From trac at twistedmatrix.com  Sun Dec  1 00:05:23 2013
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 01 Dec 2013 07:05:23 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1385881523.27.1963325935536378357@twistedmatrix.com

An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131201/984e7c5a/attachment.html>

From grindizer at gmail.com  Sun Dec  1 05:12:56 2013
From: grindizer at gmail.com (Flint)
Date: Sun, 1 Dec 2013 13:12:56 +0100
Subject: [Twisted-Python] Unpersistable instead of pb.Avatar
In-Reply-To: <CAKN9TDLgv9Q91u8dnzL8e7eB3mSFKZ=jw1c4whJU9-zOsdHYdw@mail.gmail.com>
References: <CAKN9TDLgv9Q91u8dnzL8e7eB3mSFKZ=jw1c4whJU9-zOsdHYdw@mail.gmail.com>
Message-ID: <CALpq1pbD84jVR_5m+AxP4G-Pnti=PuHY45QHxO7rv4oufUoUHA@mail.gmail.com>

Hi,

How do I fix this and actually send out new perspectives to users?
>

pb.Avatar is not a Referenceable object, the object which is sent when a
client login is a wrapper againt the pb.Avatar object built like this:

// pb.py L1327
   if not IJellyable.providedBy(avatar):
           avatar = AsReferenceable(avatar, "perspective")

So I suppose you can wrap your avatars object just like this before sending
them, "OR" you can make you own implementation of "an avatar" (implementing
IPerspective interface) and make it IJellyable at first place.

It doesn't make sense to use the same perspective in
> both games


I don't see why not personally.
Your Avatar is supposed to represente a "user" after that, it is up to you
to define what a "User" is for your application.
If a "user" is a "physical person", so your avatar could play several games
at once, your avatar could then have a list of "played games" (for
examples).
If your "user" is a couple of ("physical person"  + "a game") so each
person playing a game will represent a different "user" in the point of
view of your application.
etc.

it would be nice to separate
> the responsibilities of the user from those of the "player."
>

As I said the avatar or the user has the responsabilites that you will give
to it. I don't think Twisted makes any asumption about that (IMHO).

--
Nacim.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131201/e1e1edfb/attachment.html>

From sank.daniel at gmail.com  Sun Dec  1 09:25:29 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sun, 1 Dec 2013 08:25:29 -0800
Subject: [Twisted-Python] Unpersistable instead of pb.Avatar
In-Reply-To: <CALpq1pbD84jVR_5m+AxP4G-Pnti=PuHY45QHxO7rv4oufUoUHA@mail.gmail.com>
References: <CAKN9TDLgv9Q91u8dnzL8e7eB3mSFKZ=jw1c4whJU9-zOsdHYdw@mail.gmail.com>
 <CALpq1pbD84jVR_5m+AxP4G-Pnti=PuHY45QHxO7rv4oufUoUHA@mail.gmail.com>
Message-ID: <CAKN9TDLJ+up3FNafH6jDrLoaZCXBMYMm32ADQ1VkN4GO5ezX_g@mail.gmail.com>

>> It doesn't make sense to use the same perspective in
>> both games
>>
> I don't see why not personally.

I can think of two reasons. First, suppose that I would like to
participate in two different games of chess at the same time. Suppose
my Avatar class has a method for moving the chess pieces

perspective_movePjece(startSquare, endSquare)

If it is possible that this Avatar is playing more than one game then
this method doesn't have enough context to get the job done. Either I
have to use two method calls

perspective_selectGame(nameOfGameICareAboutNow):
    self.nameOfSelectedGame = nameOfGameICareAboutNow

perspective_movePiece(startSquare, endSquare)

or I have to require that the client side call pass in the game as an argument

perspective.callRemote("movePiece", startSquare, endSquare, whichGame)

I find both of these unsatisfying. In the first case I've basically
reverted to a remote procedure call style interface with calls that
aren't even atomic, and in the second I require the user to explicitly
declare the context of the call. This seems to miss the point of
remote objects. I'd much rather have the games be instances of
Viewable and have different perspectives into each one so that
invocations of callRemote on my references to those Viewables
automatically come with the proper context. This is why I want
multiple Avatars per human user.

The second reason is that one human may want to play as two distinct
players in the same game. In that case I need to be able to change my
client side representation of the published objects as the human
switches between the players. Here again we need multiple perspectives
to get the job done.

> Your Avatar is supposed to represente a "user" after that,
> it is up to you to define what a "User" is for your application.
> If a "user" is a "physical person", so your avatar could play
> several games at once, your avatar could then have a list of
> "played games" (for examples).

I explain above why I don't like this solution.

> If your "user" is a couple of ("physical person"  + "a game")
> so each person playing a game will represent a different
> "user" in the point of view of your application.

This lumps the "user" and the "player", which I would like to avoid.

> So I suppose you can wrap your avatars object just like
> this before sending them, "OR" you can make you own
> implementation of "an avatar" (implementing IPerspective
> interface) and make it IJellyable at first place.

That's interesting. Thanks.


From sank.daniel at gmail.com  Mon Dec  2 12:45:06 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Mon, 2 Dec 2013 11:45:06 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
Message-ID: <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>

> One way to fix this is to manually construct a ViewPoint rather than a Viewable and pass that to the client.

For the sake of trying to get my current project to work and so that I
can understand what's really going on and fix the bugs in pb: how
would I do the similar thing for a Cacheable? Looking at the source so
far I'm having trouble figuring out where things like Viewable come
into play.


From yangyouxiu at gmail.com  Tue Dec  3 02:56:11 2013
From: yangyouxiu at gmail.com (yangyouxiu)
Date: Tue, 3 Dec 2013 17:56:11 +0800
Subject: [Twisted-Python] How to get callback return value
Message-ID: <2013120317560387491630@gmail.com>

Hi,all!

On call main method, it call self.getName() in A.py, as I use callback, I can not get the return value correctly, I thought it's because the Asynchronous attribute, how should i do?

B.py
main:
name=self.getName()


A.py
def getname():
def.callback(method1)
def.callback(method2)
def.callback(success)
return self.name

def success(name):
self.name=name


Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131203/cd324e23/attachment.html>

From sank.daniel at gmail.com  Tue Dec  3 03:07:34 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Tue, 3 Dec 2013 02:07:34 -0800
Subject: [Twisted-Python] How to get callback return value
In-Reply-To: <2013120317560387491630@gmail.com>
References: <2013120317560387491630@gmail.com>
Message-ID: <CAKN9TDJdDW+H7Bce0U6EKJCzAP55z39aNRB-EjtMXihKiTwVMA@mail.gmail.com>

The code you included in your email doesn't make sense. Please include
a full working (with errors) code sample and then people can help you.

Also, I _highly_ recommend that you read this:

http://krondo.com/?page_id=1327

It might as well be considered the official n00b intro to Twisted, imho.


From yangyouxiu at gmail.com  Tue Dec  3 05:00:30 2013
From: yangyouxiu at gmail.com (=?GB2312?B?0e7T0NDj?=)
Date: Tue, 3 Dec 2013 20:00:30 +0800
Subject: [Twisted-Python] How to get callback return value
In-Reply-To: <CAKN9TDJdDW+H7Bce0U6EKJCzAP55z39aNRB-EjtMXihKiTwVMA@mail.gmail.com>
References: <2013120317560387491630@gmail.com>
 <CAKN9TDJdDW+H7Bce0U6EKJCzAP55z39aNRB-EjtMXihKiTwVMA@mail.gmail.com>
Message-ID: <CA+5=JMfQg+SNcNdA+ygYGM-c4iSRDJE--muc0PfjVG3hD4Or2Q@mail.gmail.com>

Thanks very much. Following is the traceback message and source code.

=> Traceback (most recent call last):
  File "/home/20131203-Client/src/NodeConfigurator.py", line 250, in
__slotSelectionChanged
    self.__showConfigurationPage(last_item,  0)
  File "/home/20131203-Client/src/NodeConfigurator.py", line 294, in
__showConfigurationPage
    self.showConfigurationPageByName(itm)
  File "/home/20131203-Client/src/NodeConfigurator.py", line 345, in
showConfigurationPageByName
    page.loadConfig(itm.getIDs()[0],  itm.tmpConfig)
  File "/home/20131203-Client/src/Ui/ConfigurationPages/Page_Circle.py",
line 125, in loadConfig
    self.textLabel_Platform.setText(platform)
TypeError: QLabel.setText(QString): argument 1 has unexpected type
'NoneType'
1111fff
Circle

Source code:
/home/20131203-Client/src/Ui/ConfigurationPages/Page_Circle.py

def loadConfig(self, id, config = None):
        """ Load the config
        """

        platform = node.get_platform()
self.textLabel_Platform.setText(platform)


/home/20131203-Client/src/node.py

def get_platform(self):
        """ Returns node type
        """

        self.node.addCallback(self.get_model)
        self.node.addCallback(self.success)
        return self.model


    def get_model(self, object):
        model=object.callRemote("getModel")
        return model

    def success(self, model):
        print '1111fff'
        print model
        self.model=model
        return self.model




2013/12/3 Daniel Sank <sank.daniel at gmail.com>

> The code you included in your email doesn't make sense. Please include
> a full working (with errors) code sample and then people can help you.
>
> Also, I _highly_ recommend that you read this:
>
> http://krondo.com/?page_id=1327
>
> It might as well be considered the official n00b intro to Twisted, imho.
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131203/b4bcff21/attachment.html>

From _ at lvh.io  Tue Dec  3 06:19:53 2013
From: _ at lvh.io (Laurens Van Houtven)
Date: Tue, 3 Dec 2013 14:19:53 +0100
Subject: [Twisted-Python] Unit testing AMP responder method registration
Message-ID: <CAE_Hg6anwU01cbdW-hxAMuRA2vd2psPPS+V84+QhPjaW25Sx-A@mail.gmail.com>

Hi!

I'm trying to write code using TDD and AMP. I'm trying to figure out how to
write a unit test for:

@MyCommand.responder

Specifically, I would assume that test:

1. Tests that the responder locator has a responder for MyCommand;
2. That responder matches the decorated method

(1) is easy, (2) not so much. Since usually the responder locator gives me
this nasty "doit" function that isn't introspectable (unless
it.func_closure[0].cell_contents.im_func counts as "introspection"), I'm
not sure how to write that unit test.

I do have end-to-end tests for this, obviously: I would like to also have
regular tests :)

thanks in advance
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131203/dc456540/attachment.html>

From sank.daniel at gmail.com  Tue Dec  3 10:31:01 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Tue, 3 Dec 2013 09:31:01 -0800
Subject: [Twisted-Python] How to get callback return value
In-Reply-To: <CA+5=JMfQg+SNcNdA+ygYGM-c4iSRDJE--muc0PfjVG3hD4Or2Q@mail.gmail.com>
References: <2013120317560387491630@gmail.com>
 <CAKN9TDJdDW+H7Bce0U6EKJCzAP55z39aNRB-EjtMXihKiTwVMA@mail.gmail.com>
 <CA+5=JMfQg+SNcNdA+ygYGM-c4iSRDJE--muc0PfjVG3hD4Or2Q@mail.gmail.com>
Message-ID: <CAKN9TDLtrY8_MsYMc8yVvjp0NjmCLOmCt+Wo175eC57UH+jqGw@mail.gmail.com>

this is not a complete working example. There's no executable code,
and what you included doesn't make sense.

When people ask for a complete working example it means that they want
to try to run the same program that you're running. Just attach your
actual source files to an email and send them.

>From reading the code you pasted in your email it really looks like
you aren't using deferreds correctly. Did you read the tutorial I
linked in the other email?


From peter.westlake at pobox.com  Tue Dec  3 12:36:31 2013
From: peter.westlake at pobox.com (Peter Westlake)
Date: Tue, 03 Dec 2013 19:36:31 +0000
Subject: [Twisted-Python] How to get callback return value
In-Reply-To: <CA+5=JMfQg+SNcNdA+ygYGM-c4iSRDJE--muc0PfjVG3hD4Or2Q@mail.gmail.com>
References: <2013120317560387491630@gmail.com>
 <CAKN9TDJdDW+H7Bce0U6EKJCzAP55z39aNRB-EjtMXihKiTwVMA@mail.gmail.com>
 <CA+5=JMfQg+SNcNdA+ygYGM-c4iSRDJE--muc0PfjVG3hD4Or2Q@mail.gmail.com>
Message-ID: <1386099391.28432.55080489.14F8BFD1@webmail.messagingengine.com>

On Tue, Dec 3, 2013, at 12:00, ??? wrote:

> def loadConfig(self, id, config = None):
>         """ Load the config
>         """
> 
>         platform = node.get_platform()
> self.textLabel_Platform.setText(platform)
> 
> 
> /home/20131203-Client/src/node.py
> 
> def get_platform(self):
>         """ Returns node type
>         """
> 
>         self.node.addCallback(self.get_model)
>         self.node.addCallback(self.success)
>         return self.model

addCallback is a method of twisted.internet.defer.Deferred,
but I don't think your node is a Deferred.

>     def get_model(self, object):
>         model=object.callRemote("getModel")
>         return model

This looks as though it will return a Deferred, from the callRemote.
If that isn't the case, ignore everything else below.

So you might write:

def get_platform(self):
        """ Returns node type
        """
        self.model = self.get_model()
        self.model.addCallback(self.success)
        return self.model

    def success(self, model):
        print '1111fff'
        return model

And then you could use the value returned by get_platform (which is a
Deferred)
by adding a callback to it:

def loadConfig(self, id, config = None):
        """ Load the config
        """
        node.get_platform().addCallback(self.textLabel_Platform.setText)

When the callRemote succeeds, it calls the callbacks on the Deferred.
First, it passes the return value from the remote call to success().
Then
it passes the return value from success() to textLabel_Platform.setText.

Peter.


From sank.daniel at gmail.com  Tue Dec  3 23:08:15 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Tue, 3 Dec 2013 22:08:15 -0800
Subject: [Twisted-Python] website login not working?
Message-ID: <CAKN9TD+_zrSEBiybw9PyVpPfzLZyViLf9cd4195Sddv0J4-GGg@mail.gmail.com>

I just tried logging into the website to place some tickets and found
that my login doesn't work. I got a password reset but still no dice.
Anyone else having this problem?

-- 
Daniel Sank
Department of Physics
Broida Hall
University of California
Santa Barbara, CA 93117
(805)893-3899


From exarkun at twistedmatrix.com  Wed Dec  4 01:02:26 2013
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Wed, 04 Dec 2013 08:02:26 -0000
Subject: [Twisted-Python] Unit testing AMP responder method registration
In-Reply-To: <CAE_Hg6anwU01cbdW-hxAMuRA2vd2psPPS+V84+QhPjaW25Sx-A@mail.gmail.com>
References: <CAE_Hg6anwU01cbdW-hxAMuRA2vd2psPPS+V84+QhPjaW25Sx-A@mail.gmail.com>
Message-ID: <20131204080226.5970.990320751.divmod.xquotient.2@top>

On 3 Dec, 01:19 pm, _ at lvh.io wrote:
>Hi!
>
>I'm trying to write code using TDD and AMP. I'm trying to figure out 
>how to
>write a unit test for:
>
>@MyCommand.responder
>
>Specifically, I would assume that test:
>
>1. Tests that the responder locator has a responder for MyCommand;
>2. That responder matches the decorated method
>
>(1) is easy, (2) not so much. Since usually the responder locator gives 
>me
>this nasty "doit" function that isn't introspectable (unless
>it.func_closure[0].cell_contents.im_func counts as "introspection"), 
>I'm
>not sure how to write that unit test.
>
>I do have end-to-end tests for this, obviously: I would like to also 
>have
>regular tests :)

Here's what I've done:

https://bazaar.launchpad.net/~game- 
hackers/game/trunk/view/head:/game/test/test_network.py#L418

Jean-Paul


From glyph at twistedmatrix.com  Wed Dec  4 07:26:29 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Wed, 4 Dec 2013 06:26:29 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
Message-ID: <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>


On Dec 2, 2013, at 11:45 AM, Daniel Sank <sank.daniel at gmail.com> wrote:

>> One way to fix this is to manually construct a ViewPoint rather than a Viewable and pass that to the client.
> 
> For the sake of trying to get my current project to work and so that I
> can understand what's really going on and fix the bugs in pb: how
> would I do the similar thing for a Cacheable? Looking at the source so
> far I'm having trouble figuring out where things like Viewable come
> into play.

This isn't quite as clean as with ViewPoint, but it's not all that bad either.  Basically, you need to inject the correct perspective into the RemoteCacheObserver which is constructed; unfortunately it reads it only from the jellier.

So: fix the jellier :-).

So something like this might do the trick:

class Perspectiveize(Jellyable):
    def __init__(self, perspective, obj):
        self.perspective = perspective
        self.obj = obj
    def jellyFor(self, jellier):
        old = jellier.invoker.serializingPerspective
        jellier.invoker.serializingPerspective = self.perspective
        try:
            return self.obj.jellyFor(jellier)
        finally:
            jellier.invoker.serializingPerspective = old

Untested, but I think it should do the trick.  One caveat though; if the 'obj' (in your case, Cacheable) that you wrap with this is serialized twice within the same top-level call to 'jelly', (i.e. if there are multiple references to it from within a single return message or remote method call) the second time it is serialized, it will simply serialize a reference to the first; this means you have to be careful to be sure that the Perspectiveize object is serialized before the Cacheable itself if the Cacheable is to be serialized at all.

Good luck,

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131204/89326649/attachment.html>

From _ at lvh.io  Wed Dec  4 08:06:31 2013
From: _ at lvh.io (Laurens Van Houtven)
Date: Wed, 4 Dec 2013 16:06:31 +0100
Subject: [Twisted-Python] Unit testing AMP responder method registration
In-Reply-To: <20131204080226.5970.990320751.divmod.xquotient.2@top>
References: <CAE_Hg6anwU01cbdW-hxAMuRA2vd2psPPS+V84+QhPjaW25Sx-A@mail.gmail.com>
 <20131204080226.5970.990320751.divmod.xquotient.2@top>
Message-ID: <CAE_Hg6YWY_HDncTHo0Jvn7i=P6Cho=3O25wBDDnSGYugv00n6A@mail.gmail.com>

On Wed, Dec 4, 2013 at 9:02 AM, <exarkun at twistedmatrix.com> wrote:

> https://bazaar.launchpad.net/~game- hackers/game/trunk/view/head:/
> game/test/test_network.py#L418
>


Thanks! I'll see how I can incorporate this. It does seem like the obvious
test. Right now this is more spread out in my tests: I currently test the
locator directly and the command separately.

cheers
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131204/ee5da792/attachment.html>

From grickert at coldstorage.com  Wed Dec  4 11:29:23 2013
From: grickert at coldstorage.com (Gerrat Rickert)
Date: Wed, 4 Dec 2013 18:29:23 +0000
Subject: [Twisted-Python] Filing Bugs
Message-ID: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>

I'd like to file a bug, but the site requires a login.

I'm sure I've registered before, but don't remember my username or password.
Neither the "login" link or "Register" link has any information about how to reset a password.
Nor is it present on the home page, or in the FAQ.

...although the Register link does state that:
"Entering an email address will enable you to reset your password if you ever forget it."
(I'm pretty sure I did enter an email address when I registered ages ago)

I assume there's something obvious that I'm missing, but it's flying below my visual radar, because I've tried looking everywhere
on the site.

I give up...can someone point me to the page/link where I can reset my password (to http://twistedmatrix.com - not the mailing list - resetting my password on the mailing list is obvious and straightforward).

Thanks,
                Gerrat

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131204/e84a1d43/attachment.html>

From sank.daniel at gmail.com  Wed Dec  4 11:40:56 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Wed, 4 Dec 2013 10:40:56 -0800
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
Message-ID: <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>

> I assume there?s something obvious that I?m missing, but it?s flying below my visual radar, because I?ve tried looking everywhere on the site.

I had exactly this problem last night. I googled "twisted password
reset" and found this page

http://twistedmatrix.com/trac/reset_password

I got it to send me a reset password, but that password didn't work
(as explained in my mailing list post I sent last night).


From grickert at coldstorage.com  Wed Dec  4 15:16:13 2013
From: grickert at coldstorage.com (Gerrat Rickert)
Date: Wed, 4 Dec 2013 22:16:13 +0000
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
Message-ID: <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>

> > I assume there's something obvious that I'm missing, but it's flying
> below my visual radar, because I've tried looking everywhere on the
> site.
> 
> I had exactly this problem last night. I googled "twisted password
> reset" and found this page
> 
> http://twistedmatrix.com/trac/reset_password
> 
> I got it to send me a reset password, but that password didn't work (as
> explained in my mailing list post I sent last night).


So, since I couldn't remember my username from before, I decided to just register for a new account.
During registration, it informed me:
"Warning: Another account or group already exists, who's name differs from <my name> only by case or is identical"

So I was likely just trying to re-use the same username...
It then took a few tries to guess at the right case for the previous username I had used.

...and so finally, I hit upon the right case, and it sent me an email with a new password

*Which (as you've mentioned) doesn't work.*

I've filed a website bug about the whole issue (should probably be 3 separate bugs, but I really don't have the patience):
https://bugs.launchpad.net/twisted-website/+bug/1257934



From sank.daniel at gmail.com  Wed Dec  4 15:23:41 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Wed, 4 Dec 2013 14:23:41 -0800
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
 <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
Message-ID: <CAKN9TDJgmHvy5mtw9HY5QR_HGUuGdQ-jmFNRY1d5xF24zF2Q5g@mail.gmail.com>

> I've filed a website bug about the whole issue (should probably be 3 separate bugs, but I really don't have the patience):

Thanks. I have bunch of functionality and documentation bugs in
twisted.spread.pb to report but as things are right now I can't.


From itamar at itamarst.org  Thu Dec  5 07:12:04 2013
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Thu, 05 Dec 2013 14:12:04 +0000
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <CAKN9TDJgmHvy5mtw9HY5QR_HGUuGdQ-jmFNRY1d5xF24zF2Q5g@mail.gmail.com>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
 <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
 <CAKN9TDJgmHvy5mtw9HY5QR_HGUuGdQ-jmFNRY1d5xF24zF2Q5g@mail.gmail.com>
Message-ID: <4c02675ce966c4cd2e0acfdf5939a960@itamarst.org>

 

I'm travelling for work this week, but if no one fixes it by the time
I'm back I'll see what I can figure out. Trac is terrible :( 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131205/55756efc/attachment.html>

From tom.prince at ualberta.net  Fri Dec  6 01:17:24 2013
From: tom.prince at ualberta.net (Tom Prince)
Date: Fri, 06 Dec 2013 08:17:24 +0000
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
 <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
Message-ID: <87txemjsvf.fsf@loki.hocat.ca>

Gerrat Rickert <grickert at coldstorage.com> writes:

> ...and so finally, I hit upon the right case, and it sent me an email with a new password

Have you checked your spam folder? Looking at the mail logs, it appears
a mail was sent at 2013-12-04 14:02:11 MST.

  Tom


From grickert at coldstorage.com  Fri Dec  6 06:23:07 2013
From: grickert at coldstorage.com (Gerrat Rickert)
Date: Fri, 6 Dec 2013 13:23:07 +0000
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <87txemjsvf.fsf@loki.hocat.ca>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
 <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
 <87txemjsvf.fsf@loki.hocat.ca>
Message-ID: <25CB87184063F24C9BDD8C5E3566EA257AEC6CA8@kit-ex01.coldstorage.com>

> > ...and so finally, I hit upon the right case, and it sent me an email
> > with a new password
> 
> Have you checked your spam folder? Looking at the mail logs, it appears
> a mail was sent at 2013-12-04 14:02:11 MST.
> 

Sounds right...I got the email around 2013-12-04 16:02:11 EST

It contained my username and a password.  
The username/password sent in the email doesn't work.
[Daniel Sank mentioned this same thing - maybe we weren't explicit enough]

I just tried logging into trac again (with emailed user/pass).
It still doesn't work.



From sank.daniel at gmail.com  Fri Dec  6 09:16:03 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Fri, 6 Dec 2013 08:16:03 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
Message-ID: <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>

> class Perspectiveize(Jellyable):
>     def __init__(self, perspective, obj):
>         self.perspective = perspective
>         self.obj = obj
>     def jellyFor(self, jellier):
>         old = jellier.invoker.serializingPerspective
>         jellier.invoker.serializingPerspective = self.perspective
>         try:
>             return self.obj.jellyFor(jellier)
>         finally:
>             jellier.invoker.serializingPerspective = old
>

That did work, and it helped my understand a bit more about how pb works.

Now that I have workarounds for the problems I had with pb I'd like to
try to actually modify the source to make things easier. I still can't
log into the website but as soon as that's fixed I'll get started
filing tickets etc.


From sank.daniel at gmail.com  Sat Dec  7 10:30:36 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sat, 7 Dec 2013 09:30:36 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
Message-ID: <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>

Glyph,

It seems to me that the right way to fix this issue with being able to
pass Cacheable and Viewable instances as arguments to mind.callRemote
methods would be to "attach" a perspective to that mind, possibly
during login (with a means for doing in manually as well). As soon as
that though crossed my mind I remembered that I've seen "attach" and
"detach" floating around in the pb documentation as if it were once
upon a time a real part of the API, but sort of fizzled or was never
really adopted.I would appreciate your comment on this to help me
understand the state of pb and whether my idea of how to proceed is
correct?


From sank.daniel at gmail.com  Sat Dec  7 13:28:22 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sat, 7 Dec 2013 12:28:22 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
 <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
Message-ID: <CAKN9TDJVbUDq5AP8=Zk5P6o0OVyBJ3EBrnxf9syq04SMk5MLGQ@mail.gmail.com>

I'm posting this for future hapless n00bs like myself who find this
thread while trying to grok perspective broker.

> It seems to me that the right way to fix this issue with being able to
> pass Cacheable and Viewable instances as arguments to mind.callRemote
> methods would be to "attach" a perspective to that mind, possibly
> during login (with a means for doing in manually as well).

By looking around in the source code and doing more experiments I have
figured out that you can just do this

mind.perspective = thePerspectiveIWantToAssociateWithThisMind

All subsequent serializations of Viewables and Cacheables work exactly
as they should.

This seems like a totally reasonable and simple way to fix the issue
presented at the start of this thread. Interestingly, this isn't
explained in the howto, and seems to have been forgotten by the
developers (or this is a bad solution for reasons I don't understand).

When the website is working again I'll file a documentation ticket (and fix it).


From trac at twistedmatrix.com  Sun Dec  8 00:05:21 2013
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 08 Dec 2013 07:05:21 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1386486321.11.2578535019025855265@twistedmatrix.com

An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131208/6cdfda03/attachment.html>

From glyph at twistedmatrix.com  Sun Dec  8 03:15:22 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Sun, 8 Dec 2013 02:15:22 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
 <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
Message-ID: <6BB59D03-76D0-40AC-AF3E-2647B5B37254@twistedmatrix.com>


On Dec 7, 2013, at 9:30 AM, Daniel Sank <sank.daniel at gmail.com> wrote:

> Glyph,
> 
> It seems to me that the right way to fix this issue with being able to
> pass Cacheable and Viewable instances as arguments to mind.callRemote
> methods would be to "attach" a perspective to that mind, possibly
> during login (with a means for doing in manually as well).

The mind might be any object, or it might be no object (i.e. None).  This is confusingly documented, as remote_loginAnonymous is the only thing that explicitly spells it out, but given that it's a remote thing coming from the client, and no type-checking is performed, that's implicitly what it is.

> As soon as
> that though crossed my mind I remembered that I've seen "attach" and
> "detach" floating around in the pb documentation as if it were once
> upon a time a real part of the API, but sort of fizzled or was never
> really adopted.

This part of PB was removed many years ago, and references in the documentation ought to be removed as well.

> I would appreciate your comment on this to help me
> understand the state of pb and whether my idea of how to proceed is
> correct?

In the case where a 'mind' object has a callRemote method, it's one of two things: a RemoteReference or a RemoteCacheObserver.  Both of these have a (public, given its name, but not super well documented) "perspective" attribute which triggers the serialization behavior you want when calling callRemote.  So 'attaching' that perspective is as simple of setting the attribute.  In your application, I think just setting that attribute is a much better idea than the craziness that I was suggesting with a custom Perspectivize class, and perhaps actually better than manually constructing a ViewPoint, since it generalizes completely to the whole serialization process.

What's slightly more problematic is making this general.  You have to fully deserialize the mind object before login, because it's explicitly provided in order to allow cred implementations to interact with the client during login.  And since you don't know what the avatar is before it's time to log in, there's no way to deserialize it in this way!

This is important if your Mind object were to be a custom Copyable that contained more than one RemoteReference, and, for example, had its own callRemote which could dispatch to different ones depending on what it's being asked to do.

So how about this:

Introduce a new custom interface, IHaveAPerspective (name intentionally terrible so I don't get hung up on naming it well); and then, in _cbLogin, do 'if IHaveAPerspective.providedBy(mind): mind.perspective = avatar'. (Be sure to get the right avatar, of course, the one before it's wrapped in an AsReferenceable.)  If someone had a more elaborately constructed mind object than a RemoteReference, then they could implement the interface and write a property that set it on all the relevant references.

Then, RemoteReference and RemoteCacheObserver can implement this new interface.

For compatibility reasons, you might need to make this behavior disabled by default.  But hey, it would be nice to have a public name for _PortalRoot rather than relying on adapter magic to construct one, so that new name could just do this by default.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131208/6276a892/attachment.html>

From glyph at twistedmatrix.com  Sun Dec  8 03:16:51 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Sun, 8 Dec 2013 02:16:51 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDJVbUDq5AP8=Zk5P6o0OVyBJ3EBrnxf9syq04SMk5MLGQ@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
 <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
 <CAKN9TDJVbUDq5AP8=Zk5P6o0OVyBJ3EBrnxf9syq04SMk5MLGQ@mail.gmail.com>
Message-ID: <7F2DB907-1274-467F-8CA4-704A27FF2F58@twistedmatrix.com>


On Dec 7, 2013, at 12:28 PM, Daniel Sank <sank.daniel at gmail.com> wrote:

> I'm posting this for future hapless n00bs like myself who find this
> thread while trying to grok perspective broker.
> 
>> It seems to me that the right way to fix this issue with being able to
>> pass Cacheable and Viewable instances as arguments to mind.callRemote
>> methods would be to "attach" a perspective to that mind, possibly
>> during login (with a means for doing in manually as well).
> 
> By looking around in the source code and doing more experiments I have
> figured out that you can just do this
> 
> mind.perspective = thePerspectiveIWantToAssociateWithThisMind

Oops, I wrote my previous reply without having seen this message! :-).

And yes, I'd totally forgotten that that's a way to do it, because the documentation is horrible and it's been years since I worked on a PB-based application.  I would strongly encourage you to contribute documentation enhancements that add the requisite level of docstring coverage to PB.

Thanks for your interest so far.

-glyph



From sank.daniel at gmail.com  Sun Dec  8 08:46:27 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sun, 8 Dec 2013 07:46:27 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <7F2DB907-1274-467F-8CA4-704A27FF2F58@twistedmatrix.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
 <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
 <CAKN9TDJVbUDq5AP8=Zk5P6o0OVyBJ3EBrnxf9syq04SMk5MLGQ@mail.gmail.com>
 <7F2DB907-1274-467F-8CA4-704A27FF2F58@twistedmatrix.com>
Message-ID: <CAKN9TDL+8RB2cPSsMgojEXCt=EB7hF-_EjVzX=3kVfm5D0XAwA@mail.gmail.com>

> I would strongly encourage you to contribute documentation enhancements that add the requisite level of docstring coverage to PB.

Eagerly awaiting for the website login to work so I can do that.

> it's been years since I worked on a PB-based application.

I would like to know, is there anyone else who knows how pb works, or
is it mostly just you (glyph)?


From sank.daniel at gmail.com  Sun Dec  8 08:56:25 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sun, 8 Dec 2013 07:56:25 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDL+8RB2cPSsMgojEXCt=EB7hF-_EjVzX=3kVfm5D0XAwA@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
 <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
 <CAKN9TDJVbUDq5AP8=Zk5P6o0OVyBJ3EBrnxf9syq04SMk5MLGQ@mail.gmail.com>
 <7F2DB907-1274-467F-8CA4-704A27FF2F58@twistedmatrix.com>
 <CAKN9TDL+8RB2cPSsMgojEXCt=EB7hF-_EjVzX=3kVfm5D0XAwA@mail.gmail.com>
Message-ID: <CAKN9TDLqX4PvBmv0bFbgY5RVm4RDFXgie7G2LC6jGa82+Tgnxg@mail.gmail.com>

> I would like to know, is there anyone else who knows how pb works,
> or is it mostly just you (glyph)?

I'm asking this just to get a feel for who's who among twisted
developers, not for any other reason. To be clear your help has been
awesome and I really appreciate it very much! :)


From asaha at redhat.com  Sun Dec  8 22:28:47 2013
From: asaha at redhat.com (Amit Saha)
Date: Mon, 9 Dec 2013 00:28:47 -0500 (EST)
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server over
	IPv6
In-Reply-To: <1714995926.26426627.1386566496496.JavaMail.root@redhat.com>
Message-ID: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>

Hello,

I am trying to connect to a local XML-RPC server with IPv4 *disabled*. Here is my script:

from twisted.web.xmlrpc import Proxy
from twisted.internet import reactor

def printValue(value):
    print repr(value)
    reactor.stop()

def printError(error):
    print 'error', error
    reactor.stop()

proxy = Proxy('http://localhost6:8000')
proxy.callRemote('my_proxy_method').addCallbacks(printValue, printError)


When I run it, i get "No route to host: 101, Network is unreachable".

However, 'curl -6 localhost:8000' succeeds. What could be going on here?
I am using Twisted-12.2 on Fedora 19.

Thanks for any insights.

Best,
Amit.

-- 
Amit Saha <http://echorand.me>


From asaha at redhat.com  Sun Dec  8 22:34:27 2013
From: asaha at redhat.com (Amit Saha)
Date: Mon, 9 Dec 2013 00:34:27 -0500 (EST)
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
 over	IPv6
In-Reply-To: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
Message-ID: <793295191.26431528.1386567267794.JavaMail.root@redhat.com>



----- Original Message -----
> From: "Amit Saha" <asaha at redhat.com>
> To: twisted-python at twistedmatrix.com
> Sent: Monday, December 9, 2013 3:28:47 PM
> Subject: [Twisted-Python] Queries about connecting to a XML-RPC server over	IPv6
> 
> Hello,
> 
> I am trying to connect to a local XML-RPC server with IPv4 *disabled*. Here
> is my script:
> 
> from twisted.web.xmlrpc import Proxy
> from twisted.internet import reactor
> 
> def printValue(value):
>     print repr(value)
>     reactor.stop()
> 
> def printError(error):
>     print 'error', error
>     reactor.stop()
> 
> proxy = Proxy('http://localhost6:8000')
> proxy.callRemote('my_proxy_method').addCallbacks(printValue, printError)
> 
> 
> When I run it, i get "No route to host: 101, Network is unreachable".
> 
> However, 'curl -6 localhost:8000' succeeds. What could be going on here?
> I am using Twisted-12.2 on Fedora 19.

That should be, 'curl -6 localhost6:8000'.



From p.mayers at imperial.ac.uk  Mon Dec  9 02:33:17 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Mon, 09 Dec 2013 09:33:17 +0000
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
 over IPv6
In-Reply-To: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
Message-ID: <52A58E5D.1030809@imperial.ac.uk>

On 09/12/13 05:28, Amit Saha wrote:

> proxy = Proxy('http://localhost6:8000')
> proxy.callRemote('my_proxy_method').addCallbacks(printValue, printError)
>
>
> When I run it, i get "No route to host: 101, Network is unreachable".
>
> However, 'curl -6 localhost:8000' succeeds. What could be going on here?

The IPv6 support in Twisted is very new - check your version even *has* 
it - and it's still a work in progress. You might find that you can't do 
this. I'd have to read the code to be sure and I don't have time right 
now, but my guess is that t.w.xmlrpc isn't "getaddrinfo"-ised so won't 
connect to IPv6 names.

If your version of Twisted supports it, you could probably work around 
this by sub-classing Proxy and calling reactor.connectTCP('::1', 8000) 
to attach the protocol yourself.


From glyph at twistedmatrix.com  Mon Dec  9 06:26:37 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Mon, 9 Dec 2013 05:26:37 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDLqX4PvBmv0bFbgY5RVm4RDFXgie7G2LC6jGa82+Tgnxg@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
 <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
 <CAKN9TDJVbUDq5AP8=Zk5P6o0OVyBJ3EBrnxf9syq04SMk5MLGQ@mail.gmail.com>
 <7F2DB907-1274-467F-8CA4-704A27FF2F58@twistedmatrix.com>
 <CAKN9TDL+8RB2cPSsMgojEXCt=EB7hF-_EjVzX=3kVfm5D0XAwA@mail.gmail.com>
 <CAKN9TDLqX4PvBmv0bFbgY5RVm4RDFXgie7G2LC6jGa82+Tgnxg@mail.gmail.com>
Message-ID: <1E816ADC-29F8-4DA4-AD27-ED3E0C4B977A@twistedmatrix.com>


On Dec 8, 2013, at 7:56 AM, Daniel Sank <sank.daniel at gmail.com> wrote:

>> I would like to know, is there anyone else who knows how pb works,
>> or is it mostly just you (glyph)?
> 
> I'm asking this just to get a feel for who's who among twisted
> developers, not for any other reason. To be clear your help has been
> awesome and I really appreciate it very much! :)

I'm sure that several other core developers understand how it works, but as long as I'm answering your questions promptly there's no reason for them to pop their heads in ;).

-glyph



From glyph at twistedmatrix.com  Mon Dec  9 06:27:14 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Mon, 9 Dec 2013 05:27:14 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDL+8RB2cPSsMgojEXCt=EB7hF-_EjVzX=3kVfm5D0XAwA@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
 <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
 <CAKN9TDJVbUDq5AP8=Zk5P6o0OVyBJ3EBrnxf9syq04SMk5MLGQ@mail.gmail.com>
 <7F2DB907-1274-467F-8CA4-704A27FF2F58@twistedmatrix.com>
 <CAKN9TDL+8RB2cPSsMgojEXCt=EB7hF-_EjVzX=3kVfm5D0XAwA@mail.gmail.com>
Message-ID: <634E782A-7A42-4A71-A3EE-47147E544D65@twistedmatrix.com>


On Dec 8, 2013, at 7:46 AM, Daniel Sank <sank.daniel at gmail.com> wrote:

>> I would strongly encourage you to contribute documentation enhancements that add the requisite level of docstring coverage to PB.
> 
> Eagerly awaiting for the website login to work so I can do that.

What exactly is the problem with login?  I skimmed another message where you complained, but then I tried to log in myself and it worked so I assumed the issue was temporary and had been fixed.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131209/9cfe7606/attachment.html>

From glyph at twistedmatrix.com  Mon Dec  9 06:28:55 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Mon, 9 Dec 2013 05:28:55 -0800
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
	over IPv6
In-Reply-To: <52A58E5D.1030809@imperial.ac.uk>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
 <52A58E5D.1030809@imperial.ac.uk>
Message-ID: <F9D98C1F-CAD9-43A7-9211-35F82A06CED1@twistedmatrix.com>

On Dec 9, 2013, at 1:33 AM, Phil Mayers <p.mayers at imperial.ac.uk> wrote:

> The IPv6 support in Twisted is very new - check your version even *has* it - and it's still a work in progress. You might find that you can't do this. I'd have to read the code to be sure and I don't have time right now, but my guess is that t.w.xmlrpc isn't "getaddrinfo"-ised so won't connect to IPv6 names.
> 
> If your version of Twisted supports it, you could probably work around this by sub-classing Proxy and calling reactor.connectTCP('::1', 8000) to attach the protocol yourself.

Worth noting, of course, that Proxy not working with IPv6 is a bug.  Please file it as such.  (It seems like HostnameEndpoint could totally do the trick...)

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131209/69daef50/attachment.html>

From p.mayers at imperial.ac.uk  Mon Dec  9 07:54:59 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Mon, 09 Dec 2013 14:54:59 +0000
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
 over IPv6
In-Reply-To: <F9D98C1F-CAD9-43A7-9211-35F82A06CED1@twistedmatrix.com>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
 <52A58E5D.1030809@imperial.ac.uk>
 <F9D98C1F-CAD9-43A7-9211-35F82A06CED1@twistedmatrix.com>
Message-ID: <52A5D9C3.3060606@imperial.ac.uk>

On 09/12/13 13:28, Glyph wrote:
> On Dec 9, 2013, at 1:33 AM, Phil Mayers <p.mayers at imperial.ac.uk
> <mailto:p.mayers at imperial.ac.uk>> wrote:
>
>> The IPv6 support in Twisted is very new - check your version even
>> *has* it - and it's still a work in progress. You might find that you
>> can't do this. I'd have to read the code to be sure and I don't have
>> time right now, but my guess is that t.w.xmlrpc isn't
>> "getaddrinfo"-ised so won't connect to IPv6 names.
>>
>> If your version of Twisted supports it, you could probably work around
>> this by sub-classing Proxy and calling reactor.connectTCP('::1', 8000)
>> to attach the protocol yourself.
>
> Worth noting, of course, that Proxy not working with IPv6 is a bug.

Opened #6870


From p.mayers at imperial.ac.uk  Mon Dec  9 08:01:16 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Mon, 09 Dec 2013 15:01:16 +0000
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
 over IPv6
In-Reply-To: <52A5D9C3.3060606@imperial.ac.uk>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
 <52A58E5D.1030809@imperial.ac.uk>
 <F9D98C1F-CAD9-43A7-9211-35F82A06CED1@twistedmatrix.com>
 <52A5D9C3.3060606@imperial.ac.uk>
Message-ID: <52A5DB3C.4060609@imperial.ac.uk>

On 09/12/13 14:54, Phil Mayers wrote:
> On 09/12/13 13:28, Glyph wrote:
>> On Dec 9, 2013, at 1:33 AM, Phil Mayers <p.mayers at imperial.ac.uk
>> <mailto:p.mayers at imperial.ac.uk>> wrote:
>>
>>> The IPv6 support in Twisted is very new - check your version even
>>> *has* it - and it's still a work in progress. You might find that you
>>> can't do this. I'd have to read the code to be sure and I don't have
>>> time right now, but my guess is that t.w.xmlrpc isn't
>>> "getaddrinfo"-ised so won't connect to IPv6 names.
>>>
>>> If your version of Twisted supports it, you could probably work around
>>> this by sub-classing Proxy and calling reactor.connectTCP('::1', 8000)
>>> to attach the protocol yourself.
>>
>> Worth noting, of course, that Proxy not working with IPv6 is a bug.
>
> Opened #6870
>

Also #6871 for IPv6 literal URLs, but maybe the whole xmlrpc code should 
be moved to the new web.client code, and move all that logic in there?


From sank.daniel at gmail.com  Mon Dec  9 10:43:26 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Mon, 9 Dec 2013 09:43:26 -0800
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <25CB87184063F24C9BDD8C5E3566EA257AEC6CA8@kit-ex01.coldstorage.com>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
 <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
 <87txemjsvf.fsf@loki.hocat.ca>
 <25CB87184063F24C9BDD8C5E3566EA257AEC6CA8@kit-ex01.coldstorage.com>
Message-ID: <CAKN9TDKJRcma_irLeE-YG6zuLoVnQ2ab5X+Yoga30rDLB+9zdg@mail.gmail.com>

This is an update because glyph asked about this issue in another
thread but I want to put the information where it belongs:

1. Try to log in. Does not accept credentials (login box simply
reappears with username and password fields blank).

2. Cannot find a password reset option. Scratch head.

3. Google "twisted password reset". Find this page:
http://twistedmatrix.com/trac/reset_password.

4. Ask for password reset. Receive email.

5. Try new password, goto 1.


From sank.daniel at gmail.com  Mon Dec  9 10:45:33 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Mon, 9 Dec 2013 09:45:33 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <634E782A-7A42-4A71-A3EE-47147E544D65@twistedmatrix.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
 <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
 <CAKN9TDJVbUDq5AP8=Zk5P6o0OVyBJ3EBrnxf9syq04SMk5MLGQ@mail.gmail.com>
 <7F2DB907-1274-467F-8CA4-704A27FF2F58@twistedmatrix.com>
 <CAKN9TDL+8RB2cPSsMgojEXCt=EB7hF-_EjVzX=3kVfm5D0XAwA@mail.gmail.com>
 <634E782A-7A42-4A71-A3EE-47147E544D65@twistedmatrix.com>
Message-ID: <CAKN9TD+L+mv=bz_VVgDRjFHu+JWnN5nAJa4y+i22Vkh7Yp2mUQ@mail.gmail.com>

> What exactly is the problem with login?

In an effort to stay on topic and reduce mailing list entropy I just
responded to this question in another thread that was about the broken
log-in.


From wenxiang at zopim.com  Mon Dec  9 10:49:47 2013
From: wenxiang at zopim.com (Wenxiang Wu)
Date: Tue, 10 Dec 2013 01:49:47 +0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
Message-ID: <CAGr0=+GYrEFECA__A98h2+B0TUJD29RM0T=q2pc3_4W_r0mWVg@mail.gmail.com>

I'm
On Nov 21, 2013 7:56 AM, "Daniel Sank" <sank.daniel at gmail.com> wrote:

> From some experimentation I find that the only way to make a Viewable
> get a meaningful perspective argument when executing view_* methods is
> to make sure that the references to that Viewable are given to clients
> as return values from perspective_* methods called on a pb.Avatar.
>
> In particular, if the Avatar gives a client a reference to a Viewable
> by passing it as an argument to a remote_* method on the client,
> subsequent invocations of view_* methods by the client result in
> perspective argument in view_* methods being None.
>
> I have attached a complete working example of a client and server that
> succinctly illustrates this issue.
>
> Question: Is there a way to distribute un-asked for references to
> Viewables that properly get the perspective argument in their view_*
> methods?
>
> Sincerely,
> Daniel Sank
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131210/05ff2a6b/attachment.html>

From _ at lvh.io  Mon Dec  9 15:19:21 2013
From: _ at lvh.io (Laurens Van Houtven)
Date: Mon, 9 Dec 2013 23:19:21 +0100
Subject: [Twisted-Python] ISSLTransport.getPeerCertificate returning None?
Message-ID: <CAE_Hg6ZPsLdGoW-QvcA5sVU4ikU1c76odh6_HDD9r55A8PcdxQ@mail.gmail.com>

Hi!


I'm trying to authenticate a client by looking at their SSL certificate.
I'm calling it from within an AMP responder (so, there's bytes going over
the TLS transport already), and it's still None, so this is unrelated to
calling it in connectionMade. That leads me to believe my client is doing
something wrong...

I've followed the SSL howto on how to write a client that sends a client
cert:

https://twistedmatrix.com/documents/current/core/howto/ssl.html#auto9

My client is here:

https://gist.github.com/lvh/d8d9f0b530d07a087da4

... but in the server's AMP protocol, self.transport.getPeerCertificate()
is still None :/

Any idea what's going on?

cheers
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131209/692068e2/attachment.html>

From asaha at redhat.com  Mon Dec  9 18:59:27 2013
From: asaha at redhat.com (Amit Saha)
Date: Mon, 9 Dec 2013 20:59:27 -0500 (EST)
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
 over IPv6
In-Reply-To: <52A58E5D.1030809@imperial.ac.uk>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
 <52A58E5D.1030809@imperial.ac.uk>
Message-ID: <1005863409.27288582.1386640767922.JavaMail.root@redhat.com>



----- Original Message -----
> From: "Phil Mayers" <p.mayers at imperial.ac.uk>
> To: twisted-python at twistedmatrix.com
> Sent: Monday, December 9, 2013 7:33:17 PM
> Subject: Re: [Twisted-Python] Queries about connecting to a XML-RPC server over IPv6
> 
> On 09/12/13 05:28, Amit Saha wrote:
> 
> > proxy = Proxy('http://localhost6:8000')
> > proxy.callRemote('my_proxy_method').addCallbacks(printValue, printError)
> >
> >
> > When I run it, i get "No route to host: 101, Network is unreachable".
> >
> > However, 'curl -6 localhost:8000' succeeds. What could be going on here?
> 
> The IPv6 support in Twisted is very new - check your version even *has*
> it - and it's still a work in progress. You might find that you can't do
> this. I'd have to read the code to be sure and I don't have time right
> now, but my guess is that t.w.xmlrpc isn't "getaddrinfo"-ised so won't
> connect to IPv6 names.
> 
> If your version of Twisted supports it, you could probably work around
> this by sub-classing Proxy and calling reactor.connectTCP('::1', 8000)
> to attach the protocol yourself.

Thanks for your reply, Phil. So, I basically modified twisted/web/xmlrpc.py so that
when it was calling connectTCP(), i substituted '::1' in place of self.host
and yes the method is called successfully.

I will consider your other hints and see if there is an easy way to work around this
in my particular use case.


Thanks,
Amit.


-- 
Amit Saha <http://echorand.me>


From p.mayers at imperial.ac.uk  Tue Dec 10 01:41:08 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Tue, 10 Dec 2013 08:41:08 +0000
Subject: [Twisted-Python] ISSLTransport.getPeerCertificate returning
	None?
In-Reply-To: <CAE_Hg6ZPsLdGoW-QvcA5sVU4ikU1c76odh6_HDD9r55A8PcdxQ@mail.gmail.com>
References: <CAE_Hg6ZPsLdGoW-QvcA5sVU4ikU1c76odh6_HDD9r55A8PcdxQ@mail.gmail.com>
Message-ID: <52A6D3A4.7010406@imperial.ac.uk>

On 09/12/13 22:19, Laurens Van Houtven wrote:

> ... but in the server's AMP protocol,
> self.transport.getPeerCertificate() is still None :/

Unless you set the appropriate verify options on the server side too, 
the client cert isn't available for inspection.


From _ at lvh.io  Tue Dec 10 02:21:02 2013
From: _ at lvh.io (Laurens Van Houtven)
Date: Tue, 10 Dec 2013 10:21:02 +0100
Subject: [Twisted-Python] ISSLTransport.getPeerCertificate returning
	None?
In-Reply-To: <52A6D3A4.7010406@imperial.ac.uk>
References: <CAE_Hg6ZPsLdGoW-QvcA5sVU4ikU1c76odh6_HDD9r55A8PcdxQ@mail.gmail.com>
 <52A6D3A4.7010406@imperial.ac.uk>
Message-ID: <CAE_Hg6bPdQ=BqSzFQYfTQG03u4hxnCtKex3AseH4sBcgNyvBdQ@mail.gmail.com>

On Tue, Dec 10, 2013 at 9:41 AM, Phil Mayers <p.mayers at imperial.ac.uk>wrote:

> Unless you set the appropriate verify options on the server side too, the
> client cert isn't available for inspection.
>

A-ha! But I want to do TOFU-POP; the certs are generated by the client, and
there's little point in me signing them (I don't need to be able to verify
that I ever signed them somewhere else).

The context factory I got from PrivateCertificate.options() doesn't seem to
do what I want, so I wrote my own SSL ContextFactory like it's 1999; I used
VERIFY_PEER with a callback that always claims it validated:

class ContextFactory(object):
    def getContext(self):
        ctx = Context(TLSv1_METHOD)
        ctx.use_certificate_file("cert.pem")
        ctx.use_privatekey_file("key.pem")
        ctx.set_verify(VERIFY_PEER, _verify)
        return ctx



def _verify(connection, x509, errorNumber, errorDepth, returnCode):
    """Always pretend the certificate verified.

    """
    return True


Does that sound about right, or is there an easier way to do this? (Yeah,
yeah, don't hardcode paths etc :))

cheers
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131210/bf7837ec/attachment.html>

From exarkun at twistedmatrix.com  Tue Dec 10 06:21:41 2013
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Tue, 10 Dec 2013 13:21:41 -0000
Subject: [Twisted-Python] ISSLTransport.getPeerCertificate returning
	None?
In-Reply-To: <52A6D3A4.7010406@imperial.ac.uk>
References: <CAE_Hg6ZPsLdGoW-QvcA5sVU4ikU1c76odh6_HDD9r55A8PcdxQ@mail.gmail.com>
 <52A6D3A4.7010406@imperial.ac.uk>
Message-ID: <20131210132141.6396.1418941768.divmod.xquotient.0@top>

On 08:41 am, p.mayers at imperial.ac.uk wrote:
>On 09/12/13 22:19, Laurens Van Houtven wrote:
>>... but in the server's AMP protocol,
>>self.transport.getPeerCertificate() is still None :/
>
>Unless you set the appropriate verify options on the server side too, 
>the client cert isn't available for inspection.

twisted.internet.ssl.CertificateOptions sets these by default.  If you 
use it, you shouldn't need to do anything else.

Jean-Paul


From p.mayers at imperial.ac.uk  Tue Dec 10 06:51:44 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Tue, 10 Dec 2013 13:51:44 +0000
Subject: [Twisted-Python] ISSLTransport.getPeerCertificate returning
	None?
In-Reply-To: <20131210132141.6396.1418941768.divmod.xquotient.0@top>
References: <CAE_Hg6ZPsLdGoW-QvcA5sVU4ikU1c76odh6_HDD9r55A8PcdxQ@mail.gmail.com>
 <52A6D3A4.7010406@imperial.ac.uk>
 <20131210132141.6396.1418941768.divmod.xquotient.0@top>
Message-ID: <52A71C70.5070108@imperial.ac.uk>

On 10/12/13 13:21, exarkun at twistedmatrix.com wrote:
> On 08:41 am, p.mayers at imperial.ac.uk wrote:
>> On 09/12/13 22:19, Laurens Van Houtven wrote:
>>> ... but in the server's AMP protocol,
>>> self.transport.getPeerCertificate() is still None :/
>>
>> Unless you set the appropriate verify options on the server side too,
>> the client cert isn't available for inspection.
>
> twisted.internet.ssl.CertificateOptions sets these by default.  If you
> use it, you shouldn't need to do anything else.

Are you sure about that? It does not match my recollection.


From _ at lvh.io  Tue Dec 10 07:01:47 2013
From: _ at lvh.io (Laurens Van Houtven)
Date: Tue, 10 Dec 2013 15:01:47 +0100
Subject: [Twisted-Python] ISSLTransport.getPeerCertificate returning
	None?
In-Reply-To: <52A71C70.5070108@imperial.ac.uk>
References: <CAE_Hg6ZPsLdGoW-QvcA5sVU4ikU1c76odh6_HDD9r55A8PcdxQ@mail.gmail.com>
 <52A6D3A4.7010406@imperial.ac.uk>
 <20131210132141.6396.1418941768.divmod.xquotient.0@top>
 <52A71C70.5070108@imperial.ac.uk>
Message-ID: <CAE_Hg6YWp3y-nzvrQ237prB3vVGPoh_FP976oxLoqD8sTO635w@mail.gmail.com>

Somehow, JP's e-mail did not make it into my inbox :-(

Anyway, using the context factory that I got
from ssl.PrivateCertificate.options() (which I think is
CertificateOptions), I wasn't able to inspect the peer certificate. That's
on 13.2. Using the context factory I pasted in a previous e-mail, it's now
working great :)

cheers
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131210/42968e63/attachment.html>

From itamar at itamarst.org  Tue Dec 10 18:28:38 2013
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Tue, 10 Dec 2013 20:28:38 -0500
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <CAKN9TDKJRcma_irLeE-YG6zuLoVnQ2ab5X+Yoga30rDLB+9zdg@mail.gmail.com>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
 <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
 <87txemjsvf.fsf@loki.hocat.ca>
 <25CB87184063F24C9BDD8C5E3566EA257AEC6CA8@kit-ex01.coldstorage.com>
 <CAKN9TDKJRcma_irLeE-YG6zuLoVnQ2ab5X+Yoga30rDLB+9zdg@mail.gmail.com>
Message-ID: <52A7BFC6.1060607@itamarst.org>

On 12/09/2013 12:43 PM, Daniel Sank wrote:
> This is an update because glyph asked about this issue in another
> thread but I want to put the information where it belongs:
>
> 1. Try to log in. Does not accept credentials (login box simply
> reappears with username and password fields blank).
>
> 2. Cannot find a password reset option. Scratch head.
>
> 3. Google "twisted password reset". Find this page:
> http://twistedmatrix.com/trac/reset_password.
>
> 4. Ask for password reset. Receive email.
>
> 5. Try new password, goto 1.
>

I am unable to reproduce (in Chrome, using HTTPS rather than HTTP). I am 
able to sign in with newly created user... but resetting the password 
doesn't work, it gives me a "The email and username must match a known 
account." message which is quite bogus. I see nothing different between 
the new account I created, the danielsank account and my real account 
when using the Admin UI. A second account created with Firefox did show 
the failure to login, but browser may be unrelated.

This is still pretty bad, since password resets don't work, but I can't 
actually get them to be emailed.

I hate Trac so very much.

I suspect some issue with cookies, since I've created multiple logins 
but it keeps trying to log me in as a different one. Might be browser 
auth history though, hard to tell.

Can you try deleting all cookies for twistedmatrix.com and then try the 
reset again, or perhaps login with last reset password you got?


From sank.daniel at gmail.com  Tue Dec 10 18:53:11 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Tue, 10 Dec 2013 17:53:11 -0800
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <52A7BFC6.1060607@itamarst.org>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
 <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
 <87txemjsvf.fsf@loki.hocat.ca>
 <25CB87184063F24C9BDD8C5E3566EA257AEC6CA8@kit-ex01.coldstorage.com>
 <CAKN9TDKJRcma_irLeE-YG6zuLoVnQ2ab5X+Yoga30rDLB+9zdg@mail.gmail.com>
 <52A7BFC6.1060607@itamarst.org>
Message-ID: <CAKN9TDJaOAkcyee2AF53-yBzbP3gXBA7utc8PTVEAO2NVED_Ww@mail.gmail.com>

> Can you try deleting all cookies for twistedmatrix.com and then try the reset again, or perhaps login with last reset password you got?

1. Deleted all cookies
2. Asked for password reset
3. Got new password
4. Tried to log in with new password. Does not work.


From itamar at itamarst.org  Wed Dec 11 05:48:21 2013
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Wed, 11 Dec 2013 07:48:21 -0500
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <CAKN9TDJaOAkcyee2AF53-yBzbP3gXBA7utc8PTVEAO2NVED_Ww@mail.gmail.com>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
 <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
 <87txemjsvf.fsf@loki.hocat.ca>
 <25CB87184063F24C9BDD8C5E3566EA257AEC6CA8@kit-ex01.coldstorage.com>
 <CAKN9TDKJRcma_irLeE-YG6zuLoVnQ2ab5X+Yoga30rDLB+9zdg@mail.gmail.com>
 <52A7BFC6.1060607@itamarst.org>
 <CAKN9TDJaOAkcyee2AF53-yBzbP3gXBA7utc8PTVEAO2NVED_Ww@mail.gmail.com>
Message-ID: <52A85F15.4030103@itamarst.org>

Sigh. I'll see if there's some relevant bug fixes in the newer version 
of the auth trac plugin I believe we're using.


From glyph at twistedmatrix.com  Wed Dec 11 06:48:29 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Wed, 11 Dec 2013 05:48:29 -0800
Subject: [Twisted-Python] ISSLTransport.getPeerCertificate returning
	None?
In-Reply-To: <CAE_Hg6YWp3y-nzvrQ237prB3vVGPoh_FP976oxLoqD8sTO635w@mail.gmail.com>
References: <CAE_Hg6ZPsLdGoW-QvcA5sVU4ikU1c76odh6_HDD9r55A8PcdxQ@mail.gmail.com>
 <52A6D3A4.7010406@imperial.ac.uk>
 <20131210132141.6396.1418941768.divmod.xquotient.0@top>
 <52A71C70.5070108@imperial.ac.uk>
 <CAE_Hg6YWp3y-nzvrQ237prB3vVGPoh_FP976oxLoqD8sTO635w@mail.gmail.com>
Message-ID: <6B6C4EBB-9B3D-42D1-8EC7-5205B51792AE@twistedmatrix.com>

On Dec 10, 2013, at 6:01 AM, Laurens Van Houtven <_ at lvh.io> wrote:

> Somehow, JP's e-mail did not make it into my inbox :-(
> 
> Anyway, using the context factory that I got from ssl.PrivateCertificate.options() (which I think is CertificateOptions), I wasn't able to inspect the peer certificate. That's on 13.2. Using the context factory I pasted in a previous e-mail, it's now working great :)
> 
> cheers
> lvh

CertificateOptions will only set 'verify' if there are certificate authorities to verify against.

However, you can still CertificateOptions with a wrapper, like this:

from twisted.internet.ssl import ContextFactory
from OpenSSL import SSL

class TOFUVerify(ContextFactory):
    def __init__(self, wrapped):
        self.wrapped = wrapped

    def getContext(self):
        ctx = self.wrapped.getContext()
        ctx.set_verify(SSL.VERIFY_PEER, lambda *args: True)
        return ctx

since CertificateOptions sets a bunch of other options for you that might be useful.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131211/0bf55d29/attachment.html>

From tobias.oberstein at tavendo.de  Thu Dec 12 01:29:48 2013
From: tobias.oberstein at tavendo.de (Tobias Oberstein)
Date: Thu, 12 Dec 2013 00:29:48 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
Message-ID: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>

Hi,

I am working on Twisted Endpoint support in Autobahn https://github.com/tavendo/AutobahnPython.

So far, I made Autobahn able to talk WebSocket _over_ arbitrary Twisted Endpoints, e.g. WebSocket over Unix domain sockets works. This is already quite nifty.

Is there anything like Twisted Endpoints for Processes and/or Serial? Like:

endpoint = serverFromString(reactor,"process:program=/usr/local/bin/myprogram")

or

endpoint = serverFromString(reactor,"serial:port=/dev/tty1:baudrate=115000")

That would allow to talk WebSocket over stdin/stdout to a program or a serial conneced device. Both can be useful in certain situations.

I'd also like to add the other: creating an Twisted Endpoint _from_ an Autobahn server/client to be able to talk any (stream) protocol _over_ WebSocket (like SSH or VNC over WebSocket).

endpoint = serverFromString(reactor,"websocket:tcp:80:url=ws://myhostname.com/somepath")

I guess I need to provide an implementation of
http://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.ITransport.html

What else? Is there some docs or recipe?

Thanks!
/Tobias



From asaha at redhat.com  Thu Dec 12 05:23:40 2013
From: asaha at redhat.com (Amit Saha)
Date: Thu, 12 Dec 2013 07:23:40 -0500 (EST)
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
 over IPv6
In-Reply-To: <1005863409.27288582.1386640767922.JavaMail.root@redhat.com>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
 <52A58E5D.1030809@imperial.ac.uk>
 <1005863409.27288582.1386640767922.JavaMail.root@redhat.com>
Message-ID: <1314654450.29770435.1386851020079.JavaMail.root@redhat.com>



----- Original Message -----
> From: "Amit Saha" <asaha at redhat.com>
> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> Sent: Tuesday, December 10, 2013 11:59:27 AM
> Subject: Re: [Twisted-Python] Queries about connecting to a XML-RPC server over IPv6
> 
> 
> 
> ----- Original Message -----
> > From: "Phil Mayers" <p.mayers at imperial.ac.uk>
> > To: twisted-python at twistedmatrix.com
> > Sent: Monday, December 9, 2013 7:33:17 PM
> > Subject: Re: [Twisted-Python] Queries about connecting to a XML-RPC server
> > over IPv6
> > 
> > On 09/12/13 05:28, Amit Saha wrote:
> > 
> > > proxy = Proxy('http://localhost6:8000')
> > > proxy.callRemote('my_proxy_method').addCallbacks(printValue, printError)
> > >
> > >
> > > When I run it, i get "No route to host: 101, Network is unreachable".
> > >
> > > However, 'curl -6 localhost:8000' succeeds. What could be going on here?
> > 
> > The IPv6 support in Twisted is very new - check your version even *has*
> > it - and it's still a work in progress. You might find that you can't do
> > this. I'd have to read the code to be sure and I don't have time right
> > now, but my guess is that t.w.xmlrpc isn't "getaddrinfo"-ised so won't
> > connect to IPv6 names.
> > 
> > If your version of Twisted supports it, you could probably work around
> > this by sub-classing Proxy and calling reactor.connectTCP('::1', 8000)
> > to attach the protocol yourself.
> 
> Thanks for your reply, Phil. So, I basically modified twisted/web/xmlrpc.py
> so that
> when it was calling connectTCP(), i substituted '::1' in place of self.host
> and yes the method is called successfully.
> 
> I will consider your other hints and see if there is an easy way to work
> around this
> in my particular use case.

I finally ended up doing this:

(Sorry for the +)

+class ProxyIPv6(xmlrpc.Proxy):
+
+    def __init__(self, url, **kwargs):
+
+        xmlrpc.Proxy.__init__(self, url, kwargs)
+        # resolve the LC's host/port to IPv6 address
+        # and overrise self.host
+        retries = 0
+        while retries < 5:
+            try:
+                self.host = socket.getaddrinfo(self.host, self.port,
+                                               socket.AF_INET6, 0, socket.SOL_TCP)[0][4][0]
+            except:
+                # IPv6 look up failed
+                log.debug('Failed to look up IPv6 address for LC. Sleeping for 5s')
+                time.sleep(5)
+                retries += 1
+            else:
+                log.info('Resolved IPv6 address of the LC.')
+                break


I have the retry loop since I saw that the IPv6 name resolution was failing once, but never happened
after that. The particular use case I am currently applying this is in a daemon process which starts on boot
on a IPv4 and IPv6 system. Then I disable IPv4 and the communication with the XML-RPC proxy server
happens only over IPv6.

Thanks for the pointers earlier.
-Amit.

-- 
Amit Saha <http://echorand.me>


From p.mayers at imperial.ac.uk  Thu Dec 12 05:33:21 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Thu, 12 Dec 2013 12:33:21 +0000
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
 over IPv6
In-Reply-To: <1314654450.29770435.1386851020079.JavaMail.root@redhat.com>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
 <52A58E5D.1030809@imperial.ac.uk>
 <1005863409.27288582.1386640767922.JavaMail.root@redhat.com>
 <1314654450.29770435.1386851020079.JavaMail.root@redhat.com>
Message-ID: <52A9AD11.8070803@imperial.ac.uk>

On 12/12/13 12:23, Amit Saha wrote:
>
>
> ----- Original Message -----
>> From: "Amit Saha" <asaha at redhat.com>
>> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
>> Sent: Tuesday, December 10, 2013 11:59:27 AM
>> Subject: Re: [Twisted-Python] Queries about connecting to a XML-RPC server over IPv6
>>
>>
>>
>> ----- Original Message -----
>>> From: "Phil Mayers" <p.mayers at imperial.ac.uk>
>>> To: twisted-python at twistedmatrix.com
>>> Sent: Monday, December 9, 2013 7:33:17 PM
>>> Subject: Re: [Twisted-Python] Queries about connecting to a XML-RPC server
>>> over IPv6
>>>
>>> On 09/12/13 05:28, Amit Saha wrote:
>>>
>>>> proxy = Proxy('http://localhost6:8000')
>>>> proxy.callRemote('my_proxy_method').addCallbacks(printValue, printError)
>>>>
>>>>
>>>> When I run it, i get "No route to host: 101, Network is unreachable".
>>>>
>>>> However, 'curl -6 localhost:8000' succeeds. What could be going on here?
>>>
>>> The IPv6 support in Twisted is very new - check your version even *has*
>>> it - and it's still a work in progress. You might find that you can't do
>>> this. I'd have to read the code to be sure and I don't have time right
>>> now, but my guess is that t.w.xmlrpc isn't "getaddrinfo"-ised so won't
>>> connect to IPv6 names.
>>>
>>> If your version of Twisted supports it, you could probably work around
>>> this by sub-classing Proxy and calling reactor.connectTCP('::1', 8000)
>>> to attach the protocol yourself.
>>
>> Thanks for your reply, Phil. So, I basically modified twisted/web/xmlrpc.py
>> so that
>> when it was calling connectTCP(), i substituted '::1' in place of self.host
>> and yes the method is called successfully.
>>
>> I will consider your other hints and see if there is an easy way to work
>> around this
>> in my particular use case.
>
> I finally ended up doing this:

Just to point out this is obviously a pretty hackish way of doing it; 
for starters, getaddrinfo() is blocking, so you should use deferToThread 
at minimum.

You might want to look at:

http://twistedmatrix.com/trac/browser/tags/releases/twisted-13.2.0/twisted/internet/endpoints.py#L707

...for inspiration.


From asaha at redhat.com  Thu Dec 12 16:59:43 2013
From: asaha at redhat.com (Amit Saha)
Date: Thu, 12 Dec 2013 18:59:43 -0500 (EST)
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
 over IPv6
In-Reply-To: <52A9AD11.8070803@imperial.ac.uk>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
 <52A58E5D.1030809@imperial.ac.uk>
 <1005863409.27288582.1386640767922.JavaMail.root@redhat.com>
 <1314654450.29770435.1386851020079.JavaMail.root@redhat.com>
 <52A9AD11.8070803@imperial.ac.uk>
Message-ID: <631675229.30360621.1386892783782.JavaMail.root@redhat.com>



----- Original Message -----
> From: "Phil Mayers" <p.mayers at imperial.ac.uk>
> To: twisted-python at twistedmatrix.com
> Sent: Thursday, December 12, 2013 10:33:21 PM
> Subject: Re: [Twisted-Python] Queries about connecting to a XML-RPC server over IPv6
> 
> On 12/12/13 12:23, Amit Saha wrote:
> >
> >
> > ----- Original Message -----
> >> From: "Amit Saha" <asaha at redhat.com>
> >> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> >> Sent: Tuesday, December 10, 2013 11:59:27 AM
> >> Subject: Re: [Twisted-Python] Queries about connecting to a XML-RPC server
> >> over IPv6
> >>
> >>
> >>
> >> ----- Original Message -----
> >>> From: "Phil Mayers" <p.mayers at imperial.ac.uk>
> >>> To: twisted-python at twistedmatrix.com
> >>> Sent: Monday, December 9, 2013 7:33:17 PM
> >>> Subject: Re: [Twisted-Python] Queries about connecting to a XML-RPC
> >>> server
> >>> over IPv6
> >>>
> >>> On 09/12/13 05:28, Amit Saha wrote:
> >>>
> >>>> proxy = Proxy('http://localhost6:8000')
> >>>> proxy.callRemote('my_proxy_method').addCallbacks(printValue, printError)
> >>>>
> >>>>
> >>>> When I run it, i get "No route to host: 101, Network is unreachable".
> >>>>
> >>>> However, 'curl -6 localhost:8000' succeeds. What could be going on here?
> >>>
> >>> The IPv6 support in Twisted is very new - check your version even *has*
> >>> it - and it's still a work in progress. You might find that you can't do
> >>> this. I'd have to read the code to be sure and I don't have time right
> >>> now, but my guess is that t.w.xmlrpc isn't "getaddrinfo"-ised so won't
> >>> connect to IPv6 names.
> >>>
> >>> If your version of Twisted supports it, you could probably work around
> >>> this by sub-classing Proxy and calling reactor.connectTCP('::1', 8000)
> >>> to attach the protocol yourself.
> >>
> >> Thanks for your reply, Phil. So, I basically modified
> >> twisted/web/xmlrpc.py
> >> so that
> >> when it was calling connectTCP(), i substituted '::1' in place of
> >> self.host
> >> and yes the method is called successfully.
> >>
> >> I will consider your other hints and see if there is an easy way to work
> >> around this
> >> in my particular use case.
> >
> > I finally ended up doing this:
> 
> Just to point out this is obviously a pretty hackish way of doing it;
> for starters, getaddrinfo() is blocking, so you should use deferToThread
> at minimum.

Indeed it is very hackish. It is basically the first thing that helped me solve the problem.
> 
> You might want to look at:
> 
> http://twistedmatrix.com/trac/browser/tags/releases/twisted-13.2.0/twisted/internet/endpoints.py#L707
> 
> ...for inspiration.

Thanks, I will take a look and hopefully can modify my approach.

Best,
Amit.

-- 
Amit Saha <http://echorand.me>


From asaha at redhat.com  Thu Dec 12 20:22:50 2013
From: asaha at redhat.com (Amit Saha)
Date: Thu, 12 Dec 2013 22:22:50 -0500 (EST)
Subject: [Twisted-Python] Reliable way to check if Twisted has IPv6 support?
In-Reply-To: <1876438082.30416759.1386904668142.JavaMail.root@redhat.com>
Message-ID: <1420744804.30417894.1386904970292.JavaMail.root@redhat.com>

Hello,

I have a code path similar to:

if Twisted has IPv6:
  # do this
else:
  # do that

I came up with this: 

Using 'getattr' to get a function which wouldn't exist if there was no IPv6 address as follows:

>>> from twisted.internet import abstract
>>> getattr(abstract, 'isIPv6Address')
<function isIPv6Address at 0x171a488>

Is there a more reliable way (which works with the Twisted-8.0+) to check this?

Thanks,
Amit.


-- 
Amit Saha <http://echorand.me>


From p.mayers at imperial.ac.uk  Fri Dec 13 03:41:44 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Fri, 13 Dec 2013 10:41:44 +0000
Subject: [Twisted-Python] Reliable way to check if Twisted has IPv6
	support?
In-Reply-To: <1420744804.30417894.1386904970292.JavaMail.root@redhat.com>
References: <1420744804.30417894.1386904970292.JavaMail.root@redhat.com>
Message-ID: <52AAE468.9020801@imperial.ac.uk>

On 13/12/13 03:22, Amit Saha wrote:

> Is there a more reliable way (which works with the Twisted-8.0+) to check this?

Check the Twisted version.

You should also note that IPv6 features have appeared in multiple 
versions; HostnameEndpoint was added in 13.2.0 for example, whereas 
basic "connectTCP to IPv6 address" was added in 12.1.0, with listenTCP 
in 12.0.0

So:

import twisted

vt = (twisted.version.major, twisted.version.minor)

if vt > (13,2):
   def connectv6name(n):
     return HostnameEndpoint(...)
elif vt > (12,1):
   def connectv6name(n):
     d = myGetAddrInfo(...)
     d.addCallback(reactor.connectTCP, ...)
else:
   def connectv6name(n):
     raise Exception('twisted too old for IPv6')


From glyph at twistedmatrix.com  Fri Dec 13 06:32:22 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Fri, 13 Dec 2013 05:32:22 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
Message-ID: <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>

On Dec 12, 2013, at 12:29 AM, Tobias Oberstein <tobias.oberstein at tavendo.de> wrote:

> Hi,
> 
> I am working on Twisted Endpoint support in Autobahn https://github.com/tavendo/AutobahnPython.

Yay!

> So far, I made Autobahn able to talk WebSocket _over_ arbitrary Twisted Endpoints, e.g. WebSocket over Unix domain sockets works. This is already quite nifty.
> 
> Is there anything like Twisted Endpoints for Processes and/or Serial? Like:
> 
> endpoint = serverFromString(reactor,"process:program=/usr/local/bin/myprogram")
> 
> or
> 
> endpoint = serverFromString(reactor,"serial:port=/dev/tty1:baudrate=115000")

Yes and no.

For serial port support, see <https://twistedmatrix.com/trac/ticket/4847>.  For subprocess support, <https://twistedmatrix.com/documents/current/api/twisted.internet.endpoints.ProcessEndpoint.html>.

However, process support is unfinished, as you can see in <https://twistedmatrix.com/trac/ticket/5813>; there still needs to be a string parser plugin, so you can't do what you suggest with serverFromString.

I hope you'll poke those tickets along through the process.

> That would allow to talk WebSocket over stdin/stdout to a program or a serial conneced device. Both can be useful in certain situations.

And that would be awesome.

> I'd also like to add the other: creating an Twisted Endpoint _from_ an Autobahn server/client to be able to talk any (stream) protocol _over_ WebSocket (like SSH or VNC over WebSocket).
> 
> endpoint = serverFromString(reactor,"websocket:tcp:80:url=ws://myhostname.com/somepath")

There's totally a plugin architecture for this, and I'm excited for you to use it :-).

One quick comment though: would you be OK with using 'autobahn' as your identifier rather than 'websocket'?  There are still plans to include basic websocket support within Twisted itself and it would be a shame to start conflicting on that identifier.

> I guess I need to provide an implementation of
> http://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.ITransport.html
> 
> What else? Is there some docs or recipe?

Sadly it seems that although <http://twistedmatrix.com/documents/current/core/howto/endpoints.html> alludes to the plugin API, it doesn't actually link to it.

The way that you add a new type of endpoint to the string parser is by registering a Twisted plugin (assuming that you know how to do that) providing   <https://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.IStreamServerEndpointStringParser.html>.

Hopefully the API documentation there is helpful; from there you'll need to write implementations of IStreamServerEndpoint, IListeningPort, and ITransport; the breadcrumbs should be laid out well enough that it's pretty clear where each of those needs to be though.

Hope that helps, and thanks for actually wanting to use these plugin APIs we worked so hard on,

-glyph

From itamar at itamarst.org  Fri Dec 13 06:58:22 2013
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Fri, 13 Dec 2013 08:58:22 -0500
Subject: [Twisted-Python] twistedmatrix.com will be down at some point today
	for a RAM upgrade
Message-ID: <52AB127E.1020007@itamarst.org>

FYI.

-Itamar


From tobias.oberstein at tavendo.de  Fri Dec 13 08:09:32 2013
From: tobias.oberstein at tavendo.de (Tobias Oberstein)
Date: Fri, 13 Dec 2013 07:09:32 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
Message-ID: <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>

> > I am working on Twisted Endpoint support in Autobahn
> https://github.com/tavendo/AutobahnPython.
> 
> Yay!

Endpoints are cool.

FWIW, here is a working example of WebSocket I tested over both Unix domain sockets and the usual TCP/TLS endpoints:

https://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/echo_endpoints

This works with all features Autobahn provides like support for different WebSocket versions (Hixie-76, RFC6455) and
WebSocket extensions (like permessage-compression with deflate, snappy, bzip2).


[snip: talk on Endpoints for Serial and Process]

> I hope you'll poke those tickets along through the process.

Thanks for directions! I will have a look into those.


> There's totally a plugin architecture for this, and I'm excited for you to use it :-
> ).
> 
> One quick comment though: would you be OK with using 'autobahn' as your
> identifier rather than 'websocket'?  There are still plans to include basic
> websocket support within Twisted itself and it would be a shame to start
> conflicting on that identifier.

Sure. Can I use:

"autobahn.websocket"

?

Since Autobahn also provides other protocols (WAMP), and ..

==

Thanks for your pointers on the Endpoint plugin architecture. I guess thats enough to get me
started - modulo below .. if you could give me 1 more reply with feedback, that would be awesome!

In the meantime I did a little more thinking about WebSocket and endpoints.

I can see two approaches - which one is the way forward?


Variant 1)

endpoint = serverFromString(reactor,"autobahn.websocket: tcp:80:url=ws://myhostname.com/somepath")

Here, a single endpoint descriptor is specifying parameters for both WebSocket, and the underlying transport.

Underlying transport:
tcp:80

WebSocket overlay:
autobahn.websocket:url=ws://myhostname.com/somepath:extensions:permessage-deflate;permessage-snappy

So the plugin needs to parse not only the "overlay transport" spec, but also the underlying spec ("tcp:80") and all variants thereof?

Or can I let the existing Twisted machinery do the parsing of the underlying, and only parse off the remaining
stuff ("url=ws://myhostname.com/somepath:extensions:permessage-deflate;permessage-snappy" in this case)

And if not, does that mean not only the endpoint main identifier ("tcp" vs "unix" vs "autobahn.websocket") must
be non-overlapping, but also all the individual parameters? Like in the case for WebSocket, there is a need
for a "url" parameter.

These Qs have brought me to ..


Variant 2)

endpoint = serverFromString(reactor, "tcp:80")
wrappedEndpoint = serverFromString(reactor, endpoint, "autobahn.websocket:url=ws://myhost.com/mypath")

where I would start a program like

python myprog.py --transport "tcp:80" --wrappingTransport "autobahn.websocket:url=ws://myhost.com/mypath"

Is there such thing as a WrappingEndpoint?

==

This is yet another topic/question, but it fits here.

Twisted has defined interfaces for both stream (and datagram transports).

WebSocket is essentially a bidirectional, reliable, ordered datagram transport (with 2 payload types: binary and utf8).

Is there a Twisted Interface for such transports?

I am asking, since I am right now also refactoring the code within Autobahn that lays above raw WebSocket .. a PubSub+RPC protocol, that essentially only assumes a transport like above.

I want to make it independent of WebSocket and only assume a bidirectional, reliable, ordered, datagram transport.

Thanks a bunch for your thoughts and help!

/Tobias 


From glyph at twistedmatrix.com  Fri Dec 13 10:23:35 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Fri, 13 Dec 2013 09:23:35 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
Message-ID: <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>


On Dec 13, 2013, at 7:09 AM, Tobias Oberstein <tobias.oberstein at tavendo.de> wrote:

>>> I am working on Twisted Endpoint support in Autobahn
>> https://github.com/tavendo/AutobahnPython.
>> 
>> Yay!
> 
> Endpoints are cool.
> 
> FWIW, here is a working example of WebSocket I tested over both Unix domain sockets and the usual TCP/TLS endpoints:
> 
> https://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/echo_endpoints
> 
> This works with all features Autobahn provides like support for different WebSocket versions (Hixie-76, RFC6455) and
> WebSocket extensions (like permessage-compression with deflate, snappy, bzip2).

Cool!
> 
> Sure. Can I use:
> 
> "autobahn.websocket"?
> 
> Since Autobahn also provides other protocols (WAMP), and ..

Sure.

> endpoint = serverFromString(reactor,"autobahn.websocket: tcp:80:url=ws://myhostname.com/somepath")
> 
> Here, a single endpoint descriptor is specifying parameters for both WebSocket, and the underlying transport.
> 
> Underlying transport:
> tcp:80
> 
> WebSocket overlay:
> autobahn.websocket:url=ws://myhostname.com/somepath:extensions:permessage-deflate;permessage-snappy
> 
> So the plugin needs to parse not only the "overlay transport" spec, but also the underlying spec ("tcp:80") and all variants thereof?
> 
> Or can I let the existing Twisted machinery do the parsing of the underlying, and only parse off the remaining
> stuff ("url=ws://myhostname.com/somepath:extensions:permessage-deflate;permessage-snappy" in this case)

There's some discussion of this here: <http://twistedmatrix.com/trac/ticket/5642>.

It's probably possible, the rules are reasonably simple.

> 
> And if not, does that mean not only the endpoint main identifier ("tcp" vs "unix" vs "autobahn.websocket") must
> be non-overlapping, but also all the individual parameters?

Nope; the first one has to be non-overlapping, then you just have to decide on a definite place where the "wrapped" endpoint begins.

> Like in the case for WebSocket, there is a need
> for a "url" parameter.
> 
> These Qs have brought me to ..
> 
> 
> Variant 2)
> 
> endpoint = serverFromString(reactor, "tcp:80")
> wrappedEndpoint = serverFromString(reactor, endpoint, "autobahn.websocket:url=ws://myhost.com/mypath")
> 
> where I would start a program like
> 
> python myprog.py --transport "tcp:80" --wrappingTransport "autobahn.websocket:url=ws://myhost.com/mypath"
> 

This variant is worse because you can't change the command lines of other twistd plugins, which might be able to use websockets unchanged if you could just get it returned by serverFromString.


> Is there such thing as a WrappingEndpoint?

Not yet, no.  Comment on that ticket :).

> ==
> 
> This is yet another topic/question, but it fits here.
> 
> Twisted has defined interfaces for both stream (and datagram transports).
> 
> WebSocket is essentially a bidirectional, reliable, ordered datagram transport (with 2 payload types: binary and utf8).
> 
> Is there a Twisted Interface for such transports?

No.  Websockets are incredibly bizarre; most protocols support either arbitrarily typed data or just bytes/just text.  The hybrid weirdness of "binary" (with no additional type information) and "text" is unique.

> I am asking, since I am right now also refactoring the code within Autobahn that lays above raw WebSocket .. a PubSub+RPC protocol, that essentially only assumes a transport like above.
> 
> I want to make it independent of WebSocket and only assume a bidirectional, reliable, ordered, datagram transport.

You can do this with length prefixing, but arguably Twisted should have such an interface that can express this combination of concepts, because I think these are, technically speaking, the semantics of a UNIX datagram endpoint, but the required interface (actually a superclass, bleh) is the same as for UDP, implying unreliability.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131213/ce368ff9/attachment-0001.html>

From trac at twistedmatrix.com  Sun Dec 15 00:05:14 2013
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 15 Dec 2013 07:05:14 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1387091114.55.3153109189626201950@twistedmatrix.com

An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131215/b78880eb/attachment.html>

From sank.daniel at gmail.com  Wed Dec 18 18:38:41 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Wed, 18 Dec 2013 17:38:41 -0800
Subject: [Twisted-Python] multiple log-in / perspective broker
Message-ID: <CAKN9TDLyeBCZj+RoBZhKMAuhJSyZzYfJBmpZ-Zhu4KQu1HkWHg@mail.gmail.com>

Suppose I have a chat room application using perspective broker. Users
log in with their credentials and gain access to some kind of lobby
showing all available chat rooms. Now suppose entry into each chat
room is precluded by another log in step. How do I implement that?

I suppose I could make another realm and listen on another port but
that seems wrong.

-- 
Daniel Sank
Department of Physics
Broida Hall
University of California
Santa Barbara, CA 93117
(805)893-3899


From mwollenw at gwu.edu  Thu Dec 19 13:05:27 2013
From: mwollenw at gwu.edu (Matthew Wollenweber)
Date: Thu, 19 Dec 2013 15:05:27 -0500
Subject: [Twisted-Python] Sharing a database connection in web server
Message-ID: <CAA+Xgjd7e_LQ8DLAytZSkwLppPuLnU7-KBR=z=fyohZZVALgCw@mail.gmail.com>

Hello,

Could someone please let me know the preferred method for sharing a
database connection within a twisted.web.server instance? I've found that
adbapi is the preferred method to avoid blocking when making database
calls, however I'm still struggling how to share a database connection
within the Site.

I would like to connect to the database when the server/site is executed
and make that connection accessible to pages/classes within the Site. Could
someone offer some advice?


Thanks for the help.

-- 
Matthew Wollenweber
Principal Security Engineer
DIT/Information Security Office
The George Washington University

mwollenw at gwu.edu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131219/b3dd37a0/attachment.html>

From haggardii at gmail.com  Thu Dec 19 13:34:10 2013
From: haggardii at gmail.com (Matt Haggard)
Date: Thu, 19 Dec 2013 13:34:10 -0700
Subject: [Twisted-Python] Sharing a database connection in web server
In-Reply-To: <CAA+Xgjd7e_LQ8DLAytZSkwLppPuLnU7-KBR=z=fyohZZVALgCw@mail.gmail.com>
References: <CAA+Xgjd7e_LQ8DLAytZSkwLppPuLnU7-KBR=z=fyohZZVALgCw@mail.gmail.com>
Message-ID: <CAL+xXwMxMLB5i+w1NNZRn1ufhpjXwa1maxbikiiiHo-wYzkO5A@mail.gmail.com>

Matthew,

I've found klein to be really useful for this.  Especially the ability
to have non-global state:
https://github.com/twisted/klein#non-global-state

Matt

On Thu, Dec 19, 2013 at 1:05 PM, Matthew Wollenweber <mwollenw at gwu.edu> wrote:
> Hello,
>
> Could someone please let me know the preferred method for sharing a database
> connection within a twisted.web.server instance? I've found that adbapi is
> the preferred method to avoid blocking when making database calls, however
> I'm still struggling how to share a database connection within the Site.
>
> I would like to connect to the database when the server/site is executed and
> make that connection accessible to pages/classes within the Site. Could
> someone offer some advice?
>
>
> Thanks for the help.
>
> --
> Matthew Wollenweber
> Principal Security Engineer
> DIT/Information Security Office
> The George Washington University
>
> mwollenw at gwu.edu
>
>
>
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>


From trac at twistedmatrix.com  Sun Dec 22 00:05:15 2013
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 22 Dec 2013 07:05:15 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1387695915.12.4478994386477910343@twistedmatrix.com

An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131222/a0391715/attachment.html>

From sank.daniel at gmail.com  Fri Dec 27 17:48:33 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Fri, 27 Dec 2013 16:48:33 -0800
Subject: [Twisted-Python] multiple log-in / perspective broker
In-Reply-To: <CAKN9TDLyeBCZj+RoBZhKMAuhJSyZzYfJBmpZ-Zhu4KQu1HkWHg@mail.gmail.com>
References: <CAKN9TDLyeBCZj+RoBZhKMAuhJSyZzYfJBmpZ-Zhu4KQu1HkWHg@mail.gmail.com>
Message-ID: <CAKN9TDL7DBr_kJrdQk6t3S4eOHUkBKviu0UWwVqA4M5WDXj2FA@mail.gmail.com>

Anyone?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131227/4285cf14/attachment.html>

From itamar at itamarst.org  Fri Dec 27 22:17:50 2013
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Fri, 27 Dec 2013 21:17:50 -0800
Subject: [Twisted-Python] multiple log-in / perspective broker
In-Reply-To: <CAKN9TDL7DBr_kJrdQk6t3S4eOHUkBKviu0UWwVqA4M5WDXj2FA@mail.gmail.com>
References: <CAKN9TDLyeBCZj+RoBZhKMAuhJSyZzYfJBmpZ-Zhu4KQu1HkWHg@mail.gmail.com>
 <CAKN9TDL7DBr_kJrdQk6t3S4eOHUkBKviu0UWwVqA4M5WDXj2FA@mail.gmail.com>
Message-ID: <e277f3edf470d60c446a59844356a7a8@itamarst.org>

 

On 2013-12-27 16:48, Daniel Sank wrote: 

> Anyone?

_______________________________________________

Do your own cred login() to the new Realm, or maybe Portal if need auto
auth. Read how urgent existing login code works, it is just a thin
layer.

I can't really give a good answer when typing on this crap tablet
keyboard, if that doesn't help will try to answer more when back at
computer In a few days. Or maybe someone else can.

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131227/7f70116d/attachment.html>

From sank.daniel at gmail.com  Sat Dec 28 09:15:55 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sat, 28 Dec 2013 08:15:55 -0800
Subject: [Twisted-Python] multiple log-in / perspective broker
In-Reply-To: <e277f3edf470d60c446a59844356a7a8@itamarst.org>
References: <CAKN9TDLyeBCZj+RoBZhKMAuhJSyZzYfJBmpZ-Zhu4KQu1HkWHg@mail.gmail.com>
 <CAKN9TDL7DBr_kJrdQk6t3S4eOHUkBKviu0UWwVqA4M5WDXj2FA@mail.gmail.com>
 <e277f3edf470d60c446a59844356a7a8@itamarst.org>
Message-ID: <CAKN9TDKcba4f8iUfEPkz2n0+gWy4ZgCJ3UDHogcNH=QMX6DRwQ@mail.gmail.com>

> Do your own cred login() to the new Realm, or maybe Portal if need
> auto auth.

The way I understand currently is like this:

r = MyIRealmImplementer()
p = portal.Portal(r)
pbFactory = pb.PBServerFactory(p)
reactor.listenTCP(<port number>, pbFactory)
reactor.run()

The API documentation for Portal specifically says that each Portal
gets exactly one Realm. Therefore, I don't see how to add another
Realm to the system without another listenTCP call on a new port. Is
that what I'm supposed to do?

The reason I'm not going for the listen-on-a-new-port idea is that I'd
have as many open ports as chat rooms, which smells funny to me. What
I really want is for the client processes to receive one new Avatar
instance representing their access for each chat room into which they
enter. If this is misguided please advise.

> Read how urgent existing login code works, it is just a thin layer.

I don't understand what you mean by this. Is there a particular
example I can look at?


From itamar at itamarst.org  Sat Dec 28 09:22:39 2013
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Sat, 28 Dec 2013 08:22:39 -0800
Subject: [Twisted-Python] multiple log-in / perspective broker
In-Reply-To: <CAKN9TDKcba4f8iUfEPkz2n0+gWy4ZgCJ3UDHogcNH=QMX6DRwQ@mail.gmail.com>
References: <CAKN9TDLyeBCZj+RoBZhKMAuhJSyZzYfJBmpZ-Zhu4KQu1HkWHg@mail.gmail.com>
 <CAKN9TDL7DBr_kJrdQk6t3S4eOHUkBKviu0UWwVqA4M5WDXj2FA@mail.gmail.com>
 <e277f3edf470d60c446a59844356a7a8@itamarst.org>
 <CAKN9TDKcba4f8iUfEPkz2n0+gWy4ZgCJ3UDHogcNH=QMX6DRwQ@mail.gmail.com>
Message-ID: <e844d2218d9b16d099e2bce77fcd92f3@itamarst.org>

 

I am imagining having a remotely accessible login() method on the avatar
returned by the realm. 

I meant to say read current implementation, not "urgent". 

Written on an iPad still, sorry. 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131228/c37cf079/attachment.html>

From burak.arslan at arskom.com.tr  Sat Dec 28 10:23:37 2013
From: burak.arslan at arskom.com.tr (Burak Arslan)
Date: Sat, 28 Dec 2013 19:23:37 +0200
Subject: [Twisted-Python] Async RPC with Spyne and Twisted
Message-ID: <52BF0919.7080604@arskom.com.tr>

Hi there,

As you might remember from the PyCon sprints, I've been working on
making async rpc work within Spyne using twisted.

That work is now mostly done, so I'm looking for your feedback on
how/whether I should improve the API or its implementation.

Here's a proof of concept:

https://github.com/plq/spyne/blob/9e96d166075cc3c9b57ce5accb97efe09f98fa62/examples/twisted/resource_push.py#L55

That example currently produces a regular html table.
spyne.protocol.html.* and spyne.protocol.xml are currently the only
supported protocols. I'll be working on making  other protocols
async-compliant (without breaking compatibility with sync code) in the
coming days.

At its heart, this is making use of lxml's incremental generation
functionality, described here:
http://lxml.de/api.html#incremental-xml-generation.

Awaiting your feedback.

Best,
Burak


From exarkun at twistedmatrix.com  Sat Dec 28 10:52:10 2013
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sat, 28 Dec 2013 17:52:10 -0000
Subject: [Twisted-Python] multiple log-in / perspective broker
In-Reply-To: <e844d2218d9b16d099e2bce77fcd92f3@itamarst.org>
References: <CAKN9TDLyeBCZj+RoBZhKMAuhJSyZzYfJBmpZ-Zhu4KQu1HkWHg@mail.gmail.com>
 <CAKN9TDL7DBr_kJrdQk6t3S4eOHUkBKviu0UWwVqA4M5WDXj2FA@mail.gmail.com>
 <e277f3edf470d60c446a59844356a7a8@itamarst.org>
 <CAKN9TDKcba4f8iUfEPkz2n0+gWy4ZgCJ3UDHogcNH=QMX6DRwQ@mail.gmail.com>
 <e844d2218d9b16d099e2bce77fcd92f3@itamarst.org>
Message-ID: <20131228175210.17936.440002209.divmod.xquotient.1@top>

On 04:22 pm, itamar at itamarst.org wrote:
>
>
>I am imagining having a remotely accessible login() method on the 
>avatar
>returned by the realm.

In other words, you don't have to log in on the *root* pb object.  Login 
is just a PB method call.  You can have a second portal wrapping a 
different realm handing out different avatars and you can log in to that 
portal the second time.

Jean-Paul


From sank.daniel at gmail.com  Sat Dec 28 11:24:56 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sat, 28 Dec 2013 10:24:56 -0800
Subject: [Twisted-Python] multiple log-in / perspective broker
In-Reply-To: <20131228175210.17936.440002209.divmod.xquotient.1@top>
References: <CAKN9TDLyeBCZj+RoBZhKMAuhJSyZzYfJBmpZ-Zhu4KQu1HkWHg@mail.gmail.com>
 <CAKN9TDL7DBr_kJrdQk6t3S4eOHUkBKviu0UWwVqA4M5WDXj2FA@mail.gmail.com>
 <e277f3edf470d60c446a59844356a7a8@itamarst.org>
 <CAKN9TDKcba4f8iUfEPkz2n0+gWy4ZgCJ3UDHogcNH=QMX6DRwQ@mail.gmail.com>
 <e844d2218d9b16d099e2bce77fcd92f3@itamarst.org>
 <20131228175210.17936.440002209.divmod.xquotient.1@top>
Message-ID: <CAKN9TD+AaAu_cAM_06C4yH=5vOvEABz6yO6QeE2CQSpTDFyLxA@mail.gmail.com>

> In other words, you don't have to log in on the *root* pb object.
> Login is just a PB method call.  You can have a second portal
> wrapping a different realm handing out different avatars and you
> can log in to that portal the second time.

How can the client access that second Portal if it's not hooked up
using pb.PBServerFactory and reactor.listenTCP?

> I am imagining having a remotely accessible login() method on
> the avatar returned by the realm.

Ah, I think I understand this now. The first Avatar (the one that
lives in the Lobby) has a method like

remote_logIntoChatRoom(self, roomName, credentials, mind)

which will then invoke some kind of login method on another
Portal/Realm pair representing the specific chat room. What threw me
originally is that I didn't realize that it's ok to use the
Portal/Realm structure without a corresponding PBServerFactory and
listenTCP call.


From trac at twistedmatrix.com  Sun Dec 29 00:05:14 2013
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 29 Dec 2013 07:05:14 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1388300714.95.1706393594097096847@twistedmatrix.com

An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131229/720b36fb/attachment.html>

From sank.daniel at gmail.com  Sun Dec 29 12:28:30 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sun, 29 Dec 2013 11:28:30 -0800
Subject: [Twisted-Python] Where is trial?
Message-ID: <CAKN9TDLS=efDfE4=M32AjDgw6ZLCq3ixJmVmqKt9+QKuHVg1WA@mail.gmail.com>

I am trying to write tests for my project. According to the twisted howto
found here

http://twistedmatrix.com/documents/current/core/howto/trial.html

I should use trial. When I try to run trial from the command line (Windows)
I get the usual "that's not a program I know about" error. The howto says
that there's a twisted bin directory that should be in the path, but
looking around in my python installation, I see no such thing. I checked
lib/site-packages/twisted and /Scripts.

What am I missing here?

I installed twisted using the executable windows installer.

-Daniel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131229/305cec83/attachment.html>

From kevin.horn at gmail.com  Sun Dec 29 12:43:57 2013
From: kevin.horn at gmail.com (Kevin Horn)
Date: Sun, 29 Dec 2013 13:43:57 -0600
Subject: [Twisted-Python] Where is trial?
In-Reply-To: <CAKN9TDLS=efDfE4=M32AjDgw6ZLCq3ixJmVmqKt9+QKuHVg1WA@mail.gmail.com>
References: <CAKN9TDLS=efDfE4=M32AjDgw6ZLCq3ixJmVmqKt9+QKuHVg1WA@mail.gmail.com>
Message-ID: <CA+U=zK3RszYD6ONsfy_jnwAtmSntpHB-YuhC_1EYPu5_CcQrhw@mail.gmail.com>

On my current setup (Twisted 12.3), trial is at:

C:\Python27\Scripts\trial.py

Depending on how your system is set up, this may or may not run from the
command line without some changes.  Make sure your Scripts directory is on
the executable search path, and you may need to add the .PY extension to
your PATHEXT environment variable.

Alternatively, you can write a batch file to launch trial.

Good luck, and let us know how it turns out.


On Sun, Dec 29, 2013 at 1:28 PM, Daniel Sank <sank.daniel at gmail.com> wrote:

> I am trying to write tests for my project. According to the twisted howto
> found here
>
> http://twistedmatrix.com/documents/current/core/howto/trial.html
>
> I should use trial. When I try to run trial from the command line
> (Windows) I get the usual "that's not a program I know about" error. The
> howto says that there's a twisted bin directory that should be in the path,
> but looking around in my python installation, I see no such thing. I
> checked lib/site-packages/twisted and /Scripts.
>
> What am I missing here?
>
> I installed twisted using the executable windows installer.
>
> -Daniel
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>


-- 
--
Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131229/3fe78fe1/attachment.html>

From sank.daniel at gmail.com  Sun Dec 29 12:59:52 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sun, 29 Dec 2013 11:59:52 -0800
Subject: [Twisted-Python] Where is trial?
In-Reply-To: <CA+U=zK3RszYD6ONsfy_jnwAtmSntpHB-YuhC_1EYPu5_CcQrhw@mail.gmail.com>
References: <CAKN9TDLS=efDfE4=M32AjDgw6ZLCq3ixJmVmqKt9+QKuHVg1WA@mail.gmail.com>
 <CA+U=zK3RszYD6ONsfy_jnwAtmSntpHB-YuhC_1EYPu5_CcQrhw@mail.gmail.com>
Message-ID: <CAKN9TD+4Lo-toRMc8FpSSA4KeNaR4qJtoBtthnWgjqTispGk4Q@mail.gmail.com>

> On my current setup (Twisted 12.3), trial is at:
>
> C:\Python27\Scripts\trial.py

Oh, me too. When I read the howto I thought it was saying that there should
be a binary, eg. trial.exe somewhere. I thought that because it said the
file would be in a directory called "bin".

Now I understand.

Btw, I would submit a documentation patch for this but I still can't log
into the website.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131229/6266d7be/attachment.html>

From terry at jon.es  Sun Dec 29 22:24:37 2013
From: terry at jon.es (Terry Jones)
Date: Mon, 30 Dec 2013 05:24:37 +0000
Subject: [Twisted-Python] txdlo - a Twisted DeferredListObserver
Message-ID: <CACqnu4WX0TXKBXFq7Qv8aJSnswKF-EuBXJejCcX8XTbRi9p7UA@mail.gmail.com>

I just wrote a quick class called DeferredListObserver that lets you do
various things with a list of deferreds. You can add observers that get
passed information about the deferreds firing. You can also add deferreds
to the observed list at any time (this is very useful if you're dynamically
creating deferreds that you want to monitor).

The class can be used to easily build things like Twisted's DeferredList or
simple variants of it, or can let you separate the various behaviors of
DeferredList into simpler functions. You can also do other things that I've
occasionally wanted.  E.g., get a deferred that fires when N of the
observed deferreds have fired. Or ignore errors until one deferred
succeeds, only firing with an error if all deferreds fail. Or write a
DeferredPool with a notifyWhenEmpty method like the one I posted here about
4 years ago.

Or (a more involved example), suppose you have 3 methods that can return
you a user's avatar: a fast local cache, a filesystem, and a slow network
call to Gravatar. You want to launch all three lookups at once and use the
first answer. But if the cache and/or filesystems fails first, you don't
want an error you instead want to take the result from Gravatar and add it
to the cache and/or filesystem, as well firing a deferred with the result
(wherever it comes from). Only if all three lookups fail do you want to
receive an error.

I'll improve the examples (and probably add tests for them) at some point.
Meanwhile, the DeferredListObserver class (in txdlo.py), tests for it, and
various examples can be had from https://github.com/terrycojones/txdlo

Terry
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131230/ecc19210/attachment.html>

From hs at ox.cx  Mon Dec 30 02:37:41 2013
From: hs at ox.cx (Hynek Schlawack)
Date: Mon, 30 Dec 2013 10:37:41 +0100
Subject: [Twisted-Python] txdlo - a Twisted DeferredListObserver
In-Reply-To: <CACqnu4WX0TXKBXFq7Qv8aJSnswKF-EuBXJejCcX8XTbRi9p7UA@mail.gmail.com>
References: <CACqnu4WX0TXKBXFq7Qv8aJSnswKF-EuBXJejCcX8XTbRi9p7UA@mail.gmail.com>
Message-ID: <E96F449D-2031-4ED2-82B4-89F32C0143D7@ox.cx>

On 30 Dec 2013, at 6:24, Terry Jones wrote:

> I'll improve the examples (and probably add tests for them) at some point.
> Meanwhile, the DeferredListObserver class (in txdlo.py), tests for it, and
> various examples can be had from https://github.com/terrycojones/txdlo

That?s great! Any chance of adding a license (*cough* MIT *cough*) and putting the whole thing on PyPI?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 841 bytes
Desc: OpenPGP digital signature
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131230/ab605cd9/attachment.pgp>

From terry at jon.es  Mon Dec 30 13:20:29 2013
From: terry at jon.es (Terry Jones)
Date: Mon, 30 Dec 2013 20:20:29 +0000
Subject: [Twisted-Python] txdlo - a Twisted DeferredListObserver
In-Reply-To: <E96F449D-2031-4ED2-82B4-89F32C0143D7@ox.cx>
References: <CACqnu4WX0TXKBXFq7Qv8aJSnswKF-EuBXJejCcX8XTbRi9p7UA@mail.gmail.com>
 <E96F449D-2031-4ED2-82B4-89F32C0143D7@ox.cx>
Message-ID: <CACqnu4U5MP12uHK-eXcmPR3i0WmuiTEJW+15aoWyPaXuM3pnVw@mail.gmail.com>

Hi Hynek

> Any chance of adding a license (*cough* MIT *cough*)

Is Apache ok for you?  If not, mail me off list and I can do MIT for you.

> and putting the whole thing on PyPI?

See https://pypi.python.org/pypi/txdlo

I added a proper README, more tests, the license, setup.py etc. See
https://github.com/terrycojones/txdlo

Terry



On Mon, Dec 30, 2013 at 9:37 AM, Hynek Schlawack <hs at ox.cx> wrote:

> On 30 Dec 2013, at 6:24, Terry Jones wrote:
>
> > I'll improve the examples (and probably add tests for them) at some
> point.
> > Meanwhile, the DeferredListObserver class (in txdlo.py), tests for it,
> and
> > various examples can be had from https://github.com/terrycojones/txdlo
>
> That?s great! Any chance of adding a license (*cough* MIT *cough*) and
> putting the whole thing on PyPI?
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131230/9f29a8fb/attachment.html>

From tobias.oberstein at tavendo.de  Mon Dec 30 13:34:41 2013
From: tobias.oberstein at tavendo.de (Tobias Oberstein)
Date: Mon, 30 Dec 2013 12:34:41 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
Message-ID: <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>

Hi,

I've made Autobahn fully Endpoint aware.

You can run WebSocket over any stream-based endpoint

https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/echo_endpoints

and you can run any stream-based endpoint over WebSocket (which in turn runs over any stream-based underlying endpoint):

https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/wrapping

Endpoints are cool!

Cheers,
/Tobias

PS: Above is in the repo, but not yet released. The upcoming Autobahn 0.7.0 release will have it - as well as more, big advances.


From glyph at twistedmatrix.com  Mon Dec 30 14:41:30 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Mon, 30 Dec 2013 16:41:30 -0500
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
Message-ID: <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>


On Dec 30, 2013, at 3:34 PM, Tobias Oberstein <tobias.oberstein at tavendo.de> wrote:

> Hi,
> 
> I've made Autobahn fully Endpoint aware.
> 
> You can run WebSocket over any stream-based endpoint
> 
> https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/echo_endpoints
> 
> and you can run any stream-based endpoint over WebSocket (which in turn runs over any stream-based underlying endpoint):
> 
> https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/wrapping
> 
> Endpoints are cool!

AWESOME!!!!

I'm just thrilled at more third-party plugins starting to take advantage of this powerful extensibility API.  This looks great.

(Sorry about the somewhat poorly-thought-out syntax there, with the colons that need to be escaped all over the place; hopefully we can fix that one day somehow.)

Is there an example of doing this with 'twistd' anywhere?

-glyph

From tobias.oberstein at tavendo.de  Mon Dec 30 16:22:10 2013
From: tobias.oberstein at tavendo.de (Tobias Oberstein)
Date: Mon, 30 Dec 2013 15:22:10 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
 <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
Message-ID: <634914A010D0B943A035D226786325D4446BD1E473@EXVMBX020-12.exch020.serverdata.net>

> > Endpoints are cool!
> 
> AWESOME!!!!
> 
> I'm just thrilled at more third-party plugins starting to take advantage of this
> powerful extensibility API.  This looks great.

Thanks for endpoints! I think it's a concept in very good Unix tradition: make everything look the same (stream/endpoint). Make it transparent for users.

> (Sorry about the somewhat poorly-thought-out syntax there, with the colons
> that need to be escaped all over the place; hopefully we can fix that one day
> somehow.)

Yes;) The syntax works, but it could be nicer. Well, nothing is perfect ..

> 
> Is there an example of doing this with 'twistd' anywhere?

I was hoping you or someone could tell me how to do one;)

Thing is: I was looking for --endpoint "..." argument with twistd, but there isn't.

How is the full endpoint "vision" supposed to work out? I mean, being able to:

twistd conch --endpoint "autobahn:tcp\:80:url=ws\://myhost.com"

to run a conch server that can be accessed running SSH over WebSocket over TCP.

/Tobias

> 
> -glyph
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


From hs at ox.cx  Mon Dec 30 16:54:32 2013
From: hs at ox.cx (Hynek Schlawack)
Date: Tue, 31 Dec 2013 00:54:32 +0100
Subject: [Twisted-Python] txdlo - a Twisted DeferredListObserver
In-Reply-To: <CACqnu4U5MP12uHK-eXcmPR3i0WmuiTEJW+15aoWyPaXuM3pnVw@mail.gmail.com>
References: <CACqnu4WX0TXKBXFq7Qv8aJSnswKF-EuBXJejCcX8XTbRi9p7UA@mail.gmail.com>
 <E96F449D-2031-4ED2-82B4-89F32C0143D7@ox.cx>
 <CACqnu4U5MP12uHK-eXcmPR3i0WmuiTEJW+15aoWyPaXuM3pnVw@mail.gmail.com>
Message-ID: <57F2A258-7BCB-4812-8B87-D1C166C6C49E@ox.cx>

Hey Terry,

On 30 Dec 2013, at 21:20, Terry Jones wrote:

>> Any chance of adding a license (*cough* MIT *cough*)
> Is Apache ok for you?  If not, mail me off list and I can do MIT for 
> you.

Apache is just fine for me ? I use it for structlog too. I was 
suggesting MIT because that?s Twisted?s license.

>> and putting the whole thing on PyPI?
>
> See https://pypi.python.org/pypi/txdlo
>
> I added a proper README, more tests, the license, setup.py etc. See
> https://github.com/terrycojones/txdlo

Great, now I can play with it!

?h

P.S. if I can pester you any further: I?d appreciate a wheel and you 
can have a more useful PyPI entry by including the README ? see 
<self-promotion> 
https://hynek.me/articles/sharing-your-labor-of-love-pypi-quick-and-dirty/ 
</self-promotion>


From hs at ox.cx  Mon Dec 30 16:56:47 2013
From: hs at ox.cx (Hynek Schlawack)
Date: Tue, 31 Dec 2013 00:56:47 +0100
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <634914A010D0B943A035D226786325D4446BD1E473@EXVMBX020-12.exch020.serverdata.net>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
 <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BD1E473@EXVMBX020-12.exch020.serverdata.net>
Message-ID: <60EA9E3E-1294-4C6B-A7FA-FFAC1C677C55@ox.cx>

On 31 Dec 2013, at 0:22, Tobias Oberstein wrote:

>> Is there an example of doing this with 'twistd' anywhere?
>
> I was hoping you or someone could tell me how to do one;)
>
> Thing is: I was looking for --endpoint "..." argument with twistd, but 
> there isn't.
>
> How is the full endpoint "vision" supposed to work out? I mean, being 
> able to:
>
> twistd conch --endpoint "autobahn:tcp\:80:url=ws\://myhost.com"
>
> to run a conch server that can be accessed running SSH over WebSocket 
> over TCP.

FWIW, the argument you?re looking for is usually called ?--port?.  
The most obvious example is the web plugin.


From terry at jon.es  Mon Dec 30 19:50:12 2013
From: terry at jon.es (Terry Jones)
Date: Tue, 31 Dec 2013 02:50:12 +0000
Subject: [Twisted-Python] txdlo - a Twisted DeferredListObserver
In-Reply-To: <57F2A258-7BCB-4812-8B87-D1C166C6C49E@ox.cx>
References: <CACqnu4WX0TXKBXFq7Qv8aJSnswKF-EuBXJejCcX8XTbRi9p7UA@mail.gmail.com>
 <E96F449D-2031-4ED2-82B4-89F32C0143D7@ox.cx>
 <CACqnu4U5MP12uHK-eXcmPR3i0WmuiTEJW+15aoWyPaXuM3pnVw@mail.gmail.com>
 <57F2A258-7BCB-4812-8B87-D1C166C6C49E@ox.cx>
Message-ID: <CACqnu4Xmc6ZY_VAb4Fwq++DEgc3jz1f0sHCzJVDgE_yRBjqKbw@mail.gmail.com>

Hi Hynek

On Mon, Dec 30, 2013 at 11:54 PM, Hynek Schlawack <hs at ox.cx> wrote:

> if I can pester you any further: I?d appreciate a wheel and you can have a
> more useful PyPI entry


Thanks for your PyPI guide, it's great.  I updated to include a wheel. I
tried about 5 different ways to get it to install package data (README,
LICENSE), and failed on every attempt (I actually made this work once in
the distant past, after several hours of reading and trying). [Rant
suppressed.] I'd appreciate any further thoughts/tips re setup.py, but
maybe they're better off list.

Terry
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-python/attachments/20131231/e7e2003d/attachment.html>

From tobias.oberstein at tavendo.de  Tue Dec 31 03:41:36 2013
From: tobias.oberstein at tavendo.de (Tobias Oberstein)
Date: Tue, 31 Dec 2013 02:41:36 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <60EA9E3E-1294-4C6B-A7FA-FFAC1C677C55@ox.cx>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
 <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BD1E473@EXVMBX020-12.exch020.serverdata.net>
 <60EA9E3E-1294-4C6B-A7FA-FFAC1C677C55@ox.cx>
Message-ID: <634914A010D0B943A035D226786325D4446BD1E499@EXVMBX020-12.exch020.serverdata.net>

> > Thing is: I was looking for --endpoint "..." argument with twistd, but
> > there isn't.
> >
> > How is the full endpoint "vision" supposed to work out? I mean, being
> > able to:
> >
> > twistd conch --endpoint "autobahn:tcp\:80:url=ws\://myhost.com"
> >
> > to run a conch server that can be accessed running SSH over WebSocket
> > over TCP.
> 
> FWIW, the argument you?re looking for is usually called ?--port?.
> The most obvious example is the web plugin.

Thanks! That's what I was missing.

It works: I can run

twistd -n telnet --port "autobahn:tcp\:9000:url=ws\://localhost\:9000"

and access the Python shell from a browser:

http://picpaste.com/Clipboard23-fJfJCg7E.png

I'll write a small Telnet client in JS .. and will post a complete example.

This is cool=)

/Tobias

From haggardii at gmail.com  Tue Dec 31 07:36:02 2013
From: haggardii at gmail.com (Matt Haggard)
Date: Tue, 31 Dec 2013 07:36:02 -0700
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <634914A010D0B943A035D226786325D4446BD1E499@EXVMBX020-12.exch020.serverdata.net>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
 <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BD1E473@EXVMBX020-12.exch020.serverdata.net>
 <60EA9E3E-1294-4C6B-A7FA-FFAC1C677C55@ox.cx>
 <634914A010D0B943A035D226786325D4446BD1E499@EXVMBX020-12.exch020.serverdata.net>
Message-ID: <CAL+xXwN5bp3NS28smWVe8Pge1C1omHGaobHY2TDrkKW5v7T+LA@mail.gmail.com>

Tobias,

That's neat!  Endpoints rock.  I'd like to put this up on
twistedftw.org -- I look forward to your complete example.

Matt

On Tue, Dec 31, 2013 at 3:41 AM, Tobias Oberstein
<tobias.oberstein at tavendo.de> wrote:
>> > Thing is: I was looking for --endpoint "..." argument with twistd, but
>> > there isn't.
>> >
>> > How is the full endpoint "vision" supposed to work out? I mean, being
>> > able to:
>> >
>> > twistd conch --endpoint "autobahn:tcp\:80:url=ws\://myhost.com"
>> >
>> > to run a conch server that can be accessed running SSH over WebSocket
>> > over TCP.
>>
>> FWIW, the argument you?re looking for is usually called ?--port?.
>> The most obvious example is the web plugin.
>
> Thanks! That's what I was missing.
>
> It works: I can run
>
> twistd -n telnet --port "autobahn:tcp\:9000:url=ws\://localhost\:9000"
>
> and access the Python shell from a browser:
>
> http://picpaste.com/Clipboard23-fJfJCg7E.png
>
> I'll write a small Telnet client in JS .. and will post a complete example.
>
> This is cool=)
>
> /Tobias
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


From tobias.oberstein at tavendo.de  Tue Dec 31 11:33:33 2013
From: tobias.oberstein at tavendo.de (Tobias Oberstein)
Date: Tue, 31 Dec 2013 10:33:33 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
 <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
Message-ID: <634914A010D0B943A035D226786325D4446BD1E62F@EXVMBX020-12.exch020.serverdata.net>

> Is there an example of doing this with 'twistd' anywhere?

I've added a generic endpoint forwarder plugin for twistd to Autobahn:

The example also includes a Terminal running in a browser, which talks over WebSocket
to the endpoint forwarder in twistd, which forwards the traffic to a Telnet server:

http://picpaste.com/Clipboard24-LLwRCPKG.png
https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/wrapping#endpoint-forwarder

In other words: this shows that endpoint plugins can be combined with twistd plugins.

The forwarder should be able to forward between any pair of Twisted stream server endpoint
to any stream client endpoint.

As soon as the Process endpoints are ready (the parsing), this would allows to expose programs stdin/stdout to WebSocket eg.
Or access any serial device over WebSocket (when serial endpoints are there).

This functionality is the equivalent (actually a superset) of the following projects:

https://github.com/kanaka/websockify
https://github.com/joewalnes/websocketd

Cheers,
/Tobias

PS 1: I couldn't get Manhole fully working with the JS Terminal:
https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/wrapping#manhole

PS 2: the forwarder is _generic_
https://github.com/tavendo/AutobahnPython/blob/master/autobahn/autobahn/twisted/forwarder.py
and probably should not be part of Autobahn but Twisted. And it should be robustified;)




From tobias.oberstein at tavendo.de  Tue Dec 31 11:36:23 2013
From: tobias.oberstein at tavendo.de (Tobias Oberstein)
Date: Tue, 31 Dec 2013 10:36:23 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <CAL+xXwN5bp3NS28smWVe8Pge1C1omHGaobHY2TDrkKW5v7T+LA@mail.gmail.com>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
 <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BD1E473@EXVMBX020-12.exch020.serverdata.net>
 <60EA9E3E-1294-4C6B-A7FA-FFAC1C677C55@ox.cx>
 <634914A010D0B943A035D226786325D4446BD1E499@EXVMBX020-12.exch020.serverdata.net>
 <CAL+xXwN5bp3NS28smWVe8Pge1C1omHGaobHY2TDrkKW5v7T+LA@mail.gmail.com>
Message-ID: <634914A010D0B943A035D226786325D4446BD1E630@EXVMBX020-12.exch020.serverdata.net>

Matt,

> That's neat!  Endpoints rock.  I'd like to put this up on twistedftw.org -- I look
> forward to your complete example.

Great! All examples and all code is here

https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/wrapping

and here

https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/echo_endpoints

Cheers,
/Tobias


From exarkun at twistedmatrix.com  Tue Dec 31 12:01:37 2013
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Tue, 31 Dec 2013 19:01:37 -0000
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <634914A010D0B943A035D226786325D4446BD1E62F@EXVMBX020-12.exch020.serverdata.net>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
 <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BD1E62F@EXVMBX020-12.exch020.serverdata.net>
Message-ID: <20131231190137.17936.1642533781.divmod.xquotient.6@top>

On 06:33 pm, tobias.oberstein at tavendo.de wrote:
>>Is there an example of doing this with 'twistd' anywhere?
>
>I've added a generic endpoint forwarder plugin for twistd to Autobahn:
>
>The example also includes a Terminal running in a browser, which talks 
>over WebSocket
>to the endpoint forwarder in twistd, which forwards the traffic to a 
>Telnet server:
>
>http://picpaste.com/Clipboard24-LLwRCPKG.png
>https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/wrapping 
>#endpoint-forwarder
>
>In other words: this shows that endpoint plugins can be combined with 
>twistd plugins.
>
>The forwarder should be able to forward between any pair of Twisted 
>stream server endpoint
>to any stream client endpoint.
>
>As soon as the Process endpoints are ready (the parsing), this would 
>allows to expose programs stdin/stdout to WebSocket eg.
>Or access any serial device over WebSocket (when serial endpoints are 
>there).
>
>This functionality is the equivalent (actually a superset) of the 
>following projects:
>
>https://github.com/kanaka/websockify
>https://github.com/joewalnes/websocketd
>
>Cheers,
>/Tobias
>
>PS 1: I couldn't get Manhole fully working with the JS Terminal:
>https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/wrapping#manhole
>
>PS 2: the forwarder is _generic_
>https://github.com/tavendo/AutobahnPython/blob/master/autobahn/autobahn/twisted/forwarder.py
>and probably should not be part of Autobahn but Twisted. And it should 
>be robustified;)

Indeed.  This should ultimately be what `twistd portforward` offers. :)

https://twistedmatrix.com/trac/ticket/4927 is related.

Jean-Paul


From trac at twistedmatrix.com  Sun Dec  1 00:05:23 2013
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 01 Dec 2013 07:05:23 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1385881523.27.1963325935536378357@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131201/984e7c5a/attachment-0002.html>

From grindizer at gmail.com  Sun Dec  1 05:12:56 2013
From: grindizer at gmail.com (Flint)
Date: Sun, 1 Dec 2013 13:12:56 +0100
Subject: [Twisted-Python] Unpersistable instead of pb.Avatar
In-Reply-To: <CAKN9TDLgv9Q91u8dnzL8e7eB3mSFKZ=jw1c4whJU9-zOsdHYdw@mail.gmail.com>
References: <CAKN9TDLgv9Q91u8dnzL8e7eB3mSFKZ=jw1c4whJU9-zOsdHYdw@mail.gmail.com>
Message-ID: <CALpq1pbD84jVR_5m+AxP4G-Pnti=PuHY45QHxO7rv4oufUoUHA@mail.gmail.com>

Hi,

How do I fix this and actually send out new perspectives to users?
>

pb.Avatar is not a Referenceable object, the object which is sent when a
client login is a wrapper againt the pb.Avatar object built like this:

// pb.py L1327
   if not IJellyable.providedBy(avatar):
           avatar = AsReferenceable(avatar, "perspective")

So I suppose you can wrap your avatars object just like this before sending
them, "OR" you can make you own implementation of "an avatar" (implementing
IPerspective interface) and make it IJellyable at first place.

It doesn't make sense to use the same perspective in
> both games


I don't see why not personally.
Your Avatar is supposed to represente a "user" after that, it is up to you
to define what a "User" is for your application.
If a "user" is a "physical person", so your avatar could play several games
at once, your avatar could then have a list of "played games" (for
examples).
If your "user" is a couple of ("physical person"  + "a game") so each
person playing a game will represent a different "user" in the point of
view of your application.
etc.

it would be nice to separate
> the responsibilities of the user from those of the "player."
>

As I said the avatar or the user has the responsabilites that you will give
to it. I don't think Twisted makes any asumption about that (IMHO).

--
Nacim.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131201/e1e1edfb/attachment-0002.html>

From sank.daniel at gmail.com  Sun Dec  1 09:25:29 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sun, 1 Dec 2013 08:25:29 -0800
Subject: [Twisted-Python] Unpersistable instead of pb.Avatar
In-Reply-To: <CALpq1pbD84jVR_5m+AxP4G-Pnti=PuHY45QHxO7rv4oufUoUHA@mail.gmail.com>
References: <CAKN9TDLgv9Q91u8dnzL8e7eB3mSFKZ=jw1c4whJU9-zOsdHYdw@mail.gmail.com>
 <CALpq1pbD84jVR_5m+AxP4G-Pnti=PuHY45QHxO7rv4oufUoUHA@mail.gmail.com>
Message-ID: <CAKN9TDLJ+up3FNafH6jDrLoaZCXBMYMm32ADQ1VkN4GO5ezX_g@mail.gmail.com>

>> It doesn't make sense to use the same perspective in
>> both games
>>
> I don't see why not personally.

I can think of two reasons. First, suppose that I would like to
participate in two different games of chess at the same time. Suppose
my Avatar class has a method for moving the chess pieces

perspective_movePjece(startSquare, endSquare)

If it is possible that this Avatar is playing more than one game then
this method doesn't have enough context to get the job done. Either I
have to use two method calls

perspective_selectGame(nameOfGameICareAboutNow):
    self.nameOfSelectedGame = nameOfGameICareAboutNow

perspective_movePiece(startSquare, endSquare)

or I have to require that the client side call pass in the game as an argument

perspective.callRemote("movePiece", startSquare, endSquare, whichGame)

I find both of these unsatisfying. In the first case I've basically
reverted to a remote procedure call style interface with calls that
aren't even atomic, and in the second I require the user to explicitly
declare the context of the call. This seems to miss the point of
remote objects. I'd much rather have the games be instances of
Viewable and have different perspectives into each one so that
invocations of callRemote on my references to those Viewables
automatically come with the proper context. This is why I want
multiple Avatars per human user.

The second reason is that one human may want to play as two distinct
players in the same game. In that case I need to be able to change my
client side representation of the published objects as the human
switches between the players. Here again we need multiple perspectives
to get the job done.

> Your Avatar is supposed to represente a "user" after that,
> it is up to you to define what a "User" is for your application.
> If a "user" is a "physical person", so your avatar could play
> several games at once, your avatar could then have a list of
> "played games" (for examples).

I explain above why I don't like this solution.

> If your "user" is a couple of ("physical person"  + "a game")
> so each person playing a game will represent a different
> "user" in the point of view of your application.

This lumps the "user" and the "player", which I would like to avoid.

> So I suppose you can wrap your avatars object just like
> this before sending them, "OR" you can make you own
> implementation of "an avatar" (implementing IPerspective
> interface) and make it IJellyable at first place.

That's interesting. Thanks.



From sank.daniel at gmail.com  Mon Dec  2 12:45:06 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Mon, 2 Dec 2013 11:45:06 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
Message-ID: <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>

> One way to fix this is to manually construct a ViewPoint rather than a Viewable and pass that to the client.

For the sake of trying to get my current project to work and so that I
can understand what's really going on and fix the bugs in pb: how
would I do the similar thing for a Cacheable? Looking at the source so
far I'm having trouble figuring out where things like Viewable come
into play.



From yangyouxiu at gmail.com  Tue Dec  3 02:56:11 2013
From: yangyouxiu at gmail.com (yangyouxiu)
Date: Tue, 3 Dec 2013 17:56:11 +0800
Subject: [Twisted-Python] How to get callback return value
Message-ID: <2013120317560387491630@gmail.com>

Hi,all!

On call main method, it call self.getName() in A.py, as I use callback, I can not get the return value correctly, I thought it's because the Asynchronous attribute, how should i do?

B.py
main:
name=self.getName()


A.py
def getname():
def.callback(method1)
def.callback(method2)
def.callback(success)
return self.name

def success(name):
self.name=name


Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131203/cd324e23/attachment-0002.html>

From sank.daniel at gmail.com  Tue Dec  3 03:07:34 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Tue, 3 Dec 2013 02:07:34 -0800
Subject: [Twisted-Python] How to get callback return value
In-Reply-To: <2013120317560387491630@gmail.com>
References: <2013120317560387491630@gmail.com>
Message-ID: <CAKN9TDJdDW+H7Bce0U6EKJCzAP55z39aNRB-EjtMXihKiTwVMA@mail.gmail.com>

The code you included in your email doesn't make sense. Please include
a full working (with errors) code sample and then people can help you.

Also, I _highly_ recommend that you read this:

http://krondo.com/?page_id=1327

It might as well be considered the official n00b intro to Twisted, imho.



From yangyouxiu at gmail.com  Tue Dec  3 05:00:30 2013
From: yangyouxiu at gmail.com (=?GB2312?B?0e7T0NDj?=)
Date: Tue, 3 Dec 2013 20:00:30 +0800
Subject: [Twisted-Python] How to get callback return value
In-Reply-To: <CAKN9TDJdDW+H7Bce0U6EKJCzAP55z39aNRB-EjtMXihKiTwVMA@mail.gmail.com>
References: <2013120317560387491630@gmail.com>
 <CAKN9TDJdDW+H7Bce0U6EKJCzAP55z39aNRB-EjtMXihKiTwVMA@mail.gmail.com>
Message-ID: <CA+5=JMfQg+SNcNdA+ygYGM-c4iSRDJE--muc0PfjVG3hD4Or2Q@mail.gmail.com>

Thanks very much. Following is the traceback message and source code.

=> Traceback (most recent call last):
  File "/home/20131203-Client/src/NodeConfigurator.py", line 250, in
__slotSelectionChanged
    self.__showConfigurationPage(last_item,  0)
  File "/home/20131203-Client/src/NodeConfigurator.py", line 294, in
__showConfigurationPage
    self.showConfigurationPageByName(itm)
  File "/home/20131203-Client/src/NodeConfigurator.py", line 345, in
showConfigurationPageByName
    page.loadConfig(itm.getIDs()[0],  itm.tmpConfig)
  File "/home/20131203-Client/src/Ui/ConfigurationPages/Page_Circle.py",
line 125, in loadConfig
    self.textLabel_Platform.setText(platform)
TypeError: QLabel.setText(QString): argument 1 has unexpected type
'NoneType'
1111fff
Circle

Source code:
/home/20131203-Client/src/Ui/ConfigurationPages/Page_Circle.py

def loadConfig(self, id, config = None):
        """ Load the config
        """

        platform = node.get_platform()
self.textLabel_Platform.setText(platform)


/home/20131203-Client/src/node.py

def get_platform(self):
        """ Returns node type
        """

        self.node.addCallback(self.get_model)
        self.node.addCallback(self.success)
        return self.model


    def get_model(self, object):
        model=object.callRemote("getModel")
        return model

    def success(self, model):
        print '1111fff'
        print model
        self.model=model
        return self.model




2013/12/3 Daniel Sank <sank.daniel at gmail.com>

> The code you included in your email doesn't make sense. Please include
> a full working (with errors) code sample and then people can help you.
>
> Also, I _highly_ recommend that you read this:
>
> http://krondo.com/?page_id=1327
>
> It might as well be considered the official n00b intro to Twisted, imho.
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131203/b4bcff21/attachment-0002.html>

From _ at lvh.io  Tue Dec  3 06:19:53 2013
From: _ at lvh.io (Laurens Van Houtven)
Date: Tue, 3 Dec 2013 14:19:53 +0100
Subject: [Twisted-Python] Unit testing AMP responder method registration
Message-ID: <CAE_Hg6anwU01cbdW-hxAMuRA2vd2psPPS+V84+QhPjaW25Sx-A@mail.gmail.com>

Hi!

I'm trying to write code using TDD and AMP. I'm trying to figure out how to
write a unit test for:

@MyCommand.responder

Specifically, I would assume that test:

1. Tests that the responder locator has a responder for MyCommand;
2. That responder matches the decorated method

(1) is easy, (2) not so much. Since usually the responder locator gives me
this nasty "doit" function that isn't introspectable (unless
it.func_closure[0].cell_contents.im_func counts as "introspection"), I'm
not sure how to write that unit test.

I do have end-to-end tests for this, obviously: I would like to also have
regular tests :)

thanks in advance
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131203/dc456540/attachment-0002.html>

From sank.daniel at gmail.com  Tue Dec  3 10:31:01 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Tue, 3 Dec 2013 09:31:01 -0800
Subject: [Twisted-Python] How to get callback return value
In-Reply-To: <CA+5=JMfQg+SNcNdA+ygYGM-c4iSRDJE--muc0PfjVG3hD4Or2Q@mail.gmail.com>
References: <2013120317560387491630@gmail.com>
 <CAKN9TDJdDW+H7Bce0U6EKJCzAP55z39aNRB-EjtMXihKiTwVMA@mail.gmail.com>
 <CA+5=JMfQg+SNcNdA+ygYGM-c4iSRDJE--muc0PfjVG3hD4Or2Q@mail.gmail.com>
Message-ID: <CAKN9TDLtrY8_MsYMc8yVvjp0NjmCLOmCt+Wo175eC57UH+jqGw@mail.gmail.com>

this is not a complete working example. There's no executable code,
and what you included doesn't make sense.

When people ask for a complete working example it means that they want
to try to run the same program that you're running. Just attach your
actual source files to an email and send them.

>From reading the code you pasted in your email it really looks like
you aren't using deferreds correctly. Did you read the tutorial I
linked in the other email?



From peter.westlake at pobox.com  Tue Dec  3 12:36:31 2013
From: peter.westlake at pobox.com (Peter Westlake)
Date: Tue, 03 Dec 2013 19:36:31 +0000
Subject: [Twisted-Python] How to get callback return value
In-Reply-To: <CA+5=JMfQg+SNcNdA+ygYGM-c4iSRDJE--muc0PfjVG3hD4Or2Q@mail.gmail.com>
References: <2013120317560387491630@gmail.com>
 <CAKN9TDJdDW+H7Bce0U6EKJCzAP55z39aNRB-EjtMXihKiTwVMA@mail.gmail.com>
 <CA+5=JMfQg+SNcNdA+ygYGM-c4iSRDJE--muc0PfjVG3hD4Or2Q@mail.gmail.com>
Message-ID: <1386099391.28432.55080489.14F8BFD1@webmail.messagingengine.com>

On Tue, Dec 3, 2013, at 12:00, 杨有秀 wrote:

> def loadConfig(self, id, config = None):
>         """ Load the config
>         """
> 
>         platform = node.get_platform()
> self.textLabel_Platform.setText(platform)
> 
> 
> /home/20131203-Client/src/node.py
> 
> def get_platform(self):
>         """ Returns node type
>         """
> 
>         self.node.addCallback(self.get_model)
>         self.node.addCallback(self.success)
>         return self.model

addCallback is a method of twisted.internet.defer.Deferred,
but I don't think your node is a Deferred.

>     def get_model(self, object):
>         model=object.callRemote("getModel")
>         return model

This looks as though it will return a Deferred, from the callRemote.
If that isn't the case, ignore everything else below.

So you might write:

def get_platform(self):
        """ Returns node type
        """
        self.model = self.get_model()
        self.model.addCallback(self.success)
        return self.model

    def success(self, model):
        print '1111fff'
        return model

And then you could use the value returned by get_platform (which is a
Deferred)
by adding a callback to it:

def loadConfig(self, id, config = None):
        """ Load the config
        """
        node.get_platform().addCallback(self.textLabel_Platform.setText)

When the callRemote succeeds, it calls the callbacks on the Deferred.
First, it passes the return value from the remote call to success().
Then
it passes the return value from success() to textLabel_Platform.setText.

Peter.



From sank.daniel at gmail.com  Tue Dec  3 23:08:15 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Tue, 3 Dec 2013 22:08:15 -0800
Subject: [Twisted-Python] website login not working?
Message-ID: <CAKN9TD+_zrSEBiybw9PyVpPfzLZyViLf9cd4195Sddv0J4-GGg@mail.gmail.com>

I just tried logging into the website to place some tickets and found
that my login doesn't work. I got a password reset but still no dice.
Anyone else having this problem?

-- 
Daniel Sank
Department of Physics
Broida Hall
University of California
Santa Barbara, CA 93117
(805)893-3899



From exarkun at twistedmatrix.com  Wed Dec  4 01:02:26 2013
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Wed, 04 Dec 2013 08:02:26 -0000
Subject: [Twisted-Python] Unit testing AMP responder method registration
In-Reply-To: <CAE_Hg6anwU01cbdW-hxAMuRA2vd2psPPS+V84+QhPjaW25Sx-A@mail.gmail.com>
References: <CAE_Hg6anwU01cbdW-hxAMuRA2vd2psPPS+V84+QhPjaW25Sx-A@mail.gmail.com>
Message-ID: <20131204080226.5970.990320751.divmod.xquotient.2@top>

On 3 Dec, 01:19 pm, _ at lvh.io wrote:
>Hi!
>
>I'm trying to write code using TDD and AMP. I'm trying to figure out 
>how to
>write a unit test for:
>
>@MyCommand.responder
>
>Specifically, I would assume that test:
>
>1. Tests that the responder locator has a responder for MyCommand;
>2. That responder matches the decorated method
>
>(1) is easy, (2) not so much. Since usually the responder locator gives 
>me
>this nasty "doit" function that isn't introspectable (unless
>it.func_closure[0].cell_contents.im_func counts as "introspection"), 
>I'm
>not sure how to write that unit test.
>
>I do have end-to-end tests for this, obviously: I would like to also 
>have
>regular tests :)

Here's what I've done:

https://bazaar.launchpad.net/~game- 
hackers/game/trunk/view/head:/game/test/test_network.py#L418

Jean-Paul



From glyph at twistedmatrix.com  Wed Dec  4 07:26:29 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Wed, 4 Dec 2013 06:26:29 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
Message-ID: <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>


On Dec 2, 2013, at 11:45 AM, Daniel Sank <sank.daniel at gmail.com> wrote:

>> One way to fix this is to manually construct a ViewPoint rather than a Viewable and pass that to the client.
> 
> For the sake of trying to get my current project to work and so that I
> can understand what's really going on and fix the bugs in pb: how
> would I do the similar thing for a Cacheable? Looking at the source so
> far I'm having trouble figuring out where things like Viewable come
> into play.

This isn't quite as clean as with ViewPoint, but it's not all that bad either.  Basically, you need to inject the correct perspective into the RemoteCacheObserver which is constructed; unfortunately it reads it only from the jellier.

So: fix the jellier :-).

So something like this might do the trick:

class Perspectiveize(Jellyable):
    def __init__(self, perspective, obj):
        self.perspective = perspective
        self.obj = obj
    def jellyFor(self, jellier):
        old = jellier.invoker.serializingPerspective
        jellier.invoker.serializingPerspective = self.perspective
        try:
            return self.obj.jellyFor(jellier)
        finally:
            jellier.invoker.serializingPerspective = old

Untested, but I think it should do the trick.  One caveat though; if the 'obj' (in your case, Cacheable) that you wrap with this is serialized twice within the same top-level call to 'jelly', (i.e. if there are multiple references to it from within a single return message or remote method call) the second time it is serialized, it will simply serialize a reference to the first; this means you have to be careful to be sure that the Perspectiveize object is serialized before the Cacheable itself if the Cacheable is to be serialized at all.

Good luck,

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131204/89326649/attachment-0002.html>

From _ at lvh.io  Wed Dec  4 08:06:31 2013
From: _ at lvh.io (Laurens Van Houtven)
Date: Wed, 4 Dec 2013 16:06:31 +0100
Subject: [Twisted-Python] Unit testing AMP responder method registration
In-Reply-To: <20131204080226.5970.990320751.divmod.xquotient.2@top>
References: <CAE_Hg6anwU01cbdW-hxAMuRA2vd2psPPS+V84+QhPjaW25Sx-A@mail.gmail.com>
 <20131204080226.5970.990320751.divmod.xquotient.2@top>
Message-ID: <CAE_Hg6YWY_HDncTHo0Jvn7i=P6Cho=3O25wBDDnSGYugv00n6A@mail.gmail.com>

On Wed, Dec 4, 2013 at 9:02 AM, <exarkun at twistedmatrix.com> wrote:

> https://bazaar.launchpad.net/~game- hackers/game/trunk/view/head:/
> game/test/test_network.py#L418
>


Thanks! I'll see how I can incorporate this. It does seem like the obvious
test. Right now this is more spread out in my tests: I currently test the
locator directly and the command separately.

cheers
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131204/ee5da792/attachment-0002.html>

From grickert at coldstorage.com  Wed Dec  4 11:29:23 2013
From: grickert at coldstorage.com (Gerrat Rickert)
Date: Wed, 4 Dec 2013 18:29:23 +0000
Subject: [Twisted-Python] Filing Bugs
Message-ID: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>

I'd like to file a bug, but the site requires a login.

I'm sure I've registered before, but don't remember my username or password.
Neither the "login" link or "Register" link has any information about how to reset a password.
Nor is it present on the home page, or in the FAQ.

...although the Register link does state that:
"Entering an email address will enable you to reset your password if you ever forget it."
(I'm pretty sure I did enter an email address when I registered ages ago)

I assume there's something obvious that I'm missing, but it's flying below my visual radar, because I've tried looking everywhere
on the site.

I give up...can someone point me to the page/link where I can reset my password (to http://twistedmatrix.com - not the mailing list - resetting my password on the mailing list is obvious and straightforward).

Thanks,
                Gerrat

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131204/e84a1d43/attachment-0002.html>

From sank.daniel at gmail.com  Wed Dec  4 11:40:56 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Wed, 4 Dec 2013 10:40:56 -0800
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
Message-ID: <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>

> I assume there’s something obvious that I’m missing, but it’s flying below my visual radar, because I’ve tried looking everywhere on the site.

I had exactly this problem last night. I googled "twisted password
reset" and found this page

http://twistedmatrix.com/trac/reset_password

I got it to send me a reset password, but that password didn't work
(as explained in my mailing list post I sent last night).



From grickert at coldstorage.com  Wed Dec  4 15:16:13 2013
From: grickert at coldstorage.com (Gerrat Rickert)
Date: Wed, 4 Dec 2013 22:16:13 +0000
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
Message-ID: <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>

> > I assume there's something obvious that I'm missing, but it's flying
> below my visual radar, because I've tried looking everywhere on the
> site.
> 
> I had exactly this problem last night. I googled "twisted password
> reset" and found this page
> 
> http://twistedmatrix.com/trac/reset_password
> 
> I got it to send me a reset password, but that password didn't work (as
> explained in my mailing list post I sent last night).


So, since I couldn't remember my username from before, I decided to just register for a new account.
During registration, it informed me:
"Warning: Another account or group already exists, who's name differs from <my name> only by case or is identical"

So I was likely just trying to re-use the same username...
It then took a few tries to guess at the right case for the previous username I had used.

...and so finally, I hit upon the right case, and it sent me an email with a new password

*Which (as you've mentioned) doesn't work.*

I've filed a website bug about the whole issue (should probably be 3 separate bugs, but I really don't have the patience):
https://bugs.launchpad.net/twisted-website/+bug/1257934




From sank.daniel at gmail.com  Wed Dec  4 15:23:41 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Wed, 4 Dec 2013 14:23:41 -0800
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
 <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
Message-ID: <CAKN9TDJgmHvy5mtw9HY5QR_HGUuGdQ-jmFNRY1d5xF24zF2Q5g@mail.gmail.com>

> I've filed a website bug about the whole issue (should probably be 3 separate bugs, but I really don't have the patience):

Thanks. I have bunch of functionality and documentation bugs in
twisted.spread.pb to report but as things are right now I can't.



From itamar at itamarst.org  Thu Dec  5 07:12:04 2013
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Thu, 05 Dec 2013 14:12:04 +0000
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <CAKN9TDJgmHvy5mtw9HY5QR_HGUuGdQ-jmFNRY1d5xF24zF2Q5g@mail.gmail.com>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
 <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
 <CAKN9TDJgmHvy5mtw9HY5QR_HGUuGdQ-jmFNRY1d5xF24zF2Q5g@mail.gmail.com>
Message-ID: <4c02675ce966c4cd2e0acfdf5939a960@itamarst.org>

 

I'm travelling for work this week, but if no one fixes it by the time
I'm back I'll see what I can figure out. Trac is terrible :( 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131205/55756efc/attachment-0002.html>

From tom.prince at ualberta.net  Fri Dec  6 01:17:24 2013
From: tom.prince at ualberta.net (Tom Prince)
Date: Fri, 06 Dec 2013 08:17:24 +0000
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
 <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
Message-ID: <87txemjsvf.fsf@loki.hocat.ca>

Gerrat Rickert <grickert at coldstorage.com> writes:

> ...and so finally, I hit upon the right case, and it sent me an email with a new password

Have you checked your spam folder? Looking at the mail logs, it appears
a mail was sent at 2013-12-04 14:02:11 MST.

  Tom



From grickert at coldstorage.com  Fri Dec  6 06:23:07 2013
From: grickert at coldstorage.com (Gerrat Rickert)
Date: Fri, 6 Dec 2013 13:23:07 +0000
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <87txemjsvf.fsf@loki.hocat.ca>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
 <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
 <87txemjsvf.fsf@loki.hocat.ca>
Message-ID: <25CB87184063F24C9BDD8C5E3566EA257AEC6CA8@kit-ex01.coldstorage.com>

> > ...and so finally, I hit upon the right case, and it sent me an email
> > with a new password
> 
> Have you checked your spam folder? Looking at the mail logs, it appears
> a mail was sent at 2013-12-04 14:02:11 MST.
> 

Sounds right...I got the email around 2013-12-04 16:02:11 EST

It contained my username and a password.  
The username/password sent in the email doesn't work.
[Daniel Sank mentioned this same thing - maybe we weren't explicit enough]

I just tried logging into trac again (with emailed user/pass).
It still doesn't work.




From sank.daniel at gmail.com  Fri Dec  6 09:16:03 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Fri, 6 Dec 2013 08:16:03 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
Message-ID: <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>

> class Perspectiveize(Jellyable):
>     def __init__(self, perspective, obj):
>         self.perspective = perspective
>         self.obj = obj
>     def jellyFor(self, jellier):
>         old = jellier.invoker.serializingPerspective
>         jellier.invoker.serializingPerspective = self.perspective
>         try:
>             return self.obj.jellyFor(jellier)
>         finally:
>             jellier.invoker.serializingPerspective = old
>

That did work, and it helped my understand a bit more about how pb works.

Now that I have workarounds for the problems I had with pb I'd like to
try to actually modify the source to make things easier. I still can't
log into the website but as soon as that's fixed I'll get started
filing tickets etc.



From sank.daniel at gmail.com  Sat Dec  7 10:30:36 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sat, 7 Dec 2013 09:30:36 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
Message-ID: <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>

Glyph,

It seems to me that the right way to fix this issue with being able to
pass Cacheable and Viewable instances as arguments to mind.callRemote
methods would be to "attach" a perspective to that mind, possibly
during login (with a means for doing in manually as well). As soon as
that though crossed my mind I remembered that I've seen "attach" and
"detach" floating around in the pb documentation as if it were once
upon a time a real part of the API, but sort of fizzled or was never
really adopted.I would appreciate your comment on this to help me
understand the state of pb and whether my idea of how to proceed is
correct?



From sank.daniel at gmail.com  Sat Dec  7 13:28:22 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sat, 7 Dec 2013 12:28:22 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
 <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
Message-ID: <CAKN9TDJVbUDq5AP8=Zk5P6o0OVyBJ3EBrnxf9syq04SMk5MLGQ@mail.gmail.com>

I'm posting this for future hapless n00bs like myself who find this
thread while trying to grok perspective broker.

> It seems to me that the right way to fix this issue with being able to
> pass Cacheable and Viewable instances as arguments to mind.callRemote
> methods would be to "attach" a perspective to that mind, possibly
> during login (with a means for doing in manually as well).

By looking around in the source code and doing more experiments I have
figured out that you can just do this

mind.perspective = thePerspectiveIWantToAssociateWithThisMind

All subsequent serializations of Viewables and Cacheables work exactly
as they should.

This seems like a totally reasonable and simple way to fix the issue
presented at the start of this thread. Interestingly, this isn't
explained in the howto, and seems to have been forgotten by the
developers (or this is a bad solution for reasons I don't understand).

When the website is working again I'll file a documentation ticket (and fix it).



From trac at twistedmatrix.com  Sun Dec  8 00:05:21 2013
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 08 Dec 2013 07:05:21 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1386486321.11.2578535019025855265@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131208/6cdfda03/attachment-0002.html>

From glyph at twistedmatrix.com  Sun Dec  8 03:15:22 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Sun, 8 Dec 2013 02:15:22 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
 <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
Message-ID: <6BB59D03-76D0-40AC-AF3E-2647B5B37254@twistedmatrix.com>


On Dec 7, 2013, at 9:30 AM, Daniel Sank <sank.daniel at gmail.com> wrote:

> Glyph,
> 
> It seems to me that the right way to fix this issue with being able to
> pass Cacheable and Viewable instances as arguments to mind.callRemote
> methods would be to "attach" a perspective to that mind, possibly
> during login (with a means for doing in manually as well).

The mind might be any object, or it might be no object (i.e. None).  This is confusingly documented, as remote_loginAnonymous is the only thing that explicitly spells it out, but given that it's a remote thing coming from the client, and no type-checking is performed, that's implicitly what it is.

> As soon as
> that though crossed my mind I remembered that I've seen "attach" and
> "detach" floating around in the pb documentation as if it were once
> upon a time a real part of the API, but sort of fizzled or was never
> really adopted.

This part of PB was removed many years ago, and references in the documentation ought to be removed as well.

> I would appreciate your comment on this to help me
> understand the state of pb and whether my idea of how to proceed is
> correct?

In the case where a 'mind' object has a callRemote method, it's one of two things: a RemoteReference or a RemoteCacheObserver.  Both of these have a (public, given its name, but not super well documented) "perspective" attribute which triggers the serialization behavior you want when calling callRemote.  So 'attaching' that perspective is as simple of setting the attribute.  In your application, I think just setting that attribute is a much better idea than the craziness that I was suggesting with a custom Perspectivize class, and perhaps actually better than manually constructing a ViewPoint, since it generalizes completely to the whole serialization process.

What's slightly more problematic is making this general.  You have to fully deserialize the mind object before login, because it's explicitly provided in order to allow cred implementations to interact with the client during login.  And since you don't know what the avatar is before it's time to log in, there's no way to deserialize it in this way!

This is important if your Mind object were to be a custom Copyable that contained more than one RemoteReference, and, for example, had its own callRemote which could dispatch to different ones depending on what it's being asked to do.

So how about this:

Introduce a new custom interface, IHaveAPerspective (name intentionally terrible so I don't get hung up on naming it well); and then, in _cbLogin, do 'if IHaveAPerspective.providedBy(mind): mind.perspective = avatar'. (Be sure to get the right avatar, of course, the one before it's wrapped in an AsReferenceable.)  If someone had a more elaborately constructed mind object than a RemoteReference, then they could implement the interface and write a property that set it on all the relevant references.

Then, RemoteReference and RemoteCacheObserver can implement this new interface.

For compatibility reasons, you might need to make this behavior disabled by default.  But hey, it would be nice to have a public name for _PortalRoot rather than relying on adapter magic to construct one, so that new name could just do this by default.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131208/6276a892/attachment-0002.html>

From glyph at twistedmatrix.com  Sun Dec  8 03:16:51 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Sun, 8 Dec 2013 02:16:51 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDJVbUDq5AP8=Zk5P6o0OVyBJ3EBrnxf9syq04SMk5MLGQ@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
 <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
 <CAKN9TDJVbUDq5AP8=Zk5P6o0OVyBJ3EBrnxf9syq04SMk5MLGQ@mail.gmail.com>
Message-ID: <7F2DB907-1274-467F-8CA4-704A27FF2F58@twistedmatrix.com>


On Dec 7, 2013, at 12:28 PM, Daniel Sank <sank.daniel at gmail.com> wrote:

> I'm posting this for future hapless n00bs like myself who find this
> thread while trying to grok perspective broker.
> 
>> It seems to me that the right way to fix this issue with being able to
>> pass Cacheable and Viewable instances as arguments to mind.callRemote
>> methods would be to "attach" a perspective to that mind, possibly
>> during login (with a means for doing in manually as well).
> 
> By looking around in the source code and doing more experiments I have
> figured out that you can just do this
> 
> mind.perspective = thePerspectiveIWantToAssociateWithThisMind

Oops, I wrote my previous reply without having seen this message! :-).

And yes, I'd totally forgotten that that's a way to do it, because the documentation is horrible and it's been years since I worked on a PB-based application.  I would strongly encourage you to contribute documentation enhancements that add the requisite level of docstring coverage to PB.

Thanks for your interest so far.

-glyph




From sank.daniel at gmail.com  Sun Dec  8 08:46:27 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sun, 8 Dec 2013 07:46:27 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <7F2DB907-1274-467F-8CA4-704A27FF2F58@twistedmatrix.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
 <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
 <CAKN9TDJVbUDq5AP8=Zk5P6o0OVyBJ3EBrnxf9syq04SMk5MLGQ@mail.gmail.com>
 <7F2DB907-1274-467F-8CA4-704A27FF2F58@twistedmatrix.com>
Message-ID: <CAKN9TDL+8RB2cPSsMgojEXCt=EB7hF-_EjVzX=3kVfm5D0XAwA@mail.gmail.com>

> I would strongly encourage you to contribute documentation enhancements that add the requisite level of docstring coverage to PB.

Eagerly awaiting for the website login to work so I can do that.

> it's been years since I worked on a PB-based application.

I would like to know, is there anyone else who knows how pb works, or
is it mostly just you (glyph)?



From sank.daniel at gmail.com  Sun Dec  8 08:56:25 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sun, 8 Dec 2013 07:56:25 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDL+8RB2cPSsMgojEXCt=EB7hF-_EjVzX=3kVfm5D0XAwA@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
 <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
 <CAKN9TDJVbUDq5AP8=Zk5P6o0OVyBJ3EBrnxf9syq04SMk5MLGQ@mail.gmail.com>
 <7F2DB907-1274-467F-8CA4-704A27FF2F58@twistedmatrix.com>
 <CAKN9TDL+8RB2cPSsMgojEXCt=EB7hF-_EjVzX=3kVfm5D0XAwA@mail.gmail.com>
Message-ID: <CAKN9TDLqX4PvBmv0bFbgY5RVm4RDFXgie7G2LC6jGa82+Tgnxg@mail.gmail.com>

> I would like to know, is there anyone else who knows how pb works,
> or is it mostly just you (glyph)?

I'm asking this just to get a feel for who's who among twisted
developers, not for any other reason. To be clear your help has been
awesome and I really appreciate it very much! :)



From asaha at redhat.com  Sun Dec  8 22:28:47 2013
From: asaha at redhat.com (Amit Saha)
Date: Mon, 9 Dec 2013 00:28:47 -0500 (EST)
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server over
	IPv6
In-Reply-To: <1714995926.26426627.1386566496496.JavaMail.root@redhat.com>
Message-ID: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>

Hello,

I am trying to connect to a local XML-RPC server with IPv4 *disabled*. Here is my script:

from twisted.web.xmlrpc import Proxy
from twisted.internet import reactor

def printValue(value):
    print repr(value)
    reactor.stop()

def printError(error):
    print 'error', error
    reactor.stop()

proxy = Proxy('http://localhost6:8000')
proxy.callRemote('my_proxy_method').addCallbacks(printValue, printError)


When I run it, i get "No route to host: 101, Network is unreachable".

However, 'curl -6 localhost:8000' succeeds. What could be going on here?
I am using Twisted-12.2 on Fedora 19.

Thanks for any insights.

Best,
Amit.

-- 
Amit Saha <http://echorand.me>



From asaha at redhat.com  Sun Dec  8 22:34:27 2013
From: asaha at redhat.com (Amit Saha)
Date: Mon, 9 Dec 2013 00:34:27 -0500 (EST)
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
 over	IPv6
In-Reply-To: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
Message-ID: <793295191.26431528.1386567267794.JavaMail.root@redhat.com>



----- Original Message -----
> From: "Amit Saha" <asaha at redhat.com>
> To: twisted-python at twistedmatrix.com
> Sent: Monday, December 9, 2013 3:28:47 PM
> Subject: [Twisted-Python] Queries about connecting to a XML-RPC server over	IPv6
> 
> Hello,
> 
> I am trying to connect to a local XML-RPC server with IPv4 *disabled*. Here
> is my script:
> 
> from twisted.web.xmlrpc import Proxy
> from twisted.internet import reactor
> 
> def printValue(value):
>     print repr(value)
>     reactor.stop()
> 
> def printError(error):
>     print 'error', error
>     reactor.stop()
> 
> proxy = Proxy('http://localhost6:8000')
> proxy.callRemote('my_proxy_method').addCallbacks(printValue, printError)
> 
> 
> When I run it, i get "No route to host: 101, Network is unreachable".
> 
> However, 'curl -6 localhost:8000' succeeds. What could be going on here?
> I am using Twisted-12.2 on Fedora 19.

That should be, 'curl -6 localhost6:8000'.




From p.mayers at imperial.ac.uk  Mon Dec  9 02:33:17 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Mon, 09 Dec 2013 09:33:17 +0000
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
 over IPv6
In-Reply-To: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
Message-ID: <52A58E5D.1030809@imperial.ac.uk>

On 09/12/13 05:28, Amit Saha wrote:

> proxy = Proxy('http://localhost6:8000')
> proxy.callRemote('my_proxy_method').addCallbacks(printValue, printError)
>
>
> When I run it, i get "No route to host: 101, Network is unreachable".
>
> However, 'curl -6 localhost:8000' succeeds. What could be going on here?

The IPv6 support in Twisted is very new - check your version even *has* 
it - and it's still a work in progress. You might find that you can't do 
this. I'd have to read the code to be sure and I don't have time right 
now, but my guess is that t.w.xmlrpc isn't "getaddrinfo"-ised so won't 
connect to IPv6 names.

If your version of Twisted supports it, you could probably work around 
this by sub-classing Proxy and calling reactor.connectTCP('::1', 8000) 
to attach the protocol yourself.



From glyph at twistedmatrix.com  Mon Dec  9 06:26:37 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Mon, 9 Dec 2013 05:26:37 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDLqX4PvBmv0bFbgY5RVm4RDFXgie7G2LC6jGa82+Tgnxg@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
 <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
 <CAKN9TDJVbUDq5AP8=Zk5P6o0OVyBJ3EBrnxf9syq04SMk5MLGQ@mail.gmail.com>
 <7F2DB907-1274-467F-8CA4-704A27FF2F58@twistedmatrix.com>
 <CAKN9TDL+8RB2cPSsMgojEXCt=EB7hF-_EjVzX=3kVfm5D0XAwA@mail.gmail.com>
 <CAKN9TDLqX4PvBmv0bFbgY5RVm4RDFXgie7G2LC6jGa82+Tgnxg@mail.gmail.com>
Message-ID: <1E816ADC-29F8-4DA4-AD27-ED3E0C4B977A@twistedmatrix.com>


On Dec 8, 2013, at 7:56 AM, Daniel Sank <sank.daniel at gmail.com> wrote:

>> I would like to know, is there anyone else who knows how pb works,
>> or is it mostly just you (glyph)?
> 
> I'm asking this just to get a feel for who's who among twisted
> developers, not for any other reason. To be clear your help has been
> awesome and I really appreciate it very much! :)

I'm sure that several other core developers understand how it works, but as long as I'm answering your questions promptly there's no reason for them to pop their heads in ;).

-glyph




From glyph at twistedmatrix.com  Mon Dec  9 06:27:14 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Mon, 9 Dec 2013 05:27:14 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDL+8RB2cPSsMgojEXCt=EB7hF-_EjVzX=3kVfm5D0XAwA@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
 <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
 <CAKN9TDJVbUDq5AP8=Zk5P6o0OVyBJ3EBrnxf9syq04SMk5MLGQ@mail.gmail.com>
 <7F2DB907-1274-467F-8CA4-704A27FF2F58@twistedmatrix.com>
 <CAKN9TDL+8RB2cPSsMgojEXCt=EB7hF-_EjVzX=3kVfm5D0XAwA@mail.gmail.com>
Message-ID: <634E782A-7A42-4A71-A3EE-47147E544D65@twistedmatrix.com>


On Dec 8, 2013, at 7:46 AM, Daniel Sank <sank.daniel at gmail.com> wrote:

>> I would strongly encourage you to contribute documentation enhancements that add the requisite level of docstring coverage to PB.
> 
> Eagerly awaiting for the website login to work so I can do that.

What exactly is the problem with login?  I skimmed another message where you complained, but then I tried to log in myself and it worked so I assumed the issue was temporary and had been fixed.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131209/9cfe7606/attachment-0002.html>

From glyph at twistedmatrix.com  Mon Dec  9 06:28:55 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Mon, 9 Dec 2013 05:28:55 -0800
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
	over IPv6
In-Reply-To: <52A58E5D.1030809@imperial.ac.uk>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
 <52A58E5D.1030809@imperial.ac.uk>
Message-ID: <F9D98C1F-CAD9-43A7-9211-35F82A06CED1@twistedmatrix.com>

On Dec 9, 2013, at 1:33 AM, Phil Mayers <p.mayers at imperial.ac.uk> wrote:

> The IPv6 support in Twisted is very new - check your version even *has* it - and it's still a work in progress. You might find that you can't do this. I'd have to read the code to be sure and I don't have time right now, but my guess is that t.w.xmlrpc isn't "getaddrinfo"-ised so won't connect to IPv6 names.
> 
> If your version of Twisted supports it, you could probably work around this by sub-classing Proxy and calling reactor.connectTCP('::1', 8000) to attach the protocol yourself.

Worth noting, of course, that Proxy not working with IPv6 is a bug.  Please file it as such.  (It seems like HostnameEndpoint could totally do the trick...)

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131209/69daef50/attachment-0002.html>

From p.mayers at imperial.ac.uk  Mon Dec  9 07:54:59 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Mon, 09 Dec 2013 14:54:59 +0000
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
 over IPv6
In-Reply-To: <F9D98C1F-CAD9-43A7-9211-35F82A06CED1@twistedmatrix.com>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
 <52A58E5D.1030809@imperial.ac.uk>
 <F9D98C1F-CAD9-43A7-9211-35F82A06CED1@twistedmatrix.com>
Message-ID: <52A5D9C3.3060606@imperial.ac.uk>

On 09/12/13 13:28, Glyph wrote:
> On Dec 9, 2013, at 1:33 AM, Phil Mayers <p.mayers at imperial.ac.uk
> <mailto:p.mayers at imperial.ac.uk>> wrote:
>
>> The IPv6 support in Twisted is very new - check your version even
>> *has* it - and it's still a work in progress. You might find that you
>> can't do this. I'd have to read the code to be sure and I don't have
>> time right now, but my guess is that t.w.xmlrpc isn't
>> "getaddrinfo"-ised so won't connect to IPv6 names.
>>
>> If your version of Twisted supports it, you could probably work around
>> this by sub-classing Proxy and calling reactor.connectTCP('::1', 8000)
>> to attach the protocol yourself.
>
> Worth noting, of course, that Proxy not working with IPv6 is a bug.

Opened #6870



From p.mayers at imperial.ac.uk  Mon Dec  9 08:01:16 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Mon, 09 Dec 2013 15:01:16 +0000
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
 over IPv6
In-Reply-To: <52A5D9C3.3060606@imperial.ac.uk>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
 <52A58E5D.1030809@imperial.ac.uk>
 <F9D98C1F-CAD9-43A7-9211-35F82A06CED1@twistedmatrix.com>
 <52A5D9C3.3060606@imperial.ac.uk>
Message-ID: <52A5DB3C.4060609@imperial.ac.uk>

On 09/12/13 14:54, Phil Mayers wrote:
> On 09/12/13 13:28, Glyph wrote:
>> On Dec 9, 2013, at 1:33 AM, Phil Mayers <p.mayers at imperial.ac.uk
>> <mailto:p.mayers at imperial.ac.uk>> wrote:
>>
>>> The IPv6 support in Twisted is very new - check your version even
>>> *has* it - and it's still a work in progress. You might find that you
>>> can't do this. I'd have to read the code to be sure and I don't have
>>> time right now, but my guess is that t.w.xmlrpc isn't
>>> "getaddrinfo"-ised so won't connect to IPv6 names.
>>>
>>> If your version of Twisted supports it, you could probably work around
>>> this by sub-classing Proxy and calling reactor.connectTCP('::1', 8000)
>>> to attach the protocol yourself.
>>
>> Worth noting, of course, that Proxy not working with IPv6 is a bug.
>
> Opened #6870
>

Also #6871 for IPv6 literal URLs, but maybe the whole xmlrpc code should 
be moved to the new web.client code, and move all that logic in there?



From sank.daniel at gmail.com  Mon Dec  9 10:43:26 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Mon, 9 Dec 2013 09:43:26 -0800
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <25CB87184063F24C9BDD8C5E3566EA257AEC6CA8@kit-ex01.coldstorage.com>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
 <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
 <87txemjsvf.fsf@loki.hocat.ca>
 <25CB87184063F24C9BDD8C5E3566EA257AEC6CA8@kit-ex01.coldstorage.com>
Message-ID: <CAKN9TDKJRcma_irLeE-YG6zuLoVnQ2ab5X+Yoga30rDLB+9zdg@mail.gmail.com>

This is an update because glyph asked about this issue in another
thread but I want to put the information where it belongs:

1. Try to log in. Does not accept credentials (login box simply
reappears with username and password fields blank).

2. Cannot find a password reset option. Scratch head.

3. Google "twisted password reset". Find this page:
http://twistedmatrix.com/trac/reset_password.

4. Ask for password reset. Receive email.

5. Try new password, goto 1.



From sank.daniel at gmail.com  Mon Dec  9 10:45:33 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Mon, 9 Dec 2013 09:45:33 -0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <634E782A-7A42-4A71-A3EE-47147E544D65@twistedmatrix.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
 <CAKN9TDJeswWiutcN1FVv=v03fSvCu1sSTVT2RDXthrk8uhQ+Ug@mail.gmail.com>
 <925D310F-59DA-4B43-BCC3-DBE63FD18C62@twistedmatrix.com>
 <CAKN9TDLTb80wjD36iDa99GtZH+sEXva3eXWrhYXK5E0vc10YNg@mail.gmail.com>
 <CAKN9TD+e8g-p3SNt9pmNeVqkWPDnp9=Be9oNsDHnyZyyHjkwZg@mail.gmail.com>
 <0978F6A1-DF4B-44B0-A6E3-7FA72BE9F1E1@twistedmatrix.com>
 <CAKN9TDL035TP8jwC-YLTp++SRD-Jot91e4TgMeCd_Ar-YpVQEQ@mail.gmail.com>
 <CAKN9TDKhpNx=CwPZTTrYHgdaJswGiXyydou+LEwQiNYoqFkMaQ@mail.gmail.com>
 <CAKN9TDJVbUDq5AP8=Zk5P6o0OVyBJ3EBrnxf9syq04SMk5MLGQ@mail.gmail.com>
 <7F2DB907-1274-467F-8CA4-704A27FF2F58@twistedmatrix.com>
 <CAKN9TDL+8RB2cPSsMgojEXCt=EB7hF-_EjVzX=3kVfm5D0XAwA@mail.gmail.com>
 <634E782A-7A42-4A71-A3EE-47147E544D65@twistedmatrix.com>
Message-ID: <CAKN9TD+L+mv=bz_VVgDRjFHu+JWnN5nAJa4y+i22Vkh7Yp2mUQ@mail.gmail.com>

> What exactly is the problem with login?

In an effort to stay on topic and reduce mailing list entropy I just
responded to this question in another thread that was about the broken
log-in.



From wenxiang at zopim.com  Mon Dec  9 10:49:47 2013
From: wenxiang at zopim.com (Wenxiang Wu)
Date: Tue, 10 Dec 2013 01:49:47 +0800
Subject: [Twisted-Python] Do Viewables absolutely have to be return'ed
	by Avatars?
In-Reply-To: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
References: <CAKN9TDK-Pe8JWFPQqk7L3aQ0CtOKfrotkJ3C786q7O51bejZwg@mail.gmail.com>
Message-ID: <CAGr0=+GYrEFECA__A98h2+B0TUJD29RM0T=q2pc3_4W_r0mWVg@mail.gmail.com>

I'm
On Nov 21, 2013 7:56 AM, "Daniel Sank" <sank.daniel at gmail.com> wrote:

> From some experimentation I find that the only way to make a Viewable
> get a meaningful perspective argument when executing view_* methods is
> to make sure that the references to that Viewable are given to clients
> as return values from perspective_* methods called on a pb.Avatar.
>
> In particular, if the Avatar gives a client a reference to a Viewable
> by passing it as an argument to a remote_* method on the client,
> subsequent invocations of view_* methods by the client result in
> perspective argument in view_* methods being None.
>
> I have attached a complete working example of a client and server that
> succinctly illustrates this issue.
>
> Question: Is there a way to distribute un-asked for references to
> Viewables that properly get the perspective argument in their view_*
> methods?
>
> Sincerely,
> Daniel Sank
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131210/05ff2a6b/attachment-0002.html>

From _ at lvh.io  Mon Dec  9 15:19:21 2013
From: _ at lvh.io (Laurens Van Houtven)
Date: Mon, 9 Dec 2013 23:19:21 +0100
Subject: [Twisted-Python] ISSLTransport.getPeerCertificate returning None?
Message-ID: <CAE_Hg6ZPsLdGoW-QvcA5sVU4ikU1c76odh6_HDD9r55A8PcdxQ@mail.gmail.com>

Hi!


I'm trying to authenticate a client by looking at their SSL certificate.
I'm calling it from within an AMP responder (so, there's bytes going over
the TLS transport already), and it's still None, so this is unrelated to
calling it in connectionMade. That leads me to believe my client is doing
something wrong...

I've followed the SSL howto on how to write a client that sends a client
cert:

https://twistedmatrix.com/documents/current/core/howto/ssl.html#auto9

My client is here:

https://gist.github.com/lvh/d8d9f0b530d07a087da4

... but in the server's AMP protocol, self.transport.getPeerCertificate()
is still None :/

Any idea what's going on?

cheers
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131209/692068e2/attachment-0002.html>

From asaha at redhat.com  Mon Dec  9 18:59:27 2013
From: asaha at redhat.com (Amit Saha)
Date: Mon, 9 Dec 2013 20:59:27 -0500 (EST)
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
 over IPv6
In-Reply-To: <52A58E5D.1030809@imperial.ac.uk>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
 <52A58E5D.1030809@imperial.ac.uk>
Message-ID: <1005863409.27288582.1386640767922.JavaMail.root@redhat.com>



----- Original Message -----
> From: "Phil Mayers" <p.mayers at imperial.ac.uk>
> To: twisted-python at twistedmatrix.com
> Sent: Monday, December 9, 2013 7:33:17 PM
> Subject: Re: [Twisted-Python] Queries about connecting to a XML-RPC server over IPv6
> 
> On 09/12/13 05:28, Amit Saha wrote:
> 
> > proxy = Proxy('http://localhost6:8000')
> > proxy.callRemote('my_proxy_method').addCallbacks(printValue, printError)
> >
> >
> > When I run it, i get "No route to host: 101, Network is unreachable".
> >
> > However, 'curl -6 localhost:8000' succeeds. What could be going on here?
> 
> The IPv6 support in Twisted is very new - check your version even *has*
> it - and it's still a work in progress. You might find that you can't do
> this. I'd have to read the code to be sure and I don't have time right
> now, but my guess is that t.w.xmlrpc isn't "getaddrinfo"-ised so won't
> connect to IPv6 names.
> 
> If your version of Twisted supports it, you could probably work around
> this by sub-classing Proxy and calling reactor.connectTCP('::1', 8000)
> to attach the protocol yourself.

Thanks for your reply, Phil. So, I basically modified twisted/web/xmlrpc.py so that
when it was calling connectTCP(), i substituted '::1' in place of self.host
and yes the method is called successfully.

I will consider your other hints and see if there is an easy way to work around this
in my particular use case.


Thanks,
Amit.


-- 
Amit Saha <http://echorand.me>



From p.mayers at imperial.ac.uk  Tue Dec 10 01:41:08 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Tue, 10 Dec 2013 08:41:08 +0000
Subject: [Twisted-Python] ISSLTransport.getPeerCertificate returning
	None?
In-Reply-To: <CAE_Hg6ZPsLdGoW-QvcA5sVU4ikU1c76odh6_HDD9r55A8PcdxQ@mail.gmail.com>
References: <CAE_Hg6ZPsLdGoW-QvcA5sVU4ikU1c76odh6_HDD9r55A8PcdxQ@mail.gmail.com>
Message-ID: <52A6D3A4.7010406@imperial.ac.uk>

On 09/12/13 22:19, Laurens Van Houtven wrote:

> ... but in the server's AMP protocol,
> self.transport.getPeerCertificate() is still None :/

Unless you set the appropriate verify options on the server side too, 
the client cert isn't available for inspection.



From _ at lvh.io  Tue Dec 10 02:21:02 2013
From: _ at lvh.io (Laurens Van Houtven)
Date: Tue, 10 Dec 2013 10:21:02 +0100
Subject: [Twisted-Python] ISSLTransport.getPeerCertificate returning
	None?
In-Reply-To: <52A6D3A4.7010406@imperial.ac.uk>
References: <CAE_Hg6ZPsLdGoW-QvcA5sVU4ikU1c76odh6_HDD9r55A8PcdxQ@mail.gmail.com>
 <52A6D3A4.7010406@imperial.ac.uk>
Message-ID: <CAE_Hg6bPdQ=BqSzFQYfTQG03u4hxnCtKex3AseH4sBcgNyvBdQ@mail.gmail.com>

On Tue, Dec 10, 2013 at 9:41 AM, Phil Mayers <p.mayers at imperial.ac.uk>wrote:

> Unless you set the appropriate verify options on the server side too, the
> client cert isn't available for inspection.
>

A-ha! But I want to do TOFU-POP; the certs are generated by the client, and
there's little point in me signing them (I don't need to be able to verify
that I ever signed them somewhere else).

The context factory I got from PrivateCertificate.options() doesn't seem to
do what I want, so I wrote my own SSL ContextFactory like it's 1999; I used
VERIFY_PEER with a callback that always claims it validated:

class ContextFactory(object):
    def getContext(self):
        ctx = Context(TLSv1_METHOD)
        ctx.use_certificate_file("cert.pem")
        ctx.use_privatekey_file("key.pem")
        ctx.set_verify(VERIFY_PEER, _verify)
        return ctx



def _verify(connection, x509, errorNumber, errorDepth, returnCode):
    """Always pretend the certificate verified.

    """
    return True


Does that sound about right, or is there an easier way to do this? (Yeah,
yeah, don't hardcode paths etc :))

cheers
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131210/bf7837ec/attachment-0002.html>

From exarkun at twistedmatrix.com  Tue Dec 10 06:21:41 2013
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Tue, 10 Dec 2013 13:21:41 -0000
Subject: [Twisted-Python] ISSLTransport.getPeerCertificate returning
	None?
In-Reply-To: <52A6D3A4.7010406@imperial.ac.uk>
References: <CAE_Hg6ZPsLdGoW-QvcA5sVU4ikU1c76odh6_HDD9r55A8PcdxQ@mail.gmail.com>
 <52A6D3A4.7010406@imperial.ac.uk>
Message-ID: <20131210132141.6396.1418941768.divmod.xquotient.0@top>

On 08:41 am, p.mayers at imperial.ac.uk wrote:
>On 09/12/13 22:19, Laurens Van Houtven wrote:
>>... but in the server's AMP protocol,
>>self.transport.getPeerCertificate() is still None :/
>
>Unless you set the appropriate verify options on the server side too, 
>the client cert isn't available for inspection.

twisted.internet.ssl.CertificateOptions sets these by default.  If you 
use it, you shouldn't need to do anything else.

Jean-Paul



From p.mayers at imperial.ac.uk  Tue Dec 10 06:51:44 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Tue, 10 Dec 2013 13:51:44 +0000
Subject: [Twisted-Python] ISSLTransport.getPeerCertificate returning
	None?
In-Reply-To: <20131210132141.6396.1418941768.divmod.xquotient.0@top>
References: <CAE_Hg6ZPsLdGoW-QvcA5sVU4ikU1c76odh6_HDD9r55A8PcdxQ@mail.gmail.com>
 <52A6D3A4.7010406@imperial.ac.uk>
 <20131210132141.6396.1418941768.divmod.xquotient.0@top>
Message-ID: <52A71C70.5070108@imperial.ac.uk>

On 10/12/13 13:21, exarkun at twistedmatrix.com wrote:
> On 08:41 am, p.mayers at imperial.ac.uk wrote:
>> On 09/12/13 22:19, Laurens Van Houtven wrote:
>>> ... but in the server's AMP protocol,
>>> self.transport.getPeerCertificate() is still None :/
>>
>> Unless you set the appropriate verify options on the server side too,
>> the client cert isn't available for inspection.
>
> twisted.internet.ssl.CertificateOptions sets these by default.  If you
> use it, you shouldn't need to do anything else.

Are you sure about that? It does not match my recollection.



From _ at lvh.io  Tue Dec 10 07:01:47 2013
From: _ at lvh.io (Laurens Van Houtven)
Date: Tue, 10 Dec 2013 15:01:47 +0100
Subject: [Twisted-Python] ISSLTransport.getPeerCertificate returning
	None?
In-Reply-To: <52A71C70.5070108@imperial.ac.uk>
References: <CAE_Hg6ZPsLdGoW-QvcA5sVU4ikU1c76odh6_HDD9r55A8PcdxQ@mail.gmail.com>
 <52A6D3A4.7010406@imperial.ac.uk>
 <20131210132141.6396.1418941768.divmod.xquotient.0@top>
 <52A71C70.5070108@imperial.ac.uk>
Message-ID: <CAE_Hg6YWp3y-nzvrQ237prB3vVGPoh_FP976oxLoqD8sTO635w@mail.gmail.com>

Somehow, JP's e-mail did not make it into my inbox :-(

Anyway, using the context factory that I got
from ssl.PrivateCertificate.options() (which I think is
CertificateOptions), I wasn't able to inspect the peer certificate. That's
on 13.2. Using the context factory I pasted in a previous e-mail, it's now
working great :)

cheers
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131210/42968e63/attachment-0002.html>

From itamar at itamarst.org  Tue Dec 10 18:28:38 2013
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Tue, 10 Dec 2013 20:28:38 -0500
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <CAKN9TDKJRcma_irLeE-YG6zuLoVnQ2ab5X+Yoga30rDLB+9zdg@mail.gmail.com>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
 <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
 <87txemjsvf.fsf@loki.hocat.ca>
 <25CB87184063F24C9BDD8C5E3566EA257AEC6CA8@kit-ex01.coldstorage.com>
 <CAKN9TDKJRcma_irLeE-YG6zuLoVnQ2ab5X+Yoga30rDLB+9zdg@mail.gmail.com>
Message-ID: <52A7BFC6.1060607@itamarst.org>

On 12/09/2013 12:43 PM, Daniel Sank wrote:
> This is an update because glyph asked about this issue in another
> thread but I want to put the information where it belongs:
>
> 1. Try to log in. Does not accept credentials (login box simply
> reappears with username and password fields blank).
>
> 2. Cannot find a password reset option. Scratch head.
>
> 3. Google "twisted password reset". Find this page:
> http://twistedmatrix.com/trac/reset_password.
>
> 4. Ask for password reset. Receive email.
>
> 5. Try new password, goto 1.
>

I am unable to reproduce (in Chrome, using HTTPS rather than HTTP). I am 
able to sign in with newly created user... but resetting the password 
doesn't work, it gives me a "The email and username must match a known 
account." message which is quite bogus. I see nothing different between 
the new account I created, the danielsank account and my real account 
when using the Admin UI. A second account created with Firefox did show 
the failure to login, but browser may be unrelated.

This is still pretty bad, since password resets don't work, but I can't 
actually get them to be emailed.

I hate Trac so very much.

I suspect some issue with cookies, since I've created multiple logins 
but it keeps trying to log me in as a different one. Might be browser 
auth history though, hard to tell.

Can you try deleting all cookies for twistedmatrix.com and then try the 
reset again, or perhaps login with last reset password you got?



From sank.daniel at gmail.com  Tue Dec 10 18:53:11 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Tue, 10 Dec 2013 17:53:11 -0800
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <52A7BFC6.1060607@itamarst.org>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
 <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
 <87txemjsvf.fsf@loki.hocat.ca>
 <25CB87184063F24C9BDD8C5E3566EA257AEC6CA8@kit-ex01.coldstorage.com>
 <CAKN9TDKJRcma_irLeE-YG6zuLoVnQ2ab5X+Yoga30rDLB+9zdg@mail.gmail.com>
 <52A7BFC6.1060607@itamarst.org>
Message-ID: <CAKN9TDJaOAkcyee2AF53-yBzbP3gXBA7utc8PTVEAO2NVED_Ww@mail.gmail.com>

> Can you try deleting all cookies for twistedmatrix.com and then try the reset again, or perhaps login with last reset password you got?

1. Deleted all cookies
2. Asked for password reset
3. Got new password
4. Tried to log in with new password. Does not work.



From itamar at itamarst.org  Wed Dec 11 05:48:21 2013
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Wed, 11 Dec 2013 07:48:21 -0500
Subject: [Twisted-Python] Filing Bugs
In-Reply-To: <CAKN9TDJaOAkcyee2AF53-yBzbP3gXBA7utc8PTVEAO2NVED_Ww@mail.gmail.com>
References: <25CB87184063F24C9BDD8C5E3566EA257AEC698A@kit-ex01.coldstorage.com>
 <CAKN9TD+FVxds6_WFqi7-h_+_a9kd2ReOeuD0UkhbkX8UETKBig@mail.gmail.com>
 <25CB87184063F24C9BDD8C5E3566EA257AEC69D2@kit-ex01.coldstorage.com>
 <87txemjsvf.fsf@loki.hocat.ca>
 <25CB87184063F24C9BDD8C5E3566EA257AEC6CA8@kit-ex01.coldstorage.com>
 <CAKN9TDKJRcma_irLeE-YG6zuLoVnQ2ab5X+Yoga30rDLB+9zdg@mail.gmail.com>
 <52A7BFC6.1060607@itamarst.org>
 <CAKN9TDJaOAkcyee2AF53-yBzbP3gXBA7utc8PTVEAO2NVED_Ww@mail.gmail.com>
Message-ID: <52A85F15.4030103@itamarst.org>

Sigh. I'll see if there's some relevant bug fixes in the newer version 
of the auth trac plugin I believe we're using.



From glyph at twistedmatrix.com  Wed Dec 11 06:48:29 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Wed, 11 Dec 2013 05:48:29 -0800
Subject: [Twisted-Python] ISSLTransport.getPeerCertificate returning
	None?
In-Reply-To: <CAE_Hg6YWp3y-nzvrQ237prB3vVGPoh_FP976oxLoqD8sTO635w@mail.gmail.com>
References: <CAE_Hg6ZPsLdGoW-QvcA5sVU4ikU1c76odh6_HDD9r55A8PcdxQ@mail.gmail.com>
 <52A6D3A4.7010406@imperial.ac.uk>
 <20131210132141.6396.1418941768.divmod.xquotient.0@top>
 <52A71C70.5070108@imperial.ac.uk>
 <CAE_Hg6YWp3y-nzvrQ237prB3vVGPoh_FP976oxLoqD8sTO635w@mail.gmail.com>
Message-ID: <6B6C4EBB-9B3D-42D1-8EC7-5205B51792AE@twistedmatrix.com>

On Dec 10, 2013, at 6:01 AM, Laurens Van Houtven <_ at lvh.io> wrote:

> Somehow, JP's e-mail did not make it into my inbox :-(
> 
> Anyway, using the context factory that I got from ssl.PrivateCertificate.options() (which I think is CertificateOptions), I wasn't able to inspect the peer certificate. That's on 13.2. Using the context factory I pasted in a previous e-mail, it's now working great :)
> 
> cheers
> lvh

CertificateOptions will only set 'verify' if there are certificate authorities to verify against.

However, you can still CertificateOptions with a wrapper, like this:

from twisted.internet.ssl import ContextFactory
from OpenSSL import SSL

class TOFUVerify(ContextFactory):
    def __init__(self, wrapped):
        self.wrapped = wrapped

    def getContext(self):
        ctx = self.wrapped.getContext()
        ctx.set_verify(SSL.VERIFY_PEER, lambda *args: True)
        return ctx

since CertificateOptions sets a bunch of other options for you that might be useful.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131211/0bf55d29/attachment-0002.html>

From tobias.oberstein at tavendo.de  Thu Dec 12 01:29:48 2013
From: tobias.oberstein at tavendo.de (Tobias Oberstein)
Date: Thu, 12 Dec 2013 00:29:48 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
Message-ID: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>

Hi,

I am working on Twisted Endpoint support in Autobahn https://github.com/tavendo/AutobahnPython.

So far, I made Autobahn able to talk WebSocket _over_ arbitrary Twisted Endpoints, e.g. WebSocket over Unix domain sockets works. This is already quite nifty.

Is there anything like Twisted Endpoints for Processes and/or Serial? Like:

endpoint = serverFromString(reactor,"process:program=/usr/local/bin/myprogram")

or

endpoint = serverFromString(reactor,"serial:port=/dev/tty1:baudrate=115000")

That would allow to talk WebSocket over stdin/stdout to a program or a serial conneced device. Both can be useful in certain situations.

I'd also like to add the other: creating an Twisted Endpoint _from_ an Autobahn server/client to be able to talk any (stream) protocol _over_ WebSocket (like SSH or VNC over WebSocket).

endpoint = serverFromString(reactor,"websocket:tcp:80:url=ws://myhostname.com/somepath")

I guess I need to provide an implementation of
http://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.ITransport.html

What else? Is there some docs or recipe?

Thanks!
/Tobias




From asaha at redhat.com  Thu Dec 12 05:23:40 2013
From: asaha at redhat.com (Amit Saha)
Date: Thu, 12 Dec 2013 07:23:40 -0500 (EST)
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
 over IPv6
In-Reply-To: <1005863409.27288582.1386640767922.JavaMail.root@redhat.com>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
 <52A58E5D.1030809@imperial.ac.uk>
 <1005863409.27288582.1386640767922.JavaMail.root@redhat.com>
Message-ID: <1314654450.29770435.1386851020079.JavaMail.root@redhat.com>



----- Original Message -----
> From: "Amit Saha" <asaha at redhat.com>
> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> Sent: Tuesday, December 10, 2013 11:59:27 AM
> Subject: Re: [Twisted-Python] Queries about connecting to a XML-RPC server over IPv6
> 
> 
> 
> ----- Original Message -----
> > From: "Phil Mayers" <p.mayers at imperial.ac.uk>
> > To: twisted-python at twistedmatrix.com
> > Sent: Monday, December 9, 2013 7:33:17 PM
> > Subject: Re: [Twisted-Python] Queries about connecting to a XML-RPC server
> > over IPv6
> > 
> > On 09/12/13 05:28, Amit Saha wrote:
> > 
> > > proxy = Proxy('http://localhost6:8000')
> > > proxy.callRemote('my_proxy_method').addCallbacks(printValue, printError)
> > >
> > >
> > > When I run it, i get "No route to host: 101, Network is unreachable".
> > >
> > > However, 'curl -6 localhost:8000' succeeds. What could be going on here?
> > 
> > The IPv6 support in Twisted is very new - check your version even *has*
> > it - and it's still a work in progress. You might find that you can't do
> > this. I'd have to read the code to be sure and I don't have time right
> > now, but my guess is that t.w.xmlrpc isn't "getaddrinfo"-ised so won't
> > connect to IPv6 names.
> > 
> > If your version of Twisted supports it, you could probably work around
> > this by sub-classing Proxy and calling reactor.connectTCP('::1', 8000)
> > to attach the protocol yourself.
> 
> Thanks for your reply, Phil. So, I basically modified twisted/web/xmlrpc.py
> so that
> when it was calling connectTCP(), i substituted '::1' in place of self.host
> and yes the method is called successfully.
> 
> I will consider your other hints and see if there is an easy way to work
> around this
> in my particular use case.

I finally ended up doing this:

(Sorry for the +)

+class ProxyIPv6(xmlrpc.Proxy):
+
+    def __init__(self, url, **kwargs):
+
+        xmlrpc.Proxy.__init__(self, url, kwargs)
+        # resolve the LC's host/port to IPv6 address
+        # and overrise self.host
+        retries = 0
+        while retries < 5:
+            try:
+                self.host = socket.getaddrinfo(self.host, self.port,
+                                               socket.AF_INET6, 0, socket.SOL_TCP)[0][4][0]
+            except:
+                # IPv6 look up failed
+                log.debug('Failed to look up IPv6 address for LC. Sleeping for 5s')
+                time.sleep(5)
+                retries += 1
+            else:
+                log.info('Resolved IPv6 address of the LC.')
+                break


I have the retry loop since I saw that the IPv6 name resolution was failing once, but never happened
after that. The particular use case I am currently applying this is in a daemon process which starts on boot
on a IPv4 and IPv6 system. Then I disable IPv4 and the communication with the XML-RPC proxy server
happens only over IPv6.

Thanks for the pointers earlier.
-Amit.

-- 
Amit Saha <http://echorand.me>



From p.mayers at imperial.ac.uk  Thu Dec 12 05:33:21 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Thu, 12 Dec 2013 12:33:21 +0000
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
 over IPv6
In-Reply-To: <1314654450.29770435.1386851020079.JavaMail.root@redhat.com>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
 <52A58E5D.1030809@imperial.ac.uk>
 <1005863409.27288582.1386640767922.JavaMail.root@redhat.com>
 <1314654450.29770435.1386851020079.JavaMail.root@redhat.com>
Message-ID: <52A9AD11.8070803@imperial.ac.uk>

On 12/12/13 12:23, Amit Saha wrote:
>
>
> ----- Original Message -----
>> From: "Amit Saha" <asaha at redhat.com>
>> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
>> Sent: Tuesday, December 10, 2013 11:59:27 AM
>> Subject: Re: [Twisted-Python] Queries about connecting to a XML-RPC server over IPv6
>>
>>
>>
>> ----- Original Message -----
>>> From: "Phil Mayers" <p.mayers at imperial.ac.uk>
>>> To: twisted-python at twistedmatrix.com
>>> Sent: Monday, December 9, 2013 7:33:17 PM
>>> Subject: Re: [Twisted-Python] Queries about connecting to a XML-RPC server
>>> over IPv6
>>>
>>> On 09/12/13 05:28, Amit Saha wrote:
>>>
>>>> proxy = Proxy('http://localhost6:8000')
>>>> proxy.callRemote('my_proxy_method').addCallbacks(printValue, printError)
>>>>
>>>>
>>>> When I run it, i get "No route to host: 101, Network is unreachable".
>>>>
>>>> However, 'curl -6 localhost:8000' succeeds. What could be going on here?
>>>
>>> The IPv6 support in Twisted is very new - check your version even *has*
>>> it - and it's still a work in progress. You might find that you can't do
>>> this. I'd have to read the code to be sure and I don't have time right
>>> now, but my guess is that t.w.xmlrpc isn't "getaddrinfo"-ised so won't
>>> connect to IPv6 names.
>>>
>>> If your version of Twisted supports it, you could probably work around
>>> this by sub-classing Proxy and calling reactor.connectTCP('::1', 8000)
>>> to attach the protocol yourself.
>>
>> Thanks for your reply, Phil. So, I basically modified twisted/web/xmlrpc.py
>> so that
>> when it was calling connectTCP(), i substituted '::1' in place of self.host
>> and yes the method is called successfully.
>>
>> I will consider your other hints and see if there is an easy way to work
>> around this
>> in my particular use case.
>
> I finally ended up doing this:

Just to point out this is obviously a pretty hackish way of doing it; 
for starters, getaddrinfo() is blocking, so you should use deferToThread 
at minimum.

You might want to look at:

http://twistedmatrix.com/trac/browser/tags/releases/twisted-13.2.0/twisted/internet/endpoints.py#L707

...for inspiration.



From asaha at redhat.com  Thu Dec 12 16:59:43 2013
From: asaha at redhat.com (Amit Saha)
Date: Thu, 12 Dec 2013 18:59:43 -0500 (EST)
Subject: [Twisted-Python] Queries about connecting to a XML-RPC server
 over IPv6
In-Reply-To: <52A9AD11.8070803@imperial.ac.uk>
References: <358925406.26431049.1386566927334.JavaMail.root@redhat.com>
 <52A58E5D.1030809@imperial.ac.uk>
 <1005863409.27288582.1386640767922.JavaMail.root@redhat.com>
 <1314654450.29770435.1386851020079.JavaMail.root@redhat.com>
 <52A9AD11.8070803@imperial.ac.uk>
Message-ID: <631675229.30360621.1386892783782.JavaMail.root@redhat.com>



----- Original Message -----
> From: "Phil Mayers" <p.mayers at imperial.ac.uk>
> To: twisted-python at twistedmatrix.com
> Sent: Thursday, December 12, 2013 10:33:21 PM
> Subject: Re: [Twisted-Python] Queries about connecting to a XML-RPC server over IPv6
> 
> On 12/12/13 12:23, Amit Saha wrote:
> >
> >
> > ----- Original Message -----
> >> From: "Amit Saha" <asaha at redhat.com>
> >> To: "Twisted general discussion" <twisted-python at twistedmatrix.com>
> >> Sent: Tuesday, December 10, 2013 11:59:27 AM
> >> Subject: Re: [Twisted-Python] Queries about connecting to a XML-RPC server
> >> over IPv6
> >>
> >>
> >>
> >> ----- Original Message -----
> >>> From: "Phil Mayers" <p.mayers at imperial.ac.uk>
> >>> To: twisted-python at twistedmatrix.com
> >>> Sent: Monday, December 9, 2013 7:33:17 PM
> >>> Subject: Re: [Twisted-Python] Queries about connecting to a XML-RPC
> >>> server
> >>> over IPv6
> >>>
> >>> On 09/12/13 05:28, Amit Saha wrote:
> >>>
> >>>> proxy = Proxy('http://localhost6:8000')
> >>>> proxy.callRemote('my_proxy_method').addCallbacks(printValue, printError)
> >>>>
> >>>>
> >>>> When I run it, i get "No route to host: 101, Network is unreachable".
> >>>>
> >>>> However, 'curl -6 localhost:8000' succeeds. What could be going on here?
> >>>
> >>> The IPv6 support in Twisted is very new - check your version even *has*
> >>> it - and it's still a work in progress. You might find that you can't do
> >>> this. I'd have to read the code to be sure and I don't have time right
> >>> now, but my guess is that t.w.xmlrpc isn't "getaddrinfo"-ised so won't
> >>> connect to IPv6 names.
> >>>
> >>> If your version of Twisted supports it, you could probably work around
> >>> this by sub-classing Proxy and calling reactor.connectTCP('::1', 8000)
> >>> to attach the protocol yourself.
> >>
> >> Thanks for your reply, Phil. So, I basically modified
> >> twisted/web/xmlrpc.py
> >> so that
> >> when it was calling connectTCP(), i substituted '::1' in place of
> >> self.host
> >> and yes the method is called successfully.
> >>
> >> I will consider your other hints and see if there is an easy way to work
> >> around this
> >> in my particular use case.
> >
> > I finally ended up doing this:
> 
> Just to point out this is obviously a pretty hackish way of doing it;
> for starters, getaddrinfo() is blocking, so you should use deferToThread
> at minimum.

Indeed it is very hackish. It is basically the first thing that helped me solve the problem.
> 
> You might want to look at:
> 
> http://twistedmatrix.com/trac/browser/tags/releases/twisted-13.2.0/twisted/internet/endpoints.py#L707
> 
> ...for inspiration.

Thanks, I will take a look and hopefully can modify my approach.

Best,
Amit.

-- 
Amit Saha <http://echorand.me>



From asaha at redhat.com  Thu Dec 12 20:22:50 2013
From: asaha at redhat.com (Amit Saha)
Date: Thu, 12 Dec 2013 22:22:50 -0500 (EST)
Subject: [Twisted-Python] Reliable way to check if Twisted has IPv6 support?
In-Reply-To: <1876438082.30416759.1386904668142.JavaMail.root@redhat.com>
Message-ID: <1420744804.30417894.1386904970292.JavaMail.root@redhat.com>

Hello,

I have a code path similar to:

if Twisted has IPv6:
  # do this
else:
  # do that

I came up with this: 

Using 'getattr' to get a function which wouldn't exist if there was no IPv6 address as follows:

>>> from twisted.internet import abstract
>>> getattr(abstract, 'isIPv6Address')
<function isIPv6Address at 0x171a488>

Is there a more reliable way (which works with the Twisted-8.0+) to check this?

Thanks,
Amit.


-- 
Amit Saha <http://echorand.me>



From p.mayers at imperial.ac.uk  Fri Dec 13 03:41:44 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Fri, 13 Dec 2013 10:41:44 +0000
Subject: [Twisted-Python] Reliable way to check if Twisted has IPv6
	support?
In-Reply-To: <1420744804.30417894.1386904970292.JavaMail.root@redhat.com>
References: <1420744804.30417894.1386904970292.JavaMail.root@redhat.com>
Message-ID: <52AAE468.9020801@imperial.ac.uk>

On 13/12/13 03:22, Amit Saha wrote:

> Is there a more reliable way (which works with the Twisted-8.0+) to check this?

Check the Twisted version.

You should also note that IPv6 features have appeared in multiple 
versions; HostnameEndpoint was added in 13.2.0 for example, whereas 
basic "connectTCP to IPv6 address" was added in 12.1.0, with listenTCP 
in 12.0.0

So:

import twisted

vt = (twisted.version.major, twisted.version.minor)

if vt > (13,2):
   def connectv6name(n):
     return HostnameEndpoint(...)
elif vt > (12,1):
   def connectv6name(n):
     d = myGetAddrInfo(...)
     d.addCallback(reactor.connectTCP, ...)
else:
   def connectv6name(n):
     raise Exception('twisted too old for IPv6')



From glyph at twistedmatrix.com  Fri Dec 13 06:32:22 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Fri, 13 Dec 2013 05:32:22 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
Message-ID: <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>

On Dec 12, 2013, at 12:29 AM, Tobias Oberstein <tobias.oberstein at tavendo.de> wrote:

> Hi,
> 
> I am working on Twisted Endpoint support in Autobahn https://github.com/tavendo/AutobahnPython.

Yay!

> So far, I made Autobahn able to talk WebSocket _over_ arbitrary Twisted Endpoints, e.g. WebSocket over Unix domain sockets works. This is already quite nifty.
> 
> Is there anything like Twisted Endpoints for Processes and/or Serial? Like:
> 
> endpoint = serverFromString(reactor,"process:program=/usr/local/bin/myprogram")
> 
> or
> 
> endpoint = serverFromString(reactor,"serial:port=/dev/tty1:baudrate=115000")

Yes and no.

For serial port support, see <https://twistedmatrix.com/trac/ticket/4847>.  For subprocess support, <https://twistedmatrix.com/documents/current/api/twisted.internet.endpoints.ProcessEndpoint.html>.

However, process support is unfinished, as you can see in <https://twistedmatrix.com/trac/ticket/5813>; there still needs to be a string parser plugin, so you can't do what you suggest with serverFromString.

I hope you'll poke those tickets along through the process.

> That would allow to talk WebSocket over stdin/stdout to a program or a serial conneced device. Both can be useful in certain situations.

And that would be awesome.

> I'd also like to add the other: creating an Twisted Endpoint _from_ an Autobahn server/client to be able to talk any (stream) protocol _over_ WebSocket (like SSH or VNC over WebSocket).
> 
> endpoint = serverFromString(reactor,"websocket:tcp:80:url=ws://myhostname.com/somepath")

There's totally a plugin architecture for this, and I'm excited for you to use it :-).

One quick comment though: would you be OK with using 'autobahn' as your identifier rather than 'websocket'?  There are still plans to include basic websocket support within Twisted itself and it would be a shame to start conflicting on that identifier.

> I guess I need to provide an implementation of
> http://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.ITransport.html
> 
> What else? Is there some docs or recipe?

Sadly it seems that although <http://twistedmatrix.com/documents/current/core/howto/endpoints.html> alludes to the plugin API, it doesn't actually link to it.

The way that you add a new type of endpoint to the string parser is by registering a Twisted plugin (assuming that you know how to do that) providing   <https://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.IStreamServerEndpointStringParser.html>.

Hopefully the API documentation there is helpful; from there you'll need to write implementations of IStreamServerEndpoint, IListeningPort, and ITransport; the breadcrumbs should be laid out well enough that it's pretty clear where each of those needs to be though.

Hope that helps, and thanks for actually wanting to use these plugin APIs we worked so hard on,

-glyph


From itamar at itamarst.org  Fri Dec 13 06:58:22 2013
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Fri, 13 Dec 2013 08:58:22 -0500
Subject: [Twisted-Python] twistedmatrix.com will be down at some point today
	for a RAM upgrade
Message-ID: <52AB127E.1020007@itamarst.org>

FYI.

-Itamar



From tobias.oberstein at tavendo.de  Fri Dec 13 08:09:32 2013
From: tobias.oberstein at tavendo.de (Tobias Oberstein)
Date: Fri, 13 Dec 2013 07:09:32 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
Message-ID: <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>

> > I am working on Twisted Endpoint support in Autobahn
> https://github.com/tavendo/AutobahnPython.
> 
> Yay!

Endpoints are cool.

FWIW, here is a working example of WebSocket I tested over both Unix domain sockets and the usual TCP/TLS endpoints:

https://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/echo_endpoints

This works with all features Autobahn provides like support for different WebSocket versions (Hixie-76, RFC6455) and
WebSocket extensions (like permessage-compression with deflate, snappy, bzip2).


[snip: talk on Endpoints for Serial and Process]

> I hope you'll poke those tickets along through the process.

Thanks for directions! I will have a look into those.


> There's totally a plugin architecture for this, and I'm excited for you to use it :-
> ).
> 
> One quick comment though: would you be OK with using 'autobahn' as your
> identifier rather than 'websocket'?  There are still plans to include basic
> websocket support within Twisted itself and it would be a shame to start
> conflicting on that identifier.

Sure. Can I use:

"autobahn.websocket"

?

Since Autobahn also provides other protocols (WAMP), and ..

==

Thanks for your pointers on the Endpoint plugin architecture. I guess thats enough to get me
started - modulo below .. if you could give me 1 more reply with feedback, that would be awesome!

In the meantime I did a little more thinking about WebSocket and endpoints.

I can see two approaches - which one is the way forward?


Variant 1)

endpoint = serverFromString(reactor,"autobahn.websocket: tcp:80:url=ws://myhostname.com/somepath")

Here, a single endpoint descriptor is specifying parameters for both WebSocket, and the underlying transport.

Underlying transport:
tcp:80

WebSocket overlay:
autobahn.websocket:url=ws://myhostname.com/somepath:extensions:permessage-deflate;permessage-snappy

So the plugin needs to parse not only the "overlay transport" spec, but also the underlying spec ("tcp:80") and all variants thereof?

Or can I let the existing Twisted machinery do the parsing of the underlying, and only parse off the remaining
stuff ("url=ws://myhostname.com/somepath:extensions:permessage-deflate;permessage-snappy" in this case)

And if not, does that mean not only the endpoint main identifier ("tcp" vs "unix" vs "autobahn.websocket") must
be non-overlapping, but also all the individual parameters? Like in the case for WebSocket, there is a need
for a "url" parameter.

These Qs have brought me to ..


Variant 2)

endpoint = serverFromString(reactor, "tcp:80")
wrappedEndpoint = serverFromString(reactor, endpoint, "autobahn.websocket:url=ws://myhost.com/mypath")

where I would start a program like

python myprog.py --transport "tcp:80" --wrappingTransport "autobahn.websocket:url=ws://myhost.com/mypath"

Is there such thing as a WrappingEndpoint?

==

This is yet another topic/question, but it fits here.

Twisted has defined interfaces for both stream (and datagram transports).

WebSocket is essentially a bidirectional, reliable, ordered datagram transport (with 2 payload types: binary and utf8).

Is there a Twisted Interface for such transports?

I am asking, since I am right now also refactoring the code within Autobahn that lays above raw WebSocket .. a PubSub+RPC protocol, that essentially only assumes a transport like above.

I want to make it independent of WebSocket and only assume a bidirectional, reliable, ordered, datagram transport.

Thanks a bunch for your thoughts and help!

/Tobias 



From glyph at twistedmatrix.com  Fri Dec 13 10:23:35 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Fri, 13 Dec 2013 09:23:35 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
Message-ID: <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>


On Dec 13, 2013, at 7:09 AM, Tobias Oberstein <tobias.oberstein at tavendo.de> wrote:

>>> I am working on Twisted Endpoint support in Autobahn
>> https://github.com/tavendo/AutobahnPython.
>> 
>> Yay!
> 
> Endpoints are cool.
> 
> FWIW, here is a working example of WebSocket I tested over both Unix domain sockets and the usual TCP/TLS endpoints:
> 
> https://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/echo_endpoints
> 
> This works with all features Autobahn provides like support for different WebSocket versions (Hixie-76, RFC6455) and
> WebSocket extensions (like permessage-compression with deflate, snappy, bzip2).

Cool!
> 
> Sure. Can I use:
> 
> "autobahn.websocket"?
> 
> Since Autobahn also provides other protocols (WAMP), and ..

Sure.

> endpoint = serverFromString(reactor,"autobahn.websocket: tcp:80:url=ws://myhostname.com/somepath")
> 
> Here, a single endpoint descriptor is specifying parameters for both WebSocket, and the underlying transport.
> 
> Underlying transport:
> tcp:80
> 
> WebSocket overlay:
> autobahn.websocket:url=ws://myhostname.com/somepath:extensions:permessage-deflate;permessage-snappy
> 
> So the plugin needs to parse not only the "overlay transport" spec, but also the underlying spec ("tcp:80") and all variants thereof?
> 
> Or can I let the existing Twisted machinery do the parsing of the underlying, and only parse off the remaining
> stuff ("url=ws://myhostname.com/somepath:extensions:permessage-deflate;permessage-snappy" in this case)

There's some discussion of this here: <http://twistedmatrix.com/trac/ticket/5642>.

It's probably possible, the rules are reasonably simple.

> 
> And if not, does that mean not only the endpoint main identifier ("tcp" vs "unix" vs "autobahn.websocket") must
> be non-overlapping, but also all the individual parameters?

Nope; the first one has to be non-overlapping, then you just have to decide on a definite place where the "wrapped" endpoint begins.

> Like in the case for WebSocket, there is a need
> for a "url" parameter.
> 
> These Qs have brought me to ..
> 
> 
> Variant 2)
> 
> endpoint = serverFromString(reactor, "tcp:80")
> wrappedEndpoint = serverFromString(reactor, endpoint, "autobahn.websocket:url=ws://myhost.com/mypath")
> 
> where I would start a program like
> 
> python myprog.py --transport "tcp:80" --wrappingTransport "autobahn.websocket:url=ws://myhost.com/mypath"
> 

This variant is worse because you can't change the command lines of other twistd plugins, which might be able to use websockets unchanged if you could just get it returned by serverFromString.


> Is there such thing as a WrappingEndpoint?

Not yet, no.  Comment on that ticket :).

> ==
> 
> This is yet another topic/question, but it fits here.
> 
> Twisted has defined interfaces for both stream (and datagram transports).
> 
> WebSocket is essentially a bidirectional, reliable, ordered datagram transport (with 2 payload types: binary and utf8).
> 
> Is there a Twisted Interface for such transports?

No.  Websockets are incredibly bizarre; most protocols support either arbitrarily typed data or just bytes/just text.  The hybrid weirdness of "binary" (with no additional type information) and "text" is unique.

> I am asking, since I am right now also refactoring the code within Autobahn that lays above raw WebSocket .. a PubSub+RPC protocol, that essentially only assumes a transport like above.
> 
> I want to make it independent of WebSocket and only assume a bidirectional, reliable, ordered, datagram transport.

You can do this with length prefixing, but arguably Twisted should have such an interface that can express this combination of concepts, because I think these are, technically speaking, the semantics of a UNIX datagram endpoint, but the required interface (actually a superclass, bleh) is the same as for UDP, implying unreliability.

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131213/ce368ff9/attachment-0002.html>

From trac at twistedmatrix.com  Sun Dec 15 00:05:14 2013
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 15 Dec 2013 07:05:14 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1387091114.55.3153109189626201950@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131215/b78880eb/attachment-0002.html>

From sank.daniel at gmail.com  Wed Dec 18 18:38:41 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Wed, 18 Dec 2013 17:38:41 -0800
Subject: [Twisted-Python] multiple log-in / perspective broker
Message-ID: <CAKN9TDLyeBCZj+RoBZhKMAuhJSyZzYfJBmpZ-Zhu4KQu1HkWHg@mail.gmail.com>

Suppose I have a chat room application using perspective broker. Users
log in with their credentials and gain access to some kind of lobby
showing all available chat rooms. Now suppose entry into each chat
room is precluded by another log in step. How do I implement that?

I suppose I could make another realm and listen on another port but
that seems wrong.

-- 
Daniel Sank
Department of Physics
Broida Hall
University of California
Santa Barbara, CA 93117
(805)893-3899



From mwollenw at gwu.edu  Thu Dec 19 13:05:27 2013
From: mwollenw at gwu.edu (Matthew Wollenweber)
Date: Thu, 19 Dec 2013 15:05:27 -0500
Subject: [Twisted-Python] Sharing a database connection in web server
Message-ID: <CAA+Xgjd7e_LQ8DLAytZSkwLppPuLnU7-KBR=z=fyohZZVALgCw@mail.gmail.com>

Hello,

Could someone please let me know the preferred method for sharing a
database connection within a twisted.web.server instance? I've found that
adbapi is the preferred method to avoid blocking when making database
calls, however I'm still struggling how to share a database connection
within the Site.

I would like to connect to the database when the server/site is executed
and make that connection accessible to pages/classes within the Site. Could
someone offer some advice?


Thanks for the help.

-- 
Matthew Wollenweber
Principal Security Engineer
DIT/Information Security Office
The George Washington University

mwollenw at gwu.edu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131219/b3dd37a0/attachment-0002.html>

From haggardii at gmail.com  Thu Dec 19 13:34:10 2013
From: haggardii at gmail.com (Matt Haggard)
Date: Thu, 19 Dec 2013 13:34:10 -0700
Subject: [Twisted-Python] Sharing a database connection in web server
In-Reply-To: <CAA+Xgjd7e_LQ8DLAytZSkwLppPuLnU7-KBR=z=fyohZZVALgCw@mail.gmail.com>
References: <CAA+Xgjd7e_LQ8DLAytZSkwLppPuLnU7-KBR=z=fyohZZVALgCw@mail.gmail.com>
Message-ID: <CAL+xXwMxMLB5i+w1NNZRn1ufhpjXwa1maxbikiiiHo-wYzkO5A@mail.gmail.com>

Matthew,

I've found klein to be really useful for this.  Especially the ability
to have non-global state:
https://github.com/twisted/klein#non-global-state

Matt

On Thu, Dec 19, 2013 at 1:05 PM, Matthew Wollenweber <mwollenw at gwu.edu> wrote:
> Hello,
>
> Could someone please let me know the preferred method for sharing a database
> connection within a twisted.web.server instance? I've found that adbapi is
> the preferred method to avoid blocking when making database calls, however
> I'm still struggling how to share a database connection within the Site.
>
> I would like to connect to the database when the server/site is executed and
> make that connection accessible to pages/classes within the Site. Could
> someone offer some advice?
>
>
> Thanks for the help.
>
> --
> Matthew Wollenweber
> Principal Security Engineer
> DIT/Information Security Office
> The George Washington University
>
> mwollenw at gwu.edu
>
>
>
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



From trac at twistedmatrix.com  Sun Dec 22 00:05:15 2013
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 22 Dec 2013 07:05:15 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1387695915.12.4478994386477910343@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131222/a0391715/attachment-0002.html>

From sank.daniel at gmail.com  Fri Dec 27 17:48:33 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Fri, 27 Dec 2013 16:48:33 -0800
Subject: [Twisted-Python] multiple log-in / perspective broker
In-Reply-To: <CAKN9TDLyeBCZj+RoBZhKMAuhJSyZzYfJBmpZ-Zhu4KQu1HkWHg@mail.gmail.com>
References: <CAKN9TDLyeBCZj+RoBZhKMAuhJSyZzYfJBmpZ-Zhu4KQu1HkWHg@mail.gmail.com>
Message-ID: <CAKN9TDL7DBr_kJrdQk6t3S4eOHUkBKviu0UWwVqA4M5WDXj2FA@mail.gmail.com>

Anyone?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131227/4285cf14/attachment-0002.html>

From itamar at itamarst.org  Fri Dec 27 22:17:50 2013
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Fri, 27 Dec 2013 21:17:50 -0800
Subject: [Twisted-Python] multiple log-in / perspective broker
In-Reply-To: <CAKN9TDL7DBr_kJrdQk6t3S4eOHUkBKviu0UWwVqA4M5WDXj2FA@mail.gmail.com>
References: <CAKN9TDLyeBCZj+RoBZhKMAuhJSyZzYfJBmpZ-Zhu4KQu1HkWHg@mail.gmail.com>
 <CAKN9TDL7DBr_kJrdQk6t3S4eOHUkBKviu0UWwVqA4M5WDXj2FA@mail.gmail.com>
Message-ID: <e277f3edf470d60c446a59844356a7a8@itamarst.org>

 

On 2013-12-27 16:48, Daniel Sank wrote: 

> Anyone?

_______________________________________________

Do your own cred login() to the new Realm, or maybe Portal if need auto
auth. Read how urgent existing login code works, it is just a thin
layer.

I can't really give a good answer when typing on this crap tablet
keyboard, if that doesn't help will try to answer more when back at
computer In a few days. Or maybe someone else can.

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131227/7f70116d/attachment-0002.html>

From sank.daniel at gmail.com  Sat Dec 28 09:15:55 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sat, 28 Dec 2013 08:15:55 -0800
Subject: [Twisted-Python] multiple log-in / perspective broker
In-Reply-To: <e277f3edf470d60c446a59844356a7a8@itamarst.org>
References: <CAKN9TDLyeBCZj+RoBZhKMAuhJSyZzYfJBmpZ-Zhu4KQu1HkWHg@mail.gmail.com>
 <CAKN9TDL7DBr_kJrdQk6t3S4eOHUkBKviu0UWwVqA4M5WDXj2FA@mail.gmail.com>
 <e277f3edf470d60c446a59844356a7a8@itamarst.org>
Message-ID: <CAKN9TDKcba4f8iUfEPkz2n0+gWy4ZgCJ3UDHogcNH=QMX6DRwQ@mail.gmail.com>

> Do your own cred login() to the new Realm, or maybe Portal if need
> auto auth.

The way I understand currently is like this:

r = MyIRealmImplementer()
p = portal.Portal(r)
pbFactory = pb.PBServerFactory(p)
reactor.listenTCP(<port number>, pbFactory)
reactor.run()

The API documentation for Portal specifically says that each Portal
gets exactly one Realm. Therefore, I don't see how to add another
Realm to the system without another listenTCP call on a new port. Is
that what I'm supposed to do?

The reason I'm not going for the listen-on-a-new-port idea is that I'd
have as many open ports as chat rooms, which smells funny to me. What
I really want is for the client processes to receive one new Avatar
instance representing their access for each chat room into which they
enter. If this is misguided please advise.

> Read how urgent existing login code works, it is just a thin layer.

I don't understand what you mean by this. Is there a particular
example I can look at?



From itamar at itamarst.org  Sat Dec 28 09:22:39 2013
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Sat, 28 Dec 2013 08:22:39 -0800
Subject: [Twisted-Python] multiple log-in / perspective broker
In-Reply-To: <CAKN9TDKcba4f8iUfEPkz2n0+gWy4ZgCJ3UDHogcNH=QMX6DRwQ@mail.gmail.com>
References: <CAKN9TDLyeBCZj+RoBZhKMAuhJSyZzYfJBmpZ-Zhu4KQu1HkWHg@mail.gmail.com>
 <CAKN9TDL7DBr_kJrdQk6t3S4eOHUkBKviu0UWwVqA4M5WDXj2FA@mail.gmail.com>
 <e277f3edf470d60c446a59844356a7a8@itamarst.org>
 <CAKN9TDKcba4f8iUfEPkz2n0+gWy4ZgCJ3UDHogcNH=QMX6DRwQ@mail.gmail.com>
Message-ID: <e844d2218d9b16d099e2bce77fcd92f3@itamarst.org>

 

I am imagining having a remotely accessible login() method on the avatar
returned by the realm. 

I meant to say read current implementation, not "urgent". 

Written on an iPad still, sorry. 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131228/c37cf079/attachment-0002.html>

From burak.arslan at arskom.com.tr  Sat Dec 28 10:23:37 2013
From: burak.arslan at arskom.com.tr (Burak Arslan)
Date: Sat, 28 Dec 2013 19:23:37 +0200
Subject: [Twisted-Python] Async RPC with Spyne and Twisted
Message-ID: <52BF0919.7080604@arskom.com.tr>

Hi there,

As you might remember from the PyCon sprints, I've been working on
making async rpc work within Spyne using twisted.

That work is now mostly done, so I'm looking for your feedback on
how/whether I should improve the API or its implementation.

Here's a proof of concept:

https://github.com/plq/spyne/blob/9e96d166075cc3c9b57ce5accb97efe09f98fa62/examples/twisted/resource_push.py#L55

That example currently produces a regular html table.
spyne.protocol.html.* and spyne.protocol.xml are currently the only
supported protocols. I'll be working on making  other protocols
async-compliant (without breaking compatibility with sync code) in the
coming days.

At its heart, this is making use of lxml's incremental generation
functionality, described here:
http://lxml.de/api.html#incremental-xml-generation.

Awaiting your feedback.

Best,
Burak



From exarkun at twistedmatrix.com  Sat Dec 28 10:52:10 2013
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sat, 28 Dec 2013 17:52:10 -0000
Subject: [Twisted-Python] multiple log-in / perspective broker
In-Reply-To: <e844d2218d9b16d099e2bce77fcd92f3@itamarst.org>
References: <CAKN9TDLyeBCZj+RoBZhKMAuhJSyZzYfJBmpZ-Zhu4KQu1HkWHg@mail.gmail.com>
 <CAKN9TDL7DBr_kJrdQk6t3S4eOHUkBKviu0UWwVqA4M5WDXj2FA@mail.gmail.com>
 <e277f3edf470d60c446a59844356a7a8@itamarst.org>
 <CAKN9TDKcba4f8iUfEPkz2n0+gWy4ZgCJ3UDHogcNH=QMX6DRwQ@mail.gmail.com>
 <e844d2218d9b16d099e2bce77fcd92f3@itamarst.org>
Message-ID: <20131228175210.17936.440002209.divmod.xquotient.1@top>

On 04:22 pm, itamar at itamarst.org wrote:
>
>
>I am imagining having a remotely accessible login() method on the 
>avatar
>returned by the realm.

In other words, you don't have to log in on the *root* pb object.  Login 
is just a PB method call.  You can have a second portal wrapping a 
different realm handing out different avatars and you can log in to that 
portal the second time.

Jean-Paul



From sank.daniel at gmail.com  Sat Dec 28 11:24:56 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sat, 28 Dec 2013 10:24:56 -0800
Subject: [Twisted-Python] multiple log-in / perspective broker
In-Reply-To: <20131228175210.17936.440002209.divmod.xquotient.1@top>
References: <CAKN9TDLyeBCZj+RoBZhKMAuhJSyZzYfJBmpZ-Zhu4KQu1HkWHg@mail.gmail.com>
 <CAKN9TDL7DBr_kJrdQk6t3S4eOHUkBKviu0UWwVqA4M5WDXj2FA@mail.gmail.com>
 <e277f3edf470d60c446a59844356a7a8@itamarst.org>
 <CAKN9TDKcba4f8iUfEPkz2n0+gWy4ZgCJ3UDHogcNH=QMX6DRwQ@mail.gmail.com>
 <e844d2218d9b16d099e2bce77fcd92f3@itamarst.org>
 <20131228175210.17936.440002209.divmod.xquotient.1@top>
Message-ID: <CAKN9TD+AaAu_cAM_06C4yH=5vOvEABz6yO6QeE2CQSpTDFyLxA@mail.gmail.com>

> In other words, you don't have to log in on the *root* pb object.
> Login is just a PB method call.  You can have a second portal
> wrapping a different realm handing out different avatars and you
> can log in to that portal the second time.

How can the client access that second Portal if it's not hooked up
using pb.PBServerFactory and reactor.listenTCP?

> I am imagining having a remotely accessible login() method on
> the avatar returned by the realm.

Ah, I think I understand this now. The first Avatar (the one that
lives in the Lobby) has a method like

remote_logIntoChatRoom(self, roomName, credentials, mind)

which will then invoke some kind of login method on another
Portal/Realm pair representing the specific chat room. What threw me
originally is that I didn't realize that it's ok to use the
Portal/Realm structure without a corresponding PBServerFactory and
listenTCP call.



From trac at twistedmatrix.com  Sun Dec 29 00:05:14 2013
From: trac at twistedmatrix.com (trac at twistedmatrix.com)
Date: Sun, 29 Dec 2013 07:05:14 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1388300714.95.1706393594097096847@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131229/720b36fb/attachment-0002.html>

From sank.daniel at gmail.com  Sun Dec 29 12:28:30 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sun, 29 Dec 2013 11:28:30 -0800
Subject: [Twisted-Python] Where is trial?
Message-ID: <CAKN9TDLS=efDfE4=M32AjDgw6ZLCq3ixJmVmqKt9+QKuHVg1WA@mail.gmail.com>

I am trying to write tests for my project. According to the twisted howto
found here

http://twistedmatrix.com/documents/current/core/howto/trial.html

I should use trial. When I try to run trial from the command line (Windows)
I get the usual "that's not a program I know about" error. The howto says
that there's a twisted bin directory that should be in the path, but
looking around in my python installation, I see no such thing. I checked
lib/site-packages/twisted and /Scripts.

What am I missing here?

I installed twisted using the executable windows installer.

-Daniel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131229/305cec83/attachment-0002.html>

From kevin.horn at gmail.com  Sun Dec 29 12:43:57 2013
From: kevin.horn at gmail.com (Kevin Horn)
Date: Sun, 29 Dec 2013 13:43:57 -0600
Subject: [Twisted-Python] Where is trial?
In-Reply-To: <CAKN9TDLS=efDfE4=M32AjDgw6ZLCq3ixJmVmqKt9+QKuHVg1WA@mail.gmail.com>
References: <CAKN9TDLS=efDfE4=M32AjDgw6ZLCq3ixJmVmqKt9+QKuHVg1WA@mail.gmail.com>
Message-ID: <CA+U=zK3RszYD6ONsfy_jnwAtmSntpHB-YuhC_1EYPu5_CcQrhw@mail.gmail.com>

On my current setup (Twisted 12.3), trial is at:

C:\Python27\Scripts\trial.py

Depending on how your system is set up, this may or may not run from the
command line without some changes.  Make sure your Scripts directory is on
the executable search path, and you may need to add the .PY extension to
your PATHEXT environment variable.

Alternatively, you can write a batch file to launch trial.

Good luck, and let us know how it turns out.


On Sun, Dec 29, 2013 at 1:28 PM, Daniel Sank <sank.daniel at gmail.com> wrote:

> I am trying to write tests for my project. According to the twisted howto
> found here
>
> http://twistedmatrix.com/documents/current/core/howto/trial.html
>
> I should use trial. When I try to run trial from the command line
> (Windows) I get the usual "that's not a program I know about" error. The
> howto says that there's a twisted bin directory that should be in the path,
> but looking around in my python installation, I see no such thing. I
> checked lib/site-packages/twisted and /Scripts.
>
> What am I missing here?
>
> I installed twisted using the executable windows installer.
>
> -Daniel
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>


-- 
--
Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131229/3fe78fe1/attachment-0002.html>

From sank.daniel at gmail.com  Sun Dec 29 12:59:52 2013
From: sank.daniel at gmail.com (Daniel Sank)
Date: Sun, 29 Dec 2013 11:59:52 -0800
Subject: [Twisted-Python] Where is trial?
In-Reply-To: <CA+U=zK3RszYD6ONsfy_jnwAtmSntpHB-YuhC_1EYPu5_CcQrhw@mail.gmail.com>
References: <CAKN9TDLS=efDfE4=M32AjDgw6ZLCq3ixJmVmqKt9+QKuHVg1WA@mail.gmail.com>
 <CA+U=zK3RszYD6ONsfy_jnwAtmSntpHB-YuhC_1EYPu5_CcQrhw@mail.gmail.com>
Message-ID: <CAKN9TD+4Lo-toRMc8FpSSA4KeNaR4qJtoBtthnWgjqTispGk4Q@mail.gmail.com>

> On my current setup (Twisted 12.3), trial is at:
>
> C:\Python27\Scripts\trial.py

Oh, me too. When I read the howto I thought it was saying that there should
be a binary, eg. trial.exe somewhere. I thought that because it said the
file would be in a directory called "bin".

Now I understand.

Btw, I would submit a documentation patch for this but I still can't log
into the website.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131229/6266d7be/attachment-0002.html>

From terry at jon.es  Sun Dec 29 22:24:37 2013
From: terry at jon.es (Terry Jones)
Date: Mon, 30 Dec 2013 05:24:37 +0000
Subject: [Twisted-Python] txdlo - a Twisted DeferredListObserver
Message-ID: <CACqnu4WX0TXKBXFq7Qv8aJSnswKF-EuBXJejCcX8XTbRi9p7UA@mail.gmail.com>

I just wrote a quick class called DeferredListObserver that lets you do
various things with a list of deferreds. You can add observers that get
passed information about the deferreds firing. You can also add deferreds
to the observed list at any time (this is very useful if you're dynamically
creating deferreds that you want to monitor).

The class can be used to easily build things like Twisted's DeferredList or
simple variants of it, or can let you separate the various behaviors of
DeferredList into simpler functions. You can also do other things that I've
occasionally wanted.  E.g., get a deferred that fires when N of the
observed deferreds have fired. Or ignore errors until one deferred
succeeds, only firing with an error if all deferreds fail. Or write a
DeferredPool with a notifyWhenEmpty method like the one I posted here about
4 years ago.

Or (a more involved example), suppose you have 3 methods that can return
you a user's avatar: a fast local cache, a filesystem, and a slow network
call to Gravatar. You want to launch all three lookups at once and use the
first answer. But if the cache and/or filesystems fails first, you don't
want an error you instead want to take the result from Gravatar and add it
to the cache and/or filesystem, as well firing a deferred with the result
(wherever it comes from). Only if all three lookups fail do you want to
receive an error.

I'll improve the examples (and probably add tests for them) at some point.
Meanwhile, the DeferredListObserver class (in txdlo.py), tests for it, and
various examples can be had from https://github.com/terrycojones/txdlo

Terry
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131230/ecc19210/attachment-0002.html>

From hs at ox.cx  Mon Dec 30 02:37:41 2013
From: hs at ox.cx (Hynek Schlawack)
Date: Mon, 30 Dec 2013 10:37:41 +0100
Subject: [Twisted-Python] txdlo - a Twisted DeferredListObserver
In-Reply-To: <CACqnu4WX0TXKBXFq7Qv8aJSnswKF-EuBXJejCcX8XTbRi9p7UA@mail.gmail.com>
References: <CACqnu4WX0TXKBXFq7Qv8aJSnswKF-EuBXJejCcX8XTbRi9p7UA@mail.gmail.com>
Message-ID: <E96F449D-2031-4ED2-82B4-89F32C0143D7@ox.cx>

On 30 Dec 2013, at 6:24, Terry Jones wrote:

> I'll improve the examples (and probably add tests for them) at some point.
> Meanwhile, the DeferredListObserver class (in txdlo.py), tests for it, and
> various examples can be had from https://github.com/terrycojones/txdlo

That’s great! Any chance of adding a license (*cough* MIT *cough*) and putting the whole thing on PyPI?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 841 bytes
Desc: OpenPGP digital signature
URL: </pipermail/twisted-python/attachments/20131230/ab605cd9/attachment.sig>

From terry at jon.es  Mon Dec 30 13:20:29 2013
From: terry at jon.es (Terry Jones)
Date: Mon, 30 Dec 2013 20:20:29 +0000
Subject: [Twisted-Python] txdlo - a Twisted DeferredListObserver
In-Reply-To: <E96F449D-2031-4ED2-82B4-89F32C0143D7@ox.cx>
References: <CACqnu4WX0TXKBXFq7Qv8aJSnswKF-EuBXJejCcX8XTbRi9p7UA@mail.gmail.com>
 <E96F449D-2031-4ED2-82B4-89F32C0143D7@ox.cx>
Message-ID: <CACqnu4U5MP12uHK-eXcmPR3i0WmuiTEJW+15aoWyPaXuM3pnVw@mail.gmail.com>

Hi Hynek

> Any chance of adding a license (*cough* MIT *cough*)

Is Apache ok for you?  If not, mail me off list and I can do MIT for you.

> and putting the whole thing on PyPI?

See https://pypi.python.org/pypi/txdlo

I added a proper README, more tests, the license, setup.py etc. See
https://github.com/terrycojones/txdlo

Terry



On Mon, Dec 30, 2013 at 9:37 AM, Hynek Schlawack <hs at ox.cx> wrote:

> On 30 Dec 2013, at 6:24, Terry Jones wrote:
>
> > I'll improve the examples (and probably add tests for them) at some
> point.
> > Meanwhile, the DeferredListObserver class (in txdlo.py), tests for it,
> and
> > various examples can be had from https://github.com/terrycojones/txdlo
>
> That’s great! Any chance of adding a license (*cough* MIT *cough*) and
> putting the whole thing on PyPI?
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131230/9f29a8fb/attachment-0002.html>

From tobias.oberstein at tavendo.de  Mon Dec 30 13:34:41 2013
From: tobias.oberstein at tavendo.de (Tobias Oberstein)
Date: Mon, 30 Dec 2013 12:34:41 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
Message-ID: <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>

Hi,

I've made Autobahn fully Endpoint aware.

You can run WebSocket over any stream-based endpoint

https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/echo_endpoints

and you can run any stream-based endpoint over WebSocket (which in turn runs over any stream-based underlying endpoint):

https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/wrapping

Endpoints are cool!

Cheers,
/Tobias

PS: Above is in the repo, but not yet released. The upcoming Autobahn 0.7.0 release will have it - as well as more, big advances.



From glyph at twistedmatrix.com  Mon Dec 30 14:41:30 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Mon, 30 Dec 2013 16:41:30 -0500
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
Message-ID: <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>


On Dec 30, 2013, at 3:34 PM, Tobias Oberstein <tobias.oberstein at tavendo.de> wrote:

> Hi,
> 
> I've made Autobahn fully Endpoint aware.
> 
> You can run WebSocket over any stream-based endpoint
> 
> https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/echo_endpoints
> 
> and you can run any stream-based endpoint over WebSocket (which in turn runs over any stream-based underlying endpoint):
> 
> https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/wrapping
> 
> Endpoints are cool!

AWESOME!!!!

I'm just thrilled at more third-party plugins starting to take advantage of this powerful extensibility API.  This looks great.

(Sorry about the somewhat poorly-thought-out syntax there, with the colons that need to be escaped all over the place; hopefully we can fix that one day somehow.)

Is there an example of doing this with 'twistd' anywhere?

-glyph


From tobias.oberstein at tavendo.de  Mon Dec 30 16:22:10 2013
From: tobias.oberstein at tavendo.de (Tobias Oberstein)
Date: Mon, 30 Dec 2013 15:22:10 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
 <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
Message-ID: <634914A010D0B943A035D226786325D4446BD1E473@EXVMBX020-12.exch020.serverdata.net>

> > Endpoints are cool!
> 
> AWESOME!!!!
> 
> I'm just thrilled at more third-party plugins starting to take advantage of this
> powerful extensibility API.  This looks great.

Thanks for endpoints! I think it's a concept in very good Unix tradition: make everything look the same (stream/endpoint). Make it transparent for users.

> (Sorry about the somewhat poorly-thought-out syntax there, with the colons
> that need to be escaped all over the place; hopefully we can fix that one day
> somehow.)

Yes;) The syntax works, but it could be nicer. Well, nothing is perfect ..

> 
> Is there an example of doing this with 'twistd' anywhere?

I was hoping you or someone could tell me how to do one;)

Thing is: I was looking for --endpoint "..." argument with twistd, but there isn't.

How is the full endpoint "vision" supposed to work out? I mean, being able to:

twistd conch --endpoint "autobahn:tcp\:80:url=ws\://myhost.com"

to run a conch server that can be accessed running SSH over WebSocket over TCP.

/Tobias

> 
> -glyph
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From hs at ox.cx  Mon Dec 30 16:54:32 2013
From: hs at ox.cx (Hynek Schlawack)
Date: Tue, 31 Dec 2013 00:54:32 +0100
Subject: [Twisted-Python] txdlo - a Twisted DeferredListObserver
In-Reply-To: <CACqnu4U5MP12uHK-eXcmPR3i0WmuiTEJW+15aoWyPaXuM3pnVw@mail.gmail.com>
References: <CACqnu4WX0TXKBXFq7Qv8aJSnswKF-EuBXJejCcX8XTbRi9p7UA@mail.gmail.com>
 <E96F449D-2031-4ED2-82B4-89F32C0143D7@ox.cx>
 <CACqnu4U5MP12uHK-eXcmPR3i0WmuiTEJW+15aoWyPaXuM3pnVw@mail.gmail.com>
Message-ID: <57F2A258-7BCB-4812-8B87-D1C166C6C49E@ox.cx>

Hey Terry,

On 30 Dec 2013, at 21:20, Terry Jones wrote:

>> Any chance of adding a license (*cough* MIT *cough*)
> Is Apache ok for you?  If not, mail me off list and I can do MIT for 
> you.

Apache is just fine for me – I use it for structlog too. I was 
suggesting MIT because that’s Twisted’s license.

>> and putting the whole thing on PyPI?
>
> See https://pypi.python.org/pypi/txdlo
>
> I added a proper README, more tests, the license, setup.py etc. See
> https://github.com/terrycojones/txdlo

Great, now I can play with it!

—h

P.S. if I can pester you any further: I’d appreciate a wheel and you 
can have a more useful PyPI entry by including the README – see 
<self-promotion> 
https://hynek.me/articles/sharing-your-labor-of-love-pypi-quick-and-dirty/ 
</self-promotion>



From hs at ox.cx  Mon Dec 30 16:56:47 2013
From: hs at ox.cx (Hynek Schlawack)
Date: Tue, 31 Dec 2013 00:56:47 +0100
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <634914A010D0B943A035D226786325D4446BD1E473@EXVMBX020-12.exch020.serverdata.net>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
 <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BD1E473@EXVMBX020-12.exch020.serverdata.net>
Message-ID: <60EA9E3E-1294-4C6B-A7FA-FFAC1C677C55@ox.cx>

On 31 Dec 2013, at 0:22, Tobias Oberstein wrote:

>> Is there an example of doing this with 'twistd' anywhere?
>
> I was hoping you or someone could tell me how to do one;)
>
> Thing is: I was looking for --endpoint "..." argument with twistd, but 
> there isn't.
>
> How is the full endpoint "vision" supposed to work out? I mean, being 
> able to:
>
> twistd conch --endpoint "autobahn:tcp\:80:url=ws\://myhost.com"
>
> to run a conch server that can be accessed running SSH over WebSocket 
> over TCP.

FWIW, the argument you’re looking for is usually called “--port”.  
The most obvious example is the web plugin.



From terry at jon.es  Mon Dec 30 19:50:12 2013
From: terry at jon.es (Terry Jones)
Date: Tue, 31 Dec 2013 02:50:12 +0000
Subject: [Twisted-Python] txdlo - a Twisted DeferredListObserver
In-Reply-To: <57F2A258-7BCB-4812-8B87-D1C166C6C49E@ox.cx>
References: <CACqnu4WX0TXKBXFq7Qv8aJSnswKF-EuBXJejCcX8XTbRi9p7UA@mail.gmail.com>
 <E96F449D-2031-4ED2-82B4-89F32C0143D7@ox.cx>
 <CACqnu4U5MP12uHK-eXcmPR3i0WmuiTEJW+15aoWyPaXuM3pnVw@mail.gmail.com>
 <57F2A258-7BCB-4812-8B87-D1C166C6C49E@ox.cx>
Message-ID: <CACqnu4Xmc6ZY_VAb4Fwq++DEgc3jz1f0sHCzJVDgE_yRBjqKbw@mail.gmail.com>

Hi Hynek

On Mon, Dec 30, 2013 at 11:54 PM, Hynek Schlawack <hs at ox.cx> wrote:

> if I can pester you any further: I’d appreciate a wheel and you can have a
> more useful PyPI entry


Thanks for your PyPI guide, it's great.  I updated to include a wheel. I
tried about 5 different ways to get it to install package data (README,
LICENSE), and failed on every attempt (I actually made this work once in
the distant past, after several hours of reading and trying). [Rant
suppressed.] I'd appreciate any further thoughts/tips re setup.py, but
maybe they're better off list.

Terry
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20131231/e7e2003d/attachment-0002.html>

From tobias.oberstein at tavendo.de  Tue Dec 31 03:41:36 2013
From: tobias.oberstein at tavendo.de (Tobias Oberstein)
Date: Tue, 31 Dec 2013 02:41:36 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <60EA9E3E-1294-4C6B-A7FA-FFAC1C677C55@ox.cx>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
 <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BD1E473@EXVMBX020-12.exch020.serverdata.net>
 <60EA9E3E-1294-4C6B-A7FA-FFAC1C677C55@ox.cx>
Message-ID: <634914A010D0B943A035D226786325D4446BD1E499@EXVMBX020-12.exch020.serverdata.net>

> > Thing is: I was looking for --endpoint "..." argument with twistd, but
> > there isn't.
> >
> > How is the full endpoint "vision" supposed to work out? I mean, being
> > able to:
> >
> > twistd conch --endpoint "autobahn:tcp\:80:url=ws\://myhost.com"
> >
> > to run a conch server that can be accessed running SSH over WebSocket
> > over TCP.
> 
> FWIW, the argument you’re looking for is usually called “--port”.
> The most obvious example is the web plugin.

Thanks! That's what I was missing.

It works: I can run

twistd -n telnet --port "autobahn:tcp\:9000:url=ws\://localhost\:9000"

and access the Python shell from a browser:

http://picpaste.com/Clipboard23-fJfJCg7E.png

I'll write a small Telnet client in JS .. and will post a complete example.

This is cool=)

/Tobias

From haggardii at gmail.com  Tue Dec 31 07:36:02 2013
From: haggardii at gmail.com (Matt Haggard)
Date: Tue, 31 Dec 2013 07:36:02 -0700
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <634914A010D0B943A035D226786325D4446BD1E499@EXVMBX020-12.exch020.serverdata.net>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
 <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BD1E473@EXVMBX020-12.exch020.serverdata.net>
 <60EA9E3E-1294-4C6B-A7FA-FFAC1C677C55@ox.cx>
 <634914A010D0B943A035D226786325D4446BD1E499@EXVMBX020-12.exch020.serverdata.net>
Message-ID: <CAL+xXwN5bp3NS28smWVe8Pge1C1omHGaobHY2TDrkKW5v7T+LA@mail.gmail.com>

Tobias,

That's neat!  Endpoints rock.  I'd like to put this up on
twistedftw.org -- I look forward to your complete example.

Matt

On Tue, Dec 31, 2013 at 3:41 AM, Tobias Oberstein
<tobias.oberstein at tavendo.de> wrote:
>> > Thing is: I was looking for --endpoint "..." argument with twistd, but
>> > there isn't.
>> >
>> > How is the full endpoint "vision" supposed to work out? I mean, being
>> > able to:
>> >
>> > twistd conch --endpoint "autobahn:tcp\:80:url=ws\://myhost.com"
>> >
>> > to run a conch server that can be accessed running SSH over WebSocket
>> > over TCP.
>>
>> FWIW, the argument you’re looking for is usually called “--port”.
>> The most obvious example is the web plugin.
>
> Thanks! That's what I was missing.
>
> It works: I can run
>
> twistd -n telnet --port "autobahn:tcp\:9000:url=ws\://localhost\:9000"
>
> and access the Python shell from a browser:
>
> http://picpaste.com/Clipboard23-fJfJCg7E.png
>
> I'll write a small Telnet client in JS .. and will post a complete example.
>
> This is cool=)
>
> /Tobias
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From tobias.oberstein at tavendo.de  Tue Dec 31 11:33:33 2013
From: tobias.oberstein at tavendo.de (Tobias Oberstein)
Date: Tue, 31 Dec 2013 10:33:33 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
 <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
Message-ID: <634914A010D0B943A035D226786325D4446BD1E62F@EXVMBX020-12.exch020.serverdata.net>

> Is there an example of doing this with 'twistd' anywhere?

I've added a generic endpoint forwarder plugin for twistd to Autobahn:

The example also includes a Terminal running in a browser, which talks over WebSocket
to the endpoint forwarder in twistd, which forwards the traffic to a Telnet server:

http://picpaste.com/Clipboard24-LLwRCPKG.png
https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/wrapping#endpoint-forwarder

In other words: this shows that endpoint plugins can be combined with twistd plugins.

The forwarder should be able to forward between any pair of Twisted stream server endpoint
to any stream client endpoint.

As soon as the Process endpoints are ready (the parsing), this would allows to expose programs stdin/stdout to WebSocket eg.
Or access any serial device over WebSocket (when serial endpoints are there).

This functionality is the equivalent (actually a superset) of the following projects:

https://github.com/kanaka/websockify
https://github.com/joewalnes/websocketd

Cheers,
/Tobias

PS 1: I couldn't get Manhole fully working with the JS Terminal:
https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/wrapping#manhole

PS 2: the forwarder is _generic_
https://github.com/tavendo/AutobahnPython/blob/master/autobahn/autobahn/twisted/forwarder.py
and probably should not be part of Autobahn but Twisted. And it should be robustified;)





From tobias.oberstein at tavendo.de  Tue Dec 31 11:36:23 2013
From: tobias.oberstein at tavendo.de (Tobias Oberstein)
Date: Tue, 31 Dec 2013 10:36:23 -0800
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <CAL+xXwN5bp3NS28smWVe8Pge1C1omHGaobHY2TDrkKW5v7T+LA@mail.gmail.com>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
 <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BD1E473@EXVMBX020-12.exch020.serverdata.net>
 <60EA9E3E-1294-4C6B-A7FA-FFAC1C677C55@ox.cx>
 <634914A010D0B943A035D226786325D4446BD1E499@EXVMBX020-12.exch020.serverdata.net>
 <CAL+xXwN5bp3NS28smWVe8Pge1C1omHGaobHY2TDrkKW5v7T+LA@mail.gmail.com>
Message-ID: <634914A010D0B943A035D226786325D4446BD1E630@EXVMBX020-12.exch020.serverdata.net>

Matt,

> That's neat!  Endpoints rock.  I'd like to put this up on twistedftw.org -- I look
> forward to your complete example.

Great! All examples and all code is here

https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/wrapping

and here

https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/echo_endpoints

Cheers,
/Tobias



From exarkun at twistedmatrix.com  Tue Dec 31 12:01:37 2013
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Tue, 31 Dec 2013 19:01:37 -0000
Subject: [Twisted-Python] Twisted Endpoints and WebSocket / Autobahn
In-Reply-To: <634914A010D0B943A035D226786325D4446BD1E62F@EXVMBX020-12.exch020.serverdata.net>
References: <634914A010D0B943A035D226786325D4446B9E0FA0@EXVMBX020-12.exch020.serverdata.net>
 <A01AA006-BEBC-406B-9B84-83392C69E15C@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446B9E1484@EXVMBX020-12.exch020.serverdata.net>
 <22CA6ECE-DD43-4C78-9452-2288287260C1@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BBDA70E@EXVMBX020-12.exch020.serverdata.net>
 <F2CC6546-1096-45DE-A1F6-6A36F0EFDF31@twistedmatrix.com>
 <634914A010D0B943A035D226786325D4446BD1E62F@EXVMBX020-12.exch020.serverdata.net>
Message-ID: <20131231190137.17936.1642533781.divmod.xquotient.6@top>

On 06:33 pm, tobias.oberstein at tavendo.de wrote:
>>Is there an example of doing this with 'twistd' anywhere?
>
>I've added a generic endpoint forwarder plugin for twistd to Autobahn:
>
>The example also includes a Terminal running in a browser, which talks 
>over WebSocket
>to the endpoint forwarder in twistd, which forwards the traffic to a 
>Telnet server:
>
>http://picpaste.com/Clipboard24-LLwRCPKG.png
>https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/wrapping 
>#endpoint-forwarder
>
>In other words: this shows that endpoint plugins can be combined with 
>twistd plugins.
>
>The forwarder should be able to forward between any pair of Twisted 
>stream server endpoint
>to any stream client endpoint.
>
>As soon as the Process endpoints are ready (the parsing), this would 
>allows to expose programs stdin/stdout to WebSocket eg.
>Or access any serial device over WebSocket (when serial endpoints are 
>there).
>
>This functionality is the equivalent (actually a superset) of the 
>following projects:
>
>https://github.com/kanaka/websockify
>https://github.com/joewalnes/websocketd
>
>Cheers,
>/Tobias
>
>PS 1: I couldn't get Manhole fully working with the JS Terminal:
>https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/websocket/wrapping#manhole
>
>PS 2: the forwarder is _generic_
>https://github.com/tavendo/AutobahnPython/blob/master/autobahn/autobahn/twisted/forwarder.py
>and probably should not be part of Autobahn but Twisted. And it should 
>be robustified;)

Indeed.  This should ultimately be what `twistd portforward` offers. :)

https://twistedmatrix.com/trac/ticket/4927 is related.

Jean-Paul



