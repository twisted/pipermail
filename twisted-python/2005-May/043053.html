<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] generating and handling events
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20generating%20and%20handling%20events&In-Reply-To=%3C0832951E-EADD-4A8F-BF74-93E1C9F2D6B8%40redivi.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="043052.html">
   <LINK REL="Next"  HREF="043101.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] generating and handling events</H1>
    <B>Bob Ippolito</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20generating%20and%20handling%20events&In-Reply-To=%3C0832951E-EADD-4A8F-BF74-93E1C9F2D6B8%40redivi.com%3E"
       TITLE="[Twisted-Python] generating and handling events">bob at redivi.com
       </A><BR>
    <I>Thu May 26 02:00:30 MDT 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="043052.html">[Twisted-Python] generating and handling events
</A></li>
        <LI>Next message (by thread): <A HREF="043101.html">[Twisted-Python] how to write an interactive client?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43053">[ date ]</a>
              <a href="thread.html#43053">[ thread ]</a>
              <a href="subject.html#43053">[ subject ]</a>
              <a href="author.html#43053">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On May 25, 2005, at 11:37 PM, theshz wrote:

&gt;<i> Hi, from the documentation I could only find examples where the  
</I>&gt;<i> events are
</I>&gt;<i> related more to Deferred, i.e., a method call that may take  
</I>&gt;<i> sometime. I'm a
</I>&gt;<i> little confused about the difference between this and the  
</I>&gt;<i> &quot;traditional&quot; kind
</I>&gt;<i> of event handling. Are they the same with just different  
</I>&gt;<i> terminology? By
</I>&gt;<i> &quot;traditional&quot;, I mean that in part of the code, I generate an  
</I>&gt;<i> event, say a
</I>&gt;<i> &quot;step 1 finished event&quot;, somewhere else there is a handler waiting  
</I>&gt;<i> for this
</I>&gt;<i> event. The reactor is responsible for dispatching this event to that
</I>&gt;<i> handler, which hopefull starts step 2. Or even more, like publish- 
</I>&gt;<i> subscribe:
</I>&gt;<i> multiple handers can register for the same event. In other words,  
</I>&gt;<i> these
</I>&gt;<i> events are generated internally, not necessarily by such delays like
</I>&gt;<i> network, file access, or user input. Is this doable in Twisted?
</I>
Deferreds are just objects that have a list of (result, error)  
callback pairs.  When the result or error is available, it's passed  
to the first appropriate callback.  The result or error returned by  
that callback is sent to the next, etc.  Its job is to pass that  
*single* result on to everything in its callback chain either one or  
zero times, and then it should be garbage collected because its job  
is done.

The way this would works is like this (bare bones example without any  
error handling, etc.):

###

from twisted.internet import defer, reactor

def step1():
     d = defer.Deferred()
     # In two seconds, call the callback with the result 42
     reactor.callLater(2.0, d.callback, 7)
     return d

def step2(resultOfStep1):
     d = defer.Deferred()
     # In two seconds, call the callback with the result of the
     # argument times 6
     reactor.callLater(2.0, d.callback, resultOfStep1 * 6)
     return d

def doAllSteps():
     # step1 returns a deferred
     d = step1()
     # step 2 takes the result of step1 as an argument
     # so we can use it as the callback for the deferred,
     # since the callback always receives the result as the
     # first argument
     d = d.addCallback(step2)
     # the other thing to note is that step2 returns a deferred, which
     # will automatically be chained, so we can just return it here
     # as our deferred
     return d

def main():
     def printResultAndQuit(result):
         print &quot;the answer is:&quot;, result
         reactor.stop()

     d = doAllSteps()
     d.addCallback(printResultAndQuit)

     # this should think for about 4 seconds,
     # print the answer to everything, and then
     # return.
     reactor.run()

if __name__ == '__main__':
     main()

###

It is an excellent primitive for building a notification system on  
top of, but it isn't one.  As you can see in Twisted's source, there  
is rarely a need for an event dispatching system, so one doesn't  
really exist (there is one on the reactor for startup and shutdown  
events, but that's about it).  In almost all cases the &quot;problem&quot; is  
solved by:
(a) having some particular name for a method to be implemented in a  
subclass (e.g. subclass LineReceiver and implement lineReceived)
(b) using a delegate that implements some method with a particular  
name (e.g. protocols telling their transport to lose connection, or  
transports notifying their protocol of a lost connection)
(c) using deferreds (i.e. twisted.web.server.Request.notifyFinish)

The only one that looks like traditional publish-subscribe is really  
the reactor's system events (twisted.internet.interfaces.IReactorCore)

-bob



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="043052.html">[Twisted-Python] generating and handling events
</A></li>
	<LI>Next message (by thread): <A HREF="043101.html">[Twisted-Python] how to write an interactive client?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43053">[ date ]</a>
              <a href="thread.html#43053">[ thread ]</a>
              <a href="subject.html#43053">[ subject ]</a>
              <a href="author.html#43053">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
