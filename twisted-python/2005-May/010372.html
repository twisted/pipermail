<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: Hanging test cases (Was: Evangelism notes...)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20Hanging%20test%20cases%20%28Was%3A%20Evangelism%20notes...%29&In-Reply-To=uk6mcjc0f.fsf%40fitlinxx.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010370.html">
   <LINK REL="Next"  HREF="010374.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: Hanging test cases (Was: Evangelism notes...)</H1>
    <B>Bob Ippolito</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20Hanging%20test%20cases%20%28Was%3A%20Evangelism%20notes...%29&In-Reply-To=uk6mcjc0f.fsf%40fitlinxx.com"
       TITLE="[Twisted-Python] Re: Hanging test cases (Was: Evangelism notes...)">bob at redivi.com
       </A><BR>
    <I>Fri May  6 17:40:06 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="010370.html">[Twisted-Python] Re: Hanging test cases (Was: Evangelism notes...)
</A></li>
        <LI>Next message: <A HREF="010374.html">[Twisted-Python] Re: Hanging test cases (Was: Evangelism notes...)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10372">[ date ]</a>
              <a href="thread.html#10372">[ thread ]</a>
              <a href="subject.html#10372">[ subject ]</a>
              <a href="author.html#10372">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On May 6, 2005, at 5:11 PM, David Bolen wrote:

&gt;<i> Jp Calderone &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">exarkun at divmod.com</A>&gt; writes:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i>   So as to be entirely clear, I'm going to limit this response to
</I>&gt;&gt;<i>   just one idea.  If more details are desired, I can post a followup
</I>&gt;&gt;<i>   later (as long as someone asks for one).  Anyway, for now, here's
</I>&gt;&gt;<i>   the meat of this post:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>       Do
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>       _____not_____
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>       use
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>       deferredResult
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>       (or deferredError or wait)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   As someone who pushed for their existence, I apologize.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Just to be clear, IMHO, I'd qualify this by saying something like in
</I>&gt;<i> final production code or non-test code or something.  We make heavy
</I>&gt;<i> use of these functions in our unit tests and they are invaluable ways
</I>&gt;<i> to simplify the structure of such tests when each test is the only
</I>&gt;<i> thing going on and there's no problem iterating the reactor beneath a
</I>&gt;<i> blocking call.  We've also cheated and used them for pure startup code
</I>&gt;<i> in GUI apps that are quick 'n dirty example interfaces into our main
</I>&gt;<i> Twisted system, and again they can simplify such efforts.
</I>&gt;<i>
</I>&gt;<i> But I do agree they really have no place in final production code.
</I>
Sorry, but Jp is right.  They have no place in any code.  Their  
existence is a mistake and should be corrected ASAP.  They severely  
violate the reactor interface.

Something almost as easy would probably be waitDeferred and  
deferredGenerator in twisted.internet.defer (I don't know when they  
went in, but they're probably in 2.0).  See the waitDeferred's doc  
string for information.

The only way they could be &quot;fixed&quot; is if their implementation did  
something more like this:

def deferredResult(d):
     &quot;&quot;&quot;untested because this code should not exist&quot;&quot;&quot;
     res = []
     def cb(result):
         res.append(result)
         reactor.stop()
     d.addBoth(cb)
     reactor.run()
     res = res.pop()
     if isinstance(res, Failure):
        failure.raiseException()
     return res

However, if their implementation did that, then the tests would  
probably break (because the tests are WRONG) or be a hell of a lot  
slower and even less reliable because there is no more timeout.

-bob



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010370.html">[Twisted-Python] Re: Hanging test cases (Was: Evangelism notes...)
</A></li>
	<LI>Next message: <A HREF="010374.html">[Twisted-Python] Re: Hanging test cases (Was: Evangelism notes...)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10372">[ date ]</a>
              <a href="thread.html#10372">[ thread ]</a>
              <a href="subject.html#10372">[ subject ]</a>
              <a href="author.html#10372">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
