<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] How to create a new service and listen on a new	port?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20How%20to%20create%20a%20new%20service%20and%20listen%20on%20a%20new%0A%09port%3F&In-Reply-To=43c0d2b5050522224949079041%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010503.html">
   <LINK REL="Next"  HREF="010505.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] How to create a new service and listen on a new	port?</H1>
    <B>mark</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20How%20to%20create%20a%20new%20service%20and%20listen%20on%20a%20new%0A%09port%3F&In-Reply-To=43c0d2b5050522224949079041%40mail.gmail.com"
       TITLE="[Twisted-Python] How to create a new service and listen on a new	port?">mark at junklight.com
       </A><BR>
    <I>Mon May 23 04:28:29 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="010503.html">[Twisted-Python] How to create a new service and listen on a new	port?
</A></li>
        <LI>Next message: <A HREF="010505.html">[Twisted-Python] How to create a new service and listen on a new	port?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10504">[ date ]</a>
              <a href="thread.html#10504">[ thread ]</a>
              <a href="subject.html#10504">[ subject ]</a>
              <a href="author.html#10504">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Killing the process is quite normal in early stage development.  
Twisted even helps with this by writing a pid file if you demonize it.

There are a number of more elegant techniques. If you intend to  
always run it from the command line as a non demon then write a  
control-c handler that gracefully stops your process.

def ctrlCHandler(*whatever):
     print &quot;Interupted&quot;
     for thread in threads:
         thread.stop()
         thread.join()

signal.signal(signal.SIGINT, ctrlCHandler)

(this is from a non-twisted application with threads :-) - I don't  
know if the signal thingy works on windows either)

The other option is to build a stop mechanism - I'm not sure from  
your description what your app does but you could send it a 'STOP'  
datagram for example that would cause it to stop nicely. Or when you  
have your client connection set up allow the client to terminate the  
process in a similar way.

you should be able to search the list at <A HREF="http://gmane.org/">http://gmane.org/</A> although I  
find gmane has a very poor UI and I find its search a bit mysterious  
too.

cheers

mark



On 23 May 2005, at 06:49, Eric Hsu wrote:

&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> This is my first post here, and I'm not a native English speaker, so
</I>&gt;<i> please bear with me :)
</I>&gt;<i> I'm trying to implement something like this:
</I>&gt;<i>
</I>&gt;<i>  * A UDP server listening on port1 for incoming request
</I>&gt;<i>  * A client sends the requset to port1
</I>&gt;<i>  * The server confirms the request and creates another (different) UDP
</I>&gt;<i> service on a new port (port2)
</I>&gt;<i>  * The client then would be able to connect to port2 and do some  
</I>&gt;<i> other things...
</I>&gt;<i>
</I>&gt;<i> By reading this &quot;Writing a New Plug-In for mktap&quot;
</I>&gt;<i>  - <A HREF="http://twistedmatrix.com/projects/core/documentation/howto/">http://twistedmatrix.com/projects/core/documentation/howto/</A> 
</I>&gt;<i> plugin.html
</I>&gt;<i>
</I>&gt;<i> I've implemented a UDP server and could run it with &quot;twisted -f&quot;.
</I>&gt;<i> Now the server receives request on port1, and creates a new service at
</I>&gt;<i> port2 for client to connect to it.
</I>&gt;<i>
</I>&gt;<i> I implemented this as the following:
</I>&gt;<i>
</I>&gt;<i> class FooServer(DatagramProtocol):
</I>&gt;<i>     def datagramReceived(self, data, addr):
</I>&gt;<i>         # do something to verify the request and send the client with
</I>&gt;<i> a confirm msg
</I>&gt;<i>         reactor.listenUDP(port2, AnotherService())
</I>&gt;<i>         reactor.run()
</I>&gt;<i>
</I>&gt;<i> class AnotherService(DatagramProtocol):
</I>&gt;<i>      # ...
</I>&gt;<i>
</I>&gt;<i> I got this up and run under windows cmd console, however, whenever I
</I>&gt;<i> try to stop the server with Ctrl + c or close the cmd console, the
</I>&gt;<i> server died in a dead loop which keeps produces tone of error
</I>&gt;<i> messages. The only way to quit that console is to &quot;kill&quot; it...
</I>&gt;<i>
</I>&gt;<i> I know there must be something wrong. I would like to know:
</I>&gt;<i>   * How could I accomplish this in a more elegant/&quot;formal&quot; way?
</I>&gt;<i>
</I>&gt;<i> I'm very new to twisted and this mailing list, if someone has asked
</I>&gt;<i> similar question before, please tell me how to find it. (BTW, how
</I>&gt;<i> could I search the mailinglist?)
</I>&gt;<i>
</I>&gt;<i> Thanks in advance! :D
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-Python mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">Twisted-Python at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python</A>
</I>&gt;<i>
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010503.html">[Twisted-Python] How to create a new service and listen on a new	port?
</A></li>
	<LI>Next message: <A HREF="010505.html">[Twisted-Python] How to create a new service and listen on a new	port?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10504">[ date ]</a>
              <a href="thread.html#10504">[ thread ]</a>
              <a href="subject.html#10504">[ subject ]</a>
              <a href="author.html#10504">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
