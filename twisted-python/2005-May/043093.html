<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] xmlrpc deferred
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20xmlrpc%20deferred&In-Reply-To=%3C20050527201147.559.32129599.divmod.quotient.11304%40ohm%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="043092.html">
   <LINK REL="Next"  HREF="043097.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] xmlrpc deferred</H1>
    <B>Jp Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20xmlrpc%20deferred&In-Reply-To=%3C20050527201147.559.32129599.divmod.quotient.11304%40ohm%3E"
       TITLE="[Twisted-Python] xmlrpc deferred">exarkun at divmod.com
       </A><BR>
    <I>Fri May 27 14:11:47 MDT 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="043092.html">[Twisted-Python] xmlrpc deferred
</A></li>
        <LI>Next message (by thread): <A HREF="043097.html">[Twisted-Python] xmlrpc deferred
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43093">[ date ]</a>
              <a href="thread.html#43093">[ thread ]</a>
              <a href="subject.html#43093">[ subject ]</a>
              <a href="author.html#43093">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 27 May 2005 22:56:49 +0300, Catalin Constantin &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">catalin at dazoot.ro</A>&gt; wrote:
&gt;<i>Friday, May 27, 2005, 10:46:21 PM, Jp Calderone wrote:
</I>&gt;&gt;<i> On Fri, 27 May 2005 22:28:06 +0300, Catalin Constantin &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">catalin at dazoot.ro</A>&gt; wrote:
</I>&gt;&gt;&gt;<i>Hi there,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>I have the following xmlrpc method:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>class FeederResource(xmlrpc.XMLRPC):
</I>&gt;&gt;&gt;<i>        def __init__(self):
</I>&gt;&gt;&gt;<i>                xmlrpc.XMLRPC.__init__(self)
</I>&gt;&gt;&gt;<i>                self.feeder=Feeder()
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>        def xmlrpc_getList(self, id):
</I>&gt;&gt;&gt;<i>                return self.feeder.get_urls(id)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>The thing is that the self.feeder.get_urls takes too long to execute
</I>&gt;&gt;&gt;<i>and while the request is running all the others are blocked.
</I>&gt;&gt;&gt;<i>I want that while it computes the result the other XML RPC methods to
</I>&gt;&gt;&gt;<i>be available.
</I>&gt;<i>
</I>&gt;&gt;<i> The only answer here is to make get_urls() take less time.
</I>&gt;<i>
</I>&gt;<i>I can't :)
</I>&gt;<i>
</I>&gt;&gt;<i> What is it doing?  Is it blocking on network I/O?  Querying a
</I>&gt;&gt;<i> database?  Prompting for user input?   _It_ should be creating and
</I>&gt;&gt;<i> returned a Deferred (and later calling it back with a result), most
</I>&gt;&gt;<i> likely, since it is the long-running operation.
</I>&gt;<i>
</I>&gt;<i>Mainly, database queries.
</I>
If the database doesn't provide an async API, threads may be the only reasonable solution.  If the database adapter is a DB-API 2.0 module, this is already available for you: twisted.enterprise.adbapi.  Otherwise, you may need to use the &quot;low level&quot; Twisted threading API, twisted.internet.threads.deferToThread(), or even reactor.callInThread() and reactor.callFromThread(), depending on your particular needs.

&gt;<i> [snip]
</I>&gt;<i>
</I>&gt;<i>What bothers me is that while the call to getList is not done all the
</I>&gt;<i>other functionality of the app is on hold.
</I>&gt;<i>
</I>
Yep.  Any time you have a function that takes a long time to run, this is going to happen.  The reactor needs to get execution time to process events, and it can't get that if application code (ie, your code) doesn't return quickly.

Jp


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="043092.html">[Twisted-Python] xmlrpc deferred
</A></li>
	<LI>Next message (by thread): <A HREF="043097.html">[Twisted-Python] xmlrpc deferred
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43093">[ date ]</a>
              <a href="thread.html#43093">[ thread ]</a>
              <a href="subject.html#43093">[ subject ]</a>
              <a href="author.html#43093">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
