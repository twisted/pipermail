<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Blocking on deferreds during unit tests (e.g.	deferredResult)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Blocking%20on%20deferreds%20during%20unit%20tests%20%28e.g.%0A%09deferredResult%29&In-Reply-To=3f085ecd050507080273093f6a%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010379.html">
   <LINK REL="Next"  HREF="010384.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Blocking on deferreds during unit tests (e.g.	deferredResult)</H1>
    <B>Jp Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Blocking%20on%20deferreds%20during%20unit%20tests%20%28e.g.%0A%09deferredResult%29&In-Reply-To=3f085ecd050507080273093f6a%40mail.gmail.com"
       TITLE="[Twisted-Python] Blocking on deferreds during unit tests (e.g.	deferredResult)">exarkun at divmod.com
       </A><BR>
    <I>Sat May  7 18:35:11 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="010379.html">[Twisted-Python] Blocking on deferreds during unit tests (e.g.	deferredResult)
</A></li>
        <LI>Next message: <A HREF="010384.html">[Twisted-Python] Blocking on deferreds during unit tests (e.g.	deferredResult)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10381">[ date ]</a>
              <a href="thread.html#10381">[ thread ]</a>
              <a href="subject.html#10381">[ subject ]</a>
              <a href="author.html#10381">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, 7 May 2005 11:02:09 -0400, Kevin Dangoor &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">dangoor at gmail.com</A>&gt; wrote:
&gt;<i>On 5/6/05, Christopher Armstrong &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">radeex at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> I'd suggest 1) not writing a unit test framework, and instead using
</I>&gt;&gt;<i> trial, and 2) instead of using stackless, use greenlet + my
</I>&gt;&gt;<i> gthreadless module that integrates greenlets and Deferreds
</I>&gt;&gt;<i> (sandbox/radix/gthreadless.py).
</I>&gt;<i>
</I>&gt;<i>gthreadless looks quite cool! From things I've seen along the way, it
</I>&gt;<i>seems that many people are turned off by the callback style of
</I>&gt;<i>programming required by an async framework like Twisted. Using
</I>&gt;<i>gthreadless, your code looks just like normal synchronous code.
</I>&gt;<i>
</I>&gt;<i>I'm only a little familiar with greenlet. Is there any significant
</I>&gt;<i>disadvantage to using this approach extensively? For example, is the
</I>&gt;<i>overhead very large?
</I>
  The main advantage is also the main disadvantage: when using gthreadless, rather than function callbacks, it becomes less obvious where context switches occur, leading to an increased likelihood of introducing concurrency-related bugs (primarily due to switches out of non-atomic operations).

  Unlike pre-emptive threads, such programming errors can be avoided entirely without the use of locks, but doing so may require more skill and attention to detail than would be required when writing the same code without gthreadless.

  This is somewhat unfortunate, since programmers least familiar with the concurrency problems solved by Twisted's current mechanisms -- function callbacks -- seem to be the most likely to be attracted by solutions like gthreadless while at the same time being the least prepared to develop software correctly with them.

  Of course, this isn't to say gthreadless isn't useful or an improvement over explicit use of Deferreds, just that caution needs to be taken in its use.  gthreadless documentation to the effect of the above paragraphs might go some ways towards letting people use it correctly, too (though since the module is still only in Chris' sandbox, I don't expect him to go out and write this right away; conversely, if someone were to contribute documentation, this might help gthreadless get released, either as part of Twisted or in a stand-alone capacity).

  Jp


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010379.html">[Twisted-Python] Blocking on deferreds during unit tests (e.g.	deferredResult)
</A></li>
	<LI>Next message: <A HREF="010384.html">[Twisted-Python] Blocking on deferreds during unit tests (e.g.	deferredResult)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10381">[ date ]</a>
              <a href="thread.html#10381">[ thread ]</a>
              <a href="subject.html#10381">[ subject ]</a>
              <a href="author.html#10381">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
