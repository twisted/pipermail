<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] [PATCH] UDP error trapping on Cygwin
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20%5BPATCH%5D%20UDP%20error%20trapping%20on%20Cygwin&In-Reply-To=8e5b27790702062027w11cf45f1gf29174c8894366e%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014789.html">
   <LINK REL="Next"  HREF="014773.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] [PATCH] UDP error trapping on Cygwin</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20%5BPATCH%5D%20UDP%20error%20trapping%20on%20Cygwin&In-Reply-To=8e5b27790702062027w11cf45f1gf29174c8894366e%40mail.gmail.com"
       TITLE="[Twisted-Python] [PATCH] UDP error trapping on Cygwin">exarkun at divmod.com
       </A><BR>
    <I>Wed Feb  7 09:57:21 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="014789.html">[Twisted-Python] [PATCH] UDP error trapping on Cygwin
</A></li>
        <LI>Next message: <A HREF="014773.html">[Twisted-Python] Re: Using twisted.trial with nose unittest system
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14777">[ date ]</a>
              <a href="thread.html#14777">[ thread ]</a>
              <a href="subject.html#14777">[ subject ]</a>
              <a href="author.html#14777">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 6 Feb 2007 23:27:23 -0500, Paul Marks &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">pmarks at purdue.edu</A>&gt; wrote:
&gt;<i>I wrote this program that uses Twisted with a bunch of UDP
</I>&gt;<i>communication, and a friend of mine got this exception while running
</I>&gt;<i>it on Cygwin:
</I>&gt;<i>
</I>&gt;<i>Traceback (most recent call last):
</I>&gt;<i>  File &quot;/usr/lib/python2.4/site-packages/twisted/python/log.py&quot;, line
</I>&gt;<i>48, in callWithLogger
</I>&gt;<i>    return callWithContext({&quot;system&quot;: lp}, func, *args, **kw)
</I>&gt;<i>  File &quot;/usr/lib/python2.4/site-packages/twisted/python/log.py&quot;, line
</I>&gt;<i>33, in callWithContext
</I>&gt;<i>    return context.call({ILogContext: newCtx}, func, *args, **kw)
</I>&gt;<i>  File &quot;/usr/lib/python2.4/site-packages/twisted/python/context.py&quot;,
</I>&gt;<i>line 59, in callWithContext
</I>&gt;<i>    return self.currentContext().callWithContext(ctx, func, *args, **kw)
</I>&gt;<i>  File &quot;/usr/lib/python2.4/site-packages/twisted/python/context.py&quot;,
</I>&gt;<i>line 37, in callWithContext
</I>&gt;<i>    return func(*args,**kw)
</I>&gt;<i>--- &lt;exception caught here&gt; ---
</I>&gt;<i>  File &quot;/usr/lib/python2.4/site-packages/twisted/internet/selectreactor.py&quot;,
</I>&gt;<i>line 139, in _doReadOrWrite
</I>&gt;<i>    why = getattr(selectable, method)()
</I>&gt;<i>  File &quot;/usr/lib/python2.4/site-packages/twisted/internet/udp.py&quot;,
</I>&gt;<i>line 114, in doRead
</I>&gt;<i>    data, addr = self.socket.recvfrom(self.maxPacketSize)
</I>&gt;<i>socket.error: (104, 'Connection reset by peer')
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>My interpretation is that windows (and therefore Cygwin) can throw a
</I>&gt;<i>Connection Reset By Peer error when receiving UDP packets, and Twisted
</I>&gt;<i>only checks for the error on win32, but not on Cygwin, because Cygwin
</I>&gt;<i>is identified as posix.
</I>&gt;<i>
</I>&gt;<i>Anyway, here's a patch I wrote that fixes the problem by checking for
</I>&gt;<i>ECONNRESET on every platform, although I'm not sure if that is the
</I>&gt;<i>correct approach.
</I>&gt;<i>
</I>
Thanks for the patch.  I'm not sure if it's correct either. ;)  Cygwin
isn't an officially supported platform for Twisted at the moment.  What
this basically means is that we don't do regular testing on Cygwin, so
this may not be the only problem you encounter.  Moreover, even if we
fix this, it's pretty unlikely anyone would notice if a subsequent change
breaks it again.

This is a pretty straightforward situation to remedy, though.  Someone
just needs to volunteer to run a Cygwin buildslave.  As long as there is
a buildslave for a platform, it'll get regular testing and changes which
break functionality (as reported by the test suite - by the way, is there
an existing failing unit test for this defect?) won't be allowed.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014789.html">[Twisted-Python] [PATCH] UDP error trapping on Cygwin
</A></li>
	<LI>Next message: <A HREF="014773.html">[Twisted-Python] Re: Using twisted.trial with nose unittest system
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14777">[ date ]</a>
              <a href="thread.html#14777">[ thread ]</a>
              <a href="subject.html#14777">[ subject ]</a>
              <a href="author.html#14777">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
