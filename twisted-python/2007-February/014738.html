<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Suppressing terminal window from	reactor.spawnProcess?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Suppressing%20terminal%20window%20from%0A%09reactor.spawnProcess%3F&In-Reply-To=1170435940.13420.38.camel%40lothar">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014736.html">
   <LINK REL="Next"  HREF="014739.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Suppressing terminal window from	reactor.spawnProcess?</H1>
    <B>Eric Mangold</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Suppressing%20terminal%20window%20from%0A%09reactor.spawnProcess%3F&In-Reply-To=1170435940.13420.38.camel%40lothar"
       TITLE="[Twisted-Python] Suppressing terminal window from	reactor.spawnProcess?">teratorn at twistedmatrix.com
       </A><BR>
    <I>Fri Feb  2 20:07:44 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="014736.html">[Twisted-Python] Suppressing terminal window from	reactor.spawnProcess?
</A></li>
        <LI>Next message: <A HREF="014739.html">[Twisted-Python] Suppressing terminal window from	reactor.spawnProcess?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14738">[ date ]</a>
              <a href="thread.html#14738">[ thread ]</a>
              <a href="subject.html#14738">[ subject ]</a>
              <a href="author.html#14738">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 02 Feb 2007 11:05:40 -0600, Steve Freitas &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">sflist at ihonk.com</A>&gt; wrote:

&gt;<i> Thanks for the very informative replies, Eric.
</I>&gt;<i>
</I>&gt;<i> On Fri, 2007-02-02 at 05:27 -0600, Eric Mangold wrote:
</I>&gt;&gt;<i> &gt; Processes on Windows will inherit the parent's console by default. So
</I>&gt;&gt;&gt;<i> when you run from the command-line it doesn't need to create a new
</I>&gt;&gt;&gt;<i> one.
</I>&gt;<i>
</I>&gt;&gt;<i> Actually CREATE_NO_WINDOW might be the flag you want. I'm not 100%
</I>&gt;&gt;<i> sure w/o running some tests.
</I>&gt;<i>
</I>&gt;<i> Okay... So I've got to somehow figure out how to launch the parent
</I>&gt;<i> Twisted instance with CREATE_NO_WINDOW (or DETACHED_PROCESS, or
</I>&gt;<i> whatever), then?
</I>
Well, no. Since you aren't seeing a console window I assume that  
pythonservice.exe is already doing that for you. Your challenge is to  
launch the child process in the same fashion.

&gt;<i> I'm using Hammond's pythonservice.exe, which was a side effect of using
</I>&gt;<i> this approach to installing and running the Windows service:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/pipermail/twisted-python/2006-August/013790.html">http://twistedmatrix.com/pipermail/twisted-python/2006-August/013790.html</A>
</I>&gt;<i>
</I>&gt;<i> Also, I have access to the source code of the process I'm launching --
</I>&gt;<i> if I can't figure out how to solve this from the Twisted side, might I
</I>&gt;<i> be able to resolve it by modifying the process I'm launching?
</I>&gt;<i>
</I>&gt;<i> Steve
</I>
It's better to control the parent process. You can easily use  
CreateProcess yourself, and use OpenProcess followed by TerminateProcess  
to kill it. All these functions are in pywin32 which you already have if  
you're using spawnProcess.

You *can*, however, close the console after it's created. Just call  
FreeConsole(). This will have the effect of flashing a console window on  
the screen for a split second. Depending on how you run your service it  
may not have access to the desktop, and I'm not sure if this will cause  
problems with launching processes that try to create console windows.

Alternatively, since this is python, and you don't care about I/O, you can  
use pythonw.exe instead.

Hope that helps,
-- 
Eric Mangold
Twisted/Win32 Co-Maintainer


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014736.html">[Twisted-Python] Suppressing terminal window from	reactor.spawnProcess?
</A></li>
	<LI>Next message: <A HREF="014739.html">[Twisted-Python] Suppressing terminal window from	reactor.spawnProcess?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14738">[ date ]</a>
              <a href="thread.html#14738">[ thread ]</a>
              <a href="subject.html#14738">[ subject ]</a>
              <a href="author.html#14738">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
