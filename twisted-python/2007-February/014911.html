<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: Making a duck-typed traceback from a Failure
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20Making%20a%20duck-typed%20traceback%20from%20a%20Failure&In-Reply-To=d06a5cd30702280043w688bebd7jd00ca896cc6f4fa2%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014908.html">
   <LINK REL="Next"  HREF="014912.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: Making a duck-typed traceback from a Failure</H1>
    <B>Jonathan Lange</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Re%3A%20Making%20a%20duck-typed%20traceback%20from%20a%20Failure&In-Reply-To=d06a5cd30702280043w688bebd7jd00ca896cc6f4fa2%40mail.gmail.com"
       TITLE="[Twisted-Python] Re: Making a duck-typed traceback from a Failure">jml at mumak.net
       </A><BR>
    <I>Wed Feb 28 19:16:17 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="014908.html">[Twisted-Python] Making a duck-typed traceback from a Failure
</A></li>
        <LI>Next message: <A HREF="014912.html">[Twisted-Python] Re: Making a duck-typed traceback from a Failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14911">[ date ]</a>
              <a href="thread.html#14911">[ thread ]</a>
              <a href="subject.html#14911">[ subject ]</a>
              <a href="author.html#14911">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2/28/07, Jonathan Lange &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">jml at mumak.net</A>&gt; wrote:
&gt;<i> Is it possible to make a duck-typed traceback from a cleaned Failure?
</I>&gt;<i> I haven't really looked into it, but I can't think of why not off the
</I>&gt;<i> top of my head. Granted I ran out of thought gluons a couple of hours
</I>&gt;<i> ago.
</I>&gt;<i>
</I>
&lt;exarkun&gt; jml: if you refine the question with some details (why isn't
there a real traceback, what do you want to do with the reconstructed
traceback, etc), I might be able to produce some useful feedback

1. Why isn't there a real traceback

The failure is caught in an errback in Trial's run().
Deferred._runCallbacks calls Failure.cleanFailure on any failures that
are returned from Deferreds. By the time the TestResult object gets
the failure, cleanFailure() has been run on it.

cleanFailure() sets Failure.tb to None, and converts all of the frames
into strings. This ensures that we don't keep references to a billion
different objects every time there is a failure.


2. What do I want to do with it

I want to pass the duck-typed traceback along with the exception type
and exception value to traceback.format_exception.


cheers,
jml


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014908.html">[Twisted-Python] Making a duck-typed traceback from a Failure
</A></li>
	<LI>Next message: <A HREF="014912.html">[Twisted-Python] Re: Making a duck-typed traceback from a Failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14911">[ date ]</a>
              <a href="thread.html#14911">[ thread ]</a>
              <a href="subject.html#14911">[ subject ]</a>
              <a href="author.html#14911">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
