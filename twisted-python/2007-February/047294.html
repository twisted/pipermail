<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Re: Using twisted.trial with nose unittest system
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Re%3A%20Using%20twisted.trial%20with%20nose%20unittest%20system&In-Reply-To=%3C20070207163510.28203.472311340.divmod.xquotient.1108%40joule.divmod.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="047292.html">
   <LINK REL="Next"  HREF="047295.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Re: Using twisted.trial with nose unittest system</H1>
    <B>glyph at divmod.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Re%3A%20Using%20twisted.trial%20with%20nose%20unittest%20system&In-Reply-To=%3C20070207163510.28203.472311340.divmod.xquotient.1108%40joule.divmod.com%3E"
       TITLE="[Twisted-Python] Re: Using twisted.trial with nose unittest system">glyph at divmod.com
       </A><BR>
    <I>Wed Feb  7 09:35:10 MST 2007</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="047292.html">[Twisted-Python] Re: Using twisted.trial with nose unittest system
</A></li>
        <LI>Next message (by thread): <A HREF="047295.html">[Twisted-Python] Re: Using twisted.trial with nose unittest system
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47294">[ date ]</a>
              <a href="thread.html#47294">[ thread ]</a>
              <a href="subject.html#47294">[ subject ]</a>
              <a href="author.html#47294">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03:32 pm, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">antoine.pitrou at wengo.com</A> wrote:
&gt;<i>
</I>&gt;<i>Hi Jean-Paul,
</I>&gt;<i>
</I>&gt;&gt;<i> The one practical problem which this method of integration has is that
</I>&gt;&gt;<i> it will not allow unit tests to run child processes.  So, one wouldn't
</I>&gt;&gt;<i> be able to run Twisted's test suite with nose using this.  Of course,
</I>&gt;&gt;<i> if one has no interest in running tests which run child processes, then
</I>&gt;&gt;<i> this may not be a big deal.
</I>&gt;<i>
</I>&gt;<i>Do you mean because the reactor does not receive signals?
</I>
Yes.  Also, it's highly likely that the tests won't stop cleanly on ^C.

More serious than the process-running issue, from my point of view, is the fact that if you forget the &quot;@deferred&quot; decorator on a test that uses any reactor API, or code that internally _uses_ any reactor API, you will put your tests into a non-deterministic state, and although they'll pass _most_ of the time, they will die depending on the load characteristics of your machine at the time and (insert long-winded rant about the evil things threads do to your code here).  Tests are exactly the place you never want this to happen :).

The documentation for this module should be clear on the fact that Twisted-using tests are _absolutely required_ to use the decorator, even if they don't need to wait on a deferred.  Of course, that implies that the &quot;you must return a twisted Deferred&quot; message should probably be removed and that case dealt with.

Also, setUp and tearDown methods also need the decorator applied, I think, not just test methods.

All in all it seems like it would be simpler to just use trials' TestCase class with nose.  Is there any reason not to?

&gt;&gt;<i> &gt;Let me give a few points as for nose vs. Trial :
</I>
You are welcome to use nose, of course, but some of these reasons sounded kind of flimsy to me.

&gt;&gt;<i> &gt;- nose does not depend on Twisted. Unless all your Python projects make
</I>&gt;&gt;<i> &gt;use of Twisted, you certainly don't like having to use a different
</I>&gt;&gt;<i> &gt;testing tool depending on the project.
</I>
Trial doesn't force your code to make use of Twisted, and as Mr. Lange has declared previously, it goes to some lengths to be compatible with stdlib unit tests.  It can run and discover stdlib tests, as well as being run by the stdlib runner, and I've used it to test tiny projects which do not use Twisted code anywhere.

So, Trial only requires Twisted insofar as Nose requires Nose.  It's part of its implementation.  If you use Twisted for _any_ of your development, it's already installed.

&gt;&gt;<i> &gt;- nose has nice features, including the ability to write tests as
</I>&gt;&gt;<i> &gt;functions without having to write classes
</I>
This just sounds like TIMTOWTDI to me.  I *like* the fact that all test methods look the same ;).

&gt;&gt;<i> &gt;- nose has a plugin system which already provides several extensions
</I>
In the spirit of completeness, see trial's --help-reporters and --reporter option.  These are discovered using plugins.

Please do not take this argument seriously though.  :)  There is widespread consensus that this plugin API is not very good and it is likely to change.  Still, it exists and you can use it.

See:
    <A HREF="http://twistedmatrix.com/trac/browser/sandbox/exarkun/merit/trunk/twisted/plugins/rr.py">http://twistedmatrix.com/trac/browser/sandbox/exarkun/merit/trunk/twisted/plugins/rr.py</A>

Although, perhaps the utility of the plugin system is decreased more by the fact that nobody knows about it than by its sub-optimal API, which leads into your next point...

&gt;&gt;<i> &gt;- nose is documented
</I>
This is a very, very good point.  Trial's documentation is extremely weak.

Does anyone (and by &quot;anyone&quot; I mean &quot;anyone but JML, who has already done more work on trial than any reasonable person ever would&quot;) want to volunteer to write a &quot;test driven development with Twisted&quot; lore document?  I've introduced many people to Twisted in recent weeks, and each time I ended up having to do a live demonstration of how to write a test module, how to run the trial command line, and (for those lucky enough to use emacs) how to get twisted-dev.el loaded so that f9 will do the right thing.  This stuff isn't clear even to people already familiar with Python and unit testing, let alone to people who are learning TDD for the first time with trial.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20070207/4263516a/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="047292.html">[Twisted-Python] Re: Using twisted.trial with nose unittest system
</A></li>
	<LI>Next message (by thread): <A HREF="047295.html">[Twisted-Python] Re: Using twisted.trial with nose unittest system
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47294">[ date ]</a>
              <a href="thread.html#47294">[ thread ]</a>
              <a href="subject.html#47294">[ subject ]</a>
              <a href="author.html#47294">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
