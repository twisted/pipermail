<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] testing for error conditions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20testing%20for%20error%20conditions&In-Reply-To=62ad745a0702012143m629ac54asfe83f0b93e4787a9%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014729.html">
   <LINK REL="Next"  HREF="014731.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] testing for error conditions</H1>
    <B>Jonathan Lange</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20testing%20for%20error%20conditions&In-Reply-To=62ad745a0702012143m629ac54asfe83f0b93e4787a9%40mail.gmail.com"
       TITLE="[Twisted-Python] testing for error conditions">jml at mumak.net
       </A><BR>
    <I>Fri Feb  2 01:01:31 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="014729.html">[Twisted-Python] testing for error conditions
</A></li>
        <LI>Next message: <A HREF="014731.html">[Twisted-Python] Suppressing terminal window from	reactor.spawnProcess?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14730">[ date ]</a>
              <a href="thread.html#14730">[ thread ]</a>
              <a href="subject.html#14730">[ subject ]</a>
              <a href="author.html#14730">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2/2/07, gary jefferson &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">garyjefferson123 at gmail.com</A>&gt; wrote:
&gt;<i> I've got a little test program that checks to make sure my protocol
</I>&gt;<i> behaves correctly.  Each function returns a deferred, and sets the
</I>&gt;<i> next function as the callback, and some common function as errback.
</I>&gt;<i> This seems to work great -- the test runs through all the test funcs
</I>&gt;<i> when working properly, and halts at the problem point if not.
</I>&gt;<i>
</I>&lt;snip&gt;
&gt;<i> Whats the right way to test conditions that should trigger errbacks?
</I>&gt;<i> I couldn't see a tutorial or doc that covered this.
</I>&gt;<i>
</I>
Hey Gary,

Twisted's unit testing framework, Trial, already has a bunch of
features to make this really easy.

Make a module that contains subclasses of
twisted.trial.unittest.TestCase. The code should look something like
this:

from twisted.trial import unittest

class YourTests(unittest.TestCase):
    def setUp(self):
        self.interestingProtocol = InterestingProtocol()

    def test_successPath(self):
        d = self.interestingProtocol.doSomethingSuccessfully()
        d.addCallback(lambda val: self.assertEqual(val, &quot;expected&quot;))
        return d

    def test_failurePath(self):
        d = self.interestingProtocol.causeErrback()
        return self.assertFailure(d, ExpectedError)


Notice that the two tests in this module both return Deferreds. Trial
will notice this and make sure that the tests are run in sequence.

To run the tests, simple go &quot;trial
yourpackage.test.test_interestingprotocol&quot; on the command line. Trial
accepts paths to files or fully-qualified Python names. If you specify
a package, it will recursively look for all modules under that package
that have names starting with 'test_'.

For more information, consult the API docs for twisted.trial.unittest
and the man page for 'trial'.

I'm sorry that there's not a better overview document for writing
tests for Twisted applications. As the Trial maintainer, it's been on
my radar for some time.

Hope this helps,
jml


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014729.html">[Twisted-Python] testing for error conditions
</A></li>
	<LI>Next message: <A HREF="014731.html">[Twisted-Python] Suppressing terminal window from	reactor.spawnProcess?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14730">[ date ]</a>
              <a href="thread.html#14730">[ thread ]</a>
              <a href="subject.html#14730">[ subject ]</a>
              <a href="author.html#14730">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
