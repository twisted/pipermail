<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Reactor getting stuck in random places on	Windows?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Reactor%20getting%20stuck%20in%20random%20places%20on%0A%09Windows%3F&In-Reply-To=%3Cop.tm6hrctsy3d107%40office2%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="047249.html">
   <LINK REL="Next"  HREF="047257.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Reactor getting stuck in random places on	Windows?</H1>
    <B>Eric Mangold</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Reactor%20getting%20stuck%20in%20random%20places%20on%0A%09Windows%3F&In-Reply-To=%3Cop.tm6hrctsy3d107%40office2%3E"
       TITLE="[Twisted-Python] Reactor getting stuck in random places on	Windows?">teratorn at twistedmatrix.com
       </A><BR>
    <I>Sat Feb  3 08:10:14 MST 2007</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="047249.html">[Twisted-Python] Reactor getting stuck in random places on Windows?
</A></li>
        <LI>Next message (by thread): <A HREF="047257.html">[Twisted-Python] Reactor getting stuck in random places on	Windows?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47252">[ date ]</a>
              <a href="thread.html#47252">[ thread ]</a>
              <a href="subject.html#47252">[ subject ]</a>
              <a href="author.html#47252">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 02 Feb 2007 23:13:36 -0600, Steve Freitas &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">sflist at ihonk.com</A>&gt; wrote:

&gt;<i> I'm writing a Twisted client that uses PB. It seems to be getting stuck
</I>&gt;<i> intermittently -- failing to respond to the server's queries. Sometimes
</I>&gt;<i> it gets stuck immediately after login, sometimes after it's been running
</I>&gt;<i> fine for a while. I'm starting the Twisted client in a terminal window.
</I>&gt;<i> What unsticks it in these cases is always a single ^C. Now, sometimes
</I>&gt;<i> that spits up an unhandled exception from some place into the log
</I>&gt;<i> (stdout) and then it goes on its merry way -- other times it has no
</I>&gt;<i> error to report and moves on like nothing happened.
</I>&gt;<i>
</I>&gt;<i> I'm frequently ctrl-C'ing this program as I try my new changes, and
</I>&gt;<i> sometimes it takes one to kill it, and sometimes it takes two. Hopefully
</I>&gt;<i> this is a clue.
</I>&gt;<i>
</I>&gt;<i> I thought perhaps I had a deferred that was hanging, but in the entire
</I>&gt;<i> client, I'm calling addCallback() exactly once -- and it's followed by
</I>&gt;<i> an addErrback(), so I don't think the problem is there.
</I>&gt;<i>
</I>&gt;<i> I first noticed this behavior when it was running as a Windows service,
</I>&gt;<i> and I thought it may have been related to the necessity of starting the
</I>&gt;<i> reactor with calling reactor.run(installSignalHandlers=0) (I didn't yet
</I>&gt;<i> see the tip about periodically passing child signals to the reactor),
</I>&gt;<i> but it still happens, albeit apparently less often, with a simple
</I>&gt;<i> reactor.run().
</I>&gt;<i>
</I>&gt;<i> Any ideas would be appreciated.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> Steve
</I>
Well I don't really know what your problem is, but here are some things  
you can think about and see if any little lights go off in your head :)

Are you running sub-processes? If a sub-process shares the same console  
some interesting things can happen.

There isn't any way to tell which process will receive console input. See  
this page for what Microsoft has to say about it:
<A HREF="http://msdn2.microsoft.com/en-us/library/ms682528.aspx">http://msdn2.microsoft.com/en-us/library/ms682528.aspx</A>

In particular:

&quot;(By default, a console process inherits its parent's console, and there  
is no guarantee that input is received by the process for which it was  
intended.)&quot;

Indeed, you can verify this by running a parent process and a child  
process that both read bytes from stdin. You will see that the bytes are  
sent to one process or the other. In my testing it alternated back and  
forth evenly.

Other forms of console input, such as ^C, seem to go to both processes at  
the same time. At least that is what happened in my simple test.

Maybe for you it's only delivering the ^C to one of the procsses, and  
sometimes it's the right one and sometimes not?

Or maybe it's much simpler than this and you just have a bare &quot;except:&quot;  
that is catching and hiding the first KeyboardInterrupt?

As for why your process is hanging in the first place, who is to say?  
Maybe try running under WingIDE (or something) and break in w/ the  
debugger when things hang up. The stack trace ought to give you some clues.

Hope that helps,
-- 
Eric Mangold
Twisted/Win32 Co-Maintainer


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="047249.html">[Twisted-Python] Reactor getting stuck in random places on Windows?
</A></li>
	<LI>Next message (by thread): <A HREF="047257.html">[Twisted-Python] Reactor getting stuck in random places on	Windows?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47252">[ date ]</a>
              <a href="thread.html#47252">[ thread ]</a>
              <a href="subject.html#47252">[ subject ]</a>
              <a href="author.html#47252">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
