<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] T9217 / PR1052: Wheels, wheels, and more wheels
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20T9217%20/%20PR1052%3A%20Wheels%2C%20wheels%2C%20and%20more%20wheels&In-Reply-To=%3C365DD63E-800D-49A4-A070-5BAE0B860AE3%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] T9217 / PR1052: Wheels, wheels, and more wheels</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20T9217%20/%20PR1052%3A%20Wheels%2C%20wheels%2C%20and%20more%20wheels&In-Reply-To=%3C365DD63E-800D-49A4-A070-5BAE0B860AE3%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] T9217 / PR1052: Wheels, wheels, and more wheels">glyph at twistedmatrix.com
       </A><BR>
    <I>Wed Sep  5 01:25:19 MDT 2018</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64511">[ date ]</a>
              <a href="thread.html#64511">[ thread ]</a>
              <a href="subject.html#64511">[ subject ]</a>
              <a href="author.html#64511">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

&gt;<i> On Aug 29, 2018, at 10:13 AM, Kyle Altendorf &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">sda at fstab.net</A> &lt;mailto:<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">sda at fstab.net</A>&gt;&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Hi All,
</I>
Hi Kyle!

&gt;<i> I am working on ticket #9217 / PR #1051 to add lots more wheel generation to the Twisted CI.  I decided to give the cibuildwheel package a try and it made this process almost too easy (well... sort of :] ).  I've got AppVeyor-Windows, Travis-Linux, and Circle-OSX all building a variety of wheels for the supported Python versions and bit depths.  Travis doesn't save artifacts 'easily' so I went ahead and doubled up on Linux on Circle for now, though it's having some Docker issues at the moment and hasn't been successful yet.  For some reason in this one case the project directory isn't getting mounted into the container as expected.
</I>
Thanks for doing this!

&gt;<i> wheel links:
</I>&gt;<i> <A HREF="https://github.com/twisted/twisted/pull/1051#issuecomment-416743261">https://github.com/twisted/twisted/pull/1051#issuecomment-416743261</A> &lt;<A HREF="https://github.com/twisted/twisted/pull/1051#issuecomment-416743261">https://github.com/twisted/twisted/pull/1051#issuecomment-416743261</A>&gt; (and next comment)
</I>&gt;<i> 
</I>&gt;<i> Now that I've got the wheel builds happening I figured it'd be good to try them out on 'real' machines.  Turns out we get a failure on twisted.cred.test.test_strcred.SSHCheckerTests.test_isChecker for at least the two checks I've done so far (Windows and OSX).  I haven't done more than a cursory look at that yet, but it's on the list to understand and resolve.  More testing would of course be welcome.  Real world, just trial Twisted's own tests, whatever would be appreciated if you are interested.
</I>&gt;<i> 
</I>&gt;<i> failures with wheels:
</I>&gt;<i> <A HREF="https://github.com/twisted/twisted/pull/1051#issuecomment-416977723">https://github.com/twisted/twisted/pull/1051#issuecomment-416977723</A> &lt;<A HREF="https://github.com/twisted/twisted/pull/1051#issuecomment-416977723">https://github.com/twisted/twisted/pull/1051#issuecomment-416977723</A>&gt;
</I>
It's not clear to me that we have any test environments that accurately test what happens after you install from PyPI.  If we could build these wheels and then actually run tests on installing them that would be a big step forward in test fidelity!  But given the current state of the art, I'd be happy if they just got built from the same code that passed our tests in existing configurations.

&gt;<i> Overall, it's a bit unclear what the intended use of the various CI hosts are for Twisted.
</I>
Ideally, Travis would handle it all.

But Travis can't run multiple kernels, so we have buildbots for lots of alternate kernels, just to make sure.  Including BSD kernels, since those are actually substantially different where sockets are concerned.

And Travis macOS support is so slow that it was a serious blocker for a while, so the buildbot is filling in until Circle can take over.

And Travis can't do Windows, so that's where appveyor comes in.

There might still be various non-special-kernel testing things that buildbot does, but those are probably holdovers that, if they still have a reason to exist, it's exactly because Travis doesn't have artifact hosting.

Hopefully that's comprehensive?

&gt;<i> I hear that Travis OSX builds were really slow, but from what I can see Circle isn't doing any OSX (other than what I added).
</I>
The issue for addressing this is <A HREF="https://twistedmatrix.com/trac/ticket/9445">https://twistedmatrix.com/trac/ticket/9445</A> &lt;<A HREF="https://twistedmatrix.com/trac/ticket/9445">https://twistedmatrix.com/trac/ticket/9445</A>&gt; if you'd like to pick up where Adi left off.  It's probably just resolving some conflicts, resubmitting for review, and bugging people to get it through the process :).

&gt;<i> There wasn't any artifact storage being used on Circle either.  So, I'm not sure if there was a reason to use Circle that went away, or...  But, not having to hook Travis up to S3 or somesuch for storage is quite nice so Circle wins at least in that category.
</I>
I think the big problem on Circle is capacity limits, but I don't know if that's just a macOS thing, or what.

&gt;<i> Now that I've got something rough in place, are there any opinions about how this should work?  I don't know the present release workflow so I don't know if we'd want an automatic push to PyPI on tags (probably not)
</I>
I definitely want this.  This is really the whole point, what we're trying to get to :).  Why don't you think we want this?

&gt;<i> or just artifacts on the build server to grab manually (would need some S3 or such for Travis, or Circle for Linux builds as well).  Anything else?  Do we want automated tests against the wheels?  cibuildwheel does have a feature for that though I haven't done anything with it yet.
</I>
Ideally we'd push the wheels on tag once the tests passed, but I'd be OK with just unconditionally just building / pushing on tag for starters.

&gt;<i> Anyways...  hello, thanks for Twisted, and I hope this work ends up saving some people some time.
</I>
I can't wait for fully automated releases :).
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20180905/610c4203/attachment-0002.html&gt;
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64511">[ date ]</a>
              <a href="thread.html#64511">[ thread ]</a>
              <a href="subject.html#64511">[ subject ]</a>
              <a href="author.html#64511">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
