<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Writing a shutdown command that sends an ACK back
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Writing%20a%20shutdown%20command%20that%20sends%20an%20ACK%20back&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019509.html">
   <LINK REL="Next"  HREF="019512.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Writing a shutdown command that sends an ACK back</H1>
    <B>Rutt, Benjamin</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Writing%20a%20shutdown%20command%20that%20sends%20an%20ACK%20back&In-Reply-To="
       TITLE="[Twisted-Python] Writing a shutdown command that sends an ACK back">Benjamin.Rutt at gs.com
       </A><BR>
    <I>Wed Apr 15 16:32:48 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="019509.html">[Twisted-Python] Ldaptor for a simple python LDAP server
</A></li>
        <LI>Next message: <A HREF="019512.html">[Twisted-Python] Writing a shutdown command that sends an ACK back
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19510">[ date ]</a>
              <a href="thread.html#19510">[ thread ]</a>
              <a href="subject.html#19510">[ subject ]</a>
              <a href="author.html#19510">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Is there a good way, in, say, a LineReceiver based server, to implement
a bit of code in lineReceived() that, if you receive a line like, let's
say, 'shutdown' from a client, you can call:

1) self.transport.write('goodbye\n')  # send a goodbye message to the
client

And then call

2) self.transport.close() # close the client's socket

And then

3) reactor.stop()  # terminate the server

The problem I'm finding is that since I believe self.transport.write()
enqueues the writing for later, and self.transport.close() enqueues the
closing for later, both to be picked up by the reactor soon after my
lineReceived() returns, so then if you stop the reactor in #3, it won't
be available anymore to carry out any enqueued tasks for you.  At least
I think that's what's happening in my code.

Is there any good workarounds?  E.g., is reactor.callLater(5,
reactor.stop) too much of a hack?


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019509.html">[Twisted-Python] Ldaptor for a simple python LDAP server
</A></li>
	<LI>Next message: <A HREF="019512.html">[Twisted-Python] Writing a shutdown command that sends an ACK back
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19510">[ date ]</a>
              <a href="thread.html#19510">[ thread ]</a>
              <a href="subject.html#19510">[ subject ]</a>
              <a href="author.html#19510">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
