<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] policies.py change in 2.0
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20policies.py%20change%20in%202.0&In-Reply-To=%3C426017BD.1060800%40osafoundation.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="042684.html">
   <LINK REL="Next"  HREF="042637.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] policies.py change in 2.0</H1>
    <B>Brian Kirsch</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20policies.py%20change%20in%202.0&In-Reply-To=%3C426017BD.1060800%40osafoundation.org%3E"
       TITLE="[Twisted-Python] policies.py change in 2.0">bkirsch at osafoundation.org
       </A><BR>
    <I>Fri Apr 15 13:36:29 MDT 2005</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="042684.html">[Twisted-Python] A small patch for defer.py
</A></li>
        <LI>Next message (by thread): <A HREF="042637.html">[Twisted-Python] policies.py change in 2.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42635">[ date ]</a>
              <a href="thread.html#42635">[ thread ]</a>
              <a href="subject.html#42635">[ subject ]</a>
              <a href="author.html#42635">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey guys,
Question for you. In the 2.0 Twisted release the 
policies.ProtocolWrapper changed on line 31 to now set the 
wrappedProtocol.factory to point to the wrappingFactory.


  def __init__(self, factory, wrappedProtocol):
        self.wrappedProtocol = wrappedProtocol
&lt;      self.factory = factory
 &gt;      self.factory = wrappedProtocol.factory = factory



 I was wondering what the reason for the change was? The change caused 
our current code to break (an easy fix). It seems to me that the wrapper 
should be transparent to the wrappedProtocol. Changing the protocol's 
factory leads to unexpected behavior if that protocol is depending on 
specific methods or data in the  factory. In fact this change actually 
breaks the Twisted smtp.py code.

   def getMailFrom(self):
        if not self.done:
            self.done = 1
          /  return str(self.factory.fromEmail) #this will now break if 
wrapped/
        else:
            return None


Brian Kirsch - Email Framework Engineer
Open Source Applications Foundation
543 Howard St. 5th Floor
San Francisco, CA 94105
(415) 946-3056
<A HREF="http://www.osafoundation.org">http://www.osafoundation.org</A>



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="042684.html">[Twisted-Python] A small patch for defer.py
</A></li>
	<LI>Next message (by thread): <A HREF="042637.html">[Twisted-Python] policies.py change in 2.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#42635">[ date ]</a>
              <a href="thread.html#42635">[ thread ]</a>
              <a href="subject.html#42635">[ subject ]</a>
              <a href="author.html#42635">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
