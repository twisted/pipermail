<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Foreign event loop friendly reactor
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Foreign%20event%20loop%20friendly%20reactor&In-Reply-To=4262E170.5070804%40sbcglobal.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010145.html">
   <LINK REL="Next"  HREF="010147.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Foreign event loop friendly reactor</H1>
    <B>Bob Ippolito</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Foreign%20event%20loop%20friendly%20reactor&In-Reply-To=4262E170.5070804%40sbcglobal.net"
       TITLE="[Twisted-Python] Foreign event loop friendly reactor">bob at redivi.com
       </A><BR>
    <I>Sun Apr 17 18:45:47 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="010145.html">[Twisted-Python] Foreign event loop friendly reactor
</A></li>
        <LI>Next message: <A HREF="010147.html">[Twisted-Python] Foreign event loop friendly reactor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10146">[ date ]</a>
              <a href="thread.html#10146">[ thread ]</a>
              <a href="subject.html#10146">[ subject ]</a>
              <a href="author.html#10146">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Apr 17, 2005, at 6:21 PM, Shawn Church wrote:

&gt;<i> Bob Ippolito wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> In response to the &quot;wxpython issues&quot; thread I had suggested that we
</I>&gt;&gt;<i> should have a thread-using reactor that integrates with foreign event
</I>&gt;&gt;<i> loops, so I wrote one and committed it
</I>&gt;&gt;<i> (twisted.internet.threadedselectreactor).  Since this approach
</I>&gt;&gt;<i> requires less maintenance, and whomever maintains the select reactor
</I>&gt;&gt;<i> can trivially maintain this as well, I'm &quot;officially&quot; deprecating
</I>&gt;&gt;<i> cfreactor (although I never really cared much to maintain it anyway).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> An example of using it to integrate with a foreign event loop is at:
</I>&gt;&gt;<i> doc/core/examples/Cocoa/SimpleWebClient
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It should be relatively trivial to show how it could be used to
</I>&gt;&gt;<i> integrate with other event loops (wx, Tkinter, pygame, etc.).
</I>&gt;&gt;<i> Effectively, it's compatible with anything that has a thread-safe way
</I>&gt;&gt;<i> to notify the main event loop.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In the future, it might make sense to revise the reactor API to
</I>&gt;&gt;<i> support &quot;interleave&quot; directly, and change the existing reactors
</I>&gt;&gt;<i> accordingly so that more than just select can support this behavior.
</I>&gt;&gt;<i>
</I>&gt;<i> Thanks for your work in developing this new reactor.  I just have a
</I>&gt;<i> couple questions:
</I>&gt;<i>
</I>&gt;<i> Is it (thread) safe to call wx methods from within call/errbacks with
</I>&gt;<i> this reactor?  I ask because I was (based upon the example at
</I>&gt;<i> <A HREF="http://solipsis.netofpeers.net/wiki/wikka.php?wakka=WxTwistedExample">http://solipsis.netofpeers.net/wiki/wikka.php?wakka=WxTwistedExample</A>)
</I>&gt;<i> translating callbacks into wx.Events executed during the next wx loop
</I>&gt;<i> (the PostEvent function is thread safe).
</I>
Forget everything you ever learned about wxPython/Twisted integration.  
It is no longer relevant.  Forget that any of the ugly wxPython+Twisted 
Python Cookbook entries, lame wiki examples, 
twisted.internet.wxreactor, etc. even exist.

&gt;<i> If I am understanding the
</I>&gt;<i> threadedselectreactor.py code correctly it is &quot;waking&quot; the wx loop and
</I>&gt;<i> therefore this should not be needed since only one mainloop will be
</I>&gt;<i> active at a time.
</I>
threadedselectreactor lets you imagine that you're in a wonderful 
single threaded world where everything happens in a context where 
calling into Twisted and wxPython are both safe (unless you explicitly 
make life suck by creating more threads).

&gt;<i> Also my understanding is that the reactor.interleave function should be
</I>&gt;<i> called ONCE in order to provide a function to wake the foreign event
</I>&gt;<i> loop.  I am doing this in MyApp.OnInit() and it seems to work fine.  
</I>&gt;<i> The
</I>&gt;<i> example shows this being executed in the frame's __init__ function and 
</I>&gt;<i> I
</I>&gt;<i> do not think this will work for multiple frames (I'm not saying there 
</I>&gt;<i> is
</I>&gt;<i> anything WRONG with the example,  I'm just trying to make sure I
</I>&gt;<i> understand the correct use of the new reactor when dealing with 
</I>&gt;<i> multiple
</I>&gt;<i> wxWindow objects).
</I>
Yes it should be called exactly once.  The example does it for the main 
frame.  It is done there because that is the same frame that quits the 
application when it's closed, so it also integrates with reactor.stop.

-bob



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010145.html">[Twisted-Python] Foreign event loop friendly reactor
</A></li>
	<LI>Next message: <A HREF="010147.html">[Twisted-Python] Foreign event loop friendly reactor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10146">[ date ]</a>
              <a href="thread.html#10146">[ thread ]</a>
              <a href="subject.html#10146">[ subject ]</a>
              <a href="author.html#10146">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
