From glyph at twistedmatrix.com  Fri Jan  2 19:30:25 2004
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Fri, 2 Jan 2004 18:30:25 -0600
Subject: [Twisted-Python] Technical Difficulties
Message-ID: <05D48B3E-3D84-11D8-8F96-000393C9700E@twistedmatrix.com>

Twistedmatrix.com is about to experience some significant technical 
difficulties.  As I am moving to Boston and the domain is hosted on my 
personal DSL, it will have nowhere to be for a little while.

Sometime after midnight CST tonight, I will be taking the machine down 
for a full backup in case there are problems in transit.  After that, I 
will be removing the hard drive and putting it in a box to mail 
somewhere in Maryland.  If it gets there, it will not be my fault if 
service is resumed within the week.

If and when service _is_ resumed, we all owe a very big thank you to 
Divmod, who is graciously offering to host the machine in more-or-less 
its current form.

Just to be clear: this means that the website, email, buildbot, CVS, 
wiki, and DNS services will _all_ be down.  If you have a personal 
webserver on pyramid it will also be down.  I have already redirected 
our primary DNS so that the rest of the system administration team 
should be able to make sure that we do not lose email.

I am sorry if this is the first notification you have recieved of this 
impending shutdown, but things have been fairly hectic over here.

Thank you.




From glyph at twistedmatrix.com  Thu Jan  1 01:23:03 2004
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 1 Jan 2004 01:23:03 -0500
Subject: [Twisted-Python] SSL Client Certificate support
In-Reply-To: <1072892345.5943.34.camel@pascal>
References: <1072889782.5864.27.camel@pascal>  <1072890295.28549.53.camel@sheriffpony> <1072892345.5943.34.camel@pascal>
Message-ID: <F471E51A-3C22-11D8-9071-000393C9700E@twistedmatrix.com>


On Dec 31, 2003, at 12:39 PM, Martin Waite wrote:

> Many thanks - this all works beautifully.

Easier might be

from twisted.internet.ssl import DefaultOpenSSLContextFactory
ctxfac = DefaultOpenSSLContextFactory(privkey, certfile)
ctxfac.isClient = True

I would like to discourage the use of context factories outside the 
default one unless absolutely necessary - the current notion of 
"context factory" is an ugly hack that requires direct access to the 
PyOpenSSL libraries.  This will be harmful for future compatibility to, 
say, an upcoming Jython release with Java SSL support rather than 
OpenSSL.

Changing something with "OpenSSL" in its name to be a Java SSL factory 
will certainly be an ugly workaround, but _less_ ugly than trying to 
fake out the actual PyOpenSSL API by stuffing sys.modules.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 186 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040101/2283a144/attachment.pgp 

From exarkun at intarweb.us  Thu Jan  1 01:38:10 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 1 Jan 2004 01:38:10 -0500
Subject: [Twisted-Python] Where is best place to put my custom code?
In-Reply-To: <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com>
References: <3FF120BE.3010504@paradise.net.nz> <14E99DCD-3B3E-11D8-BB69-0030656C6B9E@webcrunchers.com> <200312311211.31399.teratorn@world-net.net> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com>
Message-ID: <20040101063810.GB26751@intarweb.us>

On Wed, Dec 31, 2003 at 03:58:50PM -0800, JD wrote:
> Hi,
> 
> I'm open for suggestions on where I can put my customized code.    I seem
> to have a choice between putting it in the "factory" or in the "protocol",
> and I cannot seem to decide where the best place would be.
> 
> My application is simple.....   here is all it should do....
> 
> 1) establish a connection to an IRC server.
> 2) send an IRC command,  like a "who" command,  and extract the info
> 3) then exit the client
> 
> I could put my code in the IRCClient's "connectionMade" method.    Or I
> could put it in the factory's "startedConnecting" method.  The code would
> be simple, issue a "who" command, and take it's output and return it.  So,
> in my connectionMade method I would issue the command...  then call
> reactor.stop() which would exit from my reactor.run().
> 

  startedConnecting isn't the right place.  connectionMade is a little
closer, but since you need to log in (tell the IRC server your nickname,
etc) before you can issue commands like WHO, it isn't totally appropriate
either.  signedOn is the best place, since it is called by IRCClient once
the server acknowledges the login information.

> I think the factory's "startedConnecting" might get called first,  then
> somewhere down in this mess, the Client would call me back with the
> "connectionMade", and I could do it there. I just need to know the
> appropriate place to put my code.  None of these examples in the
> 'examples' directories make this clear.
> 
> My next task is to know how to extract the 'who' data back from my initial
> "who"

  Indeed.  This is not very easy to do with IRCClient, since the response
the server sends doesn't have a whole lot to associate it with the WHO
command you originally issued.  You need to keep track of outstanding
commands and try to match them up with server replies.

  I recognized this deficiency some time ago and did some initial work
towards improving the API.  WHO is one of the commands I did manage to
improve, but I never moved any of the work out of my sandbox.  You can find
it in Twisted/sandbox/exarkun/irc2.py.  It is under the same license as the
rest of Twisted, even though it currently lacks any indication fo that.  If
it would be helpful to you, please feel free to use it.

  The improvements take one general form: commands which will produce server
responses are exposed as functions which return a Deferred.  When the server
replies, the parsed information will be passed to that Deferred's callback.

  Here is a simple example of how you might use it (untested):

    class WhoingIRCClient(irc2.AdvancedClient):
        def signedOn(self):
            # Find everyone IRC'ing from Twisted Matrix's server.
            self.who('*twistedmatrix.com'
                ).addCallbacks(self._cbWho, self._ebWho
                ).addBoth(self._shutdownEverything
                )

        def _cbWho(self, results):
            print 'channel user host server nick flags hops realname'
            for r in results:
                print ', '.join(r)

        def _ebWho(self, failure)
            print 'Error in who!'
            log.err(failure)


        def _shutdownEverything(self, ignored):
            reactor.stop()

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040101/279f3426/attachment.pgp 

From lists at webcrunchers.com  Thu Jan  1 02:22:36 2004
From: lists at webcrunchers.com (JD)
Date: Wed, 31 Dec 2003 23:22:36 -0800
Subject: [Twisted-Python] Re: IRC Client examples...  PLEASE HELP
In-Reply-To: <3FF39441.7020600@csrules.dyndns.org>
References: <3FF120BE.3010504@paradise.net.nz> <14E99DCD-3B3E-11D8-BB69-0030656C6B9E@webcrunchers.com> <200312311211.31399.teratorn@world-net.net> <20031231205249.GA25692@intarweb.us> <072928DC-3BEA-11D8-ADCB-0030656C6B9E@webcrunchers.com> <3FF39441.7020600@csrules.dyndns.org>
Message-ID: <45EA9A45-3C2B-11D8-ADCB-0030656C6B9E@webcrunchers.com>

On Dec 31, 2003, at 7:30 PM, darryl wrote:

> This means he coded support for ident and added that to cvs 
> (twisted.protocols.ident).
> Client and server.  No he did not code IRC client examples if that's 
> what your
> asking ?

Why can't anyone post just a teeny little bit of information on how to 
tie all this
together?

One of my main problems is where to put my code.   Do I put it in the 
factory class,
or do I put it in the Client class?   One always points to the other.   
I suppose it don't really matter,
but I'm sure the author(s) of twisted have their OWN ideas of where to 
put their specific code,
but they sure don't seem to have been very sucessful in conveying this 
info to others.

I know it's mostly due to my lack of knowledge,  but the only part 
that's really well documented
is the Twisted Web section.

Anyway,   if anyone has any suggestions or tips on what goes where,   
please post it here.
Inquiring minds want to know,  and I'm not the only one who wants to 
know.

John





From glyph at twistedmatrix.com  Thu Jan  1 10:47:37 2004
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 1 Jan 2004 10:47:37 -0500
Subject: [Twisted-Python] Re: IRC Client examples...  PLEASE HELP
In-Reply-To: <45EA9A45-3C2B-11D8-ADCB-0030656C6B9E@webcrunchers.com>
References: <3FF120BE.3010504@paradise.net.nz> <14E99DCD-3B3E-11D8-BB69-0030656C6B9E@webcrunchers.com> <200312311211.31399.teratorn@world-net.net> <20031231205249.GA25692@intarweb.us> <072928DC-3BEA-11D8-ADCB-0030656C6B9E@webcrunchers.com> <3FF39441.7020600@csrules.dyndns.org> <45EA9A45-3C2B-11D8-ADCB-0030656C6B9E@webcrunchers.com>
Message-ID: <D2C287ED-3C71-11D8-9071-000393C9700E@twistedmatrix.com>


On Jan 1, 2004, at 2:22 AM, JD wrote:

> One of my main problems is where to put my code.   Do I put it in the 
> factory class,
> or do I put it in the Client class?   One always points to the other.  
>  I suppose it don't really matter,
> but I'm sure the author(s) of twisted have their OWN ideas of where to 
> put their specific code,
> but they sure don't seem to have been very sucessful in conveying this 
> info to others.

It depends.

The general pattern for Twisted code is to separate protocol logic from 
application logic.  Your protocol subclass should translate from 
protocol-level events (IRCClient.signedOn, in this case) to 
application-level events (like a hypothetical 
'jd.ChatterRobot.nowOnIRCAs(nick)' method).  As for division between 
"protocol" and "factory" - try to make it so that your factory class 
can support multiple connected clients at once.  It should be small.  
Any logic associated with a particular connection should go in the 
protocol class, and any logic associated with all connections 
simultaneously must at least be referenced from the factory class.  
Generally it's a bad idea to put that logic actually into the protocol 
class because that establishes a hard dependency between network code 
and application logic which makes your application logic harder to 
write test cases for.

This pattern breaks down by necessity when dealing with very 
network-heavy code, or abstractions over things that have to logically 
understand IP addresses and the like.   However, try to follow the 
general rule as much as possible even in this kind of code.

The reason that nobody has suggested a particular answer to your 
problem is that the best approach involves keeping your code in an 
organization that best fits your problem domain, and is not dictated by 
Twisted.  As long as the network events make it from the reactor to 
your python objects, there are few constraints as to how to organize 
those objects, and most of those have to do with starting up and 
shutting down cleanly in the context of bin/twistd.

> I know it's mostly due to my lack of knowledge,  but the only part 
> that's really well documented
> is the Twisted Web section.

I know our docs aren't the best, but I think that these cover the 
relevant organization issues:

	http://www.twistedmatrix.com/documents/howto/servers
	http://www.twistedmatrix.com/documents/howto/clients

and they have nothing to do with Twisted Web.

If you disagree, and there is really a particular documentation 
problem, open a doc bug in the tracker 
(http://www.twistedmatrix.com/bugs) and assign it to "hypatia".
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 186 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040101/b65ac0eb/attachment.pgp 

From lists at webcrunchers.com  Thu Jan  1 14:25:37 2004
From: lists at webcrunchers.com (JD)
Date: Thu, 1 Jan 2004 11:25:37 -0800
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <200312312043.15657.teratorn@world-net.net>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net>
Message-ID: <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com>

On Dec 31, 2003, at 7:43 PM, Eric Mangold wrote:

> On Wednesday 31 December 2003 04:58 pm, JD wrote:
>> Hi,
>>
>> I'm open for suggestions on where I can put my customized code.    I
>> seem to have a choice
>> between putting it in the "factory" or in the "protocol",  and I
>> cannot seem to decide where the
>> best place would be.
>
> Since this is IRC you shouldn't go issuing commands until your signed
> on, thus the signedOn method of your protocol would be the right place.

Ok,   good point....   but how do I issue commands?   let's say I have
a IRCClient class called "testIRC".

do I use:    testIRC.sendLine('signedOn')  to send the command to the 
IRC server
to signon?

or do I:   testIRC.register('mynick', 'myhost', 'irc.debian.com')

then,   when I want to do the "who" command,  would I do:   
testIRC.sendLine('who')

then,   i would expect to call me back,   so I would override the 
"action" method,
like so:

def action(self, user, channel, msg):
	< extract the info I want from msg and store it somewhere,  probably 
in an instance variable in testIRC object >
          reactor.stop()    ---  to exit the client and disconnect,   or 
would I have to put the reactor.stop() in the
          factory's "clientConnectionFailed" method,  which I would 
override of course.

It's things like this that throw me totally for a loop.   Where to put 
things....  what gets the call back...

> Yeah, it's not obvious how to do that. I'll send another mail when I've
> a chance to test something, but New Years is coming up right now... :)

Yea - and while everyone is partying,   i take this wonderful 
opportunity to get some serious coding
done,  because the place is so quiet,  and I'm too broke to do anything 
anyway.

> No. An ACTION in IRC terms is a user doing an /me.

Ok,  if "action" isn't the callback which I override to get the output 
of the who command,
then what is?

myInfo?   luserClient?

luserChannels - Called with the number of channels existant on the 
server (ALMOST what I want)
luserOp - Called with the number of ops logged on to the server 
(GETTING CLOSER - NOT QUITE)
luserMe - Called with information about the server connected to. 
(CLOSEST YET - but no IP address info)

Ok,   so how do these get called?   As far as I can tell,    
"handleCommand" calls

method = getattr(self, "irc_%s" % command, None)

which it then somehow then calls back to:

     def irc_RPL_LUSERME(self, prefix, params):
         self.luserMe(params[1])

I really want:   RPL_WHOISSERVER,  but (sigh) it's not there.   Nobody 
bothered to finish this
module.

Could I add this to my IRCClient's subclass?

IE:

     def irc_RPL_WHOISSERVER(self, prefix, params):
         self.whois(params[1])

Then....

    def whois(self, prefix,  info):
	< then in this code,  get the info?  - then after that do the 
reactor.stop() so I can fall out of the reactor.run()
             call. >

Is this all I have to do....   but then would 'getattr' as you see 
above,   know how to get the method name?
Or would I have to add this somehow to another dictionary?

If so,  how do I do it?   and if i have to do it,  how do I find the 
reference to the dictionary?

Anyway,   other then being totally confused,   is there any hope?   I 
think I'm just missing a few
critical steps.    Or do I have them all?


>> There are a number of other callbacks for the private messages and
>> such.   Which one
>> do I use?   When testing the code,  I'm not getting any callbacks to
>> the "action()" method.
>> Is this because something else is fucked up.
>
> Yeah, your code.

No shit sherlock....  now i got to figure out why it's not calling my 
"whois" method.

John




From andrew-twisted at puzzling.org  Thu Jan  1 21:52:08 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 2 Jan 2004 13:52:08 +1100
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com>
Message-ID: <20040102025208.GB11930@frobozz>

On Thu, Jan 01, 2004 at 11:25:37AM -0800, JD wrote:
> On Dec 31, 2003, at 7:43 PM, Eric Mangold wrote:
> >
> >Since this is IRC you shouldn't go issuing commands until your signed
> >on, thus the signedOn method of your protocol would be the right place.
> 
> Ok,   good point....   but how do I issue commands?   let's say I have
> a IRCClient class called "testIRC".
> 
> do I use:    testIRC.sendLine('signedOn')  to send the command to the 
> IRC server
> to signon?

No.  IRCClient is a LineReceiver subclass, because that's how the low-level
protocol works.  However, you're not using the low-level protocol, you're
using an abstraction on top of it -- IRCClient.  Don't break the abstraction
(by calling LineReceiver's sendLine method) unless you have a good reason to
and you know the protocol spec well enough to know what you're doing (which
would be RFC 2812 in this case, I think).

As far as I'm aware, sending a line saying 'signedOn' to the server doesn't
make any sense in the IRC protocol, so this definitely wouldn't achieve
anything useful, except causing an error from the server that the IRCClient
instance probably won't expect (because you broke the abstraction and snuck
behind its back to do it).

> or do I:   testIRC.register('mynick', 'myhost', 'irc.debian.com')

That looks much saner.  And noticeably more full of information than
testIRC.sendLine('signedOn')...

> then,   when I want to do the "who" command,  would I do:   
> testIRC.sendLine('who')

Well, I believe the WHO command requires an argument, so it would be more
like testIRC.sendLine('WHO ' + name)... but see my next answer.

> then,   i would expect to call me back,   so I would override the 
> "action" method,
> like so:
> 
> def action(self, user, channel, msg):
> 	< extract the info I want from msg and store it somewhere,  probably 
> in an instance variable in testIRC object >
>          reactor.stop()    ---  to exit the client and disconnect,   or 
> would I have to put the reactor.stop() in the
>          factory's "clientConnectionFailed" method,  which I would 
> override of course.

That's not what the action method is for.  As the docstring for action says:
"Called when I see a user perform an ACTION on a channel."  An ACTION is a
specific thing in IRC, not a catch-all for every type of message from
server to client.  See the RFC if you're not familar with the terms.

The right way to do this is implemented in sandbox/exarkun/irc2.py -- see
the AdvancedClient.who method.  I'd follow JP's earlier suggestion and use
it.

> It's things like this that throw me totally for a loop.   Where to put 
> things....  what gets the call back...

It depends on the protocol implementation.  There's no single generic answer
for the whole of Twisted.

> >No. An ACTION in IRC terms is a user doing an /me.
> 
> Ok,  if "action" isn't the callback which I override to get the output 
> of the who command,
> then what is?
> 
> myInfo?   luserClient?
> 
> luserChannels - Called with the number of channels existant on the 
> server (ALMOST what I want)
> luserOp - Called with the number of ops logged on to the server 
> (GETTING CLOSER - NOT QUITE)
> luserMe - Called with information about the server connected to. 
> (CLOSEST YET - but no IP address info)

The answer is of course none of those.  You should've already noticed that
IRCClient doesn't implement a who() method, so it's hardly surprising it
hasn't implemented a command to deal with its response.  irc2.py does,
though (and uses Deferreds for dealing with the response, which is cleaner
anyway).

> Ok,   so how do these get called?   As far as I can tell,    
> "handleCommand" calls
> 
> method = getattr(self, "irc_%s" % command, None)
> 
> which it then somehow then calls back to:
> 
>     def irc_RPL_LUSERME(self, prefix, params):
>         self.luserMe(params[1])
> 
> I really want:   RPL_WHOISSERVER,  but (sigh) it's not there.   Nobody 
> bothered to finish this
> module.

I thought you wanted to use the WHO command not WHOIS?  Please try to be
precise.

Anyway, irc2.py also implements WHOIS.

> Could I add this to my IRCClient's subclass?
> 
> IE:
> 
>     def irc_RPL_WHOISSERVER(self, prefix, params):
>         self.whois(params[1])

If you look at irc2.py, you'll see it does override this method.  Note that
'whois' is a bad name for the response handler -- the existing convention in
IRCClient is that 'join', 'nick', etc, are the methods that *issue* the
command, not that handle the response.

> Is this all I have to do....   but then would 'getattr' as you see 
> above,   know how to get the method name?
> Or would I have to add this somehow to another dictionary?

Yes, it would.  Please see the docs for getattr in the Python standard
library reference.

> Anyway,   other then being totally confused,   is there any hope?   I 
> think I'm just missing a few
> critical steps.    Or do I have them all?

No idea.  You tell me :)

I think the biggest critical step you're missing is that you're busily
trying to reinvent a wheel that's already been made in
sandbox/exarkun/irc2.py, though.

-Andrew.




From robert.penz at outertech.com  Fri Jan  2 05:42:37 2004
From: robert.penz at outertech.com (Robert Penz)
Date: Fri, 2 Jan 2004 11:42:37 +0100
Subject: [Twisted-Python] twisted in chroot
Message-ID: <200401021142.50777.robert.penz@outertech.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi!

I've a more complicated problem this time. I've written a client which calles 
reactor.connectTCP("localhost", 8789, factory) and I've "compiled" it with 
Installer5 (http://www.mcmillan-inc.com/install1.html) all works if I just 
run it, but if I run it in a chroot I'll get following error message: 

File "/projects/buildbabla/out1.pyz/twisted.internet.default", line 281, in 
connectTCP
AttributeError: 'module' object has no attribute 'Connector'

and I've no clue why.  

Calling any of my non-twisted programs in a chroot, "compiled" with Installer, 
works without any problem.

- -- 
Regards,
Robert
- ----------
Robert Penz
robert dot penz at outertech dot com
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2-rc1-SuSE (GNU/Linux)

iD8DBQE/9Usq8tTsQqJDUBMRAsjQAJwPyiJ/yftTpxdkAWCQHS40u5elsQCfVbTD
j5RKzbkVbsT7vJZepk8F7vI=
=MA/8
-----END PGP SIGNATURE-----




From syver at inout.no  Fri Jan  2 06:55:12 2004
From: syver at inout.no (Syver Enstad)
Date: 02 Jan 2004 12:55:12 +0100
Subject: [Twisted-Python] automating startup of twistd application.
Message-ID: <u4qve4lb3.fsf@inout.no>

I have a twistd daemon that runs a custom application (.tap). When
starting up the daemon I have to enter the root password and a
passphrase for SSL interactively from the console (the app runs a
twisted web server for HTTP and HTTPS).

Because I want to do some automatic maintenace tasks I need to be able
to start and stop the daemon from a script. Unfortunately I have
little knowledge of Linux and the twistd daemon/application and need
some input on how to attack this problem.





From exarkun at intarweb.us  Fri Jan  2 13:52:48 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 2 Jan 2004 13:52:48 -0500
Subject: [Twisted-Python] automating startup of twistd application.
In-Reply-To: <u4qve4lb3.fsf@inout.no>
References: <u4qve4lb3.fsf@inout.no>
Message-ID: <20040102185248.GA30148@intarweb.us>

On Fri, Jan 02, 2004 at 12:55:12PM +0100, Syver Enstad wrote:
> 
> I have a twistd daemon that runs a custom application (.tap). When
> starting up the daemon I have to enter the root password and a
> passphrase for SSL interactively from the console (the app runs a
> twisted web server for HTTP and HTTPS).
> 
> Because I want to do some automatic maintenace tasks I need to be able
> to start and stop the daemon from a script. Unfortunately I have
> little knowledge of Linux and the twistd daemon/application and need
> some input on how to attack this problem.
> 

  Requiring the passphrase to decrypt the SSL certificate is a measure of
security.  It makes it more difficult for attackers to trick your users into
thinking the attacker is you, by rendering the certificate useless in the
absense of the passphrase.

  If the passphrase is sitting in a plaintext file somewhere, waiting to be
used by the script that restarts your daemon, this security is negated -
attackers need now only read the script in addition to copying the
certificate.

  If the passphrase is stored encrypted, then this could be avoided, but
then you would have to type in a passphrase to decrypt that.  Of course, you
could store that passphrase in a file....  Hopefully you see where this is
leading.

  Choose security or convenience here (there is a third alternative - come
up with a new system that is both secure and convenient).  If you want
security, you can't automate this process; if you want convenience, you may
as well store the certificate plaintext, because you're buying little by
encrypting it and leaving a passphrase lying around for anyone to use.

  Lateral thinking may produce an acceptable solution - for example, wrap
the twistd restarter in a native setuid root executable, store the
certificate plaintext and readable only as root.  (Still if the filesystem
is stolen, the certificate has been compromised.  But an encrypted
filesystem alleviates this problem.)

  Hope this helps,

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040102/c7c4d2cf/attachment.pgp 

From syver-en at online.no  Fri Jan  2 18:00:07 2004
From: syver-en at online.no (Syver Enstad)
Date: 03 Jan 2004 00:00:07 +0100
Subject: [Twisted-Python] automating startup of twistd application.
In-Reply-To: <20040102185248.GA30148@intarweb.us>
References: <u4qve4lb3.fsf@inout.no> <20040102185248.GA30148@intarweb.us>
Message-ID: <uad56hs7c.fsf@online.no>

Jp Calderone <exarkun at intarweb.us> writes:

> On Fri, Jan 02, 2004 at 12:55:12PM +0100, Syver Enstad wrote:

>> Because I want to do some automatic maintenace tasks I need to be
>> able to start and stop the daemon from a script. Unfortunately I
>> have little knowledge of Linux and the twistd daemon/application and
>> need some input on how to attack this problem.

> Requiring the passphrase to decrypt the SSL certificate is a measure
> of security.  It makes it more difficult for attackers to trick your
> users into thinking the attacker is you, by rendering the
> certificate useless in the absense of the passphrase.  If the
> passphrase is sitting in a plaintext file somewhere, waiting to be
> used by the script that restarts your daemon, this security is
> negated - attackers need now only read the script in addition to
> copying the certificate.  If the passphrase is stored encrypted,
> then this could be avoided, but then you would have to type in a
> passphrase to decrypt that.  Of course, you could store that
> passphrase in a file....  Hopefully you see where this is leading.

Yes, I think that I am throughly hosed anyway if someone gets access
to the filesystem on the machine in question.

>   Hope this helps,

Yes, thanks. The security aspects of it is certainly interesting and
important. Where should I look to find out how to automate startup of
the twistd daemon so that it doesn't prompt for the root password?


-- 

Syver Enstad




From bob at redivi.com  Fri Jan  2 19:17:22 2004
From: bob at redivi.com (Bob Ippolito)
Date: Fri, 2 Jan 2004 19:17:22 -0500
Subject: [Twisted-Python] automating startup of twistd application.
In-Reply-To: <uad56hs7c.fsf@online.no>
References: <u4qve4lb3.fsf@inout.no> <20040102185248.GA30148@intarweb.us> <uad56hs7c.fsf@online.no>
Message-ID: <3395A178-3D82-11D8-996B-000A95686CD8@redivi.com>


On Jan 2, 2004, at 6:00 PM, Syver Enstad wrote:

> Jp Calderone <exarkun at intarweb.us> writes:
>
>> On Fri, Jan 02, 2004 at 12:55:12PM +0100, Syver Enstad wrote:
>
>>> Because I want to do some automatic maintenace tasks I need to be
>>> able to start and stop the daemon from a script. Unfortunately I
>>> have little knowledge of Linux and the twistd daemon/application and
>>> need some input on how to attack this problem.
>
> Yes, thanks. The security aspects of it is certainly interesting and
> important. Where should I look to find out how to automate startup of
> the twistd daemon so that it doesn't prompt for the root password?

Typically the way that one does this is to start a daemon as root via 
one of the following "startup phase" options: crontab (a @reboot 
directive), an init.d (sometimes called rc.d or rc) script, a 
"StartupItem bundle" on OS X, etc.  These don't need the root password 
to run once installed because they are executed as root during the 
normal startup phase of the computer.

-bob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040102/96fc1408/attachment.bin 

From lists at webcrunchers.com  Fri Jan  2 21:13:39 2004
From: lists at webcrunchers.com (JD)
Date: Fri, 2 Jan 2004 18:13:39 -0800
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <20040102025208.GB11930@frobozz>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com> <20040102025208.GB11930@frobozz>
Message-ID: <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com>

On Jan 1, 2004, at 6:52 PM, Andrew Bennetts wrote:

> On Thu, Jan 01, 2004 at 11:25:37AM -0800, JD wrote:
>> On Dec 31, 2003, at 7:43 PM, Eric Mangold wrote:
>>>
>>> Since this is IRC you shouldn't go issuing commands until your signed
>>> on, thus the signedOn method of your protocol would be the right 
>>> place.
>>
>> Ok,   good point....   but how do I issue commands?   let's say I have
>> a IRCClient class called "testIRC".
>>
>> do I use:    testIRC.sendLine('signedOn')  to send the command to the
>> IRC server
>> to signon?
>
> No.  IRCClient is a LineReceiver subclass, because that's how the 
> low-level
> protocol works.

I think I understand.   what is needed in the docs,   is a better 
description of just
what the roles of these objects are supposed to do,   and where we,  as 
users
of Twisted,  would have a much better chance to use Twisted in the way 
it is
intended.    So the usage of 'sendLine' in a 'lineReceiver' would be 
inappropriate?
but if that's true,  then how does one send a command to the IRC server?

By the way,   I've chosen this as a simple test application,  not 
unlike what I
want to really do,   so I have chosen a relatively simple application,  
where I
just extract all the users of a specified IRC server,  and return the 
data.

I have not specified the form of the data,  that's not important,  but 
what's
important to me,  is the understand how to use Twisted in the way it was
intended.

I have this:

class IRC_test(irc.IRCClient):

     def whois_on(self):
     	"""
     	This method issues a 'WHO' command to see who is on the server.
     	"""
     	self.sendLine("WHO")

     def signedOn(self):
         """Called after sucessfully signing on to the server.   So we 
immediately
         issue the 'whois_on' message to let the server go and do it's 
stuff.
         """
         self.whois_on(self)

     def whois_result(self, prefix,  info):
		"""
		This is the code the IRC is somehow going to call.   Then,
		after it is called,  it stores the info in the factory
		and returns by calling 'reactor.stop()' to exit the reactor.run()
		"""
		self.result = extract_whois_data(info)
		reactor.stop()
		
     def irc_RPL_WHOISSERVER(self, prefix, params):
     	"""
     	This was not included in the parent class IRCClient,
     	So I add it here.  'lineReceived' gets the
     	command = numeric_to_symbolic[command],  which is now
     	the string 'RPL_WHOISSERVER'.   To get THIS method to call,
     	the 'handleCommand' method first generates a key to the
     	class's 'attribute' dictionary,  by pre-pending 'irc_'
     	in front of it to get this method,  which is then called.
     	'params' would then have the result data.   We need to
     	hack around to see what form it's in.
     	"""
         self.whois_result(params[1])
		
def test_irc(host, port):
	"""
	This function scans a particular IRC server,  and returns a dictionary
	of all the nicks and IP addresses.  Nick is the key,  the IP or reverse
	dns is the value.
	"""
	my_nick = "jd6969"
	data_dict = {}		# place where I want my IRC data
	myTestFactory = IRC_test(data_dict,  my_nick)
	reactor.connectTCP(host, port, myTestFactory)
	reactor.run()		# I just wait for the server to respond
	return data_dict	# when it does, I just want to return with the data

I know this is a pretty stupid and useless application,  but this is 
very close to what I want
it to do,  without revealing anything.    I haven't tested this yet,  
because I just want to be
sure I'm doing it right,  rather then to spend weeks down a particular 
path to nowhere.
	
> However, you're not using the low-level protocol, you're
> using an abstraction on top of it -- IRCClient.  Don't break the 
> abstraction
> (by calling LineReceiver's sendLine method) unless you have a good 
> reason to
> and you know the protocol spec well enough to know what you're doing 
> (which
> would be RFC 2812 in this case, I think).

I believe I do,  because I still have to tell the IRC server what I 
want it to do.
And the only way I can see,  is with the sendLine command.

>
> As far as I'm aware, sending a line saying 'signedOn' to the server 
> doesn't
> make any sense in the IRC protocol, so this definitely wouldn't achieve
> anything useful, except causing an error from the server that the 
> IRCClient
> instance probably won't expect (because you broke the abstraction and 
> snuck
> behind its back to do it).

Ok,   so it is clear I'm doing this wrong.  If that's the case,  then 
what is the
RIGHT way of doing it?

>
>> or do I:   testIRC.register('mynick', 'myhost', 'irc.debian.com')
>
> That looks much saner.  And noticeably more full of information than
> testIRC.sendLine('signedOn')...
>
>> then,   when I want to do the "who" command,  would I do:
>> testIRC.sendLine('who')
>
> Well, I believe the WHO command requires an argument, so it would be 
> more
> like testIRC.sendLine('WHO ' + name)... but see my next answer.

hmmm - in checking the RFC it mentions I can either "WHO <channel>" or
"WHO" without specifying a channel,  in which it gets the names of ALL 
the users
of the IRC server not hidden.

>
>> then,   i would expect to call me back,   so I would override the
>> "action" method,
>> like so:
>>
>> def action(self, user, channel, msg):
>> 	< extract the info I want from msg and store it somewhere,  probably
>> in an instance variable in testIRC object >
>>          reactor.stop()    ---  to exit the client and disconnect,   
>> or
>> would I have to put the reactor.stop() in the
>>          factory's "clientConnectionFailed" method,  which I would
>> override of course.
>
> That's not what the action method is for.  As the docstring for action 
> says:
> "Called when I see a user perform an ACTION on a channel."  An ACTION 
> is a
> specific thing in IRC, not a catch-all for every type of message from
> server to client.  See the RFC if you're not familar with the terms.

Yes - I was mislead...   I interpreted this as an action that might come
from the server,  such as the result of a WHO command (in using my 
example)

I think if you take a look at the shell of my application,   I'm no 
longer using this.

> The right way to do this is implemented in sandbox/exarkun/irc2.py -- 
> see
> the AdvancedClient.who method.  I'd follow JP's earlier suggestion and 
> use
> it.

I was NOT aware that anything in "sandbox" had anything to do with IRC.
Expecially when words like this are chosen.   One can interpret 
'sandbox' in
many zillion ways,  so how would I even know this.

I took a look at this,  and WOW - this might be just what I need.   I'm 
going to
have to spend a lot of time studying this.    I had no clue this even 
existed,
primarily because the name 'sandbox' really had nothing to do with IRC,
and I just couldn't make the connection.

> The answer is of course none of those.  You should've already noticed 
> that
> IRCClient doesn't implement a who() method, so it's hardly surprising 
> it
> hasn't implemented a command to deal with its response.

yes - as it also doesn't implement a LOT of things,  and yet they are
defined as overrideable functions.

>  irc2.py does,
> though (and uses Deferreds for dealing with the response, which is 
> cleaner
> anyway).

Kewl - and now just being aware of that,    I definately want to check 
it out.
And also I could use some connents on my above approach,  as I have
avoided the pitfalls you outlined above.

> I thought you wanted to use the WHO command not WHOIS?  Please try to 
> be
> precise.

I thought they were almost the same....  at least that's what I read in 
the RFC's.
What is the difference?

> Anyway, irc2.py also implements WHOIS.

Kewl

>
>> Could I add this to my IRCClient's subclass?
>>
>> IE:
>>
>>     def irc_RPL_WHOISSERVER(self, prefix, params):
>>         self.whois(params[1])
>
> If you look at irc2.py, you'll see it does override this method.  Note 
> that
> 'whois' is a bad name for the response handler -- the existing 
> convention in
> IRCClient is that 'join', 'nick', etc, are the methods that *issue* the
> command, not that handle the response.

I haven't seen any mention of naming conventions,  but if there is one,
I certainly would want to know where it is.

> I think the biggest critical step you're missing is that you're busily
> trying to reinvent a wheel that's already been made in
> sandbox/exarkun/irc2.py, though.

that is obviously true....  I explained above why I just didn't even 
know of it's
existance until it was pointed out to me.

John




From andrew-twisted at puzzling.org  Fri Jan  2 22:20:31 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sat, 3 Jan 2004 14:20:31 +1100
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com> <20040102025208.GB11930@frobozz> <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com>
Message-ID: <20040103032031.GA14197@frobozz>

On Fri, Jan 02, 2004 at 06:13:39PM -0800, JD wrote:
> On Jan 1, 2004, at 6:52 PM, Andrew Bennetts wrote:
> >On Thu, Jan 01, 2004 at 11:25:37AM -0800, JD wrote:
> >>
> >>do I use:    testIRC.sendLine('signedOn')  to send the command to the
> >>IRC server
> >>to signon?
> >
> >No.  IRCClient is a LineReceiver subclass, because that's how the 
> >low-level
> >protocol works.
> 
> I think I understand.   what is needed in the docs,   is a better
> description of just what the roles of these objects are supposed to do,
> and where we,  as users of Twisted,  would have a much better chance to
> use Twisted in the way it is intended.    So the usage of 'sendLine' in a
> 'lineReceiver' would be inappropriate?  but if that's true,  then how does
> one send a command to the IRC server?

No, using sendLine in a LineReceiver is fine -- that's why LineReceiver
defines sendLine.

What isn't so good is using sendLine in an IRCClient subclass.  While
IRCClient subclasses LineReceiver, in general you should be using the
abstractions IRCClient provides to send commands to and receive responses
from the server (if you don't want to use them, then why not just use a
plain LineReceiver?).

The only reason you should have for calling sendLine in an IRCClient
subclass is to extend its functionality to support more of the protocol than
it already does.  IRCClient already has support for signing on (the
'register' method and the 'signedOn' handler), so you shouldn't use sendLine
for that.  IRCClient currently lacks some IRC features, such as WHO, so to
do those you do need sendLine.

Also, good style suggests that you probably shouldn't mix your application
code with your IRCClient extensions, i.e. subclass IRCClient for WHO support
(and other other unimplemented commands you need), and then subclass that
for your application.

> By the way,   I've chosen this as a simple test application,  not unlike
> what I want to really do,   so I have chosen a relatively simple
> application,  where I just extract all the users of a specified IRC
> server,  and return the data.
> 
> I have not specified the form of the data,  that's not important,  but
> what's important to me,  is the understand how to use Twisted in the way
> it was intended.
> 
> I have this:
> 
> class IRC_test(irc.IRCClient):
> 
>     def whois_on(self):
>     	"""
>     	This method issues a 'WHO' command to see who is on the server.
>     	"""
>     	self.sendLine("WHO")
> 
>     def signedOn(self):
>         """Called after sucessfully signing on to the server.   So we
>         immediately issue the 'whois_on' message to let the server go and
>         do it's stuff.
>         """
>         self.whois_on(self)
> 
>     def whois_result(self, prefix,  info):
> 		"""
> 		This is the code the IRC is somehow going to call.   Then,
> 		after it is called,  it stores the info in the factory
> 		and returns by calling 'reactor.stop()' to exit the 
> 		reactor.run()
> 		"""
> 		self.result = extract_whois_data(info)
> 		reactor.stop()

(This identation is really painful.)

>     def irc_RPL_WHOISSERVER(self, prefix, params):
>     	"""
>     	This was not included in the parent class IRCClient,
>     	So I add it here.  'lineReceived' gets the
>     	command = numeric_to_symbolic[command],  which is now
>     	the string 'RPL_WHOISSERVER'.   To get THIS method to call,
>     	the 'handleCommand' method first generates a key to the
>     	class's 'attribute' dictionary,  by pre-pending 'irc_'
>     	in front of it to get this method,  which is then called.
>     	'params' would then have the result data.   We need to
>     	hack around to see what form it's in.
>     	"""
>         self.whois_result(params[1])

(This identation won't even work!)

But creating a method called 'irc_RPL_WHOISSERVER' will do what you want
here.  Handler methods with a common prefix that are dispatched with a
getattr call are a common, and very nice, idiom in Twisted.

> def test_irc(host, port):
> 	"""
> 	This function scans a particular IRC server,  and returns a
> 	dictionary of all the nicks and IP addresses.  Nick is the key,  the
> 	IP or reverse dns is the value.
> 	"""
> 	my_nick = "jd6969"
> 	data_dict = {}		# place where I want my IRC data
> 	myTestFactory = IRC_test(data_dict,  my_nick)
> 	reactor.connectTCP(host, port, myTestFactory)
> 	reactor.run()		# I just wait for the server to respond
> 	return data_dict	# when it does, I just want to return with the data

(Ugh, and now you're using tabs...)

IRC_test is a protocol, but you're passing it as a factory to connectTCP.
See http://twistedmatrix.com/documents/howto/clients.

> I know this is a pretty stupid and useless application,  but this is very
> close to what I want it to do,  without revealing anything.    I haven't
> tested this yet,  because I just want to be sure I'm doing it right,
> rather then to spend weeks down a particular path to nowhere.

This code is short.  Why didn't you run it yourself to get some idea of how
close it is to working?  Working code is usually a good sign that you're
close to the right path, if not already on it...

> >However, you're not using the low-level protocol, you're
> >using an abstraction on top of it -- IRCClient.  Don't break the 
> >abstraction
> >(by calling LineReceiver's sendLine method) unless you have a good 
> >reason to
> >and you know the protocol spec well enough to know what you're doing 
> >(which
> >would be RFC 2812 in this case, I think).
> 
> I believe I do,  because I still have to tell the IRC server what I want
> it to do.  And the only way I can see,  is with the sendLine command.

Only because you need to extend it to cover parts of the protocol that
aren't implemented.  You started off talking about 'signedOn', which is
already covered by IRCClient, and only later mentioned trying to do a WHO
command, which isn't.  Confusing issues like this makes it hard to figure
out what you're trying to do.

> >As far as I'm aware, sending a line saying 'signedOn' to the server 
> >doesn't
> >make any sense in the IRC protocol, so this definitely wouldn't achieve
> >anything useful, except causing an error from the server that the 
> >IRCClient
> >instance probably won't expect (because you broke the abstraction and 
> >snuck
> >behind its back to do it).
> 
> Ok,   so it is clear I'm doing this wrong.  If that's the case,  then what
> is the RIGHT way of doing it?

Calling register, of course.  Where in the RFC does it say 'signedOn' is a
recognised command?

> >>or do I:   testIRC.register('mynick', 'myhost', 'irc.debian.com')
> >
> >That looks much saner.  And noticeably more full of information than
> >testIRC.sendLine('signedOn')...
> >
> >>then,   when I want to do the "who" command,  would I do:
> >>testIRC.sendLine('who')
> >
> >Well, I believe the WHO command requires an argument, so it would be 
> >more
> >like testIRC.sendLine('WHO ' + name)... but see my next answer.
> 
> hmmm - in checking the RFC it mentions I can either "WHO <channel>" or
> "WHO" without specifying a channel,  in which it gets the names of ALL the
> users of the IRC server not hidden.

Fair enough.  Believe it or not, but I actually know very very little about
IRC, I mainly figured it out for that email to you by skimming irc.py and
one or two brief google searches to confirm e.g. that 'signedOn' doesn't
appear in the RFC.

> >The right way to do this is implemented in sandbox/exarkun/irc2.py -- 
> >see
> >the AdvancedClient.who method.  I'd follow JP's earlier suggestion and 
> >use
> >it.
> 
> I was NOT aware that anything in "sandbox" had anything to do with IRC.
> Expecially when words like this are chosen.   One can interpret 'sandbox'
> in many zillion ways,  so how would I even know this.

Because of a mail from earlier in the thread from JP:
    http://twistedmatrix.com/pipermail/twisted-python/2004-January/006893.html

Which part of

    "WHO is one of the commands I did manage to improve, but I never moved
    any of the work out of my sandbox.  You can find it in
    Twisted/sandbox/exarkun/irc2.py."

was unclear?

> I took a look at this,  and WOW - this might be just what I need.   I'm
> going to have to spend a lot of time studying this.    I had no clue this
> even existed, primarily because the name 'sandbox' really had nothing to
> do with IRC, and I just couldn't make the connection.

Hence the email.

> >The answer is of course none of those.  You should've already noticed 
> >that
> >IRCClient doesn't implement a who() method, so it's hardly surprising 
> >it
> >hasn't implemented a command to deal with its response.
> 
> yes - as it also doesn't implement a LOT of things,  and yet they are
> defined as overrideable functions.

I don't understand what you're saying here.  You mean things like
irc_RPL_WHOISSERVER?  That's just the way the prefixed getattr idiom works;
all you need to do support a new command define a handler method for it, and
that's it.  No explicit registration or anything like that needed.  Python's
a dynamic language, and Twisted uses that to its advantage.

> >I thought you wanted to use the WHO command not WHOIS?  Please try to 
> >be
> >precise.
> 
> I thought they were almost the same....  at least that's what I read in
> the RFC's.  What is the difference?

No idea.  Again, I don't know IRC very well :)

I notice that irc2.py implements both WHO and WHOIS seperately, though, so I
figure there are some differences, which is why you saying WHO and then
later WHOIS confused me.

> >>Could I add this to my IRCClient's subclass?
> >>
> >>IE:
> >>
> >>    def irc_RPL_WHOISSERVER(self, prefix, params):
> >>        self.whois(params[1])
> >
> >If you look at irc2.py, you'll see it does override this method.  Note 
> >that
> >'whois' is a bad name for the response handler -- the existing 
> >convention in
> >IRCClient is that 'join', 'nick', etc, are the methods that *issue* the
> >command, not that handle the response.
> 
> I haven't seen any mention of naming conventions,  but if there is one,
> I certainly would want to know where it is.

It's not explicitly written anywhere that I know of.  It was just obvious to
me from skimming the code of irc.py and irc2.py that that's what the
convention was, because that's what the existing code *does*.  I generally
try to follow the conventions of code I'm using to avoid getting horribly
confused.

> >I think the biggest critical step you're missing is that you're busily
> >trying to reinvent a wheel that's already been made in
> >sandbox/exarkun/irc2.py, though.
> 
> that is obviously true....  I explained above why I just didn't even know
> of it's existance until it was pointed out to me.

Yes, but it was pointed out to you before this...

-Andrew.




From richard at starfighter.freeuk.com  Sat Jan  3 10:23:21 2004
From: richard at starfighter.freeuk.com (Richard Townsend)
Date: Sat, 3 Jan 2004 15:23:21 -0000
Subject: [Twisted-Python] Resume FTP file retrieval
Message-ID: <ECEGJLPCEIFJKDPCFJDHAEAOCDAA.richard@starfighter.freeuk.com>

In the Python ftplib.FTP class's retrbinary() method you can pass a file
offset using the 'rest' arg (in order to resume a partial download).

Please could someone advise how to do a similar thing using the Twisted
FTPClient class? 


-------------- next part --------------
A non-text attachment was scrubbed...
Name: winmail.dat
Type: application/ms-tnef
Size: 1488 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040103/c50476b1/attachment.bin 

From andrew-twisted at puzzling.org  Sat Jan  3 11:17:40 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 4 Jan 2004 03:17:40 +1100
Subject: [Twisted-Python] Resume FTP file retrieval
In-Reply-To: <ECEGJLPCEIFJKDPCFJDHAEAOCDAA.richard@starfighter.freeuk.com>
References: <ECEGJLPCEIFJKDPCFJDHAEAOCDAA.richard@starfighter.freeuk.com>
Message-ID: <20040103161740.GC14197@frobozz>

On Sat, Jan 03, 2004 at 03:23:21PM -0000, Richard Townsend wrote:
> In the Python ftplib.FTP class's retrbinary() method you can pass a file
> offset using the 'rest' arg (in order to resume a partial download).
> 
> Please could someone advise how to do a similar thing using the Twisted
> FTPClient class? 

There's currently no explicit support for this, but you could do:

    ftpclient.queueStringCommand("REST " + offset).addErrback(log.err)

before calling retrieveFile/retr.

(You probably want to do more than just log an error if the REST command
fails, but you get the idea...)

-Andrew.




From andrew-twisted at puzzling.org  Sat Jan  3 11:32:47 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 4 Jan 2004 03:32:47 +1100
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <20040103032031.GA14197@frobozz>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com> <20040102025208.GB11930@frobozz> <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com> <20040103032031.GA14197@frobozz>
Message-ID: <20040103163247.GD14197@frobozz>

On Sat, Jan 03, 2004 at 02:20:31PM +1100, I wrote:
> 
> I don't understand what you're saying here.  You mean things like
> irc_RPL_WHOISSERVER?  That's just the way the prefixed getattr idiom works;
> all you need to do support a new command define a handler method for it, and
                                          ^ obviously I meant to insert the
                                            word "is" here.

-Andrew.




From marjancinober at hotmail.com  Sat Jan  3 13:18:44 2004
From: marjancinober at hotmail.com (marjan cinober)
Date: Sat, 03 Jan 2004 19:18:44 +0100
Subject: [Twisted-Python] First demo of Twisted Enterprise HOWTO. Twisted RDBMS support.
Message-ID: <Sea1-F30WKCSxQaWutz00041be9@hotmail.com>

I?ve been trying to start twisted RDBMS by following howto.
After a couple of hours it's finaly working. I came up to this...

It's maybe worth updating howto with working examples to save some time. I 
know that missing lines are completly obvious to most of experienced users 
but I was hopeing howto will make me run some demo tests immediately, even 
thow I'm just a dumb beginner.

#!/usr/bin/python
# EnterpriseDemo.py
"""First demo of Twisted Enterprise HOWTO. Twisted RDBMS support."""

from twisted.python import log
from twisted.internet import reactor
from twisted.enterprise import adbapi

# use this line for postgresql test
dbpool = adbapi.ConnectionPool("pyPgSQL.PgSQL", database='mydb')

# equivalent of cursor.execute(statement), return cursor.fetchall():
def getAge(user):
    return dbpool.runQuery( """SELECT age FROM users
        WHERE name = '%s'""" % user)

def printResult(l):
    if l:
        print l[0][0], "years old"
    else:
        print "No such user"
    reactor.stop()

getAge("joe").addCallback(printResult).addErrback( log.err)

reactor.run()

############### Setup on Debian Testing
## su
## su - postgres
## createuser -d -a _MyUserName_
## exit
## su - _MyUserName_
## createdb -U _MyUserName_ mydb "Demo Database mydb"
## psql mydb
##
## drop table users;
## CREATE TABLE users (
##   name varchar(64),
##   age int
## );
##
## insert into users values( 'joe', 35);
## insert into users values( 'jonas', 25);
## insert into users values( 'josefa', 16);
## ### QUICK TEST ###
## select * from users;
## SELECT age FROM users WHERE name = 'joe';
#############

_________________________________________________________________
STOP MORE SPAM with the new MSN 8 and get 2 months FREE* 
http://join.msn.com/?page=features/junkmail




From marjancinober at hotmail.com  Sat Jan  3 13:53:32 2004
From: marjancinober at hotmail.com (marjan cinober)
Date: Sat, 03 Jan 2004 19:53:32 +0100
Subject: [Twisted-Python] pb Exchange infrastructure
Message-ID: <Sea1-F9GTuAyHsjCGvs000439b8@hotmail.com>

I have spent last month composing this as a complete begginner in twisted.

I need to implement distributed data collection&distributiion network to 
gradually phase out a currently old mixed standard/vendor/equipment 
production process monitoring system.

The idea is to start a system that will be distributed, redundant and 
eventually become resistant to a single point of failure by using multiple 
sensors and delivery networks/paths.

These files are working... (Note the last three messages coming in 2s 
interval.)

Fetcher.py - http://shamash.eece.unm.edu:8080/bin.rpy/468
FetchCli.py - http://shamash.eece.unm.edu:8080/bin.rpy/469

, but they must be full of weird/suboptimal solutions as a use of twisted 
Perspective Broker. And probably the python itself is weak.

I would be gratefull of any constructive criticism. :-)
Thanks

    Marjan Cinober

_________________________________________________________________
Tired of slow downloads? Compare online deals from your local high-speed 
providers now.  https://broadband.msn.com




From marjancinober at hotmail.com  Sat Jan  3 14:13:45 2004
From: marjancinober at hotmail.com (marjan cinober)
Date: Sat, 03 Jan 2004 20:13:45 +0100
Subject: [Twisted-Python] examples/row_example.py  DBError Row object not in cache
Message-ID: <Sea1-F983AYJu3aCD8W00043c57@hotmail.com>

Still trying to test some postgersql access from twisted.
Unfortunate at running example ROW (Twisted Enterprise)
http://twistedmatrix.com/documents/examples/row_example.py

got stuck at
  File "row_example.py", line 58, in onInsert
    manager.deleteRow(newRoom).addCallback(onDelete)

Anybody has some clues?

Thanks

Best regards to all of you.

        Marjan Cinober

-----
I am on Linux debian testing (sarge)
Package: python2.3-twisted  Version: 1.1.0-1
Maintainer: Moshe Zadka <moshez at debian.org>

-----
$ psql test
test=# \i row_schema.sql
\q

cinober at mym:~/examples$ python row_example.py
/usr/lib/python2.3/site-packages/twisted/enterprise/row.py:135: 
DeprecationWarning: This is deprecated. Use the underlying database to 
generate keys, or just roll your own.
  warnings.warn("This is deprecated. Use the underlying database to generate 
keys, or just roll your own.", DeprecationWarning)
got Rooms. [<Room #10: testroom1 (someguy) (10,10)>, <Room #11: testroom2 
(someguy) (30,10)>, <Room #12: testroom3 (someguy) (50,10)>]
room   <Room #10: testroom1 (someguy) (10,10)>
furn      Furniture #50: room #10 (chair1) (10,10)
inner         Lamp #21
inner         Lamp #22
furn      Furniture #51: room #10 (chair2) (14,10)
furn      Rug 81: room #10, (a big rug)
furn      Rug 82: room #10, (a blue rug)
room   <Room #11: testroom2 (someguy) (30,10)>
furn      Rug 83: room #11, (a red rug)
furn      Rug 84: room #11, (a green rug)
room   <Room #12: testroom3 (someguy) (50,10)>
furn      Furniture #52: room #12 (chair3) (14,10)
furn      Furniture #53: room #12 (chair4) (10,12)
inner         Lamp #23
inner         Lamp #24
inner         Lamp #25
furn      Furniture #54: room #12 (chair5) (18,13)
furn      Furniture #55: room #12 (couch) (22,3)
furn      Rug 85: room #12, (a dirty rug)
updated row.
row inserted
100001

******** BLOCKED *********  Forced to <Ctrl>-C

Traceback (most recent call last):
  File "/usr/lib/python2.3/site-packages/twisted/internet/default.py", line 
130, in mainLoop
    self.runUntilCurrent()
  File "/usr/lib/python2.3/site-packages/twisted/internet/base.py", line 
403, in runUntilCurrent
    callable(*args, **kw)
  File "/usr/lib/python2.3/site-packages/twisted/internet/defer.py", line 
224, in callback
    self._startRunCallbacks(result)
  File "/usr/lib/python2.3/site-packages/twisted/internet/defer.py", line 
293, in _startRunCallbacks
    self._runCallbacks()
--- <exception caught here> ---
--- <exception caught here> ---
  File "/usr/lib/python2.3/site-packages/twisted/internet/defer.py", line 
307, in _runCallbacks
    self.result = callback(self.result, *args, **kw)
  File "row_example.py", line 58, in onInsert
    manager.deleteRow(newRoom).addCallback(onDelete)
  File 
"/usr/lib/python2.3/site-packages/twisted/enterprise/sqlreflector.py", line 
330, in deleteRow
    self.removeFromCache(rowObject)
  File "/usr/lib/python2.3/site-packages/twisted/enterprise/reflector.py", 
line
141, in removeFromCache
    raise DBError("Row object not in cache: %s", rowObject)
twisted.enterprise.util.DBError: ('Row object not in cache: %s', <Room 
#100001:
newRoom1 (fred) (100,100)>)

_________________________________________________________________
Tired of spam? Get advanced junk mail protection with MSN 8. 
http://join.msn.com/?page=features/junkmail




From 2002 at weholt.org  Sat Jan  3 17:45:43 2004
From: 2002 at weholt.org (Thomas Weholt)
Date: Sat, 3 Jan 2004 23:45:43 +0100
Subject: [Twisted-Python] Twisted-Web: Authenticating a usersite-wide ??
Message-ID: <03e901c3d24b$53e51c90$0401a8c0@RAZOR>

Hi,

I got a problem using a custom-made web-application built upon Twisted. My problem is that when I ask a user for authentication, the cookie or whatever it is, is not available in the request-object for other sites than the one who asked for authentication. I want the user to login on one page, which sets the correct info so I can use request.getUser() and request.getPassword() later on all other pages to validate access to the requested resources.

In my RootResource I return something like this if I want the user authenticated:

request.setHeader('WWW-authenticate', 'Basic realm="%s"' % ("/"))
errpage = error.ErrorPage(http.UNAUTHORIZED, "Unauthorized", "401 Authentication required")
return errpage.render(request)

Is Basic realm = "/" correct if I want this authentication to be valid site-wide? What else can I use? What other approach can I use?

Happy for any hints or clues.

Thanks in advance,
Thomas


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20040103/e5bb2e45/attachment.htm 

From exarkun at intarweb.us  Sat Jan  3 18:16:34 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Sat, 3 Jan 2004 18:16:34 -0500
Subject: [Twisted-Python] Twisted-Web: Authenticating a usersite-wide ??
In-Reply-To: <03e901c3d24b$53e51c90$0401a8c0@RAZOR>
References: <03e901c3d24b$53e51c90$0401a8c0@RAZOR>
Message-ID: <20040103231634.GA1354@intarweb.us>

On Sat, Jan 03, 2004 at 11:45:43PM +0100, Thomas Weholt wrote:
> Hi,
>
> [snip] 
>
> Is Basic realm = "/" correct if I want this authentication to be valid
> site-wide? What else can I use? What other approach can I use?

  The realm should be the domain at which the site is located.

  Jp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040103/f3a1db6e/attachment.pgp 

From 2002 at weholt.org  Sat Jan  3 20:34:46 2004
From: 2002 at weholt.org (Thomas Weholt)
Date: Sun, 4 Jan 2004 02:34:46 +0100
Subject: [Twisted-Python] Twisted-Web: Authenticating a usersite-wide ??
References: <03e901c3d24b$53e51c90$0401a8c0@RAZOR> <20040103231634.GA1354@intarweb.us>
Message-ID: <03fa01c3d262$f0a29280$0401a8c0@RAZOR>

Ok, then this might sound stupid, but if I got my server running on an
ADSL-line using a dynamic DNS-service, should I then use the dynamic
DNS-name or ... ???

What if this was to run on a LAN? What then?

Apologize if this is off-topic and lame.

Thomas

----- Original Message -----
From: "Jp Calderone" <exarkun at intarweb.us>
To: <twisted-python at twistedmatrix.com>
Sent: Sunday, January 04, 2004 12:16 AM
Subject: Re: [Twisted-Python] Twisted-Web: Authenticating a usersite-wide ??






From peter at engcorp.com  Sat Jan  3 20:52:51 2004
From: peter at engcorp.com (Peter Hansen)
Date: Sat, 03 Jan 2004 20:52:51 -0500
Subject: [Twisted-Python] Twisted-Web: Authenticating a usersite-wide ??
References: <03e901c3d24b$53e51c90$0401a8c0@RAZOR> <20040103231634.GA1354@intarweb.us> <03fa01c3d262$f0a29280$0401a8c0@RAZOR>
Message-ID: <3FF771F3.CBA12BC0@engcorp.com>

Thomas Weholt wrote:
> 
> Ok, then this might sound stupid, but if I got my server running on an
> ADSL-line using a dynamic DNS-service, should I then use the dynamic
> DNS-name or ... ???

Yes.

> What if this was to run on a LAN? What then?

Use the name by which the server is known on the LAN, whether
that's by means of an /etc/hosts (or windows/hosts, or whatever) mapping
file, or by using SMB name lookup, or whatever.  For example, our
intranet server is called just "intranet", though that happens to 
translate to 192.168.0.42 most of the time...

-Peter



From richard at starfighter.freeuk.com  Sun Jan  4 08:37:26 2004
From: richard at starfighter.freeuk.com (Richard Townsend)
Date: Sun, 4 Jan 2004 13:37:26 +0000
Subject: [Twisted-Python] Re: Re: Resume FTP file retrieval
Message-ID: <200401041337.27032.richard@starfighter.freeuk.com>

Hi Andrew,

Thanks very much for your suggestions.

I modified my test app to do:

    size = 10*1024
    deferred = ftpclient.queueStringCommand("REST %d" % size)
    deferred.addCallbacks(setRestSuccess,
                          setRestFailure,
                          callbackArgs=(filename, ftpclient))

In setRestSuccess() I receive the response:

['350 Restarting at 10240. Send STORE or RETRIEVE to initiate transfer.']

Then in setRestSuccess() I do:

    file_writer = FTPWriterProtocol(filename)
        
    deferred = ftpclient.retrieveFile(filename, file_writer)
    
    deferred.addCallbacks(downloadSuccess, 
                          downloadFail, 
                          callbackArgs=(file_writer,),
                          errbackArgs=(file_writer,))

where my protocol is defined as:

class FTPWriterProtocol(Protocol):
    def __init__(self, filename):
        self.file = open(filename, "ab")
    
    def close(self):
        print 'closing file'
        self.file.close()

    def dataReceived(self, data):
        print "Received %d bytes" % len(data)
        self.file.write(data)


In downloadSuccess() I receive the response:

[(1, ["150 Opening BINARY mode data connection for 'SSTEST.TXT' (522000 
bytes).", '226 Transfer complete.']), (1, None), (1, None)]

However, I actually receive the complete file, and not the partial download I 
expected.

Note: when I use ftplib.FTP.retrbinary() using the "rest" arg (connecting to 
the same server) I do get the partial download.

Any ideas why my Twisted version is not working?

regards,
Richard Townsend




From dave at krondo.com  Sun Jan  4 14:00:20 2004
From: dave at krondo.com (Dave Peticolas)
Date: Sun, 04 Jan 2004 11:00:20 -0800
Subject: [Twisted-Python] examples/row_example.py  DBError Row object
	not in cache
In-Reply-To: <Sea1-F983AYJu3aCD8W00043c57@hotmail.com>
References: <Sea1-F983AYJu3aCD8W00043c57@hotmail.com>
Message-ID: <1073242820.11485.30.camel@oneiros>

On Sat, 2004-01-03 at 11:13, marjan cinober wrote:
> Still trying to test some postgersql access from twisted.
> Unfortunate at running example ROW (Twisted Enterprise)
> http://twistedmatrix.com/documents/examples/row_example.py
> 
> got stuck at
>   File "row_example.py", line 58, in onInsert
>     manager.deleteRow(newRoom).addCallback(onDelete)
> 
> Anybody has some clues?

This was a bug. It should be fixed in CVS.

dave

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040104/4fb786f2/attachment.pgp 

From itamar at itamarst.org  Sun Jan  4 16:30:47 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 04 Jan 2004 16:30:47 -0500
Subject: [Twisted-Python] Does anyone use instance-only interface implementation
Message-ID: <1073251847.7794.3.camel@sheriffpony>

E.g. 

  Class Foo: pass
  o = Foo()
  o.__implements__ = (IBar,)

If so, I'd like to hear about it, cause we may want to remove support
for it.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From bob at redivi.com  Sun Jan  4 17:00:44 2004
From: bob at redivi.com (Bob Ippolito)
Date: Sun, 4 Jan 2004 17:00:44 -0500
Subject: [Twisted-Python] Does anyone use instance-only interface implementation
In-Reply-To: <1073251847.7794.3.camel@sheriffpony>
References: <1073251847.7794.3.camel@sheriffpony>
Message-ID: <71BFD8FA-3F01-11D8-ACF7-000A95686CD8@redivi.com>

On Jan 4, 2004, at 4:30 PM, Itamar Shtull-Trauring wrote:

>   Class Foo: pass
>   o = Foo()
>   o.__implements__ = (IBar,)
>
> If so, I'd like to hear about it, cause we may want to remove support
> for it.

I've used "instance-only interface implementation" when the instance at 
hand is Foo (the class itself, for its class methods), not Foo().. but 
that doesn't work with a stock version of Twisted anyways.  I'm 
probably going to convert the code to PyProtocols next time it's 
unearthed for that (and other) reasons, but I figure it's worthy of 
mention.

-bob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040104/ae5279e1/attachment.bin 

From andrew-twisted at puzzling.org  Sun Jan  4 18:11:20 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon, 5 Jan 2004 10:11:20 +1100
Subject: [Twisted-Python] Re: Re: Resume FTP file retrieval
In-Reply-To: <200401041337.27032.richard@starfighter.freeuk.com>
References: <200401041337.27032.richard@starfighter.freeuk.com>
Message-ID: <20040104231120.GA20040@frobozz>

On Sun, Jan 04, 2004 at 01:37:26PM +0000, Richard Townsend wrote:
> Hi Andrew,
> 
> Thanks very much for your suggestions.
[...]
> 
> However, I actually receive the complete file, and not the partial download I 
> expected.
> 
> Note: when I use ftplib.FTP.retrbinary() using the "rest" arg (connecting to 
> the same server) I do get the partial download.
> 
> Any ideas why my Twisted version is not working?

Glancing at ftplib, the difference is that my suggestion will send REST,
PORT/PASV, RETR (in that order), but ftplib does PORT/PASV, REST, RETR.  A
quick glance at http://cr.yp.to/ftp/retr.html doesn't suggest that this
should matter, but this is FTP after all...  (and it wouldn't surprise me if
different servers behave differently here, too)

Looks like FTPClient will need to be changed after all :/

-Andrew.




From itamar at itamarst.org  Sun Jan  4 18:13:42 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 04 Jan 2004 18:13:42 -0500
Subject: [Twisted-Python] Does anyone use instance-only interface
	implementation
In-Reply-To: <71BFD8FA-3F01-11D8-ACF7-000A95686CD8@redivi.com>
References: <1073251847.7794.3.camel@sheriffpony>
	 <71BFD8FA-3F01-11D8-ACF7-000A95686CD8@redivi.com>
Message-ID: <1073258022.24289.6.camel@sheriffpony>

On Sun, 2004-01-04 at 17:00, Bob Ippolito wrote:

> I've used "instance-only interface implementation" when the instance at 
> hand is Foo (the class itself, for its class methods), not Foo().. but 
> that doesn't work with a stock version of Twisted anyways.  I'm 
> probably going to convert the code to PyProtocols next time it's 
> unearthed for that (and other) reasons, but I figure it's worthy of 
> mention.

Well, this is actually the motivation. Want to fix the code so you can
specify classes implementing interfaces, by setting __implements__ on
their metaclass. 

http://twistedmatrix.com/users/roundup.twistd/twisted/issue457

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From michal at pasternak.w.lub.pl  Sun Jan  4 17:31:54 2004
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Sun, 4 Jan 2004 23:31:54 +0100
Subject: [Twisted-Python] Encrypted PB?
Message-ID: <20040104223154.GB5515@pasternak.w.lub.pl>

How can I plug-in encryption of transmission of PB ?



From developer at csrules.dyndns.org  Sun Jan  4 20:43:22 2004
From: developer at csrules.dyndns.org (darryl)
Date: Sun, 04 Jan 2004 17:43:22 -0800
Subject: [Twisted-Python] Encrypted PB?
In-Reply-To: <20040104223154.GB5515@pasternak.w.lub.pl>
References: <20040104223154.GB5515@pasternak.w.lub.pl>
Message-ID: <3FF8C13A.6040200@csrules.dyndns.org>

Michal Pasternak wrote:

>How can I plug-in encryption of transmission of PB ?
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>  
>

SSL

-darryl




From michal at pasternak.w.lub.pl  Sun Jan  4 18:11:10 2004
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Mon, 5 Jan 2004 00:11:10 +0100
Subject: [Twisted-Python] Encrypted PB?
In-Reply-To: <3FF8C13A.6040200@csrules.dyndns.org>
References: <20040104223154.GB5515@pasternak.w.lub.pl> <3FF8C13A.6040200@csrules.dyndns.org>
Message-ID: <20040104231110.GA6428@pasternak.w.lub.pl>

darryl [Sun, Jan 04, 2004 at 05:43:22PM -0800]:
> Michal Pasternak wrote:
> 
> SSL

... any examples?



From miracle at slingshot.co.nz  Sun Jan  4 20:06:05 2004
From: miracle at slingshot.co.nz (Matthew Sherborne)
Date: Mon, 05 Jan 2004 14:06:05 +1300
Subject: [Twisted-Python] dbcred with new api example
Message-ID: <1073264765.18952.2.camel@localhost>

Hope this helps someone.

It's just a authentication checker. It uses a postgres database to store
the usernames and passwords.

Enjoy
-- 
Matthew Sherborne
Director
Sherborne International Ltd.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dbcred.py
Type: text/x-python
Size: 6419 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040105/840886f9/attachment.py 

From phil at bubblehouse.org  Sun Jan  4 21:38:34 2004
From: phil at bubblehouse.org (Phil Christensen)
Date: Sun, 4 Jan 2004 21:38:34 -0500
Subject: [Twisted-Python] Encrypted PB?
In-Reply-To: <20040104231110.GA6428@pasternak.w.lub.pl>
References: <20040104223154.GB5515@pasternak.w.lub.pl> <3FF8C13A.6040200@csrules.dyndns.org> <20040104231110.GA6428@pasternak.w.lub.pl>
Message-ID: <41A66999-3F28-11D8-BCF4-003065D65744@bubblehouse.org>

it's not often i can answer any question on this list, so i hope i'm 
first ;-) ....

here's a snippet from some server code of mine that allows either SSL 
or plaintext sessions:

#If the user has selected secure, we only allow connections
#over SSL. The pyOpenSSL library must be installed for this
#to work.
if(config['secure']):
     contexts = ssl.DefaultOpenSSLContextFactory(config['key'], 
config['cert'])
     pb_service = internet.SSLServer(int(config['port']), 
pb.PBServerFactory(portal), contexts)
else:
     pb_service = internet.TCPServer(int(config['port']), 
pb.PBServerFactory(portal))
pb_service.setServiceParent(master_service)
reg_service.setServiceParent(master_service)


On Jan 4, 2004, at 6:11 PM, Michal Pasternak wrote:

> darryl [Sun, Jan 04, 2004 at 05:43:22PM -0800]:
>> Michal Pasternak wrote:
>>
>> SSL
>
> ... any examples?
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From matthew.s.hegedus at lmco.com  Mon Jan  5 08:41:52 2004
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Mon, 05 Jan 2004 07:41:52 -0600
Subject: [Twisted-Python] IRIX install
Message-ID: <401C60E417B68B48B14B53D845FF596A8D250F@EMSS07M12.us.lmco.com>

Greetings,

What's the official word on Twisted IRIX and UNIX installs? A fellow
co-worker informed me that she contacted someone from Twisted development
who told her that Twisted is not meant for UNIX or IRIX. Thanks,

Matthew



From bob at redivi.com  Mon Jan  5 08:58:56 2004
From: bob at redivi.com (Bob Ippolito)
Date: Mon, 5 Jan 2004 08:58:56 -0500
Subject: [Twisted-Python] IRIX install
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D250F@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D250F@EMSS07M12.us.lmco.com>
Message-ID: <4E1BAE83-3F87-11D8-90C9-000A95686CD8@redivi.com>


On Jan 5, 2004, at 8:41 AM, Hegedus, Matthew S wrote:

> What's the official word on Twisted IRIX and UNIX installs? A fellow
> co-worker informed me that she contacted someone from Twisted 
> development
> who told her that Twisted is not meant for UNIX or IRIX. Thanks,

Are you sure she was talking about this Twisted?  Twisted works just 
about everywhere Python 2.2+ does.  If it doesn't work, file a bug, but 
it definitely should work on anything POSIX enough to have an "X" in 
the name.

-bob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040105/5ee339fb/attachment.bin 

From lists at webcrunchers.com  Mon Jan  5 21:59:26 2004
From: lists at webcrunchers.com (JD)
Date: Mon, 5 Jan 2004 18:59:26 -0800
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <20040103032031.GA14197@frobozz>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com> <20040102025208.GB11930@frobozz> <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com> <20040103032031.GA14197@frobozz>
Message-ID: <565F1944-3FF4-11D8-AECA-0030656C6B9E@webcrunchers.com>

On Jan 2, 2004, at 7:20 PM, Andrew Bennetts wrote:

> The only reason you should have for calling sendLine in an IRCClient
> subclass is to extend its functionality to support more of the 
> protocol than
> it already does.  IRCClient already has support for signing on (the
> 'register' method and the 'signedOn' handler), so you shouldn't use 
> sendLine
> for that.  IRCClient currently lacks some IRC features, such as WHO, 
> so to
> do those you do need sendLine.

That's what I thought.   Did you take a look at that code sample I sent 
earlier?
I hacked that up myself,  with few examples,  so I can see where i 
might have
put things in places they weren't intended to be.

I want to really learn Twisted,  and to be able to put pieces together 
without
having to be constantly digging for example code,  and twiddling with 
that.
>
> Also, good style suggests that you probably shouldn't mix your 
> application
> code with your IRCClient extensions, i.e. subclass IRCClient for WHO 
> support
> (and other other unimplemented commands you need), and then subclass 
> that
> for your application.

I don't quite understand.   Because in my case,  my application just 
intantiates
a client long enough to extract some information from the IRC server,  
issue
a "who" command and extract the data.

I always thought it was appropriate to sub-class the part i want to do, 
  or
parts that are not implemented by the parent,  as in my case of wanting
to do the "who" command,  so I treated the command like any other
IRC command that issues commands and gets back data.

So If I can't mix my application code with a sub_class of a IRCClient,  
then
how is the right way to do it.

John




From lists at webcrunchers.com  Mon Jan  5 22:02:15 2004
From: lists at webcrunchers.com (JD)
Date: Mon, 5 Jan 2004 19:02:15 -0800
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <20040103163247.GD14197@frobozz>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com> <20040102025208.GB11930@frobozz> <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com> <20040103032031.GA14197@frobozz> <20040103163247.GD14197@frobozz>
Message-ID: <BB0FB358-3FF4-11D8-AECA-0030656C6B9E@webcrunchers.com>

On Jan 3, 2004, at 8:32 AM, Andrew Bennetts wrote:

> On Sat, Jan 03, 2004 at 02:20:31PM +1100, I wrote:
>>
>> I don't understand what you're saying here.  You mean things like
>> irc_RPL_WHOISSERVER?

Yes,  exactly.

>>  That's just the way the prefixed getattr idiom works;
>> all you need to do is support a new command then define a handler 
>> method for it

I think I did that,   but not sure I did it right.    I sent a code 
fragment up to the list
earlier,   did you see how I did it?    Was I on the right track?

John




From andrew-twisted at puzzling.org  Mon Jan  5 22:28:25 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 6 Jan 2004 14:28:25 +1100
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <565F1944-3FF4-11D8-AECA-0030656C6B9E@webcrunchers.com>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com> <20040102025208.GB11930@frobozz> <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com> <20040103032031.GA14197@frobozz> <565F1944-3FF4-11D8-AECA-0030656C6B9E@webcrunchers.com>
Message-ID: <20040106032825.GA24218@frobozz>

On Mon, Jan 05, 2004 at 06:59:26PM -0800, JD wrote:
> 
> That's what I thought.   Did you take a look at that code sample I sent
> earlier?  I hacked that up myself,  with few examples,  so I can see where
> i might have put things in places they weren't intended to be.

I did.  The basic idea seemed fine, except for the trivial flaws I pointed
out.  I don't have time to test and debug your code for you, though,
especially when it's obvious you haven't tried to do so either.  If your
code isn't working, then it would help us if you could specify *how* it
isn't working, i.e. what error or misbehaviour you are seeing.  Your
previous mail didn't indicate that you'd tested the example code you sent
(and the trivial syntax errors suggest this is also the case).

> >Also, good style suggests that you probably shouldn't mix your 
> >application
> >code with your IRCClient extensions, i.e. subclass IRCClient for WHO 
> >support
> >(and other other unimplemented commands you need), and then subclass 
> >that
> >for your application.
> 
> I don't quite understand.   Because in my case,  my application just
> intantiates a client long enough to extract some information from the IRC
> server,  issue a "who" command and extract the data.
> 
> I always thought it was appropriate to sub-class the part i want to do, or
> parts that are not implemented by the parent,  as in my case of wanting to
> do the "who" command,  so I treated the command like any other IRC command
> that issues commands and gets back data.
> 
> So If I can't mix my application code with a sub_class of a IRCClient,
> then how is the right way to do it.

What I was trying to say is rather than subclass like this:

    IRCClient (from twisted.protocols.irc)
     |
     \--YourIRCApp (adds WHO command, has your application logic)

It might be a better idea to do it like this:

    IRCClient (from twisted.protocols.irc)
     |
     \--ExtendedIRCClient (adds WHO command)
         |
         \--YourIRCApp (has your application logic)

But that's really just a cosmetic issue.  In an ideal world, Twisted would
already have the WHO command implemented in its standard IRCClient.  Until
we reach that point, though, I still like the idea of keeping the protocol
implementation and the application using that protocol seperate, even if the
"protocol implementation" part of that picture is currently split between
what Twisted already provides (IRCClient) and what you need to add (what I
called ExtendedIRCClient above).

Or you could not implement WHO yourself at all, and use the more complete
IRC implementation in irc2.py...

-Andrew.




From Richard.Townsend at edl.uk.eds.com  Tue Jan  6 10:37:21 2004
From: Richard.Townsend at edl.uk.eds.com (Richard.Townsend at edl.uk.eds.com)
Date: Tue, 6 Jan 2004 15:37:21 -0000 
Subject: [Twisted-Python] Re: Re: Re: Resume FTP file retrieval
Message-ID: <68CF619C1F239A4A8BB8EDD3D1657DC827B248@ukhkc201>

Hi Andrew,
 
I have tried to follow the code in FTPClient. 
 
It looks like the _openDataConnection() method is responsible for sending
the PORT/PASV before the RETR. However, I'm not sure how it could be safely
modified to send a REST between the two requests.
 
I need this facility to be able to resume a partial download when
transferring large files over an unreliable comms link.
 
Would you or another of Twisted experts be able to help make this change?
 
thanks,
Richard Townsend
(2nd attempt to post this)
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20040106/4a3b24e2/attachment.htm 

From exarkun at intarweb.us  Tue Jan  6 12:22:50 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Tue, 6 Jan 2004 12:22:50 -0500
Subject: ircLogBot (Was: [Twisted-Python] A Twisted Web Question....)
In-Reply-To: <E7856519-3B73-11D8-ADCB-0030656C6B9E@shopip.com>
References: <200312290100.49502.lstep@adequat.net> <F487D580-3999-11D8-8F12-0030656C6B9E@webcrunchers.com> <0700785A-39B9-11D8-9472-000393C9700E@twistedmatrix.com> <E7856519-3B73-11D8-ADCB-0030656C6B9E@shopip.com>
Message-ID: <20040106172250.GA8354@intarweb.us>

On Wed, Dec 31, 2003 at 01:29:59AM -0800, John Draper wrote:
> Hi, 
> 

  Hi.  Your mail client has decided that you are responding to a message in
a thread about Twisted Web.  It probably did this because you had that
message selected when you told it to compose mail, or because you selected
reply rather than compose.  Since your message is not actually about Twisted
Web, this is confusing and undesirable.  In the future, please pay more
attention to what you are asking your mail client to do, so that it is
easier to find and understand the question you are asking.

> I call your attention to: 
> 
> This was quoted in the Docs on the TwistedMatrix web site. 
> 
> Persistent Data in the Factory 
> 
> Since the Protocol instance is recreated each time the connection is 
> made, the client needs some way to keep track of data that should be 
> persisted. In the case of ircLogBot.py: (LogBot.log() just logs the 
> data to the file object stored in LogBot.file) 
> 
> it references a LogBot.log() call....   but I checked in ircLogBot.py 
> and there is NO log() 
> method,  nor is there one in any of the other classes it inherits from. 
> 
> Would it be too much of a bother if I were to ask anyone about this 
> descrepancy? 
> 

  Not at all.  It is true that the class has no log method, however, if you
examine the connectionMade method:

    def connectionMade(self):
        irc.IRCClient.connectionMade(self)
        self.logger = MessageLogger(open(self.factory.filename, "a"))
        self.log = self.logger.log
        self.log("[connected at %s]" % time.asctime(time.localtime(time.time())))

  you will see that instances of the class bind method from a *different* to
that name, allowing users of the class to use the method as if it were
defined by the LogBot class itself.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040106/3b3675b7/attachment.pgp 

From daedalus at eigenmagic.com  Wed Jan  7 00:47:45 2004
From: daedalus at eigenmagic.com (Justin Warren)
Date: Wed, 7 Jan 2004 16:47:45 +1100
Subject: [Twisted-Python] BEEPy - a Python BEEP library
Message-ID: <20040107054745.GA19868@snafu.eigenmagic.com>

Hi folks,

I'm relatively new to twisted, but I saw some discussion early in 2003
around BEEP and twisted lamenting the lack of a Python library. I hope
this is the right place to post.

I'm the developer of a library called BEEPy which is a BEEP
implementation written in pure Python. I recently redesigned the core
to use twisted for TCP and SSL comms, so I figured you folks might be
interested in it.

BEEPy is LGPL licensed and hosted over at sourceforge:
http://beepy.sourceforge.net/ for the curious.

A quick summary of features:
- Implemented using twisted Protocol and Factory subclasses
- Support for TLS for transport layer security
- Support for SASL ANONYMOUS and OTP mechanisms for authentication
- Implements the BEEP management profile
- Reference implementation of an echo profile
- Loads of example code

Cheers,

Justin

-- 
"Either way, it'll remind the clued that there's only one letter difference
 between "turkey" and "turnkey"." -- Mike Andrews in a.s.r



From itamar at itamarst.org  Wed Jan  7 01:13:14 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 07 Jan 2004 01:13:14 -0500
Subject: [Twisted-Python] BEEPy - a Python BEEP library
In-Reply-To: <20040107054745.GA19868@snafu.eigenmagic.com>
References: <20040107054745.GA19868@snafu.eigenmagic.com>
Message-ID: <1073455994.3353.2.camel@sheriffpony>

On Wed, 2004-01-07 at 00:47, Justin Warren wrote:

> I'm the developer of a library called BEEPy which is a BEEP
> implementation written in pure Python. I recently redesigned the core
> to use twisted for TCP and SSL comms, so I figured you folks might be
> interested in it.

Indeed!

I've been meaning to look into BEEP again, so it'll be nice to be able
to look at Twisted implementation. I'll add you to our list of open
source projects using Twisted.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From exarkun at intarweb.us  Wed Jan  7 01:26:09 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 7 Jan 2004 01:26:09 -0500
Subject: [Twisted-Python] BEEPy - a Python BEEP library
In-Reply-To: <20040107054745.GA19868@snafu.eigenmagic.com>
References: <20040107054745.GA19868@snafu.eigenmagic.com>
Message-ID: <20040107062609.GA10915@intarweb.us>

On Wed, Jan 07, 2004 at 04:47:45PM +1100, Justin Warren wrote:
> Hi folks,
> 
> I'm relatively new to twisted, but I saw some discussion early in 2003
> around BEEP and twisted lamenting the lack of a Python library. I hope
> this is the right place to post.
> 
> I'm the developer of a library called BEEPy which is a BEEP
> implementation written in pure Python. I recently redesigned the core
> to use twisted for TCP and SSL comms, so I figured you folks might be
> interested in it.
> 
> BEEPy is LGPL licensed and hosted over at sourceforge:
> http://beepy.sourceforge.net/ for the curious.
> 
> A quick summary of features:
> - Implemented using twisted Protocol and Factory subclasses
> - Support for TLS for transport layer security
> - Support for SASL ANONYMOUS and OTP mechanisms for authentication
> - Implements the BEEP management profile
> - Reference implementation of an echo profile
> - Loads of example code
> 
> Cheers,
> 

  Very cool to hear :)  It's late and I'm on my way to bed, so I'll probably
download this tomorrow and take a look.  One thing I would have liked to see
on the web page is some html documentation, at least of the APIs.  Any
chance of getting something like that up (via epydoc or whatever)?

  Jp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040107/92bad68f/attachment.pgp 

From daedalus at eigenmagic.com  Wed Jan  7 02:06:06 2004
From: daedalus at eigenmagic.com (Justin Warren)
Date: Wed, 7 Jan 2004 18:06:06 +1100
Subject: [Twisted-Python] BEEPy - a Python BEEP library
In-Reply-To: <20040107062609.GA10915@intarweb.us>
References: <20040107054745.GA19868@snafu.eigenmagic.com> <20040107062609.GA10915@intarweb.us>
Message-ID: <20040107070606.GB19868@snafu.eigenmagic.com>

On Wed, Jan 07, 2004 at 01:26:09AM -0500, Jp Calderone wrote:
> On Wed, Jan 07, 2004 at 04:47:45PM +1100, Justin Warren wrote:

> > I'm the developer of a library called BEEPy which is a BEEP
> > implementation written in pure Python. I recently redesigned the core
> > to use twisted for TCP and SSL comms, so I figured you folks might be
> > interested in it.

>   Very cool to hear :)  It's late and I'm on my way to bed, so I'll probably
> download this tomorrow and take a look.  One thing I would have liked to see
> on the web page is some html documentation, at least of the APIs.  Any
> chance of getting something like that up (via epydoc or whatever)?

Probably, but not soon. The move to twisted involved a pretty major
overhaul of the API. Like most lazy developers, I've concentrated on
the code rather than writing good doco. :)

I've never used epydoc before, but it looks nice from first
impressions. I'll check it out and get cracking on some doco.

-- 
"Compared to system administration, being cursed forever is a step up."
                                        - Paul Tomko in the Monastery



From daedalus at eigenmagic.com  Wed Jan  7 02:06:59 2004
From: daedalus at eigenmagic.com (Justin Warren)
Date: Wed, 7 Jan 2004 18:06:59 +1100
Subject: [Twisted-Python] BEEPy - a Python BEEP library
In-Reply-To: <1073455994.3353.2.camel@sheriffpony>
References: <20040107054745.GA19868@snafu.eigenmagic.com> <1073455994.3353.2.camel@sheriffpony>
Message-ID: <20040107070659.GC19868@snafu.eigenmagic.com>

On Wed, Jan 07, 2004 at 01:13:14AM -0500, Itamar Shtull-Trauring wrote:
> On Wed, 2004-01-07 at 00:47, Justin Warren wrote:
> 
> > I'm the developer of a library called BEEPy which is a BEEP
> > implementation written in pure Python. I recently redesigned the core
> > to use twisted for TCP and SSL comms, so I figured you folks might be
> > interested in it.
> 
> Indeed!
> 
> I've been meaning to look into BEEP again, so it'll be nice to be able
> to look at Twisted implementation. I'll add you to our list of open
> source projects using Twisted.

w00t! Thanks very much!

-- 
"I wouldn't be surprised if this were a typo, and Shmuel meant to
write "ARF -A" to see what other dogs would answer when he barked."
  -- Mike Andrews in a.s.r



From matteo.giacomazzi at email.it  Wed Jan  7 05:52:34 2004
From: matteo.giacomazzi at email.it (Matteo Giacomazzi)
Date: Wed, 7 Jan 2004 11:52:34 +0100
Subject: [Twisted-Python] UNIX socket problem
Message-ID: <2712163625.20040107115234@email.it>

Hello,

  I have a problem with a TAP using UNIX socket.
  On  one  server  it  works  fine, on another one it raises a strange
  exception, here is the trace if someone can help...
  I  can't  understand  why  self.factory,  where  self  should  be  a
  unix.Connector  instance,  get an int value instead of the factory I
  provide. And, in any case, I cannot understand why it happens on one
  server but not in another one (same Python and Twisted version).
  Thanks!

2004/01/07 11:44 CET [-] Traceback (most recent call last):
2004/01/07 11:44 CET [-]   File "/usr/bin/twistd", line 36, in ?
2004/01/07 11:44 CET [-]     run()
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/scripts/twistd.py", line 188, in run
2004/01/07 11:44 CET [-]     app.run(runApp, ServerOptions)
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/application/app.py", line 200, in run
2004/01/07 11:44 CET [-]     runApp(config)
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/scripts/twistd.py", line 179, in runApp
2004/01/07 11:44 CET [-]     startApplication(config, application)
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/scripts/twistd.py", line 165, in startApplication
2004/01/07 11:44 CET [-]     app.startApplication(application, not config['no_save'])
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/application/app.py", line 220, in startApplication
2004/01/07 11:44 CET [-]     service.IService(application).startService()
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/application/service.py", line 194, in startService
2004/01/07 11:44 CET [-]     service.startService()
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/application/service.py", line 194, in startService
2004/01/07 11:44 CET [-]     service.startService()
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/application/internet.py", line 81, in startService
2004/01/07 11:44 CET [-]     self._connection = self._getConnection()
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/application/internet.py", line 89, in _getConnection
2004/01/07 11:44 CET [-]     return getattr(reactor, 'connect'+self.method)(*self.args,
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/internet/default.py", line 232, in connectUNIX
2004/01/07 11:44 CET [-]     c.connect()
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/internet/base.py", line 553, in connect
2004/01/07 11:44 CET [-]     self.factory.doStart()
2004/01/07 11:44 CET [-] AttributeError: 'int' object has no attribute 'doStart'  


Kindest regards,
 Matteo




From andrew-twisted at puzzling.org  Wed Jan  7 08:17:33 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 8 Jan 2004 00:17:33 +1100
Subject: [Twisted-Python] Re: XML Parsing Error in tutorial.xhtml
In-Reply-To: <bss3jb$fpd$1@sea.gmane.org>
References: <bskjqb$bba$1@sea.gmane.org> <20031230022616.GA1043@frobozz> <bss3jb$fpd$1@sea.gmane.org>
Message-ID: <20040107131733.GD29053@frobozz>

On Tue, Dec 30, 2003 at 03:52:17PM +0100, Anton Vredegoor wrote:
> 
> By the way, the tutorial uses a finger server as its example but the
> Windows 98SE machines don't have a finger client, not even if using
> Cygwin. I knew about learning curves, but nobody informed me about the
> rocks along the slope :-)

That's a good point... we should probably mention in the tute somewhere that
you can use telnet as a poor mans finger client, for people on operating
systems that aren't blessed with finger(1).  Win98SE does have a telnet
client, I hope?

-Andrew.




From andrew-twisted at puzzling.org  Wed Jan  7 08:30:06 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 8 Jan 2004 00:30:06 +1100
Subject: [Twisted-Python] Re: Re: Re: Resume FTP file retrieval
In-Reply-To: <68CF619C1F239A4A8BB8EDD3D1657DC827B248@ukhkc201>
References: <68CF619C1F239A4A8BB8EDD3D1657DC827B248@ukhkc201>
Message-ID: <20040107133006.GE29053@frobozz>

On Tue, Jan 06, 2004 at 03:37:21PM -0000, Richard.Townsend at edl.uk.eds.com wrote:
>    Hi Andrew,
>     
>    I have tried to follow the code in FTPClient.

You're brave ;)

>    It looks like the  _openDataConnection() method is responsible for sending
>    the PORT/PASV  before the RETR. However, I'm not sure how it could be
>    safely modified  to send a REST between the two requests.

You've found the right spot -- but as you've probably noticed, it's probably
the hairiest code in the entire class.

>    I need this facility to be able to resume a partial download when 
>    transferring large files over an unreliable comms link.
>     
>    Would you or another of Twisted experts be able to help make this change?

I've attached a completely untested patch!  Let me know how it goes.

-Andrew.

-------------- next part --------------
Index: twisted/protocols/ftp.py
===================================================================
RCS file: /cvs/Twisted/twisted/protocols/ftp.py,v
retrieving revision 1.100
diff -u -r1.100 ftp.py
--- twisted/protocols/ftp.py	13 Dec 2003 01:12:09 -0000	1.100
+++ twisted/protocols/ftp.py	7 Jan 2004 13:28:09 -0000
@@ -1706,13 +1706,13 @@
         else:
             return None
 
-    def receiveFromConnection(self, command, protocol):
+    def receiveFromConnection(self, commands, protocol):
         """
         Retrieves a file or listing generated by the given command,
         feeding it to the given protocol.
 
-        @param command: string of an FTP command to execute then receive the
-            results of (e.g. LIST, RETR)
+        @param command: list of strings of FTP commands to execute then receive
+            the results of (e.g. LIST, RETR)
         @param protocol: A L{Protocol} *instance* e.g. an
             L{FTPFileListProtocol}, or something that can be adapted to one.
             Typically this will be an L{IConsumer} implemenation.
@@ -1721,9 +1721,9 @@
         """
         protocol = IProtocol(protocol)
         wrapper = ProtocolWrapper(protocol, Deferred())
-        return self._openDataConnection(command, wrapper)
+        return self._openDataConnection(commands, wrapper)
 
-    def sendToConnection(self, command):
+    def sendToConnection(self, commands):
         """XXX
         
         @returns: A tuple of two L{Deferred}s:
@@ -1733,14 +1733,15 @@
                   - L{Deferred} list of control-connection responses.
         """
         s = SenderProtocol()
-        r = self._openDataConnection(command, s)
+        r = self._openDataConnection(commands, s)
         return (s.connectedDeferred, r)
 
-    def _openDataConnection(self, command, protocol):
+    def _openDataConnection(self, commands, protocol):
         """
         This method returns a DeferredList.
         """
-        cmd = FTPCommand(command, public=1)
+        cmds = [FTPCommand(command, public=1) for command in commands]
+        cmdsDeferred = DeferredList([cmd.deferred for cmd in cmds])
 
         if self.passive:
             # Hack: use a mutable object to sneak a variable out of the 
@@ -1766,7 +1767,7 @@
             self.queueCommand(pasvCmd)
             pasvCmd.deferred.addCallback(doPassive).addErrback(self.fail)
 
-            results = [cmd.deferred, pasvCmd.deferred, protocol.deferred]
+            results = [cmdsDeferred, pasvCmd.deferred, protocol.deferred]
             d = DeferredList(results, fireOnOneErrback=1)
 
             # Ensure the connection is always closed
@@ -1799,12 +1800,13 @@
             portCmd.fail = lambda error: error
             
             # Ensure that the connection always gets closed
-            cmd.deferred.addErrback(lambda e, pc=portCmd: pc.fail(e) or e)
+            cmdsDeferred.addErrback(lambda e, pc=portCmd: pc.fail(e) or e)
 
-            results = [cmd.deferred, portCmd.deferred, portCmd.transferDeferred]
+            results = [cmdsDeferred, portCmd.deferred, portCmd.transferDeferred]
             d = DeferredList(results, fireOnOneErrback=1)
                               
-        self.queueCommand(cmd)
+        for cmd in cmds:
+            self.queueCommand(cmd)
         return d
 
     def generatePortCommand(self, portCmd):
@@ -1845,7 +1847,7 @@
         # Escape newline characters
         return string.replace(path, '\n', '\0')
 
-    def retrieveFile(self, path, protocol):
+    def retrieveFile(self, path, protocol, offset=0):
         """Retrieve a file from the given path
 
         This method issues the 'RETR' FTP command.
@@ -1855,14 +1857,18 @@
 
         @param path: path to file that you wish to receive.
         @param protocol: a L{Protocol} instance.
+        @param offset: offset to start downloading from
 
         @returns: L{Deferred}
         """
-        return self.receiveFromConnection('RETR ' + self.escapePath(path), protocol)
+        cmds = ['RETR ' + self.escapePath(path)]
+        if offset:
+            cmds.insert(0, ('REST ' + str(offset))
+        return self.receiveFromConnection(, protocol)
 
     retr = retrieveFile
 
-    def storeFile(self, path):
+    def storeFile(self, path, offset=0):
         """Store a file at the given path.
 
         This method issues the 'STOR' FTP command.
@@ -1873,8 +1879,10 @@
                     is completely transferred.
                   - L{Deferred} list of control-connection responses.
         """
-        
-        return self.sendToConnection('STOR ' + self.escapePath(path))
+        cmds = ['STOR ' + self.escapePath(path)]
+        if offset:
+            cmds.insert(0, ('REST ' + str(offset))
+        return self.sendToConnection(cmds)
 
     stor = storeFile
         

From bob at redivi.com  Wed Jan  7 08:34:24 2004
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 7 Jan 2004 08:34:24 -0500
Subject: [Twisted-Python] BEEPy - a Python BEEP library
In-Reply-To: <20040107054745.GA19868@snafu.eigenmagic.com>
References: <20040107054745.GA19868@snafu.eigenmagic.com>
Message-ID: <3513EC08-4116-11D8-B0D7-000A95686CD8@redivi.com>


On Jan 7, 2004, at 12:47 AM, Justin Warren wrote:

> I'm relatively new to twisted, but I saw some discussion early in 2003
> around BEEP and twisted lamenting the lack of a Python library. I hope
> this is the right place to post.
>
> I'm the developer of a library called BEEPy which is a BEEP
> implementation written in pure Python. I recently redesigned the core
> to use twisted for TCP and SSL comms, so I figured you folks might be
> interested in it.
>
> BEEPy is LGPL licensed and hosted over at sourceforge:
> http://beepy.sourceforge.net/ for the curious.

Neat!

I've heard Apple's new Xgrid cluster-communication-stuff is based on 
XML property lists on top of BEEP.  Might be worth my time to look into 
reverse engineering it now that this exists :)

-bob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040107/c40fbb54/attachment.bin 

From matteo.giacomazzi at email.it  Wed Jan  7 09:28:24 2004
From: matteo.giacomazzi at email.it (Matteo Giacomazzi)
Date: Wed, 7 Jan 2004 15:28:24 +0100
Subject: [Twisted-Python] UNIX socket problem
In-Reply-To: <2712163625.20040107115234@email.it>
References: <2712163625.20040107115234@email.it>
Message-ID: <1041917046.20040107152824@email.it>

Hello,

>   I have a problem with a TAP using UNIX socket.
[snip]

Just  re-checking-out  my  sources  from  CVS  repository  solved  the
problem.
Many apologizes.

Regards,
 Matteo




From marjancinober at hotmail.com  Thu Jan  8 10:14:47 2004
From: marjancinober at hotmail.com (marjan cinober)
Date: Thu, 08 Jan 2004 16:14:47 +0100
Subject: [Twisted-Python] Re: examples/row_example.py  DBError Row object not in cache
Message-ID: <Sea1-F152WrwjvzWvTl0004c2aa@hotmail.com>

Hello

Thank you Dave for your fast reply, but it seems like I haven't managed to 
get rid of the problem by syncing with current CVS (today). And upgrading 
from Twisted 1.1.0 to 1.1.1 on Debian sarge - testing

Eroor message looks exactly the same
--- <exception caught here> ---
  File "/usr/lib/python2.3/site-packages/twisted/internet/defer.py", line 
308, in _runCallbacks
    self.result = callback(self.result, *args, **kw)
  File "./row_example.py", line 58, in onInsert
    manager.deleteRow(newRoom).addCallback(onDelete)
  File 
"/usr/lib/python2.3/site-packages/twisted/enterprise/sqlreflector.py", line 
330, in deleteRow
    self.removeFromCache(rowObject)
  File "/usr/lib/python2.3/site-packages/twisted/enterprise/reflector.py", 
line 141, in removeFromCache
    raise DBError("Row object not in cache: %s", rowObject)
twisted.enterprise.util.DBError: ('Row object not in cache: %s', <Room 
#100001: newRoom1 (fred) (100,100)>)

On Sun, 04 Jan 2004 11:00:20, Dave Peticolas wrote:
>Re: examples/row_example.py  DBError Row object not in cache
>On Sat, 2004-01-03 at 11:13, marjan cinober wrote:
> > Still trying to test some postgersql access from twisted.
> > Unfortunate at running example ROW (Twisted Enterprise)
> > http://twistedmatrix.com/documents/examples/row_example.py
> >
> > got stuck at
> >   File "row_example.py", line 58, in onInsert
> >     manager.deleteRow(newRoom).addCallback(onDelete)
> >
> > Anybody has some clues?
>
>This was a bug. It should be fixed in CVS.
>
>dave

_________________________________________________________________
Tired of spam? Get advanced junk mail protection with MSN 8. 
http://join.msn.com/?page=features/junkmail




From Richard.Townsend at edl.uk.eds.com  Thu Jan  8 09:38:04 2004
From: Richard.Townsend at edl.uk.eds.com (Richard.Townsend at edl.uk.eds.com)
Date: Thu, 8 Jan 2004 14:38:04 -0000 
Subject: [Twisted-Python] Re: Re: Re: Resume FTP file retrieval
Message-ID: <68CF619C1F239A4A8BB8EDD3D1657DC827B24A@ukhkc201>

Hi Andrew,
 
Many thanks for the patch.
 
I had to fix 3 typos to get it to run:
 
Line 1867 needs an extra closing parenthesis:
             cmds.insert(0, ('REST ' + str(offset)))
 
Line 1868 needs the missing 'cmds' parameter:
         return self.receiveFromConnection(cmds, protocol)
 
Line 1885 needs an extra closing parenthesis:
             cmds.insert(0, ('REST ' + str(offset)))
 
My test program then successfully did a partial download!
 
Best regards,
Richard Townsend
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20040108/2c125c73/attachment.htm 

From xpythonist at yahoo.com.br  Thu Jan  8 12:59:40 2004
From: xpythonist at yahoo.com.br (=?iso-8859-1?q?Aloysio=20Figueiredo?=)
Date: Thu, 8 Jan 2004 14:59:40 -0300 (ART)
Subject: [Twisted-Python] twisted.conch.ssh.filetransfer example...
In-Reply-To: <3513EC08-4116-11D8-B0D7-000A95686CD8@redivi.com>
Message-ID: <20040108175940.36573.qmail@web21507.mail.yahoo.com>

I need to transfer a file via ssh.
twisted.conch.ssh.filetransfer seems to be a way to do
that, but it's not documented and I couldn't figure
out how to use it. Could anyone point a short example
(here or in the web) ?

Thanks in advance,
Aloysio Figueiredo

______________________________________________________________________

Conhe?a a nova central de informa??es anti-spam do Yahoo! Mail:
http://www.yahoo.com.br/antispam



From lists at webcrunchers.com  Thu Jan  8 16:04:18 2004
From: lists at webcrunchers.com (JD)
Date: Thu, 8 Jan 2004 13:04:18 -0800
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <20040106032825.GA24218@frobozz>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com> <20040102025208.GB11930@frobozz> <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com> <20040103032031.GA14197@frobozz> <565F1944-3FF4-11D8-AECA-0030656C6B9E@webcrunchers.com> <20040106032825.GA24218@frobozz>
Message-ID: <3944330C-421E-11D8-AECA-0030656C6B9E@webcrunchers.com>

On Jan 5, 2004, at 7:28 PM, Andrew Bennetts wrote:

> On Mon, Jan 05, 2004 at 06:59:26PM -0800, JD wrote:
>>
>> That's what I thought.   Did you take a look at that code sample I 
>> sent
>> earlier?  I hacked that up myself,  with few examples,  so I can see 
>> where
>> i might have put things in places they weren't intended to be.
>
> I did.  The basic idea seemed fine, except for the trivial flaws I 
> pointed
> out.  I don't have time to test and debug your code for you, though,
> especially when it's obvious you haven't tried to do so either.  If 
> your
> code isn't working, then it would help us if you could specify *how* it
> isn't working, i.e. what error or misbehaviour you are seeing.  Your
> previous mail didn't indicate that you'd tested the example code you 
> sent
> (and the trivial syntax errors suggest this is also the case).

Don't worry about the code....   it was put up there to only show to
general construct,  and how I plan to put things together.   it was a 
simple
lame example totally different then what my intended APP was going to
be,   I just used that just to illustrate to others,  my understanding, 
  or
lack thereof..
>
>>> Also, good style suggests that you probably shouldn't mix your
>>> application
>>> code with your IRCClient extensions, i.e. subclass IRCClient for WHO
>>> support
>>> (and other other unimplemented commands you need), and then subclass
>>> that
>>> for your application.
>>
>> I don't quite understand.   Because in my case,  my application just
>> intantiates a client long enough to extract some information from the 
>> IRC
>> server,  issue a "who" command and extract the data.
>>
>> I always thought it was appropriate to sub-class the part i want to 
>> do, or
>> parts that are not implemented by the parent,  as in my case of 
>> wanting to
>> do the "who" command,  so I treated the command like any other IRC 
>> command
>> that issues commands and gets back data.
>>
>> So If I can't mix my application code with a sub_class of a IRCClient,
>> then how is the right way to do it.
>
> What I was trying to say is rather than subclass like this:
>
>     IRCClient (from twisted.protocols.irc)
>      |
>      \--YourIRCApp (adds WHO command, has your application logic)
>
> It might be a better idea to do it like this:
>
>     IRCClient (from twisted.protocols.irc)
>      |
>      \--ExtendedIRCClient (adds WHO command)
>          |
>          \--YourIRCApp (has your application logic)

I've already decided that....    because when I first started to use
Twisted,  I had no clue of even the existance of ExtendedIRCClient
because it was so cleverly mis-labeled and hidden so well in the
examples,  I never would have found it,  had I not posted this in
the first place.

John




From cygnus at cprogrammer.org  Thu Jan  8 16:39:39 2004
From: cygnus at cprogrammer.org (Jonathan Daugherty)
Date: Thu, 8 Jan 2004 16:39:39 -0500
Subject: [Twisted-Python] wxreactor
Message-ID: <20040108213939.GA12742@mail.theserver.ath.cx>

I'm using debian unstable, twisted version 1.1.1-1, python 2.3.

I'm running a wxPython demo script from the twisted site which
uses the wxreactor; it will not run, and it cannot import the
wxreactor.

The error, as one would expect, is:

File "test.py", line 20, in ?
  from twisted.internet import wxreactor
ImportError: cannot import name wxreactor

A search of the python2.3-twisted package and wxsupport.py file
indicates no such entity exists.  However, I know that a wxreactor
has been in development: is this merely a limitation of the debian
package I am using, or has it not yet been introduced into the
release?

Thanks!

-- 

  Jonathan Daugherty
  http://www.cprogrammer.org

  "It's a book about a Spanish guy called Manual, you should read it."
                                                            -- Dilbert



From itamar at itamarst.org  Thu Jan  8 16:47:58 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 08 Jan 2004 16:47:58 -0500
Subject: [Twisted-Python] wxreactor
In-Reply-To: <20040108213939.GA12742@mail.theserver.ath.cx>
References: <20040108213939.GA12742@mail.theserver.ath.cx>
Message-ID: <1073598478.6561.10.camel@sheriffpony>

On Thu, 2004-01-08 at 16:39, Jonathan Daugherty wrote:

> A search of the python2.3-twisted package and wxsupport.py file
> indicates no such entity exists.  However, I know that a wxreactor
> has been in development: is this merely a limitation of the debian
> package I am using, or has it not yet been introduced into the
> release?

Hmmm. Maybe I added wxreactor after version 1.1.1? There's no
twisted/internet/wxreactor.py in your install? There should be.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From cygnus at cprogrammer.org  Thu Jan  8 16:55:23 2004
From: cygnus at cprogrammer.org (Jonathan Daugherty)
Date: Thu, 8 Jan 2004 16:55:23 -0500
Subject: [Twisted-Python] wxreactor
In-Reply-To: <1073598478.6561.10.camel@sheriffpony>
References: <20040108213939.GA12742@mail.theserver.ath.cx> <1073598478.6561.10.camel@sheriffpony>
Message-ID: <20040108215523.GA12847@mail.theserver.ath.cx>

# Hmmm. Maybe I added wxreactor after version 1.1.1? There's no
# twisted/internet/wxreactor.py in your install? There should be.

$ dpkg -L python2.3-twisted | grep -i reactor
/usr/lib/python2.3/site-packages/twisted/internet/cfreactor.py
/usr/lib/python2.3/site-packages/twisted/internet/gladereactor.py
/usr/lib/python2.3/site-packages/twisted/internet/gtk2reactor.py
/usr/lib/python2.3/site-packages/twisted/internet/gtkreactor.py
/usr/lib/python2.3/site-packages/twisted/internet/javareactor.py
/usr/lib/python2.3/site-packages/twisted/internet/kqreactor.py
/usr/lib/python2.3/site-packages/twisted/internet/pollreactor.py
/usr/lib/python2.3/site-packages/twisted/internet/qtreactor.py
/usr/lib/python2.3/site-packages/twisted/internet/reactor.py
/usr/lib/python2.3/site-packages/twisted/internet/win32eventreactor.py

-- 

  Jonathan Daugherty
  http://www.cprogrammer.org

  "It's a book about a Spanish guy called Manual, you should read it."
                                                            -- Dilbert



From itamar at itamarst.org  Thu Jan  8 17:03:54 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 08 Jan 2004 17:03:54 -0500
Subject: [Twisted-Python] wxreactor
In-Reply-To: <20040108215523.GA12847@mail.theserver.ath.cx>
References: <20040108213939.GA12742@mail.theserver.ath.cx>
	 <1073598478.6561.10.camel@sheriffpony>
	 <20040108215523.GA12847@mail.theserver.ath.cx>
Message-ID: <1073599433.6558.12.camel@sheriffpony>

Yep, looks like it's only included in 1.1.2 (which hopefully will be out
soon).




From cygnus at cprogrammer.org  Thu Jan  8 17:10:29 2004
From: cygnus at cprogrammer.org (Jonathan Daugherty)
Date: Thu, 8 Jan 2004 17:10:29 -0500
Subject: [Twisted-Python] wxreactor
In-Reply-To: <1073599433.6558.12.camel@sheriffpony>
References: <20040108213939.GA12742@mail.theserver.ath.cx> <1073598478.6561.10.camel@sheriffpony> <20040108215523.GA12847@mail.theserver.ath.cx> <1073599433.6558.12.camel@sheriffpony>
Message-ID: <20040108221029.GB13109@mail.theserver.ath.cx>

# Yep, looks like it's only included in 1.1.2 (which hopefully will be out
# soon).

Ok, thanks! :-D

-- 

  Jonathan Daugherty
  http://www.cprogrammer.org

  "It's a book about a Spanish guy called Manual, you should read it."
                                                            -- Dilbert



From matteo.giacomazzi at email.it  Thu Jan  8 17:20:18 2004
From: matteo.giacomazzi at email.it (Matteo Giacomazzi)
Date: Thu, 8 Jan 2004 23:20:18 +0100
Subject: [Twisted-Python] wxreactor
In-Reply-To: <1073599433.6558.12.camel@sheriffpony>
References: <20040108213939.GA12742@mail.theserver.ath.cx>
 <1073598478.6561.10.camel@sheriffpony>
 <20040108215523.GA12847@mail.theserver.ath.cx>
 <1073599433.6558.12.camel@sheriffpony>
Message-ID: <12230138140.20040108232018@email.it>

Hi Itamar,

> Yep, looks like it's only included in 1.1.2 (which hopefully will be
> out soon).

Yes,  confirmed:  I had to download it from the CVS repository (it has
changed a bit since your post in ML).

Regards,
 Matteo




From cygnus at cprogrammer.org  Thu Jan  8 17:49:56 2004
From: cygnus at cprogrammer.org (Jonathan Daugherty)
Date: Thu, 8 Jan 2004 17:49:56 -0500
Subject: [Twisted-Python] wxreactor
In-Reply-To: <1073599433.6558.12.camel@sheriffpony>
References: <20040108213939.GA12742@mail.theserver.ath.cx> <1073598478.6561.10.camel@sheriffpony> <20040108215523.GA12847@mail.theserver.ath.cx> <1073599433.6558.12.camel@sheriffpony>
Message-ID: <20040108224956.GA13329@mail.theserver.ath.cx>

# Yep, looks like it's only included in 1.1.2 (which hopefully will be out
# soon).

Just out of curiosity: do you have any general idea as to the approximate
release date for 1.1.2?

-- 

  Jonathan Daugherty
  http://www.cprogrammer.org

  "It's a book about a Spanish guy called Manual, you should read it."
                                                            -- Dilbert



From reapnow at excite.com  Thu Jan  8 18:14:07 2004
From: reapnow at excite.com (Patrick Gilmartin)
Date: Thu,  8 Jan 2004 18:14:07 -0500 (EST)
Subject: [Twisted-Python] Newbie Question about PB and Firewalls
Message-ID: <20040108231407.B4D25109EB9@xprdmailfe1.nwk.excite.com>



I have been reviewing Twisted site and documentation fairly extensive for the past couple of months.  

I have just downloaded it to start working with it, but before I get started there are some answers I seek that will really help in my overall plans.

>From all the reading I have done, it looks like PB would be the optimal protocol for me to use.  I understand where I have decision making power at both ends of the line, I can modify the Firewalls settings to accommodate the port(s).  

But I know I will have situations where the client side will be behind a firewall where I do manage the decision making process.  One of the reasons why XML-RPC and SOAP are broadly popular choices is that they are over HTTP.  

Given the above situation about Firewall settings where I have no control, is my assumption correct that the PB protocol is not an option for me.

Thanks in advance for your help.

Patrick

_______________________________________________
Join Excite! - http://www.excite.com
The most personalized portal on the Web!



From andrew-twisted at puzzling.org  Thu Jan  8 18:47:27 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 9 Jan 2004 10:47:27 +1100
Subject: [Twisted-Python] Re: Re: Re: Resume FTP file retrieval
In-Reply-To: <68CF619C1F239A4A8BB8EDD3D1657DC827B24A@ukhkc201>
References: <68CF619C1F239A4A8BB8EDD3D1657DC827B24A@ukhkc201>
Message-ID: <20040108234727.GA3825@frobozz>

On Thu, Jan 08, 2004 at 02:38:04PM -0000, Richard.Townsend at edl.uk.eds.com wrote:
>    Hi Andrew,
>     
>    Many thanks for the patch.
>     
>    I had to fix 3 typos to get it to run:

Thanks!

[...]
>    My test program then successfully did a partial download!

Wow!  That's a much better result than I was expecting :)

I'll check in the fixed patch later tonight.

-Andrew.




From teratorn at world-net.net  Thu Jan  8 22:05:59 2004
From: teratorn at world-net.net (Eric Mangold)
Date: Thu, 8 Jan 2004 20:05:59 -0700
Subject: [Twisted-Python] Re: Newbie Question about PB and Firewalls
In-Reply-To: <20040108231407.B4D25109EB9@xprdmailfe1.nwk.excite.com>
References: <20040108231407.B4D25109EB9@xprdmailfe1.nwk.excite.com>
Message-ID: <200401082006.00230.teratorn@world-net.net>

On Thursday 08 January 2004 04:14 pm, Patrick Gilmartin wrote:
> I have been reviewing Twisted site and documentation fairly extensive
> for the past couple of months.
>
> I have just downloaded it to start working with it, but before I get
> started there are some answers I seek that will really help in my
> overall plans.
>
> From all the reading I have done, it looks like PB would be the
> optimal protocol for me to use.  I understand where I have decision
> making power at both ends of the line, I can modify the Firewalls
> settings to accommodate the port(s).
>
> But I know I will have situations where the client side will be
> behind a firewall where I do manage the decision making process.

If it's the client side it shouldn't have a problem connecting out to 
the Internet.

Or perhaps the firewall only allows certain outbound ports? If a user is 
running such a firewall setup they pretty much need to be able to allow 
more ports as needed.

>One
> of the reasons why XML-RPC and SOAP are broadly popular choices is
> that they are over HTTP.

They're the same as far as crossing firewalls is concerned.

>
> Given the above situation about Firewall settings where I have no
> control, is my assumption correct that the PB protocol is not an
> option for me.

No, probably not, but I don't think I understand your problem.

>
> Thanks in advance for your help.
>
> Patrick
>
> _______________________________________________
> Join Excite! - http://www.excite.com
> The most personalized portal on the Web!
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python







From pyp at gmx.net  Thu Jan  8 23:16:12 2004
From: pyp at gmx.net (Mike Mueller)
Date: Fri, 09 Jan 2004 05:16:12 +0100
Subject: [Twisted-Python] how to get form values in woven?
Message-ID: <5.2.1.1.1.20040109045850.022e2590@pop.gmx.net>

I am just starting with woven. I couldn't find a simple example how to get 
the values from a submitted form. Reading the HOWTOs and searching the 
twisted mail archives as well as web didn't bring up what I was searching for.

An example:

from twisted.application import service, internet
from twisted.web.woven import page
from twisted.web import server, resource

class FirstPage(page.Page):
     template = """<html>
         <head>
         <title>First Form</title>
         </head>
         <body>
           <h3>First Form</h3>
           <form action="processMyForm" method="post">
           <p>
           Text1:
           <input type="text" id="Text1"/><br/>
           Text2:
           <input type="text" id="Text2"/><br/>
           <input type="submit" value="Send"/>
           </p>
           </form>
         </body>
       </html>
     """
     def initialize(self, *args, **kwargs):
         self.numberOfProcessCalls = 0
     def wchild_processMyForm(self, request):
         self.numberOfProcessCalls += 1
         keysValues = []
         for k, v in request.__dict__.items():
             keysValues.append('%s:\t %s' %(k,v))
         model = {'keys-values': keysValues,
                  'number':self.numberOfProcessCalls}
         return page.Page(model, template=
                          """<html>
                              <body>
                              Number of calls:
                              <p model="number" view="Text" />
                              <h3>arg keys: values</h3>
                              <div model="keys-values" view="List">
                                 <p pattern="listItem" view="Text" />
                              </div>
                              </body>
                              </html>""")

p = FirstPage()
application = service.Application('SimpleForm')
internet.TCPServer(8088, 
server.Site(resource.IResource(p))).setServiceParent(service.IServiceCollection(application))

There are several problems with this.

1.) wchild_processMyForm gets called twice every time the submit button is hit
2.) for the first call the method is post for, the second it is get
3.) arg is always {}, so nothing to process

Obviously, I am doing something wrong. Basically I just want to echo back 
the name/values pairs that where entered into the form. How do I do this 
with woven?

Thanks

Mike 




From itamar at itamarst.org  Thu Jan  8 23:52:12 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 08 Jan 2004 23:52:12 -0500
Subject: [Twisted-Python] Newbie Question about PB and Firewalls
In-Reply-To: <20040108231407.B4D25109EB9@xprdmailfe1.nwk.excite.com>
References: <20040108231407.B4D25109EB9@xprdmailfe1.nwk.excite.com>
Message-ID: <1073623932.6872.17.camel@sheriffpony>

On Thu, 2004-01-08 at 18:14, Patrick Gilmartin wrote:

> Given the above situation about Firewall settings where I have no control, is my assumption correct that the PB protocol is not an option for me.

Yes, however -

Breaking past firewalls is actually pretty easy, assuming they allow
HTTPS access to outside world. What you do is, run server on port 443,
then connect to HTTP proxy, send:

   CONNECT http://yourhost.com:443/

or the appropriate syntax for the CONNECT command, and the connection
will now be opened for 443. At this point you switch to your protocol of
choice and can do whatever you want over this connection.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From reapnow at excite.com  Fri Jan  9 00:04:59 2004
From: reapnow at excite.com (Patrick Gilmartin)
Date: Fri,  9 Jan 2004 00:04:59 -0500 (EST)
Subject: [Twisted-Python] Re: Newbie Question about PB and Firewalls
Message-ID: <20040109050459.762981E43B@xprdmailfe25.nwk.excite.com>

Thanks for quick your response.  I finally realize the errors in my logic regarding client side firewall settings.

I look forward to becoming proficient with Twisted and incorporating it into overall IT infrastructure.

Thanks again,

Patrick   




 --- On Thu 01/08, Eric <input class="txtDsp" type="text" size="8" name="word2" value=  "<input" class="txtDsp" type="text" size="8" name="word3" value="-net.net"  wrote:
From: Eric python at twistedmatrix.com
Date: Thu, 8 Jan 2004 20:05:59 -0700
Subject: [Twisted-Python] Re: Newbie Question about PB and Firewalls

On Thursday 08 January 2004 04:14 pm, Patrick Gilmartin wrote:<br> I have been reviewing Twisted site and documentation fairly extensive<br> for the past couple of months.<br><br> I have just downloaded it to start working with it, but before I get<br> started there are some answers I seek that will really help in my<br> overall plans.<br><br> From all the reading I have done, it looks like PB would be the<br> optimal protocol for me to use.  I understand where I have decision<br> making power at both ends of the line, I can modify the Firewalls<br> settings to accommodate the port(s).<br><br> But I know I will have situations where the client side will be<br> behind a firewall where I do manage the decision making process.<br><br>If it's the client side it shouldn't have a problem connecting out to <br>the Internet.<br><br>Or perhaps the firewall only allows certain outbound ports? If a user is <br>running such a firewall setup they pretty much need to be able to allow <br>more ports as needed.<br><br>One<br> of the reasons why XML-RPC and SOAP are broadly popular choices is<br> that they are over HTTP.<br><br>They're the same as far as crossing firewalls is concerned.<br><br><br> Given the above situation about Firewall settings where I have no<br> control, is my assumption correct that the PB protocol is not an<br> option for me.<br><br>No, probably not, but I don't think I understand your problem.<br><br><br> Thanks in advance for your help.<br><br> Patrick<br><br> _______________________________________________<br> Join Excite! - <input class="txtDsp" type="text" size="8" name="word9" value="://www.excite.com<br"> The most personalized portal on the Web!<br><br> _______________________________________________<br> Twisted-Python mailing list<br> Twisted-<input class="txtDsp" type="text" size="8" name="word12" value=".com<br"> <input class="txtDsp" type="text" size="8" name="word14" value="-<input" class="txtDsp" type="text" size="8" name="word15" value="-python<br"><br><br><br><br><br>_______________________________________________<br>Twisted-Python mailing list<br>Twisted-http://twistedmatrix.

_______________________________________________
Join Excite! - http://www.excite.com
The most personalized portal on the Web!



From pyp at gmx.net  Fri Jan  9 07:38:00 2004
From: pyp at gmx.net (Mike Mueller)
Date: Fri, 09 Jan 2004 13:38:00 +0100
Subject: [Twisted-Python] how to get form values in woven?
In-Reply-To: <5.2.1.1.1.20040109045850.022e2590@pop.gmx.net>
Message-ID: <5.2.1.1.1.20040109133407.021bdc80@pop.gmx.net>


At 05:16 09.01.2004 +0100, I wrote:
>....
>
>There are several problems with this.
>
>1.) wchild_processMyForm gets called twice every time the submit button is hit
>2.) for the first call the method is post for, the second it is get
>3.) arg is always {}, so nothing to process
>
>Obviously, I am doing something wrong. Basically I just want to echo back 
>the name/values pairs that where entered into the form. How do I do this 
>with woven?


I took me while but I found the problems:

1.) <form action="processMyForm" method="post"> must be <form 
action="processMyForm/" method="post">
and
2.)  <input type="text" id="Text1"/> must be <input type="text" name="Text1"/>

The working script looks like this:

from twisted.application import service, internet
from twisted.web.woven import page
from twisted.web import server, resource


class FirstPage(page.Page):
     template = """<html>
         <head>
         <title>First Form</title>
         </head>
         <body>
           <h3>First Form</h3>
           <form action="processMyForm/" method="post">
           <p>
           Text1:
           <input type="text" name="Text1"/><br/>
           Text2:
           <input type="text" name="Text2"/><br/>
           <input type="submit" value="Send"/>
           </p>
           </form>
         </body>
       </html>
     """
     def initialize(self, *args, **kwargs):
         self.numberOfProcessCalls = 0
     def wchild_processMyForm(self, request):
         self.numberOfProcessCalls += 1
         keysValues = []
         for k, v in request.__dict__.items():
             keysValues.append('%s:\t %s' %(k,v))
         model = {'keys-values': keysValues,
                  'number':self.numberOfProcessCalls}
         return page.Page(model, template=
                          """<html>
                              <body>
                              Number of calls:
                              <p model="number" view="Text" />
                              <h3>arg keys: values</h3>
                              <div model="keys-values" view="List">
                                 <p pattern="listItem" view="Text" />
                              </div>
                              </body>
                              </html>""")


p = FirstPage()
application = service.Application('SimpleForm')
internet.TCPServer(8088, 
server.Site(resource.IResource(p))).setServiceParent(service.IServiceCollection(application))



Mike 




From z3p at twistedmatrix.com  Fri Jan  9 10:10:14 2004
From: z3p at twistedmatrix.com (Paul Swartz)
Date: Fri, 9 Jan 2004 10:10:14 -0500
Subject: [Twisted-Python] twisted.conch.ssh.filetransfer example...
In-Reply-To: <20040108175940.36573.qmail@web21507.mail.yahoo.com>
References: <3513EC08-4116-11D8-B0D7-000A95686CD8@redivi.com> <20040108175940.36573.qmail@web21507.mail.yahoo.com>
Message-ID: <20040109151014.GA30005@pyramid.twistedmatrix.com>

On Thu, Jan 08, 2004 at 02:59:40PM -0300, Aloysio Figueiredo wrote:
> 
> I need to transfer a file via ssh.
> twisted.conch.ssh.filetransfer seems to be a way to do
> that, but it's not documented and I couldn't figure
> out how to use it. Could anyone point a short example
> (here or in the web) ?

If you want to transfer a single file, t.c.s.filetransfer is overkill.
If this is a custom application that you want to transfer the file in,
just open the connection and just send the file directly over an open
channel.

If you still want an example of how to use the filetransfer code, look
for Fred Drake's SFTP->FTP gateway.  I don't know the link off the top
of my head, but check the list archives.


-p
-- 
       Paul Swartz
(o_    http://www.twistedmatrix.com/users/z3p.twistd/  _o)
//\    z3p at twistedmatrix.com                           /\\
V_/_   AIM: z3penguin                                 _\_V->



From fdrake at acm.org  Fri Jan  9 10:42:56 2004
From: fdrake at acm.org (Fred L. Drake, Jr.)
Date: Fri, 9 Jan 2004 10:42:56 -0500
Subject: [Twisted-Python] twisted.conch.ssh.filetransfer example...
In-Reply-To: <20040109151014.GA30005@pyramid.twistedmatrix.com>
References: <3513EC08-4116-11D8-B0D7-000A95686CD8@redivi.com>
	<20040108175940.36573.qmail@web21507.mail.yahoo.com>
	<20040109151014.GA30005@pyramid.twistedmatrix.com>
Message-ID: <16382.52224.531498.179376@sftp.fdrake.net>

Paul Swartz writes:
 > If you still want an example of how to use the filetransfer code, look
 > for Fred Drake's SFTP->FTP gateway.  I don't know the link off the top
 > of my head, but check the list archives.

And what an example that is!  ;-)  There's no HTML page that describes
the project anywhere, but it's available from CVS:

    http://cvs.zope.org/Packages/SFTPGateway/

It's easy enough to select a branch tag at the bottom of the page and
then click "Download a tarball".  I just tagged beta 3 yesterday, but
the SFTP->FTP code hasn't changed for a while, only the outer layer of
the application (configuration support changes mostly).


  -Fred

-- 
Fred L. Drake, Jr.  <fdrake at acm.org>
PythonLabs at Zope Corporation



From andrew-twisted at puzzling.org  Fri Jan  9 11:20:07 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sat, 10 Jan 2004 03:20:07 +1100
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <3944330C-421E-11D8-AECA-0030656C6B9E@webcrunchers.com>
References: <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com> <20040102025208.GB11930@frobozz> <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com> <20040103032031.GA14197@frobozz> <565F1944-3FF4-11D8-AECA-0030656C6B9E@webcrunchers.com> <20040106032825.GA24218@frobozz> <3944330C-421E-11D8-AECA-0030656C6B9E@webcrunchers.com>
Message-ID: <20040109162007.GB6198@frobozz>

On Thu, Jan 08, 2004 at 01:04:18PM -0800, JD wrote:
> On Jan 5, 2004, at 7:28 PM, Andrew Bennetts wrote:
> >On Mon, Jan 05, 2004 at 06:59:26PM -0800, JD wrote:
[...]
> >>
> >>So If I can't mix my application code with a sub_class of a IRCClient,
> >>then how is the right way to do it.
> >
> >What I was trying to say is rather than subclass like this:
> >
> >    IRCClient (from twisted.protocols.irc)
> >     |
> >     \--YourIRCApp (adds WHO command, has your application logic)
> >
> >It might be a better idea to do it like this:
> >
> >    IRCClient (from twisted.protocols.irc)
> >     |
> >     \--ExtendedIRCClient (adds WHO command)
> >         |
> >         \--YourIRCApp (has your application logic)
> 
> I've already decided that....    because when I first started to use
> Twisted,  I had no clue of even the existance of ExtendedIRCClient
> because it was so cleverly mis-labeled and hidden so well in the
> examples,  I never would have found it,  had I not posted this in
> the first place.

You misunderstand me.

I wasn't referring to the AdvancedClient class in sandbox/exarkun/irc2.py,
as you seem to be thinking.  I was offering a suggestion on how to structure
*your* code that extends twisted.protocols.irc.IRCClient, if you choose to
extend it.

(The fact that AdvancedClient is an extension to IRCClient that subclasses
it as I describe above suggests that my advice is sound, but the existence
of AdvancedClient is incidental to the point I was trying to make.)

-Andrew.




From jeethur at sancharnet.in  Fri Jan  9 22:32:43 2004
From: jeethur at sancharnet.in (Jeethu Rao)
Date: Sat, 10 Jan 2004 09:02:43 +0530
Subject: [Twisted-Python] wxreactor hack
Message-ID: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo>

Hi Folks,
Attached is a hack of Itamar's wxreactor, which uses another wxTimer
to implement reactor.callLater. I even tried using the oft 
mentioned(on the wxPy list) wxCallAfter for reactor.callFromThread.
But it tends to lag behind a lot, which is very unsuitable. Hence,
the standard runUntilCurrent from SelectReactor is slightly modified and
used.

Anyways, no performance guarantees. It works for me though :)

Jeethu Rao
-------------- next part --------------
A non-text attachment was scrubbed...
Name: wxreactor.py.gz
Type: application/octet-stream
Size: 2420 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040110/02dd1568/attachment.obj 

From dave at krondo.com  Sat Jan 10 12:25:53 2004
From: dave at krondo.com (Dave Peticolas)
Date: Sat, 10 Jan 2004 09:25:53 -0800
Subject: [Twisted-Python] Re: examples/row_example.py  DBError Row
	object not in cache
In-Reply-To: <Sea1-F152WrwjvzWvTl0004c2aa@hotmail.com>
References: <Sea1-F152WrwjvzWvTl0004c2aa@hotmail.com>
Message-ID: <1073755553.9590.7.camel@oneiros>

On Thu, 2004-01-08 at 07:14, marjan cinober wrote:
> Hello
> 
> Thank you Dave for your fast reply, but it seems like I haven't managed to 
> get rid of the problem by syncing with current CVS (today). And upgrading 
> from Twisted 1.1.0 to 1.1.1 on Debian sarge - testing
> 
> Eroor message looks exactly the same
> --- <exception caught here> ---
>   File "/usr/lib/python2.3/site-packages/twisted/internet/defer.py", line 
> 308, in _runCallbacks
>     self.result = callback(self.result, *args, **kw)
>   File "./row_example.py", line 58, in onInsert
>     manager.deleteRow(newRoom).addCallback(onDelete)
>   File 
> "/usr/lib/python2.3/site-packages/twisted/enterprise/sqlreflector.py", line 
> 330, in deleteRow
>     self.removeFromCache(rowObject)
>   File "/usr/lib/python2.3/site-packages/twisted/enterprise/reflector.py", 
> line 141, in removeFromCache
>     raise DBError("Row object not in cache: %s", rowObject)
> twisted.enterprise.util.DBError: ('Row object not in cache: %s', <Room 
> #100001: newRoom1 (fred) (100,100)>)

Are you running directly out of CVS or installing it somewhere?
Is it possible you forgot to re-install after syncing? The error
message you are getting isn't in CVS anymore.

dave

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040110/956d6d9d/attachment.pgp 

From theman at eradman.com  Sat Jan 10 15:10:37 2004
From: theman at eradman.com (Eric Radman)
Date: Sat, 10 Jan 2004 20:10:37 +0000
Subject: [Twisted-Python] wxreactor hack
In-Reply-To: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo>
References: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo>
Message-ID: <1073765437.2606.4.camel@inspiration>

Hi All,

It seems that Woven escapes on all text returned by wmfactory_ methods.
Can this behavior be changed? I would like to build a model function
that returns an XML fragment, but Woven applies microdom.escape() to the
strings I return!

Eric Radman
theman at eradman.com

article.py:
----------------------------------------------------

import os
from twisted.web import microdom
from twisted.web.woven import page
from cStringIO import StringIO

class MyPage(page.Page):
?  def getXMLDocument(self, request):
?  ?  global xmldoc
?  ?  
?  ?  try:
?  ?  ?  return xmldoc
?  ?  except:
?  ?  ?  code = request.args.get("code", [None])[0]
?  ?  ?  xmlfile = open(os.path.abspath("articles/%s.xml" % code),  "r")
?  ?  ?  xmltext = xmlfile.read()
?  ?  ?  xmlfile.close()
?  ?  ?  xmldoc = microdom.parseString(xmltext)
?  ?  ?  return xmldoc

?  def wmfactory_Topic(self, request):
?  ?  return "Title"
?  
?  def wmfactory_Content(self, request):
?  ?  xmldoc = self.getXMLDocument(request)
?  ?  content = xmldoc.getElementsByTagName("content")[0]
?  ?  return content.toxml()

?  def wmfactory_Summary(self, request):
?  ?  return "Summary"





From itamar at itamarst.org  Sat Jan 10 20:22:54 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 10 Jan 2004 20:22:54 -0500
Subject: Escaping text in Woven (was Re: [Twisted-Python] wxreactor hack)
In-Reply-To: <1073765437.2606.4.camel@inspiration>
References: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo>
	 <1073765437.2606.4.camel@inspiration>
Message-ID: <1073784173.6565.102.camel@sheriffpony>

On Sat, 2004-01-10 at 15:10, Eric Radman wrote:

> It seems that Woven escapes on all text returned by wmfactory_ methods.
> Can this behavior be changed? I would like to build a model function
> that returns an XML fragment, but Woven applies microdom.escape() to the
> strings I return!

1. Return a RawText widget. (twisted.web.woven.widgets.RawText("hello!")
might work, IIRC.)

2. Woven is being replaced by nevow, sometime.

3. Please choose relevant subject for your emails.

4. twisted-web mailing list is probably better place for this question.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From itamar at itamarst.org  Sat Jan 10 20:32:43 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 10 Jan 2004 20:32:43 -0500
Subject: Escaping text in Woven (was Re: [Twisted-Python] wxreactor
	hack)
In-Reply-To: <1073784173.6565.102.camel@sheriffpony>
References: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo>
	 <1073765437.2606.4.camel@inspiration>
	 <1073784173.6565.102.camel@sheriffpony>
Message-ID: <1073784762.6871.104.camel@sheriffpony>

On Sat, 2004-01-10 at 20:22, Itamar Shtull-Trauring wrote:

> > It seems that Woven escapes on all text returned by wmfactory_ methods.
> > Can this behavior be changed? I would like to build a model function
> > that returns an XML fragment, but Woven applies microdom.escape() to the
> > strings I return!

Oh, wait, a model... Er. I'm not sure... maybe what I said works, maybe
you need custom class with view of RawWidget set for it.




From jsmith at psych.duke.edu  Sat Jan 10 21:40:14 2004
From: jsmith at psych.duke.edu (Joshua Smith)
Date: Sat, 10 Jan 2004 21:40:14 -0500
Subject: [Twisted-Python] Question about conch.ssh.forwarding
Message-ID: <4000B78E.1010903@psych.duke.edu>

I am working on creating a module for a project involving workstation 
administration and have been trying to get the ssh port forwarding in 
conch to work. Anybody have any quick and dirty examples of this? My 
goal is to be able to forward traffic to our mail server and a central 
administrative console in a secure fashion. I have had limited success 
with python controlling the command line ssh, but it is unwieldy 
compared to doing it natively in python.

-- 
Joshua H. Smith
Computer Support
The Department of Psychological & Brain Sciences
Rm 017
Jsmith at psych.duke.edu
919-660-5680 





From theman at eradman.com  Sat Jan 10 20:11:03 2004
From: theman at eradman.com (Eric Radman)
Date: Sun, 11 Jan 2004 01:11:03 +0000
Subject: [Twisted-Python] Escaping text in Woven and nevow
In-Reply-To: <1073784173.6565.102.camel@sheriffpony>
References: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo>
	 <1073765437.2606.4.camel@inspiration>
	 <1073784173.6565.102.camel@sheriffpony>
Message-ID: <1073783462.31733.11.camel@inspiration>

> 1. Return a RawText widget. (twisted.web.woven.widgets.RawText("hello!")
> might work, IIRC.)

Woven seems to be expecting a string for a return value. This is what I
get:
<twisted.web.woven.widgets.RawText instance at 0x4cd190>

> 2. Woven is being replaced by nevow, sometime.

I installed Twisted from CVS this evening and cannot find any library
named 'nevow'. Is this still on the drawing board?

> 3. Please choose relevant subject for your emails.

OK

> 4. twisted-web mailing list is probably better place for this question.

Good point. Signed up to that list.

Thanks for your help!

E. Radman




From z3p at twistedmatrix.com  Sun Jan 11 10:39:37 2004
From: z3p at twistedmatrix.com (Paul Swartz)
Date: Sun, 11 Jan 2004 10:39:37 -0500
Subject: [Twisted-Python] Question about conch.ssh.forwarding
In-Reply-To: <4000B78E.1010903@psych.duke.edu>
References: <4000B78E.1010903@psych.duke.edu>
Message-ID: <20040111153937.GA16853@pyramid.twistedmatrix.com>

On Sat, Jan 10, 2004 at 09:40:14PM -0500, Joshua Smith wrote:
> I am working on creating a module for a project involving workstation 
> administration and have been trying to get the ssh port forwarding in 
> conch to work. Anybody have any quick and dirty examples of this? My 
> goal is to be able to forward traffic to our mail server and a central 
> administrative console in a secure fashion. I have had limited success 
> with python controlling the command line ssh, but it is unwieldy 
> compared to doing it natively in python.

Once you have an SSHConnection instance:

reactor.listenTCP(localPortToListenOn,
    forwarding.SSHListenForwardingFactory(conn, (hostToConnectTo,
                                                 portToConnectTo),
                                          SSHListenClientForwardingChannel))

Then you can connect to localPortToListenOn any way you want.

-p
-- 
       Paul Swartz
(o_    http://www.twistedmatrix.com/users/z3p.twistd/  _o)
//\    z3p at twistedmatrix.com                           /\\
V_/_   AIM: z3penguin                                 _\_V->



From alan at norfolkgraphics.com  Sun Jan 11 18:37:32 2004
From: alan at norfolkgraphics.com (Alan McIntyre)
Date: Sun, 11 Jan 2004 18:37:32 -0500
Subject: [Twisted-Python] Suggested t.f.ftp patch for Windows users
Message-ID: <4001DE3C.1090600@norfolkgraphics.com>

Hi all,

I ran into a small problem with the FTP module under Windows. It imports 
pwd and grp, which are not available on Windows.

Since these modules are only used within the FTPAnonymousShell class, I 
moved the import to the methods that actually need it.  There's probably 
something more appropriate that could be done with them, but I'm not 
sure if there's a Windows analog for these modules.

I attached a patch (obtained with GNU diff, default options) just in 
case it's useful to someone else.

Thanks,
Alan
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: ftp.diff
Url: http://twistedmatrix.com/pipermail/twisted-python/attachments/20040111/acb2bb4e/attachment.txt 

From itamar at itamarst.org  Sun Jan 11 19:02:53 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 11 Jan 2004 19:02:53 -0500
Subject: [Twisted-Python] wxreactor hack
In-Reply-To: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo>
References: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo>
Message-ID: <1073865773.1251.3.camel@sheriffpony>

On Fri, 2004-01-09 at 22:32, Jeethu Rao wrote:

> Attached is a hack of Itamar's wxreactor, which uses another wxTimer
> to implement reactor.callLater. I even tried using the oft 
> mentioned(on the wxPy list) wxCallAfter for reactor.callFromThread.
> But it tends to lag behind a lot, which is very unsuitable. Hence,
> the standard runUntilCurrent from SelectReactor is slightly modified and
> used.

Please add a "diff -u" to the bug tracker (twistedmatrix.com/bugs/), and
I'll check it in when I have some time to look at it.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From alan at norfolkgraphics.com  Sun Jan 11 19:07:12 2004
From: alan at norfolkgraphics.com (Alan McIntyre)
Date: Sun, 11 Jan 2004 19:07:12 -0500
Subject: [Twisted-Python] Suggested t.f.ftp patch for Windows users
In-Reply-To: <4001DE3C.1090600@norfolkgraphics.com>
References: <4001DE3C.1090600@norfolkgraphics.com>
Message-ID: <4001E530.8000104@norfolkgraphics.com>

Ooops. :)  I see t.p.ftp has changed a bit since I last looked, so just 
please just ignore my ignorance.  I suppose I should spend some more 
time keeping up with such things. ;)

Alan McIntyre wrote:
> Hi all,
> 
> I ran into a small problem with the FTP module under Windows. It imports 
> pwd and grp, which are not available on Windows.
> 
> Since these modules are only used within the FTPAnonymousShell class, I 
> moved the import to the methods that actually need it.  There's probably 
> something more appropriate that could be done with them, but I'm not 
> sure if there's a Windows analog for these modules.
> 
> I attached a patch (obtained with GNU diff, default options) just in 
> case it's useful to someone else.
> 
> Thanks,
> Alan
> 
> 
> ------------------------------------------------------------------------
> 
> 1177,1178d1176
> < import pwd, grp
> < 
> 1243a1242,1243
> 
>>        import pwd
>>        
> 
> 1259a1260,1261
> 
>>        import pwd
>>




From jsmith at psych.duke.edu  Sun Jan 11 21:30:06 2004
From: jsmith at psych.duke.edu (Joshua Smith)
Date: Sun, 11 Jan 2004 21:30:06 -0500
Subject: [Twisted-Python] Question about conch.ssh.forwarding
In-Reply-To: <20040111153937.GA16853@pyramid.twistedmatrix.com>
References: <4000B78E.1010903@psych.duke.edu> <20040111153937.GA16853@pyramid.twistedmatrix.com>
Message-ID: <400206AE.6010109@psych.duke.edu>

Perfect. Thanks Paul, I now have fun things to play with.

Paul Swartz wrote:

>On Sat, Jan 10, 2004 at 09:40:14PM -0500, Joshua Smith wrote:
>  
>
>>I am working on creating a module for a project involving workstation 
>>administration and have been trying to get the ssh port forwarding in 
>>conch to work. Anybody have any quick and dirty examples of this? My 
>>goal is to be able to forward traffic to our mail server and a central 
>>administrative console in a secure fashion. I have had limited success 
>>with python controlling the command line ssh, but it is unwieldy 
>>compared to doing it natively in python.
>>    
>>
>
>Once you have an SSHConnection instance:
>
>reactor.listenTCP(localPortToListenOn,
>    forwarding.SSHListenForwardingFactory(conn, (hostToConnectTo,
>                                                 portToConnectTo),
>                                          SSHListenClientForwardingChannel))
>
>Then you can connect to localPortToListenOn any way you want.
>
>-p
>  
>

-- 
Joshua H. Smith
Computer Support
The Department of Psychological & Brain Sciences
Rm 017
Jsmith at psych.duke.edu
919-660-5680 





From andrew-twisted at puzzling.org  Sun Jan 11 23:49:43 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon, 12 Jan 2004 15:49:43 +1100
Subject: [Twisted-Python] Suggested t.f.ftp patch for Windows users
In-Reply-To: <4001DE3C.1090600@norfolkgraphics.com>
References: <4001DE3C.1090600@norfolkgraphics.com>
Message-ID: <20040112044938.GB2699@frobozz>

On Sun, Jan 11, 2004 at 06:37:32PM -0500, Alan McIntyre wrote:
> 
> I attached a patch (obtained with GNU diff, default options) just in 
> case it's useful to someone else.

(We prefer unified diff format, i.e. "diff -u")

-Andrew.




From alan at norfolkgraphics.com  Mon Jan 12 00:01:33 2004
From: alan at norfolkgraphics.com (Alan McIntyre)
Date: Mon, 12 Jan 2004 00:01:33 -0500
Subject: [Twisted-Python] Suggested t.f.ftp patch for Windows users
In-Reply-To: <20040112044938.GB2699@frobozz>
References: <4001DE3C.1090600@norfolkgraphics.com> <20040112044938.GB2699@frobozz>
Message-ID: <40022A2D.9040008@norfolkgraphics.com>

Thanks; I'll keep that in mind for any future patches. :)

Andrew Bennetts wrote:
> On Sun, Jan 11, 2004 at 06:37:32PM -0500, Alan McIntyre wrote:
> 
>>I attached a patch (obtained with GNU diff, default options) just in 
>>case it's useful to someone else.
> 
> 
> (We prefer unified diff format, i.e. "diff -u")
> 
> -Andrew.
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
> 




From db3l at fitlinxx.com  Mon Jan 12 12:35:35 2004
From: db3l at fitlinxx.com (David Bolen)
Date: 12 Jan 2004 12:35:35 -0500
Subject: [Twisted-Python] Simulating time for reactor
Message-ID: <uy8sdysrc.fsf@fitlinxx.com>

I was wondering if the subject of being able to override the concept
of "time" for the Twisted reactor has come up before?

In the context of testing code that depends on reactor delayed events
(e.g., such as callLater), up to this point we've been controlling the
test by having the test override the timers used in the callLater
call, and then controlling the point at which the reactor "cranks"
(via iterate) so that we can control when the timer would or wouldn't
fire with respect to other events under test.

While this works well, it does mean that we aren't testing with actual
time values in the objects under test, thus our tests aren't enforcing
a particular time value in the design.  But I don't want the tests to
have to wait for the real time values (which can be lengthy) during
their normal execution.

For our own objects that manage events based on time delays, we have
those objects centralize their access to time through a single method,
which we can override in a mock version of that object for testing -
and thus the test has explicit control on the notion of "time" when it
executes.  It seems to me that something similar might be useful as a
standard part of the reactor.

For example, if IReactorCore included a now() or time() method which
was the only way it grabbed system time, then tests could mock up a
reactor to be installed at the start of a test and just override that
one method to control time.  From looking at base.py in the Twisted
distribution for example, it only appears that a few uses of
time.time() would have to be tweaked.

Anyway, I was curious if this has come up before, and if so, how else
have people tested reactor based code that has lengthy timers involved?

-- David





From nico at tekNico.net  Mon Jan 12 14:02:24 2004
From: nico at tekNico.net (Nicola Larosa)
Date: Mon, 12 Jan 2004 20:02:24 +0100
Subject: [Twisted-Python] Re: Simulating time for reactor
In-Reply-To: <uy8sdysrc.fsf@fitlinxx.com>
References: <uy8sdysrc.fsf@fitlinxx.com>
Message-ID: <4002EF40.2030807@tekNico.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> I was wondering if the subject of being able to override the concept
> of "time" for the Twisted reactor has come up before?
> ...
> Anyway, I was curious if this has come up before, and if so, how else
> have people tested reactor based code that has lengthy timers involved?

Here's my try, and the somewhat lukewarm reaction: :^)

StepReactor?
http://twistedmatrix.com/pipermail/twisted-python/2003-July/005288.html
http://twistedmatrix.com/pipermail/twisted-python/2003-July/005289.html
http://twistedmatrix.com/pipermail/twisted-python/2003-July/005292.html
http://twistedmatrix.com/pipermail/twisted-python/2003-August/005332.html
http://twistedmatrix.com/pipermail/twisted-python/2003-August/005337.html


- --
Nicola Larosa - nico at tekNico.net

"The word "community" comes from Latin, "cum munere". "Munere" is
"to give," and "cum" is "among each other" - so, community means
"to give among each other". In short, it turns out that dollar
exchanges tend to be incompatible with a gift economy.
Complementary currencies are." -- Bernard Lietaer

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)

iD8DBQFAAu8+Xv0hgDImBm4RAsHeAKC9s0NRidDWVWvVs9UZBnAV7eFYAwCfTlTU
zHFDy3S6a4ex+LiCDfHDnRg=
=JjeC
-----END PGP SIGNATURE-----



From itamar at itamarst.org  Mon Jan 12 14:03:02 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 12 Jan 2004 14:03:02 -0500
Subject: [Twisted-Python] Simulating time for reactor
In-Reply-To: <uy8sdysrc.fsf@fitlinxx.com>
References: <uy8sdysrc.fsf@fitlinxx.com>
Message-ID: <1073934182.1252.28.camel@sheriffpony>

On Mon, 2004-01-12 at 12:35, David Bolen wrote:
> I was wondering if the subject of being able to override the concept
> of "time" for the Twisted reactor has come up before?

Sounds like good idea. Please add an issue to twistedmatrix.com/bugs/
asking for a reactor.installClock(timeFunction) and a reactor.now(). JP
already did most of the necessary work at some point so this should be
easy to add.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From itamar at itamarst.org  Mon Jan 12 14:06:00 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 12 Jan 2004 14:06:00 -0500
Subject: [Twisted-Python] Simulating time for reactor
In-Reply-To: <uy8sdysrc.fsf@fitlinxx.com>
References: <uy8sdysrc.fsf@fitlinxx.com>
Message-ID: <1073934360.1249.31.camel@sheriffpony>

On Mon, 2004-01-12 at 12:35, David Bolen wrote:

> For example, if IReactorCore included a now() or time() method which
> was the only way it grabbed system time, then tests could mock up a
> reactor to be installed at the start of a test and just override that
> one method to control time.  From looking at base.py in the Twisted
> distribution for example, it only appears that a few uses of
> time.time() would have to be tweaked.

This still wouldn't alter how long e.g. select() waits, but since that
has maximum timeouts you'd probably be fine with just changing the time
to be 30 secs in the future, yeah.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From bob at redivi.com  Mon Jan 12 14:20:30 2004
From: bob at redivi.com (Bob Ippolito)
Date: Mon, 12 Jan 2004 14:20:30 -0500
Subject: [Twisted-Python] Simulating time for reactor
In-Reply-To: <1073934182.1252.28.camel@sheriffpony>
References: <uy8sdysrc.fsf@fitlinxx.com> <1073934182.1252.28.camel@sheriffpony>
Message-ID: <62C39C55-4534-11D8-97F6-000A95686CD8@redivi.com>


On Jan 12, 2004, at 2:03 PM, Itamar Shtull-Trauring wrote:

> On Mon, 2004-01-12 at 12:35, David Bolen wrote:
>> I was wondering if the subject of being able to override the concept
>> of "time" for the Twisted reactor has come up before?
>
> Sounds like good idea. Please add an issue to twistedmatrix.com/bugs/
> asking for a reactor.installClock(timeFunction) and a reactor.now(). JP
> already did most of the necessary work at some point so this should be
> easy to add.

At some point the tests should be refactored to do reactor.run(), too.. 
  the whole reactor.iterate() thing is bogus.

-bob

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040112/e8bab96d/attachment.bin 

From pje at telecommunity.com  Mon Jan 12 14:55:09 2004
From: pje at telecommunity.com (Phillip J. Eby)
Date: Mon, 12 Jan 2004 14:55:09 -0500
Subject: [Twisted-Python] Simulating time for reactor
In-Reply-To: <1073934360.1249.31.camel@sheriffpony>
References: <uy8sdysrc.fsf@fitlinxx.com>
 <uy8sdysrc.fsf@fitlinxx.com>
Message-ID: <5.1.0.14.0.20040112145057.044f3710@mail.telecommunity.com>

At 02:06 PM 1/12/04 -0500, Itamar Shtull-Trauring wrote:
>On Mon, 2004-01-12 at 12:35, David Bolen wrote:
>
> > For example, if IReactorCore included a now() or time() method which
> > was the only way it grabbed system time, then tests could mock up a
> > reactor to be installed at the start of a test and just override that
> > one method to control time.  From looking at base.py in the Twisted
> > distribution for example, it only appears that a few uses of
> > time.time() would have to be tweaked.
>
>This still wouldn't alter how long e.g. select() waits, but since that
>has maximum timeouts you'd probably be fine with just changing the time
>to be 30 secs in the future, yeah.

For tests in PEAK that involve reactors, I use a "clock" object with 
time(), select(), and sleep() methods.  The select() and sleep() methods 
just increment the time() value by the given number of seconds.  So, for 
each test, time() starts at zero and we go from there.

One other issue to watch for: the insertion of delayed calls must be 
stable.  That is, if you add two delayed calls with the same target time, 
they must end up in the list in the order that they were added.  Otherwise, 
tests will behave oddly.  It's been a long time since I looked at Twisted's 
base reactor code, but it seems to me that the last time I did, Twisted was 
*not* using a stable insertion algorithm.  Mine uses insort_right and 
pop(0), with an object type that compares equal for equal target times.  If 
this latter constraint isn't met, it's not possible to get a stable 
insertion using the bisect module's insort functions.




From db3l at fitlinxx.com  Mon Jan 12 18:59:24 2004
From: db3l at fitlinxx.com (David Bolen)
Date: 12 Jan 2004 18:59:24 -0500
Subject: [Twisted-Python] Re: Simulating time for reactor
References: <uy8sdysrc.fsf@fitlinxx.com> <1073934182.1252.28.camel@sheriffpony> <62C39C55-4534-11D8-97F6-000A95686CD8@redivi.com>
Message-ID: <uu130zpk3.fsf@fitlinxx.com>

Bob Ippolito <bob at redivi.com> writes:

> On Jan 12, 2004, at 2:03 PM, Itamar Shtull-Trauring wrote:
> 
> > On Mon, 2004-01-12 at 12:35, David Bolen wrote:
> >> I was wondering if the subject of being able to override the concept
> >> of "time" for the Twisted reactor has come up before?
> >
> > Sounds like good idea. Please add an issue to twistedmatrix.com/bugs/
> > asking for a reactor.installClock(timeFunction) and a reactor.now(). JP
> > already did most of the necessary work at some point so this should be
> > easy to add.
> 
> At some point the tests should be refactored to do reactor.run(),
> too.. the whole reactor.iterate() thing is bogus.

I'm not sure I follow - I certainly couldn't just use reactor.run() in
my tests because while the objects under test will certainly be under
an overall reactor.run() loop in production use, during each test, I'm
only testing a small fraction of those objects behavior, and thus I
don't want to yield permanent control of execution to the reactor.

Having the ability to explicitly crank the reactor (via iterate) when
I want within my tests was, to me, a very positive point about Twisted
(when compared to threaded approaches for example), as it gave me
explicit control in my test environment where I needed it.

-- David




From radix at twistedmatrix.com  Mon Jan 12 19:04:27 2004
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 12 Jan 2004 19:04:27 -0500
Subject: [Twisted-Python] Re: Simulating time for reactor
In-Reply-To: <uu130zpk3.fsf@fitlinxx.com>
References: <uy8sdysrc.fsf@fitlinxx.com> <1073934182.1252.28.camel@sheriffpony> <62C39C55-4534-11D8-97F6-000A95686CD8@redivi.com> <uu130zpk3.fsf@fitlinxx.com>
Message-ID: <4003360B.5070700@twistedmatrix.com>

David Bolen wrote:
> Bob Ippolito <bob at redivi.com> writes:
>>At some point the tests should be refactored to do reactor.run(),
>>too.. the whole reactor.iterate() thing is bogus.
> 
> 
> I'm not sure I follow - I certainly couldn't just use reactor.run() in
> my tests because while the objects under test will certainly be under
> an overall reactor.run() loop in production use, during each test, I'm
> only testing a small fraction of those objects behavior, and thus I
> don't want to yield permanent control of execution to the reactor.

That's your incorrect assumption; you can stop reactors. 
reactor.crash(). Usually one does this from some callback within their 
test. I've written tests with both iterate() and run()/crash(); the 
latter is usually more natural to me. I don't remember enough right now 
to try to make a blanket assertion about which one is better, though 
(maybe I should write more tests again ;).

-- 
  Twisted | Christopher Armstrong: International Man of Twistery
   Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 256 bytes
Desc: OpenPGP digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040112/8ee0adbd/attachment.pgp 

From radix at twistedmatrix.com  Tue Jan 13 02:53:03 2004
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 13 Jan 2004 02:53:03 -0500
Subject: [Twisted-Python] twisted-bugs mailing list back in action
Message-ID: <4003A3DF.8030400@twistedmatrix.com>



http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-bugs

*New* issues will be sent to this list; If you want to get further 
updates on a particular issue, you'll still need to set yourself nosy on 
the particular issue. I tried making all updates go to the list, but it 
wasn't obvious how to do this in an optimal way -- a single change to an 
issue that modified two properties of it (i.e., "status" as well as 
adding a message) would generate two messages.

-- 
  Twisted | Christopher Armstrong: International Man of Twistery
   Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 256 bytes
Desc: OpenPGP digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040113/d2df1515/attachment.pgp 

From miracle at slingshot.co.nz  Tue Jan 13 03:01:28 2004
From: miracle at slingshot.co.nz (Matthew Sherborne)
Date: Tue, 13 Jan 2004 21:01:28 +1300
Subject: [Twisted-Python] testing enterprise and pb
In-Reply-To: <20040112115056.31889.84839.Mailman@twistedmatrix.com>
References: <20040112115056.31889.84839.Mailman@twistedmatrix.com>
Message-ID: <1073980888.5679.5.camel@localhost>

Hi,

This is some advice I'd like to share:

If you're testing enterprise [and pb] with twisted.trial

before running the testing suite go:

from twisted.interet import reactor
reactor.startRunning()

And if you find that the deferreds returned by dbpool.runQuery('Select
...') and dbpool.runOperation?('...') don't return, just pump
reactor.iterate() until they do...

Aparently reactor.startRunning() gets the threads going.

Thanks to radix and slyphoon for the chat room help.

Matthew Sherborne (matiu)




From nic at tymar.com  Wed Jan  7 23:52:58 2004
From: nic at tymar.com (Nic Cave-Lynch)
Date: Thu, 08 Jan 2004 17:52:58 +1300
Subject: [Twisted-Python] newbie: using serial ports in plugin
Message-ID: <3FFCE22A.5050105@tymar.com>

Hi people

I need to write an application which will receive data from a number of 
serial ports, mash it around a lot, then forward the mashed results 
across a TCP connection to another box where it's all un-mashed and spat 
out one of a number of serial ports there. All conceptually fairly 
simple, and Twisted looked like it would help enormously.

But

I can't work out how to daemonise an application which is bound to a 
serial port. The neither the gpsfix.py or the mouse.py examples seem to 
follow the required interface for being able to be turned into a 'tap'. 
I've looked at other approaches (like munging the portforward.py 
concepts -- that doesn't seem to allow the SerialPort intialisations to 
work properly) but I keep hitting dead ends (and my head against a brick 
wall)

Can anyone give me any pointers, or better still, some example code of a 
serial port protocol running as a daemon.

All help gratefully received

Nic C-L





From exarkun at intarweb.us  Sun Jan 11 13:00:01 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Sun, 11 Jan 2004 13:00:01 -0500
Subject: [Twisted-Python] wxreactor hack
In-Reply-To: <1073765437.2606.4.camel@inspiration>
References: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo> <1073765437.2606.4.camel@inspiration>
Message-ID: <20040111180001.GA8334@intarweb.us>

On Sat, Jan 10, 2004 at 08:10:37PM +0000, Eric Radman wrote:
> Hi All,
> 

  Hi.  Your mail client has decided that you are responding to a message in
a thread about wxreactor.  It probably did this because you had that message
selected when you told it to compose mail, or because you selected reply
rather than compose.  Since your message is not actually about wxreactor,
this is confusing and undesirable.  In the future, please pay more attention
to what you are asking your mail client to do, so that it is easier to find
and understand the question you are asking.

  Thanks,

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040111/f85115cc/attachment.pgp 

From exarkun at intarweb.us  Sun Jan 11 19:29:51 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Sun, 11 Jan 2004 19:29:51 -0500
Subject: [Twisted-Python] Suggested t.f.ftp patch for Windows users
In-Reply-To: <4001E530.8000104@norfolkgraphics.com>
References: <4001DE3C.1090600@norfolkgraphics.com> <4001E530.8000104@norfolkgraphics.com>
Message-ID: <20040112002951.GA9073@intarweb.us>

On Sun, Jan 11, 2004 at 07:07:12PM -0500, Alan McIntyre wrote:
> Ooops. :)  I see t.p.ftp has changed a bit since I last looked, so just 
> please just ignore my ignorance.  I suppose I should spend some more 
> time keeping up with such things. ;)

  Not at all.  I believe itamar made the change in response to your message.
So, thanks :)

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040111/e978ade7/attachment.pgp 

From db3l at fitlinxx.com  Tue Jan 13 10:42:46 2004
From: db3l at fitlinxx.com (David Bolen)
Date: 13 Jan 2004 10:42:46 -0500
Subject: [Twisted-Python] Re: Simulating time for reactor
References: <uy8sdysrc.fsf@fitlinxx.com> <1073934182.1252.28.camel@sheriffpony> <62C39C55-4534-11D8-97F6-000A95686CD8@redivi.com> <uu130zpk3.fsf@fitlinxx.com> <4003360B.5070700@twistedmatrix.com>
Message-ID: <uhdyzg8i1.fsf@fitlinxx.com>

Christopher Armstrong <radix at twistedmatrix.com> writes:

> That's your incorrect assumption; you can stop
> reactors. reactor.crash().

Well, actually I'm well aware of being able to stop reactors.  It's
just that doing so isn't a good fit for my current test scenario.

>                            Usually one does this from some callback
> within their test.

Ah, there's your incorrect assumption :-) That the reactor delayed
events that are created by the code under test end up in a callback
within the test itself.  If that were the case I might not have a
problem using reactor.run() and reactor.stop(), although I suppose I'd
still have to think about the case when the callback was incorrectly
never called - how would the test terminate in that case with a
failure?  (Guess I'd have to install an additional callLater as a
back-stop or something, which is unnecessary latency in a failure
scenario - could easily add up over a lot of tests)

>                    I've written tests with both iterate() and
> run()/crash(); the latter is usually more natural to me. I don't
> remember enough right now to try to make a blanket assertion about
> which one is better, though (maybe I should write more tests again ;).

I'm definitely not saying which is better or worse, but in the tests I
was referring to, iterate() was clearly more applicable.  I think I
could see using run()/crash() if I were testing a more protocol piece
of code, but that's not my current scenario, where it's primarily
delayed calls I want control of.

As an example, I'm testing the controller portion of an MVC setup.
Most of the tests initialize a model to some known state, assign it to
a controller, and then initiate certain events through the controller.
The controller will be part of a bigger Twisted-based system, but the
controller itself handles no network I/O, so the only part of Twisted
it's really depending on is the IReactorTime for delayed actions used
as timeouts in the controller.  The checks in the test are that the
model ends up in the right final state after the events.  I don't care
how the controller accomplishes that feat (it's internals are opaque
to users and semi-opaque to tests), just that the model ends up the
right way.

Some of the model changes are triggered by internal timeouts within
the controller, so to test that, the test adjusts the timeout value
used by the controller (hence "semi-opaque") when establishing delayed
calls so that I know the call - if the controller set it up - will
fire during the next iterate().  I can then sequence the iterate()
call along with other events to simulate various permutations of
timing of events with respect to the delayed call occurring.  To my
mind it's extremely clean and controlled given that I'm effectively
testing asynchronous events with respect to specific use cases.  That
is, except for externally overriding the timer value, which is only
needed to ensure the delayed call will trigger when I want it to (thus
my request here).

But with respect to reactor.run(), the key is that the callback for
the delayed call is internal to the controller and the test is not
interfering with that at all, nor does it have visibility to it.  I
could theoretically subclass the controller as a mock controller to
add a reactor.stop() to such a callback, but that would be much more
complexity to me than simply using iterate() when appropriate in the
test.  I think both have their place, but I definitely like the
availability of iterate() for this scenario.

-- David




From developer at csrules.dyndns.org  Tue Jan 13 11:49:08 2004
From: developer at csrules.dyndns.org (darryl)
Date: Tue, 13 Jan 2004 10:49:08 -0600
Subject: [Twisted-Python] twisted-bugs mailing list back in action
In-Reply-To: <4003A3DF.8030400@twistedmatrix.com>
References: <4003A3DF.8030400@twistedmatrix.com>
Message-ID: <40042184.10808@csrules.dyndns.org>

Christopher Armstrong wrote:
> 
> 
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-bugs
> 
> *New* issues will be sent to this list; If you want to get further 
> updates on a particular issue, you'll still need to set yourself nosy on 
> the particular issue. I tried making all updates go to the list, but it 
> wasn't obvious how to do this in an optimal way -- a single change to an 
> issue that modified two properties of it (i.e., "status" as well as 
> adding a message) would generate two messages.
> 


As far as i know you would need to make a custom reactor to replace
the default nosyreactor distributed with roundup.

-darryl



From radix at twistedmatrix.com  Tue Jan 13 18:19:20 2004
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 13 Jan 2004 18:19:20 -0500
Subject: [Twisted-Python] twisted-bugs mailing list back in action
In-Reply-To: <40042184.10808@csrules.dyndns.org>
References: <4003A3DF.8030400@twistedmatrix.com> <40042184.10808@csrules.dyndns.org>
Message-ID: <40047CF8.6070407@twistedmatrix.com>

darryl wrote:
> Christopher Armstrong wrote:
>>
>> I tried making all updates go to the list, 
>> but it wasn't obvious how to do this in an optimal way -- a single 
>> change to an issue that modified two properties of it (i.e., "status" 
>> as well as adding a message) would generate two messages.
>
> As far as i know you would need to make a custom reactor to replace
> the default nosyreactor distributed with roundup.

Well, not really replace -- e.g., the way I did this list functionality 
is by adding a new reactor that just reacts to the "create" action. So I 
could just improve that to sanely deal with the "set" action without 
being so verbose... Alternatively, I guess I could hack the nosyreactor 
reactor itself to always add a particular email address to the list of 
addresses to send to.

I'm still not sure this is desirable, though -- would people like for 
all updates to be sent to the twisted-bugs list? If so, I think I'll do 
the nosyreactor hack, it shouldn't be hard.

-- 
  Twisted | Christopher Armstrong: International Man of Twistery
   Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 256 bytes
Desc: OpenPGP digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040113/b97f9010/attachment.pgp 

From justinjohnson at fastmail.fm  Wed Jan 14 15:04:12 2004
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Wed, 14 Jan 2004 14:04:12 -0600
Subject: [Twisted-Python] Handling UnauthorizedLogin Exception with PB
Message-ID: <20040114200412.890AF44DCA@server1.messagingengine.com>

I have a PB server that uses new cred and the FileUserPasswordDB checker
for authentication.  When users attempt to login with the incorrect
username/password, a twisted.cred.error.UnauthorizedLogin exception is
raised and logged on the server.  The exception doesn't get passed back
to the client though.  On the client side I have a deferred with multiple
callbacks added and a single errback added to the end as follows:

    def mkrepexport(self, vobs, group, original_site, sites):

        [...]

        def _cbFailure(failure, site):
            self.resultsTable.failures.append(["None","None",
                Exception("Failure at site '%s'! The error is '%s'." %
                (site, str(failure)) )])
            return failure
            
        [...]

        deferreds = []
        for vob in vobs:
            for site in sites:
                ## Connect to exporting site
                d =
                self.connectToServer(config.siteToServer[original_site])
                ## Export the VOB to the site
                d.addCallback(_cbExport, vob,
                site).addErrback(_cbFailure, original_site)
                ## Connect to the importing site and import the VOB
                d.addCallback(_cbInitiateImport, vob, group,
                site).addErrback(_cbFailure, site)
                ## Add to the list of Deferreds
                deferreds.append(d)
                
        ## Stop the reactor when complete
        return defer.DeferredList(deferreds).addBoth(_cbStop)


When I attempt to login with an incorrect password, I get the following
output:



     Task: None, Step: None, Failure: Failure at site 'stby'! The error
     is '[Failure instance: Traceback from remote host -- Traceback
     unavailable]'.

Traceback from remote host -- Traceback unavailable


Is there something special I need to do to get the exception information
passed back to the client?

Thanks.
-Justin



From itamar at itamarst.org  Wed Jan 14 15:09:47 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 14 Jan 2004 15:09:47 -0500
Subject: [Twisted-Python] Handling UnauthorizedLogin Exception with PB
In-Reply-To: <20040114200412.890AF44DCA@server1.messagingengine.com>
References: <20040114200412.890AF44DCA@server1.messagingengine.com>
Message-ID: <1074110987.6502.18.camel@sheriffpony>

On Wed, 2004-01-14 at 15:04, Justin Johnson wrote:
>      Task: None, Step: None, Failure: Failure at site 'stby'! The error
>      is '[Failure instance: Traceback from remote host -- Traceback
>      unavailable]'.
> 
> Traceback from remote host -- Traceback unavailable

The info is available, I think, the traceback is not in any way relevant
anyway. I think this is mostly an issue with Failure display being
confusing.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From stenis at stenhard.net  Wed Jan 14 17:29:42 2004
From: stenis at stenhard.net (=?iso-8859-1?Q?Martin_Stenh=E5rd?=)
Date: Wed, 14 Jan 2004 23:29:42 +0100
Subject: [Twisted-Python] Adding pb users online
Message-ID: <E1AgtWh-0005HZ-00@pyramid.twistedmatrix.com>

Hi

I have the below code for my server with pb authentications. And that?s
works fine clients can login and do CallRemote. The clients can also login
as an anonymous users to add them self to users database that are stored in
a MySQL table. My question is how do I reload my users using registerChecker
with out stopping the server? So that the current online users don't lose
there connections.

c = checkers.InMemoryUsernamePasswordDatabaseDontUse()
# users comes from a SQL db
for user in users: 
        
       print "User  Password  Email Status  Disable Lastlogin"
       print user.username," ",user.password," ",user.email,"
",user.status," ",user.disable," ",
       print time.ctime(user.lastlogin)        
       c.addUser(user.username,user.password)
realm =MyRealm()
realm.server = GameServer()
p = portal.Portal(realm)    
p.registerChecker(c)
reactor.listenTCP(8800, pb.PBServerFactory(p))
reactor.run

/Martin




From itamar at itamarst.org  Wed Jan 14 17:38:53 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 14 Jan 2004 17:38:53 -0500
Subject: [Twisted-Python] Adding pb users online
In-Reply-To: <E1AgtWh-0005HZ-00@pyramid.twistedmatrix.com>
References: <E1AgtWh-0005HZ-00@pyramid.twistedmatrix.com>
Message-ID: <1074119932.6504.95.camel@sheriffpony>

On Wed, 2004-01-14 at 17:29, Martin Stenh?rd wrote:
> c = checkers.InMemoryUsernamePasswordDatabaseDontUse()
> # users comes from a SQL db
> for user in users: 
>         
>        print "User  Password  Email Status  Disable Lastlogin"
>        print user.username," ",user.password," ",user.email,"
> ",user.status," ",user.disable," ",
>        print time.ctime(user.lastlogin)        
>        c.addUser(user.username,user.password)

Don't use a checkers.InMemoryUsernamePasswordDatabaseDontUse (the name
is a hint ;). Instead write a checker that reads directly from the MySQL
database.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From michal at pasternak.w.lub.pl  Wed Jan 14 16:46:15 2004
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Wed, 14 Jan 2004 22:46:15 +0100
Subject: [Twisted-Python] Adding pb users online
In-Reply-To: <E1AgtWh-0005HZ-00@pyramid.twistedmatrix.com>
References: <E1AgtWh-0005HZ-00@pyramid.twistedmatrix.com>
Message-ID: <20040114214614.GA47991@pasternak.w.lub.pl>

Martin Stenh?rd [Wed, Jan 14, 2004 at 11:29:42PM +0100]:
> I have the below code for my server with pb authentications. And that?s
> works fine clients can login and do CallRemote. The clients can also login
> as an anonymous users to add them self to users database that are stored in
> a MySQL table. My question is how do I reload my users using registerChecker
> with out stopping the server? So that the current online users don't lose
> there connections.
> 
> c = checkers.InMemoryUsernamePasswordDatabaseDontUse()

Instead of adding them to the above checker, write your own class, that
implements ICredentialsChecker and authenticates using queries to SQL
database.

You could implement some caching at that level, so it won't be really much
slower, than InMemory checker.

You could use FilePasswordDB as an example, defined in cred.checkers.



From douglas at paradise.net.nz  Thu Jan 15 06:36:26 2004
From: douglas at paradise.net.nz (Douglas Bagnall)
Date: Fri, 16 Jan 2004 00:36:26 +1300
Subject: [Twisted-Python] mktap/twistd make 2 copies of some objects?  (was Re: [Twisted-web]
 subtle copying in woven driving me crazy.)
In-Reply-To: <3FE644C6.5070204@paradise.net.nz>
References: <3FE56235.9000801@paradise.net.nz>
 <3FE56AD0.2050705@twistedmatrix.com> <3FE644C6.5070204@paradise.net.nz>
Message-ID: <40067B3A.3050309@paradise.net.nz>

A while ago in twisted-web, in a thread beginning here:

http://twistedmatrix.com/pipermail/twisted-web/2003-December/000061.html

I was complaining about twisted making a spare copy of an object used 
for guard credentials (meaning you can't add users on the fly).  I now 
think it stems from the pickling of objects between mktap and twistd. 
The checker is instantiated and pickled in mktap, because the guard code 
is called directly from updateApplication. But then when twistd runs, it 
is instantiated again for the rest of the app.

This makes two copies of my checker:

#!/bin/sh
kill `cat twistd.pid`
mktap2.3 upstage
twistd2.3  -f upstage.tap

and this doesn't:

#!/usr/bin/python
from upstage import app
from twisted.internet import reactor
app.updateApplication(reactor, {'webport':8083,'port':7232 })
reactor.run()


The code called in updateApplication goes a bit like this:

def updateApplication(app, options):
     docroot = website()
     app.listenTCP(webport, server.Site(docroot))

def website():
     docroot = static.File(config.HTDOCS)
     admin = adminWrapper(config.ADMIN)
     docroot.putChild('admin', admin)
     return docroot

class Checker(dict):
     __implements__ = checkers.ICredentialsChecker
     credentialInterfaces = (IUsernamePassword,)
     def requestAvatarId(self, credentials):
         player = self.get(credentials.username)
         if player and player.password == credentials.password:
             return credentials.username
         return failure.Failure(error.UnauthorizedLogin())

myCheckerThatGetsCopied = Checker({'p1': player1})

def adminWrapper(admin_dir):
     p = Portal(AdminRealm(admin_dir))
     p.registerChecker(AllowAnonymousAccess(), IAnonymous)
     p.registerChecker(myCheckerThatGetsCopied, IUsernamePassword)
     upw = guard.UsernamePasswordWrapper(p, callback=dumbRedirect)
     r = guard.SessionWrapper(upw)
     r.sessionLifetime = 12 * 3600
     return r


One workaround is wrapping the true checker in one that has no data:

class CheckerThatGetsCopiedWrapper:
     __implements__ = checkers.ICredentialsChecker
     credentialInterfaces = (credentials.IUsernamePassword,)

     def requestAvatarId(self, credentials):
         return myCheckerThatGetsCopied.requestAvatarId(credentials)


which is what I'm actually using now.  Is my diagnosis plausible?

regards,

douglas bagnall





From douglas at paradise.net.nz  Thu Jan 15 06:36:33 2004
From: douglas at paradise.net.nz (Douglas Bagnall)
Date: Fri, 16 Jan 2004 00:36:33 +1300
Subject: [Twisted-Python] announcing another twisted project
Message-ID: <40067B41.10302@paradise.net.nz>

hi all,

For a few months I've been working on software for some people who do 
"cyberformance", which boils down to being theatre in chat rooms.  They 
want to be able to do everything they can in their vintage Mac apps, but 
be accessable to a general audience.  So I've almost written a graphical 
chat thingy using SWF for the front end and twisted for the server.  I 
wasn't quite ready to announce it, but the Daily Python Url has gone and 
exposed it anyway.

The theatrical paradigm makes it very slightly different from most chat 
programs - for example, you don't need to log in to watch, but as 
audience you won't appear on stage; the "avatars" are more like puppets 
- players can exchange them during the performance without the audience 
knowing.  There are also a few unusual features, like text-to-speech 
processing (using Festival), and seconds-per-frame live video, to suit 
the particular performance style of the artists.  But really it's just a 
chat program.  And it's GPL'd, so if anyone wants a chat program, it 
wouldn't be too hard to configure the strange elements away (and I'd 
really appreciate anyone using it).

The flash part is generated entirely from actionscript, using the Ming 
compiler (http://ming.sf.net/), which I found to be easier than working 
  in Macromedia Flash, not to mention altogether freer.  You still need 
the flash plugin to view it though.

Some things about it are a bit broken, and the tests are woefully out of 
date. But there you go.

http://sourceforge.net/projects/upstage/ and http://upstage.org.nz/

cheers,

douglas





From itamar at itamarst.org  Thu Jan 15 09:29:58 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 15 Jan 2004 09:29:58 -0500
Subject: [Twisted-Python] mktap/twistd make 2 copies of some objects? 
	(was Re: [Twisted-web] subtle copying in woven driving me crazy.)
In-Reply-To: <40067B3A.3050309@paradise.net.nz>
References: <3FE56235.9000801@paradise.net.nz>
	 <3FE56AD0.2050705@twistedmatrix.com> <3FE644C6.5070204@paradise.net.nz>
	 <40067B3A.3050309@paradise.net.nz>
Message-ID: <1074176998.6505.113.camel@sheriffpony>

On Thu, 2004-01-15 at 19:36, Douglas Bagnall wrote:
> which is what I'm actually using now.  Is my diagnosis plausible?

Yes - the checker on module-level is created from scratch when you start
the tap with twistd, and is different from the one you load from the
TAP.

In general, you should not store any important data (i.e. application
data) in the TAP. Implement some sort of external storage.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From ed at unidata.ucar.edu  Thu Jan 15 10:02:27 2004
From: ed at unidata.ucar.edu (Ed Hartnett)
Date: 15 Jan 2004 08:02:27 -0700
Subject: [Twisted-Python] can't get twisted to install on SunOS...
Message-ID: <wrxad4pgsqk.fsf@rodney.unidata.ucar.edu>

Howdy all!

I am using twisted as part of BuildBot, to automatically test my
software on various platforms.

One problem I am having on a couple of Suns is that twisted won't
install. I have python 2.2.3 installed as you can see from the
printout:

gilda.unidata.ucar.edu% python
Python 2.2.3 (#1, Jan 13 2004, 13:54:46) [C] on sunos5
Type "help", "copyright", "credits" or "license" for more information.
>>> 

bash-2.03# pwd
/home/ed/downloads/Twisted-1.1.1
bash-2.03# python setup.py install
Traceback (most recent call last):
  File "setup.py", line 43, in ?
    from twisted import copyright
  File "twisted/__init__.py", line 23, in ?
    from python import compat
  File "twisted/python/compat.py", line 27, in ?
    import sys, types, socket, struct, __builtin__, exceptions
  File "/usr/local/lib/python2.2/socket.py", line 41, in ?
    from _socket import *
ImportError: No module named _socket


What's the deal here? Any suggestions for getting Twisted working on
these suns?

I've had trouble before because of the weird directories that sun
uses, but this seems to be a problem within python.

Thanks for any suggestions,

Ed Hartnett
Unidata




From exarkun at intarweb.us  Thu Jan 15 10:14:16 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 15 Jan 2004 10:14:16 -0500
Subject: [Twisted-Python] can't get twisted to install on SunOS...
In-Reply-To: <wrxad4pgsqk.fsf@rodney.unidata.ucar.edu>
References: <wrxad4pgsqk.fsf@rodney.unidata.ucar.edu>
Message-ID: <20040115151416.GA22476@intarweb.us>

On Thu, Jan 15, 2004 at 08:02:27AM -0700, Ed Hartnett wrote:
> Howdy all!
> 
> I am using twisted as part of BuildBot, to automatically test my
> software on various platforms.
> 
> One problem I am having on a couple of Suns is that twisted won't
> install. I have python 2.2.3 installed as you can see from the
> printout:
> 
> gilda.unidata.ucar.edu% python
> Python 2.2.3 (#1, Jan 13 2004, 13:54:46) [C] on sunos5
> Type "help", "copyright", "credits" or "license" for more information.
> >>> 
> 
> bash-2.03# pwd
> /home/ed/downloads/Twisted-1.1.1
> bash-2.03# python setup.py install
> Traceback (most recent call last):
>   File "setup.py", line 43, in ?
>     from twisted import copyright
>   File "twisted/__init__.py", line 23, in ?
>     from python import compat
>   File "twisted/python/compat.py", line 27, in ?
>     import sys, types, socket, struct, __builtin__, exceptions
>   File "/usr/local/lib/python2.2/socket.py", line 41, in ?
>     from _socket import *
> ImportError: No module named _socket
> 
> 
> What's the deal here? Any suggestions for getting Twisted working on
> these suns?


  Does "python -c 'import socket'" raise the same exception?  I'm guessing
it does, in which case this indicates a problem with the Python install. 
Without the socket module, Twisted can't do a heck of a lot.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040115/1441654a/attachment.pgp 

From michal at pasternak.w.lub.pl  Thu Jan 15 10:04:04 2004
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Thu, 15 Jan 2004 16:04:04 +0100
Subject: [Twisted-Python] can't get twisted to install on SunOS...
In-Reply-To: <wrxad4pgsqk.fsf@rodney.unidata.ucar.edu>
References: <wrxad4pgsqk.fsf@rodney.unidata.ucar.edu>
Message-ID: <20040115150404.GA96120@pasternak.w.lub.pl>

Ed Hartnett [Thu, Jan 15, 2004 at 08:02:27AM -0700]:
>   File "/usr/local/lib/python2.2/socket.py", line 41, in ?
>     from _socket import *
> ImportError: No module named _socket

Obviously, your Python installation came without socket module (which
results from bad ./configure --options while building)

You can either try to find package for it (some distributions split Python
package, and they do it with a reason) -- or, I suggest, as usual, taking a
look http://pkgsrc.org . I havent tested Python package on SunOS, but it
seems it comes there with socked module enabled.



From slepage at drummonddesigns.com  Thu Jan 15 14:12:37 2004
From: slepage at drummonddesigns.com (Steve Lepage)
Date: Thu, 15 Jan 2004 14:12:37 -0500
Subject: [Twisted-Python] Example with textbox and html
In-Reply-To: <20040115150404.GA96120@pasternak.w.lub.pl>
Message-ID: <002301c3db9b$89dc0ee0$667ba8c0@vicky>

Hi all,

I begin to program in nevow and I can't bind a textbox with variable
when I use html file to do sql request after. If I use Textbox.tac with
Textbox.html, I don't know how have a textbox and if I use formpost.tac,
I can have textbox binded with variable but I want to work with html
file.
Can people help me, please.

Textbox.tac
import random
from twisted.application import service
from twisted.application import internet
from nevow import renderer
from nevow import appserver
class Textbox(renderer.HTMLRenderer):
    def data_textbox(self, context, data):
        return " DDI Number: "
application = service.Application("Test")
internet.TCPServer(
    8888, 
    appserver.NevowSite(Textbox(templateFile = "Textbox.html"))
#    appserver.NevowSite(Textbox())
).setServiceParent(application)


Textbox.html
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>First windows with a texbox</title>
	</head>
	<body>
		<ol nevow:data="textbox" nevow:render="string"></ol>	
	</body>
</html>


formpost.tac
from twisted.application import service
from twisted.application import internet
from nevow import appserver
from nevow import renderer
from nevow import tags
from nevow import formless
from nevow import freeform
class IMyForm(formless.TypedInterface):
    foo = formless.Integer()
class FormPage(renderer.Renderer):
    __implements__ = IMyForm, renderer.Renderer.__implements__
    foo = 5
    document = tags.html[
    tags.body[
        "Hello! Here is a form:",
        freeform.configure
    ]
]
application = service.Application("formpost")
internet.TCPServer(
    8888, 
    appserver.NevowSite(
        FormPage()
    )
).setServiceParent(application)




From fabrice.coudert at free.fr  Fri Jan 16 10:22:58 2004
From: fabrice.coudert at free.fr (Fabrice Coudert)
Date: Fri, 16 Jan 2004 16:22:58 +0100
Subject: [Twisted-Python] deferred proposed update
Message-ID: <400801D2.2020805@free.fr>

Hi,

I 'd like to add a pre-processing and post-processing callback in a 
deferred callback list. I did somthing like this :

my_defer = getADeferredForSomething()
new_defer = defer.Deferred()
new_defer.addCallback(preprocessing)
new_defer.chainDeferred(my_defer)
new_defer.addCallback(postprocessing)
my_defer = new_defer

My problem is that postprocessing doesn't receive the result of the last 
callback in my_defer, but it reveive None.
This can be explained in twisted source by that chainDeferred(d) is 
equivalent to addCallbacks(d.callback, d.errback), but this two methods 
are not really sort of callback methods for deferred coz they didn't 
return a result.

So I patched Deferred class to add "return self.result", and it works well :

Deferred_old = defer.Deferred
class Deferred_new(Deferred_old):
    def callback(self, result):
        Deferred_old.callback(self, result)
        return self.result
    def errback(self, fail=None):
        Deferred_old.errback(self, fail)
        return self.result
defer.Deferred = Deferred_new

Notes by doing this you can also get final result when firing the 
callbacks :

final_result = my_defer.callback(result)

I dunno if this patch will fail something else in twisted.

fc.









From michael.l.schneider at ugsplm.com  Mon Jan 19 16:30:33 2004
From: michael.l.schneider at ugsplm.com (Schneider, Michael)
Date: Mon, 19 Jan 2004 16:30:33 -0500
Subject: [Twisted-Python] Running twisted tap file as NT service
Message-ID: <49199579A2BB32438A7572AF3DBB2FB538D50A@uscimplm001.net.plm.eds.com>

I am tring to convert a twisted .tap file (gridnoded.tap) to a service
for windows 2000 and XP.
 
I installed the required python packages:
        - inno
        - win32 extensions
      
 
 
What I have done:
    created .tap file
    run with twistd  (checks out ok)
    
 
 
When I run tap2ntsvc --help,  I get no output (error or help message).
 
what else do I have to do to get this going?
 
Thanks for your efforts with tap2ntsvc,  
 
Mike
------------------------------------------------------------------------------
 
I've finished the initial work on tap2ntsvc.  This script does the
tedious work of creating an installer around your Twisted service.  A
quick howto:

1. Create a tap or tac file for your application, using the method you
normally use.  **Test with twistd to make sure that you can start the
app from the command line, _before_ you wrap a service around it.**

2. Acquire and install the prerequisites of tap2ntsvc.  It depends on
software outside of Twisted, specifically:
win32all @ http://starship.python.net/crew/mhammond/win32/Downloads.html
Innoconda @ http://twistedmatrix.com/~moonfallen/innoconda.html

3. Run tap2ntsvc from the command line.  (*This is not yet integrated
with the "Twisted Command Prompt" available on MSWindows with the
official Twisted installer, but it will be when the script becomes an
official part of Twisted.) Use --help to get the command line options.
To start with, all you need to provide is the name of your tap or tac file.
| python .../Twisted/sandbox/moonfallen/tap2ntsvc myapp.tac
This will build an installable package using Innoconda.

4. Install the package.  It will be in myappsvc/myapp-...-setup.exe.

5. Start the service; it will fail, but you'll find out what modules you
need to add.
| net start myapp
**It's ok if this doesn't work.**

6. Check the Application event log to find out what modules failed to
import; you will be re-running py2exe after you add the missing modules.

7. Either: (a) re-run tap2ntsvc with the -i option or (b) add your
modules to myappsvc/setup.cfg on the "includes=" line.  If you choose to
do the latter, read myappsvc/README.txt to find out how to recompile
just the parts you need.

8. Redo steps 3 through 7 until you no longer get ImportErrors in the
Application log.

9. Some applications need data files.  If you need data files in your
application, consult myappsvc/README.txt and edit myappsvc/myapp.fms.
myapp.fms uses a special command language to make adding data files as
intuitive as possible.  You can put files in c:\Program Files\myapp or
any subdirectory thereof, so make sure your application code can find
data files there.

When you're done, you should be able to 'net start myapp' successfully.
~   When you want to rebuild it in the future, just keep these files in
your version control:
~  myappsvc/do_inno_script.py
~           do_inno.py
~           setup.cfg
~           setup.py
~           myapp.fms

Caveats, bugs, TODO:
- - you must be able to start your application in py2exe.  Things most
likely to not work are finding important data files based on the value
of __file__ in some module.
- - if you install the same service multiple times without uninstalling it
in between installs, then start it, then uninstall it, it will crash on
uninstall.  Just be sure to uninstall it in between installs while
you're experimenting.
- - I want to make the module finder more foolproof, saving several of the
steps above.  This is a non-trivial problem, however.
- - Really, it needs a frontend.  And I hate Tk.  Can I put a Gtk app into
~ Twisted proper? :-)


The future:
I want to move tap2ntsvc out of sandbox and into main Twisted.  I want
people to read this email over and try it before I do so, in case there
are important concerns I need to address.  We need to give some thought
to what to do about the 2 significant dependencies.  Should this block
tap2ntsvc from being in Twisted proper?  Is there a policy for this sort
of thing?


 
----------------------------------------------------------------
Michael Schneider
Senior Software Engineering Consultant
UGS PLM Solutions - an EDS Company
 
"The Greatest Performance Improvement Is the transitioning from a non-working state to the working state"
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20040119/d2d73936/attachment.htm 

From rdrb at 123.cl  Tue Jan 27 09:22:04 2004
From: rdrb at 123.cl (=?iso-8859-1?Q?Rita_D=EDaz_y/o_Rodrigo_Benenson?=)
Date: Tue, 27 Jan 2004 11:22:04 -0300
Subject: [Twisted-Python] RPC over UDP
Message-ID: <004c01c3e4e0$f0191a10$4b30fea9@laboratorio>

Is there an UDP RPC twisted system aviable ? What happened to the UDP
support of PB ?
Khashmir has an airhook UDP RPC, but the code does not give 'quality
assurance' (at least at a psycholigical level). It is something similar
integrated in the Twisted Distro, or as an external package ?


rodrigob.




From tv at tv.debian.net  Tue Jan 20 04:30:09 2004
From: tv at tv.debian.net (Tommi Virtanen)
Date: Tue, 20 Jan 2004 11:30:09 +0200
Subject: [Twisted-Python] deferred proposed update
In-Reply-To: <400801D2.2020805@free.fr>
References: <400801D2.2020805@free.fr>
Message-ID: <400CF521.2030000@tv.debian.net>

Fabrice Coudert wrote:
> I 'd like to add a pre-processing and post-processing callback in a 
> deferred callback list. I did somthing like this :
 >
 > my_defer = getADeferredForSomething()
 > new_defer = defer.Deferred()
 > new_defer.addCallback(preprocessing)
 > new_defer.chainDeferred(my_defer)
 > new_defer.addCallback(postprocessing)
 > my_defer = new_defer

You are using Deferreds incorrectly. For example, nothing here
makes new_defer ever trigger.

You haven't stated clearly what you want to do, but I don't see
why you aren't just doing this:

d = getADeferredForSomething()
d.addCallback(preprocessing)
d.addCallback(theRealMcCoy)
d.addCallback(postprocessing)



From nopa90 at msn.com  Sun Jan 25 04:25:49 2004
From: nopa90 at msn.com (maxwell hammer)
Date: Sun, 25 Jan 2004 09:25:49 +0000
Subject: [Twisted-Python] Re: Adding pb users online
Message-ID: <BAY3-F375bd6xHCpWA00002366d@hotmail.com>

here is a mysql checker i made,
probably not the best job but you can fix it :)

from twisted.python import components, failure, log
from twisted.cred import error, credentials
from twisted.cred.checkers import ICredentialsChecker
from twisted.enterprise import adbapi

class MysqlPasswordDatabase :
    __implements__ = ICredentialsChecker

    credentialInterfaces = 
(credentials.IUsernamePassword,credentials.IUsernameHashedPassword)

    def __init__(self,db_name,db_username,db_password,table_name) :
        self.db_name=db_name
        self.db_username=db_username
        self.db_password=db_password
        self.table_name=table_name

        self.dbpool = adbapi.ConnectionPool("MySQLdb",host="localhost",
                                            db=db_name,
                                            user=db_username,
                                            passwd=db_password)
    def _dbResult(self,result,credentials) :
        #print result[0][0]
        #print credentials
        if result :
            if credentials.checkPassword(str(result[0][0])) :
                return credentials.username
            else :
                #print "Failing in password cmp"
                return failure.Failure(error.UnauthorizedLogin())
        else :
            #print "Failing in dbresult"
            return failure.Failure(error.UnauthorizedLogin())

    def _dbError(self,reason) :
        return failure.Failure(error.UnauthorizedLogin())

    def requestAvatarId(self,c) :
        print "requestAvatarID ",c
        d=self.dbpool.runQuery("SELECT pword FROM %s WHERE uname = '%s'" %
                              (self.table_name,c.username))
        d.addCallback(self._dbResult,c)
        d.addErrback(self._dbError)
        return d

anyway you get the idea, the above code works for me, but it assumes 
passwords are stored in plain text.

John Janecek

_________________________________________________________________
STOP MORE SPAM with the new MSN 8 and get 2 months FREE*   
http://join.msn.com/?page=dept/bcomm&pgmarket=en-ca&RU=http%3a%2f%2fjoin.msn.com%2f%3fpage%3dmisc%2fspecialoffers%26pgmarket%3den-ca




From michaelschneider at fuse.net  Wed Jan 28 08:13:42 2004
From: michaelschneider at fuse.net (Mike Schneider)
Date: Wed, 28 Jan 2004 8:13:42 -0500
Subject: [Twisted-Python] Beepy Twisted Library
Message-ID: <20040128131342.PAAV5308.smtp1.fuse.net@smtp.fuse.net>

After reading the emails on the list I downloaded the Beepy
Twisted BEEP library.

I read the included docs, and looked at the test cases.

I had a server and client up in less than an hour.

Thank you for your work on this package.  I am going to
spend more time prototyping today.


I like the development style:
   - simple short tests
   - test cases that serve as models for code development


FYI.  I am running Python2.3 on Windows, so I had to download
PyOpenSSL from:



This should be a very popular protocol for people developing peer-to-peer
solutions.


Thank you for your good work, Beepy is being used!!!!!!!
Mike


PS.  The test cases were very valuable.  If you have to choose between more docs and more testcases/examples.  my +1 would be for more test cases/examples




From corydodt at twistedmatrix.com  Wed Jan 28 11:11:36 2004
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Wed, 28 Jan 2004 08:11:36 -0800
Subject: [Twisted-Python] Running twisted tap file as NT service
In-Reply-To: <49199579A2BB32438A7572AF3DBB2FB538D50A@uscimplm001.net.plm.eds.com>
References: <49199579A2BB32438A7572AF3DBB2FB538D50A@uscimplm001.net.plm.eds.com>
Message-ID: <4017DF38.9080201@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Thanks for trying it out.

Can you provide more details on how you ran tap2ntsvc from the command line?
The exact command line, environment (especially PYTHONPATH), working
directory, what shell (whether cygwin or windows)...

I am able to run it by ...

Start > Run... > "cmd"
C:\winnt\system32>cd %twisted%\sandbox\moonfallen
C:\...\Twisted-HEAD\sandbox\moonfallen>python tap2ntsvc --help
<<< output here >>>

C





Schneider, Michael wrote:

| I am tring to convert a twisted .tap file (gridnoded.tap) to a service
| for windows 2000 and XP.
|
| I installed the required python packages:
|         - inno
|         - win32 extensions
|
|
|
| What I have done:
|     created .tap file
|     run with twistd  (checks out ok)
|
|
|
| When I run tap2ntsvc --help,  I get no output (error or help message).
|
| what else do I have to do to get this going?
|
| Thanks for your efforts with tap2ntsvc,
|
| Mike
| ------------------------------------------------------------------------------
|
| I've finished the initial work on tap2ntsvc.  This script does the
| tedious work of creating an installer around your Twisted service.  A
| quick howto:
|
| 1. Create a tap or tac file for your application, using the method you
| normally use.  **Test with twistd to make sure that you can start the
| app from the command line, _before_ you wrap a service around it.**
|
| 2. Acquire and install the prerequisites of tap2ntsvc.  It depends on
| software outside of Twisted, specifically:
| win32all @ http://starship.python.net/crew/mhammond/win32/Downloads.html
| Innoconda @ http://twistedmatrix.com/~moonfallen/innoconda.html
|
| 3. Run tap2ntsvc from the command line.  (*This is not yet integrated
| with the "Twisted Command Prompt" available on MSWindows with the
| official Twisted installer, but it will be when the script becomes an
| official part of Twisted.) Use --help to get the command line options.
| To start with, all you need to provide is the name of your tap or tac file.
| |/ python .../Twisted/sandbox/moonfallen/tap2ntsvc myapp.tac
| /This will build an installable package using Innoconda.
|
| 4. Install the package.  It will be in myappsvc/myapp-...-setup.exe.
|
| 5. Start the service; it will fail, but you'll find out what modules you
| need to add.
| |/ net start myapp
| /**It's ok if this doesn't work.**
|
| 6. Check the Application event log to find out what modules failed to
| import; you will be re-running py2exe after you add the missing modules.
|
| 7. Either: (a) re-run tap2ntsvc with the -i option or (b) add your
| modules to myappsvc/setup.cfg on the "includes=" line.  If you choose to
| do the latter, read myappsvc/README.txt to find out how to recompile
| just the parts you need.
|
| 8. Redo steps 3 through 7 until you no longer get ImportErrors in the
| Application log.
|
| 9. Some applications need data files.  If you need data files in your
| application, consult myappsvc/README.txt and edit myappsvc/myapp.fms.
| myapp.fms uses a special command language to make adding data files as
| intuitive as possible.  You can put files in c:\Program Files\myapp or
| any subdirectory thereof, so make sure your application code can find
| data files there.
|
| When you're done, you should be able to 'net start myapp' successfully.
| ~   When you want to rebuild it in the future, just keep these files in
| your version control:
| ~  myappsvc/do_inno_script.py
| ~           do_inno.py
| ~           setup.cfg
| ~           setup.py
| ~           myapp.fms
|
| Caveats, bugs, TODO:
| - - you must be able to start your application in py2exe.  Things most
| likely to not work are finding important data files based on the value
| of __file__ in some module.
| - - if you install the same service multiple times without uninstalling it
| in between installs, then start it, then uninstall it, it will crash on
| uninstall.  Just be sure to uninstall it in between installs while
| you're experimenting.
| - - I want to make the module finder more foolproof, saving several of the
| steps above.  This is a non-trivial problem, however.
| - - Really, it needs a frontend.  And I hate Tk.  Can I put a Gtk app into
| ~ Twisted proper? :-)
|
|
| The future:
| I want to move tap2ntsvc out of sandbox and into main Twisted.  I want
| people to read this email over and try it before I do so, in case there
| are important concerns I need to address.  We need to give some thought
| to what to do about the 2 significant dependencies.  Should this block
| tap2ntsvc from being in Twisted proper?  Is there a policy for this sort
| of thing?
|
|
| ----------------------------------------------------------------
| Michael Schneider
| Senior Software Engineering Consultant
| UGS PLM Solutions - an EDS Company
|
| "The Greatest Performance Improvement Is the transitioning from a
| non-working state to the working state"
|

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3-nr1 (Windows 2000)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQFAF9843A5SrXAiHQcRAjdzAJ9ugdK22esEoT4y7l0pone57oLY4wCfcexP
kmexXNkM3uV5iLXeWDUveI0=
=MqSP
-----END PGP SIGNATURE-----



From fabrice.coudert at free.fr  Thu Jan 29 02:41:59 2004
From: fabrice.coudert at free.fr (Fabrice Coudert)
Date: Thu, 29 Jan 2004 08:41:59 +0100
Subject: [Twisted-Python] deferred proposed update
In-Reply-To: <400CF521.2030000@tv.debian.net>
References: <400801D2.2020805@free.fr> <400CF521.2030000@tv.debian.net>
Message-ID: <4018B947.9060102@free.fr>

Tommi Virtanen a ?crit :

> Fabrice Coudert wrote:
>
>> I 'd like to add a pre-processing and post-processing callback in a 
>> deferred callback list. I did somthing like this :
>
> >
> > my_defer = getADeferredForSomething()
> > new_defer = defer.Deferred()
> > new_defer.addCallback(preprocessing)
> > new_defer.chainDeferred(my_defer)
> > new_defer.addCallback(postprocessing)
> > my_defer = new_defer
>
> You are using Deferreds incorrectly. For example, nothing here
> makes new_defer ever trigger.

It is a sample code to show inconcistency of chainDeferred, not a real
case. Add my_defer.callback(True) after the sample code if you'd like
and trace it. You should see that postprocessing() is called with None
argument, but not with the result of previous callback as it should be
with a normal behaviour of deferred callbacks (read the tutorial)

>
> You haven't stated clearly what you want to do, but I don't see
> why you aren't just doing this:
>
> d = getADeferredForSomething()
> d.addCallback(preprocessing)
> d.addCallback(theRealMcCoy)
> d.addCallback(postprocessing)
>
Same as before, it is a *sample code*.
In real case theRealMcCoy (and some more methodes) is added before I
need to add a post/preprocessing to that defer.

So, I restate the probleme with chainDeferred :
chainDeferred(d) is equivalent to addCallbacks(d.callback, d.errback),
but this two methods are not really sort of callback methods for
deferred coz they didn't return a result.

effcy.










From glyph at twistedmatrix.com  Thu Jan 29 10:09:22 2004
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 29 Jan 2004 10:09:22 -0500
Subject: [Twisted-Python] deferred proposed update
In-Reply-To: <4018B947.9060102@free.fr>
References: <400801D2.2020805@free.fr> <400CF521.2030000@tv.debian.net> <4018B947.9060102@free.fr>
Message-ID: <40192222.1030605@twistedmatrix.com>

Fabrice Coudert wrote:

> So, I restate the probleme with chainDeferred :
> chainDeferred(d) is equivalent to addCallbacks(d.callback, d.errback),
> but this two methods are not really sort of callback methods for
> deferred coz they didn't return a result.

This is not a problem, this is a specification of the way it works.  
chainDeferred is a holdover from before one could sensibly return one 
Deferred from the callback to another.  If you want to add callbacks in 
some other way, don't use chainDeferred.



From foom at fuhm.net  Thu Jan 29 15:48:31 2004
From: foom at fuhm.net (James Y Knight)
Date: Thu, 29 Jan 2004 15:48:31 -0500
Subject: [Twisted-Python] deferred proposed update
In-Reply-To: <40192222.1030605@twistedmatrix.com>
References: <400801D2.2020805@free.fr> <400CF521.2030000@tv.debian.net> <4018B947.9060102@free.fr> <40192222.1030605@twistedmatrix.com>
Message-ID: <7F67E8F1-529C-11D8-961D-000A95A50FB2@fuhm.net>

On Jan 29, 2004, at 10:09 AM, Glyph Lefkowitz wrote:

> Fabrice Coudert wrote:
>
>> So, I restate the probleme with chainDeferred :
>> chainDeferred(d) is equivalent to addCallbacks(d.callback, d.errback),
>> but this two methods are not really sort of callback methods for
>> deferred coz they didn't return a result.
>
> This is not a problem, this is a specification of the way it works.  
> chainDeferred is a holdover from before one could sensibly return one 
> Deferred from the callback to another.  If you want to add callbacks 
> in some other way, don't use chainDeferred.

So, the right way to do what he asks is...? Perhaps this?

my_defer = getADeferredForSomething()
new_defer = defer.Deferred()
new_defer.addCallback(preprocessing)
new_defer.addCallback(lambda x: return my_defer)
new_defer.addCallback(postprocessing)
my_defer = new_defer

James




From fab.coudert at free.fr  Wed Jan 28 13:22:40 2004
From: fab.coudert at free.fr (Fabrice Coudert)
Date: Wed, 28 Jan 2004 19:22:40 +0100
Subject: [Twisted-Python] deferred proposed update
In-Reply-To: <400CF521.2030000@tv.debian.net>
References: <400801D2.2020805@free.fr> <400CF521.2030000@tv.debian.net>
Message-ID: <4017FDF0.3070707@free.fr>

Tommi Virtanen a ?crit :

> Fabrice Coudert wrote:
>
>> I 'd like to add a pre-processing and post-processing callback in a 
>> deferred callback list. I did somthing like this :
>
> >
> > my_defer = getADeferredForSomething()
> > new_defer = defer.Deferred()
> > new_defer.addCallback(preprocessing)
> > new_defer.chainDeferred(my_defer)
> > new_defer.addCallback(postprocessing)
> > my_defer = new_defer
>
> You are using Deferreds incorrectly. For example, nothing here
> makes new_defer ever trigger.

It is a sample code to show inconcistency of chainDeferred, not a real 
case. Add my_defer.callback(True) after the sample code if you'd like 
and trace it. You should see that postprocessing() is called with None 
argument, but not with the result of previous callback as it should be 
with a normal behaviour of deferred callbacks (read the tutorial)

>
> You haven't stated clearly what you want to do, but I don't see
> why you aren't just doing this:
>
> d = getADeferredForSomething()
> d.addCallback(preprocessing)
> d.addCallback(theRealMcCoy)
> d.addCallback(postprocessing)
>
Same as before, it is a *sample code*.
In real case theRealMcCoy (and some more methodes) is added before I 
need to add a post/preprocessing to that defer.

So, I restate the probleme with chainDeferred : 
chainDeferred(d) is equivalent to addCallbacks(d.callback, d.errback), 
but this two methods are not really sort of callback methods for 
deferred coz they didn't return a result.

effcy.








From exarkun at intarweb.us  Thu Jan 29 23:48:18 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 29 Jan 2004 23:48:18 -0500
Subject: [Twisted-Python] deferred proposed update
In-Reply-To: <4017FDF0.3070707@free.fr>
References: <400801D2.2020805@free.fr> <400CF521.2030000@tv.debian.net> <4017FDF0.3070707@free.fr>
Message-ID: <20040130044818.GB27862@intarweb.us>

On Wed, Jan 28, 2004 at 07:22:40PM +0100, Fabrice Coudert wrote:
> Tommi Virtanen a ?crit :
> 
> >Fabrice Coudert wrote:
> >
> >>I 'd like to add a pre-processing and post-processing callback in a 
> >>deferred callback list. I did somthing like this :
> >
> >>
> >> my_defer = getADeferredForSomething()
> >> new_defer = defer.Deferred()
> >> new_defer.addCallback(preprocessing)
> >> new_defer.chainDeferred(my_defer)
> >> new_defer.addCallback(postprocessing)
> >> my_defer = new_defer
> >
> >You are using Deferreds incorrectly. For example, nothing here
> >makes new_defer ever trigger.
> 
> It is a sample code to show inconcistency of chainDeferred, not a real 
> case. Add my_defer.callback(True) after the sample code if you'd like 
> and trace it. You should see that postprocessing() is called with None 
> argument, but not with the result of previous callback as it should be 
> with a normal behaviour of deferred callbacks (read the tutorial)

  Without a use case, there's no chance of the behavior changing.  False
consistency is the hobgoblin of, etc.

> 
> >
> >You haven't stated clearly what you want to do, but I don't see
> >why you aren't just doing this:
> >
> >d = getADeferredForSomething()
> >d.addCallback(preprocessing)
> >d.addCallback(theRealMcCoy)
> >d.addCallback(postprocessing)
> >
> Same as before, it is a *sample code*.
> In real case theRealMcCoy (and some more methodes) is added before I 
> need to add a post/preprocessing to that defer.

  If the code you included in your message isn't equivalent to the code
you're using in your actual application, then it's a waste of time to
discuss it.  If it is equivalent, I don't see why you can't use the code
glyph suggested.

> 
> So, I restate the probleme with chainDeferred : 
> chainDeferred(d) is equivalent to addCallbacks(d.callback, d.errback), 
> but this two methods are not really sort of callback methods for 
> deferred coz they didn't return a result.
> 

  If it doesn't do what you want, don't use it.  For that matter, even if it
does, you can probably avoid using it.  As glyph stated, it is a hold-over
from times past.  If you can share the real use case, maybe someone can help
you reformulate it in terms of more recent APIs.

> effcy.
> 

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20040129/a45c4a07/attachment.pgp 

From michael.l.schneider at ugsplm.com  Fri Jan 30 11:23:42 2004
From: michael.l.schneider at ugsplm.com (Schneider, Michael)
Date: Fri, 30 Jan 2004 11:23:42 -0500
Subject: [Twisted-Python] Running twisted tap file as NT service
Message-ID: <49199579A2BB32438A7572AF3DBB2FB538D518@uscimplm001.net.plm.eds.com>

Thanks for the guide.

I am able to create a ntservice .exe, attached is the command that
I used, and the output.

My application is in the gridnode package, and it depends on twisted
and standard python.


Really Stupid question time. I have very little expericence with
deploying windows services.  

What do I do next to install this?
Since you leverage py2exe, does python need to be installed on the
machines (I am rolling this out to several hundred machines, and
python is not installed on those machine at this time)?



Thank you very much for your work on this tool!!!!!!!!!!!!!!

Mike
------------------- Command and Command Output

D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>python tap2ntsvc --name="gridnoded" --display_name=gridnoded --disp
lay_name="Grid Node Service" --type=pickle --include=gridnode d:\grid\gridnoded.tap



C:\Python23\Lib\site-packages\py2exe\build_exe.py:992: DeprecationWarning: Non-ASCII character '\xa9' in file C:\Python2
3\Lib\site-packages\py2exe\resources\VersionInfo.py on line 226, but no encoding declared; see http://www.python.org/pep
s/pep-0263.html for details
  from resources.VersionInfo import VS_VERSIONINFO, RT_VERSION, \
C:\Python23\Lib\site-packages\py2exe\resources\VersionInfo.py:70: FutureWarning: hex/oct constants > sys.maxint will ret
urn positive values in Python 2.4 and up
  dwSignature = 0xFEEF04BD
warning: py2exe: could not parse version number ''
  No VersionInfo will be created
warning: py2exe: *************************************************************************
warning: py2exe: * The following modules were not found:
warning: py2exe: *   Carbon.Folder
warning: py2exe: *   Carbon.Folders
warning: py2exe: *   Crypto.Cipher
warning: py2exe: *   OpenSSL
warning: py2exe: *   SOCKS
warning: py2exe: *   _ssl
warning: py2exe: *   _xmlplus
warning: py2exe: *   _xmlrpclib
warning: py2exe: *   fcntl
warning: py2exe: *   grp
warning: py2exe: *   ic
warning: py2exe: *   jarray
warning: py2exe: *   java.io.IOException
warning: py2exe: *   java.io.InterruptedIOException
warning: py2exe: *   java.net
warning: py2exe: *   readline
warning: py2exe: *   rourl2path
warning: py2exe: *   sgi
warning: py2exe: *   sgmlop
warning: py2exe: *************************************************************************
Built File dist\gridnodedsvc\gridnodedsvc.exe
Created gridnoded.fms
Inno Setup 4 Command-Line Compiler
Copyright (C) 1998-2003 Jordan Russell. All rights reserved.
Portions by Martijn Laan

Compiler engine version: Inno Setup 4.0.9

Reading [Setup] section, line 18
Reading [Setup] section, line 19
Reading [Setup] section, line 20
Reading [Setup] section, line 21
Reading [Setup] section, line 22
Reading [Setup] section, line 23
Reading file (WizardImage)
   File: C:\Python23\Lib\site-packages\inno\program\WIZMODERNIMAGE.BMP
Reading file (WizardSmallImage)
   File: C:\Python23\Lib\site-packages\inno\program\WIZMODERNSMALLIMAGE.BMP
Reading [LangOptions] and [Messages] sections
   File: C:\Python23\Lib\site-packages\inno\program\DEFAULT.ISL
   Messages in script file
Reading [Code] section
Reading [Dirs] section, line 16
Reading [Icons] section, line 25
Reading [Run] section, line 27
Reading [Run] section, line 28
Reading [UninstallRun] section, line 30
Reading [UninstallRun] section, line 31
   Reading version info: C:\Python23\Lib\site-packages\inno\program\UNINST.E32
Reading [Files] section, line 2
Reading [Files] section, line 3
Reading [Files] section, line 4
Reading [Files] section, line 5
Reading [Files] section, line 6
Reading [Files] section, line 7
Reading [Files] section, line 8
Reading [Files] section, line 9
Reading [Files] section, line 10
Reading [Files] section, line 11
Reading [Files] section, line 12
Reading [Files] section, line 13
Reading [Files] section, line 14
Creating setup files
   Compressing: C:\Python23\Lib\site-packages\inno\program\UNINST.E32   (51.9.0.0)
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\gridnoded.tap
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\gridnodedsvc.exe
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\parser.pyd
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\pyexpat.pyd
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\python23.dll
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\PyWinTypes23.dll
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\select.pyd
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\win32api.pyd
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\win32process.pyd
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\win32service.pyd
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\_socket.pyd
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\_sre.pyd
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\_winreg.pyd


Successful compile (1.402 sec). Resulting Setup program filename is:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\gridnoded-1.0-setup.exe

Output written to D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\gridnodedsvc\gridnoded-setup-1.0.exe

tap2ntsvc: 0 warnings.

D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>
 



From corydodt at twistedmatrix.com  Fri Jan 30 12:41:59 2004
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Fri, 30 Jan 2004 09:41:59 -0800
Subject: [Twisted-Python] Running twisted tap file as NT service
In-Reply-To: <49199579A2BB32438A7572AF3DBB2FB538D518@uscimplm001.net.plm.eds.com>
References: <49199579A2BB32438A7572AF3DBB2FB538D518@uscimplm001.net.plm.eds.com>
Message-ID: <401A9767.7050206@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Tap2ntsvc creates a package structured like the following:

+-----------------------------------------------+
|   inno setup installer                        |
|      +--------------------------------+       |
|      |     py2exe'd executable        |       |
|      |        +-----------------+     |       |
|      |        |  your app  code |     |       |
|      |        +-----------------+     |       |
|      |                                |       |
|      +--------------------------------+       |
|                                               |
+-----------------------------------------------+

The py2exe'd executable is dynamically linked with pythonxx.dll, which is in
your directory.  (It's just a stub attached to a zip file; the stub runs
python on the zipped modules.  You can actually open it with winzip etc.)

The output, that -setup.exe, can be run on the machine where you want the
service, and it will (by default) place the py2exe stuff and whatever data
files you added to gridnode.fms in C:\program files\gridnode.  It will also
install the service as the first operation.

If you remembered all your includes when you built, all you need is the setup
executable and you have a fully functioning service.  Start it with "net start
gridnode" from the command line or Start>Settings>ControlPanel>Services>select
gridnode and click start, or just reboot.

Be sure to check the event logs when you do; it sometimes takes several
attempts before you collect all the modules py2exe didn't find on its own.

(Incidentally, psloglist is the best way to do this from the command line:
http://www.sysinternals.com/ntw2k/freeware/psloglist.shtml.)

C




Schneider, Michael wrote:

| Thanks for the guide.
|
| I am able to create a ntservice .exe, attached is the command that
| I used, and the output.
|
| My application is in the gridnode package, and it depends on twisted
| and standard python.
|
|
| Really Stupid question time. I have very little expericence with
| deploying windows services.
|
| What do I do next to install this?
| Since you leverage py2exe, does python need to be installed on the
| machines (I am rolling this out to several hundred machines, and
| python is not installed on those machine at this time)?
|
|
|
| Thank you very much for your work on this tool!!!!!!!!!!!!!!
|
| Mike
| ------------------- Command and Command Output
|
| D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>python tap2ntsvc
- --name="gridnoded" --display_name=gridnoded --disp
| lay_name="Grid Node Service" --type=pickle --include=gridnode
d:\grid\gridnoded.tap
|
|
|
| C:\Python23\Lib\site-packages\py2exe\build_exe.py:992: DeprecationWarning:
Non-ASCII character '\xa9' in file C:\Python2
| 3\Lib\site-packages\py2exe\resources\VersionInfo.py on line 226, but no
encoding declared; see http://www.python.org/pep
| s/pep-0263.html for details
|   from resources.VersionInfo import VS_VERSIONINFO, RT_VERSION, \
| C:\Python23\Lib\site-packages\py2exe\resources\VersionInfo.py:70:
FutureWarning: hex/oct constants > sys.maxint will ret
| urn positive values in Python 2.4 and up
|   dwSignature = 0xFEEF04BD
| warning: py2exe: could not parse version number ''
|   No VersionInfo will be created
| warning: py2exe:
*************************************************************************
| warning: py2exe: * The following modules were not found:
| warning: py2exe: *   Carbon.Folder
| warning: py2exe: *   Carbon.Folders
| warning: py2exe: *   Crypto.Cipher
| warning: py2exe: *   OpenSSL
| warning: py2exe: *   SOCKS
| warning: py2exe: *   _ssl
| warning: py2exe: *   _xmlplus
| warning: py2exe: *   _xmlrpclib
| warning: py2exe: *   fcntl
| warning: py2exe: *   grp
| warning: py2exe: *   ic
| warning: py2exe: *   jarray
| warning: py2exe: *   java.io.IOException
| warning: py2exe: *   java.io.InterruptedIOException
| warning: py2exe: *   java.net
| warning: py2exe: *   readline
| warning: py2exe: *   rourl2path
| warning: py2exe: *   sgi
| warning: py2exe: *   sgmlop
| warning: py2exe:
*************************************************************************
| Built File dist\gridnodedsvc\gridnodedsvc.exe
| Created gridnoded.fms
| Inno Setup 4 Command-Line Compiler
| Copyright (C) 1998-2003 Jordan Russell. All rights reserved.
| Portions by Martijn Laan
|
| Compiler engine version: Inno Setup 4.0.9
|
| Reading [Setup] section, line 18
| Reading [Setup] section, line 19
| Reading [Setup] section, line 20
| Reading [Setup] section, line 21
| Reading [Setup] section, line 22
| Reading [Setup] section, line 23
| Reading file (WizardImage)
|    File: C:\Python23\Lib\site-packages\inno\program\WIZMODERNIMAGE.BMP
| Reading file (WizardSmallImage)
|    File: C:\Python23\Lib\site-packages\inno\program\WIZMODERNSMALLIMAGE.BMP
| Reading [LangOptions] and [Messages] sections
|    File: C:\Python23\Lib\site-packages\inno\program\DEFAULT.ISL
|    Messages in script file
| Reading [Code] section
| Reading [Dirs] section, line 16
| Reading [Icons] section, line 25
| Reading [Run] section, line 27
| Reading [Run] section, line 28
| Reading [UninstallRun] section, line 30
| Reading [UninstallRun] section, line 31
|    Reading version info: C:\Python23\Lib\site-packages\inno\program\UNINST.E32
| Reading [Files] section, line 2
| Reading [Files] section, line 3
| Reading [Files] section, line 4
| Reading [Files] section, line 5
| Reading [Files] section, line 6
| Reading [Files] section, line 7
| Reading [Files] section, line 8
| Reading [Files] section, line 9
| Reading [Files] section, line 10
| Reading [Files] section, line 11
| Reading [Files] section, line 12
| Reading [Files] section, line 13
| Reading [Files] section, line 14
| Creating setup files
|    Compressing: C:\Python23\Lib\site-packages\inno\program\UNINST.E32
(51.9.0.0)
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\gridnoded.tap
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\gridnodedsvc.exe
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\parser.pyd
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\pyexpat.pyd
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\python23.dll
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\PyWinTypes23.dll
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\select.pyd
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\win32api.pyd
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\win32process.pyd
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\win32service.pyd
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\_socket.pyd
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\_sre.pyd
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\_winreg.pyd
|
|
| Successful compile (1.402 sec). Resulting Setup program filename is:
|
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\gridnoded-1.0-setup.exe
|
| Output written to
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\gridnodedsvc\gridnoded-setup-1.0.exe
|
| tap2ntsvc: 0 warnings.
|
| D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>
| D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>
| D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>
| D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>
|
|
| _______________________________________________
| Twisted-Python mailing list
| Twisted-Python at twistedmatrix.com
| http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3-nr1 (Windows 2000)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQFAGpdn3A5SrXAiHQcRAhuSAJ9JS/gkYInzBsZN0I8+BA036pjUVQCfUV7t
p+PZrwMiupJXt2sd2xZgl8s=
=hzVT
-----END PGP SIGNATURE-----



From glyph at twistedmatrix.com  Fri Jan  2 17:30:25 2004
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Fri, 2 Jan 2004 18:30:25 -0600
Subject: [Twisted-Python] Technical Difficulties
Message-ID: <05D48B3E-3D84-11D8-8F96-000393C9700E@twistedmatrix.com>

Twistedmatrix.com is about to experience some significant technical 
difficulties.  As I am moving to Boston and the domain is hosted on my 
personal DSL, it will have nowhere to be for a little while.

Sometime after midnight CST tonight, I will be taking the machine down 
for a full backup in case there are problems in transit.  After that, I 
will be removing the hard drive and putting it in a box to mail 
somewhere in Maryland.  If it gets there, it will not be my fault if 
service is resumed within the week.

If and when service _is_ resumed, we all owe a very big thank you to 
Divmod, who is graciously offering to host the machine in more-or-less 
its current form.

Just to be clear: this means that the website, email, buildbot, CVS, 
wiki, and DNS services will _all_ be down.  If you have a personal 
webserver on pyramid it will also be down.  I have already redirected 
our primary DNS so that the rest of the system administration team 
should be able to make sure that we do not lose email.

I am sorry if this is the first notification you have recieved of this 
impending shutdown, but things have been fairly hectic over here.

Thank you.




From lists at webcrunchers.com  Thu Jan  1 00:22:36 2004
From: lists at webcrunchers.com (JD)
Date: Wed, 31 Dec 2003 23:22:36 -0800
Subject: [Twisted-Python] Re: IRC Client examples...  PLEASE HELP
In-Reply-To: <3FF39441.7020600@csrules.dyndns.org>
References: <3FF120BE.3010504@paradise.net.nz> <14E99DCD-3B3E-11D8-BB69-0030656C6B9E@webcrunchers.com> <200312311211.31399.teratorn@world-net.net> <20031231205249.GA25692@intarweb.us> <072928DC-3BEA-11D8-ADCB-0030656C6B9E@webcrunchers.com> <3FF39441.7020600@csrules.dyndns.org>
Message-ID: <45EA9A45-3C2B-11D8-ADCB-0030656C6B9E@webcrunchers.com>

On Dec 31, 2003, at 7:30 PM, darryl wrote:

> This means he coded support for ident and added that to cvs 
> (twisted.protocols.ident).
> Client and server.  No he did not code IRC client examples if that's 
> what your
> asking ?

Why can't anyone post just a teeny little bit of information on how to 
tie all this
together?

One of my main problems is where to put my code.   Do I put it in the 
factory class,
or do I put it in the Client class?   One always points to the other.   
I suppose it don't really matter,
but I'm sure the author(s) of twisted have their OWN ideas of where to 
put their specific code,
but they sure don't seem to have been very sucessful in conveying this 
info to others.

I know it's mostly due to my lack of knowledge,  but the only part 
that's really well documented
is the Twisted Web section.

Anyway,   if anyone has any suggestions or tips on what goes where,   
please post it here.
Inquiring minds want to know,  and I'm not the only one who wants to 
know.

John





From glyph at twistedmatrix.com  Thu Jan  1 08:47:37 2004
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 1 Jan 2004 10:47:37 -0500
Subject: [Twisted-Python] Re: IRC Client examples...  PLEASE HELP
In-Reply-To: <45EA9A45-3C2B-11D8-ADCB-0030656C6B9E@webcrunchers.com>
References: <3FF120BE.3010504@paradise.net.nz> <14E99DCD-3B3E-11D8-BB69-0030656C6B9E@webcrunchers.com> <200312311211.31399.teratorn@world-net.net> <20031231205249.GA25692@intarweb.us> <072928DC-3BEA-11D8-ADCB-0030656C6B9E@webcrunchers.com> <3FF39441.7020600@csrules.dyndns.org> <45EA9A45-3C2B-11D8-ADCB-0030656C6B9E@webcrunchers.com>
Message-ID: <D2C287ED-3C71-11D8-9071-000393C9700E@twistedmatrix.com>


On Jan 1, 2004, at 2:22 AM, JD wrote:

> One of my main problems is where to put my code.   Do I put it in the 
> factory class,
> or do I put it in the Client class?   One always points to the other.  
>  I suppose it don't really matter,
> but I'm sure the author(s) of twisted have their OWN ideas of where to 
> put their specific code,
> but they sure don't seem to have been very sucessful in conveying this 
> info to others.

It depends.

The general pattern for Twisted code is to separate protocol logic from 
application logic.  Your protocol subclass should translate from 
protocol-level events (IRCClient.signedOn, in this case) to 
application-level events (like a hypothetical 
'jd.ChatterRobot.nowOnIRCAs(nick)' method).  As for division between 
"protocol" and "factory" - try to make it so that your factory class 
can support multiple connected clients at once.  It should be small.  
Any logic associated with a particular connection should go in the 
protocol class, and any logic associated with all connections 
simultaneously must at least be referenced from the factory class.  
Generally it's a bad idea to put that logic actually into the protocol 
class because that establishes a hard dependency between network code 
and application logic which makes your application logic harder to 
write test cases for.

This pattern breaks down by necessity when dealing with very 
network-heavy code, or abstractions over things that have to logically 
understand IP addresses and the like.   However, try to follow the 
general rule as much as possible even in this kind of code.

The reason that nobody has suggested a particular answer to your 
problem is that the best approach involves keeping your code in an 
organization that best fits your problem domain, and is not dictated by 
Twisted.  As long as the network events make it from the reactor to 
your python objects, there are few constraints as to how to organize 
those objects, and most of those have to do with starting up and 
shutting down cleanly in the context of bin/twistd.

> I know it's mostly due to my lack of knowledge,  but the only part 
> that's really well documented
> is the Twisted Web section.

I know our docs aren't the best, but I think that these cover the 
relevant organization issues:

	http://www.twistedmatrix.com/documents/howto/servers
	http://www.twistedmatrix.com/documents/howto/clients

and they have nothing to do with Twisted Web.

If you disagree, and there is really a particular documentation 
problem, open a doc bug in the tracker 
(http://www.twistedmatrix.com/bugs) and assign it to "hypatia".
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 186 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20040101/b65ac0eb/attachment.sig>

From lists at webcrunchers.com  Thu Jan  1 12:25:37 2004
From: lists at webcrunchers.com (JD)
Date: Thu, 1 Jan 2004 11:25:37 -0800
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <200312312043.15657.teratorn@world-net.net>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net>
Message-ID: <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com>

On Dec 31, 2003, at 7:43 PM, Eric Mangold wrote:

> On Wednesday 31 December 2003 04:58 pm, JD wrote:
>> Hi,
>>
>> I'm open for suggestions on where I can put my customized code.    I
>> seem to have a choice
>> between putting it in the "factory" or in the "protocol",  and I
>> cannot seem to decide where the
>> best place would be.
>
> Since this is IRC you shouldn't go issuing commands until your signed
> on, thus the signedOn method of your protocol would be the right place.

Ok,   good point....   but how do I issue commands?   let's say I have
a IRCClient class called "testIRC".

do I use:    testIRC.sendLine('signedOn')  to send the command to the 
IRC server
to signon?

or do I:   testIRC.register('mynick', 'myhost', 'irc.debian.com')

then,   when I want to do the "who" command,  would I do:   
testIRC.sendLine('who')

then,   i would expect to call me back,   so I would override the 
"action" method,
like so:

def action(self, user, channel, msg):
	< extract the info I want from msg and store it somewhere,  probably 
in an instance variable in testIRC object >
          reactor.stop()    ---  to exit the client and disconnect,   or 
would I have to put the reactor.stop() in the
          factory's "clientConnectionFailed" method,  which I would 
override of course.

It's things like this that throw me totally for a loop.   Where to put 
things....  what gets the call back...

> Yeah, it's not obvious how to do that. I'll send another mail when I've
> a chance to test something, but New Years is coming up right now... :)

Yea - and while everyone is partying,   i take this wonderful 
opportunity to get some serious coding
done,  because the place is so quiet,  and I'm too broke to do anything 
anyway.

> No. An ACTION in IRC terms is a user doing an /me.

Ok,  if "action" isn't the callback which I override to get the output 
of the who command,
then what is?

myInfo?   luserClient?

luserChannels - Called with the number of channels existant on the 
server (ALMOST what I want)
luserOp - Called with the number of ops logged on to the server 
(GETTING CLOSER - NOT QUITE)
luserMe - Called with information about the server connected to. 
(CLOSEST YET - but no IP address info)

Ok,   so how do these get called?   As far as I can tell,    
"handleCommand" calls

method = getattr(self, "irc_%s" % command, None)

which it then somehow then calls back to:

     def irc_RPL_LUSERME(self, prefix, params):
         self.luserMe(params[1])

I really want:   RPL_WHOISSERVER,  but (sigh) it's not there.   Nobody 
bothered to finish this
module.

Could I add this to my IRCClient's subclass?

IE:

     def irc_RPL_WHOISSERVER(self, prefix, params):
         self.whois(params[1])

Then....

    def whois(self, prefix,  info):
	< then in this code,  get the info?  - then after that do the 
reactor.stop() so I can fall out of the reactor.run()
             call. >

Is this all I have to do....   but then would 'getattr' as you see 
above,   know how to get the method name?
Or would I have to add this somehow to another dictionary?

If so,  how do I do it?   and if i have to do it,  how do I find the 
reference to the dictionary?

Anyway,   other then being totally confused,   is there any hope?   I 
think I'm just missing a few
critical steps.    Or do I have them all?


>> There are a number of other callbacks for the private messages and
>> such.   Which one
>> do I use?   When testing the code,  I'm not getting any callbacks to
>> the "action()" method.
>> Is this because something else is fucked up.
>
> Yeah, your code.

No shit sherlock....  now i got to figure out why it's not calling my 
"whois" method.

John




From andrew-twisted at puzzling.org  Thu Jan  1 19:52:08 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 2 Jan 2004 13:52:08 +1100
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com>
Message-ID: <20040102025208.GB11930@frobozz>

On Thu, Jan 01, 2004 at 11:25:37AM -0800, JD wrote:
> On Dec 31, 2003, at 7:43 PM, Eric Mangold wrote:
> >
> >Since this is IRC you shouldn't go issuing commands until your signed
> >on, thus the signedOn method of your protocol would be the right place.
> 
> Ok,   good point....   but how do I issue commands?   let's say I have
> a IRCClient class called "testIRC".
> 
> do I use:    testIRC.sendLine('signedOn')  to send the command to the 
> IRC server
> to signon?

No.  IRCClient is a LineReceiver subclass, because that's how the low-level
protocol works.  However, you're not using the low-level protocol, you're
using an abstraction on top of it -- IRCClient.  Don't break the abstraction
(by calling LineReceiver's sendLine method) unless you have a good reason to
and you know the protocol spec well enough to know what you're doing (which
would be RFC 2812 in this case, I think).

As far as I'm aware, sending a line saying 'signedOn' to the server doesn't
make any sense in the IRC protocol, so this definitely wouldn't achieve
anything useful, except causing an error from the server that the IRCClient
instance probably won't expect (because you broke the abstraction and snuck
behind its back to do it).

> or do I:   testIRC.register('mynick', 'myhost', 'irc.debian.com')

That looks much saner.  And noticeably more full of information than
testIRC.sendLine('signedOn')...

> then,   when I want to do the "who" command,  would I do:   
> testIRC.sendLine('who')

Well, I believe the WHO command requires an argument, so it would be more
like testIRC.sendLine('WHO ' + name)... but see my next answer.

> then,   i would expect to call me back,   so I would override the 
> "action" method,
> like so:
> 
> def action(self, user, channel, msg):
> 	< extract the info I want from msg and store it somewhere,  probably 
> in an instance variable in testIRC object >
>          reactor.stop()    ---  to exit the client and disconnect,   or 
> would I have to put the reactor.stop() in the
>          factory's "clientConnectionFailed" method,  which I would 
> override of course.

That's not what the action method is for.  As the docstring for action says:
"Called when I see a user perform an ACTION on a channel."  An ACTION is a
specific thing in IRC, not a catch-all for every type of message from
server to client.  See the RFC if you're not familar with the terms.

The right way to do this is implemented in sandbox/exarkun/irc2.py -- see
the AdvancedClient.who method.  I'd follow JP's earlier suggestion and use
it.

> It's things like this that throw me totally for a loop.   Where to put 
> things....  what gets the call back...

It depends on the protocol implementation.  There's no single generic answer
for the whole of Twisted.

> >No. An ACTION in IRC terms is a user doing an /me.
> 
> Ok,  if "action" isn't the callback which I override to get the output 
> of the who command,
> then what is?
> 
> myInfo?   luserClient?
> 
> luserChannels - Called with the number of channels existant on the 
> server (ALMOST what I want)
> luserOp - Called with the number of ops logged on to the server 
> (GETTING CLOSER - NOT QUITE)
> luserMe - Called with information about the server connected to. 
> (CLOSEST YET - but no IP address info)

The answer is of course none of those.  You should've already noticed that
IRCClient doesn't implement a who() method, so it's hardly surprising it
hasn't implemented a command to deal with its response.  irc2.py does,
though (and uses Deferreds for dealing with the response, which is cleaner
anyway).

> Ok,   so how do these get called?   As far as I can tell,    
> "handleCommand" calls
> 
> method = getattr(self, "irc_%s" % command, None)
> 
> which it then somehow then calls back to:
> 
>     def irc_RPL_LUSERME(self, prefix, params):
>         self.luserMe(params[1])
> 
> I really want:   RPL_WHOISSERVER,  but (sigh) it's not there.   Nobody 
> bothered to finish this
> module.

I thought you wanted to use the WHO command not WHOIS?  Please try to be
precise.

Anyway, irc2.py also implements WHOIS.

> Could I add this to my IRCClient's subclass?
> 
> IE:
> 
>     def irc_RPL_WHOISSERVER(self, prefix, params):
>         self.whois(params[1])

If you look at irc2.py, you'll see it does override this method.  Note that
'whois' is a bad name for the response handler -- the existing convention in
IRCClient is that 'join', 'nick', etc, are the methods that *issue* the
command, not that handle the response.

> Is this all I have to do....   but then would 'getattr' as you see 
> above,   know how to get the method name?
> Or would I have to add this somehow to another dictionary?

Yes, it would.  Please see the docs for getattr in the Python standard
library reference.

> Anyway,   other then being totally confused,   is there any hope?   I 
> think I'm just missing a few
> critical steps.    Or do I have them all?

No idea.  You tell me :)

I think the biggest critical step you're missing is that you're busily
trying to reinvent a wheel that's already been made in
sandbox/exarkun/irc2.py, though.

-Andrew.




From robert.penz at outertech.com  Fri Jan  2 03:42:37 2004
From: robert.penz at outertech.com (Robert Penz)
Date: Fri, 2 Jan 2004 11:42:37 +0100
Subject: [Twisted-Python] twisted in chroot
Message-ID: <200401021142.50777.robert.penz@outertech.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi!

I've a more complicated problem this time. I've written a client which calles 
reactor.connectTCP("localhost", 8789, factory) and I've "compiled" it with 
Installer5 (http://www.mcmillan-inc.com/install1.html) all works if I just 
run it, but if I run it in a chroot I'll get following error message: 

File "/projects/buildbabla/out1.pyz/twisted.internet.default", line 281, in 
connectTCP
AttributeError: 'module' object has no attribute 'Connector'

and I've no clue why.  

Calling any of my non-twisted programs in a chroot, "compiled" with Installer, 
works without any problem.

- -- 
Regards,
Robert
- ----------
Robert Penz
robert dot penz at outertech dot com
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2-rc1-SuSE (GNU/Linux)

iD8DBQE/9Usq8tTsQqJDUBMRAsjQAJwPyiJ/yftTpxdkAWCQHS40u5elsQCfVbTD
j5RKzbkVbsT7vJZepk8F7vI=
=MA/8
-----END PGP SIGNATURE-----




From syver at inout.no  Fri Jan  2 04:55:12 2004
From: syver at inout.no (Syver Enstad)
Date: 02 Jan 2004 12:55:12 +0100
Subject: [Twisted-Python] automating startup of twistd application.
Message-ID: <u4qve4lb3.fsf@inout.no>

I have a twistd daemon that runs a custom application (.tap). When
starting up the daemon I have to enter the root password and a
passphrase for SSL interactively from the console (the app runs a
twisted web server for HTTP and HTTPS).

Because I want to do some automatic maintenace tasks I need to be able
to start and stop the daemon from a script. Unfortunately I have
little knowledge of Linux and the twistd daemon/application and need
some input on how to attack this problem.





From exarkun at intarweb.us  Fri Jan  2 11:52:48 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Fri, 2 Jan 2004 13:52:48 -0500
Subject: [Twisted-Python] automating startup of twistd application.
In-Reply-To: <u4qve4lb3.fsf@inout.no>
References: <u4qve4lb3.fsf@inout.no>
Message-ID: <20040102185248.GA30148@intarweb.us>

On Fri, Jan 02, 2004 at 12:55:12PM +0100, Syver Enstad wrote:
> 
> I have a twistd daemon that runs a custom application (.tap). When
> starting up the daemon I have to enter the root password and a
> passphrase for SSL interactively from the console (the app runs a
> twisted web server for HTTP and HTTPS).
> 
> Because I want to do some automatic maintenace tasks I need to be able
> to start and stop the daemon from a script. Unfortunately I have
> little knowledge of Linux and the twistd daemon/application and need
> some input on how to attack this problem.
> 

  Requiring the passphrase to decrypt the SSL certificate is a measure of
security.  It makes it more difficult for attackers to trick your users into
thinking the attacker is you, by rendering the certificate useless in the
absense of the passphrase.

  If the passphrase is sitting in a plaintext file somewhere, waiting to be
used by the script that restarts your daemon, this security is negated -
attackers need now only read the script in addition to copying the
certificate.

  If the passphrase is stored encrypted, then this could be avoided, but
then you would have to type in a passphrase to decrypt that.  Of course, you
could store that passphrase in a file....  Hopefully you see where this is
leading.

  Choose security or convenience here (there is a third alternative - come
up with a new system that is both secure and convenient).  If you want
security, you can't automate this process; if you want convenience, you may
as well store the certificate plaintext, because you're buying little by
encrypting it and leaving a passphrase lying around for anyone to use.

  Lateral thinking may produce an acceptable solution - for example, wrap
the twistd restarter in a native setuid root executable, store the
certificate plaintext and readable only as root.  (Still if the filesystem
is stolen, the certificate has been compromised.  But an encrypted
filesystem alleviates this problem.)

  Hope this helps,

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20040102/c7c4d2cf/attachment.sig>

From syver-en at online.no  Fri Jan  2 16:00:07 2004
From: syver-en at online.no (Syver Enstad)
Date: 03 Jan 2004 00:00:07 +0100
Subject: [Twisted-Python] automating startup of twistd application.
In-Reply-To: <20040102185248.GA30148@intarweb.us>
References: <u4qve4lb3.fsf@inout.no> <20040102185248.GA30148@intarweb.us>
Message-ID: <uad56hs7c.fsf@online.no>

Jp Calderone <exarkun at intarweb.us> writes:

> On Fri, Jan 02, 2004 at 12:55:12PM +0100, Syver Enstad wrote:

>> Because I want to do some automatic maintenace tasks I need to be
>> able to start and stop the daemon from a script. Unfortunately I
>> have little knowledge of Linux and the twistd daemon/application and
>> need some input on how to attack this problem.

> Requiring the passphrase to decrypt the SSL certificate is a measure
> of security.  It makes it more difficult for attackers to trick your
> users into thinking the attacker is you, by rendering the
> certificate useless in the absense of the passphrase.  If the
> passphrase is sitting in a plaintext file somewhere, waiting to be
> used by the script that restarts your daemon, this security is
> negated - attackers need now only read the script in addition to
> copying the certificate.  If the passphrase is stored encrypted,
> then this could be avoided, but then you would have to type in a
> passphrase to decrypt that.  Of course, you could store that
> passphrase in a file....  Hopefully you see where this is leading.

Yes, I think that I am throughly hosed anyway if someone gets access
to the filesystem on the machine in question.

>   Hope this helps,

Yes, thanks. The security aspects of it is certainly interesting and
important. Where should I look to find out how to automate startup of
the twistd daemon so that it doesn't prompt for the root password?


-- 

Syver Enstad




From bob at redivi.com  Fri Jan  2 17:17:22 2004
From: bob at redivi.com (Bob Ippolito)
Date: Fri, 2 Jan 2004 19:17:22 -0500
Subject: [Twisted-Python] automating startup of twistd application.
In-Reply-To: <uad56hs7c.fsf@online.no>
References: <u4qve4lb3.fsf@inout.no> <20040102185248.GA30148@intarweb.us> <uad56hs7c.fsf@online.no>
Message-ID: <3395A178-3D82-11D8-996B-000A95686CD8@redivi.com>


On Jan 2, 2004, at 6:00 PM, Syver Enstad wrote:

> Jp Calderone <exarkun at intarweb.us> writes:
>
>> On Fri, Jan 02, 2004 at 12:55:12PM +0100, Syver Enstad wrote:
>
>>> Because I want to do some automatic maintenace tasks I need to be
>>> able to start and stop the daemon from a script. Unfortunately I
>>> have little knowledge of Linux and the twistd daemon/application and
>>> need some input on how to attack this problem.
>
> Yes, thanks. The security aspects of it is certainly interesting and
> important. Where should I look to find out how to automate startup of
> the twistd daemon so that it doesn't prompt for the root password?

Typically the way that one does this is to start a daemon as root via 
one of the following "startup phase" options: crontab (a @reboot 
directive), an init.d (sometimes called rc.d or rc) script, a 
"StartupItem bundle" on OS X, etc.  These don't need the root password 
to run once installed because they are executed as root during the 
normal startup phase of the computer.

-bob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20040102/96fc1408/attachment-0002.bin>

From lists at webcrunchers.com  Fri Jan  2 19:13:39 2004
From: lists at webcrunchers.com (JD)
Date: Fri, 2 Jan 2004 18:13:39 -0800
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <20040102025208.GB11930@frobozz>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com> <20040102025208.GB11930@frobozz>
Message-ID: <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com>

On Jan 1, 2004, at 6:52 PM, Andrew Bennetts wrote:

> On Thu, Jan 01, 2004 at 11:25:37AM -0800, JD wrote:
>> On Dec 31, 2003, at 7:43 PM, Eric Mangold wrote:
>>>
>>> Since this is IRC you shouldn't go issuing commands until your signed
>>> on, thus the signedOn method of your protocol would be the right 
>>> place.
>>
>> Ok,   good point....   but how do I issue commands?   let's say I have
>> a IRCClient class called "testIRC".
>>
>> do I use:    testIRC.sendLine('signedOn')  to send the command to the
>> IRC server
>> to signon?
>
> No.  IRCClient is a LineReceiver subclass, because that's how the 
> low-level
> protocol works.

I think I understand.   what is needed in the docs,   is a better 
description of just
what the roles of these objects are supposed to do,   and where we,  as 
users
of Twisted,  would have a much better chance to use Twisted in the way 
it is
intended.    So the usage of 'sendLine' in a 'lineReceiver' would be 
inappropriate?
but if that's true,  then how does one send a command to the IRC server?

By the way,   I've chosen this as a simple test application,  not 
unlike what I
want to really do,   so I have chosen a relatively simple application,  
where I
just extract all the users of a specified IRC server,  and return the 
data.

I have not specified the form of the data,  that's not important,  but 
what's
important to me,  is the understand how to use Twisted in the way it was
intended.

I have this:

class IRC_test(irc.IRCClient):

     def whois_on(self):
     	"""
     	This method issues a 'WHO' command to see who is on the server.
     	"""
     	self.sendLine("WHO")

     def signedOn(self):
         """Called after sucessfully signing on to the server.   So we 
immediately
         issue the 'whois_on' message to let the server go and do it's 
stuff.
         """
         self.whois_on(self)

     def whois_result(self, prefix,  info):
		"""
		This is the code the IRC is somehow going to call.   Then,
		after it is called,  it stores the info in the factory
		and returns by calling 'reactor.stop()' to exit the reactor.run()
		"""
		self.result = extract_whois_data(info)
		reactor.stop()
		
     def irc_RPL_WHOISSERVER(self, prefix, params):
     	"""
     	This was not included in the parent class IRCClient,
     	So I add it here.  'lineReceived' gets the
     	command = numeric_to_symbolic[command],  which is now
     	the string 'RPL_WHOISSERVER'.   To get THIS method to call,
     	the 'handleCommand' method first generates a key to the
     	class's 'attribute' dictionary,  by pre-pending 'irc_'
     	in front of it to get this method,  which is then called.
     	'params' would then have the result data.   We need to
     	hack around to see what form it's in.
     	"""
         self.whois_result(params[1])
		
def test_irc(host, port):
	"""
	This function scans a particular IRC server,  and returns a dictionary
	of all the nicks and IP addresses.  Nick is the key,  the IP or reverse
	dns is the value.
	"""
	my_nick = "jd6969"
	data_dict = {}		# place where I want my IRC data
	myTestFactory = IRC_test(data_dict,  my_nick)
	reactor.connectTCP(host, port, myTestFactory)
	reactor.run()		# I just wait for the server to respond
	return data_dict	# when it does, I just want to return with the data

I know this is a pretty stupid and useless application,  but this is 
very close to what I want
it to do,  without revealing anything.    I haven't tested this yet,  
because I just want to be
sure I'm doing it right,  rather then to spend weeks down a particular 
path to nowhere.
	
> However, you're not using the low-level protocol, you're
> using an abstraction on top of it -- IRCClient.  Don't break the 
> abstraction
> (by calling LineReceiver's sendLine method) unless you have a good 
> reason to
> and you know the protocol spec well enough to know what you're doing 
> (which
> would be RFC 2812 in this case, I think).

I believe I do,  because I still have to tell the IRC server what I 
want it to do.
And the only way I can see,  is with the sendLine command.

>
> As far as I'm aware, sending a line saying 'signedOn' to the server 
> doesn't
> make any sense in the IRC protocol, so this definitely wouldn't achieve
> anything useful, except causing an error from the server that the 
> IRCClient
> instance probably won't expect (because you broke the abstraction and 
> snuck
> behind its back to do it).

Ok,   so it is clear I'm doing this wrong.  If that's the case,  then 
what is the
RIGHT way of doing it?

>
>> or do I:   testIRC.register('mynick', 'myhost', 'irc.debian.com')
>
> That looks much saner.  And noticeably more full of information than
> testIRC.sendLine('signedOn')...
>
>> then,   when I want to do the "who" command,  would I do:
>> testIRC.sendLine('who')
>
> Well, I believe the WHO command requires an argument, so it would be 
> more
> like testIRC.sendLine('WHO ' + name)... but see my next answer.

hmmm - in checking the RFC it mentions I can either "WHO <channel>" or
"WHO" without specifying a channel,  in which it gets the names of ALL 
the users
of the IRC server not hidden.

>
>> then,   i would expect to call me back,   so I would override the
>> "action" method,
>> like so:
>>
>> def action(self, user, channel, msg):
>> 	< extract the info I want from msg and store it somewhere,  probably
>> in an instance variable in testIRC object >
>>          reactor.stop()    ---  to exit the client and disconnect,   
>> or
>> would I have to put the reactor.stop() in the
>>          factory's "clientConnectionFailed" method,  which I would
>> override of course.
>
> That's not what the action method is for.  As the docstring for action 
> says:
> "Called when I see a user perform an ACTION on a channel."  An ACTION 
> is a
> specific thing in IRC, not a catch-all for every type of message from
> server to client.  See the RFC if you're not familar with the terms.

Yes - I was mislead...   I interpreted this as an action that might come
from the server,  such as the result of a WHO command (in using my 
example)

I think if you take a look at the shell of my application,   I'm no 
longer using this.

> The right way to do this is implemented in sandbox/exarkun/irc2.py -- 
> see
> the AdvancedClient.who method.  I'd follow JP's earlier suggestion and 
> use
> it.

I was NOT aware that anything in "sandbox" had anything to do with IRC.
Expecially when words like this are chosen.   One can interpret 
'sandbox' in
many zillion ways,  so how would I even know this.

I took a look at this,  and WOW - this might be just what I need.   I'm 
going to
have to spend a lot of time studying this.    I had no clue this even 
existed,
primarily because the name 'sandbox' really had nothing to do with IRC,
and I just couldn't make the connection.

> The answer is of course none of those.  You should've already noticed 
> that
> IRCClient doesn't implement a who() method, so it's hardly surprising 
> it
> hasn't implemented a command to deal with its response.

yes - as it also doesn't implement a LOT of things,  and yet they are
defined as overrideable functions.

>  irc2.py does,
> though (and uses Deferreds for dealing with the response, which is 
> cleaner
> anyway).

Kewl - and now just being aware of that,    I definately want to check 
it out.
And also I could use some connents on my above approach,  as I have
avoided the pitfalls you outlined above.

> I thought you wanted to use the WHO command not WHOIS?  Please try to 
> be
> precise.

I thought they were almost the same....  at least that's what I read in 
the RFC's.
What is the difference?

> Anyway, irc2.py also implements WHOIS.

Kewl

>
>> Could I add this to my IRCClient's subclass?
>>
>> IE:
>>
>>     def irc_RPL_WHOISSERVER(self, prefix, params):
>>         self.whois(params[1])
>
> If you look at irc2.py, you'll see it does override this method.  Note 
> that
> 'whois' is a bad name for the response handler -- the existing 
> convention in
> IRCClient is that 'join', 'nick', etc, are the methods that *issue* the
> command, not that handle the response.

I haven't seen any mention of naming conventions,  but if there is one,
I certainly would want to know where it is.

> I think the biggest critical step you're missing is that you're busily
> trying to reinvent a wheel that's already been made in
> sandbox/exarkun/irc2.py, though.

that is obviously true....  I explained above why I just didn't even 
know of it's
existance until it was pointed out to me.

John




From andrew-twisted at puzzling.org  Fri Jan  2 20:20:31 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sat, 3 Jan 2004 14:20:31 +1100
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com> <20040102025208.GB11930@frobozz> <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com>
Message-ID: <20040103032031.GA14197@frobozz>

On Fri, Jan 02, 2004 at 06:13:39PM -0800, JD wrote:
> On Jan 1, 2004, at 6:52 PM, Andrew Bennetts wrote:
> >On Thu, Jan 01, 2004 at 11:25:37AM -0800, JD wrote:
> >>
> >>do I use:    testIRC.sendLine('signedOn')  to send the command to the
> >>IRC server
> >>to signon?
> >
> >No.  IRCClient is a LineReceiver subclass, because that's how the 
> >low-level
> >protocol works.
> 
> I think I understand.   what is needed in the docs,   is a better
> description of just what the roles of these objects are supposed to do,
> and where we,  as users of Twisted,  would have a much better chance to
> use Twisted in the way it is intended.    So the usage of 'sendLine' in a
> 'lineReceiver' would be inappropriate?  but if that's true,  then how does
> one send a command to the IRC server?

No, using sendLine in a LineReceiver is fine -- that's why LineReceiver
defines sendLine.

What isn't so good is using sendLine in an IRCClient subclass.  While
IRCClient subclasses LineReceiver, in general you should be using the
abstractions IRCClient provides to send commands to and receive responses
from the server (if you don't want to use them, then why not just use a
plain LineReceiver?).

The only reason you should have for calling sendLine in an IRCClient
subclass is to extend its functionality to support more of the protocol than
it already does.  IRCClient already has support for signing on (the
'register' method and the 'signedOn' handler), so you shouldn't use sendLine
for that.  IRCClient currently lacks some IRC features, such as WHO, so to
do those you do need sendLine.

Also, good style suggests that you probably shouldn't mix your application
code with your IRCClient extensions, i.e. subclass IRCClient for WHO support
(and other other unimplemented commands you need), and then subclass that
for your application.

> By the way,   I've chosen this as a simple test application,  not unlike
> what I want to really do,   so I have chosen a relatively simple
> application,  where I just extract all the users of a specified IRC
> server,  and return the data.
> 
> I have not specified the form of the data,  that's not important,  but
> what's important to me,  is the understand how to use Twisted in the way
> it was intended.
> 
> I have this:
> 
> class IRC_test(irc.IRCClient):
> 
>     def whois_on(self):
>     	"""
>     	This method issues a 'WHO' command to see who is on the server.
>     	"""
>     	self.sendLine("WHO")
> 
>     def signedOn(self):
>         """Called after sucessfully signing on to the server.   So we
>         immediately issue the 'whois_on' message to let the server go and
>         do it's stuff.
>         """
>         self.whois_on(self)
> 
>     def whois_result(self, prefix,  info):
> 		"""
> 		This is the code the IRC is somehow going to call.   Then,
> 		after it is called,  it stores the info in the factory
> 		and returns by calling 'reactor.stop()' to exit the 
> 		reactor.run()
> 		"""
> 		self.result = extract_whois_data(info)
> 		reactor.stop()

(This identation is really painful.)

>     def irc_RPL_WHOISSERVER(self, prefix, params):
>     	"""
>     	This was not included in the parent class IRCClient,
>     	So I add it here.  'lineReceived' gets the
>     	command = numeric_to_symbolic[command],  which is now
>     	the string 'RPL_WHOISSERVER'.   To get THIS method to call,
>     	the 'handleCommand' method first generates a key to the
>     	class's 'attribute' dictionary,  by pre-pending 'irc_'
>     	in front of it to get this method,  which is then called.
>     	'params' would then have the result data.   We need to
>     	hack around to see what form it's in.
>     	"""
>         self.whois_result(params[1])

(This identation won't even work!)

But creating a method called 'irc_RPL_WHOISSERVER' will do what you want
here.  Handler methods with a common prefix that are dispatched with a
getattr call are a common, and very nice, idiom in Twisted.

> def test_irc(host, port):
> 	"""
> 	This function scans a particular IRC server,  and returns a
> 	dictionary of all the nicks and IP addresses.  Nick is the key,  the
> 	IP or reverse dns is the value.
> 	"""
> 	my_nick = "jd6969"
> 	data_dict = {}		# place where I want my IRC data
> 	myTestFactory = IRC_test(data_dict,  my_nick)
> 	reactor.connectTCP(host, port, myTestFactory)
> 	reactor.run()		# I just wait for the server to respond
> 	return data_dict	# when it does, I just want to return with the data

(Ugh, and now you're using tabs...)

IRC_test is a protocol, but you're passing it as a factory to connectTCP.
See http://twistedmatrix.com/documents/howto/clients.

> I know this is a pretty stupid and useless application,  but this is very
> close to what I want it to do,  without revealing anything.    I haven't
> tested this yet,  because I just want to be sure I'm doing it right,
> rather then to spend weeks down a particular path to nowhere.

This code is short.  Why didn't you run it yourself to get some idea of how
close it is to working?  Working code is usually a good sign that you're
close to the right path, if not already on it...

> >However, you're not using the low-level protocol, you're
> >using an abstraction on top of it -- IRCClient.  Don't break the 
> >abstraction
> >(by calling LineReceiver's sendLine method) unless you have a good 
> >reason to
> >and you know the protocol spec well enough to know what you're doing 
> >(which
> >would be RFC 2812 in this case, I think).
> 
> I believe I do,  because I still have to tell the IRC server what I want
> it to do.  And the only way I can see,  is with the sendLine command.

Only because you need to extend it to cover parts of the protocol that
aren't implemented.  You started off talking about 'signedOn', which is
already covered by IRCClient, and only later mentioned trying to do a WHO
command, which isn't.  Confusing issues like this makes it hard to figure
out what you're trying to do.

> >As far as I'm aware, sending a line saying 'signedOn' to the server 
> >doesn't
> >make any sense in the IRC protocol, so this definitely wouldn't achieve
> >anything useful, except causing an error from the server that the 
> >IRCClient
> >instance probably won't expect (because you broke the abstraction and 
> >snuck
> >behind its back to do it).
> 
> Ok,   so it is clear I'm doing this wrong.  If that's the case,  then what
> is the RIGHT way of doing it?

Calling register, of course.  Where in the RFC does it say 'signedOn' is a
recognised command?

> >>or do I:   testIRC.register('mynick', 'myhost', 'irc.debian.com')
> >
> >That looks much saner.  And noticeably more full of information than
> >testIRC.sendLine('signedOn')...
> >
> >>then,   when I want to do the "who" command,  would I do:
> >>testIRC.sendLine('who')
> >
> >Well, I believe the WHO command requires an argument, so it would be 
> >more
> >like testIRC.sendLine('WHO ' + name)... but see my next answer.
> 
> hmmm - in checking the RFC it mentions I can either "WHO <channel>" or
> "WHO" without specifying a channel,  in which it gets the names of ALL the
> users of the IRC server not hidden.

Fair enough.  Believe it or not, but I actually know very very little about
IRC, I mainly figured it out for that email to you by skimming irc.py and
one or two brief google searches to confirm e.g. that 'signedOn' doesn't
appear in the RFC.

> >The right way to do this is implemented in sandbox/exarkun/irc2.py -- 
> >see
> >the AdvancedClient.who method.  I'd follow JP's earlier suggestion and 
> >use
> >it.
> 
> I was NOT aware that anything in "sandbox" had anything to do with IRC.
> Expecially when words like this are chosen.   One can interpret 'sandbox'
> in many zillion ways,  so how would I even know this.

Because of a mail from earlier in the thread from JP:
    http://twistedmatrix.com/pipermail/twisted-python/2004-January/006893.html

Which part of

    "WHO is one of the commands I did manage to improve, but I never moved
    any of the work out of my sandbox.  You can find it in
    Twisted/sandbox/exarkun/irc2.py."

was unclear?

> I took a look at this,  and WOW - this might be just what I need.   I'm
> going to have to spend a lot of time studying this.    I had no clue this
> even existed, primarily because the name 'sandbox' really had nothing to
> do with IRC, and I just couldn't make the connection.

Hence the email.

> >The answer is of course none of those.  You should've already noticed 
> >that
> >IRCClient doesn't implement a who() method, so it's hardly surprising 
> >it
> >hasn't implemented a command to deal with its response.
> 
> yes - as it also doesn't implement a LOT of things,  and yet they are
> defined as overrideable functions.

I don't understand what you're saying here.  You mean things like
irc_RPL_WHOISSERVER?  That's just the way the prefixed getattr idiom works;
all you need to do support a new command define a handler method for it, and
that's it.  No explicit registration or anything like that needed.  Python's
a dynamic language, and Twisted uses that to its advantage.

> >I thought you wanted to use the WHO command not WHOIS?  Please try to 
> >be
> >precise.
> 
> I thought they were almost the same....  at least that's what I read in
> the RFC's.  What is the difference?

No idea.  Again, I don't know IRC very well :)

I notice that irc2.py implements both WHO and WHOIS seperately, though, so I
figure there are some differences, which is why you saying WHO and then
later WHOIS confused me.

> >>Could I add this to my IRCClient's subclass?
> >>
> >>IE:
> >>
> >>    def irc_RPL_WHOISSERVER(self, prefix, params):
> >>        self.whois(params[1])
> >
> >If you look at irc2.py, you'll see it does override this method.  Note 
> >that
> >'whois' is a bad name for the response handler -- the existing 
> >convention in
> >IRCClient is that 'join', 'nick', etc, are the methods that *issue* the
> >command, not that handle the response.
> 
> I haven't seen any mention of naming conventions,  but if there is one,
> I certainly would want to know where it is.

It's not explicitly written anywhere that I know of.  It was just obvious to
me from skimming the code of irc.py and irc2.py that that's what the
convention was, because that's what the existing code *does*.  I generally
try to follow the conventions of code I'm using to avoid getting horribly
confused.

> >I think the biggest critical step you're missing is that you're busily
> >trying to reinvent a wheel that's already been made in
> >sandbox/exarkun/irc2.py, though.
> 
> that is obviously true....  I explained above why I just didn't even know
> of it's existance until it was pointed out to me.

Yes, but it was pointed out to you before this...

-Andrew.




From richard at starfighter.freeuk.com  Sat Jan  3 08:23:21 2004
From: richard at starfighter.freeuk.com (Richard Townsend)
Date: Sat, 3 Jan 2004 15:23:21 -0000
Subject: [Twisted-Python] Resume FTP file retrieval
Message-ID: <ECEGJLPCEIFJKDPCFJDHAEAOCDAA.richard@starfighter.freeuk.com>

In the Python ftplib.FTP class's retrbinary() method you can pass a file
offset using the 'rest' arg (in order to resume a partial download).

Please could someone advise how to do a similar thing using the Twisted
FTPClient class? 


-------------- next part --------------
A non-text attachment was scrubbed...
Name: winmail.dat
Type: application/ms-tnef
Size: 1488 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20040103/c50476b1/attachment-0002.bin>

From andrew-twisted at puzzling.org  Sat Jan  3 09:17:40 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 4 Jan 2004 03:17:40 +1100
Subject: [Twisted-Python] Resume FTP file retrieval
In-Reply-To: <ECEGJLPCEIFJKDPCFJDHAEAOCDAA.richard@starfighter.freeuk.com>
References: <ECEGJLPCEIFJKDPCFJDHAEAOCDAA.richard@starfighter.freeuk.com>
Message-ID: <20040103161740.GC14197@frobozz>

On Sat, Jan 03, 2004 at 03:23:21PM -0000, Richard Townsend wrote:
> In the Python ftplib.FTP class's retrbinary() method you can pass a file
> offset using the 'rest' arg (in order to resume a partial download).
> 
> Please could someone advise how to do a similar thing using the Twisted
> FTPClient class? 

There's currently no explicit support for this, but you could do:

    ftpclient.queueStringCommand("REST " + offset).addErrback(log.err)

before calling retrieveFile/retr.

(You probably want to do more than just log an error if the REST command
fails, but you get the idea...)

-Andrew.




From andrew-twisted at puzzling.org  Sat Jan  3 09:32:47 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun, 4 Jan 2004 03:32:47 +1100
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <20040103032031.GA14197@frobozz>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com> <20040102025208.GB11930@frobozz> <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com> <20040103032031.GA14197@frobozz>
Message-ID: <20040103163247.GD14197@frobozz>

On Sat, Jan 03, 2004 at 02:20:31PM +1100, I wrote:
> 
> I don't understand what you're saying here.  You mean things like
> irc_RPL_WHOISSERVER?  That's just the way the prefixed getattr idiom works;
> all you need to do support a new command define a handler method for it, and
                                          ^ obviously I meant to insert the
                                            word "is" here.

-Andrew.




From marjancinober at hotmail.com  Sat Jan  3 11:18:44 2004
From: marjancinober at hotmail.com (marjan cinober)
Date: Sat, 03 Jan 2004 19:18:44 +0100
Subject: [Twisted-Python] First demo of Twisted Enterprise HOWTO. Twisted RDBMS support.
Message-ID: <Sea1-F30WKCSxQaWutz00041be9@hotmail.com>

Ive been trying to start twisted RDBMS by following howto.
After a couple of hours it's finaly working. I came up to this...

It's maybe worth updating howto with working examples to save some time. I 
know that missing lines are completly obvious to most of experienced users 
but I was hopeing howto will make me run some demo tests immediately, even 
thow I'm just a dumb beginner.

#!/usr/bin/python
# EnterpriseDemo.py
"""First demo of Twisted Enterprise HOWTO. Twisted RDBMS support."""

from twisted.python import log
from twisted.internet import reactor
from twisted.enterprise import adbapi

# use this line for postgresql test
dbpool = adbapi.ConnectionPool("pyPgSQL.PgSQL", database='mydb')

# equivalent of cursor.execute(statement), return cursor.fetchall():
def getAge(user):
    return dbpool.runQuery( """SELECT age FROM users
        WHERE name = '%s'""" % user)

def printResult(l):
    if l:
        print l[0][0], "years old"
    else:
        print "No such user"
    reactor.stop()

getAge("joe").addCallback(printResult).addErrback( log.err)

reactor.run()

############### Setup on Debian Testing
## su
## su - postgres
## createuser -d -a _MyUserName_
## exit
## su - _MyUserName_
## createdb -U _MyUserName_ mydb "Demo Database mydb"
## psql mydb
##
## drop table users;
## CREATE TABLE users (
##   name varchar(64),
##   age int
## );
##
## insert into users values( 'joe', 35);
## insert into users values( 'jonas', 25);
## insert into users values( 'josefa', 16);
## ### QUICK TEST ###
## select * from users;
## SELECT age FROM users WHERE name = 'joe';
#############

_________________________________________________________________
STOP MORE SPAM with the new MSN 8 and get 2 months FREE* 
http://join.msn.com/?page=features/junkmail




From marjancinober at hotmail.com  Sat Jan  3 11:53:32 2004
From: marjancinober at hotmail.com (marjan cinober)
Date: Sat, 03 Jan 2004 19:53:32 +0100
Subject: [Twisted-Python] pb Exchange infrastructure
Message-ID: <Sea1-F9GTuAyHsjCGvs000439b8@hotmail.com>

I have spent last month composing this as a complete begginner in twisted.

I need to implement distributed data collection&distributiion network to 
gradually phase out a currently old mixed standard/vendor/equipment 
production process monitoring system.

The idea is to start a system that will be distributed, redundant and 
eventually become resistant to a single point of failure by using multiple 
sensors and delivery networks/paths.

These files are working... (Note the last three messages coming in 2s 
interval.)

Fetcher.py - http://shamash.eece.unm.edu:8080/bin.rpy/468
FetchCli.py - http://shamash.eece.unm.edu:8080/bin.rpy/469

, but they must be full of weird/suboptimal solutions as a use of twisted 
Perspective Broker. And probably the python itself is weak.

I would be gratefull of any constructive criticism. :-)
Thanks

    Marjan Cinober

_________________________________________________________________
Tired of slow downloads? Compare online deals from your local high-speed 
providers now.  https://broadband.msn.com




From marjancinober at hotmail.com  Sat Jan  3 12:13:45 2004
From: marjancinober at hotmail.com (marjan cinober)
Date: Sat, 03 Jan 2004 20:13:45 +0100
Subject: [Twisted-Python] examples/row_example.py  DBError Row object not in cache
Message-ID: <Sea1-F983AYJu3aCD8W00043c57@hotmail.com>

Still trying to test some postgersql access from twisted.
Unfortunate at running example ROW (Twisted Enterprise)
http://twistedmatrix.com/documents/examples/row_example.py

got stuck at
  File "row_example.py", line 58, in onInsert
    manager.deleteRow(newRoom).addCallback(onDelete)

Anybody has some clues?

Thanks

Best regards to all of you.

        Marjan Cinober

-----
I am on Linux debian testing (sarge)
Package: python2.3-twisted  Version: 1.1.0-1
Maintainer: Moshe Zadka <moshez at debian.org>

-----
$ psql test
test=# \i row_schema.sql
\q

cinober at mym:~/examples$ python row_example.py
/usr/lib/python2.3/site-packages/twisted/enterprise/row.py:135: 
DeprecationWarning: This is deprecated. Use the underlying database to 
generate keys, or just roll your own.
  warnings.warn("This is deprecated. Use the underlying database to generate 
keys, or just roll your own.", DeprecationWarning)
got Rooms. [<Room #10: testroom1 (someguy) (10,10)>, <Room #11: testroom2 
(someguy) (30,10)>, <Room #12: testroom3 (someguy) (50,10)>]
room   <Room #10: testroom1 (someguy) (10,10)>
furn      Furniture #50: room #10 (chair1) (10,10)
inner         Lamp #21
inner         Lamp #22
furn      Furniture #51: room #10 (chair2) (14,10)
furn      Rug 81: room #10, (a big rug)
furn      Rug 82: room #10, (a blue rug)
room   <Room #11: testroom2 (someguy) (30,10)>
furn      Rug 83: room #11, (a red rug)
furn      Rug 84: room #11, (a green rug)
room   <Room #12: testroom3 (someguy) (50,10)>
furn      Furniture #52: room #12 (chair3) (14,10)
furn      Furniture #53: room #12 (chair4) (10,12)
inner         Lamp #23
inner         Lamp #24
inner         Lamp #25
furn      Furniture #54: room #12 (chair5) (18,13)
furn      Furniture #55: room #12 (couch) (22,3)
furn      Rug 85: room #12, (a dirty rug)
updated row.
row inserted
100001

******** BLOCKED *********  Forced to <Ctrl>-C

Traceback (most recent call last):
  File "/usr/lib/python2.3/site-packages/twisted/internet/default.py", line 
130, in mainLoop
    self.runUntilCurrent()
  File "/usr/lib/python2.3/site-packages/twisted/internet/base.py", line 
403, in runUntilCurrent
    callable(*args, **kw)
  File "/usr/lib/python2.3/site-packages/twisted/internet/defer.py", line 
224, in callback
    self._startRunCallbacks(result)
  File "/usr/lib/python2.3/site-packages/twisted/internet/defer.py", line 
293, in _startRunCallbacks
    self._runCallbacks()
--- <exception caught here> ---
--- <exception caught here> ---
  File "/usr/lib/python2.3/site-packages/twisted/internet/defer.py", line 
307, in _runCallbacks
    self.result = callback(self.result, *args, **kw)
  File "row_example.py", line 58, in onInsert
    manager.deleteRow(newRoom).addCallback(onDelete)
  File 
"/usr/lib/python2.3/site-packages/twisted/enterprise/sqlreflector.py", line 
330, in deleteRow
    self.removeFromCache(rowObject)
  File "/usr/lib/python2.3/site-packages/twisted/enterprise/reflector.py", 
line
141, in removeFromCache
    raise DBError("Row object not in cache: %s", rowObject)
twisted.enterprise.util.DBError: ('Row object not in cache: %s', <Room 
#100001:
newRoom1 (fred) (100,100)>)

_________________________________________________________________
Tired of spam? Get advanced junk mail protection with MSN 8. 
http://join.msn.com/?page=features/junkmail




From 2002 at weholt.org  Sat Jan  3 15:45:43 2004
From: 2002 at weholt.org (Thomas Weholt)
Date: Sat, 3 Jan 2004 23:45:43 +0100
Subject: [Twisted-Python] Twisted-Web: Authenticating a usersite-wide ??
Message-ID: <03e901c3d24b$53e51c90$0401a8c0@RAZOR>

Hi,

I got a problem using a custom-made web-application built upon Twisted. My problem is that when I ask a user for authentication, the cookie or whatever it is, is not available in the request-object for other sites than the one who asked for authentication. I want the user to login on one page, which sets the correct info so I can use request.getUser() and request.getPassword() later on all other pages to validate access to the requested resources.

In my RootResource I return something like this if I want the user authenticated:

request.setHeader('WWW-authenticate', 'Basic realm="%s"' % ("/"))
errpage = error.ErrorPage(http.UNAUTHORIZED, "Unauthorized", "401 Authentication required")
return errpage.render(request)

Is Basic realm = "/" correct if I want this authentication to be valid site-wide? What else can I use? What other approach can I use?

Happy for any hints or clues.

Thanks in advance,
Thomas


-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20040103/e5bb2e45/attachment.html>

From exarkun at intarweb.us  Sat Jan  3 16:16:34 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Sat, 3 Jan 2004 18:16:34 -0500
Subject: [Twisted-Python] Twisted-Web: Authenticating a usersite-wide ??
In-Reply-To: <03e901c3d24b$53e51c90$0401a8c0@RAZOR>
References: <03e901c3d24b$53e51c90$0401a8c0@RAZOR>
Message-ID: <20040103231634.GA1354@intarweb.us>

On Sat, Jan 03, 2004 at 11:45:43PM +0100, Thomas Weholt wrote:
> Hi,
>
> [snip] 
>
> Is Basic realm = "/" correct if I want this authentication to be valid
> site-wide? What else can I use? What other approach can I use?

  The realm should be the domain at which the site is located.

  Jp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20040103/f3a1db6e/attachment.sig>

From 2002 at weholt.org  Sat Jan  3 18:34:46 2004
From: 2002 at weholt.org (Thomas Weholt)
Date: Sun, 4 Jan 2004 02:34:46 +0100
Subject: [Twisted-Python] Twisted-Web: Authenticating a usersite-wide ??
References: <03e901c3d24b$53e51c90$0401a8c0@RAZOR> <20040103231634.GA1354@intarweb.us>
Message-ID: <03fa01c3d262$f0a29280$0401a8c0@RAZOR>

Ok, then this might sound stupid, but if I got my server running on an
ADSL-line using a dynamic DNS-service, should I then use the dynamic
DNS-name or ... ???

What if this was to run on a LAN? What then?

Apologize if this is off-topic and lame.

Thomas

----- Original Message -----
From: "Jp Calderone" <exarkun at intarweb.us>
To: <twisted-python at twistedmatrix.com>
Sent: Sunday, January 04, 2004 12:16 AM
Subject: Re: [Twisted-Python] Twisted-Web: Authenticating a usersite-wide ??






From peter at engcorp.com  Sat Jan  3 18:52:51 2004
From: peter at engcorp.com (Peter Hansen)
Date: Sat, 03 Jan 2004 20:52:51 -0500
Subject: [Twisted-Python] Twisted-Web: Authenticating a usersite-wide ??
References: <03e901c3d24b$53e51c90$0401a8c0@RAZOR> <20040103231634.GA1354@intarweb.us> <03fa01c3d262$f0a29280$0401a8c0@RAZOR>
Message-ID: <3FF771F3.CBA12BC0@engcorp.com>

Thomas Weholt wrote:
> 
> Ok, then this might sound stupid, but if I got my server running on an
> ADSL-line using a dynamic DNS-service, should I then use the dynamic
> DNS-name or ... ???

Yes.

> What if this was to run on a LAN? What then?

Use the name by which the server is known on the LAN, whether
that's by means of an /etc/hosts (or windows/hosts, or whatever) mapping
file, or by using SMB name lookup, or whatever.  For example, our
intranet server is called just "intranet", though that happens to 
translate to 192.168.0.42 most of the time...

-Peter



From richard at starfighter.freeuk.com  Sun Jan  4 06:37:26 2004
From: richard at starfighter.freeuk.com (Richard Townsend)
Date: Sun, 4 Jan 2004 13:37:26 +0000
Subject: [Twisted-Python] Re: Re: Resume FTP file retrieval
Message-ID: <200401041337.27032.richard@starfighter.freeuk.com>

Hi Andrew,

Thanks very much for your suggestions.

I modified my test app to do:

    size = 10*1024
    deferred = ftpclient.queueStringCommand("REST %d" % size)
    deferred.addCallbacks(setRestSuccess,
                          setRestFailure,
                          callbackArgs=(filename, ftpclient))

In setRestSuccess() I receive the response:

['350 Restarting at 10240. Send STORE or RETRIEVE to initiate transfer.']

Then in setRestSuccess() I do:

    file_writer = FTPWriterProtocol(filename)
        
    deferred = ftpclient.retrieveFile(filename, file_writer)
    
    deferred.addCallbacks(downloadSuccess, 
                          downloadFail, 
                          callbackArgs=(file_writer,),
                          errbackArgs=(file_writer,))

where my protocol is defined as:

class FTPWriterProtocol(Protocol):
    def __init__(self, filename):
        self.file = open(filename, "ab")
    
    def close(self):
        print 'closing file'
        self.file.close()

    def dataReceived(self, data):
        print "Received %d bytes" % len(data)
        self.file.write(data)


In downloadSuccess() I receive the response:

[(1, ["150 Opening BINARY mode data connection for 'SSTEST.TXT' (522000 
bytes).", '226 Transfer complete.']), (1, None), (1, None)]

However, I actually receive the complete file, and not the partial download I 
expected.

Note: when I use ftplib.FTP.retrbinary() using the "rest" arg (connecting to 
the same server) I do get the partial download.

Any ideas why my Twisted version is not working?

regards,
Richard Townsend




From dave at krondo.com  Sun Jan  4 12:00:20 2004
From: dave at krondo.com (Dave Peticolas)
Date: Sun, 04 Jan 2004 11:00:20 -0800
Subject: [Twisted-Python] examples/row_example.py  DBError Row object
	not in cache
In-Reply-To: <Sea1-F983AYJu3aCD8W00043c57@hotmail.com>
References: <Sea1-F983AYJu3aCD8W00043c57@hotmail.com>
Message-ID: <1073242820.11485.30.camel@oneiros>

On Sat, 2004-01-03 at 11:13, marjan cinober wrote:
> Still trying to test some postgersql access from twisted.
> Unfortunate at running example ROW (Twisted Enterprise)
> http://twistedmatrix.com/documents/examples/row_example.py
> 
> got stuck at
>   File "row_example.py", line 58, in onInsert
>     manager.deleteRow(newRoom).addCallback(onDelete)
> 
> Anybody has some clues?

This was a bug. It should be fixed in CVS.

dave

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20040104/4fb786f2/attachment.sig>

From itamar at itamarst.org  Sun Jan  4 14:30:47 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 04 Jan 2004 16:30:47 -0500
Subject: [Twisted-Python] Does anyone use instance-only interface implementation
Message-ID: <1073251847.7794.3.camel@sheriffpony>

E.g. 

  Class Foo: pass
  o = Foo()
  o.__implements__ = (IBar,)

If so, I'd like to hear about it, cause we may want to remove support
for it.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From bob at redivi.com  Sun Jan  4 15:00:44 2004
From: bob at redivi.com (Bob Ippolito)
Date: Sun, 4 Jan 2004 17:00:44 -0500
Subject: [Twisted-Python] Does anyone use instance-only interface implementation
In-Reply-To: <1073251847.7794.3.camel@sheriffpony>
References: <1073251847.7794.3.camel@sheriffpony>
Message-ID: <71BFD8FA-3F01-11D8-ACF7-000A95686CD8@redivi.com>

On Jan 4, 2004, at 4:30 PM, Itamar Shtull-Trauring wrote:

>   Class Foo: pass
>   o = Foo()
>   o.__implements__ = (IBar,)
>
> If so, I'd like to hear about it, cause we may want to remove support
> for it.

I've used "instance-only interface implementation" when the instance at 
hand is Foo (the class itself, for its class methods), not Foo().. but 
that doesn't work with a stock version of Twisted anyways.  I'm 
probably going to convert the code to PyProtocols next time it's 
unearthed for that (and other) reasons, but I figure it's worthy of 
mention.

-bob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20040104/ae5279e1/attachment-0002.bin>

From andrew-twisted at puzzling.org  Sun Jan  4 16:11:20 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon, 5 Jan 2004 10:11:20 +1100
Subject: [Twisted-Python] Re: Re: Resume FTP file retrieval
In-Reply-To: <200401041337.27032.richard@starfighter.freeuk.com>
References: <200401041337.27032.richard@starfighter.freeuk.com>
Message-ID: <20040104231120.GA20040@frobozz>

On Sun, Jan 04, 2004 at 01:37:26PM +0000, Richard Townsend wrote:
> Hi Andrew,
> 
> Thanks very much for your suggestions.
[...]
> 
> However, I actually receive the complete file, and not the partial download I 
> expected.
> 
> Note: when I use ftplib.FTP.retrbinary() using the "rest" arg (connecting to 
> the same server) I do get the partial download.
> 
> Any ideas why my Twisted version is not working?

Glancing at ftplib, the difference is that my suggestion will send REST,
PORT/PASV, RETR (in that order), but ftplib does PORT/PASV, REST, RETR.  A
quick glance at http://cr.yp.to/ftp/retr.html doesn't suggest that this
should matter, but this is FTP after all...  (and it wouldn't surprise me if
different servers behave differently here, too)

Looks like FTPClient will need to be changed after all :/

-Andrew.




From itamar at itamarst.org  Sun Jan  4 16:13:42 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 04 Jan 2004 18:13:42 -0500
Subject: [Twisted-Python] Does anyone use instance-only interface
	implementation
In-Reply-To: <71BFD8FA-3F01-11D8-ACF7-000A95686CD8@redivi.com>
References: <1073251847.7794.3.camel@sheriffpony>
	 <71BFD8FA-3F01-11D8-ACF7-000A95686CD8@redivi.com>
Message-ID: <1073258022.24289.6.camel@sheriffpony>

On Sun, 2004-01-04 at 17:00, Bob Ippolito wrote:

> I've used "instance-only interface implementation" when the instance at 
> hand is Foo (the class itself, for its class methods), not Foo().. but 
> that doesn't work with a stock version of Twisted anyways.  I'm 
> probably going to convert the code to PyProtocols next time it's 
> unearthed for that (and other) reasons, but I figure it's worthy of 
> mention.

Well, this is actually the motivation. Want to fix the code so you can
specify classes implementing interfaces, by setting __implements__ on
their metaclass. 

http://twistedmatrix.com/users/roundup.twistd/twisted/issue457

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From michal at pasternak.w.lub.pl  Sun Jan  4 15:31:54 2004
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Sun, 4 Jan 2004 23:31:54 +0100
Subject: [Twisted-Python] Encrypted PB?
Message-ID: <20040104223154.GB5515@pasternak.w.lub.pl>

How can I plug-in encryption of transmission of PB ?



From developer at csrules.dyndns.org  Sun Jan  4 18:43:22 2004
From: developer at csrules.dyndns.org (darryl)
Date: Sun, 04 Jan 2004 17:43:22 -0800
Subject: [Twisted-Python] Encrypted PB?
In-Reply-To: <20040104223154.GB5515@pasternak.w.lub.pl>
References: <20040104223154.GB5515@pasternak.w.lub.pl>
Message-ID: <3FF8C13A.6040200@csrules.dyndns.org>

Michal Pasternak wrote:

>How can I plug-in encryption of transmission of PB ?
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>  
>

SSL

-darryl




From michal at pasternak.w.lub.pl  Sun Jan  4 16:11:10 2004
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Mon, 5 Jan 2004 00:11:10 +0100
Subject: [Twisted-Python] Encrypted PB?
In-Reply-To: <3FF8C13A.6040200@csrules.dyndns.org>
References: <20040104223154.GB5515@pasternak.w.lub.pl> <3FF8C13A.6040200@csrules.dyndns.org>
Message-ID: <20040104231110.GA6428@pasternak.w.lub.pl>

darryl [Sun, Jan 04, 2004 at 05:43:22PM -0800]:
> Michal Pasternak wrote:
> 
> SSL

... any examples?



From miracle at slingshot.co.nz  Sun Jan  4 18:06:05 2004
From: miracle at slingshot.co.nz (Matthew Sherborne)
Date: Mon, 05 Jan 2004 14:06:05 +1300
Subject: [Twisted-Python] dbcred with new api example
Message-ID: <1073264765.18952.2.camel@localhost>

Hope this helps someone.

It's just a authentication checker. It uses a postgres database to store
the usernames and passwords.

Enjoy
-- 
Matthew Sherborne
Director
Sherborne International Ltd.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dbcred.py
Type: text/x-python
Size: 6419 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20040105/840886f9/attachment-0002.py>

From phil at bubblehouse.org  Sun Jan  4 19:38:34 2004
From: phil at bubblehouse.org (Phil Christensen)
Date: Sun, 4 Jan 2004 21:38:34 -0500
Subject: [Twisted-Python] Encrypted PB?
In-Reply-To: <20040104231110.GA6428@pasternak.w.lub.pl>
References: <20040104223154.GB5515@pasternak.w.lub.pl> <3FF8C13A.6040200@csrules.dyndns.org> <20040104231110.GA6428@pasternak.w.lub.pl>
Message-ID: <41A66999-3F28-11D8-BCF4-003065D65744@bubblehouse.org>

it's not often i can answer any question on this list, so i hope i'm 
first ;-) ....

here's a snippet from some server code of mine that allows either SSL 
or plaintext sessions:

#If the user has selected secure, we only allow connections
#over SSL. The pyOpenSSL library must be installed for this
#to work.
if(config['secure']):
     contexts = ssl.DefaultOpenSSLContextFactory(config['key'], 
config['cert'])
     pb_service = internet.SSLServer(int(config['port']), 
pb.PBServerFactory(portal), contexts)
else:
     pb_service = internet.TCPServer(int(config['port']), 
pb.PBServerFactory(portal))
pb_service.setServiceParent(master_service)
reg_service.setServiceParent(master_service)


On Jan 4, 2004, at 6:11 PM, Michal Pasternak wrote:

> darryl [Sun, Jan 04, 2004 at 05:43:22PM -0800]:
>> Michal Pasternak wrote:
>>
>> SSL
>
> ... any examples?
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From matthew.s.hegedus at lmco.com  Mon Jan  5 06:41:52 2004
From: matthew.s.hegedus at lmco.com (Hegedus, Matthew S)
Date: Mon, 05 Jan 2004 07:41:52 -0600
Subject: [Twisted-Python] IRIX install
Message-ID: <401C60E417B68B48B14B53D845FF596A8D250F@EMSS07M12.us.lmco.com>

Greetings,

What's the official word on Twisted IRIX and UNIX installs? A fellow
co-worker informed me that she contacted someone from Twisted development
who told her that Twisted is not meant for UNIX or IRIX. Thanks,

Matthew



From bob at redivi.com  Mon Jan  5 06:58:56 2004
From: bob at redivi.com (Bob Ippolito)
Date: Mon, 5 Jan 2004 08:58:56 -0500
Subject: [Twisted-Python] IRIX install
In-Reply-To: <401C60E417B68B48B14B53D845FF596A8D250F@EMSS07M12.us.lmco.com>
References: <401C60E417B68B48B14B53D845FF596A8D250F@EMSS07M12.us.lmco.com>
Message-ID: <4E1BAE83-3F87-11D8-90C9-000A95686CD8@redivi.com>


On Jan 5, 2004, at 8:41 AM, Hegedus, Matthew S wrote:

> What's the official word on Twisted IRIX and UNIX installs? A fellow
> co-worker informed me that she contacted someone from Twisted 
> development
> who told her that Twisted is not meant for UNIX or IRIX. Thanks,

Are you sure she was talking about this Twisted?  Twisted works just 
about everywhere Python 2.2+ does.  If it doesn't work, file a bug, but 
it definitely should work on anything POSIX enough to have an "X" in 
the name.

-bob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20040105/5ee339fb/attachment-0002.bin>

From lists at webcrunchers.com  Mon Jan  5 19:59:26 2004
From: lists at webcrunchers.com (JD)
Date: Mon, 5 Jan 2004 18:59:26 -0800
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <20040103032031.GA14197@frobozz>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com> <20040102025208.GB11930@frobozz> <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com> <20040103032031.GA14197@frobozz>
Message-ID: <565F1944-3FF4-11D8-AECA-0030656C6B9E@webcrunchers.com>

On Jan 2, 2004, at 7:20 PM, Andrew Bennetts wrote:

> The only reason you should have for calling sendLine in an IRCClient
> subclass is to extend its functionality to support more of the 
> protocol than
> it already does.  IRCClient already has support for signing on (the
> 'register' method and the 'signedOn' handler), so you shouldn't use 
> sendLine
> for that.  IRCClient currently lacks some IRC features, such as WHO, 
> so to
> do those you do need sendLine.

That's what I thought.   Did you take a look at that code sample I sent 
earlier?
I hacked that up myself,  with few examples,  so I can see where i 
might have
put things in places they weren't intended to be.

I want to really learn Twisted,  and to be able to put pieces together 
without
having to be constantly digging for example code,  and twiddling with 
that.
>
> Also, good style suggests that you probably shouldn't mix your 
> application
> code with your IRCClient extensions, i.e. subclass IRCClient for WHO 
> support
> (and other other unimplemented commands you need), and then subclass 
> that
> for your application.

I don't quite understand.   Because in my case,  my application just 
intantiates
a client long enough to extract some information from the IRC server,  
issue
a "who" command and extract the data.

I always thought it was appropriate to sub-class the part i want to do, 
  or
parts that are not implemented by the parent,  as in my case of wanting
to do the "who" command,  so I treated the command like any other
IRC command that issues commands and gets back data.

So If I can't mix my application code with a sub_class of a IRCClient,  
then
how is the right way to do it.

John




From lists at webcrunchers.com  Mon Jan  5 20:02:15 2004
From: lists at webcrunchers.com (JD)
Date: Mon, 5 Jan 2004 19:02:15 -0800
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <20040103163247.GD14197@frobozz>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com> <20040102025208.GB11930@frobozz> <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com> <20040103032031.GA14197@frobozz> <20040103163247.GD14197@frobozz>
Message-ID: <BB0FB358-3FF4-11D8-AECA-0030656C6B9E@webcrunchers.com>

On Jan 3, 2004, at 8:32 AM, Andrew Bennetts wrote:

> On Sat, Jan 03, 2004 at 02:20:31PM +1100, I wrote:
>>
>> I don't understand what you're saying here.  You mean things like
>> irc_RPL_WHOISSERVER?

Yes,  exactly.

>>  That's just the way the prefixed getattr idiom works;
>> all you need to do is support a new command then define a handler 
>> method for it

I think I did that,   but not sure I did it right.    I sent a code 
fragment up to the list
earlier,   did you see how I did it?    Was I on the right track?

John




From andrew-twisted at puzzling.org  Mon Jan  5 20:28:25 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Tue, 6 Jan 2004 14:28:25 +1100
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <565F1944-3FF4-11D8-AECA-0030656C6B9E@webcrunchers.com>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com> <20040102025208.GB11930@frobozz> <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com> <20040103032031.GA14197@frobozz> <565F1944-3FF4-11D8-AECA-0030656C6B9E@webcrunchers.com>
Message-ID: <20040106032825.GA24218@frobozz>

On Mon, Jan 05, 2004 at 06:59:26PM -0800, JD wrote:
> 
> That's what I thought.   Did you take a look at that code sample I sent
> earlier?  I hacked that up myself,  with few examples,  so I can see where
> i might have put things in places they weren't intended to be.

I did.  The basic idea seemed fine, except for the trivial flaws I pointed
out.  I don't have time to test and debug your code for you, though,
especially when it's obvious you haven't tried to do so either.  If your
code isn't working, then it would help us if you could specify *how* it
isn't working, i.e. what error or misbehaviour you are seeing.  Your
previous mail didn't indicate that you'd tested the example code you sent
(and the trivial syntax errors suggest this is also the case).

> >Also, good style suggests that you probably shouldn't mix your 
> >application
> >code with your IRCClient extensions, i.e. subclass IRCClient for WHO 
> >support
> >(and other other unimplemented commands you need), and then subclass 
> >that
> >for your application.
> 
> I don't quite understand.   Because in my case,  my application just
> intantiates a client long enough to extract some information from the IRC
> server,  issue a "who" command and extract the data.
> 
> I always thought it was appropriate to sub-class the part i want to do, or
> parts that are not implemented by the parent,  as in my case of wanting to
> do the "who" command,  so I treated the command like any other IRC command
> that issues commands and gets back data.
> 
> So If I can't mix my application code with a sub_class of a IRCClient,
> then how is the right way to do it.

What I was trying to say is rather than subclass like this:

    IRCClient (from twisted.protocols.irc)
     |
     \--YourIRCApp (adds WHO command, has your application logic)

It might be a better idea to do it like this:

    IRCClient (from twisted.protocols.irc)
     |
     \--ExtendedIRCClient (adds WHO command)
         |
         \--YourIRCApp (has your application logic)

But that's really just a cosmetic issue.  In an ideal world, Twisted would
already have the WHO command implemented in its standard IRCClient.  Until
we reach that point, though, I still like the idea of keeping the protocol
implementation and the application using that protocol seperate, even if the
"protocol implementation" part of that picture is currently split between
what Twisted already provides (IRCClient) and what you need to add (what I
called ExtendedIRCClient above).

Or you could not implement WHO yourself at all, and use the more complete
IRC implementation in irc2.py...

-Andrew.




From Richard.Townsend at edl.uk.eds.com  Tue Jan  6 08:37:21 2004
From: Richard.Townsend at edl.uk.eds.com (Richard.Townsend at edl.uk.eds.com)
Date: Tue, 6 Jan 2004 15:37:21 -0000 
Subject: [Twisted-Python] Re: Re: Re: Resume FTP file retrieval
Message-ID: <68CF619C1F239A4A8BB8EDD3D1657DC827B248@ukhkc201>

Hi Andrew,
 
I have tried to follow the code in FTPClient. 
 
It looks like the _openDataConnection() method is responsible for sending
the PORT/PASV before the RETR. However, I'm not sure how it could be safely
modified to send a REST between the two requests.
 
I need this facility to be able to resume a partial download when
transferring large files over an unreliable comms link.
 
Would you or another of Twisted experts be able to help make this change?
 
thanks,
Richard Townsend
(2nd attempt to post this)
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20040106/4a3b24e2/attachment.html>

From exarkun at intarweb.us  Tue Jan  6 10:22:50 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Tue, 6 Jan 2004 12:22:50 -0500
Subject: ircLogBot (Was: [Twisted-Python] A Twisted Web Question....)
In-Reply-To: <E7856519-3B73-11D8-ADCB-0030656C6B9E@shopip.com>
References: <200312290100.49502.lstep@adequat.net> <F487D580-3999-11D8-8F12-0030656C6B9E@webcrunchers.com> <0700785A-39B9-11D8-9472-000393C9700E@twistedmatrix.com> <E7856519-3B73-11D8-ADCB-0030656C6B9E@shopip.com>
Message-ID: <20040106172250.GA8354@intarweb.us>

On Wed, Dec 31, 2003 at 01:29:59AM -0800, John Draper wrote:
> Hi, 
> 

  Hi.  Your mail client has decided that you are responding to a message in
a thread about Twisted Web.  It probably did this because you had that
message selected when you told it to compose mail, or because you selected
reply rather than compose.  Since your message is not actually about Twisted
Web, this is confusing and undesirable.  In the future, please pay more
attention to what you are asking your mail client to do, so that it is
easier to find and understand the question you are asking.

> I call your attention to: 
> 
> This was quoted in the Docs on the TwistedMatrix web site. 
> 
> Persistent Data in the Factory 
> 
> Since the Protocol instance is recreated each time the connection is 
> made, the client needs some way to keep track of data that should be 
> persisted. In the case of ircLogBot.py: (LogBot.log() just logs the 
> data to the file object stored in LogBot.file) 
> 
> it references a LogBot.log() call....   but I checked in ircLogBot.py 
> and there is NO log() 
> method,  nor is there one in any of the other classes it inherits from. 
> 
> Would it be too much of a bother if I were to ask anyone about this 
> descrepancy? 
> 

  Not at all.  It is true that the class has no log method, however, if you
examine the connectionMade method:

    def connectionMade(self):
        irc.IRCClient.connectionMade(self)
        self.logger = MessageLogger(open(self.factory.filename, "a"))
        self.log = self.logger.log
        self.log("[connected at %s]" % time.asctime(time.localtime(time.time())))

  you will see that instances of the class bind method from a *different* to
that name, allowing users of the class to use the method as if it were
defined by the LogBot class itself.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20040106/3b3675b7/attachment.sig>

From daedalus at eigenmagic.com  Tue Jan  6 22:47:45 2004
From: daedalus at eigenmagic.com (Justin Warren)
Date: Wed, 7 Jan 2004 16:47:45 +1100
Subject: [Twisted-Python] BEEPy - a Python BEEP library
Message-ID: <20040107054745.GA19868@snafu.eigenmagic.com>

Hi folks,

I'm relatively new to twisted, but I saw some discussion early in 2003
around BEEP and twisted lamenting the lack of a Python library. I hope
this is the right place to post.

I'm the developer of a library called BEEPy which is a BEEP
implementation written in pure Python. I recently redesigned the core
to use twisted for TCP and SSL comms, so I figured you folks might be
interested in it.

BEEPy is LGPL licensed and hosted over at sourceforge:
http://beepy.sourceforge.net/ for the curious.

A quick summary of features:
- Implemented using twisted Protocol and Factory subclasses
- Support for TLS for transport layer security
- Support for SASL ANONYMOUS and OTP mechanisms for authentication
- Implements the BEEP management profile
- Reference implementation of an echo profile
- Loads of example code

Cheers,

Justin

-- 
"Either way, it'll remind the clued that there's only one letter difference
 between "turkey" and "turnkey"." -- Mike Andrews in a.s.r



From itamar at itamarst.org  Tue Jan  6 23:13:14 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 07 Jan 2004 01:13:14 -0500
Subject: [Twisted-Python] BEEPy - a Python BEEP library
In-Reply-To: <20040107054745.GA19868@snafu.eigenmagic.com>
References: <20040107054745.GA19868@snafu.eigenmagic.com>
Message-ID: <1073455994.3353.2.camel@sheriffpony>

On Wed, 2004-01-07 at 00:47, Justin Warren wrote:

> I'm the developer of a library called BEEPy which is a BEEP
> implementation written in pure Python. I recently redesigned the core
> to use twisted for TCP and SSL comms, so I figured you folks might be
> interested in it.

Indeed!

I've been meaning to look into BEEP again, so it'll be nice to be able
to look at Twisted implementation. I'll add you to our list of open
source projects using Twisted.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From exarkun at intarweb.us  Tue Jan  6 23:26:09 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Wed, 7 Jan 2004 01:26:09 -0500
Subject: [Twisted-Python] BEEPy - a Python BEEP library
In-Reply-To: <20040107054745.GA19868@snafu.eigenmagic.com>
References: <20040107054745.GA19868@snafu.eigenmagic.com>
Message-ID: <20040107062609.GA10915@intarweb.us>

On Wed, Jan 07, 2004 at 04:47:45PM +1100, Justin Warren wrote:
> Hi folks,
> 
> I'm relatively new to twisted, but I saw some discussion early in 2003
> around BEEP and twisted lamenting the lack of a Python library. I hope
> this is the right place to post.
> 
> I'm the developer of a library called BEEPy which is a BEEP
> implementation written in pure Python. I recently redesigned the core
> to use twisted for TCP and SSL comms, so I figured you folks might be
> interested in it.
> 
> BEEPy is LGPL licensed and hosted over at sourceforge:
> http://beepy.sourceforge.net/ for the curious.
> 
> A quick summary of features:
> - Implemented using twisted Protocol and Factory subclasses
> - Support for TLS for transport layer security
> - Support for SASL ANONYMOUS and OTP mechanisms for authentication
> - Implements the BEEP management profile
> - Reference implementation of an echo profile
> - Loads of example code
> 
> Cheers,
> 

  Very cool to hear :)  It's late and I'm on my way to bed, so I'll probably
download this tomorrow and take a look.  One thing I would have liked to see
on the web page is some html documentation, at least of the APIs.  Any
chance of getting something like that up (via epydoc or whatever)?

  Jp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20040107/92bad68f/attachment.sig>

From daedalus at eigenmagic.com  Wed Jan  7 00:06:06 2004
From: daedalus at eigenmagic.com (Justin Warren)
Date: Wed, 7 Jan 2004 18:06:06 +1100
Subject: [Twisted-Python] BEEPy - a Python BEEP library
In-Reply-To: <20040107062609.GA10915@intarweb.us>
References: <20040107054745.GA19868@snafu.eigenmagic.com> <20040107062609.GA10915@intarweb.us>
Message-ID: <20040107070606.GB19868@snafu.eigenmagic.com>

On Wed, Jan 07, 2004 at 01:26:09AM -0500, Jp Calderone wrote:
> On Wed, Jan 07, 2004 at 04:47:45PM +1100, Justin Warren wrote:

> > I'm the developer of a library called BEEPy which is a BEEP
> > implementation written in pure Python. I recently redesigned the core
> > to use twisted for TCP and SSL comms, so I figured you folks might be
> > interested in it.

>   Very cool to hear :)  It's late and I'm on my way to bed, so I'll probably
> download this tomorrow and take a look.  One thing I would have liked to see
> on the web page is some html documentation, at least of the APIs.  Any
> chance of getting something like that up (via epydoc or whatever)?

Probably, but not soon. The move to twisted involved a pretty major
overhaul of the API. Like most lazy developers, I've concentrated on
the code rather than writing good doco. :)

I've never used epydoc before, but it looks nice from first
impressions. I'll check it out and get cracking on some doco.

-- 
"Compared to system administration, being cursed forever is a step up."
                                        - Paul Tomko in the Monastery



From daedalus at eigenmagic.com  Wed Jan  7 00:06:59 2004
From: daedalus at eigenmagic.com (Justin Warren)
Date: Wed, 7 Jan 2004 18:06:59 +1100
Subject: [Twisted-Python] BEEPy - a Python BEEP library
In-Reply-To: <1073455994.3353.2.camel@sheriffpony>
References: <20040107054745.GA19868@snafu.eigenmagic.com> <1073455994.3353.2.camel@sheriffpony>
Message-ID: <20040107070659.GC19868@snafu.eigenmagic.com>

On Wed, Jan 07, 2004 at 01:13:14AM -0500, Itamar Shtull-Trauring wrote:
> On Wed, 2004-01-07 at 00:47, Justin Warren wrote:
> 
> > I'm the developer of a library called BEEPy which is a BEEP
> > implementation written in pure Python. I recently redesigned the core
> > to use twisted for TCP and SSL comms, so I figured you folks might be
> > interested in it.
> 
> Indeed!
> 
> I've been meaning to look into BEEP again, so it'll be nice to be able
> to look at Twisted implementation. I'll add you to our list of open
> source projects using Twisted.

w00t! Thanks very much!

-- 
"I wouldn't be surprised if this were a typo, and Shmuel meant to
write "ARF -A" to see what other dogs would answer when he barked."
  -- Mike Andrews in a.s.r



From matteo.giacomazzi at email.it  Wed Jan  7 03:52:34 2004
From: matteo.giacomazzi at email.it (Matteo Giacomazzi)
Date: Wed, 7 Jan 2004 11:52:34 +0100
Subject: [Twisted-Python] UNIX socket problem
Message-ID: <2712163625.20040107115234@email.it>

Hello,

  I have a problem with a TAP using UNIX socket.
  On  one  server  it  works  fine, on another one it raises a strange
  exception, here is the trace if someone can help...
  I  can't  understand  why  self.factory,  where  self  should  be  a
  unix.Connector  instance,  get an int value instead of the factory I
  provide. And, in any case, I cannot understand why it happens on one
  server but not in another one (same Python and Twisted version).
  Thanks!

2004/01/07 11:44 CET [-] Traceback (most recent call last):
2004/01/07 11:44 CET [-]   File "/usr/bin/twistd", line 36, in ?
2004/01/07 11:44 CET [-]     run()
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/scripts/twistd.py", line 188, in run
2004/01/07 11:44 CET [-]     app.run(runApp, ServerOptions)
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/application/app.py", line 200, in run
2004/01/07 11:44 CET [-]     runApp(config)
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/scripts/twistd.py", line 179, in runApp
2004/01/07 11:44 CET [-]     startApplication(config, application)
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/scripts/twistd.py", line 165, in startApplication
2004/01/07 11:44 CET [-]     app.startApplication(application, not config['no_save'])
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/application/app.py", line 220, in startApplication
2004/01/07 11:44 CET [-]     service.IService(application).startService()
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/application/service.py", line 194, in startService
2004/01/07 11:44 CET [-]     service.startService()
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/application/service.py", line 194, in startService
2004/01/07 11:44 CET [-]     service.startService()
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/application/internet.py", line 81, in startService
2004/01/07 11:44 CET [-]     self._connection = self._getConnection()
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/application/internet.py", line 89, in _getConnection
2004/01/07 11:44 CET [-]     return getattr(reactor, 'connect'+self.method)(*self.args,
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/internet/default.py", line 232, in connectUNIX
2004/01/07 11:44 CET [-]     c.connect()
2004/01/07 11:44 CET [-]   File "/usr/lib/python2.3/site-packages/twisted/internet/base.py", line 553, in connect
2004/01/07 11:44 CET [-]     self.factory.doStart()
2004/01/07 11:44 CET [-] AttributeError: 'int' object has no attribute 'doStart'  


Kindest regards,
 Matteo




From andrew-twisted at puzzling.org  Wed Jan  7 06:17:33 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 8 Jan 2004 00:17:33 +1100
Subject: [Twisted-Python] Re: XML Parsing Error in tutorial.xhtml
In-Reply-To: <bss3jb$fpd$1@sea.gmane.org>
References: <bskjqb$bba$1@sea.gmane.org> <20031230022616.GA1043@frobozz> <bss3jb$fpd$1@sea.gmane.org>
Message-ID: <20040107131733.GD29053@frobozz>

On Tue, Dec 30, 2003 at 03:52:17PM +0100, Anton Vredegoor wrote:
> 
> By the way, the tutorial uses a finger server as its example but the
> Windows 98SE machines don't have a finger client, not even if using
> Cygwin. I knew about learning curves, but nobody informed me about the
> rocks along the slope :-)

That's a good point... we should probably mention in the tute somewhere that
you can use telnet as a poor mans finger client, for people on operating
systems that aren't blessed with finger(1).  Win98SE does have a telnet
client, I hope?

-Andrew.




From andrew-twisted at puzzling.org  Wed Jan  7 06:30:06 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Thu, 8 Jan 2004 00:30:06 +1100
Subject: [Twisted-Python] Re: Re: Re: Resume FTP file retrieval
In-Reply-To: <68CF619C1F239A4A8BB8EDD3D1657DC827B248@ukhkc201>
References: <68CF619C1F239A4A8BB8EDD3D1657DC827B248@ukhkc201>
Message-ID: <20040107133006.GE29053@frobozz>

On Tue, Jan 06, 2004 at 03:37:21PM -0000, Richard.Townsend at edl.uk.eds.com wrote:
>    Hi Andrew,
>     
>    I have tried to follow the code in FTPClient.

You're brave ;)

>    It looks like the  _openDataConnection() method is responsible for sending
>    the PORT/PASV  before the RETR. However, I'm not sure how it could be
>    safely modified  to send a REST between the two requests.

You've found the right spot -- but as you've probably noticed, it's probably
the hairiest code in the entire class.

>    I need this facility to be able to resume a partial download when 
>    transferring large files over an unreliable comms link.
>     
>    Would you or another of Twisted experts be able to help make this change?

I've attached a completely untested patch!  Let me know how it goes.

-Andrew.

-------------- next part --------------
Index: twisted/protocols/ftp.py
===================================================================
RCS file: /cvs/Twisted/twisted/protocols/ftp.py,v
retrieving revision 1.100
diff -u -r1.100 ftp.py
--- twisted/protocols/ftp.py	13 Dec 2003 01:12:09 -0000	1.100
+++ twisted/protocols/ftp.py	7 Jan 2004 13:28:09 -0000
@@ -1706,13 +1706,13 @@
         else:
             return None
 
-    def receiveFromConnection(self, command, protocol):
+    def receiveFromConnection(self, commands, protocol):
         """
         Retrieves a file or listing generated by the given command,
         feeding it to the given protocol.
 
-        @param command: string of an FTP command to execute then receive the
-            results of (e.g. LIST, RETR)
+        @param command: list of strings of FTP commands to execute then receive
+            the results of (e.g. LIST, RETR)
         @param protocol: A L{Protocol} *instance* e.g. an
             L{FTPFileListProtocol}, or something that can be adapted to one.
             Typically this will be an L{IConsumer} implemenation.
@@ -1721,9 +1721,9 @@
         """
         protocol = IProtocol(protocol)
         wrapper = ProtocolWrapper(protocol, Deferred())
-        return self._openDataConnection(command, wrapper)
+        return self._openDataConnection(commands, wrapper)
 
-    def sendToConnection(self, command):
+    def sendToConnection(self, commands):
         """XXX
         
         @returns: A tuple of two L{Deferred}s:
@@ -1733,14 +1733,15 @@
                   - L{Deferred} list of control-connection responses.
         """
         s = SenderProtocol()
-        r = self._openDataConnection(command, s)
+        r = self._openDataConnection(commands, s)
         return (s.connectedDeferred, r)
 
-    def _openDataConnection(self, command, protocol):
+    def _openDataConnection(self, commands, protocol):
         """
         This method returns a DeferredList.
         """
-        cmd = FTPCommand(command, public=1)
+        cmds = [FTPCommand(command, public=1) for command in commands]
+        cmdsDeferred = DeferredList([cmd.deferred for cmd in cmds])
 
         if self.passive:
             # Hack: use a mutable object to sneak a variable out of the 
@@ -1766,7 +1767,7 @@
             self.queueCommand(pasvCmd)
             pasvCmd.deferred.addCallback(doPassive).addErrback(self.fail)
 
-            results = [cmd.deferred, pasvCmd.deferred, protocol.deferred]
+            results = [cmdsDeferred, pasvCmd.deferred, protocol.deferred]
             d = DeferredList(results, fireOnOneErrback=1)
 
             # Ensure the connection is always closed
@@ -1799,12 +1800,13 @@
             portCmd.fail = lambda error: error
             
             # Ensure that the connection always gets closed
-            cmd.deferred.addErrback(lambda e, pc=portCmd: pc.fail(e) or e)
+            cmdsDeferred.addErrback(lambda e, pc=portCmd: pc.fail(e) or e)
 
-            results = [cmd.deferred, portCmd.deferred, portCmd.transferDeferred]
+            results = [cmdsDeferred, portCmd.deferred, portCmd.transferDeferred]
             d = DeferredList(results, fireOnOneErrback=1)
                               
-        self.queueCommand(cmd)
+        for cmd in cmds:
+            self.queueCommand(cmd)
         return d
 
     def generatePortCommand(self, portCmd):
@@ -1845,7 +1847,7 @@
         # Escape newline characters
         return string.replace(path, '\n', '\0')
 
-    def retrieveFile(self, path, protocol):
+    def retrieveFile(self, path, protocol, offset=0):
         """Retrieve a file from the given path
 
         This method issues the 'RETR' FTP command.
@@ -1855,14 +1857,18 @@
 
         @param path: path to file that you wish to receive.
         @param protocol: a L{Protocol} instance.
+        @param offset: offset to start downloading from
 
         @returns: L{Deferred}
         """
-        return self.receiveFromConnection('RETR ' + self.escapePath(path), protocol)
+        cmds = ['RETR ' + self.escapePath(path)]
+        if offset:
+            cmds.insert(0, ('REST ' + str(offset))
+        return self.receiveFromConnection(, protocol)
 
     retr = retrieveFile
 
-    def storeFile(self, path):
+    def storeFile(self, path, offset=0):
         """Store a file at the given path.
 
         This method issues the 'STOR' FTP command.
@@ -1873,8 +1879,10 @@
                     is completely transferred.
                   - L{Deferred} list of control-connection responses.
         """
-        
-        return self.sendToConnection('STOR ' + self.escapePath(path))
+        cmds = ['STOR ' + self.escapePath(path)]
+        if offset:
+            cmds.insert(0, ('REST ' + str(offset))
+        return self.sendToConnection(cmds)
 
     stor = storeFile
         

From bob at redivi.com  Wed Jan  7 06:34:24 2004
From: bob at redivi.com (Bob Ippolito)
Date: Wed, 7 Jan 2004 08:34:24 -0500
Subject: [Twisted-Python] BEEPy - a Python BEEP library
In-Reply-To: <20040107054745.GA19868@snafu.eigenmagic.com>
References: <20040107054745.GA19868@snafu.eigenmagic.com>
Message-ID: <3513EC08-4116-11D8-B0D7-000A95686CD8@redivi.com>


On Jan 7, 2004, at 12:47 AM, Justin Warren wrote:

> I'm relatively new to twisted, but I saw some discussion early in 2003
> around BEEP and twisted lamenting the lack of a Python library. I hope
> this is the right place to post.
>
> I'm the developer of a library called BEEPy which is a BEEP
> implementation written in pure Python. I recently redesigned the core
> to use twisted for TCP and SSL comms, so I figured you folks might be
> interested in it.
>
> BEEPy is LGPL licensed and hosted over at sourceforge:
> http://beepy.sourceforge.net/ for the curious.

Neat!

I've heard Apple's new Xgrid cluster-communication-stuff is based on 
XML property lists on top of BEEP.  Might be worth my time to look into 
reverse engineering it now that this exists :)

-bob
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20040107/c40fbb54/attachment-0002.bin>

From matteo.giacomazzi at email.it  Wed Jan  7 07:28:24 2004
From: matteo.giacomazzi at email.it (Matteo Giacomazzi)
Date: Wed, 7 Jan 2004 15:28:24 +0100
Subject: [Twisted-Python] UNIX socket problem
In-Reply-To: <2712163625.20040107115234@email.it>
References: <2712163625.20040107115234@email.it>
Message-ID: <1041917046.20040107152824@email.it>

Hello,

>   I have a problem with a TAP using UNIX socket.
[snip]

Just  re-checking-out  my  sources  from  CVS  repository  solved  the
problem.
Many apologizes.

Regards,
 Matteo




From marjancinober at hotmail.com  Thu Jan  8 08:14:47 2004
From: marjancinober at hotmail.com (marjan cinober)
Date: Thu, 08 Jan 2004 16:14:47 +0100
Subject: [Twisted-Python] Re: examples/row_example.py  DBError Row object not in cache
Message-ID: <Sea1-F152WrwjvzWvTl0004c2aa@hotmail.com>

Hello

Thank you Dave for your fast reply, but it seems like I haven't managed to 
get rid of the problem by syncing with current CVS (today). And upgrading 
from Twisted 1.1.0 to 1.1.1 on Debian sarge - testing

Eroor message looks exactly the same
--- <exception caught here> ---
  File "/usr/lib/python2.3/site-packages/twisted/internet/defer.py", line 
308, in _runCallbacks
    self.result = callback(self.result, *args, **kw)
  File "./row_example.py", line 58, in onInsert
    manager.deleteRow(newRoom).addCallback(onDelete)
  File 
"/usr/lib/python2.3/site-packages/twisted/enterprise/sqlreflector.py", line 
330, in deleteRow
    self.removeFromCache(rowObject)
  File "/usr/lib/python2.3/site-packages/twisted/enterprise/reflector.py", 
line 141, in removeFromCache
    raise DBError("Row object not in cache: %s", rowObject)
twisted.enterprise.util.DBError: ('Row object not in cache: %s', <Room 
#100001: newRoom1 (fred) (100,100)>)

On Sun, 04 Jan 2004 11:00:20, Dave Peticolas wrote:
>Re: examples/row_example.py  DBError Row object not in cache
>On Sat, 2004-01-03 at 11:13, marjan cinober wrote:
> > Still trying to test some postgersql access from twisted.
> > Unfortunate at running example ROW (Twisted Enterprise)
> > http://twistedmatrix.com/documents/examples/row_example.py
> >
> > got stuck at
> >   File "row_example.py", line 58, in onInsert
> >     manager.deleteRow(newRoom).addCallback(onDelete)
> >
> > Anybody has some clues?
>
>This was a bug. It should be fixed in CVS.
>
>dave

_________________________________________________________________
Tired of spam? Get advanced junk mail protection with MSN 8. 
http://join.msn.com/?page=features/junkmail




From Richard.Townsend at edl.uk.eds.com  Thu Jan  8 07:38:04 2004
From: Richard.Townsend at edl.uk.eds.com (Richard.Townsend at edl.uk.eds.com)
Date: Thu, 8 Jan 2004 14:38:04 -0000 
Subject: [Twisted-Python] Re: Re: Re: Resume FTP file retrieval
Message-ID: <68CF619C1F239A4A8BB8EDD3D1657DC827B24A@ukhkc201>

Hi Andrew,
 
Many thanks for the patch.
 
I had to fix 3 typos to get it to run:
 
Line 1867 needs an extra closing parenthesis:
             cmds.insert(0, ('REST ' + str(offset)))
 
Line 1868 needs the missing 'cmds' parameter:
         return self.receiveFromConnection(cmds, protocol)
 
Line 1885 needs an extra closing parenthesis:
             cmds.insert(0, ('REST ' + str(offset)))
 
My test program then successfully did a partial download!
 
Best regards,
Richard Townsend
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20040108/2c125c73/attachment.html>

From xpythonist at yahoo.com.br  Thu Jan  8 10:59:40 2004
From: xpythonist at yahoo.com.br (=?iso-8859-1?q?Aloysio=20Figueiredo?=)
Date: Thu, 8 Jan 2004 14:59:40 -0300 (ART)
Subject: [Twisted-Python] twisted.conch.ssh.filetransfer example...
In-Reply-To: <3513EC08-4116-11D8-B0D7-000A95686CD8@redivi.com>
Message-ID: <20040108175940.36573.qmail@web21507.mail.yahoo.com>

I need to transfer a file via ssh.
twisted.conch.ssh.filetransfer seems to be a way to do
that, but it's not documented and I couldn't figure
out how to use it. Could anyone point a short example
(here or in the web) ?

Thanks in advance,
Aloysio Figueiredo

______________________________________________________________________

Conhea a nova central de informaes anti-spam do Yahoo! Mail:
http://www.yahoo.com.br/antispam



From lists at webcrunchers.com  Thu Jan  8 14:04:18 2004
From: lists at webcrunchers.com (JD)
Date: Thu, 8 Jan 2004 13:04:18 -0800
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <20040106032825.GA24218@frobozz>
References: <3FF120BE.3010504@paradise.net.nz> <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com> <20040102025208.GB11930@frobozz> <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com> <20040103032031.GA14197@frobozz> <565F1944-3FF4-11D8-AECA-0030656C6B9E@webcrunchers.com> <20040106032825.GA24218@frobozz>
Message-ID: <3944330C-421E-11D8-AECA-0030656C6B9E@webcrunchers.com>

On Jan 5, 2004, at 7:28 PM, Andrew Bennetts wrote:

> On Mon, Jan 05, 2004 at 06:59:26PM -0800, JD wrote:
>>
>> That's what I thought.   Did you take a look at that code sample I 
>> sent
>> earlier?  I hacked that up myself,  with few examples,  so I can see 
>> where
>> i might have put things in places they weren't intended to be.
>
> I did.  The basic idea seemed fine, except for the trivial flaws I 
> pointed
> out.  I don't have time to test and debug your code for you, though,
> especially when it's obvious you haven't tried to do so either.  If 
> your
> code isn't working, then it would help us if you could specify *how* it
> isn't working, i.e. what error or misbehaviour you are seeing.  Your
> previous mail didn't indicate that you'd tested the example code you 
> sent
> (and the trivial syntax errors suggest this is also the case).

Don't worry about the code....   it was put up there to only show to
general construct,  and how I plan to put things together.   it was a 
simple
lame example totally different then what my intended APP was going to
be,   I just used that just to illustrate to others,  my understanding, 
  or
lack thereof..
>
>>> Also, good style suggests that you probably shouldn't mix your
>>> application
>>> code with your IRCClient extensions, i.e. subclass IRCClient for WHO
>>> support
>>> (and other other unimplemented commands you need), and then subclass
>>> that
>>> for your application.
>>
>> I don't quite understand.   Because in my case,  my application just
>> intantiates a client long enough to extract some information from the 
>> IRC
>> server,  issue a "who" command and extract the data.
>>
>> I always thought it was appropriate to sub-class the part i want to 
>> do, or
>> parts that are not implemented by the parent,  as in my case of 
>> wanting to
>> do the "who" command,  so I treated the command like any other IRC 
>> command
>> that issues commands and gets back data.
>>
>> So If I can't mix my application code with a sub_class of a IRCClient,
>> then how is the right way to do it.
>
> What I was trying to say is rather than subclass like this:
>
>     IRCClient (from twisted.protocols.irc)
>      |
>      \--YourIRCApp (adds WHO command, has your application logic)
>
> It might be a better idea to do it like this:
>
>     IRCClient (from twisted.protocols.irc)
>      |
>      \--ExtendedIRCClient (adds WHO command)
>          |
>          \--YourIRCApp (has your application logic)

I've already decided that....    because when I first started to use
Twisted,  I had no clue of even the existance of ExtendedIRCClient
because it was so cleverly mis-labeled and hidden so well in the
examples,  I never would have found it,  had I not posted this in
the first place.

John




From cygnus at cprogrammer.org  Thu Jan  8 14:39:39 2004
From: cygnus at cprogrammer.org (Jonathan Daugherty)
Date: Thu, 8 Jan 2004 16:39:39 -0500
Subject: [Twisted-Python] wxreactor
Message-ID: <20040108213939.GA12742@mail.theserver.ath.cx>

I'm using debian unstable, twisted version 1.1.1-1, python 2.3.

I'm running a wxPython demo script from the twisted site which
uses the wxreactor; it will not run, and it cannot import the
wxreactor.

The error, as one would expect, is:

File "test.py", line 20, in ?
  from twisted.internet import wxreactor
ImportError: cannot import name wxreactor

A search of the python2.3-twisted package and wxsupport.py file
indicates no such entity exists.  However, I know that a wxreactor
has been in development: is this merely a limitation of the debian
package I am using, or has it not yet been introduced into the
release?

Thanks!

-- 

  Jonathan Daugherty
  http://www.cprogrammer.org

  "It's a book about a Spanish guy called Manual, you should read it."
                                                            -- Dilbert



From itamar at itamarst.org  Thu Jan  8 14:47:58 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 08 Jan 2004 16:47:58 -0500
Subject: [Twisted-Python] wxreactor
In-Reply-To: <20040108213939.GA12742@mail.theserver.ath.cx>
References: <20040108213939.GA12742@mail.theserver.ath.cx>
Message-ID: <1073598478.6561.10.camel@sheriffpony>

On Thu, 2004-01-08 at 16:39, Jonathan Daugherty wrote:

> A search of the python2.3-twisted package and wxsupport.py file
> indicates no such entity exists.  However, I know that a wxreactor
> has been in development: is this merely a limitation of the debian
> package I am using, or has it not yet been introduced into the
> release?

Hmmm. Maybe I added wxreactor after version 1.1.1? There's no
twisted/internet/wxreactor.py in your install? There should be.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From cygnus at cprogrammer.org  Thu Jan  8 14:55:23 2004
From: cygnus at cprogrammer.org (Jonathan Daugherty)
Date: Thu, 8 Jan 2004 16:55:23 -0500
Subject: [Twisted-Python] wxreactor
In-Reply-To: <1073598478.6561.10.camel@sheriffpony>
References: <20040108213939.GA12742@mail.theserver.ath.cx> <1073598478.6561.10.camel@sheriffpony>
Message-ID: <20040108215523.GA12847@mail.theserver.ath.cx>

# Hmmm. Maybe I added wxreactor after version 1.1.1? There's no
# twisted/internet/wxreactor.py in your install? There should be.

$ dpkg -L python2.3-twisted | grep -i reactor
/usr/lib/python2.3/site-packages/twisted/internet/cfreactor.py
/usr/lib/python2.3/site-packages/twisted/internet/gladereactor.py
/usr/lib/python2.3/site-packages/twisted/internet/gtk2reactor.py
/usr/lib/python2.3/site-packages/twisted/internet/gtkreactor.py
/usr/lib/python2.3/site-packages/twisted/internet/javareactor.py
/usr/lib/python2.3/site-packages/twisted/internet/kqreactor.py
/usr/lib/python2.3/site-packages/twisted/internet/pollreactor.py
/usr/lib/python2.3/site-packages/twisted/internet/qtreactor.py
/usr/lib/python2.3/site-packages/twisted/internet/reactor.py
/usr/lib/python2.3/site-packages/twisted/internet/win32eventreactor.py

-- 

  Jonathan Daugherty
  http://www.cprogrammer.org

  "It's a book about a Spanish guy called Manual, you should read it."
                                                            -- Dilbert



From itamar at itamarst.org  Thu Jan  8 15:03:54 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 08 Jan 2004 17:03:54 -0500
Subject: [Twisted-Python] wxreactor
In-Reply-To: <20040108215523.GA12847@mail.theserver.ath.cx>
References: <20040108213939.GA12742@mail.theserver.ath.cx>
	 <1073598478.6561.10.camel@sheriffpony>
	 <20040108215523.GA12847@mail.theserver.ath.cx>
Message-ID: <1073599433.6558.12.camel@sheriffpony>

Yep, looks like it's only included in 1.1.2 (which hopefully will be out
soon).




From cygnus at cprogrammer.org  Thu Jan  8 15:10:29 2004
From: cygnus at cprogrammer.org (Jonathan Daugherty)
Date: Thu, 8 Jan 2004 17:10:29 -0500
Subject: [Twisted-Python] wxreactor
In-Reply-To: <1073599433.6558.12.camel@sheriffpony>
References: <20040108213939.GA12742@mail.theserver.ath.cx> <1073598478.6561.10.camel@sheriffpony> <20040108215523.GA12847@mail.theserver.ath.cx> <1073599433.6558.12.camel@sheriffpony>
Message-ID: <20040108221029.GB13109@mail.theserver.ath.cx>

# Yep, looks like it's only included in 1.1.2 (which hopefully will be out
# soon).

Ok, thanks! :-D

-- 

  Jonathan Daugherty
  http://www.cprogrammer.org

  "It's a book about a Spanish guy called Manual, you should read it."
                                                            -- Dilbert



From matteo.giacomazzi at email.it  Thu Jan  8 15:20:18 2004
From: matteo.giacomazzi at email.it (Matteo Giacomazzi)
Date: Thu, 8 Jan 2004 23:20:18 +0100
Subject: [Twisted-Python] wxreactor
In-Reply-To: <1073599433.6558.12.camel@sheriffpony>
References: <20040108213939.GA12742@mail.theserver.ath.cx>
 <1073598478.6561.10.camel@sheriffpony>
 <20040108215523.GA12847@mail.theserver.ath.cx>
 <1073599433.6558.12.camel@sheriffpony>
Message-ID: <12230138140.20040108232018@email.it>

Hi Itamar,

> Yep, looks like it's only included in 1.1.2 (which hopefully will be
> out soon).

Yes,  confirmed:  I had to download it from the CVS repository (it has
changed a bit since your post in ML).

Regards,
 Matteo




From cygnus at cprogrammer.org  Thu Jan  8 15:49:56 2004
From: cygnus at cprogrammer.org (Jonathan Daugherty)
Date: Thu, 8 Jan 2004 17:49:56 -0500
Subject: [Twisted-Python] wxreactor
In-Reply-To: <1073599433.6558.12.camel@sheriffpony>
References: <20040108213939.GA12742@mail.theserver.ath.cx> <1073598478.6561.10.camel@sheriffpony> <20040108215523.GA12847@mail.theserver.ath.cx> <1073599433.6558.12.camel@sheriffpony>
Message-ID: <20040108224956.GA13329@mail.theserver.ath.cx>

# Yep, looks like it's only included in 1.1.2 (which hopefully will be out
# soon).

Just out of curiosity: do you have any general idea as to the approximate
release date for 1.1.2?

-- 

  Jonathan Daugherty
  http://www.cprogrammer.org

  "It's a book about a Spanish guy called Manual, you should read it."
                                                            -- Dilbert



From reapnow at excite.com  Thu Jan  8 16:14:07 2004
From: reapnow at excite.com (Patrick Gilmartin)
Date: Thu,  8 Jan 2004 18:14:07 -0500 (EST)
Subject: [Twisted-Python] Newbie Question about PB and Firewalls
Message-ID: <20040108231407.B4D25109EB9@xprdmailfe1.nwk.excite.com>



I have been reviewing Twisted site and documentation fairly extensive for the past couple of months.  

I have just downloaded it to start working with it, but before I get started there are some answers I seek that will really help in my overall plans.

>From all the reading I have done, it looks like PB would be the optimal protocol for me to use.  I understand where I have decision making power at both ends of the line, I can modify the Firewalls settings to accommodate the port(s).  

But I know I will have situations where the client side will be behind a firewall where I do manage the decision making process.  One of the reasons why XML-RPC and SOAP are broadly popular choices is that they are over HTTP.  

Given the above situation about Firewall settings where I have no control, is my assumption correct that the PB protocol is not an option for me.

Thanks in advance for your help.

Patrick

_______________________________________________
Join Excite! - http://www.excite.com
The most personalized portal on the Web!



From andrew-twisted at puzzling.org  Thu Jan  8 16:47:27 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Fri, 9 Jan 2004 10:47:27 +1100
Subject: [Twisted-Python] Re: Re: Re: Resume FTP file retrieval
In-Reply-To: <68CF619C1F239A4A8BB8EDD3D1657DC827B24A@ukhkc201>
References: <68CF619C1F239A4A8BB8EDD3D1657DC827B24A@ukhkc201>
Message-ID: <20040108234727.GA3825@frobozz>

On Thu, Jan 08, 2004 at 02:38:04PM -0000, Richard.Townsend at edl.uk.eds.com wrote:
>    Hi Andrew,
>     
>    Many thanks for the patch.
>     
>    I had to fix 3 typos to get it to run:

Thanks!

[...]
>    My test program then successfully did a partial download!

Wow!  That's a much better result than I was expecting :)

I'll check in the fixed patch later tonight.

-Andrew.




From teratorn at world-net.net  Thu Jan  8 20:05:59 2004
From: teratorn at world-net.net (Eric Mangold)
Date: Thu, 8 Jan 2004 20:05:59 -0700
Subject: [Twisted-Python] Re: Newbie Question about PB and Firewalls
In-Reply-To: <20040108231407.B4D25109EB9@xprdmailfe1.nwk.excite.com>
References: <20040108231407.B4D25109EB9@xprdmailfe1.nwk.excite.com>
Message-ID: <200401082006.00230.teratorn@world-net.net>

On Thursday 08 January 2004 04:14 pm, Patrick Gilmartin wrote:
> I have been reviewing Twisted site and documentation fairly extensive
> for the past couple of months.
>
> I have just downloaded it to start working with it, but before I get
> started there are some answers I seek that will really help in my
> overall plans.
>
> From all the reading I have done, it looks like PB would be the
> optimal protocol for me to use.  I understand where I have decision
> making power at both ends of the line, I can modify the Firewalls
> settings to accommodate the port(s).
>
> But I know I will have situations where the client side will be
> behind a firewall where I do manage the decision making process.

If it's the client side it shouldn't have a problem connecting out to 
the Internet.

Or perhaps the firewall only allows certain outbound ports? If a user is 
running such a firewall setup they pretty much need to be able to allow 
more ports as needed.

>One
> of the reasons why XML-RPC and SOAP are broadly popular choices is
> that they are over HTTP.

They're the same as far as crossing firewalls is concerned.

>
> Given the above situation about Firewall settings where I have no
> control, is my assumption correct that the PB protocol is not an
> option for me.

No, probably not, but I don't think I understand your problem.

>
> Thanks in advance for your help.
>
> Patrick
>
> _______________________________________________
> Join Excite! - http://www.excite.com
> The most personalized portal on the Web!
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python







From pyp at gmx.net  Thu Jan  8 21:16:12 2004
From: pyp at gmx.net (Mike Mueller)
Date: Fri, 09 Jan 2004 05:16:12 +0100
Subject: [Twisted-Python] how to get form values in woven?
Message-ID: <5.2.1.1.1.20040109045850.022e2590@pop.gmx.net>

I am just starting with woven. I couldn't find a simple example how to get 
the values from a submitted form. Reading the HOWTOs and searching the 
twisted mail archives as well as web didn't bring up what I was searching for.

An example:

from twisted.application import service, internet
from twisted.web.woven import page
from twisted.web import server, resource

class FirstPage(page.Page):
     template = """<html>
         <head>
         <title>First Form</title>
         </head>
         <body>
           <h3>First Form</h3>
           <form action="processMyForm" method="post">
           <p>
           Text1:
           <input type="text" id="Text1"/><br/>
           Text2:
           <input type="text" id="Text2"/><br/>
           <input type="submit" value="Send"/>
           </p>
           </form>
         </body>
       </html>
     """
     def initialize(self, *args, **kwargs):
         self.numberOfProcessCalls = 0
     def wchild_processMyForm(self, request):
         self.numberOfProcessCalls += 1
         keysValues = []
         for k, v in request.__dict__.items():
             keysValues.append('%s:\t %s' %(k,v))
         model = {'keys-values': keysValues,
                  'number':self.numberOfProcessCalls}
         return page.Page(model, template=
                          """<html>
                              <body>
                              Number of calls:
                              <p model="number" view="Text" />
                              <h3>arg keys: values</h3>
                              <div model="keys-values" view="List">
                                 <p pattern="listItem" view="Text" />
                              </div>
                              </body>
                              </html>""")

p = FirstPage()
application = service.Application('SimpleForm')
internet.TCPServer(8088, 
server.Site(resource.IResource(p))).setServiceParent(service.IServiceCollection(application))

There are several problems with this.

1.) wchild_processMyForm gets called twice every time the submit button is hit
2.) for the first call the method is post for, the second it is get
3.) arg is always {}, so nothing to process

Obviously, I am doing something wrong. Basically I just want to echo back 
the name/values pairs that where entered into the form. How do I do this 
with woven?

Thanks

Mike 




From itamar at itamarst.org  Thu Jan  8 21:52:12 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 08 Jan 2004 23:52:12 -0500
Subject: [Twisted-Python] Newbie Question about PB and Firewalls
In-Reply-To: <20040108231407.B4D25109EB9@xprdmailfe1.nwk.excite.com>
References: <20040108231407.B4D25109EB9@xprdmailfe1.nwk.excite.com>
Message-ID: <1073623932.6872.17.camel@sheriffpony>

On Thu, 2004-01-08 at 18:14, Patrick Gilmartin wrote:

> Given the above situation about Firewall settings where I have no control, is my assumption correct that the PB protocol is not an option for me.

Yes, however -

Breaking past firewalls is actually pretty easy, assuming they allow
HTTPS access to outside world. What you do is, run server on port 443,
then connect to HTTP proxy, send:

   CONNECT http://yourhost.com:443/

or the appropriate syntax for the CONNECT command, and the connection
will now be opened for 443. At this point you switch to your protocol of
choice and can do whatever you want over this connection.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From reapnow at excite.com  Thu Jan  8 22:04:59 2004
From: reapnow at excite.com (Patrick Gilmartin)
Date: Fri,  9 Jan 2004 00:04:59 -0500 (EST)
Subject: [Twisted-Python] Re: Newbie Question about PB and Firewalls
Message-ID: <20040109050459.762981E43B@xprdmailfe25.nwk.excite.com>

Thanks for quick your response.  I finally realize the errors in my logic regarding client side firewall settings.

I look forward to becoming proficient with Twisted and incorporating it into overall IT infrastructure.

Thanks again,

Patrick   




 --- On Thu 01/08, Eric <input class="txtDsp" type="text" size="8" name="word2" value=  "<input" class="txtDsp" type="text" size="8" name="word3" value="-net.net"  wrote:
From: Eric python at twistedmatrix.com
Date: Thu, 8 Jan 2004 20:05:59 -0700
Subject: [Twisted-Python] Re: Newbie Question about PB and Firewalls

On Thursday 08 January 2004 04:14 pm, Patrick Gilmartin wrote:<br> I have been reviewing Twisted site and documentation fairly extensive<br> for the past couple of months.<br><br> I have just downloaded it to start working with it, but before I get<br> started there are some answers I seek that will really help in my<br> overall plans.<br><br> From all the reading I have done, it looks like PB would be the<br> optimal protocol for me to use.  I understand where I have decision<br> making power at both ends of the line, I can modify the Firewalls<br> settings to accommodate the port(s).<br><br> But I know I will have situations where the client side will be<br> behind a firewall where I do manage the decision making process.<br><br>If it's the client side it shouldn't have a problem connecting out to <br>the Internet.<br><br>Or perhaps the firewall only allows certain outbound ports? If a user is <br>running such a firewall setup they pretty much need to be able to allow <br>more ports as needed.<br><br>One<br> of the reasons why XML-RPC and SOAP are broadly popular choices is<br> that they are over HTTP.<br><br>They're the same as far as crossing firewalls is concerned.<br><br><br> Given the above situation about Firewall settings where I have no<br> control, is my assumption correct that the PB protocol is not an<br> option for me.<br><br>No, probably not, but I don't think I understand your problem.<br><br><br> Thanks in advance for your help.<br><br> Patrick<br><br> _______________________________________________<br> Join Excite! - <input class="txtDsp" type="text" size="8" name="word9" value="://www.excite.com<br"> The most personalized portal on the Web!<br><br> _______________________________________________<br> Twisted-Python mailing list<br> Twisted-<input class="txtDsp" type="text" size="8" name="word12" value=".com<br"> <input class="txtDsp" type="text" size="8" name="word14" value="-<input" class="txtDsp" type="text" size="8" name="word15" value="-python<br"><br><br><br><br><br>_______________________________________________<br>Twisted-Python mailing list<br>Twisted-http://twistedmatrix.

_______________________________________________
Join Excite! - http://www.excite.com
The most personalized portal on the Web!



From pyp at gmx.net  Fri Jan  9 05:38:00 2004
From: pyp at gmx.net (Mike Mueller)
Date: Fri, 09 Jan 2004 13:38:00 +0100
Subject: [Twisted-Python] how to get form values in woven?
In-Reply-To: <5.2.1.1.1.20040109045850.022e2590@pop.gmx.net>
Message-ID: <5.2.1.1.1.20040109133407.021bdc80@pop.gmx.net>


At 05:16 09.01.2004 +0100, I wrote:
>....
>
>There are several problems with this.
>
>1.) wchild_processMyForm gets called twice every time the submit button is hit
>2.) for the first call the method is post for, the second it is get
>3.) arg is always {}, so nothing to process
>
>Obviously, I am doing something wrong. Basically I just want to echo back 
>the name/values pairs that where entered into the form. How do I do this 
>with woven?


I took me while but I found the problems:

1.) <form action="processMyForm" method="post"> must be <form 
action="processMyForm/" method="post">
and
2.)  <input type="text" id="Text1"/> must be <input type="text" name="Text1"/>

The working script looks like this:

from twisted.application import service, internet
from twisted.web.woven import page
from twisted.web import server, resource


class FirstPage(page.Page):
     template = """<html>
         <head>
         <title>First Form</title>
         </head>
         <body>
           <h3>First Form</h3>
           <form action="processMyForm/" method="post">
           <p>
           Text1:
           <input type="text" name="Text1"/><br/>
           Text2:
           <input type="text" name="Text2"/><br/>
           <input type="submit" value="Send"/>
           </p>
           </form>
         </body>
       </html>
     """
     def initialize(self, *args, **kwargs):
         self.numberOfProcessCalls = 0
     def wchild_processMyForm(self, request):
         self.numberOfProcessCalls += 1
         keysValues = []
         for k, v in request.__dict__.items():
             keysValues.append('%s:\t %s' %(k,v))
         model = {'keys-values': keysValues,
                  'number':self.numberOfProcessCalls}
         return page.Page(model, template=
                          """<html>
                              <body>
                              Number of calls:
                              <p model="number" view="Text" />
                              <h3>arg keys: values</h3>
                              <div model="keys-values" view="List">
                                 <p pattern="listItem" view="Text" />
                              </div>
                              </body>
                              </html>""")


p = FirstPage()
application = service.Application('SimpleForm')
internet.TCPServer(8088, 
server.Site(resource.IResource(p))).setServiceParent(service.IServiceCollection(application))



Mike 




From z3p at twistedmatrix.com  Fri Jan  9 08:10:14 2004
From: z3p at twistedmatrix.com (Paul Swartz)
Date: Fri, 9 Jan 2004 10:10:14 -0500
Subject: [Twisted-Python] twisted.conch.ssh.filetransfer example...
In-Reply-To: <20040108175940.36573.qmail@web21507.mail.yahoo.com>
References: <3513EC08-4116-11D8-B0D7-000A95686CD8@redivi.com> <20040108175940.36573.qmail@web21507.mail.yahoo.com>
Message-ID: <20040109151014.GA30005@pyramid.twistedmatrix.com>

On Thu, Jan 08, 2004 at 02:59:40PM -0300, Aloysio Figueiredo wrote:
> 
> I need to transfer a file via ssh.
> twisted.conch.ssh.filetransfer seems to be a way to do
> that, but it's not documented and I couldn't figure
> out how to use it. Could anyone point a short example
> (here or in the web) ?

If you want to transfer a single file, t.c.s.filetransfer is overkill.
If this is a custom application that you want to transfer the file in,
just open the connection and just send the file directly over an open
channel.

If you still want an example of how to use the filetransfer code, look
for Fred Drake's SFTP->FTP gateway.  I don't know the link off the top
of my head, but check the list archives.


-p
-- 
       Paul Swartz
(o_    http://www.twistedmatrix.com/users/z3p.twistd/  _o)
//\    z3p at twistedmatrix.com                           /\\
V_/_   AIM: z3penguin                                 _\_V->



From fdrake at acm.org  Fri Jan  9 08:42:56 2004
From: fdrake at acm.org (Fred L. Drake, Jr.)
Date: Fri, 9 Jan 2004 10:42:56 -0500
Subject: [Twisted-Python] twisted.conch.ssh.filetransfer example...
In-Reply-To: <20040109151014.GA30005@pyramid.twistedmatrix.com>
References: <3513EC08-4116-11D8-B0D7-000A95686CD8@redivi.com>
	<20040108175940.36573.qmail@web21507.mail.yahoo.com>
	<20040109151014.GA30005@pyramid.twistedmatrix.com>
Message-ID: <16382.52224.531498.179376@sftp.fdrake.net>

Paul Swartz writes:
 > If you still want an example of how to use the filetransfer code, look
 > for Fred Drake's SFTP->FTP gateway.  I don't know the link off the top
 > of my head, but check the list archives.

And what an example that is!  ;-)  There's no HTML page that describes
the project anywhere, but it's available from CVS:

    http://cvs.zope.org/Packages/SFTPGateway/

It's easy enough to select a branch tag at the bottom of the page and
then click "Download a tarball".  I just tagged beta 3 yesterday, but
the SFTP->FTP code hasn't changed for a while, only the outer layer of
the application (configuration support changes mostly).


  -Fred

-- 
Fred L. Drake, Jr.  <fdrake at acm.org>
PythonLabs at Zope Corporation



From andrew-twisted at puzzling.org  Fri Jan  9 09:20:07 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sat, 10 Jan 2004 03:20:07 +1100
Subject: [Twisted-Python] Re: Where is best place to put my custom code?
In-Reply-To: <3944330C-421E-11D8-AECA-0030656C6B9E@webcrunchers.com>
References: <20031231205249.GA25692@intarweb.us> <47D7D71E-3BED-11D8-ADCB-0030656C6B9E@webcrunchers.com> <200312312043.15657.teratorn@world-net.net> <46FC665F-3C90-11D8-ADCB-0030656C6B9E@webcrunchers.com> <20040102025208.GB11930@frobozz> <71D2DB39-3D92-11D8-B76A-0030656C6B9E@webcrunchers.com> <20040103032031.GA14197@frobozz> <565F1944-3FF4-11D8-AECA-0030656C6B9E@webcrunchers.com> <20040106032825.GA24218@frobozz> <3944330C-421E-11D8-AECA-0030656C6B9E@webcrunchers.com>
Message-ID: <20040109162007.GB6198@frobozz>

On Thu, Jan 08, 2004 at 01:04:18PM -0800, JD wrote:
> On Jan 5, 2004, at 7:28 PM, Andrew Bennetts wrote:
> >On Mon, Jan 05, 2004 at 06:59:26PM -0800, JD wrote:
[...]
> >>
> >>So If I can't mix my application code with a sub_class of a IRCClient,
> >>then how is the right way to do it.
> >
> >What I was trying to say is rather than subclass like this:
> >
> >    IRCClient (from twisted.protocols.irc)
> >     |
> >     \--YourIRCApp (adds WHO command, has your application logic)
> >
> >It might be a better idea to do it like this:
> >
> >    IRCClient (from twisted.protocols.irc)
> >     |
> >     \--ExtendedIRCClient (adds WHO command)
> >         |
> >         \--YourIRCApp (has your application logic)
> 
> I've already decided that....    because when I first started to use
> Twisted,  I had no clue of even the existance of ExtendedIRCClient
> because it was so cleverly mis-labeled and hidden so well in the
> examples,  I never would have found it,  had I not posted this in
> the first place.

You misunderstand me.

I wasn't referring to the AdvancedClient class in sandbox/exarkun/irc2.py,
as you seem to be thinking.  I was offering a suggestion on how to structure
*your* code that extends twisted.protocols.irc.IRCClient, if you choose to
extend it.

(The fact that AdvancedClient is an extension to IRCClient that subclasses
it as I describe above suggests that my advice is sound, but the existence
of AdvancedClient is incidental to the point I was trying to make.)

-Andrew.




From jeethur at sancharnet.in  Fri Jan  9 20:32:43 2004
From: jeethur at sancharnet.in (Jeethu Rao)
Date: Sat, 10 Jan 2004 09:02:43 +0530
Subject: [Twisted-Python] wxreactor hack
Message-ID: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo>

Hi Folks,
Attached is a hack of Itamar's wxreactor, which uses another wxTimer
to implement reactor.callLater. I even tried using the oft 
mentioned(on the wxPy list) wxCallAfter for reactor.callFromThread.
But it tends to lag behind a lot, which is very unsuitable. Hence,
the standard runUntilCurrent from SelectReactor is slightly modified and
used.

Anyways, no performance guarantees. It works for me though :)

Jeethu Rao
-------------- next part --------------
A non-text attachment was scrubbed...
Name: wxreactor.py.gz
Type: application/octet-stream
Size: 2420 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20040110/02dd1568/attachment-0002.obj>

From dave at krondo.com  Sat Jan 10 10:25:53 2004
From: dave at krondo.com (Dave Peticolas)
Date: Sat, 10 Jan 2004 09:25:53 -0800
Subject: [Twisted-Python] Re: examples/row_example.py  DBError Row
	object not in cache
In-Reply-To: <Sea1-F152WrwjvzWvTl0004c2aa@hotmail.com>
References: <Sea1-F152WrwjvzWvTl0004c2aa@hotmail.com>
Message-ID: <1073755553.9590.7.camel@oneiros>

On Thu, 2004-01-08 at 07:14, marjan cinober wrote:
> Hello
> 
> Thank you Dave for your fast reply, but it seems like I haven't managed to 
> get rid of the problem by syncing with current CVS (today). And upgrading 
> from Twisted 1.1.0 to 1.1.1 on Debian sarge - testing
> 
> Eroor message looks exactly the same
> --- <exception caught here> ---
>   File "/usr/lib/python2.3/site-packages/twisted/internet/defer.py", line 
> 308, in _runCallbacks
>     self.result = callback(self.result, *args, **kw)
>   File "./row_example.py", line 58, in onInsert
>     manager.deleteRow(newRoom).addCallback(onDelete)
>   File 
> "/usr/lib/python2.3/site-packages/twisted/enterprise/sqlreflector.py", line 
> 330, in deleteRow
>     self.removeFromCache(rowObject)
>   File "/usr/lib/python2.3/site-packages/twisted/enterprise/reflector.py", 
> line 141, in removeFromCache
>     raise DBError("Row object not in cache: %s", rowObject)
> twisted.enterprise.util.DBError: ('Row object not in cache: %s', <Room 
> #100001: newRoom1 (fred) (100,100)>)

Are you running directly out of CVS or installing it somewhere?
Is it possible you forgot to re-install after syncing? The error
message you are getting isn't in CVS anymore.

dave

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: </pipermail/twisted-python/attachments/20040110/956d6d9d/attachment.sig>

From theman at eradman.com  Sat Jan 10 13:10:37 2004
From: theman at eradman.com (Eric Radman)
Date: Sat, 10 Jan 2004 20:10:37 +0000
Subject: [Twisted-Python] wxreactor hack
In-Reply-To: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo>
References: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo>
Message-ID: <1073765437.2606.4.camel@inspiration>

Hi All,

It seems that Woven escapes on all text returned by wmfactory_ methods.
Can this behavior be changed? I would like to build a model function
that returns an XML fragment, but Woven applies microdom.escape() to the
strings I return!

Eric Radman
theman at eradman.com

article.py:
----------------------------------------------------

import os
from twisted.web import microdom
from twisted.web.woven import page
from cStringIO import StringIO

class MyPage(page.Page):
  def getXMLDocument(self, request):
    global xmldoc
    
    try:
      return xmldoc
    except:
      code = request.args.get("code", [None])[0]
      xmlfile = open(os.path.abspath("articles/%s.xml" % code),  "r")
      xmltext = xmlfile.read()
      xmlfile.close()
      xmldoc = microdom.parseString(xmltext)
      return xmldoc

  def wmfactory_Topic(self, request):
    return "Title"
  
  def wmfactory_Content(self, request):
    xmldoc = self.getXMLDocument(request)
    content = xmldoc.getElementsByTagName("content")[0]
    return content.toxml()

  def wmfactory_Summary(self, request):
    return "Summary"





From itamar at itamarst.org  Sat Jan 10 18:22:54 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 10 Jan 2004 20:22:54 -0500
Subject: Escaping text in Woven (was Re: [Twisted-Python] wxreactor hack)
In-Reply-To: <1073765437.2606.4.camel@inspiration>
References: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo>
	 <1073765437.2606.4.camel@inspiration>
Message-ID: <1073784173.6565.102.camel@sheriffpony>

On Sat, 2004-01-10 at 15:10, Eric Radman wrote:

> It seems that Woven escapes on all text returned by wmfactory_ methods.
> Can this behavior be changed? I would like to build a model function
> that returns an XML fragment, but Woven applies microdom.escape() to the
> strings I return!

1. Return a RawText widget. (twisted.web.woven.widgets.RawText("hello!")
might work, IIRC.)

2. Woven is being replaced by nevow, sometime.

3. Please choose relevant subject for your emails.

4. twisted-web mailing list is probably better place for this question.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From itamar at itamarst.org  Sat Jan 10 18:32:43 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sat, 10 Jan 2004 20:32:43 -0500
Subject: Escaping text in Woven (was Re: [Twisted-Python] wxreactor
	hack)
In-Reply-To: <1073784173.6565.102.camel@sheriffpony>
References: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo>
	 <1073765437.2606.4.camel@inspiration>
	 <1073784173.6565.102.camel@sheriffpony>
Message-ID: <1073784762.6871.104.camel@sheriffpony>

On Sat, 2004-01-10 at 20:22, Itamar Shtull-Trauring wrote:

> > It seems that Woven escapes on all text returned by wmfactory_ methods.
> > Can this behavior be changed? I would like to build a model function
> > that returns an XML fragment, but Woven applies microdom.escape() to the
> > strings I return!

Oh, wait, a model... Er. I'm not sure... maybe what I said works, maybe
you need custom class with view of RawWidget set for it.




From jsmith at psych.duke.edu  Sat Jan 10 19:40:14 2004
From: jsmith at psych.duke.edu (Joshua Smith)
Date: Sat, 10 Jan 2004 21:40:14 -0500
Subject: [Twisted-Python] Question about conch.ssh.forwarding
Message-ID: <4000B78E.1010903@psych.duke.edu>

I am working on creating a module for a project involving workstation 
administration and have been trying to get the ssh port forwarding in 
conch to work. Anybody have any quick and dirty examples of this? My 
goal is to be able to forward traffic to our mail server and a central 
administrative console in a secure fashion. I have had limited success 
with python controlling the command line ssh, but it is unwieldy 
compared to doing it natively in python.

-- 
Joshua H. Smith
Computer Support
The Department of Psychological & Brain Sciences
Rm 017
Jsmith at psych.duke.edu
919-660-5680 





From theman at eradman.com  Sat Jan 10 18:11:03 2004
From: theman at eradman.com (Eric Radman)
Date: Sun, 11 Jan 2004 01:11:03 +0000
Subject: [Twisted-Python] Escaping text in Woven and nevow
In-Reply-To: <1073784173.6565.102.camel@sheriffpony>
References: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo>
	 <1073765437.2606.4.camel@inspiration>
	 <1073784173.6565.102.camel@sheriffpony>
Message-ID: <1073783462.31733.11.camel@inspiration>

> 1. Return a RawText widget. (twisted.web.woven.widgets.RawText("hello!")
> might work, IIRC.)

Woven seems to be expecting a string for a return value. This is what I
get:
<twisted.web.woven.widgets.RawText instance at 0x4cd190>

> 2. Woven is being replaced by nevow, sometime.

I installed Twisted from CVS this evening and cannot find any library
named 'nevow'. Is this still on the drawing board?

> 3. Please choose relevant subject for your emails.

OK

> 4. twisted-web mailing list is probably better place for this question.

Good point. Signed up to that list.

Thanks for your help!

E. Radman




From z3p at twistedmatrix.com  Sun Jan 11 08:39:37 2004
From: z3p at twistedmatrix.com (Paul Swartz)
Date: Sun, 11 Jan 2004 10:39:37 -0500
Subject: [Twisted-Python] Question about conch.ssh.forwarding
In-Reply-To: <4000B78E.1010903@psych.duke.edu>
References: <4000B78E.1010903@psych.duke.edu>
Message-ID: <20040111153937.GA16853@pyramid.twistedmatrix.com>

On Sat, Jan 10, 2004 at 09:40:14PM -0500, Joshua Smith wrote:
> I am working on creating a module for a project involving workstation 
> administration and have been trying to get the ssh port forwarding in 
> conch to work. Anybody have any quick and dirty examples of this? My 
> goal is to be able to forward traffic to our mail server and a central 
> administrative console in a secure fashion. I have had limited success 
> with python controlling the command line ssh, but it is unwieldy 
> compared to doing it natively in python.

Once you have an SSHConnection instance:

reactor.listenTCP(localPortToListenOn,
    forwarding.SSHListenForwardingFactory(conn, (hostToConnectTo,
                                                 portToConnectTo),
                                          SSHListenClientForwardingChannel))

Then you can connect to localPortToListenOn any way you want.

-p
-- 
       Paul Swartz
(o_    http://www.twistedmatrix.com/users/z3p.twistd/  _o)
//\    z3p at twistedmatrix.com                           /\\
V_/_   AIM: z3penguin                                 _\_V->



From alan at norfolkgraphics.com  Sun Jan 11 16:37:32 2004
From: alan at norfolkgraphics.com (Alan McIntyre)
Date: Sun, 11 Jan 2004 18:37:32 -0500
Subject: [Twisted-Python] Suggested t.f.ftp patch for Windows users
Message-ID: <4001DE3C.1090600@norfolkgraphics.com>

Hi all,

I ran into a small problem with the FTP module under Windows. It imports 
pwd and grp, which are not available on Windows.

Since these modules are only used within the FTPAnonymousShell class, I 
moved the import to the methods that actually need it.  There's probably 
something more appropriate that could be done with them, but I'm not 
sure if there's a Windows analog for these modules.

I attached a patch (obtained with GNU diff, default options) just in 
case it's useful to someone else.

Thanks,
Alan
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: ftp.diff
URL: </pipermail/twisted-python/attachments/20040111/acb2bb4e/attachment.ksh>

From itamar at itamarst.org  Sun Jan 11 17:02:53 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Sun, 11 Jan 2004 19:02:53 -0500
Subject: [Twisted-Python] wxreactor hack
In-Reply-To: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo>
References: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo>
Message-ID: <1073865773.1251.3.camel@sheriffpony>

On Fri, 2004-01-09 at 22:32, Jeethu Rao wrote:

> Attached is a hack of Itamar's wxreactor, which uses another wxTimer
> to implement reactor.callLater. I even tried using the oft 
> mentioned(on the wxPy list) wxCallAfter for reactor.callFromThread.
> But it tends to lag behind a lot, which is very unsuitable. Hence,
> the standard runUntilCurrent from SelectReactor is slightly modified and
> used.

Please add a "diff -u" to the bug tracker (twistedmatrix.com/bugs/), and
I'll check it in when I have some time to look at it.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From alan at norfolkgraphics.com  Sun Jan 11 17:07:12 2004
From: alan at norfolkgraphics.com (Alan McIntyre)
Date: Sun, 11 Jan 2004 19:07:12 -0500
Subject: [Twisted-Python] Suggested t.f.ftp patch for Windows users
In-Reply-To: <4001DE3C.1090600@norfolkgraphics.com>
References: <4001DE3C.1090600@norfolkgraphics.com>
Message-ID: <4001E530.8000104@norfolkgraphics.com>

Ooops. :)  I see t.p.ftp has changed a bit since I last looked, so just 
please just ignore my ignorance.  I suppose I should spend some more 
time keeping up with such things. ;)

Alan McIntyre wrote:
> Hi all,
> 
> I ran into a small problem with the FTP module under Windows. It imports 
> pwd and grp, which are not available on Windows.
> 
> Since these modules are only used within the FTPAnonymousShell class, I 
> moved the import to the methods that actually need it.  There's probably 
> something more appropriate that could be done with them, but I'm not 
> sure if there's a Windows analog for these modules.
> 
> I attached a patch (obtained with GNU diff, default options) just in 
> case it's useful to someone else.
> 
> Thanks,
> Alan
> 
> 
> ------------------------------------------------------------------------
> 
> 1177,1178d1176
> < import pwd, grp
> < 
> 1243a1242,1243
> 
>>        import pwd
>>        
> 
> 1259a1260,1261
> 
>>        import pwd
>>




From jsmith at psych.duke.edu  Sun Jan 11 19:30:06 2004
From: jsmith at psych.duke.edu (Joshua Smith)
Date: Sun, 11 Jan 2004 21:30:06 -0500
Subject: [Twisted-Python] Question about conch.ssh.forwarding
In-Reply-To: <20040111153937.GA16853@pyramid.twistedmatrix.com>
References: <4000B78E.1010903@psych.duke.edu> <20040111153937.GA16853@pyramid.twistedmatrix.com>
Message-ID: <400206AE.6010109@psych.duke.edu>

Perfect. Thanks Paul, I now have fun things to play with.

Paul Swartz wrote:

>On Sat, Jan 10, 2004 at 09:40:14PM -0500, Joshua Smith wrote:
>  
>
>>I am working on creating a module for a project involving workstation 
>>administration and have been trying to get the ssh port forwarding in 
>>conch to work. Anybody have any quick and dirty examples of this? My 
>>goal is to be able to forward traffic to our mail server and a central 
>>administrative console in a secure fashion. I have had limited success 
>>with python controlling the command line ssh, but it is unwieldy 
>>compared to doing it natively in python.
>>    
>>
>
>Once you have an SSHConnection instance:
>
>reactor.listenTCP(localPortToListenOn,
>    forwarding.SSHListenForwardingFactory(conn, (hostToConnectTo,
>                                                 portToConnectTo),
>                                          SSHListenClientForwardingChannel))
>
>Then you can connect to localPortToListenOn any way you want.
>
>-p
>  
>

-- 
Joshua H. Smith
Computer Support
The Department of Psychological & Brain Sciences
Rm 017
Jsmith at psych.duke.edu
919-660-5680 





From andrew-twisted at puzzling.org  Sun Jan 11 21:49:43 2004
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon, 12 Jan 2004 15:49:43 +1100
Subject: [Twisted-Python] Suggested t.f.ftp patch for Windows users
In-Reply-To: <4001DE3C.1090600@norfolkgraphics.com>
References: <4001DE3C.1090600@norfolkgraphics.com>
Message-ID: <20040112044938.GB2699@frobozz>

On Sun, Jan 11, 2004 at 06:37:32PM -0500, Alan McIntyre wrote:
> 
> I attached a patch (obtained with GNU diff, default options) just in 
> case it's useful to someone else.

(We prefer unified diff format, i.e. "diff -u")

-Andrew.




From alan at norfolkgraphics.com  Sun Jan 11 22:01:33 2004
From: alan at norfolkgraphics.com (Alan McIntyre)
Date: Mon, 12 Jan 2004 00:01:33 -0500
Subject: [Twisted-Python] Suggested t.f.ftp patch for Windows users
In-Reply-To: <20040112044938.GB2699@frobozz>
References: <4001DE3C.1090600@norfolkgraphics.com> <20040112044938.GB2699@frobozz>
Message-ID: <40022A2D.9040008@norfolkgraphics.com>

Thanks; I'll keep that in mind for any future patches. :)

Andrew Bennetts wrote:
> On Sun, Jan 11, 2004 at 06:37:32PM -0500, Alan McIntyre wrote:
> 
>>I attached a patch (obtained with GNU diff, default options) just in 
>>case it's useful to someone else.
> 
> 
> (We prefer unified diff format, i.e. "diff -u")
> 
> -Andrew.
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
> 




From db3l at fitlinxx.com  Mon Jan 12 10:35:35 2004
From: db3l at fitlinxx.com (David Bolen)
Date: 12 Jan 2004 12:35:35 -0500
Subject: [Twisted-Python] Simulating time for reactor
Message-ID: <uy8sdysrc.fsf@fitlinxx.com>

I was wondering if the subject of being able to override the concept
of "time" for the Twisted reactor has come up before?

In the context of testing code that depends on reactor delayed events
(e.g., such as callLater), up to this point we've been controlling the
test by having the test override the timers used in the callLater
call, and then controlling the point at which the reactor "cranks"
(via iterate) so that we can control when the timer would or wouldn't
fire with respect to other events under test.

While this works well, it does mean that we aren't testing with actual
time values in the objects under test, thus our tests aren't enforcing
a particular time value in the design.  But I don't want the tests to
have to wait for the real time values (which can be lengthy) during
their normal execution.

For our own objects that manage events based on time delays, we have
those objects centralize their access to time through a single method,
which we can override in a mock version of that object for testing -
and thus the test has explicit control on the notion of "time" when it
executes.  It seems to me that something similar might be useful as a
standard part of the reactor.

For example, if IReactorCore included a now() or time() method which
was the only way it grabbed system time, then tests could mock up a
reactor to be installed at the start of a test and just override that
one method to control time.  From looking at base.py in the Twisted
distribution for example, it only appears that a few uses of
time.time() would have to be tweaked.

Anyway, I was curious if this has come up before, and if so, how else
have people tested reactor based code that has lengthy timers involved?

-- David





From nico at tekNico.net  Mon Jan 12 12:02:24 2004
From: nico at tekNico.net (Nicola Larosa)
Date: Mon, 12 Jan 2004 20:02:24 +0100
Subject: [Twisted-Python] Re: Simulating time for reactor
In-Reply-To: <uy8sdysrc.fsf@fitlinxx.com>
References: <uy8sdysrc.fsf@fitlinxx.com>
Message-ID: <4002EF40.2030807@tekNico.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> I was wondering if the subject of being able to override the concept
> of "time" for the Twisted reactor has come up before?
> ...
> Anyway, I was curious if this has come up before, and if so, how else
> have people tested reactor based code that has lengthy timers involved?

Here's my try, and the somewhat lukewarm reaction: :^)

StepReactor?
http://twistedmatrix.com/pipermail/twisted-python/2003-July/005288.html
http://twistedmatrix.com/pipermail/twisted-python/2003-July/005289.html
http://twistedmatrix.com/pipermail/twisted-python/2003-July/005292.html
http://twistedmatrix.com/pipermail/twisted-python/2003-August/005332.html
http://twistedmatrix.com/pipermail/twisted-python/2003-August/005337.html


- --
Nicola Larosa - nico at tekNico.net

"The word "community" comes from Latin, "cum munere". "Munere" is
"to give," and "cum" is "among each other" - so, community means
"to give among each other". In short, it turns out that dollar
exchanges tend to be incompatible with a gift economy.
Complementary currencies are." -- Bernard Lietaer

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)

iD8DBQFAAu8+Xv0hgDImBm4RAsHeAKC9s0NRidDWVWvVs9UZBnAV7eFYAwCfTlTU
zHFDy3S6a4ex+LiCDfHDnRg=
=JjeC
-----END PGP SIGNATURE-----



From itamar at itamarst.org  Mon Jan 12 12:03:02 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 12 Jan 2004 14:03:02 -0500
Subject: [Twisted-Python] Simulating time for reactor
In-Reply-To: <uy8sdysrc.fsf@fitlinxx.com>
References: <uy8sdysrc.fsf@fitlinxx.com>
Message-ID: <1073934182.1252.28.camel@sheriffpony>

On Mon, 2004-01-12 at 12:35, David Bolen wrote:
> I was wondering if the subject of being able to override the concept
> of "time" for the Twisted reactor has come up before?

Sounds like good idea. Please add an issue to twistedmatrix.com/bugs/
asking for a reactor.installClock(timeFunction) and a reactor.now(). JP
already did most of the necessary work at some point so this should be
easy to add.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From itamar at itamarst.org  Mon Jan 12 12:06:00 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Mon, 12 Jan 2004 14:06:00 -0500
Subject: [Twisted-Python] Simulating time for reactor
In-Reply-To: <uy8sdysrc.fsf@fitlinxx.com>
References: <uy8sdysrc.fsf@fitlinxx.com>
Message-ID: <1073934360.1249.31.camel@sheriffpony>

On Mon, 2004-01-12 at 12:35, David Bolen wrote:

> For example, if IReactorCore included a now() or time() method which
> was the only way it grabbed system time, then tests could mock up a
> reactor to be installed at the start of a test and just override that
> one method to control time.  From looking at base.py in the Twisted
> distribution for example, it only appears that a few uses of
> time.time() would have to be tweaked.

This still wouldn't alter how long e.g. select() waits, but since that
has maximum timeouts you'd probably be fine with just changing the time
to be 30 secs in the future, yeah.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From bob at redivi.com  Mon Jan 12 12:20:30 2004
From: bob at redivi.com (Bob Ippolito)
Date: Mon, 12 Jan 2004 14:20:30 -0500
Subject: [Twisted-Python] Simulating time for reactor
In-Reply-To: <1073934182.1252.28.camel@sheriffpony>
References: <uy8sdysrc.fsf@fitlinxx.com> <1073934182.1252.28.camel@sheriffpony>
Message-ID: <62C39C55-4534-11D8-97F6-000A95686CD8@redivi.com>


On Jan 12, 2004, at 2:03 PM, Itamar Shtull-Trauring wrote:

> On Mon, 2004-01-12 at 12:35, David Bolen wrote:
>> I was wondering if the subject of being able to override the concept
>> of "time" for the Twisted reactor has come up before?
>
> Sounds like good idea. Please add an issue to twistedmatrix.com/bugs/
> asking for a reactor.installClock(timeFunction) and a reactor.now(). JP
> already did most of the necessary work at some point so this should be
> easy to add.

At some point the tests should be refactored to do reactor.run(), too.. 
  the whole reactor.iterate() thing is bogus.

-bob

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2357 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20040112/e8bab96d/attachment-0002.bin>

From pje at telecommunity.com  Mon Jan 12 12:55:09 2004
From: pje at telecommunity.com (Phillip J. Eby)
Date: Mon, 12 Jan 2004 14:55:09 -0500
Subject: [Twisted-Python] Simulating time for reactor
In-Reply-To: <1073934360.1249.31.camel@sheriffpony>
References: <uy8sdysrc.fsf@fitlinxx.com>
 <uy8sdysrc.fsf@fitlinxx.com>
Message-ID: <5.1.0.14.0.20040112145057.044f3710@mail.telecommunity.com>

At 02:06 PM 1/12/04 -0500, Itamar Shtull-Trauring wrote:
>On Mon, 2004-01-12 at 12:35, David Bolen wrote:
>
> > For example, if IReactorCore included a now() or time() method which
> > was the only way it grabbed system time, then tests could mock up a
> > reactor to be installed at the start of a test and just override that
> > one method to control time.  From looking at base.py in the Twisted
> > distribution for example, it only appears that a few uses of
> > time.time() would have to be tweaked.
>
>This still wouldn't alter how long e.g. select() waits, but since that
>has maximum timeouts you'd probably be fine with just changing the time
>to be 30 secs in the future, yeah.

For tests in PEAK that involve reactors, I use a "clock" object with 
time(), select(), and sleep() methods.  The select() and sleep() methods 
just increment the time() value by the given number of seconds.  So, for 
each test, time() starts at zero and we go from there.

One other issue to watch for: the insertion of delayed calls must be 
stable.  That is, if you add two delayed calls with the same target time, 
they must end up in the list in the order that they were added.  Otherwise, 
tests will behave oddly.  It's been a long time since I looked at Twisted's 
base reactor code, but it seems to me that the last time I did, Twisted was 
*not* using a stable insertion algorithm.  Mine uses insort_right and 
pop(0), with an object type that compares equal for equal target times.  If 
this latter constraint isn't met, it's not possible to get a stable 
insertion using the bisect module's insort functions.




From db3l at fitlinxx.com  Mon Jan 12 16:59:24 2004
From: db3l at fitlinxx.com (David Bolen)
Date: 12 Jan 2004 18:59:24 -0500
Subject: [Twisted-Python] Re: Simulating time for reactor
References: <uy8sdysrc.fsf@fitlinxx.com> <1073934182.1252.28.camel@sheriffpony> <62C39C55-4534-11D8-97F6-000A95686CD8@redivi.com>
Message-ID: <uu130zpk3.fsf@fitlinxx.com>

Bob Ippolito <bob at redivi.com> writes:

> On Jan 12, 2004, at 2:03 PM, Itamar Shtull-Trauring wrote:
> 
> > On Mon, 2004-01-12 at 12:35, David Bolen wrote:
> >> I was wondering if the subject of being able to override the concept
> >> of "time" for the Twisted reactor has come up before?
> >
> > Sounds like good idea. Please add an issue to twistedmatrix.com/bugs/
> > asking for a reactor.installClock(timeFunction) and a reactor.now(). JP
> > already did most of the necessary work at some point so this should be
> > easy to add.
> 
> At some point the tests should be refactored to do reactor.run(),
> too.. the whole reactor.iterate() thing is bogus.

I'm not sure I follow - I certainly couldn't just use reactor.run() in
my tests because while the objects under test will certainly be under
an overall reactor.run() loop in production use, during each test, I'm
only testing a small fraction of those objects behavior, and thus I
don't want to yield permanent control of execution to the reactor.

Having the ability to explicitly crank the reactor (via iterate) when
I want within my tests was, to me, a very positive point about Twisted
(when compared to threaded approaches for example), as it gave me
explicit control in my test environment where I needed it.

-- David




From radix at twistedmatrix.com  Mon Jan 12 17:04:27 2004
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Mon, 12 Jan 2004 19:04:27 -0500
Subject: [Twisted-Python] Re: Simulating time for reactor
In-Reply-To: <uu130zpk3.fsf@fitlinxx.com>
References: <uy8sdysrc.fsf@fitlinxx.com> <1073934182.1252.28.camel@sheriffpony> <62C39C55-4534-11D8-97F6-000A95686CD8@redivi.com> <uu130zpk3.fsf@fitlinxx.com>
Message-ID: <4003360B.5070700@twistedmatrix.com>

David Bolen wrote:
> Bob Ippolito <bob at redivi.com> writes:
>>At some point the tests should be refactored to do reactor.run(),
>>too.. the whole reactor.iterate() thing is bogus.
> 
> 
> I'm not sure I follow - I certainly couldn't just use reactor.run() in
> my tests because while the objects under test will certainly be under
> an overall reactor.run() loop in production use, during each test, I'm
> only testing a small fraction of those objects behavior, and thus I
> don't want to yield permanent control of execution to the reactor.

That's your incorrect assumption; you can stop reactors. 
reactor.crash(). Usually one does this from some callback within their 
test. I've written tests with both iterate() and run()/crash(); the 
latter is usually more natural to me. I don't remember enough right now 
to try to make a blanket assertion about which one is better, though 
(maybe I should write more tests again ;).

-- 
  Twisted | Christopher Armstrong: International Man of Twistery
   Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 256 bytes
Desc: OpenPGP digital signature
URL: </pipermail/twisted-python/attachments/20040112/8ee0adbd/attachment.sig>

From radix at twistedmatrix.com  Tue Jan 13 00:53:03 2004
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 13 Jan 2004 02:53:03 -0500
Subject: [Twisted-Python] twisted-bugs mailing list back in action
Message-ID: <4003A3DF.8030400@twistedmatrix.com>



http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-bugs

*New* issues will be sent to this list; If you want to get further 
updates on a particular issue, you'll still need to set yourself nosy on 
the particular issue. I tried making all updates go to the list, but it 
wasn't obvious how to do this in an optimal way -- a single change to an 
issue that modified two properties of it (i.e., "status" as well as 
adding a message) would generate two messages.

-- 
  Twisted | Christopher Armstrong: International Man of Twistery
   Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 256 bytes
Desc: OpenPGP digital signature
URL: </pipermail/twisted-python/attachments/20040113/d2df1515/attachment.sig>

From miracle at slingshot.co.nz  Tue Jan 13 01:01:28 2004
From: miracle at slingshot.co.nz (Matthew Sherborne)
Date: Tue, 13 Jan 2004 21:01:28 +1300
Subject: [Twisted-Python] testing enterprise and pb
In-Reply-To: <20040112115056.31889.84839.Mailman@twistedmatrix.com>
References: <20040112115056.31889.84839.Mailman@twistedmatrix.com>
Message-ID: <1073980888.5679.5.camel@localhost>

Hi,

This is some advice I'd like to share:

If you're testing enterprise [and pb] with twisted.trial

before running the testing suite go:

from twisted.interet import reactor
reactor.startRunning()

And if you find that the deferreds returned by dbpool.runQuery('Select
...') and dbpool.runOperation?('...') don't return, just pump
reactor.iterate() until they do...

Aparently reactor.startRunning() gets the threads going.

Thanks to radix and slyphoon for the chat room help.

Matthew Sherborne (matiu)




From nic at tymar.com  Wed Jan  7 21:52:58 2004
From: nic at tymar.com (Nic Cave-Lynch)
Date: Thu, 08 Jan 2004 17:52:58 +1300
Subject: [Twisted-Python] newbie: using serial ports in plugin
Message-ID: <3FFCE22A.5050105@tymar.com>

Hi people

I need to write an application which will receive data from a number of 
serial ports, mash it around a lot, then forward the mashed results 
across a TCP connection to another box where it's all un-mashed and spat 
out one of a number of serial ports there. All conceptually fairly 
simple, and Twisted looked like it would help enormously.

But

I can't work out how to daemonise an application which is bound to a 
serial port. The neither the gpsfix.py or the mouse.py examples seem to 
follow the required interface for being able to be turned into a 'tap'. 
I've looked at other approaches (like munging the portforward.py 
concepts -- that doesn't seem to allow the SerialPort intialisations to 
work properly) but I keep hitting dead ends (and my head against a brick 
wall)

Can anyone give me any pointers, or better still, some example code of a 
serial port protocol running as a daemon.

All help gratefully received

Nic C-L





From exarkun at intarweb.us  Sun Jan 11 11:00:01 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Sun, 11 Jan 2004 13:00:01 -0500
Subject: [Twisted-Python] wxreactor hack
In-Reply-To: <1073765437.2606.4.camel@inspiration>
References: <000001c3d72a$6a325e70$02f0023d@nagsoft1hyhtvo> <1073765437.2606.4.camel@inspiration>
Message-ID: <20040111180001.GA8334@intarweb.us>

On Sat, Jan 10, 2004 at 08:10:37PM +0000, Eric Radman wrote:
> Hi All,
> 

  Hi.  Your mail client has decided that you are responding to a message in
a thread about wxreactor.  It probably did this because you had that message
selected when you told it to compose mail, or because you selected reply
rather than compose.  Since your message is not actually about wxreactor,
this is confusing and undesirable.  In the future, please pay more attention
to what you are asking your mail client to do, so that it is easier to find
and understand the question you are asking.

  Thanks,

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20040111/f85115cc/attachment.sig>

From exarkun at intarweb.us  Sun Jan 11 17:29:51 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Sun, 11 Jan 2004 19:29:51 -0500
Subject: [Twisted-Python] Suggested t.f.ftp patch for Windows users
In-Reply-To: <4001E530.8000104@norfolkgraphics.com>
References: <4001DE3C.1090600@norfolkgraphics.com> <4001E530.8000104@norfolkgraphics.com>
Message-ID: <20040112002951.GA9073@intarweb.us>

On Sun, Jan 11, 2004 at 07:07:12PM -0500, Alan McIntyre wrote:
> Ooops. :)  I see t.p.ftp has changed a bit since I last looked, so just 
> please just ignore my ignorance.  I suppose I should spend some more 
> time keeping up with such things. ;)

  Not at all.  I believe itamar made the change in response to your message.
So, thanks :)

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20040111/e978ade7/attachment.sig>

From db3l at fitlinxx.com  Tue Jan 13 08:42:46 2004
From: db3l at fitlinxx.com (David Bolen)
Date: 13 Jan 2004 10:42:46 -0500
Subject: [Twisted-Python] Re: Simulating time for reactor
References: <uy8sdysrc.fsf@fitlinxx.com> <1073934182.1252.28.camel@sheriffpony> <62C39C55-4534-11D8-97F6-000A95686CD8@redivi.com> <uu130zpk3.fsf@fitlinxx.com> <4003360B.5070700@twistedmatrix.com>
Message-ID: <uhdyzg8i1.fsf@fitlinxx.com>

Christopher Armstrong <radix at twistedmatrix.com> writes:

> That's your incorrect assumption; you can stop
> reactors. reactor.crash().

Well, actually I'm well aware of being able to stop reactors.  It's
just that doing so isn't a good fit for my current test scenario.

>                            Usually one does this from some callback
> within their test.

Ah, there's your incorrect assumption :-) That the reactor delayed
events that are created by the code under test end up in a callback
within the test itself.  If that were the case I might not have a
problem using reactor.run() and reactor.stop(), although I suppose I'd
still have to think about the case when the callback was incorrectly
never called - how would the test terminate in that case with a
failure?  (Guess I'd have to install an additional callLater as a
back-stop or something, which is unnecessary latency in a failure
scenario - could easily add up over a lot of tests)

>                    I've written tests with both iterate() and
> run()/crash(); the latter is usually more natural to me. I don't
> remember enough right now to try to make a blanket assertion about
> which one is better, though (maybe I should write more tests again ;).

I'm definitely not saying which is better or worse, but in the tests I
was referring to, iterate() was clearly more applicable.  I think I
could see using run()/crash() if I were testing a more protocol piece
of code, but that's not my current scenario, where it's primarily
delayed calls I want control of.

As an example, I'm testing the controller portion of an MVC setup.
Most of the tests initialize a model to some known state, assign it to
a controller, and then initiate certain events through the controller.
The controller will be part of a bigger Twisted-based system, but the
controller itself handles no network I/O, so the only part of Twisted
it's really depending on is the IReactorTime for delayed actions used
as timeouts in the controller.  The checks in the test are that the
model ends up in the right final state after the events.  I don't care
how the controller accomplishes that feat (it's internals are opaque
to users and semi-opaque to tests), just that the model ends up the
right way.

Some of the model changes are triggered by internal timeouts within
the controller, so to test that, the test adjusts the timeout value
used by the controller (hence "semi-opaque") when establishing delayed
calls so that I know the call - if the controller set it up - will
fire during the next iterate().  I can then sequence the iterate()
call along with other events to simulate various permutations of
timing of events with respect to the delayed call occurring.  To my
mind it's extremely clean and controlled given that I'm effectively
testing asynchronous events with respect to specific use cases.  That
is, except for externally overriding the timer value, which is only
needed to ensure the delayed call will trigger when I want it to (thus
my request here).

But with respect to reactor.run(), the key is that the callback for
the delayed call is internal to the controller and the test is not
interfering with that at all, nor does it have visibility to it.  I
could theoretically subclass the controller as a mock controller to
add a reactor.stop() to such a callback, but that would be much more
complexity to me than simply using iterate() when appropriate in the
test.  I think both have their place, but I definitely like the
availability of iterate() for this scenario.

-- David




From developer at csrules.dyndns.org  Tue Jan 13 09:49:08 2004
From: developer at csrules.dyndns.org (darryl)
Date: Tue, 13 Jan 2004 10:49:08 -0600
Subject: [Twisted-Python] twisted-bugs mailing list back in action
In-Reply-To: <4003A3DF.8030400@twistedmatrix.com>
References: <4003A3DF.8030400@twistedmatrix.com>
Message-ID: <40042184.10808@csrules.dyndns.org>

Christopher Armstrong wrote:
> 
> 
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-bugs
> 
> *New* issues will be sent to this list; If you want to get further 
> updates on a particular issue, you'll still need to set yourself nosy on 
> the particular issue. I tried making all updates go to the list, but it 
> wasn't obvious how to do this in an optimal way -- a single change to an 
> issue that modified two properties of it (i.e., "status" as well as 
> adding a message) would generate two messages.
> 


As far as i know you would need to make a custom reactor to replace
the default nosyreactor distributed with roundup.

-darryl



From radix at twistedmatrix.com  Tue Jan 13 16:19:20 2004
From: radix at twistedmatrix.com (Christopher Armstrong)
Date: Tue, 13 Jan 2004 18:19:20 -0500
Subject: [Twisted-Python] twisted-bugs mailing list back in action
In-Reply-To: <40042184.10808@csrules.dyndns.org>
References: <4003A3DF.8030400@twistedmatrix.com> <40042184.10808@csrules.dyndns.org>
Message-ID: <40047CF8.6070407@twistedmatrix.com>

darryl wrote:
> Christopher Armstrong wrote:
>>
>> I tried making all updates go to the list, 
>> but it wasn't obvious how to do this in an optimal way -- a single 
>> change to an issue that modified two properties of it (i.e., "status" 
>> as well as adding a message) would generate two messages.
>
> As far as i know you would need to make a custom reactor to replace
> the default nosyreactor distributed with roundup.

Well, not really replace -- e.g., the way I did this list functionality 
is by adding a new reactor that just reacts to the "create" action. So I 
could just improve that to sanely deal with the "set" action without 
being so verbose... Alternatively, I guess I could hack the nosyreactor 
reactor itself to always add a particular email address to the list of 
addresses to send to.

I'm still not sure this is desirable, though -- would people like for 
all updates to be sent to the twisted-bugs list? If so, I think I'll do 
the nosyreactor hack, it shouldn't be hard.

-- 
  Twisted | Christopher Armstrong: International Man of Twistery
   Radix  |          Release Manager,  Twisted Project
---------+           http://radix.twistedmatrix.com/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 256 bytes
Desc: OpenPGP digital signature
URL: </pipermail/twisted-python/attachments/20040113/b97f9010/attachment.sig>

From justinjohnson at fastmail.fm  Wed Jan 14 13:04:12 2004
From: justinjohnson at fastmail.fm (Justin Johnson)
Date: Wed, 14 Jan 2004 14:04:12 -0600
Subject: [Twisted-Python] Handling UnauthorizedLogin Exception with PB
Message-ID: <20040114200412.890AF44DCA@server1.messagingengine.com>

I have a PB server that uses new cred and the FileUserPasswordDB checker
for authentication.  When users attempt to login with the incorrect
username/password, a twisted.cred.error.UnauthorizedLogin exception is
raised and logged on the server.  The exception doesn't get passed back
to the client though.  On the client side I have a deferred with multiple
callbacks added and a single errback added to the end as follows:

    def mkrepexport(self, vobs, group, original_site, sites):

        [...]

        def _cbFailure(failure, site):
            self.resultsTable.failures.append(["None","None",
                Exception("Failure at site '%s'! The error is '%s'." %
                (site, str(failure)) )])
            return failure
            
        [...]

        deferreds = []
        for vob in vobs:
            for site in sites:
                ## Connect to exporting site
                d =
                self.connectToServer(config.siteToServer[original_site])
                ## Export the VOB to the site
                d.addCallback(_cbExport, vob,
                site).addErrback(_cbFailure, original_site)
                ## Connect to the importing site and import the VOB
                d.addCallback(_cbInitiateImport, vob, group,
                site).addErrback(_cbFailure, site)
                ## Add to the list of Deferreds
                deferreds.append(d)
                
        ## Stop the reactor when complete
        return defer.DeferredList(deferreds).addBoth(_cbStop)


When I attempt to login with an incorrect password, I get the following
output:



     Task: None, Step: None, Failure: Failure at site 'stby'! The error
     is '[Failure instance: Traceback from remote host -- Traceback
     unavailable]'.

Traceback from remote host -- Traceback unavailable


Is there something special I need to do to get the exception information
passed back to the client?

Thanks.
-Justin



From itamar at itamarst.org  Wed Jan 14 13:09:47 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 14 Jan 2004 15:09:47 -0500
Subject: [Twisted-Python] Handling UnauthorizedLogin Exception with PB
In-Reply-To: <20040114200412.890AF44DCA@server1.messagingengine.com>
References: <20040114200412.890AF44DCA@server1.messagingengine.com>
Message-ID: <1074110987.6502.18.camel@sheriffpony>

On Wed, 2004-01-14 at 15:04, Justin Johnson wrote:
>      Task: None, Step: None, Failure: Failure at site 'stby'! The error
>      is '[Failure instance: Traceback from remote host -- Traceback
>      unavailable]'.
> 
> Traceback from remote host -- Traceback unavailable

The info is available, I think, the traceback is not in any way relevant
anyway. I think this is mostly an issue with Failure display being
confusing.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From stenis at stenhard.net  Wed Jan 14 15:29:42 2004
From: stenis at stenhard.net (=?iso-8859-1?Q?Martin_Stenh=E5rd?=)
Date: Wed, 14 Jan 2004 23:29:42 +0100
Subject: [Twisted-Python] Adding pb users online
Message-ID: <E1AgtWh-0005HZ-00@pyramid.twistedmatrix.com>

Hi

I have the below code for my server with pb authentications. And thats
works fine clients can login and do CallRemote. The clients can also login
as an anonymous users to add them self to users database that are stored in
a MySQL table. My question is how do I reload my users using registerChecker
with out stopping the server? So that the current online users don't lose
there connections.

c = checkers.InMemoryUsernamePasswordDatabaseDontUse()
# users comes from a SQL db
for user in users: 
        
       print "User  Password  Email Status  Disable Lastlogin"
       print user.username," ",user.password," ",user.email,"
",user.status," ",user.disable," ",
       print time.ctime(user.lastlogin)        
       c.addUser(user.username,user.password)
realm =MyRealm()
realm.server = GameServer()
p = portal.Portal(realm)    
p.registerChecker(c)
reactor.listenTCP(8800, pb.PBServerFactory(p))
reactor.run

/Martin




From itamar at itamarst.org  Wed Jan 14 15:38:53 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Wed, 14 Jan 2004 17:38:53 -0500
Subject: [Twisted-Python] Adding pb users online
In-Reply-To: <E1AgtWh-0005HZ-00@pyramid.twistedmatrix.com>
References: <E1AgtWh-0005HZ-00@pyramid.twistedmatrix.com>
Message-ID: <1074119932.6504.95.camel@sheriffpony>

On Wed, 2004-01-14 at 17:29, Martin Stenhrd wrote:
> c = checkers.InMemoryUsernamePasswordDatabaseDontUse()
> # users comes from a SQL db
> for user in users: 
>         
>        print "User  Password  Email Status  Disable Lastlogin"
>        print user.username," ",user.password," ",user.email,"
> ",user.status," ",user.disable," ",
>        print time.ctime(user.lastlogin)        
>        c.addUser(user.username,user.password)

Don't use a checkers.InMemoryUsernamePasswordDatabaseDontUse (the name
is a hint ;). Instead write a checker that reads directly from the MySQL
database.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From michal at pasternak.w.lub.pl  Wed Jan 14 14:46:15 2004
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Wed, 14 Jan 2004 22:46:15 +0100
Subject: [Twisted-Python] Adding pb users online
In-Reply-To: <E1AgtWh-0005HZ-00@pyramid.twistedmatrix.com>
References: <E1AgtWh-0005HZ-00@pyramid.twistedmatrix.com>
Message-ID: <20040114214614.GA47991@pasternak.w.lub.pl>

Martin Stenh?rd [Wed, Jan 14, 2004 at 11:29:42PM +0100]:
> I have the below code for my server with pb authentications. And thats
> works fine clients can login and do CallRemote. The clients can also login
> as an anonymous users to add them self to users database that are stored in
> a MySQL table. My question is how do I reload my users using registerChecker
> with out stopping the server? So that the current online users don't lose
> there connections.
> 
> c = checkers.InMemoryUsernamePasswordDatabaseDontUse()

Instead of adding them to the above checker, write your own class, that
implements ICredentialsChecker and authenticates using queries to SQL
database.

You could implement some caching at that level, so it won't be really much
slower, than InMemory checker.

You could use FilePasswordDB as an example, defined in cred.checkers.



From douglas at paradise.net.nz  Thu Jan 15 04:36:26 2004
From: douglas at paradise.net.nz (Douglas Bagnall)
Date: Fri, 16 Jan 2004 00:36:26 +1300
Subject: [Twisted-Python] mktap/twistd make 2 copies of some objects?  (was Re: [Twisted-web]
 subtle copying in woven driving me crazy.)
In-Reply-To: <3FE644C6.5070204@paradise.net.nz>
References: <3FE56235.9000801@paradise.net.nz>
 <3FE56AD0.2050705@twistedmatrix.com> <3FE644C6.5070204@paradise.net.nz>
Message-ID: <40067B3A.3050309@paradise.net.nz>

A while ago in twisted-web, in a thread beginning here:

http://twistedmatrix.com/pipermail/twisted-web/2003-December/000061.html

I was complaining about twisted making a spare copy of an object used 
for guard credentials (meaning you can't add users on the fly).  I now 
think it stems from the pickling of objects between mktap and twistd. 
The checker is instantiated and pickled in mktap, because the guard code 
is called directly from updateApplication. But then when twistd runs, it 
is instantiated again for the rest of the app.

This makes two copies of my checker:

#!/bin/sh
kill `cat twistd.pid`
mktap2.3 upstage
twistd2.3  -f upstage.tap

and this doesn't:

#!/usr/bin/python
from upstage import app
from twisted.internet import reactor
app.updateApplication(reactor, {'webport':8083,'port':7232 })
reactor.run()


The code called in updateApplication goes a bit like this:

def updateApplication(app, options):
     docroot = website()
     app.listenTCP(webport, server.Site(docroot))

def website():
     docroot = static.File(config.HTDOCS)
     admin = adminWrapper(config.ADMIN)
     docroot.putChild('admin', admin)
     return docroot

class Checker(dict):
     __implements__ = checkers.ICredentialsChecker
     credentialInterfaces = (IUsernamePassword,)
     def requestAvatarId(self, credentials):
         player = self.get(credentials.username)
         if player and player.password == credentials.password:
             return credentials.username
         return failure.Failure(error.UnauthorizedLogin())

myCheckerThatGetsCopied = Checker({'p1': player1})

def adminWrapper(admin_dir):
     p = Portal(AdminRealm(admin_dir))
     p.registerChecker(AllowAnonymousAccess(), IAnonymous)
     p.registerChecker(myCheckerThatGetsCopied, IUsernamePassword)
     upw = guard.UsernamePasswordWrapper(p, callback=dumbRedirect)
     r = guard.SessionWrapper(upw)
     r.sessionLifetime = 12 * 3600
     return r


One workaround is wrapping the true checker in one that has no data:

class CheckerThatGetsCopiedWrapper:
     __implements__ = checkers.ICredentialsChecker
     credentialInterfaces = (credentials.IUsernamePassword,)

     def requestAvatarId(self, credentials):
         return myCheckerThatGetsCopied.requestAvatarId(credentials)


which is what I'm actually using now.  Is my diagnosis plausible?

regards,

douglas bagnall





From douglas at paradise.net.nz  Thu Jan 15 04:36:33 2004
From: douglas at paradise.net.nz (Douglas Bagnall)
Date: Fri, 16 Jan 2004 00:36:33 +1300
Subject: [Twisted-Python] announcing another twisted project
Message-ID: <40067B41.10302@paradise.net.nz>

hi all,

For a few months I've been working on software for some people who do 
"cyberformance", which boils down to being theatre in chat rooms.  They 
want to be able to do everything they can in their vintage Mac apps, but 
be accessable to a general audience.  So I've almost written a graphical 
chat thingy using SWF for the front end and twisted for the server.  I 
wasn't quite ready to announce it, but the Daily Python Url has gone and 
exposed it anyway.

The theatrical paradigm makes it very slightly different from most chat 
programs - for example, you don't need to log in to watch, but as 
audience you won't appear on stage; the "avatars" are more like puppets 
- players can exchange them during the performance without the audience 
knowing.  There are also a few unusual features, like text-to-speech 
processing (using Festival), and seconds-per-frame live video, to suit 
the particular performance style of the artists.  But really it's just a 
chat program.  And it's GPL'd, so if anyone wants a chat program, it 
wouldn't be too hard to configure the strange elements away (and I'd 
really appreciate anyone using it).

The flash part is generated entirely from actionscript, using the Ming 
compiler (http://ming.sf.net/), which I found to be easier than working 
  in Macromedia Flash, not to mention altogether freer.  You still need 
the flash plugin to view it though.

Some things about it are a bit broken, and the tests are woefully out of 
date. But there you go.

http://sourceforge.net/projects/upstage/ and http://upstage.org.nz/

cheers,

douglas





From itamar at itamarst.org  Thu Jan 15 07:29:58 2004
From: itamar at itamarst.org (Itamar Shtull-Trauring)
Date: Thu, 15 Jan 2004 09:29:58 -0500
Subject: [Twisted-Python] mktap/twistd make 2 copies of some objects? 
	(was Re: [Twisted-web] subtle copying in woven driving me crazy.)
In-Reply-To: <40067B3A.3050309@paradise.net.nz>
References: <3FE56235.9000801@paradise.net.nz>
	 <3FE56AD0.2050705@twistedmatrix.com> <3FE644C6.5070204@paradise.net.nz>
	 <40067B3A.3050309@paradise.net.nz>
Message-ID: <1074176998.6505.113.camel@sheriffpony>

On Thu, 2004-01-15 at 19:36, Douglas Bagnall wrote:
> which is what I'm actually using now.  Is my diagnosis plausible?

Yes - the checker on module-level is created from scratch when you start
the tap with twistd, and is different from the one you load from the
TAP.

In general, you should not store any important data (i.e. application
data) in the TAP. Implement some sort of external storage.

-- 
Itamar Shtull-Trauring    http://itamarst.org
Looking for a job: http://itamarst.org/resume.html




From ed at unidata.ucar.edu  Thu Jan 15 08:02:27 2004
From: ed at unidata.ucar.edu (Ed Hartnett)
Date: 15 Jan 2004 08:02:27 -0700
Subject: [Twisted-Python] can't get twisted to install on SunOS...
Message-ID: <wrxad4pgsqk.fsf@rodney.unidata.ucar.edu>

Howdy all!

I am using twisted as part of BuildBot, to automatically test my
software on various platforms.

One problem I am having on a couple of Suns is that twisted won't
install. I have python 2.2.3 installed as you can see from the
printout:

gilda.unidata.ucar.edu% python
Python 2.2.3 (#1, Jan 13 2004, 13:54:46) [C] on sunos5
Type "help", "copyright", "credits" or "license" for more information.
>>> 

bash-2.03# pwd
/home/ed/downloads/Twisted-1.1.1
bash-2.03# python setup.py install
Traceback (most recent call last):
  File "setup.py", line 43, in ?
    from twisted import copyright
  File "twisted/__init__.py", line 23, in ?
    from python import compat
  File "twisted/python/compat.py", line 27, in ?
    import sys, types, socket, struct, __builtin__, exceptions
  File "/usr/local/lib/python2.2/socket.py", line 41, in ?
    from _socket import *
ImportError: No module named _socket


What's the deal here? Any suggestions for getting Twisted working on
these suns?

I've had trouble before because of the weird directories that sun
uses, but this seems to be a problem within python.

Thanks for any suggestions,

Ed Hartnett
Unidata




From exarkun at intarweb.us  Thu Jan 15 08:14:16 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 15 Jan 2004 10:14:16 -0500
Subject: [Twisted-Python] can't get twisted to install on SunOS...
In-Reply-To: <wrxad4pgsqk.fsf@rodney.unidata.ucar.edu>
References: <wrxad4pgsqk.fsf@rodney.unidata.ucar.edu>
Message-ID: <20040115151416.GA22476@intarweb.us>

On Thu, Jan 15, 2004 at 08:02:27AM -0700, Ed Hartnett wrote:
> Howdy all!
> 
> I am using twisted as part of BuildBot, to automatically test my
> software on various platforms.
> 
> One problem I am having on a couple of Suns is that twisted won't
> install. I have python 2.2.3 installed as you can see from the
> printout:
> 
> gilda.unidata.ucar.edu% python
> Python 2.2.3 (#1, Jan 13 2004, 13:54:46) [C] on sunos5
> Type "help", "copyright", "credits" or "license" for more information.
> >>> 
> 
> bash-2.03# pwd
> /home/ed/downloads/Twisted-1.1.1
> bash-2.03# python setup.py install
> Traceback (most recent call last):
>   File "setup.py", line 43, in ?
>     from twisted import copyright
>   File "twisted/__init__.py", line 23, in ?
>     from python import compat
>   File "twisted/python/compat.py", line 27, in ?
>     import sys, types, socket, struct, __builtin__, exceptions
>   File "/usr/local/lib/python2.2/socket.py", line 41, in ?
>     from _socket import *
> ImportError: No module named _socket
> 
> 
> What's the deal here? Any suggestions for getting Twisted working on
> these suns?


  Does "python -c 'import socket'" raise the same exception?  I'm guessing
it does, in which case this indicates a problem with the Python install. 
Without the socket module, Twisted can't do a heck of a lot.

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20040115/1441654a/attachment.sig>

From michal at pasternak.w.lub.pl  Thu Jan 15 08:04:04 2004
From: michal at pasternak.w.lub.pl (Michal Pasternak)
Date: Thu, 15 Jan 2004 16:04:04 +0100
Subject: [Twisted-Python] can't get twisted to install on SunOS...
In-Reply-To: <wrxad4pgsqk.fsf@rodney.unidata.ucar.edu>
References: <wrxad4pgsqk.fsf@rodney.unidata.ucar.edu>
Message-ID: <20040115150404.GA96120@pasternak.w.lub.pl>

Ed Hartnett [Thu, Jan 15, 2004 at 08:02:27AM -0700]:
>   File "/usr/local/lib/python2.2/socket.py", line 41, in ?
>     from _socket import *
> ImportError: No module named _socket

Obviously, your Python installation came without socket module (which
results from bad ./configure --options while building)

You can either try to find package for it (some distributions split Python
package, and they do it with a reason) -- or, I suggest, as usual, taking a
look http://pkgsrc.org . I havent tested Python package on SunOS, but it
seems it comes there with socked module enabled.



From slepage at drummonddesigns.com  Thu Jan 15 12:12:37 2004
From: slepage at drummonddesigns.com (Steve Lepage)
Date: Thu, 15 Jan 2004 14:12:37 -0500
Subject: [Twisted-Python] Example with textbox and html
In-Reply-To: <20040115150404.GA96120@pasternak.w.lub.pl>
Message-ID: <002301c3db9b$89dc0ee0$667ba8c0@vicky>

Hi all,

I begin to program in nevow and I can't bind a textbox with variable
when I use html file to do sql request after. If I use Textbox.tac with
Textbox.html, I don't know how have a textbox and if I use formpost.tac,
I can have textbox binded with variable but I want to work with html
file.
Can people help me, please.

Textbox.tac
import random
from twisted.application import service
from twisted.application import internet
from nevow import renderer
from nevow import appserver
class Textbox(renderer.HTMLRenderer):
    def data_textbox(self, context, data):
        return " DDI Number: "
application = service.Application("Test")
internet.TCPServer(
    8888, 
    appserver.NevowSite(Textbox(templateFile = "Textbox.html"))
#    appserver.NevowSite(Textbox())
).setServiceParent(application)


Textbox.html
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>First windows with a texbox</title>
	</head>
	<body>
		<ol nevow:data="textbox" nevow:render="string"></ol>	
	</body>
</html>


formpost.tac
from twisted.application import service
from twisted.application import internet
from nevow import appserver
from nevow import renderer
from nevow import tags
from nevow import formless
from nevow import freeform
class IMyForm(formless.TypedInterface):
    foo = formless.Integer()
class FormPage(renderer.Renderer):
    __implements__ = IMyForm, renderer.Renderer.__implements__
    foo = 5
    document = tags.html[
    tags.body[
        "Hello! Here is a form:",
        freeform.configure
    ]
]
application = service.Application("formpost")
internet.TCPServer(
    8888, 
    appserver.NevowSite(
        FormPage()
    )
).setServiceParent(application)




From fabrice.coudert at free.fr  Fri Jan 16 08:22:58 2004
From: fabrice.coudert at free.fr (Fabrice Coudert)
Date: Fri, 16 Jan 2004 16:22:58 +0100
Subject: [Twisted-Python] deferred proposed update
Message-ID: <400801D2.2020805@free.fr>

Hi,

I 'd like to add a pre-processing and post-processing callback in a 
deferred callback list. I did somthing like this :

my_defer = getADeferredForSomething()
new_defer = defer.Deferred()
new_defer.addCallback(preprocessing)
new_defer.chainDeferred(my_defer)
new_defer.addCallback(postprocessing)
my_defer = new_defer

My problem is that postprocessing doesn't receive the result of the last 
callback in my_defer, but it reveive None.
This can be explained in twisted source by that chainDeferred(d) is 
equivalent to addCallbacks(d.callback, d.errback), but this two methods 
are not really sort of callback methods for deferred coz they didn't 
return a result.

So I patched Deferred class to add "return self.result", and it works well :

Deferred_old = defer.Deferred
class Deferred_new(Deferred_old):
    def callback(self, result):
        Deferred_old.callback(self, result)
        return self.result
    def errback(self, fail=None):
        Deferred_old.errback(self, fail)
        return self.result
defer.Deferred = Deferred_new

Notes by doing this you can also get final result when firing the 
callbacks :

final_result = my_defer.callback(result)

I dunno if this patch will fail something else in twisted.

fc.









From michael.l.schneider at ugsplm.com  Mon Jan 19 14:30:33 2004
From: michael.l.schneider at ugsplm.com (Schneider, Michael)
Date: Mon, 19 Jan 2004 16:30:33 -0500
Subject: [Twisted-Python] Running twisted tap file as NT service
Message-ID: <49199579A2BB32438A7572AF3DBB2FB538D50A@uscimplm001.net.plm.eds.com>

I am tring to convert a twisted .tap file (gridnoded.tap) to a service
for windows 2000 and XP.
 
I installed the required python packages:
        - inno
        - win32 extensions
      
 
 
What I have done:
    created .tap file
    run with twistd  (checks out ok)
    
 
 
When I run tap2ntsvc --help,  I get no output (error or help message).
 
what else do I have to do to get this going?
 
Thanks for your efforts with tap2ntsvc,  
 
Mike
------------------------------------------------------------------------------
 
I've finished the initial work on tap2ntsvc.  This script does the
tedious work of creating an installer around your Twisted service.  A
quick howto:

1. Create a tap or tac file for your application, using the method you
normally use.  **Test with twistd to make sure that you can start the
app from the command line, _before_ you wrap a service around it.**

2. Acquire and install the prerequisites of tap2ntsvc.  It depends on
software outside of Twisted, specifically:
win32all @ http://starship.python.net/crew/mhammond/win32/Downloads.html
Innoconda @ http://twistedmatrix.com/~moonfallen/innoconda.html

3. Run tap2ntsvc from the command line.  (*This is not yet integrated
with the "Twisted Command Prompt" available on MSWindows with the
official Twisted installer, but it will be when the script becomes an
official part of Twisted.) Use --help to get the command line options.
To start with, all you need to provide is the name of your tap or tac file.
| python .../Twisted/sandbox/moonfallen/tap2ntsvc myapp.tac
This will build an installable package using Innoconda.

4. Install the package.  It will be in myappsvc/myapp-...-setup.exe.

5. Start the service; it will fail, but you'll find out what modules you
need to add.
| net start myapp
**It's ok if this doesn't work.**

6. Check the Application event log to find out what modules failed to
import; you will be re-running py2exe after you add the missing modules.

7. Either: (a) re-run tap2ntsvc with the -i option or (b) add your
modules to myappsvc/setup.cfg on the "includes=" line.  If you choose to
do the latter, read myappsvc/README.txt to find out how to recompile
just the parts you need.

8. Redo steps 3 through 7 until you no longer get ImportErrors in the
Application log.

9. Some applications need data files.  If you need data files in your
application, consult myappsvc/README.txt and edit myappsvc/myapp.fms.
myapp.fms uses a special command language to make adding data files as
intuitive as possible.  You can put files in c:\Program Files\myapp or
any subdirectory thereof, so make sure your application code can find
data files there.

When you're done, you should be able to 'net start myapp' successfully.
~   When you want to rebuild it in the future, just keep these files in
your version control:
~  myappsvc/do_inno_script.py
~           do_inno.py
~           setup.cfg
~           setup.py
~           myapp.fms

Caveats, bugs, TODO:
- - you must be able to start your application in py2exe.  Things most
likely to not work are finding important data files based on the value
of __file__ in some module.
- - if you install the same service multiple times without uninstalling it
in between installs, then start it, then uninstall it, it will crash on
uninstall.  Just be sure to uninstall it in between installs while
you're experimenting.
- - I want to make the module finder more foolproof, saving several of the
steps above.  This is a non-trivial problem, however.
- - Really, it needs a frontend.  And I hate Tk.  Can I put a Gtk app into
~ Twisted proper? :-)


The future:
I want to move tap2ntsvc out of sandbox and into main Twisted.  I want
people to read this email over and try it before I do so, in case there
are important concerns I need to address.  We need to give some thought
to what to do about the 2 significant dependencies.  Should this block
tap2ntsvc from being in Twisted proper?  Is there a policy for this sort
of thing?


 
----------------------------------------------------------------
Michael Schneider
Senior Software Engineering Consultant
UGS PLM Solutions - an EDS Company
 
"The Greatest Performance Improvement Is the transitioning from a non-working state to the working state"
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20040119/d2d73936/attachment.html>

From rdrb at 123.cl  Tue Jan 27 07:22:04 2004
From: rdrb at 123.cl (=?iso-8859-1?Q?Rita_D=EDaz_y/o_Rodrigo_Benenson?=)
Date: Tue, 27 Jan 2004 11:22:04 -0300
Subject: [Twisted-Python] RPC over UDP
Message-ID: <004c01c3e4e0$f0191a10$4b30fea9@laboratorio>

Is there an UDP RPC twisted system aviable ? What happened to the UDP
support of PB ?
Khashmir has an airhook UDP RPC, but the code does not give 'quality
assurance' (at least at a psycholigical level). It is something similar
integrated in the Twisted Distro, or as an external package ?


rodrigob.




From tv at tv.debian.net  Tue Jan 20 02:30:09 2004
From: tv at tv.debian.net (Tommi Virtanen)
Date: Tue, 20 Jan 2004 11:30:09 +0200
Subject: [Twisted-Python] deferred proposed update
In-Reply-To: <400801D2.2020805@free.fr>
References: <400801D2.2020805@free.fr>
Message-ID: <400CF521.2030000@tv.debian.net>

Fabrice Coudert wrote:
> I 'd like to add a pre-processing and post-processing callback in a 
> deferred callback list. I did somthing like this :
 >
 > my_defer = getADeferredForSomething()
 > new_defer = defer.Deferred()
 > new_defer.addCallback(preprocessing)
 > new_defer.chainDeferred(my_defer)
 > new_defer.addCallback(postprocessing)
 > my_defer = new_defer

You are using Deferreds incorrectly. For example, nothing here
makes new_defer ever trigger.

You haven't stated clearly what you want to do, but I don't see
why you aren't just doing this:

d = getADeferredForSomething()
d.addCallback(preprocessing)
d.addCallback(theRealMcCoy)
d.addCallback(postprocessing)



From nopa90 at msn.com  Sun Jan 25 02:25:49 2004
From: nopa90 at msn.com (maxwell hammer)
Date: Sun, 25 Jan 2004 09:25:49 +0000
Subject: [Twisted-Python] Re: Adding pb users online
Message-ID: <BAY3-F375bd6xHCpWA00002366d@hotmail.com>

here is a mysql checker i made,
probably not the best job but you can fix it :)

from twisted.python import components, failure, log
from twisted.cred import error, credentials
from twisted.cred.checkers import ICredentialsChecker
from twisted.enterprise import adbapi

class MysqlPasswordDatabase :
    __implements__ = ICredentialsChecker

    credentialInterfaces = 
(credentials.IUsernamePassword,credentials.IUsernameHashedPassword)

    def __init__(self,db_name,db_username,db_password,table_name) :
        self.db_name=db_name
        self.db_username=db_username
        self.db_password=db_password
        self.table_name=table_name

        self.dbpool = adbapi.ConnectionPool("MySQLdb",host="localhost",
                                            db=db_name,
                                            user=db_username,
                                            passwd=db_password)
    def _dbResult(self,result,credentials) :
        #print result[0][0]
        #print credentials
        if result :
            if credentials.checkPassword(str(result[0][0])) :
                return credentials.username
            else :
                #print "Failing in password cmp"
                return failure.Failure(error.UnauthorizedLogin())
        else :
            #print "Failing in dbresult"
            return failure.Failure(error.UnauthorizedLogin())

    def _dbError(self,reason) :
        return failure.Failure(error.UnauthorizedLogin())

    def requestAvatarId(self,c) :
        print "requestAvatarID ",c
        d=self.dbpool.runQuery("SELECT pword FROM %s WHERE uname = '%s'" %
                              (self.table_name,c.username))
        d.addCallback(self._dbResult,c)
        d.addErrback(self._dbError)
        return d

anyway you get the idea, the above code works for me, but it assumes 
passwords are stored in plain text.

John Janecek

_________________________________________________________________
STOP MORE SPAM with the new MSN 8 and get 2 months FREE*   
http://join.msn.com/?page=dept/bcomm&pgmarket=en-ca&RU=http%3a%2f%2fjoin.msn.com%2f%3fpage%3dmisc%2fspecialoffers%26pgmarket%3den-ca




From michaelschneider at fuse.net  Wed Jan 28 06:13:42 2004
From: michaelschneider at fuse.net (Mike Schneider)
Date: Wed, 28 Jan 2004 8:13:42 -0500
Subject: [Twisted-Python] Beepy Twisted Library
Message-ID: <20040128131342.PAAV5308.smtp1.fuse.net@smtp.fuse.net>

After reading the emails on the list I downloaded the Beepy
Twisted BEEP library.

I read the included docs, and looked at the test cases.

I had a server and client up in less than an hour.

Thank you for your work on this package.  I am going to
spend more time prototyping today.


I like the development style:
   - simple short tests
   - test cases that serve as models for code development


FYI.  I am running Python2.3 on Windows, so I had to download
PyOpenSSL from:



This should be a very popular protocol for people developing peer-to-peer
solutions.


Thank you for your good work, Beepy is being used!!!!!!!
Mike


PS.  The test cases were very valuable.  If you have to choose between more docs and more testcases/examples.  my +1 would be for more test cases/examples




From corydodt at twistedmatrix.com  Wed Jan 28 09:11:36 2004
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Wed, 28 Jan 2004 08:11:36 -0800
Subject: [Twisted-Python] Running twisted tap file as NT service
In-Reply-To: <49199579A2BB32438A7572AF3DBB2FB538D50A@uscimplm001.net.plm.eds.com>
References: <49199579A2BB32438A7572AF3DBB2FB538D50A@uscimplm001.net.plm.eds.com>
Message-ID: <4017DF38.9080201@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Thanks for trying it out.

Can you provide more details on how you ran tap2ntsvc from the command line?
The exact command line, environment (especially PYTHONPATH), working
directory, what shell (whether cygwin or windows)...

I am able to run it by ...

Start > Run... > "cmd"
C:\winnt\system32>cd %twisted%\sandbox\moonfallen
C:\...\Twisted-HEAD\sandbox\moonfallen>python tap2ntsvc --help
<<< output here >>>

C





Schneider, Michael wrote:

| I am tring to convert a twisted .tap file (gridnoded.tap) to a service
| for windows 2000 and XP.
|
| I installed the required python packages:
|         - inno
|         - win32 extensions
|
|
|
| What I have done:
|     created .tap file
|     run with twistd  (checks out ok)
|
|
|
| When I run tap2ntsvc --help,  I get no output (error or help message).
|
| what else do I have to do to get this going?
|
| Thanks for your efforts with tap2ntsvc,
|
| Mike
| ------------------------------------------------------------------------------
|
| I've finished the initial work on tap2ntsvc.  This script does the
| tedious work of creating an installer around your Twisted service.  A
| quick howto:
|
| 1. Create a tap or tac file for your application, using the method you
| normally use.  **Test with twistd to make sure that you can start the
| app from the command line, _before_ you wrap a service around it.**
|
| 2. Acquire and install the prerequisites of tap2ntsvc.  It depends on
| software outside of Twisted, specifically:
| win32all @ http://starship.python.net/crew/mhammond/win32/Downloads.html
| Innoconda @ http://twistedmatrix.com/~moonfallen/innoconda.html
|
| 3. Run tap2ntsvc from the command line.  (*This is not yet integrated
| with the "Twisted Command Prompt" available on MSWindows with the
| official Twisted installer, but it will be when the script becomes an
| official part of Twisted.) Use --help to get the command line options.
| To start with, all you need to provide is the name of your tap or tac file.
| |/ python .../Twisted/sandbox/moonfallen/tap2ntsvc myapp.tac
| /This will build an installable package using Innoconda.
|
| 4. Install the package.  It will be in myappsvc/myapp-...-setup.exe.
|
| 5. Start the service; it will fail, but you'll find out what modules you
| need to add.
| |/ net start myapp
| /**It's ok if this doesn't work.**
|
| 6. Check the Application event log to find out what modules failed to
| import; you will be re-running py2exe after you add the missing modules.
|
| 7. Either: (a) re-run tap2ntsvc with the -i option or (b) add your
| modules to myappsvc/setup.cfg on the "includes=" line.  If you choose to
| do the latter, read myappsvc/README.txt to find out how to recompile
| just the parts you need.
|
| 8. Redo steps 3 through 7 until you no longer get ImportErrors in the
| Application log.
|
| 9. Some applications need data files.  If you need data files in your
| application, consult myappsvc/README.txt and edit myappsvc/myapp.fms.
| myapp.fms uses a special command language to make adding data files as
| intuitive as possible.  You can put files in c:\Program Files\myapp or
| any subdirectory thereof, so make sure your application code can find
| data files there.
|
| When you're done, you should be able to 'net start myapp' successfully.
| ~   When you want to rebuild it in the future, just keep these files in
| your version control:
| ~  myappsvc/do_inno_script.py
| ~           do_inno.py
| ~           setup.cfg
| ~           setup.py
| ~           myapp.fms
|
| Caveats, bugs, TODO:
| - - you must be able to start your application in py2exe.  Things most
| likely to not work are finding important data files based on the value
| of __file__ in some module.
| - - if you install the same service multiple times without uninstalling it
| in between installs, then start it, then uninstall it, it will crash on
| uninstall.  Just be sure to uninstall it in between installs while
| you're experimenting.
| - - I want to make the module finder more foolproof, saving several of the
| steps above.  This is a non-trivial problem, however.
| - - Really, it needs a frontend.  And I hate Tk.  Can I put a Gtk app into
| ~ Twisted proper? :-)
|
|
| The future:
| I want to move tap2ntsvc out of sandbox and into main Twisted.  I want
| people to read this email over and try it before I do so, in case there
| are important concerns I need to address.  We need to give some thought
| to what to do about the 2 significant dependencies.  Should this block
| tap2ntsvc from being in Twisted proper?  Is there a policy for this sort
| of thing?
|
|
| ----------------------------------------------------------------
| Michael Schneider
| Senior Software Engineering Consultant
| UGS PLM Solutions - an EDS Company
|
| "The Greatest Performance Improvement Is the transitioning from a
| non-working state to the working state"
|

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3-nr1 (Windows 2000)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQFAF9843A5SrXAiHQcRAjdzAJ9ugdK22esEoT4y7l0pone57oLY4wCfcexP
kmexXNkM3uV5iLXeWDUveI0=
=MqSP
-----END PGP SIGNATURE-----



From fabrice.coudert at free.fr  Thu Jan 29 00:41:59 2004
From: fabrice.coudert at free.fr (Fabrice Coudert)
Date: Thu, 29 Jan 2004 08:41:59 +0100
Subject: [Twisted-Python] deferred proposed update
In-Reply-To: <400CF521.2030000@tv.debian.net>
References: <400801D2.2020805@free.fr> <400CF521.2030000@tv.debian.net>
Message-ID: <4018B947.9060102@free.fr>

Tommi Virtanen a crit :

> Fabrice Coudert wrote:
>
>> I 'd like to add a pre-processing and post-processing callback in a 
>> deferred callback list. I did somthing like this :
>
> >
> > my_defer = getADeferredForSomething()
> > new_defer = defer.Deferred()
> > new_defer.addCallback(preprocessing)
> > new_defer.chainDeferred(my_defer)
> > new_defer.addCallback(postprocessing)
> > my_defer = new_defer
>
> You are using Deferreds incorrectly. For example, nothing here
> makes new_defer ever trigger.

It is a sample code to show inconcistency of chainDeferred, not a real
case. Add my_defer.callback(True) after the sample code if you'd like
and trace it. You should see that postprocessing() is called with None
argument, but not with the result of previous callback as it should be
with a normal behaviour of deferred callbacks (read the tutorial)

>
> You haven't stated clearly what you want to do, but I don't see
> why you aren't just doing this:
>
> d = getADeferredForSomething()
> d.addCallback(preprocessing)
> d.addCallback(theRealMcCoy)
> d.addCallback(postprocessing)
>
Same as before, it is a *sample code*.
In real case theRealMcCoy (and some more methodes) is added before I
need to add a post/preprocessing to that defer.

So, I restate the probleme with chainDeferred :
chainDeferred(d) is equivalent to addCallbacks(d.callback, d.errback),
but this two methods are not really sort of callback methods for
deferred coz they didn't return a result.

effcy.










From glyph at twistedmatrix.com  Thu Jan 29 08:09:22 2004
From: glyph at twistedmatrix.com (Glyph Lefkowitz)
Date: Thu, 29 Jan 2004 10:09:22 -0500
Subject: [Twisted-Python] deferred proposed update
In-Reply-To: <4018B947.9060102@free.fr>
References: <400801D2.2020805@free.fr> <400CF521.2030000@tv.debian.net> <4018B947.9060102@free.fr>
Message-ID: <40192222.1030605@twistedmatrix.com>

Fabrice Coudert wrote:

> So, I restate the probleme with chainDeferred :
> chainDeferred(d) is equivalent to addCallbacks(d.callback, d.errback),
> but this two methods are not really sort of callback methods for
> deferred coz they didn't return a result.

This is not a problem, this is a specification of the way it works.  
chainDeferred is a holdover from before one could sensibly return one 
Deferred from the callback to another.  If you want to add callbacks in 
some other way, don't use chainDeferred.



From foom at fuhm.net  Thu Jan 29 13:48:31 2004
From: foom at fuhm.net (James Y Knight)
Date: Thu, 29 Jan 2004 15:48:31 -0500
Subject: [Twisted-Python] deferred proposed update
In-Reply-To: <40192222.1030605@twistedmatrix.com>
References: <400801D2.2020805@free.fr> <400CF521.2030000@tv.debian.net> <4018B947.9060102@free.fr> <40192222.1030605@twistedmatrix.com>
Message-ID: <7F67E8F1-529C-11D8-961D-000A95A50FB2@fuhm.net>

On Jan 29, 2004, at 10:09 AM, Glyph Lefkowitz wrote:

> Fabrice Coudert wrote:
>
>> So, I restate the probleme with chainDeferred :
>> chainDeferred(d) is equivalent to addCallbacks(d.callback, d.errback),
>> but this two methods are not really sort of callback methods for
>> deferred coz they didn't return a result.
>
> This is not a problem, this is a specification of the way it works.  
> chainDeferred is a holdover from before one could sensibly return one 
> Deferred from the callback to another.  If you want to add callbacks 
> in some other way, don't use chainDeferred.

So, the right way to do what he asks is...? Perhaps this?

my_defer = getADeferredForSomething()
new_defer = defer.Deferred()
new_defer.addCallback(preprocessing)
new_defer.addCallback(lambda x: return my_defer)
new_defer.addCallback(postprocessing)
my_defer = new_defer

James




From fab.coudert at free.fr  Wed Jan 28 11:22:40 2004
From: fab.coudert at free.fr (Fabrice Coudert)
Date: Wed, 28 Jan 2004 19:22:40 +0100
Subject: [Twisted-Python] deferred proposed update
In-Reply-To: <400CF521.2030000@tv.debian.net>
References: <400801D2.2020805@free.fr> <400CF521.2030000@tv.debian.net>
Message-ID: <4017FDF0.3070707@free.fr>

Tommi Virtanen a crit :

> Fabrice Coudert wrote:
>
>> I 'd like to add a pre-processing and post-processing callback in a 
>> deferred callback list. I did somthing like this :
>
> >
> > my_defer = getADeferredForSomething()
> > new_defer = defer.Deferred()
> > new_defer.addCallback(preprocessing)
> > new_defer.chainDeferred(my_defer)
> > new_defer.addCallback(postprocessing)
> > my_defer = new_defer
>
> You are using Deferreds incorrectly. For example, nothing here
> makes new_defer ever trigger.

It is a sample code to show inconcistency of chainDeferred, not a real 
case. Add my_defer.callback(True) after the sample code if you'd like 
and trace it. You should see that postprocessing() is called with None 
argument, but not with the result of previous callback as it should be 
with a normal behaviour of deferred callbacks (read the tutorial)

>
> You haven't stated clearly what you want to do, but I don't see
> why you aren't just doing this:
>
> d = getADeferredForSomething()
> d.addCallback(preprocessing)
> d.addCallback(theRealMcCoy)
> d.addCallback(postprocessing)
>
Same as before, it is a *sample code*.
In real case theRealMcCoy (and some more methodes) is added before I 
need to add a post/preprocessing to that defer.

So, I restate the probleme with chainDeferred : 
chainDeferred(d) is equivalent to addCallbacks(d.callback, d.errback), 
but this two methods are not really sort of callback methods for 
deferred coz they didn't return a result.

effcy.








From exarkun at intarweb.us  Thu Jan 29 21:48:18 2004
From: exarkun at intarweb.us (Jp Calderone)
Date: Thu, 29 Jan 2004 23:48:18 -0500
Subject: [Twisted-Python] deferred proposed update
In-Reply-To: <4017FDF0.3070707@free.fr>
References: <400801D2.2020805@free.fr> <400CF521.2030000@tv.debian.net> <4017FDF0.3070707@free.fr>
Message-ID: <20040130044818.GB27862@intarweb.us>

On Wed, Jan 28, 2004 at 07:22:40PM +0100, Fabrice Coudert wrote:
> Tommi Virtanen a ?crit :
> 
> >Fabrice Coudert wrote:
> >
> >>I 'd like to add a pre-processing and post-processing callback in a 
> >>deferred callback list. I did somthing like this :
> >
> >>
> >> my_defer = getADeferredForSomething()
> >> new_defer = defer.Deferred()
> >> new_defer.addCallback(preprocessing)
> >> new_defer.chainDeferred(my_defer)
> >> new_defer.addCallback(postprocessing)
> >> my_defer = new_defer
> >
> >You are using Deferreds incorrectly. For example, nothing here
> >makes new_defer ever trigger.
> 
> It is a sample code to show inconcistency of chainDeferred, not a real 
> case. Add my_defer.callback(True) after the sample code if you'd like 
> and trace it. You should see that postprocessing() is called with None 
> argument, but not with the result of previous callback as it should be 
> with a normal behaviour of deferred callbacks (read the tutorial)

  Without a use case, there's no chance of the behavior changing.  False
consistency is the hobgoblin of, etc.

> 
> >
> >You haven't stated clearly what you want to do, but I don't see
> >why you aren't just doing this:
> >
> >d = getADeferredForSomething()
> >d.addCallback(preprocessing)
> >d.addCallback(theRealMcCoy)
> >d.addCallback(postprocessing)
> >
> Same as before, it is a *sample code*.
> In real case theRealMcCoy (and some more methodes) is added before I 
> need to add a post/preprocessing to that defer.

  If the code you included in your message isn't equivalent to the code
you're using in your actual application, then it's a waste of time to
discuss it.  If it is equivalent, I don't see why you can't use the code
glyph suggested.

> 
> So, I restate the probleme with chainDeferred : 
> chainDeferred(d) is equivalent to addCallbacks(d.callback, d.errback), 
> but this two methods are not really sort of callback methods for 
> deferred coz they didn't return a result.
> 

  If it doesn't do what you want, don't use it.  For that matter, even if it
does, you can probably avoid using it.  As glyph stated, it is a hold-over
from times past.  If you can share the real use case, maybe someone can help
you reformulate it in terms of more recent APIs.

> effcy.
> 

  Jp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: </pipermail/twisted-python/attachments/20040129/a45c4a07/attachment.sig>

From michael.l.schneider at ugsplm.com  Fri Jan 30 09:23:42 2004
From: michael.l.schneider at ugsplm.com (Schneider, Michael)
Date: Fri, 30 Jan 2004 11:23:42 -0500
Subject: [Twisted-Python] Running twisted tap file as NT service
Message-ID: <49199579A2BB32438A7572AF3DBB2FB538D518@uscimplm001.net.plm.eds.com>

Thanks for the guide.

I am able to create a ntservice .exe, attached is the command that
I used, and the output.

My application is in the gridnode package, and it depends on twisted
and standard python.


Really Stupid question time. I have very little expericence with
deploying windows services.  

What do I do next to install this?
Since you leverage py2exe, does python need to be installed on the
machines (I am rolling this out to several hundred machines, and
python is not installed on those machine at this time)?



Thank you very much for your work on this tool!!!!!!!!!!!!!!

Mike
------------------- Command and Command Output

D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>python tap2ntsvc --name="gridnoded" --display_name=gridnoded --disp
lay_name="Grid Node Service" --type=pickle --include=gridnode d:\grid\gridnoded.tap



C:\Python23\Lib\site-packages\py2exe\build_exe.py:992: DeprecationWarning: Non-ASCII character '\xa9' in file C:\Python2
3\Lib\site-packages\py2exe\resources\VersionInfo.py on line 226, but no encoding declared; see http://www.python.org/pep
s/pep-0263.html for details
  from resources.VersionInfo import VS_VERSIONINFO, RT_VERSION, \
C:\Python23\Lib\site-packages\py2exe\resources\VersionInfo.py:70: FutureWarning: hex/oct constants > sys.maxint will ret
urn positive values in Python 2.4 and up
  dwSignature = 0xFEEF04BD
warning: py2exe: could not parse version number ''
  No VersionInfo will be created
warning: py2exe: *************************************************************************
warning: py2exe: * The following modules were not found:
warning: py2exe: *   Carbon.Folder
warning: py2exe: *   Carbon.Folders
warning: py2exe: *   Crypto.Cipher
warning: py2exe: *   OpenSSL
warning: py2exe: *   SOCKS
warning: py2exe: *   _ssl
warning: py2exe: *   _xmlplus
warning: py2exe: *   _xmlrpclib
warning: py2exe: *   fcntl
warning: py2exe: *   grp
warning: py2exe: *   ic
warning: py2exe: *   jarray
warning: py2exe: *   java.io.IOException
warning: py2exe: *   java.io.InterruptedIOException
warning: py2exe: *   java.net
warning: py2exe: *   readline
warning: py2exe: *   rourl2path
warning: py2exe: *   sgi
warning: py2exe: *   sgmlop
warning: py2exe: *************************************************************************
Built File dist\gridnodedsvc\gridnodedsvc.exe
Created gridnoded.fms
Inno Setup 4 Command-Line Compiler
Copyright (C) 1998-2003 Jordan Russell. All rights reserved.
Portions by Martijn Laan

Compiler engine version: Inno Setup 4.0.9

Reading [Setup] section, line 18
Reading [Setup] section, line 19
Reading [Setup] section, line 20
Reading [Setup] section, line 21
Reading [Setup] section, line 22
Reading [Setup] section, line 23
Reading file (WizardImage)
   File: C:\Python23\Lib\site-packages\inno\program\WIZMODERNIMAGE.BMP
Reading file (WizardSmallImage)
   File: C:\Python23\Lib\site-packages\inno\program\WIZMODERNSMALLIMAGE.BMP
Reading [LangOptions] and [Messages] sections
   File: C:\Python23\Lib\site-packages\inno\program\DEFAULT.ISL
   Messages in script file
Reading [Code] section
Reading [Dirs] section, line 16
Reading [Icons] section, line 25
Reading [Run] section, line 27
Reading [Run] section, line 28
Reading [UninstallRun] section, line 30
Reading [UninstallRun] section, line 31
   Reading version info: C:\Python23\Lib\site-packages\inno\program\UNINST.E32
Reading [Files] section, line 2
Reading [Files] section, line 3
Reading [Files] section, line 4
Reading [Files] section, line 5
Reading [Files] section, line 6
Reading [Files] section, line 7
Reading [Files] section, line 8
Reading [Files] section, line 9
Reading [Files] section, line 10
Reading [Files] section, line 11
Reading [Files] section, line 12
Reading [Files] section, line 13
Reading [Files] section, line 14
Creating setup files
   Compressing: C:\Python23\Lib\site-packages\inno\program\UNINST.E32   (51.9.0.0)
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\gridnoded.tap
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\gridnodedsvc.exe
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\parser.pyd
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\pyexpat.pyd
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\python23.dll
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\PyWinTypes23.dll
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\select.pyd
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\win32api.pyd
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\win32process.pyd
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\win32service.pyd
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\_socket.pyd
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\_sre.pyd
   Compressing: D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\_winreg.pyd


Successful compile (1.402 sec). Resulting Setup program filename is:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\gridnoded-1.0-setup.exe

Output written to D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\gridnodedsvc\gridnoded-setup-1.0.exe

tap2ntsvc: 0 warnings.

D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>
 



From corydodt at twistedmatrix.com  Fri Jan 30 10:41:59 2004
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Fri, 30 Jan 2004 09:41:59 -0800
Subject: [Twisted-Python] Running twisted tap file as NT service
In-Reply-To: <49199579A2BB32438A7572AF3DBB2FB538D518@uscimplm001.net.plm.eds.com>
References: <49199579A2BB32438A7572AF3DBB2FB538D518@uscimplm001.net.plm.eds.com>
Message-ID: <401A9767.7050206@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Tap2ntsvc creates a package structured like the following:

+-----------------------------------------------+
|   inno setup installer                        |
|      +--------------------------------+       |
|      |     py2exe'd executable        |       |
|      |        +-----------------+     |       |
|      |        |  your app  code |     |       |
|      |        +-----------------+     |       |
|      |                                |       |
|      +--------------------------------+       |
|                                               |
+-----------------------------------------------+

The py2exe'd executable is dynamically linked with pythonxx.dll, which is in
your directory.  (It's just a stub attached to a zip file; the stub runs
python on the zipped modules.  You can actually open it with winzip etc.)

The output, that -setup.exe, can be run on the machine where you want the
service, and it will (by default) place the py2exe stuff and whatever data
files you added to gridnode.fms in C:\program files\gridnode.  It will also
install the service as the first operation.

If you remembered all your includes when you built, all you need is the setup
executable and you have a fully functioning service.  Start it with "net start
gridnode" from the command line or Start>Settings>ControlPanel>Services>select
gridnode and click start, or just reboot.

Be sure to check the event logs when you do; it sometimes takes several
attempts before you collect all the modules py2exe didn't find on its own.

(Incidentally, psloglist is the best way to do this from the command line:
http://www.sysinternals.com/ntw2k/freeware/psloglist.shtml.)

C




Schneider, Michael wrote:

| Thanks for the guide.
|
| I am able to create a ntservice .exe, attached is the command that
| I used, and the output.
|
| My application is in the gridnode package, and it depends on twisted
| and standard python.
|
|
| Really Stupid question time. I have very little expericence with
| deploying windows services.
|
| What do I do next to install this?
| Since you leverage py2exe, does python need to be installed on the
| machines (I am rolling this out to several hundred machines, and
| python is not installed on those machine at this time)?
|
|
|
| Thank you very much for your work on this tool!!!!!!!!!!!!!!
|
| Mike
| ------------------- Command and Command Output
|
| D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>python tap2ntsvc
- --name="gridnoded" --display_name=gridnoded --disp
| lay_name="Grid Node Service" --type=pickle --include=gridnode
d:\grid\gridnoded.tap
|
|
|
| C:\Python23\Lib\site-packages\py2exe\build_exe.py:992: DeprecationWarning:
Non-ASCII character '\xa9' in file C:\Python2
| 3\Lib\site-packages\py2exe\resources\VersionInfo.py on line 226, but no
encoding declared; see http://www.python.org/pep
| s/pep-0263.html for details
|   from resources.VersionInfo import VS_VERSIONINFO, RT_VERSION, \
| C:\Python23\Lib\site-packages\py2exe\resources\VersionInfo.py:70:
FutureWarning: hex/oct constants > sys.maxint will ret
| urn positive values in Python 2.4 and up
|   dwSignature = 0xFEEF04BD
| warning: py2exe: could not parse version number ''
|   No VersionInfo will be created
| warning: py2exe:
*************************************************************************
| warning: py2exe: * The following modules were not found:
| warning: py2exe: *   Carbon.Folder
| warning: py2exe: *   Carbon.Folders
| warning: py2exe: *   Crypto.Cipher
| warning: py2exe: *   OpenSSL
| warning: py2exe: *   SOCKS
| warning: py2exe: *   _ssl
| warning: py2exe: *   _xmlplus
| warning: py2exe: *   _xmlrpclib
| warning: py2exe: *   fcntl
| warning: py2exe: *   grp
| warning: py2exe: *   ic
| warning: py2exe: *   jarray
| warning: py2exe: *   java.io.IOException
| warning: py2exe: *   java.io.InterruptedIOException
| warning: py2exe: *   java.net
| warning: py2exe: *   readline
| warning: py2exe: *   rourl2path
| warning: py2exe: *   sgi
| warning: py2exe: *   sgmlop
| warning: py2exe:
*************************************************************************
| Built File dist\gridnodedsvc\gridnodedsvc.exe
| Created gridnoded.fms
| Inno Setup 4 Command-Line Compiler
| Copyright (C) 1998-2003 Jordan Russell. All rights reserved.
| Portions by Martijn Laan
|
| Compiler engine version: Inno Setup 4.0.9
|
| Reading [Setup] section, line 18
| Reading [Setup] section, line 19
| Reading [Setup] section, line 20
| Reading [Setup] section, line 21
| Reading [Setup] section, line 22
| Reading [Setup] section, line 23
| Reading file (WizardImage)
|    File: C:\Python23\Lib\site-packages\inno\program\WIZMODERNIMAGE.BMP
| Reading file (WizardSmallImage)
|    File: C:\Python23\Lib\site-packages\inno\program\WIZMODERNSMALLIMAGE.BMP
| Reading [LangOptions] and [Messages] sections
|    File: C:\Python23\Lib\site-packages\inno\program\DEFAULT.ISL
|    Messages in script file
| Reading [Code] section
| Reading [Dirs] section, line 16
| Reading [Icons] section, line 25
| Reading [Run] section, line 27
| Reading [Run] section, line 28
| Reading [UninstallRun] section, line 30
| Reading [UninstallRun] section, line 31
|    Reading version info: C:\Python23\Lib\site-packages\inno\program\UNINST.E32
| Reading [Files] section, line 2
| Reading [Files] section, line 3
| Reading [Files] section, line 4
| Reading [Files] section, line 5
| Reading [Files] section, line 6
| Reading [Files] section, line 7
| Reading [Files] section, line 8
| Reading [Files] section, line 9
| Reading [Files] section, line 10
| Reading [Files] section, line 11
| Reading [Files] section, line 12
| Reading [Files] section, line 13
| Reading [Files] section, line 14
| Creating setup files
|    Compressing: C:\Python23\Lib\site-packages\inno\program\UNINST.E32
(51.9.0.0)
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\gridnoded.tap
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\gridnodedsvc.exe
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\parser.pyd
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\pyexpat.pyd
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\python23.dll
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\PyWinTypes23.dll
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\select.pyd
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\win32api.pyd
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\win32process.pyd
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\win32service.pyd
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\_socket.pyd
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\_sre.pyd
|    Compressing:
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\dist\gridnodedsvc\_winreg.pyd
|
|
| Successful compile (1.402 sec). Resulting Setup program filename is:
|
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\gridnoded-1.0-setup.exe
|
| Output written to
D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen\gridnodedsvc\gridnodedsvc\gridnoded-setup-1.0.exe
|
| tap2ntsvc: 0 warnings.
|
| D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>
| D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>
| D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>
| D:\grid\work\python\Twisted-1.1.1\sandbox\moonfallen>
|
|
| _______________________________________________
| Twisted-Python mailing list
| Twisted-Python at twistedmatrix.com
| http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3-nr1 (Windows 2000)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQFAGpdn3A5SrXAiHQcRAhuSAJ9JS/gkYInzBsZN0I8+BA036pjUVQCfUV7t
p+PZrwMiupJXt2sd2xZgl8s=
=hzVT
-----END PGP SIGNATURE-----



