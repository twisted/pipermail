From itamar at itamarst.org  Tue May  1 16:09:37 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Tue, 01 May 2012 16:09:37 -0400
Subject: [Twisted-Python] Releasing 12.1
Message-ID: <4FA04301.8000005@itamarst.org>

Once 12.1 is out, we'll be able to drop Python 2.5 support in trunk. 
This will make life easier for one of our Google Summer of Code students 
who will be working on the start of Python 3 support, so it'd be good to 
get it done soon. In order to release 12.1, we need:

1. To finish code reviews of remaining 12.1 tickets and merge: 
http://twistedmatrix.com/trac/query?status=assigned&status=new&status=reopened&group=status&milestone=Twisted-12.1

These include two gtk3 tickets: gtk3 is new in 12.1, and I'd like to 
ship it bug free and feature complete. There's also a couple of tickets 
which will make epoll the default reactor on Linux. While not strictly 
necessary, they should be easy enough to get merged and it's a great 
feature to have in; if they become a bottleneck we can drop this and 
wait until the next release.

2. A volunteer to do the release. Any takers?

-Itamar


From dmitriy at fogcreek.com  Tue May  1 16:38:09 2012
From: dmitriy at fogcreek.com (Dmitriy Komarov)
Date: Tue, 1 May 2012 16:38:09 -0400
Subject: [Twisted-Python] (no subject)
Message-ID: <CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com>

Hi All,

Our team is setting up Twisted to access Mercurial over SSH.

SSH connection, key exchange, and receiving large amount of data from the
client work nicely,
but sending server data back to the client ends up with a PuTTY Fatal Error
"Incoming packet was garbled on decryption" at a random point.

If plink compression is disabled, the error happens very rarely, but
overall SSH performance becomes unacceptable.
If plink uses compression, the error occurs within 1-10 seconds from
starting data download.

To make things more hectic, on a rare occasion, PuTTY reports "Incorrect
MAC received on packet" instead of "garbled on decryption".

If anyone had a similar issue before, I'd appreciate any pointers on
resolving or avoiding it.


Sincerely,
- Dmitriy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120501/f8fa7283/attachment.htm 

From itamar at itamarst.org  Tue May  1 18:27:23 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Tue, 01 May 2012 18:27:23 -0400
Subject: [Twisted-Python] (no subject)
In-Reply-To: <CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com>
References: <CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com>
Message-ID: <4FA0634B.8000904@itamarst.org>

On 05/01/2012 04:38 PM, Dmitriy Komarov wrote:
> Hi All,
>
> Our team is setting up Twisted to access Mercurial over SSH.
So this means SSH is on the server side, right?

> SSH connection, key exchange, and receiving large amount of data from 
> the client work nicely,
> but sending server data back to the client ends up with a PuTTY Fatal 
> Error "Incoming packet was garbled on decryption" at a random point.
>
> If plink compression is disabled, the error happens very rarely, but 
> overall SSH performance becomes unacceptable.
> If plink uses compression, the error occurs within 1-10 seconds from 
> starting data download.
>
> To make things more hectic, on a rare occasion, PuTTY reports 
> "Incorrect MAC received on packet" instead of "garbled on decryption".
>
> If anyone had a similar issue before, I'd appreciate any pointers on 
> resolving or avoiding it.
>

What version of Twisted are you using? Likewise, what versions of 
PyCrypto and pyASN1? I imagine issues could be in any of the three. If 
you're using up-to-date versions of each, I don't see any pending 
tickets or post-Twisted-12.0 bugfixes that reflect this, in which case a 
good next step would be a minimal reproducing example.






From itamar at itamarst.org  Wed May  2 00:37:45 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Wed, 02 May 2012 00:37:45 -0400
Subject: [Twisted-Python] (no subject)
In-Reply-To: <CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com>
References: <CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com>
Message-ID: <4FA0BA19.8070009@itamarst.org>

On 05/01/2012 04:38 PM, Dmitriy Komarov wrote:
> If anyone had a similar issue before, I'd appreciate any pointers on 
> resolving or avoiding it.
>
Actually, one thing does occur to me - are you using the IOCP reactor? 
If so, try the select() reactor, the IOCP reactor unfortunately has a 
bunch of serious bugs. I'm vaguely considering working on those as my 
next Twisted work, since they're embarrassing and IOCP is so much better 
than select() on Windows.


From glyph at twistedmatrix.com  Wed May  2 14:57:53 2012
From: glyph at twistedmatrix.com (Glyph)
Date: Wed, 2 May 2012 14:57:53 -0400
Subject: [Twisted-Python] (no subject)
In-Reply-To: <4FA0BA19.8070009@itamarst.org>
References: <CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com>
	<4FA0BA19.8070009@itamarst.org>
Message-ID: <7EACC5C0-66FE-4B04-99E5-2725511B212B@twistedmatrix.com>

On May 2, 2012, at 12:37 AM, Itamar Turner-Trauring wrote:

> a bunch of serious bugs

Can you be more specific?  Let's not spread vague FUD about ourselves :).

I suspect you're mostly talking about <http://twistedmatrix.com/trac/ticket/1551>, which, yes, is somewhat embarrassing.

-g
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120502/e4fa9d26/attachment.htm 

From itamar at itamarst.org  Wed May  2 15:22:30 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Wed, 02 May 2012 15:22:30 -0400
Subject: [Twisted-Python] (no subject)
In-Reply-To: <7EACC5C0-66FE-4B04-99E5-2725511B212B@twistedmatrix.com>
References: <CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com>
	<4FA0BA19.8070009@itamarst.org>
	<7EACC5C0-66FE-4B04-99E5-2725511B212B@twistedmatrix.com>
Message-ID: <4FA18976.6030408@itamarst.org>

On 05/02/2012 02:57 PM, Glyph wrote:
> On May 2, 2012, at 12:37 AM, Itamar Turner-Trauring wrote:
>
>> abunch of serious bugs
>
> Can you be more specific?  Let's not spread vague FUD about ourselves :).
>
> I suspect you're mostly talking about 
> <http://twistedmatrix.com/trac/ticket/1551>, which, yes, is somewhat 
> embarrassing.
>
http://twistedmatrix.com/trac/ticket/4667
http://twistedmatrix.com/trac/ticket/3525
http://twistedmatrix.com/trac/ticket/5562 - this was the one I was 
thinking of.

There's probably more!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120502/5d71e7ac/attachment.htm 

From dynamicgl at gmail.com  Thu May  3 01:14:55 2012
From: dynamicgl at gmail.com (gelin yan)
Date: Thu, 3 May 2012 13:14:55 +0800
Subject: [Twisted-Python] (no subject)
In-Reply-To: <4FA18976.6030408@itamarst.org>
References: <CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com>
	<4FA0BA19.8070009@itamarst.org>
	<7EACC5C0-66FE-4B04-99E5-2725511B212B@twistedmatrix.com>
	<4FA18976.6030408@itamarst.org>
Message-ID: <CABkOF6S4HNQ21_6wahVR5PGW-9o1GWQN1ybUWCj=UA4kMBSQ-Q@mail.gmail.com>

On Thu, May 3, 2012 at 3:22 AM, Itamar Turner-Trauring
<itamar at itamarst.org>wrote:

>  On 05/02/2012 02:57 PM, Glyph wrote:
>
>  On May 2, 2012, at 12:37 AM, Itamar Turner-Trauring wrote:
>
> a bunch of serious bugs
>
>
> Can you be more specific?  Let's not spread vague FUD about ourselves :).
>
>  I suspect you're mostly talking about <
> http://twistedmatrix.com/trac/ticket/1551>, which, yes, is somewhat
> embarrassing.
>
>  http://twistedmatrix.com/trac/ticket/4667
> http://twistedmatrix.com/trac/ticket/3525
> http://twistedmatrix.com/trac/ticket/5562 - this was the one I was
> thinking of.
>
> There's probably more!
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
I think those issues has one thing in common: current iocp implementation
has a problem about how to send data in order.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120503/825c93bc/attachment.htm 

From schenette at gmail.com  Thu May  3 11:56:36 2012
From: schenette at gmail.com (Stephan)
Date: Thu, 3 May 2012 08:56:36 -0700
Subject: [Twisted-Python] feedback on next version of Fireshark using
	twisted framework....
Message-ID: <CADozHMVnYD5Oqwhq+R50zKCQP6zSdrrz8mCTqOMspNNTSSYDCQ@mail.gmail.com>

Hi I have an open source project that is pretty well-known in the security
community. http://www.fireshark.org
it's a service wrapper that runs a headless version of firefox to visit
malicious sites to store telemetry data.

The old service used PERL for threading (very painful), so a while ago I
changed everything to python using
the twisted framework. the service's job is to launch a choose a firefox
profile, launch the process and
handle closes and crashes approprietly.

the launch of version 2.5 is next week but I sure could use some feedback
on the service code before releasing it.
Keep in mind I haven't finishing commenting for public release.

here are the files for the new service:

1)
fireshark.py http://pastebin.mozilla.org/1614427

this is the main service. opens up a port to listen on, and uses the
following two classes to manage profiles and launch
a firefox process.

2)
firesharkprofilemanager.py http://pastebin.mozilla.org/1614428

this is the firefox profile manager, it manages what firefox profiles are
available.

3)
firefoxprocess.py http://pastebin.mozilla.org/1614431

this is the firefox process class, to check if  the launched process has
been killed as well, as check if the logging from
the internal plugin (another part of the fireshark project) has completed
logging.

Thanks in advance! Twisted has been a great Framework!
Stephan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120503/10063e96/attachment.htm 

From jstpierre at mecheye.net  Thu May  3 14:12:01 2012
From: jstpierre at mecheye.net (Jasper St. Pierre)
Date: Thu, 3 May 2012 14:12:01 -0400
Subject: [Twisted-Python] feedback on next version of Fireshark using
 twisted framework....
In-Reply-To: <CADozHMVnYD5Oqwhq+R50zKCQP6zSdrrz8mCTqOMspNNTSSYDCQ@mail.gmail.com>
References: <CADozHMVnYD5Oqwhq+R50zKCQP6zSdrrz8mCTqOMspNNTSSYDCQ@mail.gmail.com>
Message-ID: <CAA0H+QSmE6+U6nzhGxCLx=51DRU91FwmU0GUSVRRkZT-XLJUaw@mail.gmail.com>

You seem to have some indentation issues. You have a random assortment
of Python style issues (some lines end with a semicolon). You use
'foo' + '/' + 'bar' to generate paths. While not evil (I think all
major platforms will support that and do the translation on their
own), you're better off using os.path.join. The "~/.mozilla/firefox"
won't work on certain platforms (and you could just use
os.path.expanduser if you don't want to support those platforms).

Your process spawning code is ugly, and could be open to injection if
not handled properly. Do it the better way:

    reactor.spawnProcess(self.processProtocol, 'xfvb-run',
['xvfv-run', '--auto-servernum', 'firefox', '-p', profile_id], env =
os.environ, usePTY=1)

Don't do 'foo == True'. Please use new-style classes (inherit from
'object'). I don't know why the timeout stuff makes me a bit scared,
but it does. I don't really think timeouts are necessary here.

I don't think you should be killing a process with os.kill. I'm quite
sure whatever you're trying to do has a better Twisted idiom.

Google for PEP 8, ignore the ones that don't make sense (like foo_case
instead of camelCase in Twisted code), and try to follow the rest.
When using Twisted code, always look for things in Twisted that might
combat the standard library, and try to use Twisted's whenever
possible.

On Thu, May 3, 2012 at 11:56 AM, Stephan <schenette at gmail.com> wrote:
>
> Hi I have an open source project that is pretty well-known in the security
> community. http://www.fireshark.org
> it's a service wrapper that runs a headless version of firefox to visit
> malicious sites to store telemetry data.
>
> The old service used PERL for threading (very painful), so a while ago I
> changed everything to python using
> the twisted framework. the service's job is to launch a choose a firefox
> profile, launch the process and
> handle closes and crashes approprietly.
>
> the launch of version 2.5 is next week but I sure could use some feedback on
> the service code before releasing it.
> Keep in mind I haven't finishing commenting for public release.
>
> here are the files for the new service:
>
> 1)
> fireshark.py http://pastebin.mozilla.org/1614427
>
> this is the main service. opens up a port to listen on, and uses the
> following two classes to manage profiles and launch
> a firefox process.
>
> 2)
> firesharkprofilemanager.py http://pastebin.mozilla.org/1614428
>
> this is the firefox profile manager, it manages what firefox profiles are
> available.
>
> 3)
> firefoxprocess.py http://pastebin.mozilla.org/1614431
>
> this is the firefox process class, to check if ?the launched process has
> been killed as well, as check if the logging from
> the internal plugin (another part of the fireshark project) has completed
> logging.
>
> Thanks in advance! Twisted has been a great Framework!
> Stephan
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
? Jasper


From schenette at gmail.com  Thu May  3 15:11:33 2012
From: schenette at gmail.com (Stephan)
Date: Thu, 3 May 2012 12:11:33 -0700
Subject: [Twisted-Python] feedback on next version of Fireshark using
 twisted framework....
In-Reply-To: <CAA0H+QSmE6+U6nzhGxCLx=51DRU91FwmU0GUSVRRkZT-XLJUaw@mail.gmail.com>
References: <CADozHMVnYD5Oqwhq+R50zKCQP6zSdrrz8mCTqOMspNNTSSYDCQ@mail.gmail.com>
	<CAA0H+QSmE6+U6nzhGxCLx=51DRU91FwmU0GUSVRRkZT-XLJUaw@mail.gmail.com>
Message-ID: <CADozHMX8GRzH_HuwzsaoE+Cf8=cecoPL3k0w8BGDfGg95Ky__g@mail.gmail.com>

thanks for the feed back Jasper! More feedback welcome.
Yes the code def. needs to be cleaned up before public release, and I will
make more use of python libs for path concatenation.

The feedback I'm specifically looking for is anything related to how I'm
using twisted and process management.
The reason I have everything in there from timing out, to killing a
process, is because I'm dealing with malicious websites, so bad things
happen and so I need to take extreme measures to for resource monitoring.

Any suggestions on how I can do things better with the service in terms of
how i'm using Twisted is welcome! Jasper provided great comments and I'll
be working to make those changes.

Thanks,
Stephan

On Thu, May 3, 2012 at 11:12 AM, Jasper St. Pierre <jstpierre at mecheye.net>wrote:

> You seem to have some indentation issues. You have a random assortment
> of Python style issues (some lines end with a semicolon). You use
> 'foo' + '/' + 'bar' to generate paths. While not evil (I think all
> major platforms will support that and do the translation on their
> own), you're better off using os.path.join. The "~/.mozilla/firefox"
> won't work on certain platforms (and you could just use
> os.path.expanduser if you don't want to support those platforms).
>
> Your process spawning code is ugly, and could be open to injection if
> not handled properly. Do it the better way:
>
>    reactor.spawnProcess(self.processProtocol, 'xfvb-run',
> ['xvfv-run', '--auto-servernum', 'firefox', '-p', profile_id], env =
> os.environ, usePTY=1)
>
> Don't do 'foo == True'. Please use new-style classes (inherit from
> 'object'). I don't know why the timeout stuff makes me a bit scared,
> but it does. I don't really think timeouts are necessary here.
>
> I don't think you should be killing a process with os.kill. I'm quite
> sure whatever you're trying to do has a better Twisted idiom.
>
> Google for PEP 8, ignore the ones that don't make sense (like foo_case
> instead of camelCase in Twisted code), and try to follow the rest.
> When using Twisted code, always look for things in Twisted that might
> combat the standard library, and try to use Twisted's whenever
> possible.
>
> On Thu, May 3, 2012 at 11:56 AM, Stephan <schenette at gmail.com> wrote:
> >
> > Hi I have an open source project that is pretty well-known in the
> security
> > community. http://www.fireshark.org
> > it's a service wrapper that runs a headless version of firefox to visit
> > malicious sites to store telemetry data.
> >
> > The old service used PERL for threading (very painful), so a while ago I
> > changed everything to python using
> > the twisted framework. the service's job is to launch a choose a firefox
> > profile, launch the process and
> > handle closes and crashes approprietly.
> >
> > the launch of version 2.5 is next week but I sure could use some
> feedback on
> > the service code before releasing it.
> > Keep in mind I haven't finishing commenting for public release.
> >
> > here are the files for the new service:
> >
> > 1)
> > fireshark.py http://pastebin.mozilla.org/1614427
> >
> > this is the main service. opens up a port to listen on, and uses the
> > following two classes to manage profiles and launch
> > a firefox process.
> >
> > 2)
> > firesharkprofilemanager.py http://pastebin.mozilla.org/1614428
> >
> > this is the firefox profile manager, it manages what firefox profiles are
> > available.
> >
> > 3)
> > firefoxprocess.py http://pastebin.mozilla.org/1614431
> >
> > this is the firefox process class, to check if  the launched process has
> > been killed as well, as check if the logging from
> > the internal plugin (another part of the fireshark project) has completed
> > logging.
> >
> > Thanks in advance! Twisted has been a great Framework!
> > Stephan
> >
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> >
>
>
>
> --
>   Jasper
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120503/f473e823/attachment.htm 

From glyph at twistedmatrix.com  Thu May  3 16:05:04 2012
From: glyph at twistedmatrix.com (Glyph)
Date: Thu, 3 May 2012 16:05:04 -0400
Subject: [Twisted-Python] feedback on next version of Fireshark using
	twisted framework....
In-Reply-To: <CAA0H+QSmE6+U6nzhGxCLx=51DRU91FwmU0GUSVRRkZT-XLJUaw@mail.gmail.com>
References: <CADozHMVnYD5Oqwhq+R50zKCQP6zSdrrz8mCTqOMspNNTSSYDCQ@mail.gmail.com>
	<CAA0H+QSmE6+U6nzhGxCLx=51DRU91FwmU0GUSVRRkZT-XLJUaw@mail.gmail.com>
Message-ID: <471F89D2-00CF-4563-AE4A-F43D445034EC@twistedmatrix.com>


On May 3, 2012, at 2:12 PM, Jasper St. Pierre wrote:

> you're better off using os.path.join

Actually, you're better off using twisted.python.filepath.FilePath.child :).

<http://twistedmatrix.com/documents/current/api/twisted.python.filepath.FilePath.html>

HTH, HAND,

-g
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120503/f56a7645/attachment.htm 

From dmitriy at fogcreek.com  Thu May  3 17:27:51 2012
From: dmitriy at fogcreek.com (Dmitriy)
Date: Thu, 03 May 2012 17:27:51 -0400
Subject: [Twisted-Python]  (no subject)
In-Reply-To: 4FA0BA19.8070009@itamarst.org
References: CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com
Message-ID: <4FA2F857.6020608@fogcreek.com>

 > > If anyone had a similar issue before, I'd appreciate any pointers on
 > > resolving or avoiding it.
 > >
 > Actually, one thing does occur to me - are you using the IOCP reactor?
 > If so, try the select() reactor, the IOCP reactor unfortunately has a
 > bunch of serious bugs. I'm vaguely considering working on those as my
 > next Twisted work, since they're embarrassing and IOCP is so much better
 > than select() on Windows.

Hi Itamar,

The subject was supposed to be "SSH with Twisted: PuTTY Fatal Error
"Incoming packet was garbled on decryption".
(Shame on me, I've missed it while fighting multiple gmail accounts.)

To add more details, unfortunately, I'm already running SelectReactor with
pretty recent packages:
Twisted==12.0.0
pyasn1==0.1.2
pycrypto==2.5

After some heavy experimenting, I really think that plink is the weakest 
link:
the error happens at a random point when my server is accessed from the same
windows 7 box. There are no issues when running the client on an Ubuntu
virtual box* though; Twisted doesn't seem to be the one to blame by itself.

So, I was hoping that someone with plink+twisted experience had stumbled
on this before.

I've tried hg command line and hg's client TortoiseHG, in both cases with
either tortoiseplink.exe (based on putty 0.61) or original PuTTY's
plink 0.62; with and without compression. All combinations failing 
reliably,
though some have a slim random chance to succeed once in a while.
Success rate seems to be dependent on server load - more chances for success
when server is more busy - feels completely crazy. I'm investigating 
this route now.

"Garbled packet" error is pretty random and likely to occur on larg-ish
repositories starting with 5-10 Mb. Brief check of plink's source 
suggests that
this can happen if it receives an incomplete packet, but that's pretty 
much it
for isolating the issue so far.

----
That (*) above was Ubuntu client still getting the same error if 
SSHChannel.write()
would split data in multiple sendData calls when running out of space in
remoteWindowLeft. But if it is patched it to ignore remote window, it 
shows no
issues, so I'm not that much concerned with it for now.

- Dmitriy.


From itamar at itamarst.org  Thu May  3 18:10:39 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Thu, 03 May 2012 18:10:39 -0400
Subject: [Twisted-Python] (no subject)
In-Reply-To: <4FA2F857.6020608@fogcreek.com>
References: CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com
	<4FA2F857.6020608@fogcreek.com>
Message-ID: <4FA3025F.8070301@itamarst.org>

On 05/03/2012 05:27 PM, Dmitriy wrote:
> To add more details, unfortunately, I'm already running SelectReactor with
> pretty recent packages:
> Twisted==12.0.0
> pyasn1==0.1.2
> pycrypto==2.5
>
> After some heavy experimenting, I really think that plink is the weakest
> link:
> the error happens at a random point when my server is accessed from the same
> windows 7 box. There are no issues when running the client on an Ubuntu
> virtual box* though; Twisted doesn't seem to be the one to blame by itself.
When you say "the client", it's still plink? plink on Ubuntu on a 
different machine might also be worth trying, in case there's some bug 
which can only happen due to TCP packet splitting, which might happen 
differently over virtual network driver. Also, have you tried with 
openssh (perhaps on cygwin), or SecureCRT? If other clients are happy 
I'd lean towards a bug in plink.

> ----
> That (*) above was Ubuntu client still getting the same error if
> SSHChannel.write()
> would split data in multiple sendData calls when running out of space in
> remoteWindowLeft. But if it is patched it to ignore remote window, it
> shows no
> issues, so I'm not that much concerned with it for now.
Could you file a ticket with a patch for this, if there isn't one 
already, so that this fix can make it into Twisted proper? See our 
ticket tracker at http://twistedmatrix.com/. Thanks!


From david at davidstrauss.net  Fri May  4 01:21:02 2012
From: david at davidstrauss.net (David Strauss)
Date: Thu, 3 May 2012 22:21:02 -0700
Subject: [Twisted-Python] feedback on next version of Fireshark using
 twisted framework....
In-Reply-To: <471F89D2-00CF-4563-AE4A-F43D445034EC@twistedmatrix.com>
References: <CADozHMVnYD5Oqwhq+R50zKCQP6zSdrrz8mCTqOMspNNTSSYDCQ@mail.gmail.com>
	<CAA0H+QSmE6+U6nzhGxCLx=51DRU91FwmU0GUSVRRkZT-XLJUaw@mail.gmail.com>
	<471F89D2-00CF-4563-AE4A-F43D445034EC@twistedmatrix.com>
Message-ID: <CAKz8sYWKHxRg=u5EUQ7KSSCv737hARGo7JC8=m+omwmpZxX5NA@mail.gmail.com>

On Thu, May 3, 2012 at 1:05 PM, Glyph <glyph at twistedmatrix.com> wrote:
> Actually, you're better off using twisted.python.filepath.FilePath.child :).
>
> <http://twistedmatrix.com/documents/current/api/twisted.python.filepath.FilePath.html>

That documentation has quite the personality.


From exarkun at twistedmatrix.com  Fri May  4 15:43:57 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Fri, 04 May 2012 19:43:57 -0000
Subject: [Twisted-Python] (no subject)
Message-ID: <20120504194357.3668.1386543969.divmod.xquotient.200@localhost6.localdomain6>

Hi all,

A few us were discussing providing commercial support contracts for 
Twisted users, and it would be helpful to gauge potential interest. 
Support contracts might include things like:

     A certified version of Twisted for your platform
     Twisted bug fixes
     Twisted feature development
     Answers to questions about Twisted functionality
     Answers to questions about Twisted best practices and design 
patterns
     Answers to questions about performance and scaling
     In-depth support for your specific applications
     Additional documentation
     Training
     Code review

If you or your organization might be interested in such a thing, we'd 
appreciate your answering a quick questionnaire:

    http://bit.ly/JxrIbu

Thanks,
Jean-Paul


From itamar at itamarst.org  Fri May  4 19:32:13 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Fri, 04 May 2012 19:32:13 -0400
Subject: [Twisted-Python] Commercial support contracts for Twisted - any
	interest?
In-Reply-To: <20120504194357.3668.1386543969.divmod.xquotient.200@localhost6.localdomain6>
References: <20120504194357.3668.1386543969.divmod.xquotient.200@localhost6.localdomain6>
Message-ID: <4FA466FD.1030202@itamarst.org>

Just so no one misses this, I updated the subject.

On 05/04/2012 03:43 PM, exarkun at twistedmatrix.com wrote:
> Hi all,
>
> A few us were discussing providing commercial support contracts for
> Twisted users, and it would be helpful to gauge potential interest.
> Support contracts might include things like:
>
>       A certified version of Twisted for your platform
>       Twisted bug fixes
>       Twisted feature development
>       Answers to questions about Twisted functionality
>       Answers to questions about Twisted best practices and design
> patterns
>       Answers to questions about performance and scaling
>       In-depth support for your specific applications
>       Additional documentation
>       Training
>       Code review
>
> If you or your organization might be interested in such a thing, we'd
> appreciate your answering a quick questionnaire:
>
>      http://bit.ly/JxrIbu
>
> Thanks,
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From exarkun at twistedmatrix.com  Sun May  6 00:05:32 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 06 May 2012 04:05:32 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1336277132.76.1105150850@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120506/a780d890/attachment.htm 

From orestis at orestis.gr  Thu May 10 06:02:54 2012
From: orestis at orestis.gr (Orestis Markou)
Date: Thu, 10 May 2012 13:02:54 +0300
Subject: [Twisted-Python] Replacement for Twisted Tutorial in Europython 2012
Message-ID: <5CB88ED5-1978-4256-85C0-6C8E01A6193C@orestis.gr>

Hello everyone,

My proposal for delivering a 4h Twisted training in EuroPython 2012 (Florence, July 2-8) has been voted in the community and is set to be delivered on July 5. https://ep2012.europython.eu/conference/talks/twisted-tutorial This turned out to be very popular last year, and had to be repeated on a second day to cover all the audience.

Unfortunately for personal reasons I won't be able to attend the conference. Before I give back the slot to the EuroPython organizers, I wonder if someone that would be attending would want to deliver the training in my place. I have a lot of material already from last year, and I can happily work for the preparation of the training.

I need to give an answer to the organizers in the next few days, so if someone's interested, please speak up!

Thanks,
Orestis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120510/99ef746b/attachment.htm 

From stephen at thorne.id.au  Thu May 10 06:51:47 2012
From: stephen at thorne.id.au (Thorne, Stephen)
Date: Thu, 10 May 2012 11:51:47 +0100
Subject: [Twisted-Python] Replacement for Twisted Tutorial in Europython
	2012
In-Reply-To: <5CB88ED5-1978-4256-85C0-6C8E01A6193C@orestis.gr>
References: <5CB88ED5-1978-4256-85C0-6C8E01A6193C@orestis.gr>
Message-ID: <CAFPU7=u3eJcvWAKWr_6ErStNAEfqby33jrbOb+SF-orm4jQymA@mail.gmail.com>

Hihi,

It sounds like I need to get my ass into gear and convince my employer
to send me to europython, so I can help you out here.

I am available at that time, I just haven't organised anything. Can you send
me a link to the latest version of the training material you had from last
year?

Are there any other volunteers? Training is very draining and having more
than
one person in the room really helps.

On Thu, May 10, 2012 at 11:02 AM, Orestis Markou <orestis at orestis.gr> wrote:

> Hello everyone,
>
> My proposal for delivering a 4h Twisted training in EuroPython 2012
> (Florence, July 2-8) has been voted in the community and is set to be
> delivered on July 5.
> https://ep2012.europython.eu/conference/talks/twisted-tutorial This
> turned out to be very popular last year, and had to be repeated on a second
> day to cover all the audience.
>
> Unfortunately for personal reasons I won't be able to attend the
> conference. Before I give back the slot to the EuroPython organizers, I
> wonder if someone that would be attending would want to deliver the
> training in my place. I have a lot of material already from last year, and
> I can happily work for the preparation of the training.
>
> I need to give an answer to the organizers in the next few days, so if
> someone's interested, please speak up!
>
> Thanks,
> Orestis
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120510/981b4830/attachment.htm 

From orestis at orestis.gr  Thu May 10 07:02:58 2012
From: orestis at orestis.gr (Orestis Markou)
Date: Thu, 10 May 2012 14:02:58 +0300
Subject: [Twisted-Python] Replacement for Twisted Tutorial in Europython
	2012
In-Reply-To: <CAFPU7=u3eJcvWAKWr_6ErStNAEfqby33jrbOb+SF-orm4jQymA@mail.gmail.com>
References: <5CB88ED5-1978-4256-85C0-6C8E01A6193C@orestis.gr>
	<CAFPU7=u3eJcvWAKWr_6ErStNAEfqby33jrbOb+SF-orm4jQymA@mail.gmail.com>
Message-ID: <BC4854AA-4E6C-48CC-ABC7-6965BF8929BB@orestis.gr>

The PDF is here - I can export the Keynote slides to some other format if you want.

https://ep2012.europython.eu/conference/talks/asynchronous-programming-with-twisted

On 10 ??? 2012, at 1:51 ?.?., Thorne, Stephen wrote:

> Hihi,
> 
> It sounds like I need to get my ass into gear and convince my employer
> to send me to europython, so I can help you out here.
> 
> I am available at that time, I just haven't organised anything. Can you send
> me a link to the latest version of the training material you had from last year?
> 
> Are there any other volunteers? Training is very draining and having more than
> one person in the room really helps.
> 
> On Thu, May 10, 2012 at 11:02 AM, Orestis Markou <orestis at orestis.gr> wrote:
> Hello everyone,
> 
> My proposal for delivering a 4h Twisted training in EuroPython 2012 (Florence, July 2-8) has been voted in the community and is set to be delivered on July 5. https://ep2012.europython.eu/conference/talks/twisted-tutorial This turned out to be very popular last year, and had to be repeated on a second day to cover all the audience.
> 
> Unfortunately for personal reasons I won't be able to attend the conference. Before I give back the slot to the EuroPython organizers, I wonder if someone that would be attending would want to deliver the training in my place. I have a lot of material already from last year, and I can happily work for the preparation of the training.
> 
> I need to give an answer to the organizers in the next few days, so if someone's interested, please speak up!
> 
> Thanks,
> Orestis
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120510/843eec8e/attachment.htm 

From stephen at thorne.id.au  Thu May 10 09:54:50 2012
From: stephen at thorne.id.au (Thorne, Stephen)
Date: Thu, 10 May 2012 14:54:50 +0100
Subject: [Twisted-Python] Replacement for Twisted Tutorial in Europython
	2012
In-Reply-To: <BC4854AA-4E6C-48CC-ABC7-6965BF8929BB@orestis.gr>
References: <5CB88ED5-1978-4256-85C0-6C8E01A6193C@orestis.gr>
	<CAFPU7=u3eJcvWAKWr_6ErStNAEfqby33jrbOb+SF-orm4jQymA@mail.gmail.com>
	<BC4854AA-4E6C-48CC-ABC7-6965BF8929BB@orestis.gr>
Message-ID: <CAFPU7=sfCLEkg9gAHG0iWz4L6MZk9NPb5Vi=jjkregYfzu0e9A@mail.gmail.com>

Orestis,

I've got approval to take this on, so you can let the Europython2012 team
know that I'm willing to take responsibility for running the session from
you.

On Thu, May 10, 2012 at 12:02 PM, Orestis Markou <orestis at orestis.gr> wrote:

> The PDF is here - I can export the Keynote slides to some other format if
> you want.
>
>
> https://ep2012.europython.eu/conference/talks/asynchronous-programming-with-twisted
>
> On 10 ??? 2012, at 1:51 ?.?., Thorne, Stephen wrote:
>
> Hihi,
>
> It sounds like I need to get my ass into gear and convince my employer
> to send me to europython, so I can help you out here.
>
> I am available at that time, I just haven't organised anything. Can you
> send
> me a link to the latest version of the training material you had from last
> year?
>
> Are there any other volunteers? Training is very draining and having more
> than
> one person in the room really helps.
>
> On Thu, May 10, 2012 at 11:02 AM, Orestis Markou <orestis at orestis.gr>wrote:
>
>> Hello everyone,
>>
>> My proposal for delivering a 4h Twisted training in EuroPython 2012
>> (Florence, July 2-8) has been voted in the community and is set to be
>> delivered on July 5.
>> https://ep2012.europython.eu/conference/talks/twisted-tutorial This
>> turned out to be very popular last year, and had to be repeated on a second
>> day to cover all the audience.
>>
>> Unfortunately for personal reasons I won't be able to attend the
>> conference. Before I give back the slot to the EuroPython organizers, I
>> wonder if someone that would be attending would want to deliver the
>> training in my place. I have a lot of material already from last year, and
>> I can happily work for the preparation of the training.
>>
>> I need to give an answer to the organizers in the next few days, so if
>> someone's interested, please speak up!
>>
>> Thanks,
>> Orestis
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120510/af85f8f5/attachment-0001.htm 

From exarkun at twistedmatrix.com  Sun May 13 00:05:42 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 13 May 2012 04:05:42 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1336881942.16.309234754@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120513/d209c03e/attachment.htm 

From bino at indoakses-online.com  Mon May 14 04:53:53 2012
From: bino at indoakses-online.com (bino oetomo)
Date: Mon, 14 May 2012 15:53:53 +0700
Subject: [Twisted-Python] question : json.loads failed using LineReceiver
	data
Message-ID: <4FB0C821.9070607@indoakses-online.com>

Dear All ..

I'm trying to received json formated text using LineReceiver

Here is my code
----START----
class ArduinoReceiver(LineReceiver):
     def __init__(self):
         print 'INIT : ArduinoReceiver'

     def lineReceived(self, line):
         line = line.strip()
         print 'Received line = '+line
         if 'Arduino' in line :
             return
         self.linedict=json.loads(line)

----STOP-----
but I got error msg in the log as :
----START----
2012-05-14 15:42:00+0700 [-] Received line = 
'{"a_flw_fwd":12,"a_flw_rtr":5029,"a_rpm":519,"b_flw_fwd":23,"b_flw_rtr":8,"b_rpm":913}'
2012-05-14 15:42:00+0700 [-] Unhandled Error
     Traceback (most recent call last):
       File 
"/usr/local/lib/python2.6/dist-packages/Twisted-11.1.0_r33425-py2.6-linux-i686.egg/twisted/python/log.py", 
line 84, in callWithLogger
         return callWithContext({"system": lp}, func, *args, **kw)
       File 
"/usr/local/lib/python2.6/dist-packages/Twisted-11.1.0_r33425-py2.6-linux-i686.egg/twisted/python/log.py", 
line 69, in callWithContext
         return context.call({ILogContext: newCtx}, func, *args, **kw)
       File 
"/usr/local/lib/python2.6/dist-packages/Twisted-11.1.0_r33425-py2.6-linux-i686.egg/twisted/python/context.py", 
line 118, in callWithContext
         return self.currentContext().callWithContext(ctx, func, *args, 
**kw)
       File 
"/usr/local/lib/python2.6/dist-packages/Twisted-11.1.0_r33425-py2.6-linux-i686.egg/twisted/python/context.py", 
line 81, in callWithContext
         return func(*args,**kw)
     --- <exception caught here> ---
       File 
"/usr/local/lib/python2.6/dist-packages/Twisted-11.1.0_r33425-py2.6-linux-i686.egg/twisted/internet/posixbase.py", 
line 586, in _doReadOrWrite
         why = selectable.doRead()
       File 
"/usr/local/lib/python2.6/dist-packages/Twisted-11.1.0_r33425-py2.6-linux-i686.egg/twisted/internet/_posixserialport.py", 
line 62, in doRead
         return fdesc.readFromFD(self.fileno(), self.protocol.dataReceived)
       File 
"/usr/local/lib/python2.6/dist-packages/Twisted-11.1.0_r33425-py2.6-linux-i686.egg/twisted/internet/fdesc.py", 
line 94, in readFromFD
         callback(output)
       File 
"/usr/local/lib/python2.6/dist-packages/Twisted-11.1.0_r33425-py2.6-linux-i686.egg/twisted/protocols/basic.py", 
line 564, in dataReceived
         why = self.lineReceived(line)
       File "./kapal02.tac", line 48, in lineReceived
         self.linedict=json.loads(line)
       File "/usr/lib/python2.6/json/__init__.py", line 307, in loads
         return _default_decoder.decode(s)
       File "/usr/lib/python2.6/json/decoder.py", line 319, in decode
         obj, end = self.raw_decode(s, idx=_w(s, 0).end())
       File "/usr/lib/python2.6/json/decoder.py", line 338, in raw_decode
         raise ValueError("No JSON object could be decoded")
     exceptions.ValueError: No JSON object could be decoded
----STOP-----

I try to do json.loads based on received msg using python console, and 
it work :
---START---------
bino at bino-desktop:/var/log/rabbitmq$ python
Python 2.6.6 (r266:84292, Sep 15 2010, 15:52:39)
[GCC 4.4.5] on linux2
Type "help", "copyright", "credits" or "license" for more information.
 >>> import json
 >>> 
aa='{"a_flw_fwd":12,"a_flw_rtr":5029,"a_rpm":519,"b_flw_fwd":23,"b_flw_rtr":8,"b_rpm":913}'
 >>> mydict=json.loads(aa)
 >>> print mydict['a_flw_fwd']
12
---STOP----------

Kindly please tell me why the 'json.loads' is failed in my tac file 
while it work in python console.

Sincerely
-bino-


From itamar at itamarst.org  Mon May 14 06:47:38 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Mon, 14 May 2012 06:47:38 -0400
Subject: [Twisted-Python] question : json.loads failed using
 LineReceiver data
In-Reply-To: <4FB0C821.9070607@indoakses-online.com>
References: <4FB0C821.9070607@indoakses-online.com>
Message-ID: <4FB0E2CA.4090802@itamarst.org>

On 05/14/2012 04:53 AM, bino oetomo wrote:
> Kindly please tell me why the 'json.loads' is failed in my tac file
> while it work in python console.
>
Perhaps the JSON spans more than one line? Printing out the repr() of 
the lines you're receiving may be informative.


From exarkun at twistedmatrix.com  Mon May 14 08:47:17 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Mon, 14 May 2012 12:47:17 -0000
Subject: [Twisted-Python] question : json.loads failed using
 LineReceiver data
In-Reply-To: <4FB0C821.9070607@indoakses-online.com>
References: <4FB0C821.9070607@indoakses-online.com>
Message-ID: <20120514124717.13157.1256494908.divmod.xquotient.160@localhost6.localdomain6>

On 08:53 am, bino at indoakses-online.com wrote:
>Dear All ..
>
>I'm trying to received json formated text using LineReceiver
>
>Here is my code
>----START----
>class ArduinoReceiver(LineReceiver):
>     def __init__(self):
>         print 'INIT : ArduinoReceiver'
>
>     def lineReceived(self, line):
>         line = line.strip()
>         print 'Received line = '+line
>         if 'Arduino' in line :
>             return
>         self.linedict=json.loads(line)
>
>----STOP-----
>but I got error msg in the log as :
>----START----
>2012-05-14 15:42:00+0700 [-] Received line =
>'{"a_flw_fwd":12,"a_flw_rtr":5029,"a_rpm":519,"b_flw_fwd":23,"b_flw_rtr":8,"b_rpm":913}'

Read your log message.  This is not a valid JSON string:

'{"a_flw_fwd":12,"a_flw_rtr":5029,"a_rpm":519,"b_flw_fwd":23,"b_flw_rtr":8,"b_rpm":913}'

Presumably your objective is to receive something like this instead:

{"a_flw_fwd":12,"a_flw_rtr":5029,"a_rpm":519,"b_flw_fwd":23,"b_flw_rtr":8,"b_rpm":913}

The problem is unrelated to Twisted or the console.  The sender is 
sending the wrong data, or else your parsing of it is incorrect.

Jean-Paul


From pascal at optimorlabs.com  Mon May 14 09:14:49 2012
From: pascal at optimorlabs.com (Pascal Briet)
Date: Mon, 14 May 2012 14:14:49 +0100
Subject: [Twisted-Python] Cannot install Twisted version 8 through PIP
Message-ID: <CAMd_B-SrHV8qvSRuORSO72ea7d_zjymEV7cSXsnm4NeCn+bUUA@mail.gmail.com>

Hi,

We're having some troubles today, because it seems that old packages of
Twisted are not available anymore.
We are currently relying on Twisted 8.2.0.

pip install twisted==8.2.0  is failing  (first version available seems to
be 9.0.0)
The package was still available last Friday.

Is there a critical reason explaining that it has been removed from the
servers ?

Thanks very much,
Best regards,

-- 
Pascal BRIET
Software engineer
Optimor Labs
http://www.billmonitor.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120514/9be45d82/attachment.htm 

From itamar at itamarst.org  Mon May 14 09:29:23 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Mon, 14 May 2012 09:29:23 -0400
Subject: [Twisted-Python] Cannot install Twisted version 8 through PIP
In-Reply-To: <CAMd_B-SrHV8qvSRuORSO72ea7d_zjymEV7cSXsnm4NeCn+bUUA@mail.gmail.com>
References: <CAMd_B-SrHV8qvSRuORSO72ea7d_zjymEV7cSXsnm4NeCn+bUUA@mail.gmail.com>
Message-ID: <4FB108B3.3060700@itamarst.org>

On 05/14/2012 09:14 AM, Pascal Briet wrote:
> Hi,
>
> We're having some troubles today, because it seems that old packages 
> of Twisted are not available anymore.
> We are currently relying on Twisted 8.2.0.
>
> pip install twisted==8.2.0  is failing  (first version available seems 
> to be 9.0.0)
> The package was still available last Friday.
>
> Is there a critical reason explaining that it has been removed from 
> the servers ?
>
My understanding is that pip uses PyPI, and personally I know of no one 
who removed stuff from PyPI; more likely PyPI decided to remove old 
versions of software to save space.

Any reason you're using 8.2? It's almost 4 years old at this point, and 
we've fixed a lot of bugs and added a lot of features since then.

-Itamar


From pascal at optimorlabs.com  Mon May 14 09:35:14 2012
From: pascal at optimorlabs.com (Pascal Briet)
Date: Mon, 14 May 2012 14:35:14 +0100
Subject: [Twisted-Python] Cannot install Twisted version 8 through PIP
In-Reply-To: <4FB108B3.3060700@itamarst.org>
References: <CAMd_B-SrHV8qvSRuORSO72ea7d_zjymEV7cSXsnm4NeCn+bUUA@mail.gmail.com>
	<4FB108B3.3060700@itamarst.org>
Message-ID: <CAMd_B-QjkExS_Bp5a5+3xxt42YdNQk6pfXJvxW74UW+tExOYjA@mail.gmail.com>

Hi,

Thanks for your answer.

Well, there is no specific reason that we use the 8.2.0 version.
It's just... history. We never needed to upgrade it.

Do you think we can easily upgrade to 9/10/11/12 ??
Thanks very much,

-- 
Pascal BRIET
Software engineer
Optimor Labs
http://www.billmonitor.com



On 14 May 2012 14:29, Itamar Turner-Trauring <itamar at itamarst.org> wrote:

> On 05/14/2012 09:14 AM, Pascal Briet wrote:
> > Hi,
> >
> > We're having some troubles today, because it seems that old packages
> > of Twisted are not available anymore.
> > We are currently relying on Twisted 8.2.0.
> >
> > pip install twisted==8.2.0  is failing  (first version available seems
> > to be 9.0.0)
> > The package was still available last Friday.
> >
> > Is there a critical reason explaining that it has been removed from
> > the servers ?
> >
> My understanding is that pip uses PyPI, and personally I know of no one
> who removed stuff from PyPI; more likely PyPI decided to remove old
> versions of software to save space.
>
> Any reason you're using 8.2? It's almost 4 years old at this point, and
> we've fixed a lot of bugs and added a lot of features since then.
>
> -Itamar
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120514/6ba86e96/attachment.htm 

From itamar at itamarst.org  Mon May 14 09:54:00 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Mon, 14 May 2012 09:54:00 -0400
Subject: [Twisted-Python] Cannot install Twisted version 8 through PIP
In-Reply-To: <CAMd_B-QjkExS_Bp5a5+3xxt42YdNQk6pfXJvxW74UW+tExOYjA@mail.gmail.com>
References: <CAMd_B-SrHV8qvSRuORSO72ea7d_zjymEV7cSXsnm4NeCn+bUUA@mail.gmail.com>
	<4FB108B3.3060700@itamarst.org>
	<CAMd_B-QjkExS_Bp5a5+3xxt42YdNQk6pfXJvxW74UW+tExOYjA@mail.gmail.com>
Message-ID: <4FB10E78.1010104@itamarst.org>

On 05/14/2012 09:35 AM, Pascal Briet wrote:
> Hi,
>
> Thanks for your answer.
>
> Well, there is no specific reason that we use the 8.2.0 version.
> It's just... history. We never needed to upgrade it.
>
> Do you think we can easily upgrade to 9/10/11/12 ??
> Thanks very much,
>

We have a strict backwards compatibility policy; anything that changes 
or is removed will have deprecation warnings for at least 2 releases and 
one year.

So the thing to do is, upgrade to version 9, run your program and make 
sure its tests pass, and fix any code that triggers deprecation warnings 
in Twisted. Repeat with each version until you're up to date. In most 
cases this may take as little as a couple of hours of work; possibly 
none if you didn't happen to be using any deprecated APIs.


From pascal at optimorlabs.com  Mon May 14 10:00:18 2012
From: pascal at optimorlabs.com (Pascal Briet)
Date: Mon, 14 May 2012 15:00:18 +0100
Subject: [Twisted-Python] Cannot install Twisted version 8 through PIP
In-Reply-To: <4FB10E78.1010104@itamarst.org>
References: <CAMd_B-SrHV8qvSRuORSO72ea7d_zjymEV7cSXsnm4NeCn+bUUA@mail.gmail.com>
	<4FB108B3.3060700@itamarst.org>
	<CAMd_B-QjkExS_Bp5a5+3xxt42YdNQk6pfXJvxW74UW+tExOYjA@mail.gmail.com>
	<4FB10E78.1010104@itamarst.org>
Message-ID: <CAMd_B-QYiUk8BqDN-WoD-LGBNiHZCEiMRpBFKMZnSxfSyZvZQg@mail.gmail.com>

Ok,

Thanks for your help.
Best regards,

-- 
Pascal BRIET
Software engineer
Optimor Labs
http://www.billmonitor.com



On 14 May 2012 14:54, Itamar Turner-Trauring <itamar at itamarst.org> wrote:

> On 05/14/2012 09:35 AM, Pascal Briet wrote:
> > Hi,
> >
> > Thanks for your answer.
> >
> > Well, there is no specific reason that we use the 8.2.0 version.
> > It's just... history. We never needed to upgrade it.
> >
> > Do you think we can easily upgrade to 9/10/11/12 ??
> > Thanks very much,
> >
>
> We have a strict backwards compatibility policy; anything that changes
> or is removed will have deprecation warnings for at least 2 releases and
> one year.
>
> So the thing to do is, upgrade to version 9, run your program and make
> sure its tests pass, and fix any code that triggers deprecation warnings
> in Twisted. Repeat with each version until you're up to date. In most
> cases this may take as little as a couple of hours of work; possibly
> none if you didn't happen to be using any deprecated APIs.
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120514/9a18a925/attachment-0001.htm 

From itamar at itamarst.org  Tue May 15 06:26:24 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Tue, 15 May 2012 06:26:24 -0400
Subject: [Twisted-Python] Getting rid of "DirtyReactorWarning"
Message-ID: <4FB22F50.6000407@itamarst.org>

I have a ticket open for allowing tests that look like this, where each 
run has a new reactor instance:


def test_somethingShouldHappen(self, reactor):
      result = []
      reactor.listenTCP(...)
      self.runReactor(reactor)
      self.assertEqual(result, ["hooray"])


Further thought suggests however that this doesn't add much, 
necessarily, over the current "return a Deferred" idiom for most users. 
Experience with ReactorBuilder framework that has similar testing 
mechanism suggests it's far too easy to fail to stop the reactor. 
Moreover, things like coiterate() don't work since they rely on 
pre-imported global reactor, and given the "from twisted.internet import 
reactor" idiom this testing style won't work well for many people's code.

But! ReactorBuilder tests are superior in one way: no 
DirtyReactorWarning. You don't have to wait until all connections are 
closed, which is difficult, or make sure to cancel every timeout. This 
makes test writing simpler.

Perhaps we should get rid of DirtyReactorWarning for regular 
Deferred-returning tests as well, then. We have all the infrastructure 
we need, after all, for canceling scheduled events and disconnecting all 
descriptors. We might want to log when we do so, to help debug things, 
but we already have cleanup code mostly implemented in trial anyway, and 
it seems like DirtyReactorWarning doesn't usually make future tests fail 
anyway since we do run cleanup.

Threaded code might still be a problem, but that's the case for current 
tests now, and even switching to a new style of tests as above would 
only somewhat mitigate the issue.

Thoughts?


From _ at lvh.cc  Wed May 16 10:26:00 2012
From: _ at lvh.cc (Laurens Van Houtven)
Date: Wed, 16 May 2012 16:26:00 +0200
Subject: [Twisted-Python] Declaring AMP responders away from
Message-ID: <32D7EF96-0CD4-4507-B667-70281C4FBC24@lvh.cc>

Hi,

I'm writing a service that exposes a bunch of methods over AMP.

These methods are easily logically grouped into separate modules (i.e. message-related, picture-related?). So, I'd like to define the behavior for those methods in those modules.

However, the amp.Command.responder decorator only works inside the class definition of an AMP subclass.  (http://twistedmatrix.com/documents/current/api/twisted.protocols.amp.Command.html#responder).

Does that mean I should have multiple AMP subclasses? How do I get all of them to listen on the same port? Is this what the mysterious "routes" feature I've been hearing about does?

Right now I'm doing it like this, which works but isn't very pretty or nice:

user.py:
-----
class Register(amp.Command):
    arguments = [?]
    response = [?]
    errors = [?]


def register(self, ?):
    # do actual registering behavior here
-----

api.py:
-----
from project import auth

class API(amp.AMP):
    register = auth.Register.responder(auth.register)
-----


cheers
lvh





From washort at twistedmatrix.com  Wed May 16 11:07:48 2012
From: washort at twistedmatrix.com (Allen Short)
Date: Wed, 16 May 2012 10:07:48 -0500
Subject: [Twisted-Python] Declaring AMP responders away from
In-Reply-To: <32D7EF96-0CD4-4507-B667-70281C4FBC24@lvh.cc>
References: <32D7EF96-0CD4-4507-B667-70281C4FBC24@lvh.cc>
Message-ID: <CAEzUHiMjuHGWmqm6vWR__-np0K2KRfYoO08-b+izrdortGrDTA@mail.gmail.com>

Have a look at what I did in Frack:

http://bazaar.launchpad.net/~washort/frack/trunk/view/head:/frack/wiring.py#L27
http://bazaar.launchpad.net/~washort/frack/trunk/view/head:/frack/responder.py#L85

You can unbundle the locator and dispatcher bits. I only used this for
a single separate class, but with some imagination the principle could
be extended to multiple objects I bet.


From spalax at gresille.org  Wed May 16 18:58:57 2012
From: spalax at gresille.org (Louis)
Date: Thu, 17 May 2012 00:58:57 +0200
Subject: [Twisted-Python] Synchronous calls using Twisted?
Message-ID: <4FB43131.2030805@gresille.org>

  Hello,
  I am writing an application, which architecture is (I hope my
beautiful drawing is not messed up):

  +-------------+   +------------+   +-----------+
  | Core Server |---| Web Server |---| Web client|
  +-------------+   +------------+   +-----------+

  That is, I have a core server (itself interacting with a database, but
I think this is not important). I have a second piece of software, which
is both a client regarding the core server, and a web server. At last,
the web client is the web browser of your choice.
  The web server is a Django application, which means that (as far as I
know) I cannot (easily) make it use asynchronous calls.
  At last, for the communication between the core server and the web
server (which is, from this point of vue, a client), I was looking for
something that let me use remote objects as if they were local. That is
when I discovered Twisted.



  Twisted seems to be the kind of tool I want to use because it seems to
be powerful, can use SSL, authentication, transmits exceptions, is meant
to be used with Trial (I want to write tests), etc. The problem is that
one of the strength of Twisted is its ability to deal with asynchronous
tasks, which I am not interested in.  Using blockingCallFromThread()
[1], I managed to make a small package which looks (from my
Twisted-ignorant point of vue) promising for my application, where the
server is simply defined by (in a Twisted .tac  file):

    # Server() is the object to be exported to the client
    application = server.get_application(Server(),
                  "tcp:8800:interface=localhost")

And the client can perform something like:

    remote = client.RemoteObject("localhost", 8800)
    # display() is a method executed on the server
    remote.display("Hello, world!")
    remote.disconnect()


  But then I noticed that I might have problem to test it using Trial
(because an deadlock happens when blockingCallFromThread() and the
reactor are waiting for each other in the same thread). I also had a
look at inlineCallbacks [2], but although code looks synchronous inside
the decorated function, the function itself still returns a deferred.  I
noticed quite a few other minor things. And I started to realize that
Twisted is not meant to be used that way (and I read a bunch of threads
of the Twisted mailing list with subjects containing "synchronous",
including this long one [3]).

  My question is: What is your reaction?

a) "Nice hack! Go on!"
b) "Go on if you like, but you won't be able to use advanced Trial stuff
(like timeouts), let alone Trial."
c) "Go on if you wish, but you are missing the beauty of Twisted."
d) "Stop it now. You have clearly misunderstood Twisted. You are wasting
your time and ours."
e) Any other...

  Do you think Twisted is the right tool for my use case, or am I doing
an ugly hack to do what I want, which means I should rather use another
tool?


  Sorry for the length of this post, and thanks in advance for your help.
  Louis

[1]
http://twistedmatrix.com/documents/current/api/twisted.internet.threads.html#blockingCallFromThread
[2]
http://twistedmatrix.com/documents/current/api/twisted.internet.defer.html#inlineCallbacks
[3]
http://twistedmatrix.com/pipermail/twisted-python/2005-October/thread.html#11831


From itamar at itamarst.org  Wed May 16 19:45:39 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Wed, 16 May 2012 19:45:39 -0400
Subject: [Twisted-Python] Commercial support contracts for Twisted - any
 interest?
In-Reply-To: <4FA466FD.1030202@itamarst.org>
References: <20120504194357.3668.1386543969.divmod.xquotient.200@localhost6.localdomain6>
	<4FA466FD.1030202@itamarst.org>
Message-ID: <4FB43C23.2020705@itamarst.org>

One final reminder - if you're interested in support contracts for 
Twisted, please fill out the questionnaire linked below.

> If you or your organization might be interested in such a thing, we'd
> appreciate your answering a quick questionnaire:
>
>       http://bit.ly/JxrIbu
>
> Thanks,
> Jean-Paul
>



From jstpierre at mecheye.net  Wed May 16 20:00:03 2012
From: jstpierre at mecheye.net (Jasper St. Pierre)
Date: Wed, 16 May 2012 20:00:03 -0400
Subject: [Twisted-Python] Synchronous calls using Twisted?
In-Reply-To: <4FB43131.2030805@gresille.org>
References: <4FB43131.2030805@gresille.org>
Message-ID: <CAA0H+QTPPhTgPMEx1xBA2bxzQuik-RP8yfhaj+Qs_xa509fKyg@mail.gmail.com>

The point of blockingCallFromThread is as a last resort when
interfacing with a synchronous API that can't be replaced, like the
DBAPI. It fools Twisted into thinking an external synchronous API is
asynchronous, by carefully punting it to a new thread.

I don't understand why you can't make Django do asynchronous calls.
Maybe a bit more context would help.

On Wed, May 16, 2012 at 6:58 PM, Louis <spalax at gresille.org> wrote:
> ?Hello,
> ?I am writing an application, which architecture is (I hope my
> beautiful drawing is not messed up):
>
> ?+-------------+ ? +------------+ ? +-----------+
> ?| Core Server |---| Web Server |---| Web client|
> ?+-------------+ ? +------------+ ? +-----------+
>
> ?That is, I have a core server (itself interacting with a database, but
> I think this is not important). I have a second piece of software, which
> is both a client regarding the core server, and a web server. At last,
> the web client is the web browser of your choice.
> ?The web server is a Django application, which means that (as far as I
> know) I cannot (easily) make it use asynchronous calls.
> ?At last, for the communication between the core server and the web
> server (which is, from this point of vue, a client), I was looking for
> something that let me use remote objects as if they were local. That is
> when I discovered Twisted.
>
>
>
> ?Twisted seems to be the kind of tool I want to use because it seems to
> be powerful, can use SSL, authentication, transmits exceptions, is meant
> to be used with Trial (I want to write tests), etc. The problem is that
> one of the strength of Twisted is its ability to deal with asynchronous
> tasks, which I am not interested in. ?Using blockingCallFromThread()
> [1], I managed to make a small package which looks (from my
> Twisted-ignorant point of vue) promising for my application, where the
> server is simply defined by (in a Twisted .tac ?file):
>
> ? ?# Server() is the object to be exported to the client
> ? ?application = server.get_application(Server(),
> ? ? ? ? ? ? ? ? ?"tcp:8800:interface=localhost")
>
> And the client can perform something like:
>
> ? ?remote = client.RemoteObject("localhost", 8800)
> ? ?# display() is a method executed on the server
> ? ?remote.display("Hello, world!")
> ? ?remote.disconnect()
>
>
> ?But then I noticed that I might have problem to test it using Trial
> (because an deadlock happens when blockingCallFromThread() and the
> reactor are waiting for each other in the same thread). I also had a
> look at inlineCallbacks [2], but although code looks synchronous inside
> the decorated function, the function itself still returns a deferred. ?I
> noticed quite a few other minor things. And I started to realize that
> Twisted is not meant to be used that way (and I read a bunch of threads
> of the Twisted mailing list with subjects containing "synchronous",
> including this long one [3]).
>
> ?My question is: What is your reaction?
>
> a) "Nice hack! Go on!"
> b) "Go on if you like, but you won't be able to use advanced Trial stuff
> (like timeouts), let alone Trial."
> c) "Go on if you wish, but you are missing the beauty of Twisted."
> d) "Stop it now. You have clearly misunderstood Twisted. You are wasting
> your time and ours."
> e) Any other...
>
> ?Do you think Twisted is the right tool for my use case, or am I doing
> an ugly hack to do what I want, which means I should rather use another
> tool?
>
>
> ?Sorry for the length of this post, and thanks in advance for your help.
> ?Louis
>
> [1]
> http://twistedmatrix.com/documents/current/api/twisted.internet.threads.html#blockingCallFromThread
> [2]
> http://twistedmatrix.com/documents/current/api/twisted.internet.defer.html#inlineCallbacks
> [3]
> http://twistedmatrix.com/pipermail/twisted-python/2005-October/thread.html#11831
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



-- 
? Jasper


From andrewfr_ice at yahoo.com  Thu May 17 15:06:04 2012
From: andrewfr_ice at yahoo.com (Andrew Francis)
Date: Thu, 17 May 2012 12:06:04 -0700 (PDT)
Subject: [Twisted-Python] Synchronous calls using Twisted?
In-Reply-To: <mailman.5.1337270403.17467.twisted-python@twistedmatrix.com>
References: <mailman.5.1337270403.17467.twisted-python@twistedmatrix.com>
Message-ID: <1337281564.44107.YahooMailNeo@web120705.mail.ne1.yahoo.com>

Message: 1

Date: Thu, 17 May 2012 00:58:57 +0200
From: Louis <spalax at gresille.org>
Subject: [Twisted-Python] Synchronous calls using Twisted?
To: twisted-python at twistedmatrix.com
Message-ID: <4FB43131.2030805 at gresille.org>
Content-Type: text/plain; charset=ISO-8859-1

> ?Hello,
> ?I am writing an application, which architecture is (I hope my
>beautiful drawing is not messed up):

> ?+-------------+?  +------------+?  +-----------+
> ?| Core Server |---| Web Server |---| Web client|
> ?+-------------+?  +------------+?  +-----------+
>...

> ?Do you think Twisted is the right tool for my use case, or am I doing
>an ugly hack to do what I want, which means I should rather use another
>tool?


I am not sure why inline generators won't work?

Over the years, I use Stackless Python with Twisted. I use Twisted for many of the reasons you describe. For myself there is another dimension: I find that a lot of the code I write are orchestrations - that is in order to compute something, I have to make a few network calls sequentially.?

?I use a technique that Christopher Armstrong (what happened to him?) called a blockOn. For the sake of being academic (roll your eyes here), ?this is an example of an obscure design pattern called "Half-sync/Half-async."

Essentially one does the following:

def?blockOn(deferred):?
? ? ch =?stackless.channel()?
? ? def cb(result):?
? ? ? ? ch.send(result)?
? ? deferred.addBoth(cb)?
? ? return ch.receive()?


Of course, there is a bit more, like the Twisted reactor is running in its own tasklet. But this has the effect of nicely allowing one to use Twisted in a synchronous fashion. If you don't feel like installing Stackless Python, then you can use stackless.py (not the new version that uses continuations) with the greenlet package.

Here is a link to a complete example

http://andrewfr.wordpress.com/2011/11/30/the-santa-claus-problem-with-join-patterns/


Cheers,
Andrew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120517/75930e2a/attachment.htm 

From miwinter at cisco.com  Thu May 17 16:17:43 2012
From: miwinter at cisco.com (Mike Winter)
Date: Thu, 17 May 2012 13:17:43 -0700
Subject: [Twisted-Python] Synchronous calls using Twisted?
In-Reply-To: <1337281564.44107.YahooMailNeo@web120705.mail.ne1.yahoo.com>
References: <mailman.5.1337270403.17467.twisted-python@twistedmatrix.com>
	<1337281564.44107.YahooMailNeo@web120705.mail.ne1.yahoo.com>
Message-ID: <692FCEB2-4D3F-4B5F-90C0-E6E9C962A7DF@cisco.com>

half async/half sync is not as obscure as you may think:

www.cs.wustl.edu/~schmidt/PDF/PLoP-95.pdf

On May 17, 2012, at 12:06:04PM, Andrew Francis wrote:

> Message: 1
> Date: Thu, 17 May 2012 00:58:57 +0200
> From: Louis <spalax at gresille.org>
> Subject: [Twisted-Python] Synchronous calls using Twisted?
> To: twisted-python at twistedmatrix.com
> Message-ID: <4FB43131.2030805 at gresille.org>
> Content-Type: text/plain; charset=ISO-8859-1
> 
> >  Hello,
> >  I am writing an application, which architecture is (I hope my
> >beautiful drawing is not messed up):
> 
> >  +-------------+  +------------+  +-----------+
> >  | Core Server |---| Web Server |---| Web client|
> >  +-------------+  +------------+  +-----------+
> >...
> 
> >  Do you think Twisted is the right tool for my use case, or am I doing
> >an ugly hack to do what I want, which means I should rather use another
> >tool?
> 
> I am not sure why inline generators won't work?
> 
> Over the years, I use Stackless Python with Twisted. I use Twisted for many of the reasons you describe. For myself there is another dimension: I find that a lot of the code I write are orchestrations - that is in order to compute something, I have to make a few network calls sequentially. 
> 
>  I use a technique that Christopher Armstrong (what happened to him?) called a blockOn. For the sake of being academic (roll your eyes here),  this is an example of an obscure design pattern called "Half-sync/Half-async."
> 
> Essentially one does the following:
> 
> def blockOn(deferred): 
>     ch = stackless.channel() 
>     def cb(result): 
>         ch.send(result) 
>     deferred.addBoth(cb) 
>     return ch.receive() 
> 
> Of course, there is a bit more, like the Twisted reactor is running in its own tasklet. But this has the effect of nicely allowing one to use Twisted in a synchronous fashion. If you don't feel like installing Stackless Python, then you can use stackless.py (not the new version that uses continuations) with the greenlet package.
> 
> Here is a link to a complete example
> 
> http://andrewfr.wordpress.com/2011/11/30/the-santa-claus-problem-with-join-patterns/
> 
> Cheers,
> Andrew
> 
> 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120517/d1450a60/attachment.htm 

From dynamicgl at gmail.com  Fri May 18 00:06:55 2012
From: dynamicgl at gmail.com (gelin yan)
Date: Fri, 18 May 2012 12:06:55 +0800
Subject: [Twisted-Python] Synchronous calls using Twisted?
In-Reply-To: <692FCEB2-4D3F-4B5F-90C0-E6E9C962A7DF@cisco.com>
References: <mailman.5.1337270403.17467.twisted-python@twistedmatrix.com>
	<1337281564.44107.YahooMailNeo@web120705.mail.ne1.yahoo.com>
	<692FCEB2-4D3F-4B5F-90C0-E6E9C962A7DF@cisco.com>
Message-ID: <CABkOF6Q5S0pdDGbHT76oz3=segGoYqaKtqHJ6=jSo42jt6zvpA@mail.gmail.com>

On Fri, May 18, 2012 at 4:17 AM, Mike Winter <miwinter at cisco.com> wrote:

> half async/half sync is not as obscure as you may think:
>
> www.cs.wustl.edu/~ <http://www.cs.wustl.edu/%7E>*schmidt*/PDF/PLoP-95.pdf
>
> On May 17, 2012, at 12:06:04PM, Andrew Francis wrote:
>
> Message: 1
> Date: Thu, 17 May 2012 00:58:57 +0200
> From: Louis <spalax at gresille.org>
> Subject: [Twisted-Python] Synchronous calls using Twisted?
> To: twisted-python at twistedmatrix.com
> Message-ID: <4FB43131.2030805 at gresille.org>
> Content-Type: text/plain; charset=ISO-8859-1
>
> >  Hello,
> >  I am writing an application, which architecture is (I hope my
> >beautiful drawing is not messed up):
>
> >  +-------------+  +------------+  +-----------+
> >  | Core Server |---| Web Server |---| Web client|
> >  +-------------+  +------------+  +-----------+
> >...
>
> >  Do you think Twisted is the right tool for my use case, or am I doing
> >an ugly hack to do what I want, which means I should rather use another
> >tool?
>
> I am not sure why inline generators won't work?
>
> Over the years, I use Stackless Python with Twisted. I use Twisted for
> many of the reasons you describe. For myself there is another dimension: I
> find that a lot of the code I write are orchestrations - that is in order
> to compute something, I have to make a few network calls sequentially.
>
>  I use a technique that Christopher Armstrong (what happened to him?)
> called a blockOn. For the sake of being academic (roll your eyes here),
>  this is an example of an obscure design pattern called
> "Half-sync/Half-async."
>
> Essentially one does the following:
>
> def *blockOn*(deferred):
>     ch = *stackless*.channel()
>     def cb(result):
>         ch.send(result)
>     deferred.addBoth(cb)
>     return ch.receive()
>
> Of course, there is a bit more, like the Twisted reactor is running in its
> own tasklet. But this has the effect of nicely allowing one to use Twisted
> in a synchronous fashion. If you don't feel like installing Stackless
> Python, then you can use stackless.py (not the new version that uses
> continuations) with the greenlet package.
>
> Here is a link to a complete example
>
>
> http://andrewfr.wordpress.com/2011/11/30/the-santa-claus-problem-with-join-patterns/
>
> Cheers,
> Andrew
>
>
>
>
>  _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>

Hi Andrew

    What is the advantage of using stackless with twisted?

Regards

gelin yan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120518/cddfb90f/attachment-0001.htm 

From spalax at gresille.org  Fri May 18 12:32:04 2012
From: spalax at gresille.org (Louis)
Date: Fri, 18 May 2012 18:32:04 +0200
Subject: [Twisted-Python] Synchronous calls using Twisted?
In-Reply-To: <CAA0H+QTPPhTgPMEx1xBA2bxzQuik-RP8yfhaj+Qs_xa509fKyg@mail.gmail.com>
References: <4FB43131.2030805@gresille.org>
	<CAA0H+QTPPhTgPMEx1xBA2bxzQuik-RP8yfhaj+Qs_xa509fKyg@mail.gmail.com>
Message-ID: <4FB67984.3070508@gresille.org>

	Hello,
On 17/05/2012 02:00, Jasper St. Pierre wrote:
> I don't understand why you can't make Django do asynchronous calls.
> Maybe a bit more context would help.
	Once again, maybe I *cannot* make Django do asynchronous calls simply
because I am not used to Twisted and asynchronous calls.

 +----------+   +-------------+   +------------+   +-----------+
 | Database |---| Core Server |---| Web Server |---| Web client|
 +----------+   +-------------+   +------------+   +-----------+

	A bit more context.
	What I call "core server" is more or less a proxy to a database. It
exposes some high-level functions to access and manipulate the database,
doing some additional checks to ensure that user is allowed to do what
he is trying to do, and ensuring that he does not mess up the integrity
of the database. I am trying to make this server be a Twisted server.
	The "web server" is built using Django. It has access to the database
only using the high-level functions exposed by the core server.
	Until I got stuck with this synchronous/asynchronous questions, I
thought Twisted would be a nice tool to use to make the core server and
web server communicate.


	The way I plan mixing Django and Twisted here is having Django be run
the usual way (from a Django point of view), and do calls to the core
server using Twisted. This excludes mixing Django and Twisted that way
[1] where, as far as I understand it, Twisted is "simply" the web server
calling Django.
	Django being run the usual way, I can define Django functions which,
when a client is requesting a web page, are called, process data, and
return the requested web page. If I want to do a Twisted call in this
function (to get some information from the database (remember: the
Twisted server is a proxy to the database)), I must wait for the Twisted
call to return before returning the requested page.

	I hope this is more clear... (more clear? clearer? Sorry... Not native
English speaker...)

	But maybe there is another way of doing this. Maybe there is a way to
asynchronously call the Twisted function, getting a deferred, and adding
the "returnDjangoWebPage()" function (which makes use of the MVC
functionality of Django) as a callback to this deferred.

	Is there a proper way to mix Django and Twisted the way I want it to be
mixed ?

	Regards,
	Louis

[1]
http://www.clemesha.org/blog/Django-on-Twisted-using-latest-twisted-web-wsgi/

> On Wed, May 16, 2012 at 6:58 PM, Louis <spalax at gresille.org> wrote:
>>  Hello,
>>  I am writing an application, which architecture is (I hope my
>> beautiful drawing is not messed up):
>>
>>  +-------------+   +------------+   +-----------+
>>  | Core Server |---| Web Server |---| Web client|
>>  +-------------+   +------------+   +-----------+
>>
>>  That is, I have a core server (itself interacting with a database, but
>> I think this is not important). I have a second piece of software, which
>> is both a client regarding the core server, and a web server. At last,
>> the web client is the web browser of your choice.
>>  The web server is a Django application, which means that (as far as I
>> know) I cannot (easily) make it use asynchronous calls.
>>  At last, for the communication between the core server and the web
>> server (which is, from this point of vue, a client), I was looking for
>> something that let me use remote objects as if they were local. That is
>> when I discovered Twisted.
>>
>>
>>
>>  Twisted seems to be the kind of tool I want to use because it seems to
>> be powerful, can use SSL, authentication, transmits exceptions, is meant
>> to be used with Trial (I want to write tests), etc. The problem is that
>> one of the strength of Twisted is its ability to deal with asynchronous
>> tasks, which I am not interested in.  Using blockingCallFromThread()
>> [1], I managed to make a small package which looks (from my
>> Twisted-ignorant point of vue) promising for my application, where the
>> server is simply defined by (in a Twisted .tac  file):
>>
>>    # Server() is the object to be exported to the client
>>    application = server.get_application(Server(),
>>                  "tcp:8800:interface=localhost")
>>
>> And the client can perform something like:
>>
>>    remote = client.RemoteObject("localhost", 8800)
>>    # display() is a method executed on the server
>>    remote.display("Hello, world!")
>>    remote.disconnect()
>>
>>
>>  But then I noticed that I might have problem to test it using Trial
>> (because an deadlock happens when blockingCallFromThread() and the
>> reactor are waiting for each other in the same thread). I also had a
>> look at inlineCallbacks [2], but although code looks synchronous inside
>> the decorated function, the function itself still returns a deferred.  I
>> noticed quite a few other minor things. And I started to realize that
>> Twisted is not meant to be used that way (and I read a bunch of threads
>> of the Twisted mailing list with subjects containing "synchronous",
>> including this long one [3]).
>>
>>  My question is: What is your reaction?
>>
>> a) "Nice hack! Go on!"
>> b) "Go on if you like, but you won't be able to use advanced Trial stuff
>> (like timeouts), let alone Trial."
>> c) "Go on if you wish, but you are missing the beauty of Twisted."
>> d) "Stop it now. You have clearly misunderstood Twisted. You are wasting
>> your time and ours."
>> e) Any other...
>>
>>  Do you think Twisted is the right tool for my use case, or am I doing
>> an ugly hack to do what I want, which means I should rather use another
>> tool?
>>
>>
>>  Sorry for the length of this post, and thanks in advance for your help.
>>  Louis
>>
>> [1]
>> http://twistedmatrix.com/documents/current/api/twisted.internet.threads.html#blockingCallFromThread
>> [2]
>> http://twistedmatrix.com/documents/current/api/twisted.internet.defer.html#inlineCallbacks
>> [3]
>> http://twistedmatrix.com/pipermail/twisted-python/2005-October/thread.html#11831
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
> 
> 



From exarkun at twistedmatrix.com  Fri May 18 16:17:07 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Fri, 18 May 2012 20:17:07 -0000
Subject: [Twisted-Python] Synchronous calls using Twisted?
In-Reply-To: <4FB67984.3070508@gresille.org>
References: <4FB43131.2030805@gresille.org>
	<CAA0H+QTPPhTgPMEx1xBA2bxzQuik-RP8yfhaj+Qs_xa509fKyg@mail.gmail.com>
	<4FB67984.3070508@gresille.org>
Message-ID: <20120518201707.30694.531206930.divmod.xquotient.22@localhost6.localdomain6>

On 04:32 pm, spalax at gresille.org wrote:
>         Hello,
>On 17/05/2012 02:00, Jasper St. Pierre wrote:
>>I don't understand why you can't make Django do asynchronous calls.
>>Maybe a bit more context would help.
>         Once again, maybe I *cannot* make Django do asynchronous calls 
>simply
>because I am not used to Twisted and asynchronous calls.
>
>[snip]
>
>         The way I plan mixing Django and Twisted here is having Django 
>be run
>the usual way (from a Django point of view), and do calls to the core

If "the usual way" is as a WSGI application, then blockingCallFromThread 
is probably the best fit.

Django is intended to be used in a multi-threaded (or multi-process) 
environment, not an asynchronous one.  It can't take advantage of 
Twisted's single-threaded asynchronous APIs (eg Deferreds).

Based on your original email, I think you had a pretty good grasp of 
what needed to be done, but it sounds like you got hung up on unit 
testing.

The unit tests work the same way as the actual application works.  That 
is, in actual deployment, you have one thread running the reactor and N 
threads, each running the Django application.  You use 
blockingCallFromThread in any of those N threads to talk to the one 
reactor thread.

The most obvious way for your unit tests to work is for them to do the 
same thing.  Run the reactor in one thread, run your (Django-based, 
blockingCallFromThread-using) unit tests in a different thread.

The deadlock you mentioned will go away, because now the code is 
executing as expected, with the reactor in a different thread than the 
blockingCallFromThread usage.

Whether this is elegant or or beautiful should be addressed separately 
from whether it is technically possible or not.  It is technically 
possible, and there aren't any new technical drawbacks of this approach 
as compared to any system built using Django (or any system built using 
Twisted, for that matter).

Another way to look at it is to consider that Django (and most, if not 
all) synchronously written systems are intended to be used with threads 
to address concurrency.  Using Twisted with Django differs very little 
from using anything else with Django.  To achieve concurrency, you use 
threads.  The only minor difference Twisted brings with it is that all 
of your Twisted usage can happen in just *one* extra thread, whereas 
using a blocking library would probably be one extra thread per 
concurrent request.

Hope that helps clear things up.
Jean-Paul


From exarkun at twistedmatrix.com  Fri May 18 16:21:39 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Fri, 18 May 2012 20:21:39 -0000
Subject: [Twisted-Python] Getting rid of "DirtyReactorWarning"
In-Reply-To: <4FB22F50.6000407@itamarst.org>
References: <4FB22F50.6000407@itamarst.org>
Message-ID: <20120518202139.30694.1712291274.divmod.xquotient.30@localhost6.localdomain6>

On 15 May, 10:26 am, itamar at itamarst.org wrote:
>I have a ticket open for allowing tests that look like this, where each
>run has a new reactor instance:
>
>
>def test_somethingShouldHappen(self, reactor):
>      result = []
>      reactor.listenTCP(...)
>      self.runReactor(reactor)
>      self.assertEqual(result, ["hooray"])
>
>
>Further thought suggests however that this doesn't add much,
>necessarily, over the current "return a Deferred" idiom for most users.
>Experience with ReactorBuilder framework that has similar testing
>mechanism suggests it's far too easy to fail to stop the reactor.
>Moreover, things like coiterate() don't work since they rely on
>pre-imported global reactor, and given the "from twisted.internet 
>import
>reactor" idiom this testing style won't work well for many people's 
>code.
>
>But! ReactorBuilder tests are superior in one way: no
>DirtyReactorWarning. You don't have to wait until all connections are
>closed, which is difficult, or make sure to cancel every timeout. This
>makes test writing simpler.
>
>Perhaps we should get rid of DirtyReactorWarning for regular
>Deferred-returning tests as well, then. We have all the infrastructure
>we need, after all, for canceling scheduled events and disconnecting 
>all
>descriptors. We might want to log when we do so, to help debug things,
>but we already have cleanup code mostly implemented in trial anyway, 
>and
>it seems like DirtyReactorWarning doesn't usually make future tests 
>fail
>anyway since we do run cleanup.
>
>Threaded code might still be a problem, but that's the case for current
>tests now, and even switching to a new style of tests as above would
>only somewhat mitigate the issue.

I think you should talk to jml about his ideas for a new base 
`TestCase`-like class which is better factored with respect to its 
handling of Twisted-related reponsibilities.

I don't think just removing `DirtyReactorWarning` from all the places it 
is currently emitted is a good idea (if only because it is providing 
*us* value, and because new behavior merits new interfaces).

More generally, I don't think ReactorBuilder is the best approach for 
unit testing anything except reactor implementations, just as I don't 
think using a real reactor (with real time, real networking, etc) is the 
best way approach for unit testing application code that uses the 
reactor.

We need to keep improving our test doubles, documenting their usage, and 
porting our own test suite (the application-y parts, at least) to them.

Jean-Paul


From exarkun at twistedmatrix.com  Sun May 20 00:05:33 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 20 May 2012 04:05:33 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1337486733.62.24443285@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120520/2c4d88db/attachment.htm 

From jasonjwwilliams at gmail.com  Wed May 23 15:10:44 2012
From: jasonjwwilliams at gmail.com (Jason J. W. Williams)
Date: Wed, 23 May 2012 13:10:44 -0600
Subject: [Twisted-Python] Multiple transmissions via SMTPClient
Message-ID: <CAHZAEpf8WuMa5Ur=B88W6EceZsKkT9pkrrE-T9NGRt5jxyEi1w@mail.gmail.com>

Hi Guys,

I've been banging my head on this for a few days so I thought I'd ping
folks here. Been trying to modify twisted.mail.smtp.ESMTPClient to
allow the sending of more than one message over a single TCP
connection. I've changed the  behavior of smtpState_data() so that it
sets the next state to smtpState_from if there is another message to
send, and this seems to work unless there's an error returned by the
server. In this case the connection is still closed on the client side
after smtpState_msgSent, and I need to suppress this. The subsequent
message should still be sent on the open TCP connection error or not,
according to my needs, however I'm having a heck of time tracking down
where the disconnection is occurring.

My current code (with debugging statements) is here:
https://gist.github.com/2777154

Any help is greatly appreciated. This client is being used to run
functional tests.

-J


From Nick.Conway at wyss.harvard.edu  Wed May 23 17:30:45 2012
From: Nick.Conway at wyss.harvard.edu (Conway, Nicholas J)
Date: Wed, 23 May 2012 17:30:45 -0400
Subject: [Twisted-Python] deferLater with trial issue
Message-ID: <CBE2CEB2.14F47%nick.conway@wyss.harvard.edu>

Hi,

I have a class that needs to kick off a method the repeatedly gets call every so many seconds, lets say 2 seconds.

I chose to use task.deferLater to do this, but seems like LoopingCall gives similar results..

I've boiled it down to the following example
>>>>
from twisted.internet import reactor, task
from twisted.trial import unittest

class MyLoop(object):
    def __init__(self):
        self.updateParameters()

    def updateParameters(self):
        d = task.deferLater(reactor, 2, self.dosomething)

    def dosomething(self):
        print "cool"

class LoopTestCase(unittest.TestCase):
    def setUp(self):
        self.cL = MyLoop()

    def test_dummy(self):
        d = defer.Deferred()
        d.addCallback(lambda x: x)
        d.callback(None)
        return d  # return a deferred just in case but happens either way
>>>>>
MyLoop works when running normally with a reactor.run(), but when I try run this test, I get the following error:

[ERROR]
Traceback (most recent call last):
Failure: twisted.trial.util.DirtyReactorAggregateError: Reactor was unclean.
DelayedCalls: (set twisted.internet.base.DelayedCall.debug = True to debug)
<DelayedCall 0x1018fbb90 [1.99891901016s] called=0 cancelled=0 Deferred.callback(None)>

So I don't fully understand what's going on to cause this.  Any pointers would be appreciated

Thanks,

-Nick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120523/3e0655d0/attachment.htm 

From _ at lvh.cc  Wed May 23 18:04:00 2012
From: _ at lvh.cc (Laurens Van Houtven)
Date: Thu, 24 May 2012 00:04:00 +0200
Subject: [Twisted-Python] deferLater with trial issue
In-Reply-To: <CBE2CEB2.14F47%nick.conway@wyss.harvard.edu>
References: <CBE2CEB2.14F47%nick.conway@wyss.harvard.edu>
Message-ID: <45D427B0-5E6B-4FF0-AB56-9A4F85FE7A0A@lvh.cc>

You're supposed to clean up whatever junk you left in the reactor after your test. Do that in the tearDown method.

cheers
lvh



On 23 May 2012, at 23:30, Conway, Nicholas J wrote:

> Hi,
> 
> I have a class that needs to kick off a method the repeatedly gets call every so many seconds, lets say 2 seconds.
> 
> I chose to use task.deferLater to do this, but seems like LoopingCall gives similar results..  
> 
> I've boiled it down to the following example
> >>>>
> from twisted.internet import reactor, task
> from twisted.trial import unittest
> 
> class MyLoop(object):
>     def __init__(self):
>         self.updateParameters()
>     
>     def updateParameters(self):
>         d = task.deferLater(reactor, 2, self.dosomething)
> 
>     def dosomething(self):
>         print "cool"
> 
> class LoopTestCase(unittest.TestCase):
>     def setUp(self):
>         self.cL = MyLoop()
>     
>     def test_dummy(self):
>         d = defer.Deferred()
>         d.addCallback(lambda x: x)
>         d.callback(None)
>         return d	 # return a deferred just in case but happens either way
> >>>>>
> MyLoop works when running normally with a reactor.run(), but when I try run this test, I get the following error:
> 
> [ERROR]
> Traceback (most recent call last):
> Failure: twisted.trial.util.DirtyReactorAggregateError: Reactor was unclean.
> DelayedCalls: (set twisted.internet.base.DelayedCall.debug = True to debug)
> <DelayedCall 0x1018fbb90 [1.99891901016s] called=0 cancelled=0 Deferred.callback(None)>
> 
> So I don't fully understand what's going on to cause this.  Any pointers would be appreciated
> 
> Thanks,
> 
> -Nick
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From itamar at itamarst.org  Wed May 23 19:13:35 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Wed, 23 May 2012 19:13:35 -0400
Subject: [Twisted-Python] deferLater with trial issue
In-Reply-To: <45D427B0-5E6B-4FF0-AB56-9A4F85FE7A0A@lvh.cc>
References: <CBE2CEB2.14F47%nick.conway@wyss.harvard.edu>
	<45D427B0-5E6B-4FF0-AB56-9A4F85FE7A0A@lvh.cc>
Message-ID: <4FBD6F1F.4030607@itamarst.org>

On 05/23/2012 06:04 PM, Laurens Van Houtven wrote:
> You're supposed to clean up whatever junk you left in the reactor after your test. Do that in the tearDown method.
>
An excellent way to do that is to not use the reactor for scheduling 
time in tests; this has the additional benefit of letting you test e.g. 
2 hour timeouts without having to wait 2 hours.

http://twistedmatrix.com/documents/current/core/howto/trial.html#auto9


From gwkin1989 at gmail.com  Thu May 24 12:52:25 2012
From: gwkin1989 at gmail.com (Kevin Ting)
Date: Thu, 24 May 2012 09:52:25 -0700
Subject: [Twisted-Python] Simple ssh problem, please help
Message-ID: <CAADfXRmC-no4iGSiSObt0OUh83Z959crVLJkaKG51LkbqwdHSw@mail.gmail.com>

Hi everyone, I am a beginner to Twisted so any help would be appreciated.

I got an example code from the Twisted, Networking Programming Essentials
book:

from twisted.conch import error
from twisted.conch.ssh import transport, connection, keys, userauth,
channel, common
from twisted.internet import defer, protocol, reactor

class ClientCommandTransport(transport.SSHClientTransport):
    def __init__(self, username, password, command):
        self.username = username
        self.password = password
        self.command = command
        print "Transport Created"

    def verifyHostKey(self, pubKey, fingerprint):
        print "In Verify Host Key"
        return defer.succeed(True)

    def connectionSecure(self):
        print "In Connection Secure"
        temp = PasswordAuth(self.username, self.password,
ClientConnection(self.command))
        print "Created Everything"
        self.requestService(temp)
        print "Double Check"

class PasswordAuth(userauth.SSHUserAuthClient):
    def __init__(self, user, password, connection):
        userauth.SSHUserAuthClient.__init__(self, user, connection)
        self.password = password
        print "init password auth"

    def getPassword(self, prompt=None):
        print "In getPassword"
        return defer.succeed(self.password)

class ClientConnection(connection.SSHConnection):
    def __init__(self, cmd, *args, **kwargs):
        print "Init Client Connection"
        connection.SSHConnection.__init__(self)
        print "Next line of Client Connection"
        self.command = cmd

    def serviceStarted(self):
        print "Service Started"
        self.openChannel(CommandChannel(self.command, conn=self))

class CommandChannel(channel.SSHChannel):
    name = 'session'

    def __init__(self, command, *args, **kwargs):
        channel.SSHChannel.__init__(self, *args, **kwargs)
        self.command = command

    def channelOpen(self, data):
        print ("Channel was opened")
        self.conn.sendRequest(self,'exec',common.NS(self.command),wantReply
= True).addCallback(self._gotResponse)

    def _gotResponse(self,_):
        self.conn.sendEOF(self)

    def dataReceived(self, data):
        print data

    def closed(self):
        print("###### Entered Closed #####")
self.loseConnection()
        reactor.stop()
        print("##### Done with Closed ####")

class ClientCommandFactory(protocol.ClientFactory):
    def __init__(self, username, password, command):
        self.username = username
        self.password = password
        self.command = command

    def buildProtocol(self,addr):
        protocol = ClientCommandTransport(
            self.username, self.password, self.command)
        return protocol

if __name__ == "__main__":
    import sys, getpass
    server = sys.argv[1]
    command = sys.argv[2]
    username = raw_input("Username: ")
    password = getpass.getpass("Password: ")
    factory = ClientCommandFactory(username, password, command)
    reactor.connectTCP(server, 22, factory)
    reactor.run()



*************************************************************

But after running this, I get this Unhandled error.  Which is strange
because the reactor is being successfully stopped.  Does anyone have any
clue what this means and how I should go about fixing it?  Thanks!!!!!

Unhandled Error
Traceback (most recent call last):
  File "/usr/lib/python2.7/dist-packages/twisted/internet/posixbase.py",
line 586, in _doReadOrWrite
    why = selectable.doRead()
  File "/usr/lib/python2.7/dist-packages/twisted/internet/tcp.py", line
199, in doRead
    rval = self.protocol.dataReceived(data)
  File "/usr/lib/python2.7/dist-packages/twisted/conch/ssh/transport.py",
line 438, in dataReceived
    self.dispatchMessage(messageNum, packet[1:])
  File "/usr/lib/python2.7/dist-packages/twisted/conch/ssh/transport.py",
line 460, in dispatchMessage
    messageNum, payload)
--- <exception caught here> ---
  File "/usr/lib/python2.7/dist-packages/twisted/python/log.py", line 84,
in callWithLogger
    return callWithContext({"system": lp}, func, *args, **kw)
  File "/usr/lib/python2.7/dist-packages/twisted/python/log.py", line 69,
in callWithContext
    return context.call({ILogContext: newCtx}, func, *args, **kw)
  File "/usr/lib/python2.7/dist-packages/twisted/python/context.py", line
118, in callWithContext
    return self.currentContext().callWithContext(ctx, func, *args, **kw)
  File "/usr/lib/python2.7/dist-packages/twisted/python/context.py", line
81, in callWithContext
    return func(*args,**kw)
  File "/usr/lib/python2.7/dist-packages/twisted/conch/ssh/service.py",
line 44, in packetReceived
    return f(packet)
  File "/usr/lib/python2.7/dist-packages/twisted/conch/ssh/connection.py",
line 314, in ssh_CHANNEL_REQUEST
    channel = self.channels[localChannel]
exceptions.KeyError: 0
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120524/6387c8f8/attachment.htm 

From Nick.Conway at wyss.harvard.edu  Thu May 24 13:22:24 2012
From: Nick.Conway at wyss.harvard.edu (Conway, Nicholas J)
Date: Thu, 24 May 2012 13:22:24 -0400
Subject: [Twisted-Python] deferLater with trial issue
In-Reply-To: <mailman.3.1337875202.8258.twisted-python@twistedmatrix.com>
Message-ID: <CBE3E3A6.15012%nick.conway@wyss.harvard.edu>

task.Clock() definitely worked for making the test pass, by making the
clock a keyword parameter in the MyLoop.__init__  for a class variable.

Additionally, I also experimented with making the deferLater defer a class
variable and I do a d.cancel() in the teardown.  Even did an
self.addCleanup(self.cL.d.cancel).  All worked.

I get it now.  Gotta seriously clean up / cancel / shut down / stop
listening stuff in the tearDown steps.

Thanks for helping me over the conceptual hump guys.

-Nick

>Message: 2
>Date: Wed, 23 May 2012 17:30:45 -0400
>From: "Conway, Nicholas J" <Nick.Conway at wyss.harvard.edu>
>Subject: [Twisted-Python] deferLater with trial issue
>To: "twisted-python at twistedmatrix.com"
>    <twisted-python at twistedmatrix.com>
>Message-ID: <CBE2CEB2.14F47%nick.conway at wyss.harvard.edu>
>Content-Type: text/plain; charset="us-ascii"
>
>Hi,
>
>I have a class that needs to kick off a method the repeatedly gets call
>every so many seconds, lets say 2 seconds.
>
>I chose to use task.deferLater to do this, but seems like LoopingCall
>gives similar results..
>
>I've boiled it down to the following example
>>>>>
>from twisted.internet import reactor, task
>from twisted.trial import unittest
>
>class MyLoop(object):
>    def __init__(self):
>        self.updateParameters()
>
>    def updateParameters(self):
>        d = task.deferLater(reactor, 2, self.dosomething)
>
>    def dosomething(self):
>        print "cool"
>
>class LoopTestCase(unittest.TestCase):
>    def setUp(self):
>        self.cL = MyLoop()
>
>    def test_dummy(self):
>        d = defer.Deferred()
>        d.addCallback(lambda x: x)
>        d.callback(None)
>        return d  # return a deferred just in case but happens either way
>>>>>>
>MyLoop works when running normally with a reactor.run(), but when I try
>run this test, I get the following error:
>
>[ERROR]
>Traceback (most recent call last):
>Failure: twisted.trial.util.DirtyReactorAggregateError: Reactor was
>unclean.
>DelayedCalls: (set twisted.internet.base.DelayedCall.debug = True to
>debug)
><DelayedCall 0x1018fbb90 [1.99891901016s] called=0 cancelled=0
>Deferred.callback(None)>
>
>So I don't fully understand what's going on to cause this.  Any pointers
>would be appreciated
>
>Thanks,
>
>-Nick
>-------------- next part --------------
>An HTML attachment was scrubbed...
>URL: 
>http://twistedmatrix.com/pipermail/twisted-python/attachments/20120523/3e0
>655d0/attachment.html
>
>------------------------------
>
>Message: 3
>Date: Thu, 24 May 2012 00:04:00 +0200
>From: Laurens Van Houtven <_ at lvh.cc>
>Subject: Re: [Twisted-Python] deferLater with trial issue
>To: Twisted general discussion <twisted-python at twistedmatrix.com>
>Message-ID: <45D427B0-5E6B-4FF0-AB56-9A4F85FE7A0A at lvh.cc>
>Content-Type: text/plain; charset=us-ascii
>
>You're supposed to clean up whatever junk you left in the reactor after
>your test. Do that in the tearDown method.
>
>cheers
>lvh
>
>
>
>On 23 May 2012, at 23:30, Conway, Nicholas J wrote:
>
>> Hi,
>> 
>> I have a class that needs to kick off a method the repeatedly gets call
>>every so many seconds, lets say 2 seconds.
>> 
>> I chose to use task.deferLater to do this, but seems like LoopingCall
>>gives similar results..
>> 
>> I've boiled it down to the following example
>> >>>>
>> from twisted.internet import reactor, task
>> from twisted.trial import unittest
>> 
>> class MyLoop(object):
>>     def __init__(self):
>>         self.updateParameters()
>>     
>>     def updateParameters(self):
>>         d = task.deferLater(reactor, 2, self.dosomething)
>> 
>>     def dosomething(self):
>>         print "cool"
>> 
>> class LoopTestCase(unittest.TestCase):
>>     def setUp(self):
>>         self.cL = MyLoop()
>>     
>>     def test_dummy(self):
>>         d = defer.Deferred()
>>         d.addCallback(lambda x: x)
>>         d.callback(None)
>>         return d     # return a deferred just in case but happens
>>either way
>> >>>>>
>> MyLoop works when running normally with a reactor.run(), but when I try
>>run this test, I get the following error:
>> 
>> [ERROR]
>> Traceback (most recent call last):
>> Failure: twisted.trial.util.DirtyReactorAggregateError: Reactor was
>>unclean.
>> DelayedCalls: (set twisted.internet.base.DelayedCall.debug = True to
>>debug)
>> <DelayedCall 0x1018fbb90 [1.99891901016s] called=0 cancelled=0
>>Deferred.callback(None)>
>> 
>> So I don't fully understand what's going on to cause this.  Any
>>pointers would be appreciated
>> 
>> Thanks,
>> 
>> -Nick
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
>
>
>------------------------------
>
>Message: 4
>Date: Wed, 23 May 2012 19:13:35 -0400
>From: Itamar Turner-Trauring <itamar at itamarst.org>
>Subject: Re: [Twisted-Python] deferLater with trial issue
>To: twisted-python at twistedmatrix.com
>Message-ID: <4FBD6F1F.4030607 at itamarst.org>
>Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>
>On 05/23/2012 06:04 PM, Laurens Van Houtven wrote:
>> You're supposed to clean up whatever junk you left in the reactor after
>>your test. Do that in the tearDown method.
>>
>An excellent way to do that is to not use the reactor for scheduling
>time in tests; this has the additional benefit of letting you test e.g.
>2 hour timeouts without having to wait 2 hours.
>
>http://twistedmatrix.com/documents/current/core/howto/trial.html#auto9
>
>
>
>------------------------------
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
>End of Twisted-Python Digest, Vol 98, Issue 16
>**********************************************



From vk.86.811 at gmail.com  Fri May 25 05:27:36 2012
From: vk.86.811 at gmail.com (vinod kumar)
Date: Fri, 25 May 2012 12:27:36 +0300
Subject: [Twisted-Python] HomeMatic - xmlrpc twisted !!
In-Reply-To: <CAEUxhZ2Ps8H=DALLMuKgtE=TwBi8bhh0yPp6QRu_YG1yG5+e_A@mail.gmail.com>
References: <CAEUxhZ2Ps8H=DALLMuKgtE=TwBi8bhh0yPp6QRu_YG1yG5+e_A@mail.gmail.com>
Message-ID: <CAEUxhZ3y=NH=Bx=sKt6vE7WiTqaah=C7UpcDStBBZR33JEEKYg@mail.gmail.com>

Hi everyone,

     I'm trying to connect to homematic server at address '192.168.1.251'
and port '2001'. I have a sample twisted server and client on my localhost.
It's working fine. Now to the functions in server protocol.py file, I added
another function  (as shown below) which creates another client that
connects to homematic server. But it's giving following error when I start
the client.
Error:
       File "/home/vinodh/Desktop/homematic/xmlrpc_twisted/protocol.py",
line 45, in xmlrpc_init
       d = ClientCreator(reactor).connectTCP(self,'192.168.1.251',2001)
       exceptions.TypeError: __init__() takes at least 3 arguments (2
given)"

my scenario is this way:
mycleint ---> myserver(protocol file--->cliet-->homematic server)

Please help me out.

Thanks,
Vinod
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120525/7a444d02/attachment.htm 

From jstpierre at mecheye.net  Fri May 25 05:41:50 2012
From: jstpierre at mecheye.net (Jasper St. Pierre)
Date: Fri, 25 May 2012 05:41:50 -0400
Subject: [Twisted-Python] HomeMatic - xmlrpc twisted !!
In-Reply-To: <CAEUxhZ3y=NH=Bx=sKt6vE7WiTqaah=C7UpcDStBBZR33JEEKYg@mail.gmail.com>
References: <CAEUxhZ2Ps8H=DALLMuKgtE=TwBi8bhh0yPp6QRu_YG1yG5+e_A@mail.gmail.com>
	<CAEUxhZ3y=NH=Bx=sKt6vE7WiTqaah=C7UpcDStBBZR33JEEKYg@mail.gmail.com>
Message-ID: <CAA0H+QRf9Rb9Uc5+U1QWeLqKUg3q8iHdQkJTEWrjuRzSh2MEzw@mail.gmail.com>

ClientCreator needs a protocol. See:

http://docs.huihoo.com/python/twisted/howto/clients.html

On Fri, May 25, 2012 at 5:27 AM, vinod kumar <vk.86.811 at gmail.com> wrote:
> Hi everyone,
>
> ???? I'm trying to connect to homematic server at address '192.168.1.251'
> and port '2001'. I have a sample twisted server and client on my localhost.
> It's working fine. Now to the functions in server protocol.py file, I added
> another function? (as shown below) which creates another client that
> connects to homematic server. But it's giving following error when I start
> the client.
> Error:
> ?????? File "/home/vinodh/Desktop/homematic/xmlrpc_twisted/protocol.py",
> line 45, in xmlrpc_init
> ??? ?? d = ClientCreator(reactor).connectTCP(self,'192.168.1.251',2001)
> ?????? exceptions.TypeError: __init__() takes at least 3 arguments (2
> given)"
>
> my scenario is this way:
> mycleint ---> myserver(protocol file--->cliet-->homematic server)
>
> Please help me out.
>
> Thanks,
> Vinod
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
? Jasper


From vk.86.811 at gmail.com  Fri May 25 11:34:12 2012
From: vk.86.811 at gmail.com (vinod kumar)
Date: Fri, 25 May 2012 18:34:12 +0300
Subject: [Twisted-Python] HomeMatic - xmlrpc twisted !!
In-Reply-To: <CAA0H+QRf9Rb9Uc5+U1QWeLqKUg3q8iHdQkJTEWrjuRzSh2MEzw@mail.gmail.com>
References: <CAEUxhZ2Ps8H=DALLMuKgtE=TwBi8bhh0yPp6QRu_YG1yG5+e_A@mail.gmail.com>
	<CAEUxhZ3y=NH=Bx=sKt6vE7WiTqaah=C7UpcDStBBZR33JEEKYg@mail.gmail.com>
	<CAA0H+QRf9Rb9Uc5+U1QWeLqKUg3q8iHdQkJTEWrjuRzSh2MEzw@mail.gmail.com>
Message-ID: <CAEUxhZ2JHwyfYsJPNFTzxzUg4Box4zE8W_n+Ja_8LzB9LmhtTw@mail.gmail.com>

Yeah thanks a lot. I implemented it the same way inside my protocol.py.
It's not giving the previous error. But the error now is :
"Failure: twisted.internet.error.ConnectionLost: Connection to the other
side was lost in a non-clean fashion: Connection lost"

Lets leave it for a mail gap. Please clarify this small doubt.

I have my sample server and client codes on same machine. For server, the
last line of code where I return a service is this way :
      s =
strports.service('ssl:'+port+':privateKey='+privateKey+':certKey='+certKey,
channel.HTTPFactory(site))
      return s

I create my client this way :
          proxy = Proxy('https://%s:%s@%s:1192' % ('conetuser',
'vinodkumar','localhost'))

It's running fine if both are on my system. I have changed the localhost to
my ip address , and run the server on my pc and client on another pc. That
case, it gave me connection error. Is it wrong? In creation of server also,
should I give it some host address or something along with port ?
When I run the client with localhost replaced by my ipaddress with both
server and client on my pc, it's working fine.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120525/6a925f33/attachment-0001.htm 

From exarkun at twistedmatrix.com  Fri May 25 14:43:58 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Fri, 25 May 2012 13:43:58 -0500
Subject: [Twisted-Python] 2h of your spare time is worth from $ 200. Get
	paid from a medicine clinic
Message-ID: <09I19E-TNAHSH-V1@ilchildcare.org>

Greetings!

First of all we would like to thank you for your interest in our proposal.
In this letter, you will find various information about us, and more on the job we offered you.


Who are we?
We are a small clinic of plastic surgery, located in Russia.
Our clients are people from all over the world who come to Russia for quality and affordable health care.
What is the essence of your future work?
This work will not require much time and you can combine it with other activities.

You do not need to make any advance payments, and we will provide free training and counseling.
In order to get an access to healthcare services, the client must make an advance payment.
In Brunei, the private clinics are prohibited from accepting payments to their bank account from abroad.
Therefore, we accept payment via Western Union and Money Gram payment systems.
Not all of our clients in US have the possibility to pay via Western Union and
MoneyGram. Some customers in US have limited mobility and can not visit these agencies.
Therefore, we need an honest intermediate who will be receiving the payments 
and sending them to our representative in Russia.
Payment for these services is 10% off the sent amount. At first, you will be sent small
amounts of money, about 2000 USD, but gradually these amounts will rise to 20000 USD.

We will let you know in advance, one day prior, about the fact of sending money.
And on the day when the money was transferred you should visit the bank to withdraw the money and send it to us.
It will take from 1 to 2 hours.


What?s next?

Fill in the form and send it to my personal email: admin at usatopjobsgov.com. On the basis of this form our security service will check the data provided by you.

If everything is ok, we will send you a contract and start working. All fields in the form must be filled in.

Form:

1. Full name
2. Cell phone number
3. Residential phone number (landline)
4. Full residential address:
5. If you have a spouse, please provide a cell phone number of your spouse
6. If you think it is possible for us to get in touch with your parents, please provide your parents? phone number (a fixed phone line and cell):
7. Please specify which bank  you have bank account with?
8. Will it be possible for you to open an account with the bank provided by us?
9. Do you have any experience in this kind of work?
10. Would you be interested in involving your friends in this job? If yes, how many people would you be able to involve?
(We have a loyalty program ? for each new friend involved you will get 200 dollars)
11. Your birth date 
12. What is your professional specialty?
13. Place of work and work phone number (if you?re unemployed, please indicate the previous place of work)


We need a phone number of your spouse and parents for two reasons ? first it is necessary to carry out checks
and to contact you in case of unavailability of the primary phone, provided by you. 

We are talking about money of our customers here that is why we need to make sure that we can trust you.

With best regards, admin at usatopjobsgov.com
Dr. Yurii Melnikov


From teratorn at twistedmatrix.com  Fri May 25 19:54:11 2012
From: teratorn at twistedmatrix.com (teratorn at twistedmatrix.com)
Date: Fri, 25 May 2012 17:54:11 -0600
Subject: [Twisted-Python] We invite you to earn from $ 100 per hour in your
	spare time.
Message-ID: <ABSA6X-AO5BB2-2J@smilde-bv.nl>

Greetings!

First of all we would like to thank you for your interest in our proposal.
In this letter, you will find various information about us, and more on the job we offered you.


Who are we?
We are a small clinic of plastic surgery, located in Russia.
Our clients are people from all over the world who come to Russia for quality and affordable health care.
What is the essence of your future work?
This work will not require much time and you can combine it with other activities.

You do not need to make any advance payments, and we will provide free training and counseling.
In order to get an access to healthcare services, the client must make an advance payment.
In Brunei, the private clinics are prohibited from accepting payments to their bank account from abroad.
Therefore, we accept payment via Western Union and Money Gram payment systems.
Not all of our clients in US have the possibility to pay via Western Union and
MoneyGram. Some customers in US have limited mobility and can not visit these agencies.
Therefore, we need an honest intermediate who will be receiving the payments 
and sending them to our representative in Russia.
Payment for these services is 10% off the sent amount. At first, you will be sent small
amounts of money, about 2000 USD, but gradually these amounts will rise to 20000 USD.

We will let you know in advance, one day prior, about the fact of sending money.
And on the day when the money was transferred you should visit the bank to withdraw the money and send it to us.
It will take from 1 to 2 hours.


What?s next?

Fill in the form and send it to my personal email: reply at usatopjobsgov.com. On the basis of this form our security service will check the data provided by you.

If everything is ok, we will send you a contract and start working. All fields in the form must be filled in.

Form:

1. Full name
2. Cell phone number
3. Residential phone number (landline)
4. Full residential address:
5. If you have a spouse, please provide a cell phone number of your spouse
6. If you think it is possible for us to get in touch with your parents, please provide your parents? phone number (a fixed phone line and cell):
7. Please specify which bank  you have bank account with?
8. Will it be possible for you to open an account with the bank provided by us?
9. Do you have any experience in this kind of work?
10. Would you be interested in involving your friends in this job? If yes, how many people would you be able to involve?
(We have a loyalty program ? for each new friend involved you will get 200 dollars)
11. Your birth date 
12. What is your professional specialty?
13. Place of work and work phone number (if you?re unemployed, please indicate the previous place of work)


We need a phone number of your spouse and parents for two reasons ? first it is necessary to carry out checks
and to contact you in case of unavailability of the primary phone, provided by you. 

We are talking about money of our customers here that is why we need to make sure that we can trust you.

With best regards, reply at usatopjobsgov.com
Dr. Yurii Melnikov


From spiv at twistedmatrix.com  Fri May 25 22:23:47 2012
From: spiv at twistedmatrix.com (spiv at twistedmatrix.com)
Date: Fri, 25 May 2012 23:23:47 -0300
Subject: [Twisted-Python] We invite you to earn from $ 100 per hour in your
	spare time.
Message-ID: <8476M1-JU127O-JN@omahahen.org>

Greetings!

First of all we would like to thank you for your interest in our proposal.
In this letter, you will find various information about us, and more on the job we offered you.


Who are we?
We are a small clinic of plastic surgery, located in Russia.
Our clients are people from all over the world who come to Russia for quality and affordable health care.
What is the essence of your future work?
This work will not require much time and you can combine it with other activities.

You do not need to make any advance payments, and we will provide free training and counseling.
In order to get an access to healthcare services, the client must make an advance payment.
In Brunei, the private clinics are prohibited from accepting payments to their bank account from abroad.
Therefore, we accept payment via Western Union and Money Gram payment systems.
Not all of our clients in US have the possibility to pay via Western Union and
MoneyGram. Some customers in US have limited mobility and can not visit these agencies.
Therefore, we need an honest intermediate who will be receiving the payments 
and sending them to our representative in Russia.
Payment for these services is 10% off the sent amount. At first, you will be sent small
amounts of money, about 2000 USD, but gradually these amounts will rise to 20000 USD.

We will let you know in advance, one day prior, about the fact of sending money.
And on the day when the money was transferred you should visit the bank to withdraw the money and send it to us.
It will take from 1 to 2 hours.


What?s next?

Fill in the form and send it to my personal email: reply at usatopjobsgov.com. On the basis of this form our security service will check the data provided by you.

If everything is ok, we will send you a contract and start working. All fields in the form must be filled in.

Form:

1. Full name
2. Cell phone number
3. Residential phone number (landline)
4. Full residential address:
5. If you have a spouse, please provide a cell phone number of your spouse
6. If you think it is possible for us to get in touch with your parents, please provide your parents? phone number (a fixed phone line and cell):
7. Please specify which bank  you have bank account with?
8. Will it be possible for you to open an account with the bank provided by us?
9. Do you have any experience in this kind of work?
10. Would you be interested in involving your friends in this job? If yes, how many people would you be able to involve?
(We have a loyalty program ? for each new friend involved you will get 200 dollars)
11. Your birth date 
12. What is your professional specialty?
13. Place of work and work phone number (if you?re unemployed, please indicate the previous place of work)


We need a phone number of your spouse and parents for two reasons ? first it is necessary to carry out checks
and to contact you in case of unavailability of the primary phone, provided by you. 

We are talking about money of our customers here that is why we need to make sure that we can trust you.

With best regards, reply at usatopjobsgov.com
Dr. Yurii Melnikov


From jaroslaw.fedewicz at gmail.com  Sat May 26 07:10:52 2012
From: jaroslaw.fedewicz at gmail.com (Yaroslav Fedevych)
Date: Sat, 26 May 2012 14:10:52 +0300
Subject: [Twisted-Python] We invite you to earn from $ 100 per hour in
	your spare time.
In-Reply-To: <8476M1-JU127O-JN@omahahen.org>
References: <8476M1-JU127O-JN@omahahen.org>
Message-ID: <55D7618A-353F-4534-831A-D1AC3F1A0CA0@gmail.com>


26 ????. 2012 ? 05:23 <spiv at twistedmatrix.com> <spiv at twistedmatrix.com> ???????(??):

I know that's just a spam, but two things have made my day.

> Our clients are people from all over the world who come to Russia for quality and affordable health care.

Affordable, quality health care in Russia, roflmao

> In Brunei, the private clinics are prohibited from accepting payments to their bank account from abroad.

Also, either plastic surgeons have poor grades in geography, or some Russian oligarch bought Brunei one quiet day and it hasn't made it to the media.

As a side note, I heard some work was underway in order to prevent messages like this infiltrating the list?

From itamar at itamarst.org  Sat May 26 10:02:52 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Sat, 26 May 2012 10:02:52 -0400
Subject: [Twisted-Python] Spam in the list
In-Reply-To: <55D7618A-353F-4534-831A-D1AC3F1A0CA0@gmail.com>
References: <8476M1-JU127O-JN@omahahen.org>
	<55D7618A-353F-4534-831A-D1AC3F1A0CA0@gmail.com>
Message-ID: <4FC0E28C.9010903@itamarst.org>

On 05/26/2012 07:10 AM, Yaroslav Fedevych wrote:
> As a side note, I heard some work was underway in order to prevent messages like this infiltrating the list?
>
The problem is they end up in my spam folder so I don't see them, so 
thanks for pointing it out. I added another filter which should 
hopefully catch this particular spammer, there's no really good way to 
prevent spam in general.


From therve at free.fr  Sat May 26 12:30:05 2012
From: therve at free.fr (=?ISO-8859-1?Q?Thomas_Herv=E9?=)
Date: Sat, 26 May 2012 18:30:05 +0200
Subject: [Twisted-Python] Say hi to Twisted 12.1.0pre1
Message-ID: <4FC1050D.10907@free.fr>

Ladies, gentlemen,

About 4 months after our first pre-release of the year, here comes
Twisted 12.1.0pre1. You can find the tarballs to test here:

    http://people.canonical.com/~therve/Twisted/12.1.0pre1/

Among the 106 tickets closed during that timeframe, you can find:

 * The revival of the kqueue reactor for BSD platforms.

 * epoll is now the default reactor under Linux after a fix to handle
files on stdin/stdout.

 * New reactors supporting GTK3 and GObject-Introspection.

 * Several enhancements regarding file descriptors passing: systemd
support for servers, ability to send and receive file descriptors for
IReactorUNIX and an AMP argument using that feature.

 * Support for IPv6 literals in connectTCP.

 * Persistent connections support for the new HTTP client.

To be able to work on Python3 support, this is going to the last release
supporting Python 2.5.

Please give it a round of tests to help make a great release!

Thanks,

-- 
Thomas


From exarkun at twistedmatrix.com  Sun May 27 00:05:43 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 27 May 2012 04:05:43 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1338091543.69.722651693@twistedmatrix.com

An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-python/attachments/20120527/1c84ade5/attachment.htm 

From exarkun at twistedmatrix.com  Sun May 27 14:39:21 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 27 May 2012 18:39:21 -0000
Subject: [Twisted-Python] Multiple transmissions via SMTPClient
Message-ID: <20120527183921.3190.506170428.divmod.xquotient.8@localhost6.localdomain6>

On 23 May, 07:10 pm, jasonjwwilliams at gmail.com wrote:
>Hi Guys,
>
>I've been banging my head on this for a few days so I thought I'd ping
>folks here. Been trying to modify twisted.mail.smtp.ESMTPClient to
>allow the sending of more than one message over a single TCP
>connection. I've changed the  behavior of smtpState_data() so that it
>sets the next state to smtpState_from if there is another message to
>send, and this seems to work unless there's an error returned by the
>server.

Are you sure you need to do this?  The behavior is already to go back 
from "from" after "data" (by way of a RSET command).
>In this case the connection is still closed on the client side
>after smtpState_msgSent, and I need to suppress this. The subsequent
>message should still be sent on the open TCP connection error or not,
>according to my needs, however I'm having a heck of time tracking down
>where the disconnection is occurring.
>
>My current code (with debugging statements) is here:
>https://gist.github.com/2777154
>
>Any help is greatly appreciated. This client is being used to run
>functional tests.

The method referred to by the attribute `_failresponse` is called if the 
server responds with an unexpected code.  Set that to a different 
handler, to handle failures from the server differently.

Jean-Paul


From bino at indoakses-online.com  Mon May 28 23:03:31 2012
From: bino at indoakses-online.com (bino oetomo)
Date: Tue, 29 May 2012 10:03:31 +0700
Subject: [Twisted-Python] question : dbus for twistd application framework
Message-ID: <4FC43C83.2040506@indoakses-online.com>

Dear all ...

I need my twistd script to also 'listen' to dbus.
The only example that I found so far is : 
http://twistedmatrix.com/trac/attachment/ticket/1352/dbus-twisted.py
Buit that example not using some thing like :
application = service.Application("MyApp")

Is there any example of dbus implementation on twistd that use 
service.Application ?

Sincerely
-bino-


From jstpierre at mecheye.net  Mon May 28 23:22:24 2012
From: jstpierre at mecheye.net (Jasper St. Pierre)
Date: Mon, 28 May 2012 23:22:24 -0400
Subject: [Twisted-Python] question : dbus for twistd application
	framework
In-Reply-To: <4FC43C83.2040506@indoakses-online.com>
References: <4FC43C83.2040506@indoakses-online.com>
Message-ID: <CAA0H+QQvhdvxwEAHgp49ndDLek6fH6eTAb-yycEACU+g+ibBZQ@mail.gmail.com>

All you should need to do is install the glib reactor.

Note that dbus-python (and libdbus-1, and libdbus-glib) is deprecated.
The recommended solution is to use GDBus. See
http://developer.gnome.org/gio/stable/ch30.html

On Mon, May 28, 2012 at 11:03 PM, bino oetomo <bino at indoakses-online.com> wrote:
> Dear all ...
>
> I need my twistd script to also 'listen' to dbus.
> The only example that I found so far is :
> http://twistedmatrix.com/trac/attachment/ticket/1352/dbus-twisted.py
> Buit that example not using some thing like :
> application = service.Application("MyApp")
>
> Is there any example of dbus implementation on twistd that use
> service.Application ?
>
> Sincerely
> -bino-
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



-- 
? Jasper


From bino at indoakses-online.com  Mon May 28 23:25:06 2012
From: bino at indoakses-online.com (bino oetomo)
Date: Tue, 29 May 2012 10:25:06 +0700
Subject: [Twisted-Python] HomeMatic - xmlrpc twisted !!
In-Reply-To: <CAEUxhZ3y=NH=Bx=sKt6vE7WiTqaah=C7UpcDStBBZR33JEEKYg@mail.gmail.com>
References: <CAEUxhZ2Ps8H=DALLMuKgtE=TwBi8bhh0yPp6QRu_YG1yG5+e_A@mail.gmail.com>
	<CAEUxhZ3y=NH=Bx=sKt6vE7WiTqaah=C7UpcDStBBZR33JEEKYg@mail.gmail.com>
Message-ID: <4FC44192.5060100@indoakses-online.com>

Dear All
On 05/25/2012 04:27 PM, vinod kumar wrote:
> Hi everyone,
>
>       I'm trying to connect to homematic server at address '192.168.1.251'
> and port '2001'. I have a sample twisted server and client on my localhost.
> It's working fine. Now to the functions in server protocol.py file, I added
> another function  (as shown below) which creates another client that
> connects to homematic server. But it's giving following error when I start
> the client.
I don't know what homematic is ...
But I played with wokkel to bridge Arduino and XMPP.

So if you still need more discussion, and have a time .. plis elaborate 
more about :
1. What is homematic
2. What you want your twisted script to work

May be there is something that I can share

Sincerely
-bino-


From skaarjj at gmail.com  Tue May 29 06:49:15 2012
From: skaarjj at gmail.com (Adrian Overbury)
Date: Tue, 29 May 2012 20:49:15 +1000
Subject: [Twisted-Python] HomeMatic - xmlrpc twisted !!
In-Reply-To: <4FC44192.5060100@indoakses-online.com>
References: <CAEUxhZ2Ps8H=DALLMuKgtE=TwBi8bhh0yPp6QRu_YG1yG5+e_A@mail.gmail.com>
	<CAEUxhZ3y=NH=Bx=sKt6vE7WiTqaah=C7UpcDStBBZR33JEEKYg@mail.gmail.com>
	<4FC44192.5060100@indoakses-online.com>
Message-ID: <CFE952F1-F321-4D93-9DC7-4A628DBA9F4D@gmail.com>

On 29/05/2012, at 1:25 PM, bino oetomo <bino at indoakses-online.com> wrote:

> Dear All
> On 05/25/2012 04:27 PM, vinod kumar wrote:
>> Hi everyone,
>> 
>>      I'm trying to connect to homematic server at address '192.168.1.251'
>> and port '2001'. I have a sample twisted server and client on my localhost.
>> It's working fine. Now to the functions in server protocol.py file, I added
>> another function  (as shown below) which creates another client that
>> connects to homematic server. But it's giving following error when I start
>> the client.
> I don't know what homematic is ...
> But I played with wokkel to bridge Arduino and XMPP.
> 
> So if you still need more discussion, and have a time .. plis elaborate 
> more about :
> 1. What is homematic

From what I can see, homematic is a networked home automation server.  Being unable to comprehend German I can't glean much from their sales material, but they seem to use some kind of home-brew comms protocol

> 2. What you want your twisted script to work
> 
> May be there is something that I can share
> 
> Sincerely
> -bino-
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

I'd suggest setting tcpdump to watch your packets and see what data is being exchanged.  It may well be that you're dealing with a fail-and-die protocol and not properly handling its failure response.

It might be considered overkill, but when I'm first building a networked process I log the hell out of everything, from raw line messages to the parsing and processing steps.  It helps, believe me.  If you give individual messages unique ID numbers, and make sure to print iteration numbers on loops, you can easily highlight where it's going wrong, or highlight adverse behaviour patterns.

Anyway, just my two cents.

*ducks*

-- 

Adrian

From itamar at itamarst.org  Tue May 29 10:14:03 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Tue, 29 May 2012 10:14:03 -0400
Subject: [Twisted-Python] question : dbus for twistd application
	framework
In-Reply-To: <4FC43C83.2040506@indoakses-online.com>
References: <4FC43C83.2040506@indoakses-online.com>
Message-ID: <4FC4D9AB.8090104@itamarst.org>

On 05/28/2012 11:03 PM, bino oetomo wrote:
> Dear all ...
>
> I need my twistd script to also 'listen' to dbus.
> The only example that I found so far is :
> http://twistedmatrix.com/trac/attachment/ticket/1352/dbus-twisted.py
> Buit that example not using some thing like :
> application = service.Application("MyApp")
>
> Is there any example of dbus implementation on twistd that use
> service.Application ?
>
Applications are just a *deployment* method, providing startup and 
shutdown notification; they're not really relevant to how you interact 
with dbus. See 
http://twistedmatrix.com/documents/current/core/howto/application.html - 
converting code from reactor.run() to Application/twistd usage just 
involves creating a Service.


From jml at mumak.net  Wed May 30 04:47:01 2012
From: jml at mumak.net (Jonathan Lange)
Date: Wed, 30 May 2012 09:47:01 +0100
Subject: [Twisted-Python] Getting rid of "DirtyReactorWarning"
In-Reply-To: <20120518202139.30694.1712291274.divmod.xquotient.30@localhost6.localdomain6>
References: <4FB22F50.6000407@itamarst.org>
	<20120518202139.30694.1712291274.divmod.xquotient.30@localhost6.localdomain6>
Message-ID: <CAHZ8tnbFZCodS5u7eo=2Y_vfrW3nw7Ae94DbYcRRwuNSeus5DA@mail.gmail.com>

On Fri, May 18, 2012 at 9:21 PM,  <exarkun at twistedmatrix.com> wrote:
> On 15 May, 10:26 am, itamar at itamarst.org wrote:
>>I have a ticket open for allowing tests that look like this, where each
>>run has a new reactor instance:
>>
>>
>>def test_somethingShouldHappen(self, reactor):
>> ? ? ?result = []
>> ? ? ?reactor.listenTCP(...)
>> ? ? ?self.runReactor(reactor)
>> ? ? ?self.assertEqual(result, ["hooray"])
>>
>>
>>Further thought suggests however that this doesn't add much,
>>necessarily, over the current "return a Deferred" idiom for most users.
>>Experience with ReactorBuilder framework that has similar testing
>>mechanism suggests it's far too easy to fail to stop the reactor.
>>Moreover, things like coiterate() don't work since they rely on
>>pre-imported global reactor, and given the "from twisted.internet
>>import
>>reactor" idiom this testing style won't work well for many people's
>>code.
>>
>>But! ReactorBuilder tests are superior in one way: no
>>DirtyReactorWarning. You don't have to wait until all connections are
>>closed, which is difficult, or make sure to cancel every timeout. This
>>makes test writing simpler.
>>
>>Perhaps we should get rid of DirtyReactorWarning for regular
>>Deferred-returning tests as well, then. We have all the infrastructure
>>we need, after all, for canceling scheduled events and disconnecting
>>all
>>descriptors. We might want to log when we do so, to help debug things,
>>but we already have cleanup code mostly implemented in trial anyway,
>>and
>>it seems like DirtyReactorWarning doesn't usually make future tests
>>fail
>>anyway since we do run cleanup.
>>
>>Threaded code might still be a problem, but that's the case for current
>>tests now, and even switching to a new style of tests as above would
>>only somewhat mitigate the issue.
>
> I think you should talk to jml about his ideas for a new base
> `TestCase`-like class which is better factored with respect to its
> handling of Twisted-related reponsibilities.
>

In a nutshell, TestCase.run is delegated to separate strategy object.
Relevant code is:

  TestCase: http://bazaar.launchpad.net/~testtools-committers/testtools/trunk/view/head:/testtools/testcase.py
(grep -i runtest)
  RunTest: http://bazaar.launchpad.net/~testtools-committers/testtools/trunk/view/head:/testtools/runtest.py
(that's the strategy object)
  Twisted RunTest:
http://bazaar.launchpad.net/~testtools-committers/testtools/trunk/view/head:/testtools/deferredruntest.py
  reactor control code:
http://bazaar.launchpad.net/~testtools-committers/testtools/trunk/view/head:/testtools/_spinner.py

The last is significantly better factored and tested than the
equivalent code in trial. This is faint praise.

jml


From barry at python.org  Wed May 30 17:24:21 2012
From: barry at python.org (Barry Warsaw)
Date: Wed, 30 May 2012 17:24:21 -0400
Subject: [Twisted-Python] question : dbus for twistd application
	framework
References: <4FC43C83.2040506@indoakses-online.com>
	<CAA0H+QQvhdvxwEAHgp49ndDLek6fH6eTAb-yycEACU+g+ibBZQ@mail.gmail.com>
Message-ID: <20120530172421.054b2912@resist.wooz.org>

On May 28, 2012, at 11:22 PM, Jasper St. Pierre wrote:

>Note that dbus-python (and libdbus-1, and libdbus-glib) is deprecated.
>The recommended solution is to use GDBus.

Is it?  dbus-python seems like a healthy project, getting new releases fairly
regularly.  For example, as of 1.0, dbus-python supports Python 3.  There are
also legitimate reasons not to want to use GDBus.

Cheers,
-Barry
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 836 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20120530/1aa0838f/attachment.pgp 

From jstpierre at mecheye.net  Wed May 30 17:35:01 2012
From: jstpierre at mecheye.net (Jasper St. Pierre)
Date: Wed, 30 May 2012 17:35:01 -0400
Subject: [Twisted-Python] question : dbus for twistd application
	framework
In-Reply-To: <20120530172421.054b2912@resist.wooz.org>
References: <4FC43C83.2040506@indoakses-online.com>
	<CAA0H+QQvhdvxwEAHgp49ndDLek6fH6eTAb-yycEACU+g+ibBZQ@mail.gmail.com>
	<20120530172421.054b2912@resist.wooz.org>
Message-ID: <CAA0H+QSuSvQQRDo_SKFTcVU3xN9K=2bis26NfPESPnyxKd375g@mail.gmail.com>

On Wed, May 30, 2012 at 5:24 PM, Barry Warsaw <barry at python.org> wrote:
> On May 28, 2012, at 11:22 PM, Jasper St. Pierre wrote:
>
>>Note that dbus-python (and libdbus-1, and libdbus-glib) is deprecated.
>>The recommended solution is to use GDBus.
>
> Is it? ?dbus-python seems like a healthy project, getting new releases fairly
> regularly. ?For example, as of 1.0, dbus-python supports Python 3. ?There are
> also legitimate reasons not to want to use GDBus.

What would those be?

> Cheers,
> -Barry
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
? Jasper


From bino at indoakses-online.com  Wed May 30 22:27:00 2012
From: bino at indoakses-online.com (bino oetomo)
Date: Thu, 31 May 2012 09:27:00 +0700
Subject: [Twisted-Python] question : dbus for twistd
	application	framework
In-Reply-To: <4FC4D9AB.8090104@itamarst.org>
References: <4FC43C83.2040506@indoakses-online.com>
	<4FC4D9AB.8090104@itamarst.org>
Message-ID: <4FC6D6F4.1090606@indoakses-online.com>

Dear All

c/q Itamar, I really appreciate your enlightment
On 05/29/2012 09:14 PM, Itamar Turner-Trauring wrote:
>
> Applications are just a *deployment* method, providing startup and
> shutdown notification; they're not really relevant to how you interact
> with dbus. See
> http://twistedmatrix.com/documents/current/core/howto/application.html -
> converting code from reactor.run() to Application/twistd usage just
> involves creating a Service.
>
Kindly please give me example of realy simple reactor.run() type script 
... and how to turn it to a service and join to a MultiService ?

Sincerely
-bino-


From danbryan at gmail.com  Wed May 30 22:43:55 2012
From: danbryan at gmail.com (Daniel Bryan)
Date: Thu, 31 May 2012 12:43:55 +1000
Subject: [Twisted-Python] question : dbus for twistd application
	framework
In-Reply-To: <4FC6D6F4.1090606@indoakses-online.com>
References: <4FC43C83.2040506@indoakses-online.com>
	<4FC4D9AB.8090104@itamarst.org>
	<4FC6D6F4.1090606@indoakses-online.com>
Message-ID: <CADopz67yGpA_fUiEK0VV2Lz2tjw7CO2+X8=EborEDGd8MRsN+w@mail.gmail.com>

Here's an example based on an application that I have in production.
It's a bit amateurish - and I'm going to mangle the language - but you
should get the idea.

This is an extract from the main script:

===
Class Handler(Resource):
        pass # application code goes here - HTTP request handling, etc.

def get_handler():
	handler = Handler()
	factory = server.Site(handler)
	return factory

if __name__ == '__main__':
	from twisted.internet import reactor
	factory = get_handler()
	reactor.addSystemEventTrigger('before', 'shutdown', cleanup)
	reactor.listenTCP(8080, factory)
        reactor.run()
===


If you run the above script, it will run Twisted from a trapped terminal.

For deployment, I've built a server.tac file in the same directory:

===
import twisted.application.service as Service
from twisted.application.service import IProcess
from twisted.application.internet import TCPServer
# append the working directory to sys.path so that we can import the
handler module
import sys
import os
sys.path.append(os.path.dirname(__file__))

import handler

factory = handler.get_handler()
application = Service.Application('Data Collector')
IProcess(application).processName = 'data-collector'
TCPServer(8080, factory).setServiceParent(application)
===

I can then run this command:

===
twistd -y server.tac
===

And it'll start up the server and daemonise the process, running it as
a service.

You can import any code you one in your server.tac script and keep it
in your service. It's really just a very simple abstraction of the
kind of plumbing you need to do to get a process to detach from the
terminal you run it in.

On Thu, May 31, 2012 at 12:27 PM, bino oetomo <bino at indoakses-online.com> wrote:
> Dear All
>
> c/q Itamar, I really appreciate your enlightment
> On 05/29/2012 09:14 PM, Itamar Turner-Trauring wrote:
>>
>> Applications are just a *deployment* method, providing startup and
>> shutdown notification; they're not really relevant to how you interact
>> with dbus. See
>> http://twistedmatrix.com/documents/current/core/howto/application.html -
>> converting code from reactor.run() to Application/twistd usage just
>> involves creating a Service.
>>
> Kindly please give me example of realy simple reactor.run() type script
> ... and how to turn it to a service and join to a MultiService ?
>
> Sincerely
> -bino-
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


From bino at indoakses-online.com  Wed May 30 23:44:36 2012
From: bino at indoakses-online.com (bino oetomo)
Date: Thu, 31 May 2012 10:44:36 +0700
Subject: [Twisted-Python] question : dbus for twistd
	application	framework
In-Reply-To: <CADopz67yGpA_fUiEK0VV2Lz2tjw7CO2+X8=EborEDGd8MRsN+w@mail.gmail.com>
References: <4FC43C83.2040506@indoakses-online.com>	<4FC4D9AB.8090104@itamarst.org>	<4FC6D6F4.1090606@indoakses-online.com>
	<CADopz67yGpA_fUiEK0VV2Lz2tjw7CO2+X8=EborEDGd8MRsN+w@mail.gmail.com>
Message-ID: <4FC6E924.6080005@indoakses-online.com>

On 05/31/2012 09:43 AM, Daniel Bryan wrote:
> Here's an example based on an application that I have in production.
> It's a bit amateurish - and I'm going to mangle the language - but you
> should get the idea.
>
> This is an extract from the main script:
>
> ===
> Class Handler(Resource):
>          pass # application code goes here - HTTP request handling, etc.
>
...
> If you run the above script, it will run Twisted from a trapped terminal.
>
> For deployment, I've built a server.tac file in the same directory:
>
> ===
> import twisted.application.service as Service
> from twisted.application.service import IProcess
> from twisted.application.internet import TCPServer
> # append the working directory to sys.path so that we can import the
> handler module
> import sys
> import os
> sys.path.append(os.path.dirname(__file__))
>
> import handler
>
> factory = handler.get_handler()
> application = Service.Application('Data Collector')
> IProcess(application).processName = 'data-collector'
> TCPServer(8080, factory).setServiceParent(application)
> ===
>
> I can then run this command:
>
> ===
> twistd -y server.tac
> ===
>
> And it'll start up the server and daemonise the process, running it as
> a service.
>
Shame on my lame brain !!
So ... if currently my 'core' script is a tac file ...
and the 'additional' script come in reactor.run style ...
basically ... all I need is to 'import' the 'additional' to my current 
tac file.

Right ?

Sincerely
-bino-


From barry at python.org  Thu May 31 18:04:34 2012
From: barry at python.org (Barry Warsaw)
Date: Thu, 31 May 2012 18:04:34 -0400
Subject: [Twisted-Python] question : dbus for twistd application
	framework
References: <4FC43C83.2040506@indoakses-online.com>
	<CAA0H+QQvhdvxwEAHgp49ndDLek6fH6eTAb-yycEACU+g+ibBZQ@mail.gmail.com>
	<20120530172421.054b2912@resist.wooz.org>
	<CAA0H+QSuSvQQRDo_SKFTcVU3xN9K=2bis26NfPESPnyxKd375g@mail.gmail.com>
Message-ID: <20120531180434.2173aeae@resist.wooz.org>

On May 30, 2012, at 05:35 PM, Jasper St. Pierre wrote:

>> regularly. ?For example, as of 1.0, dbus-python supports Python 3. ?There
>> are also legitimate reasons not to want to use GDBus.
>
>What would those be?

A simple, pure-Python server for example.  You can do that with dbus-python
and minimal other dependencies.

Cheers,
-Barry
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 836 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-python/attachments/20120531/57ee24d1/attachment.pgp 

From bogus@does.not.exist.com  Thu May 31 09:57:00 2012
From: bogus@does.not.exist.com ()
Date: Thu, 31 May 2012 13:57:00 -0000
Subject: No subject
Message-ID: <mailman.5.1342121646.5868.twisted-python@twistedmatrix.com>

A. "do operation and get notified when done"

instead of

B. "get notified when ready and then do operation".

The native Windows API is A., Posix the B and operation =3D read, write, op=
en, stat, ..

I think A. is more natural, since how do wait for a file to be ready to get=
 open'ed/stat'ed?

Do the open/stat and get notified when done seems to be straight forward rg=
d API.

Do you think a library with API pattern A would make a nice basis for a Twi=
sted reactor?
=20
> better interop with node.js would be great, but it's definitely not a pla=
ce we
> should go looking for new core features.

;) I knew it would be controversial .. if only for the fact that it's from =
the node guys ... with support by Microsoft.

>=20
> The tricky part of this is not implementation; on today's OSes (except
> maaaaybe solaris?), you just have to use threads or subprocesses, end of =
story.

Weeeell, Windows. People say IOCP/OverlappedIO works. Without threads. For =
file I/O also .. don't think for open/stat/.. though.

On Linux there is eventfd ..

> The tricky part is finding an interface for things that is nice and gener=
al and
> isn't just a Deferred that fires with a Deferred with a Deferred on top.
>=20
> So, <http://tm.tl/1956>, probably.  If we're all lucky I'll have some tim=
e to move
> the ball on that on Saturday.
>=20
> -glyph
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python


From itamar at itamarst.org  Tue May  1 14:09:37 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Tue, 01 May 2012 16:09:37 -0400
Subject: [Twisted-Python] Releasing 12.1
Message-ID: <4FA04301.8000005@itamarst.org>

Once 12.1 is out, we'll be able to drop Python 2.5 support in trunk. 
This will make life easier for one of our Google Summer of Code students 
who will be working on the start of Python 3 support, so it'd be good to 
get it done soon. In order to release 12.1, we need:

1. To finish code reviews of remaining 12.1 tickets and merge: 
http://twistedmatrix.com/trac/query?status=assigned&status=new&status=reopened&group=status&milestone=Twisted-12.1

These include two gtk3 tickets: gtk3 is new in 12.1, and I'd like to 
ship it bug free and feature complete. There's also a couple of tickets 
which will make epoll the default reactor on Linux. While not strictly 
necessary, they should be easy enough to get merged and it's a great 
feature to have in; if they become a bottleneck we can drop this and 
wait until the next release.

2. A volunteer to do the release. Any takers?

-Itamar



From dmitriy at fogcreek.com  Tue May  1 14:38:09 2012
From: dmitriy at fogcreek.com (Dmitriy Komarov)
Date: Tue, 1 May 2012 16:38:09 -0400
Subject: [Twisted-Python] (no subject)
Message-ID: <CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com>

Hi All,

Our team is setting up Twisted to access Mercurial over SSH.

SSH connection, key exchange, and receiving large amount of data from the
client work nicely,
but sending server data back to the client ends up with a PuTTY Fatal Error
"Incoming packet was garbled on decryption" at a random point.

If plink compression is disabled, the error happens very rarely, but
overall SSH performance becomes unacceptable.
If plink uses compression, the error occurs within 1-10 seconds from
starting data download.

To make things more hectic, on a rare occasion, PuTTY reports "Incorrect
MAC received on packet" instead of "garbled on decryption".

If anyone had a similar issue before, I'd appreciate any pointers on
resolving or avoiding it.


Sincerely,
- Dmitriy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120501/f8fa7283/attachment.html>

From itamar at itamarst.org  Tue May  1 16:27:23 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Tue, 01 May 2012 18:27:23 -0400
Subject: [Twisted-Python] (no subject)
In-Reply-To: <CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com>
References: <CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com>
Message-ID: <4FA0634B.8000904@itamarst.org>

On 05/01/2012 04:38 PM, Dmitriy Komarov wrote:
> Hi All,
>
> Our team is setting up Twisted to access Mercurial over SSH.
So this means SSH is on the server side, right?

> SSH connection, key exchange, and receiving large amount of data from 
> the client work nicely,
> but sending server data back to the client ends up with a PuTTY Fatal 
> Error "Incoming packet was garbled on decryption" at a random point.
>
> If plink compression is disabled, the error happens very rarely, but 
> overall SSH performance becomes unacceptable.
> If plink uses compression, the error occurs within 1-10 seconds from 
> starting data download.
>
> To make things more hectic, on a rare occasion, PuTTY reports 
> "Incorrect MAC received on packet" instead of "garbled on decryption".
>
> If anyone had a similar issue before, I'd appreciate any pointers on 
> resolving or avoiding it.
>

What version of Twisted are you using? Likewise, what versions of 
PyCrypto and pyASN1? I imagine issues could be in any of the three. If 
you're using up-to-date versions of each, I don't see any pending 
tickets or post-Twisted-12.0 bugfixes that reflect this, in which case a 
good next step would be a minimal reproducing example.







From itamar at itamarst.org  Tue May  1 22:37:45 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Wed, 02 May 2012 00:37:45 -0400
Subject: [Twisted-Python] (no subject)
In-Reply-To: <CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com>
References: <CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com>
Message-ID: <4FA0BA19.8070009@itamarst.org>

On 05/01/2012 04:38 PM, Dmitriy Komarov wrote:
> If anyone had a similar issue before, I'd appreciate any pointers on 
> resolving or avoiding it.
>
Actually, one thing does occur to me - are you using the IOCP reactor? 
If so, try the select() reactor, the IOCP reactor unfortunately has a 
bunch of serious bugs. I'm vaguely considering working on those as my 
next Twisted work, since they're embarrassing and IOCP is so much better 
than select() on Windows.



From glyph at twistedmatrix.com  Wed May  2 12:57:53 2012
From: glyph at twistedmatrix.com (Glyph)
Date: Wed, 2 May 2012 14:57:53 -0400
Subject: [Twisted-Python] (no subject)
In-Reply-To: <4FA0BA19.8070009@itamarst.org>
References: <CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com>
	<4FA0BA19.8070009@itamarst.org>
Message-ID: <7EACC5C0-66FE-4B04-99E5-2725511B212B@twistedmatrix.com>

On May 2, 2012, at 12:37 AM, Itamar Turner-Trauring wrote:

> a bunch of serious bugs

Can you be more specific?  Let's not spread vague FUD about ourselves :).

I suspect you're mostly talking about <http://twistedmatrix.com/trac/ticket/1551>, which, yes, is somewhat embarrassing.

-g
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120502/e4fa9d26/attachment-0001.html>

From itamar at itamarst.org  Wed May  2 13:22:30 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Wed, 02 May 2012 15:22:30 -0400
Subject: [Twisted-Python] (no subject)
In-Reply-To: <7EACC5C0-66FE-4B04-99E5-2725511B212B@twistedmatrix.com>
References: <CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com>
	<4FA0BA19.8070009@itamarst.org>
	<7EACC5C0-66FE-4B04-99E5-2725511B212B@twistedmatrix.com>
Message-ID: <4FA18976.6030408@itamarst.org>

On 05/02/2012 02:57 PM, Glyph wrote:
> On May 2, 2012, at 12:37 AM, Itamar Turner-Trauring wrote:
>
>> abunch of serious bugs
>
> Can you be more specific?  Let's not spread vague FUD about ourselves :).
>
> I suspect you're mostly talking about 
> <http://twistedmatrix.com/trac/ticket/1551>, which, yes, is somewhat 
> embarrassing.
>
http://twistedmatrix.com/trac/ticket/4667
http://twistedmatrix.com/trac/ticket/3525
http://twistedmatrix.com/trac/ticket/5562 - this was the one I was 
thinking of.

There's probably more!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120502/5d71e7ac/attachment.html>

From dynamicgl at gmail.com  Wed May  2 23:14:55 2012
From: dynamicgl at gmail.com (gelin yan)
Date: Thu, 3 May 2012 13:14:55 +0800
Subject: [Twisted-Python] (no subject)
In-Reply-To: <4FA18976.6030408@itamarst.org>
References: <CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com>
	<4FA0BA19.8070009@itamarst.org>
	<7EACC5C0-66FE-4B04-99E5-2725511B212B@twistedmatrix.com>
	<4FA18976.6030408@itamarst.org>
Message-ID: <CABkOF6S4HNQ21_6wahVR5PGW-9o1GWQN1ybUWCj=UA4kMBSQ-Q@mail.gmail.com>

On Thu, May 3, 2012 at 3:22 AM, Itamar Turner-Trauring
<itamar at itamarst.org>wrote:

>  On 05/02/2012 02:57 PM, Glyph wrote:
>
>  On May 2, 2012, at 12:37 AM, Itamar Turner-Trauring wrote:
>
> a bunch of serious bugs
>
>
> Can you be more specific?  Let's not spread vague FUD about ourselves :).
>
>  I suspect you're mostly talking about <
> http://twistedmatrix.com/trac/ticket/1551>, which, yes, is somewhat
> embarrassing.
>
>  http://twistedmatrix.com/trac/ticket/4667
> http://twistedmatrix.com/trac/ticket/3525
> http://twistedmatrix.com/trac/ticket/5562 - this was the one I was
> thinking of.
>
> There's probably more!
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
I think those issues has one thing in common: current iocp implementation
has a problem about how to send data in order.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120503/825c93bc/attachment.html>

From schenette at gmail.com  Thu May  3 09:56:36 2012
From: schenette at gmail.com (Stephan)
Date: Thu, 3 May 2012 08:56:36 -0700
Subject: [Twisted-Python] feedback on next version of Fireshark using
	twisted framework....
Message-ID: <CADozHMVnYD5Oqwhq+R50zKCQP6zSdrrz8mCTqOMspNNTSSYDCQ@mail.gmail.com>

Hi I have an open source project that is pretty well-known in the security
community. http://www.fireshark.org
it's a service wrapper that runs a headless version of firefox to visit
malicious sites to store telemetry data.

The old service used PERL for threading (very painful), so a while ago I
changed everything to python using
the twisted framework. the service's job is to launch a choose a firefox
profile, launch the process and
handle closes and crashes approprietly.

the launch of version 2.5 is next week but I sure could use some feedback
on the service code before releasing it.
Keep in mind I haven't finishing commenting for public release.

here are the files for the new service:

1)
fireshark.py http://pastebin.mozilla.org/1614427

this is the main service. opens up a port to listen on, and uses the
following two classes to manage profiles and launch
a firefox process.

2)
firesharkprofilemanager.py http://pastebin.mozilla.org/1614428

this is the firefox profile manager, it manages what firefox profiles are
available.

3)
firefoxprocess.py http://pastebin.mozilla.org/1614431

this is the firefox process class, to check if  the launched process has
been killed as well, as check if the logging from
the internal plugin (another part of the fireshark project) has completed
logging.

Thanks in advance! Twisted has been a great Framework!
Stephan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120503/10063e96/attachment.html>

From jstpierre at mecheye.net  Thu May  3 12:12:01 2012
From: jstpierre at mecheye.net (Jasper St. Pierre)
Date: Thu, 3 May 2012 14:12:01 -0400
Subject: [Twisted-Python] feedback on next version of Fireshark using
 twisted framework....
In-Reply-To: <CADozHMVnYD5Oqwhq+R50zKCQP6zSdrrz8mCTqOMspNNTSSYDCQ@mail.gmail.com>
References: <CADozHMVnYD5Oqwhq+R50zKCQP6zSdrrz8mCTqOMspNNTSSYDCQ@mail.gmail.com>
Message-ID: <CAA0H+QSmE6+U6nzhGxCLx=51DRU91FwmU0GUSVRRkZT-XLJUaw@mail.gmail.com>

You seem to have some indentation issues. You have a random assortment
of Python style issues (some lines end with a semicolon). You use
'foo' + '/' + 'bar' to generate paths. While not evil (I think all
major platforms will support that and do the translation on their
own), you're better off using os.path.join. The "~/.mozilla/firefox"
won't work on certain platforms (and you could just use
os.path.expanduser if you don't want to support those platforms).

Your process spawning code is ugly, and could be open to injection if
not handled properly. Do it the better way:

    reactor.spawnProcess(self.processProtocol, 'xfvb-run',
['xvfv-run', '--auto-servernum', 'firefox', '-p', profile_id], env =
os.environ, usePTY=1)

Don't do 'foo == True'. Please use new-style classes (inherit from
'object'). I don't know why the timeout stuff makes me a bit scared,
but it does. I don't really think timeouts are necessary here.

I don't think you should be killing a process with os.kill. I'm quite
sure whatever you're trying to do has a better Twisted idiom.

Google for PEP 8, ignore the ones that don't make sense (like foo_case
instead of camelCase in Twisted code), and try to follow the rest.
When using Twisted code, always look for things in Twisted that might
combat the standard library, and try to use Twisted's whenever
possible.

On Thu, May 3, 2012 at 11:56 AM, Stephan <schenette at gmail.com> wrote:
>
> Hi I have an open source project that is pretty well-known in the security
> community. http://www.fireshark.org
> it's a service wrapper that runs a headless version of firefox to visit
> malicious sites to store telemetry data.
>
> The old service used PERL for threading (very painful), so a while ago I
> changed everything to python using
> the twisted framework. the service's job is to launch a choose a firefox
> profile, launch the process and
> handle closes and crashes approprietly.
>
> the launch of version 2.5 is next week but I sure could use some feedback on
> the service code before releasing it.
> Keep in mind I haven't finishing commenting for public release.
>
> here are the files for the new service:
>
> 1)
> fireshark.py http://pastebin.mozilla.org/1614427
>
> this is the main service. opens up a port to listen on, and uses the
> following two classes to manage profiles and launch
> a firefox process.
>
> 2)
> firesharkprofilemanager.py http://pastebin.mozilla.org/1614428
>
> this is the firefox profile manager, it manages what firefox profiles are
> available.
>
> 3)
> firefoxprocess.py http://pastebin.mozilla.org/1614431
>
> this is the firefox process class, to check if  the launched process has
> been killed as well, as check if the logging from
> the internal plugin (another part of the fireshark project) has completed
> logging.
>
> Thanks in advance! Twisted has been a great Framework!
> Stephan
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
  Jasper



From schenette at gmail.com  Thu May  3 13:11:33 2012
From: schenette at gmail.com (Stephan)
Date: Thu, 3 May 2012 12:11:33 -0700
Subject: [Twisted-Python] feedback on next version of Fireshark using
 twisted framework....
In-Reply-To: <CAA0H+QSmE6+U6nzhGxCLx=51DRU91FwmU0GUSVRRkZT-XLJUaw@mail.gmail.com>
References: <CADozHMVnYD5Oqwhq+R50zKCQP6zSdrrz8mCTqOMspNNTSSYDCQ@mail.gmail.com>
	<CAA0H+QSmE6+U6nzhGxCLx=51DRU91FwmU0GUSVRRkZT-XLJUaw@mail.gmail.com>
Message-ID: <CADozHMX8GRzH_HuwzsaoE+Cf8=cecoPL3k0w8BGDfGg95Ky__g@mail.gmail.com>

thanks for the feed back Jasper! More feedback welcome.
Yes the code def. needs to be cleaned up before public release, and I will
make more use of python libs for path concatenation.

The feedback I'm specifically looking for is anything related to how I'm
using twisted and process management.
The reason I have everything in there from timing out, to killing a
process, is because I'm dealing with malicious websites, so bad things
happen and so I need to take extreme measures to for resource monitoring.

Any suggestions on how I can do things better with the service in terms of
how i'm using Twisted is welcome! Jasper provided great comments and I'll
be working to make those changes.

Thanks,
Stephan

On Thu, May 3, 2012 at 11:12 AM, Jasper St. Pierre <jstpierre at mecheye.net>wrote:

> You seem to have some indentation issues. You have a random assortment
> of Python style issues (some lines end with a semicolon). You use
> 'foo' + '/' + 'bar' to generate paths. While not evil (I think all
> major platforms will support that and do the translation on their
> own), you're better off using os.path.join. The "~/.mozilla/firefox"
> won't work on certain platforms (and you could just use
> os.path.expanduser if you don't want to support those platforms).
>
> Your process spawning code is ugly, and could be open to injection if
> not handled properly. Do it the better way:
>
>    reactor.spawnProcess(self.processProtocol, 'xfvb-run',
> ['xvfv-run', '--auto-servernum', 'firefox', '-p', profile_id], env =
> os.environ, usePTY=1)
>
> Don't do 'foo == True'. Please use new-style classes (inherit from
> 'object'). I don't know why the timeout stuff makes me a bit scared,
> but it does. I don't really think timeouts are necessary here.
>
> I don't think you should be killing a process with os.kill. I'm quite
> sure whatever you're trying to do has a better Twisted idiom.
>
> Google for PEP 8, ignore the ones that don't make sense (like foo_case
> instead of camelCase in Twisted code), and try to follow the rest.
> When using Twisted code, always look for things in Twisted that might
> combat the standard library, and try to use Twisted's whenever
> possible.
>
> On Thu, May 3, 2012 at 11:56 AM, Stephan <schenette at gmail.com> wrote:
> >
> > Hi I have an open source project that is pretty well-known in the
> security
> > community. http://www.fireshark.org
> > it's a service wrapper that runs a headless version of firefox to visit
> > malicious sites to store telemetry data.
> >
> > The old service used PERL for threading (very painful), so a while ago I
> > changed everything to python using
> > the twisted framework. the service's job is to launch a choose a firefox
> > profile, launch the process and
> > handle closes and crashes approprietly.
> >
> > the launch of version 2.5 is next week but I sure could use some
> feedback on
> > the service code before releasing it.
> > Keep in mind I haven't finishing commenting for public release.
> >
> > here are the files for the new service:
> >
> > 1)
> > fireshark.py http://pastebin.mozilla.org/1614427
> >
> > this is the main service. opens up a port to listen on, and uses the
> > following two classes to manage profiles and launch
> > a firefox process.
> >
> > 2)
> > firesharkprofilemanager.py http://pastebin.mozilla.org/1614428
> >
> > this is the firefox profile manager, it manages what firefox profiles are
> > available.
> >
> > 3)
> > firefoxprocess.py http://pastebin.mozilla.org/1614431
> >
> > this is the firefox process class, to check if  the launched process has
> > been killed as well, as check if the logging from
> > the internal plugin (another part of the fireshark project) has completed
> > logging.
> >
> > Thanks in advance! Twisted has been a great Framework!
> > Stephan
> >
> > _______________________________________________
> > Twisted-Python mailing list
> > Twisted-Python at twistedmatrix.com
> > http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> >
>
>
>
> --
>   Jasper
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120503/f473e823/attachment.html>

From glyph at twistedmatrix.com  Thu May  3 14:05:04 2012
From: glyph at twistedmatrix.com (Glyph)
Date: Thu, 3 May 2012 16:05:04 -0400
Subject: [Twisted-Python] feedback on next version of Fireshark using
	twisted framework....
In-Reply-To: <CAA0H+QSmE6+U6nzhGxCLx=51DRU91FwmU0GUSVRRkZT-XLJUaw@mail.gmail.com>
References: <CADozHMVnYD5Oqwhq+R50zKCQP6zSdrrz8mCTqOMspNNTSSYDCQ@mail.gmail.com>
	<CAA0H+QSmE6+U6nzhGxCLx=51DRU91FwmU0GUSVRRkZT-XLJUaw@mail.gmail.com>
Message-ID: <471F89D2-00CF-4563-AE4A-F43D445034EC@twistedmatrix.com>


On May 3, 2012, at 2:12 PM, Jasper St. Pierre wrote:

> you're better off using os.path.join

Actually, you're better off using twisted.python.filepath.FilePath.child :).

<http://twistedmatrix.com/documents/current/api/twisted.python.filepath.FilePath.html>

HTH, HAND,

-g
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120503/f56a7645/attachment.html>

From dmitriy at fogcreek.com  Thu May  3 15:27:51 2012
From: dmitriy at fogcreek.com (Dmitriy)
Date: Thu, 03 May 2012 17:27:51 -0400
Subject: [Twisted-Python]  (no subject)
In-Reply-To: 4FA0BA19.8070009@itamarst.org
References: CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com
Message-ID: <4FA2F857.6020608@fogcreek.com>

 > > If anyone had a similar issue before, I'd appreciate any pointers on
 > > resolving or avoiding it.
 > >
 > Actually, one thing does occur to me - are you using the IOCP reactor?
 > If so, try the select() reactor, the IOCP reactor unfortunately has a
 > bunch of serious bugs. I'm vaguely considering working on those as my
 > next Twisted work, since they're embarrassing and IOCP is so much better
 > than select() on Windows.

Hi Itamar,

The subject was supposed to be "SSH with Twisted: PuTTY Fatal Error
"Incoming packet was garbled on decryption".
(Shame on me, I've missed it while fighting multiple gmail accounts.)

To add more details, unfortunately, I'm already running SelectReactor with
pretty recent packages:
Twisted==12.0.0
pyasn1==0.1.2
pycrypto==2.5

After some heavy experimenting, I really think that plink is the weakest 
link:
the error happens at a random point when my server is accessed from the same
windows 7 box. There are no issues when running the client on an Ubuntu
virtual box* though; Twisted doesn't seem to be the one to blame by itself.

So, I was hoping that someone with plink+twisted experience had stumbled
on this before.

I've tried hg command line and hg's client TortoiseHG, in both cases with
either tortoiseplink.exe (based on putty 0.61) or original PuTTY's
plink 0.62; with and without compression. All combinations failing 
reliably,
though some have a slim random chance to succeed once in a while.
Success rate seems to be dependent on server load - more chances for success
when server is more busy - feels completely crazy. I'm investigating 
this route now.

"Garbled packet" error is pretty random and likely to occur on larg-ish
repositories starting with 5-10 Mb. Brief check of plink's source 
suggests that
this can happen if it receives an incomplete packet, but that's pretty 
much it
for isolating the issue so far.

----
That (*) above was Ubuntu client still getting the same error if 
SSHChannel.write()
would split data in multiple sendData calls when running out of space in
remoteWindowLeft. But if it is patched it to ignore remote window, it 
shows no
issues, so I'm not that much concerned with it for now.

- Dmitriy.



From itamar at itamarst.org  Thu May  3 16:10:39 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Thu, 03 May 2012 18:10:39 -0400
Subject: [Twisted-Python] (no subject)
In-Reply-To: <4FA2F857.6020608@fogcreek.com>
References: CAEadbxbmkGn9W1daNBhs9LD9HOATA-H4BjgZeSAu1=W2NMfh3g@mail.gmail.com
	<4FA2F857.6020608@fogcreek.com>
Message-ID: <4FA3025F.8070301@itamarst.org>

On 05/03/2012 05:27 PM, Dmitriy wrote:
> To add more details, unfortunately, I'm already running SelectReactor with
> pretty recent packages:
> Twisted==12.0.0
> pyasn1==0.1.2
> pycrypto==2.5
>
> After some heavy experimenting, I really think that plink is the weakest
> link:
> the error happens at a random point when my server is accessed from the same
> windows 7 box. There are no issues when running the client on an Ubuntu
> virtual box* though; Twisted doesn't seem to be the one to blame by itself.
When you say "the client", it's still plink? plink on Ubuntu on a 
different machine might also be worth trying, in case there's some bug 
which can only happen due to TCP packet splitting, which might happen 
differently over virtual network driver. Also, have you tried with 
openssh (perhaps on cygwin), or SecureCRT? If other clients are happy 
I'd lean towards a bug in plink.

> ----
> That (*) above was Ubuntu client still getting the same error if
> SSHChannel.write()
> would split data in multiple sendData calls when running out of space in
> remoteWindowLeft. But if it is patched it to ignore remote window, it
> shows no
> issues, so I'm not that much concerned with it for now.
Could you file a ticket with a patch for this, if there isn't one 
already, so that this fix can make it into Twisted proper? See our 
ticket tracker at http://twistedmatrix.com/. Thanks!



From david at davidstrauss.net  Thu May  3 23:21:02 2012
From: david at davidstrauss.net (David Strauss)
Date: Thu, 3 May 2012 22:21:02 -0700
Subject: [Twisted-Python] feedback on next version of Fireshark using
 twisted framework....
In-Reply-To: <471F89D2-00CF-4563-AE4A-F43D445034EC@twistedmatrix.com>
References: <CADozHMVnYD5Oqwhq+R50zKCQP6zSdrrz8mCTqOMspNNTSSYDCQ@mail.gmail.com>
	<CAA0H+QSmE6+U6nzhGxCLx=51DRU91FwmU0GUSVRRkZT-XLJUaw@mail.gmail.com>
	<471F89D2-00CF-4563-AE4A-F43D445034EC@twistedmatrix.com>
Message-ID: <CAKz8sYWKHxRg=u5EUQ7KSSCv737hARGo7JC8=m+omwmpZxX5NA@mail.gmail.com>

On Thu, May 3, 2012 at 1:05 PM, Glyph <glyph at twistedmatrix.com> wrote:
> Actually, you're better off using twisted.python.filepath.FilePath.child :).
>
> <http://twistedmatrix.com/documents/current/api/twisted.python.filepath.FilePath.html>

That documentation has quite the personality.



From exarkun at twistedmatrix.com  Fri May  4 13:43:57 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Fri, 04 May 2012 19:43:57 -0000
Subject: [Twisted-Python] (no subject)
Message-ID: <20120504194357.3668.1386543969.divmod.xquotient.200@localhost6.localdomain6>

Hi all,

A few us were discussing providing commercial support contracts for 
Twisted users, and it would be helpful to gauge potential interest. 
Support contracts might include things like:

     A certified version of Twisted for your platform
     Twisted bug fixes
     Twisted feature development
     Answers to questions about Twisted functionality
     Answers to questions about Twisted best practices and design 
patterns
     Answers to questions about performance and scaling
     In-depth support for your specific applications
     Additional documentation
     Training
     Code review

If you or your organization might be interested in such a thing, we'd 
appreciate your answering a quick questionnaire:

    http://bit.ly/JxrIbu

Thanks,
Jean-Paul



From itamar at itamarst.org  Fri May  4 17:32:13 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Fri, 04 May 2012 19:32:13 -0400
Subject: [Twisted-Python] Commercial support contracts for Twisted - any
	interest?
In-Reply-To: <20120504194357.3668.1386543969.divmod.xquotient.200@localhost6.localdomain6>
References: <20120504194357.3668.1386543969.divmod.xquotient.200@localhost6.localdomain6>
Message-ID: <4FA466FD.1030202@itamarst.org>

Just so no one misses this, I updated the subject.

On 05/04/2012 03:43 PM, exarkun at twistedmatrix.com wrote:
> Hi all,
>
> A few us were discussing providing commercial support contracts for
> Twisted users, and it would be helpful to gauge potential interest.
> Support contracts might include things like:
>
>       A certified version of Twisted for your platform
>       Twisted bug fixes
>       Twisted feature development
>       Answers to questions about Twisted functionality
>       Answers to questions about Twisted best practices and design
> patterns
>       Answers to questions about performance and scaling
>       In-depth support for your specific applications
>       Additional documentation
>       Training
>       Code review
>
> If you or your organization might be interested in such a thing, we'd
> appreciate your answering a quick questionnaire:
>
>      http://bit.ly/JxrIbu
>
> Thanks,
> Jean-Paul
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From exarkun at twistedmatrix.com  Sat May  5 22:05:32 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 06 May 2012 04:05:32 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1336277132.76.1105150850@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120506/a780d890/attachment-0001.html>

From orestis at orestis.gr  Thu May 10 04:02:54 2012
From: orestis at orestis.gr (Orestis Markou)
Date: Thu, 10 May 2012 13:02:54 +0300
Subject: [Twisted-Python] Replacement for Twisted Tutorial in Europython 2012
Message-ID: <5CB88ED5-1978-4256-85C0-6C8E01A6193C@orestis.gr>

Hello everyone,

My proposal for delivering a 4h Twisted training in EuroPython 2012 (Florence, July 2-8) has been voted in the community and is set to be delivered on July 5. https://ep2012.europython.eu/conference/talks/twisted-tutorial This turned out to be very popular last year, and had to be repeated on a second day to cover all the audience.

Unfortunately for personal reasons I won't be able to attend the conference. Before I give back the slot to the EuroPython organizers, I wonder if someone that would be attending would want to deliver the training in my place. I have a lot of material already from last year, and I can happily work for the preparation of the training.

I need to give an answer to the organizers in the next few days, so if someone's interested, please speak up!

Thanks,
Orestis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120510/99ef746b/attachment.html>

From stephen at thorne.id.au  Thu May 10 04:51:47 2012
From: stephen at thorne.id.au (Thorne, Stephen)
Date: Thu, 10 May 2012 11:51:47 +0100
Subject: [Twisted-Python] Replacement for Twisted Tutorial in Europython
	2012
In-Reply-To: <5CB88ED5-1978-4256-85C0-6C8E01A6193C@orestis.gr>
References: <5CB88ED5-1978-4256-85C0-6C8E01A6193C@orestis.gr>
Message-ID: <CAFPU7=u3eJcvWAKWr_6ErStNAEfqby33jrbOb+SF-orm4jQymA@mail.gmail.com>

Hihi,

It sounds like I need to get my ass into gear and convince my employer
to send me to europython, so I can help you out here.

I am available at that time, I just haven't organised anything. Can you send
me a link to the latest version of the training material you had from last
year?

Are there any other volunteers? Training is very draining and having more
than
one person in the room really helps.

On Thu, May 10, 2012 at 11:02 AM, Orestis Markou <orestis at orestis.gr> wrote:

> Hello everyone,
>
> My proposal for delivering a 4h Twisted training in EuroPython 2012
> (Florence, July 2-8) has been voted in the community and is set to be
> delivered on July 5.
> https://ep2012.europython.eu/conference/talks/twisted-tutorial This
> turned out to be very popular last year, and had to be repeated on a second
> day to cover all the audience.
>
> Unfortunately for personal reasons I won't be able to attend the
> conference. Before I give back the slot to the EuroPython organizers, I
> wonder if someone that would be attending would want to deliver the
> training in my place. I have a lot of material already from last year, and
> I can happily work for the preparation of the training.
>
> I need to give an answer to the organizers in the next few days, so if
> someone's interested, please speak up!
>
> Thanks,
> Orestis
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120510/981b4830/attachment.html>

From orestis at orestis.gr  Thu May 10 05:02:58 2012
From: orestis at orestis.gr (Orestis Markou)
Date: Thu, 10 May 2012 14:02:58 +0300
Subject: [Twisted-Python] Replacement for Twisted Tutorial in Europython
	2012
In-Reply-To: <CAFPU7=u3eJcvWAKWr_6ErStNAEfqby33jrbOb+SF-orm4jQymA@mail.gmail.com>
References: <5CB88ED5-1978-4256-85C0-6C8E01A6193C@orestis.gr>
	<CAFPU7=u3eJcvWAKWr_6ErStNAEfqby33jrbOb+SF-orm4jQymA@mail.gmail.com>
Message-ID: <BC4854AA-4E6C-48CC-ABC7-6965BF8929BB@orestis.gr>

The PDF is here - I can export the Keynote slides to some other format if you want.

https://ep2012.europython.eu/conference/talks/asynchronous-programming-with-twisted

On 10 Μαϊ 2012, at 1:51 μ.μ., Thorne, Stephen wrote:

> Hihi,
> 
> It sounds like I need to get my ass into gear and convince my employer
> to send me to europython, so I can help you out here.
> 
> I am available at that time, I just haven't organised anything. Can you send
> me a link to the latest version of the training material you had from last year?
> 
> Are there any other volunteers? Training is very draining and having more than
> one person in the room really helps.
> 
> On Thu, May 10, 2012 at 11:02 AM, Orestis Markou <orestis at orestis.gr> wrote:
> Hello everyone,
> 
> My proposal for delivering a 4h Twisted training in EuroPython 2012 (Florence, July 2-8) has been voted in the community and is set to be delivered on July 5. https://ep2012.europython.eu/conference/talks/twisted-tutorial This turned out to be very popular last year, and had to be repeated on a second day to cover all the audience.
> 
> Unfortunately for personal reasons I won't be able to attend the conference. Before I give back the slot to the EuroPython organizers, I wonder if someone that would be attending would want to deliver the training in my place. I have a lot of material already from last year, and I can happily work for the preparation of the training.
> 
> I need to give an answer to the organizers in the next few days, so if someone's interested, please speak up!
> 
> Thanks,
> Orestis
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120510/843eec8e/attachment.html>

From stephen at thorne.id.au  Thu May 10 07:54:50 2012
From: stephen at thorne.id.au (Thorne, Stephen)
Date: Thu, 10 May 2012 14:54:50 +0100
Subject: [Twisted-Python] Replacement for Twisted Tutorial in Europython
	2012
In-Reply-To: <BC4854AA-4E6C-48CC-ABC7-6965BF8929BB@orestis.gr>
References: <5CB88ED5-1978-4256-85C0-6C8E01A6193C@orestis.gr>
	<CAFPU7=u3eJcvWAKWr_6ErStNAEfqby33jrbOb+SF-orm4jQymA@mail.gmail.com>
	<BC4854AA-4E6C-48CC-ABC7-6965BF8929BB@orestis.gr>
Message-ID: <CAFPU7=sfCLEkg9gAHG0iWz4L6MZk9NPb5Vi=jjkregYfzu0e9A@mail.gmail.com>

Orestis,

I've got approval to take this on, so you can let the Europython2012 team
know that I'm willing to take responsibility for running the session from
you.

On Thu, May 10, 2012 at 12:02 PM, Orestis Markou <orestis at orestis.gr> wrote:

> The PDF is here - I can export the Keynote slides to some other format if
> you want.
>
>
> https://ep2012.europython.eu/conference/talks/asynchronous-programming-with-twisted
>
> On 10 Μαϊ 2012, at 1:51 μ.μ., Thorne, Stephen wrote:
>
> Hihi,
>
> It sounds like I need to get my ass into gear and convince my employer
> to send me to europython, so I can help you out here.
>
> I am available at that time, I just haven't organised anything. Can you
> send
> me a link to the latest version of the training material you had from last
> year?
>
> Are there any other volunteers? Training is very draining and having more
> than
> one person in the room really helps.
>
> On Thu, May 10, 2012 at 11:02 AM, Orestis Markou <orestis at orestis.gr>wrote:
>
>> Hello everyone,
>>
>> My proposal for delivering a 4h Twisted training in EuroPython 2012
>> (Florence, July 2-8) has been voted in the community and is set to be
>> delivered on July 5.
>> https://ep2012.europython.eu/conference/talks/twisted-tutorial This
>> turned out to be very popular last year, and had to be repeated on a second
>> day to cover all the audience.
>>
>> Unfortunately for personal reasons I won't be able to attend the
>> conference. Before I give back the slot to the EuroPython organizers, I
>> wonder if someone that would be attending would want to deliver the
>> training in my place. I have a lot of material already from last year, and
>> I can happily work for the preparation of the training.
>>
>> I need to give an answer to the organizers in the next few days, so if
>> someone's interested, please speak up!
>>
>> Thanks,
>> Orestis
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>>
>>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120510/af85f8f5/attachment.html>

From exarkun at twistedmatrix.com  Sat May 12 22:05:42 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 13 May 2012 04:05:42 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1336881942.16.309234754@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120513/d209c03e/attachment-0001.html>

From bino at indoakses-online.com  Mon May 14 02:53:53 2012
From: bino at indoakses-online.com (bino oetomo)
Date: Mon, 14 May 2012 15:53:53 +0700
Subject: [Twisted-Python] question : json.loads failed using LineReceiver
	data
Message-ID: <4FB0C821.9070607@indoakses-online.com>

Dear All ..

I'm trying to received json formated text using LineReceiver

Here is my code
----START----
class ArduinoReceiver(LineReceiver):
     def __init__(self):
         print 'INIT : ArduinoReceiver'

     def lineReceived(self, line):
         line = line.strip()
         print 'Received line = '+line
         if 'Arduino' in line :
             return
         self.linedict=json.loads(line)

----STOP-----
but I got error msg in the log as :
----START----
2012-05-14 15:42:00+0700 [-] Received line = 
'{"a_flw_fwd":12,"a_flw_rtr":5029,"a_rpm":519,"b_flw_fwd":23,"b_flw_rtr":8,"b_rpm":913}'
2012-05-14 15:42:00+0700 [-] Unhandled Error
     Traceback (most recent call last):
       File 
"/usr/local/lib/python2.6/dist-packages/Twisted-11.1.0_r33425-py2.6-linux-i686.egg/twisted/python/log.py", 
line 84, in callWithLogger
         return callWithContext({"system": lp}, func, *args, **kw)
       File 
"/usr/local/lib/python2.6/dist-packages/Twisted-11.1.0_r33425-py2.6-linux-i686.egg/twisted/python/log.py", 
line 69, in callWithContext
         return context.call({ILogContext: newCtx}, func, *args, **kw)
       File 
"/usr/local/lib/python2.6/dist-packages/Twisted-11.1.0_r33425-py2.6-linux-i686.egg/twisted/python/context.py", 
line 118, in callWithContext
         return self.currentContext().callWithContext(ctx, func, *args, 
**kw)
       File 
"/usr/local/lib/python2.6/dist-packages/Twisted-11.1.0_r33425-py2.6-linux-i686.egg/twisted/python/context.py", 
line 81, in callWithContext
         return func(*args,**kw)
     --- <exception caught here> ---
       File 
"/usr/local/lib/python2.6/dist-packages/Twisted-11.1.0_r33425-py2.6-linux-i686.egg/twisted/internet/posixbase.py", 
line 586, in _doReadOrWrite
         why = selectable.doRead()
       File 
"/usr/local/lib/python2.6/dist-packages/Twisted-11.1.0_r33425-py2.6-linux-i686.egg/twisted/internet/_posixserialport.py", 
line 62, in doRead
         return fdesc.readFromFD(self.fileno(), self.protocol.dataReceived)
       File 
"/usr/local/lib/python2.6/dist-packages/Twisted-11.1.0_r33425-py2.6-linux-i686.egg/twisted/internet/fdesc.py", 
line 94, in readFromFD
         callback(output)
       File 
"/usr/local/lib/python2.6/dist-packages/Twisted-11.1.0_r33425-py2.6-linux-i686.egg/twisted/protocols/basic.py", 
line 564, in dataReceived
         why = self.lineReceived(line)
       File "./kapal02.tac", line 48, in lineReceived
         self.linedict=json.loads(line)
       File "/usr/lib/python2.6/json/__init__.py", line 307, in loads
         return _default_decoder.decode(s)
       File "/usr/lib/python2.6/json/decoder.py", line 319, in decode
         obj, end = self.raw_decode(s, idx=_w(s, 0).end())
       File "/usr/lib/python2.6/json/decoder.py", line 338, in raw_decode
         raise ValueError("No JSON object could be decoded")
     exceptions.ValueError: No JSON object could be decoded
----STOP-----

I try to do json.loads based on received msg using python console, and 
it work :
---START---------
bino at bino-desktop:/var/log/rabbitmq$ python
Python 2.6.6 (r266:84292, Sep 15 2010, 15:52:39)
[GCC 4.4.5] on linux2
Type "help", "copyright", "credits" or "license" for more information.
 >>> import json
 >>> 
aa='{"a_flw_fwd":12,"a_flw_rtr":5029,"a_rpm":519,"b_flw_fwd":23,"b_flw_rtr":8,"b_rpm":913}'
 >>> mydict=json.loads(aa)
 >>> print mydict['a_flw_fwd']
12
---STOP----------

Kindly please tell me why the 'json.loads' is failed in my tac file 
while it work in python console.

Sincerely
-bino-



From itamar at itamarst.org  Mon May 14 04:47:38 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Mon, 14 May 2012 06:47:38 -0400
Subject: [Twisted-Python] question : json.loads failed using
 LineReceiver data
In-Reply-To: <4FB0C821.9070607@indoakses-online.com>
References: <4FB0C821.9070607@indoakses-online.com>
Message-ID: <4FB0E2CA.4090802@itamarst.org>

On 05/14/2012 04:53 AM, bino oetomo wrote:
> Kindly please tell me why the 'json.loads' is failed in my tac file
> while it work in python console.
>
Perhaps the JSON spans more than one line? Printing out the repr() of 
the lines you're receiving may be informative.



From exarkun at twistedmatrix.com  Mon May 14 06:47:17 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Mon, 14 May 2012 12:47:17 -0000
Subject: [Twisted-Python] question : json.loads failed using
 LineReceiver data
In-Reply-To: <4FB0C821.9070607@indoakses-online.com>
References: <4FB0C821.9070607@indoakses-online.com>
Message-ID: <20120514124717.13157.1256494908.divmod.xquotient.160@localhost6.localdomain6>

On 08:53 am, bino at indoakses-online.com wrote:
>Dear All ..
>
>I'm trying to received json formated text using LineReceiver
>
>Here is my code
>----START----
>class ArduinoReceiver(LineReceiver):
>     def __init__(self):
>         print 'INIT : ArduinoReceiver'
>
>     def lineReceived(self, line):
>         line = line.strip()
>         print 'Received line = '+line
>         if 'Arduino' in line :
>             return
>         self.linedict=json.loads(line)
>
>----STOP-----
>but I got error msg in the log as :
>----START----
>2012-05-14 15:42:00+0700 [-] Received line =
>'{"a_flw_fwd":12,"a_flw_rtr":5029,"a_rpm":519,"b_flw_fwd":23,"b_flw_rtr":8,"b_rpm":913}'

Read your log message.  This is not a valid JSON string:

'{"a_flw_fwd":12,"a_flw_rtr":5029,"a_rpm":519,"b_flw_fwd":23,"b_flw_rtr":8,"b_rpm":913}'

Presumably your objective is to receive something like this instead:

{"a_flw_fwd":12,"a_flw_rtr":5029,"a_rpm":519,"b_flw_fwd":23,"b_flw_rtr":8,"b_rpm":913}

The problem is unrelated to Twisted or the console.  The sender is 
sending the wrong data, or else your parsing of it is incorrect.

Jean-Paul



From pascal at optimorlabs.com  Mon May 14 07:14:49 2012
From: pascal at optimorlabs.com (Pascal Briet)
Date: Mon, 14 May 2012 14:14:49 +0100
Subject: [Twisted-Python] Cannot install Twisted version 8 through PIP
Message-ID: <CAMd_B-SrHV8qvSRuORSO72ea7d_zjymEV7cSXsnm4NeCn+bUUA@mail.gmail.com>

Hi,

We're having some troubles today, because it seems that old packages of
Twisted are not available anymore.
We are currently relying on Twisted 8.2.0.

pip install twisted==8.2.0  is failing  (first version available seems to
be 9.0.0)
The package was still available last Friday.

Is there a critical reason explaining that it has been removed from the
servers ?

Thanks very much,
Best regards,

-- 
Pascal BRIET
Software engineer
Optimor Labs
http://www.billmonitor.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120514/9be45d82/attachment.html>

From itamar at itamarst.org  Mon May 14 07:29:23 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Mon, 14 May 2012 09:29:23 -0400
Subject: [Twisted-Python] Cannot install Twisted version 8 through PIP
In-Reply-To: <CAMd_B-SrHV8qvSRuORSO72ea7d_zjymEV7cSXsnm4NeCn+bUUA@mail.gmail.com>
References: <CAMd_B-SrHV8qvSRuORSO72ea7d_zjymEV7cSXsnm4NeCn+bUUA@mail.gmail.com>
Message-ID: <4FB108B3.3060700@itamarst.org>

On 05/14/2012 09:14 AM, Pascal Briet wrote:
> Hi,
>
> We're having some troubles today, because it seems that old packages 
> of Twisted are not available anymore.
> We are currently relying on Twisted 8.2.0.
>
> pip install twisted==8.2.0  is failing  (first version available seems 
> to be 9.0.0)
> The package was still available last Friday.
>
> Is there a critical reason explaining that it has been removed from 
> the servers ?
>
My understanding is that pip uses PyPI, and personally I know of no one 
who removed stuff from PyPI; more likely PyPI decided to remove old 
versions of software to save space.

Any reason you're using 8.2? It's almost 4 years old at this point, and 
we've fixed a lot of bugs and added a lot of features since then.

-Itamar



From pascal at optimorlabs.com  Mon May 14 07:35:14 2012
From: pascal at optimorlabs.com (Pascal Briet)
Date: Mon, 14 May 2012 14:35:14 +0100
Subject: [Twisted-Python] Cannot install Twisted version 8 through PIP
In-Reply-To: <4FB108B3.3060700@itamarst.org>
References: <CAMd_B-SrHV8qvSRuORSO72ea7d_zjymEV7cSXsnm4NeCn+bUUA@mail.gmail.com>
	<4FB108B3.3060700@itamarst.org>
Message-ID: <CAMd_B-QjkExS_Bp5a5+3xxt42YdNQk6pfXJvxW74UW+tExOYjA@mail.gmail.com>

Hi,

Thanks for your answer.

Well, there is no specific reason that we use the 8.2.0 version.
It's just... history. We never needed to upgrade it.

Do you think we can easily upgrade to 9/10/11/12 ??
Thanks very much,

-- 
Pascal BRIET
Software engineer
Optimor Labs
http://www.billmonitor.com



On 14 May 2012 14:29, Itamar Turner-Trauring <itamar at itamarst.org> wrote:

> On 05/14/2012 09:14 AM, Pascal Briet wrote:
> > Hi,
> >
> > We're having some troubles today, because it seems that old packages
> > of Twisted are not available anymore.
> > We are currently relying on Twisted 8.2.0.
> >
> > pip install twisted==8.2.0  is failing  (first version available seems
> > to be 9.0.0)
> > The package was still available last Friday.
> >
> > Is there a critical reason explaining that it has been removed from
> > the servers ?
> >
> My understanding is that pip uses PyPI, and personally I know of no one
> who removed stuff from PyPI; more likely PyPI decided to remove old
> versions of software to save space.
>
> Any reason you're using 8.2? It's almost 4 years old at this point, and
> we've fixed a lot of bugs and added a lot of features since then.
>
> -Itamar
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120514/6ba86e96/attachment.html>

From itamar at itamarst.org  Mon May 14 07:54:00 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Mon, 14 May 2012 09:54:00 -0400
Subject: [Twisted-Python] Cannot install Twisted version 8 through PIP
In-Reply-To: <CAMd_B-QjkExS_Bp5a5+3xxt42YdNQk6pfXJvxW74UW+tExOYjA@mail.gmail.com>
References: <CAMd_B-SrHV8qvSRuORSO72ea7d_zjymEV7cSXsnm4NeCn+bUUA@mail.gmail.com>
	<4FB108B3.3060700@itamarst.org>
	<CAMd_B-QjkExS_Bp5a5+3xxt42YdNQk6pfXJvxW74UW+tExOYjA@mail.gmail.com>
Message-ID: <4FB10E78.1010104@itamarst.org>

On 05/14/2012 09:35 AM, Pascal Briet wrote:
> Hi,
>
> Thanks for your answer.
>
> Well, there is no specific reason that we use the 8.2.0 version.
> It's just... history. We never needed to upgrade it.
>
> Do you think we can easily upgrade to 9/10/11/12 ??
> Thanks very much,
>

We have a strict backwards compatibility policy; anything that changes 
or is removed will have deprecation warnings for at least 2 releases and 
one year.

So the thing to do is, upgrade to version 9, run your program and make 
sure its tests pass, and fix any code that triggers deprecation warnings 
in Twisted. Repeat with each version until you're up to date. In most 
cases this may take as little as a couple of hours of work; possibly 
none if you didn't happen to be using any deprecated APIs.



From pascal at optimorlabs.com  Mon May 14 08:00:18 2012
From: pascal at optimorlabs.com (Pascal Briet)
Date: Mon, 14 May 2012 15:00:18 +0100
Subject: [Twisted-Python] Cannot install Twisted version 8 through PIP
In-Reply-To: <4FB10E78.1010104@itamarst.org>
References: <CAMd_B-SrHV8qvSRuORSO72ea7d_zjymEV7cSXsnm4NeCn+bUUA@mail.gmail.com>
	<4FB108B3.3060700@itamarst.org>
	<CAMd_B-QjkExS_Bp5a5+3xxt42YdNQk6pfXJvxW74UW+tExOYjA@mail.gmail.com>
	<4FB10E78.1010104@itamarst.org>
Message-ID: <CAMd_B-QYiUk8BqDN-WoD-LGBNiHZCEiMRpBFKMZnSxfSyZvZQg@mail.gmail.com>

Ok,

Thanks for your help.
Best regards,

-- 
Pascal BRIET
Software engineer
Optimor Labs
http://www.billmonitor.com



On 14 May 2012 14:54, Itamar Turner-Trauring <itamar at itamarst.org> wrote:

> On 05/14/2012 09:35 AM, Pascal Briet wrote:
> > Hi,
> >
> > Thanks for your answer.
> >
> > Well, there is no specific reason that we use the 8.2.0 version.
> > It's just... history. We never needed to upgrade it.
> >
> > Do you think we can easily upgrade to 9/10/11/12 ??
> > Thanks very much,
> >
>
> We have a strict backwards compatibility policy; anything that changes
> or is removed will have deprecation warnings for at least 2 releases and
> one year.
>
> So the thing to do is, upgrade to version 9, run your program and make
> sure its tests pass, and fix any code that triggers deprecation warnings
> in Twisted. Repeat with each version until you're up to date. In most
> cases this may take as little as a couple of hours of work; possibly
> none if you didn't happen to be using any deprecated APIs.
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120514/9a18a925/attachment.html>

From itamar at itamarst.org  Tue May 15 04:26:24 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Tue, 15 May 2012 06:26:24 -0400
Subject: [Twisted-Python] Getting rid of "DirtyReactorWarning"
Message-ID: <4FB22F50.6000407@itamarst.org>

I have a ticket open for allowing tests that look like this, where each 
run has a new reactor instance:


def test_somethingShouldHappen(self, reactor):
      result = []
      reactor.listenTCP(...)
      self.runReactor(reactor)
      self.assertEqual(result, ["hooray"])


Further thought suggests however that this doesn't add much, 
necessarily, over the current "return a Deferred" idiom for most users. 
Experience with ReactorBuilder framework that has similar testing 
mechanism suggests it's far too easy to fail to stop the reactor. 
Moreover, things like coiterate() don't work since they rely on 
pre-imported global reactor, and given the "from twisted.internet import 
reactor" idiom this testing style won't work well for many people's code.

But! ReactorBuilder tests are superior in one way: no 
DirtyReactorWarning. You don't have to wait until all connections are 
closed, which is difficult, or make sure to cancel every timeout. This 
makes test writing simpler.

Perhaps we should get rid of DirtyReactorWarning for regular 
Deferred-returning tests as well, then. We have all the infrastructure 
we need, after all, for canceling scheduled events and disconnecting all 
descriptors. We might want to log when we do so, to help debug things, 
but we already have cleanup code mostly implemented in trial anyway, and 
it seems like DirtyReactorWarning doesn't usually make future tests fail 
anyway since we do run cleanup.

Threaded code might still be a problem, but that's the case for current 
tests now, and even switching to a new style of tests as above would 
only somewhat mitigate the issue.

Thoughts?



From _ at lvh.cc  Wed May 16 08:26:00 2012
From: _ at lvh.cc (Laurens Van Houtven)
Date: Wed, 16 May 2012 16:26:00 +0200
Subject: [Twisted-Python] Declaring AMP responders away from
Message-ID: <32D7EF96-0CD4-4507-B667-70281C4FBC24@lvh.cc>

Hi,

I'm writing a service that exposes a bunch of methods over AMP.

These methods are easily logically grouped into separate modules (i.e. message-related, picture-related…). So, I'd like to define the behavior for those methods in those modules.

However, the amp.Command.responder decorator only works inside the class definition of an AMP subclass.  (http://twistedmatrix.com/documents/current/api/twisted.protocols.amp.Command.html#responder).

Does that mean I should have multiple AMP subclasses? How do I get all of them to listen on the same port? Is this what the mysterious "routes" feature I've been hearing about does?

Right now I'm doing it like this, which works but isn't very pretty or nice:

user.py:
-----
class Register(amp.Command):
    arguments = […]
    response = […]
    errors = […]


def register(self, …):
    # do actual registering behavior here
-----

api.py:
-----
from project import auth

class API(amp.AMP):
    register = auth.Register.responder(auth.register)
-----


cheers
lvh






From washort at twistedmatrix.com  Wed May 16 09:07:48 2012
From: washort at twistedmatrix.com (Allen Short)
Date: Wed, 16 May 2012 10:07:48 -0500
Subject: [Twisted-Python] Declaring AMP responders away from
In-Reply-To: <32D7EF96-0CD4-4507-B667-70281C4FBC24@lvh.cc>
References: <32D7EF96-0CD4-4507-B667-70281C4FBC24@lvh.cc>
Message-ID: <CAEzUHiMjuHGWmqm6vWR__-np0K2KRfYoO08-b+izrdortGrDTA@mail.gmail.com>

Have a look at what I did in Frack:

http://bazaar.launchpad.net/~washort/frack/trunk/view/head:/frack/wiring.py#L27
http://bazaar.launchpad.net/~washort/frack/trunk/view/head:/frack/responder.py#L85

You can unbundle the locator and dispatcher bits. I only used this for
a single separate class, but with some imagination the principle could
be extended to multiple objects I bet.



From spalax at gresille.org  Wed May 16 16:58:57 2012
From: spalax at gresille.org (Louis)
Date: Thu, 17 May 2012 00:58:57 +0200
Subject: [Twisted-Python] Synchronous calls using Twisted?
Message-ID: <4FB43131.2030805@gresille.org>

  Hello,
  I am writing an application, which architecture is (I hope my
beautiful drawing is not messed up):

  +-------------+   +------------+   +-----------+
  | Core Server |---| Web Server |---| Web client|
  +-------------+   +------------+   +-----------+

  That is, I have a core server (itself interacting with a database, but
I think this is not important). I have a second piece of software, which
is both a client regarding the core server, and a web server. At last,
the web client is the web browser of your choice.
  The web server is a Django application, which means that (as far as I
know) I cannot (easily) make it use asynchronous calls.
  At last, for the communication between the core server and the web
server (which is, from this point of vue, a client), I was looking for
something that let me use remote objects as if they were local. That is
when I discovered Twisted.



  Twisted seems to be the kind of tool I want to use because it seems to
be powerful, can use SSL, authentication, transmits exceptions, is meant
to be used with Trial (I want to write tests), etc. The problem is that
one of the strength of Twisted is its ability to deal with asynchronous
tasks, which I am not interested in.  Using blockingCallFromThread()
[1], I managed to make a small package which looks (from my
Twisted-ignorant point of vue) promising for my application, where the
server is simply defined by (in a Twisted .tac  file):

    # Server() is the object to be exported to the client
    application = server.get_application(Server(),
                  "tcp:8800:interface=localhost")

And the client can perform something like:

    remote = client.RemoteObject("localhost", 8800)
    # display() is a method executed on the server
    remote.display("Hello, world!")
    remote.disconnect()


  But then I noticed that I might have problem to test it using Trial
(because an deadlock happens when blockingCallFromThread() and the
reactor are waiting for each other in the same thread). I also had a
look at inlineCallbacks [2], but although code looks synchronous inside
the decorated function, the function itself still returns a deferred.  I
noticed quite a few other minor things. And I started to realize that
Twisted is not meant to be used that way (and I read a bunch of threads
of the Twisted mailing list with subjects containing "synchronous",
including this long one [3]).

  My question is: What is your reaction?

a) "Nice hack! Go on!"
b) "Go on if you like, but you won't be able to use advanced Trial stuff
(like timeouts), let alone Trial."
c) "Go on if you wish, but you are missing the beauty of Twisted."
d) "Stop it now. You have clearly misunderstood Twisted. You are wasting
your time and ours."
e) Any other...

  Do you think Twisted is the right tool for my use case, or am I doing
an ugly hack to do what I want, which means I should rather use another
tool?


  Sorry for the length of this post, and thanks in advance for your help.
  Louis

[1]
http://twistedmatrix.com/documents/current/api/twisted.internet.threads.html#blockingCallFromThread
[2]
http://twistedmatrix.com/documents/current/api/twisted.internet.defer.html#inlineCallbacks
[3]
http://twistedmatrix.com/pipermail/twisted-python/2005-October/thread.html#11831



From itamar at itamarst.org  Wed May 16 17:45:39 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Wed, 16 May 2012 19:45:39 -0400
Subject: [Twisted-Python] Commercial support contracts for Twisted - any
 interest?
In-Reply-To: <4FA466FD.1030202@itamarst.org>
References: <20120504194357.3668.1386543969.divmod.xquotient.200@localhost6.localdomain6>
	<4FA466FD.1030202@itamarst.org>
Message-ID: <4FB43C23.2020705@itamarst.org>

One final reminder - if you're interested in support contracts for 
Twisted, please fill out the questionnaire linked below.

> If you or your organization might be interested in such a thing, we'd
> appreciate your answering a quick questionnaire:
>
>       http://bit.ly/JxrIbu
>
> Thanks,
> Jean-Paul
>




From jstpierre at mecheye.net  Wed May 16 18:00:03 2012
From: jstpierre at mecheye.net (Jasper St. Pierre)
Date: Wed, 16 May 2012 20:00:03 -0400
Subject: [Twisted-Python] Synchronous calls using Twisted?
In-Reply-To: <4FB43131.2030805@gresille.org>
References: <4FB43131.2030805@gresille.org>
Message-ID: <CAA0H+QTPPhTgPMEx1xBA2bxzQuik-RP8yfhaj+Qs_xa509fKyg@mail.gmail.com>

The point of blockingCallFromThread is as a last resort when
interfacing with a synchronous API that can't be replaced, like the
DBAPI. It fools Twisted into thinking an external synchronous API is
asynchronous, by carefully punting it to a new thread.

I don't understand why you can't make Django do asynchronous calls.
Maybe a bit more context would help.

On Wed, May 16, 2012 at 6:58 PM, Louis <spalax at gresille.org> wrote:
>  Hello,
>  I am writing an application, which architecture is (I hope my
> beautiful drawing is not messed up):
>
>  +-------------+   +------------+   +-----------+
>  | Core Server |---| Web Server |---| Web client|
>  +-------------+   +------------+   +-----------+
>
>  That is, I have a core server (itself interacting with a database, but
> I think this is not important). I have a second piece of software, which
> is both a client regarding the core server, and a web server. At last,
> the web client is the web browser of your choice.
>  The web server is a Django application, which means that (as far as I
> know) I cannot (easily) make it use asynchronous calls.
>  At last, for the communication between the core server and the web
> server (which is, from this point of vue, a client), I was looking for
> something that let me use remote objects as if they were local. That is
> when I discovered Twisted.
>
>
>
>  Twisted seems to be the kind of tool I want to use because it seems to
> be powerful, can use SSL, authentication, transmits exceptions, is meant
> to be used with Trial (I want to write tests), etc. The problem is that
> one of the strength of Twisted is its ability to deal with asynchronous
> tasks, which I am not interested in.  Using blockingCallFromThread()
> [1], I managed to make a small package which looks (from my
> Twisted-ignorant point of vue) promising for my application, where the
> server is simply defined by (in a Twisted .tac  file):
>
>    # Server() is the object to be exported to the client
>    application = server.get_application(Server(),
>                  "tcp:8800:interface=localhost")
>
> And the client can perform something like:
>
>    remote = client.RemoteObject("localhost", 8800)
>    # display() is a method executed on the server
>    remote.display("Hello, world!")
>    remote.disconnect()
>
>
>  But then I noticed that I might have problem to test it using Trial
> (because an deadlock happens when blockingCallFromThread() and the
> reactor are waiting for each other in the same thread). I also had a
> look at inlineCallbacks [2], but although code looks synchronous inside
> the decorated function, the function itself still returns a deferred.  I
> noticed quite a few other minor things. And I started to realize that
> Twisted is not meant to be used that way (and I read a bunch of threads
> of the Twisted mailing list with subjects containing "synchronous",
> including this long one [3]).
>
>  My question is: What is your reaction?
>
> a) "Nice hack! Go on!"
> b) "Go on if you like, but you won't be able to use advanced Trial stuff
> (like timeouts), let alone Trial."
> c) "Go on if you wish, but you are missing the beauty of Twisted."
> d) "Stop it now. You have clearly misunderstood Twisted. You are wasting
> your time and ours."
> e) Any other...
>
>  Do you think Twisted is the right tool for my use case, or am I doing
> an ugly hack to do what I want, which means I should rather use another
> tool?
>
>
>  Sorry for the length of this post, and thanks in advance for your help.
>  Louis
>
> [1]
> http://twistedmatrix.com/documents/current/api/twisted.internet.threads.html#blockingCallFromThread
> [2]
> http://twistedmatrix.com/documents/current/api/twisted.internet.defer.html#inlineCallbacks
> [3]
> http://twistedmatrix.com/pipermail/twisted-python/2005-October/thread.html#11831
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



-- 
  Jasper



From andrewfr_ice at yahoo.com  Thu May 17 13:06:04 2012
From: andrewfr_ice at yahoo.com (Andrew Francis)
Date: Thu, 17 May 2012 12:06:04 -0700 (PDT)
Subject: [Twisted-Python] Synchronous calls using Twisted?
In-Reply-To: <mailman.5.1337270403.17467.twisted-python@twistedmatrix.com>
References: <mailman.5.1337270403.17467.twisted-python@twistedmatrix.com>
Message-ID: <1337281564.44107.YahooMailNeo@web120705.mail.ne1.yahoo.com>

Message: 1

Date: Thu, 17 May 2012 00:58:57 +0200
From: Louis <spalax at gresille.org>
Subject: [Twisted-Python] Synchronous calls using Twisted?
To: twisted-python at twistedmatrix.com
Message-ID: <4FB43131.2030805 at gresille.org>
Content-Type: text/plain; charset=ISO-8859-1

>  Hello,
>  I am writing an application, which architecture is (I hope my
>beautiful drawing is not messed up):

>  +-------------+   +------------+   +-----------+
>  | Core Server |---| Web Server |---| Web client|
>  +-------------+   +------------+   +-----------+
>...

>  Do you think Twisted is the right tool for my use case, or am I doing
>an ugly hack to do what I want, which means I should rather use another
>tool?


I am not sure why inline generators won't work?

Over the years, I use Stackless Python with Twisted. I use Twisted for many of the reasons you describe. For myself there is another dimension: I find that a lot of the code I write are orchestrations - that is in order to compute something, I have to make a few network calls sequentially. 

 I use a technique that Christopher Armstrong (what happened to him?) called a blockOn. For the sake of being academic (roll your eyes here),  this is an example of an obscure design pattern called "Half-sync/Half-async."

Essentially one does the following:

def blockOn(deferred): 
    ch = stackless.channel() 
    def cb(result): 
        ch.send(result) 
    deferred.addBoth(cb) 
    return ch.receive() 


Of course, there is a bit more, like the Twisted reactor is running in its own tasklet. But this has the effect of nicely allowing one to use Twisted in a synchronous fashion. If you don't feel like installing Stackless Python, then you can use stackless.py (not the new version that uses continuations) with the greenlet package.

Here is a link to a complete example

http://andrewfr.wordpress.com/2011/11/30/the-santa-claus-problem-with-join-patterns/


Cheers,
Andrew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120517/75930e2a/attachment.html>

From miwinter at cisco.com  Thu May 17 14:17:43 2012
From: miwinter at cisco.com (Mike Winter)
Date: Thu, 17 May 2012 13:17:43 -0700
Subject: [Twisted-Python] Synchronous calls using Twisted?
In-Reply-To: <1337281564.44107.YahooMailNeo@web120705.mail.ne1.yahoo.com>
References: <mailman.5.1337270403.17467.twisted-python@twistedmatrix.com>
	<1337281564.44107.YahooMailNeo@web120705.mail.ne1.yahoo.com>
Message-ID: <692FCEB2-4D3F-4B5F-90C0-E6E9C962A7DF@cisco.com>

half async/half sync is not as obscure as you may think:

www.cs.wustl.edu/~schmidt/PDF/PLoP-95.pdf

On May 17, 2012, at 12:06:04PM, Andrew Francis wrote:

> Message: 1
> Date: Thu, 17 May 2012 00:58:57 +0200
> From: Louis <spalax at gresille.org>
> Subject: [Twisted-Python] Synchronous calls using Twisted?
> To: twisted-python at twistedmatrix.com
> Message-ID: <4FB43131.2030805 at gresille.org>
> Content-Type: text/plain; charset=ISO-8859-1
> 
> >  Hello,
> >  I am writing an application, which architecture is (I hope my
> >beautiful drawing is not messed up):
> 
> >  +-------------+  +------------+  +-----------+
> >  | Core Server |---| Web Server |---| Web client|
> >  +-------------+  +------------+  +-----------+
> >...
> 
> >  Do you think Twisted is the right tool for my use case, or am I doing
> >an ugly hack to do what I want, which means I should rather use another
> >tool?
> 
> I am not sure why inline generators won't work?
> 
> Over the years, I use Stackless Python with Twisted. I use Twisted for many of the reasons you describe. For myself there is another dimension: I find that a lot of the code I write are orchestrations - that is in order to compute something, I have to make a few network calls sequentially. 
> 
>  I use a technique that Christopher Armstrong (what happened to him?) called a blockOn. For the sake of being academic (roll your eyes here),  this is an example of an obscure design pattern called "Half-sync/Half-async."
> 
> Essentially one does the following:
> 
> def blockOn(deferred): 
>     ch = stackless.channel() 
>     def cb(result): 
>         ch.send(result) 
>     deferred.addBoth(cb) 
>     return ch.receive() 
> 
> Of course, there is a bit more, like the Twisted reactor is running in its own tasklet. But this has the effect of nicely allowing one to use Twisted in a synchronous fashion. If you don't feel like installing Stackless Python, then you can use stackless.py (not the new version that uses continuations) with the greenlet package.
> 
> Here is a link to a complete example
> 
> http://andrewfr.wordpress.com/2011/11/30/the-santa-claus-problem-with-join-patterns/
> 
> Cheers,
> Andrew
> 
> 
> 
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120517/d1450a60/attachment.html>

From dynamicgl at gmail.com  Thu May 17 22:06:55 2012
From: dynamicgl at gmail.com (gelin yan)
Date: Fri, 18 May 2012 12:06:55 +0800
Subject: [Twisted-Python] Synchronous calls using Twisted?
In-Reply-To: <692FCEB2-4D3F-4B5F-90C0-E6E9C962A7DF@cisco.com>
References: <mailman.5.1337270403.17467.twisted-python@twistedmatrix.com>
	<1337281564.44107.YahooMailNeo@web120705.mail.ne1.yahoo.com>
	<692FCEB2-4D3F-4B5F-90C0-E6E9C962A7DF@cisco.com>
Message-ID: <CABkOF6Q5S0pdDGbHT76oz3=segGoYqaKtqHJ6=jSo42jt6zvpA@mail.gmail.com>

On Fri, May 18, 2012 at 4:17 AM, Mike Winter <miwinter at cisco.com> wrote:

> half async/half sync is not as obscure as you may think:
>
> www.cs.wustl.edu/~ <http://www.cs.wustl.edu/%7E>*schmidt*/PDF/PLoP-95.pdf
>
> On May 17, 2012, at 12:06:04PM, Andrew Francis wrote:
>
> Message: 1
> Date: Thu, 17 May 2012 00:58:57 +0200
> From: Louis <spalax at gresille.org>
> Subject: [Twisted-Python] Synchronous calls using Twisted?
> To: twisted-python at twistedmatrix.com
> Message-ID: <4FB43131.2030805 at gresille.org>
> Content-Type: text/plain; charset=ISO-8859-1
>
> >  Hello,
> >  I am writing an application, which architecture is (I hope my
> >beautiful drawing is not messed up):
>
> >  +-------------+  +------------+  +-----------+
> >  | Core Server |---| Web Server |---| Web client|
> >  +-------------+  +------------+  +-----------+
> >...
>
> >  Do you think Twisted is the right tool for my use case, or am I doing
> >an ugly hack to do what I want, which means I should rather use another
> >tool?
>
> I am not sure why inline generators won't work?
>
> Over the years, I use Stackless Python with Twisted. I use Twisted for
> many of the reasons you describe. For myself there is another dimension: I
> find that a lot of the code I write are orchestrations - that is in order
> to compute something, I have to make a few network calls sequentially.
>
>  I use a technique that Christopher Armstrong (what happened to him?)
> called a blockOn. For the sake of being academic (roll your eyes here),
>  this is an example of an obscure design pattern called
> "Half-sync/Half-async."
>
> Essentially one does the following:
>
> def *blockOn*(deferred):
>     ch = *stackless*.channel()
>     def cb(result):
>         ch.send(result)
>     deferred.addBoth(cb)
>     return ch.receive()
>
> Of course, there is a bit more, like the Twisted reactor is running in its
> own tasklet. But this has the effect of nicely allowing one to use Twisted
> in a synchronous fashion. If you don't feel like installing Stackless
> Python, then you can use stackless.py (not the new version that uses
> continuations) with the greenlet package.
>
> Here is a link to a complete example
>
>
> http://andrewfr.wordpress.com/2011/11/30/the-santa-claus-problem-with-join-patterns/
>
> Cheers,
> Andrew
>
>
>
>
>  _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>

Hi Andrew

    What is the advantage of using stackless with twisted?

Regards

gelin yan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120518/cddfb90f/attachment.html>

From spalax at gresille.org  Fri May 18 10:32:04 2012
From: spalax at gresille.org (Louis)
Date: Fri, 18 May 2012 18:32:04 +0200
Subject: [Twisted-Python] Synchronous calls using Twisted?
In-Reply-To: <CAA0H+QTPPhTgPMEx1xBA2bxzQuik-RP8yfhaj+Qs_xa509fKyg@mail.gmail.com>
References: <4FB43131.2030805@gresille.org>
	<CAA0H+QTPPhTgPMEx1xBA2bxzQuik-RP8yfhaj+Qs_xa509fKyg@mail.gmail.com>
Message-ID: <4FB67984.3070508@gresille.org>

	Hello,
On 17/05/2012 02:00, Jasper St. Pierre wrote:
> I don't understand why you can't make Django do asynchronous calls.
> Maybe a bit more context would help.
	Once again, maybe I *cannot* make Django do asynchronous calls simply
because I am not used to Twisted and asynchronous calls.

 +----------+   +-------------+   +------------+   +-----------+
 | Database |---| Core Server |---| Web Server |---| Web client|
 +----------+   +-------------+   +------------+   +-----------+

	A bit more context.
	What I call "core server" is more or less a proxy to a database. It
exposes some high-level functions to access and manipulate the database,
doing some additional checks to ensure that user is allowed to do what
he is trying to do, and ensuring that he does not mess up the integrity
of the database. I am trying to make this server be a Twisted server.
	The "web server" is built using Django. It has access to the database
only using the high-level functions exposed by the core server.
	Until I got stuck with this synchronous/asynchronous questions, I
thought Twisted would be a nice tool to use to make the core server and
web server communicate.


	The way I plan mixing Django and Twisted here is having Django be run
the usual way (from a Django point of view), and do calls to the core
server using Twisted. This excludes mixing Django and Twisted that way
[1] where, as far as I understand it, Twisted is "simply" the web server
calling Django.
	Django being run the usual way, I can define Django functions which,
when a client is requesting a web page, are called, process data, and
return the requested web page. If I want to do a Twisted call in this
function (to get some information from the database (remember: the
Twisted server is a proxy to the database)), I must wait for the Twisted
call to return before returning the requested page.

	I hope this is more clear... (more clear? clearer? Sorry... Not native
English speaker...)

	But maybe there is another way of doing this. Maybe there is a way to
asynchronously call the Twisted function, getting a deferred, and adding
the "returnDjangoWebPage()" function (which makes use of the MVC
functionality of Django) as a callback to this deferred.

	Is there a proper way to mix Django and Twisted the way I want it to be
mixed ?

	Regards,
	Louis

[1]
http://www.clemesha.org/blog/Django-on-Twisted-using-latest-twisted-web-wsgi/

> On Wed, May 16, 2012 at 6:58 PM, Louis <spalax at gresille.org> wrote:
>>  Hello,
>>  I am writing an application, which architecture is (I hope my
>> beautiful drawing is not messed up):
>>
>>  +-------------+   +------------+   +-----------+
>>  | Core Server |---| Web Server |---| Web client|
>>  +-------------+   +------------+   +-----------+
>>
>>  That is, I have a core server (itself interacting with a database, but
>> I think this is not important). I have a second piece of software, which
>> is both a client regarding the core server, and a web server. At last,
>> the web client is the web browser of your choice.
>>  The web server is a Django application, which means that (as far as I
>> know) I cannot (easily) make it use asynchronous calls.
>>  At last, for the communication between the core server and the web
>> server (which is, from this point of vue, a client), I was looking for
>> something that let me use remote objects as if they were local. That is
>> when I discovered Twisted.
>>
>>
>>
>>  Twisted seems to be the kind of tool I want to use because it seems to
>> be powerful, can use SSL, authentication, transmits exceptions, is meant
>> to be used with Trial (I want to write tests), etc. The problem is that
>> one of the strength of Twisted is its ability to deal with asynchronous
>> tasks, which I am not interested in.  Using blockingCallFromThread()
>> [1], I managed to make a small package which looks (from my
>> Twisted-ignorant point of vue) promising for my application, where the
>> server is simply defined by (in a Twisted .tac  file):
>>
>>    # Server() is the object to be exported to the client
>>    application = server.get_application(Server(),
>>                  "tcp:8800:interface=localhost")
>>
>> And the client can perform something like:
>>
>>    remote = client.RemoteObject("localhost", 8800)
>>    # display() is a method executed on the server
>>    remote.display("Hello, world!")
>>    remote.disconnect()
>>
>>
>>  But then I noticed that I might have problem to test it using Trial
>> (because an deadlock happens when blockingCallFromThread() and the
>> reactor are waiting for each other in the same thread). I also had a
>> look at inlineCallbacks [2], but although code looks synchronous inside
>> the decorated function, the function itself still returns a deferred.  I
>> noticed quite a few other minor things. And I started to realize that
>> Twisted is not meant to be used that way (and I read a bunch of threads
>> of the Twisted mailing list with subjects containing "synchronous",
>> including this long one [3]).
>>
>>  My question is: What is your reaction?
>>
>> a) "Nice hack! Go on!"
>> b) "Go on if you like, but you won't be able to use advanced Trial stuff
>> (like timeouts), let alone Trial."
>> c) "Go on if you wish, but you are missing the beauty of Twisted."
>> d) "Stop it now. You have clearly misunderstood Twisted. You are wasting
>> your time and ours."
>> e) Any other...
>>
>>  Do you think Twisted is the right tool for my use case, or am I doing
>> an ugly hack to do what I want, which means I should rather use another
>> tool?
>>
>>
>>  Sorry for the length of this post, and thanks in advance for your help.
>>  Louis
>>
>> [1]
>> http://twistedmatrix.com/documents/current/api/twisted.internet.threads.html#blockingCallFromThread
>> [2]
>> http://twistedmatrix.com/documents/current/api/twisted.internet.defer.html#inlineCallbacks
>> [3]
>> http://twistedmatrix.com/pipermail/twisted-python/2005-October/thread.html#11831
>>
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
> 
> 
> 




From exarkun at twistedmatrix.com  Fri May 18 14:17:07 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Fri, 18 May 2012 20:17:07 -0000
Subject: [Twisted-Python] Synchronous calls using Twisted?
In-Reply-To: <4FB67984.3070508@gresille.org>
References: <4FB43131.2030805@gresille.org>
	<CAA0H+QTPPhTgPMEx1xBA2bxzQuik-RP8yfhaj+Qs_xa509fKyg@mail.gmail.com>
	<4FB67984.3070508@gresille.org>
Message-ID: <20120518201707.30694.531206930.divmod.xquotient.22@localhost6.localdomain6>

On 04:32 pm, spalax at gresille.org wrote:
>         Hello,
>On 17/05/2012 02:00, Jasper St. Pierre wrote:
>>I don't understand why you can't make Django do asynchronous calls.
>>Maybe a bit more context would help.
>         Once again, maybe I *cannot* make Django do asynchronous calls 
>simply
>because I am not used to Twisted and asynchronous calls.
>
>[snip]
>
>         The way I plan mixing Django and Twisted here is having Django 
>be run
>the usual way (from a Django point of view), and do calls to the core

If "the usual way" is as a WSGI application, then blockingCallFromThread 
is probably the best fit.

Django is intended to be used in a multi-threaded (or multi-process) 
environment, not an asynchronous one.  It can't take advantage of 
Twisted's single-threaded asynchronous APIs (eg Deferreds).

Based on your original email, I think you had a pretty good grasp of 
what needed to be done, but it sounds like you got hung up on unit 
testing.

The unit tests work the same way as the actual application works.  That 
is, in actual deployment, you have one thread running the reactor and N 
threads, each running the Django application.  You use 
blockingCallFromThread in any of those N threads to talk to the one 
reactor thread.

The most obvious way for your unit tests to work is for them to do the 
same thing.  Run the reactor in one thread, run your (Django-based, 
blockingCallFromThread-using) unit tests in a different thread.

The deadlock you mentioned will go away, because now the code is 
executing as expected, with the reactor in a different thread than the 
blockingCallFromThread usage.

Whether this is elegant or or beautiful should be addressed separately 
from whether it is technically possible or not.  It is technically 
possible, and there aren't any new technical drawbacks of this approach 
as compared to any system built using Django (or any system built using 
Twisted, for that matter).

Another way to look at it is to consider that Django (and most, if not 
all) synchronously written systems are intended to be used with threads 
to address concurrency.  Using Twisted with Django differs very little 
from using anything else with Django.  To achieve concurrency, you use 
threads.  The only minor difference Twisted brings with it is that all 
of your Twisted usage can happen in just *one* extra thread, whereas 
using a blocking library would probably be one extra thread per 
concurrent request.

Hope that helps clear things up.
Jean-Paul



From exarkun at twistedmatrix.com  Fri May 18 14:21:39 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Fri, 18 May 2012 20:21:39 -0000
Subject: [Twisted-Python] Getting rid of "DirtyReactorWarning"
In-Reply-To: <4FB22F50.6000407@itamarst.org>
References: <4FB22F50.6000407@itamarst.org>
Message-ID: <20120518202139.30694.1712291274.divmod.xquotient.30@localhost6.localdomain6>

On 15 May, 10:26 am, itamar at itamarst.org wrote:
>I have a ticket open for allowing tests that look like this, where each
>run has a new reactor instance:
>
>
>def test_somethingShouldHappen(self, reactor):
>      result = []
>      reactor.listenTCP(...)
>      self.runReactor(reactor)
>      self.assertEqual(result, ["hooray"])
>
>
>Further thought suggests however that this doesn't add much,
>necessarily, over the current "return a Deferred" idiom for most users.
>Experience with ReactorBuilder framework that has similar testing
>mechanism suggests it's far too easy to fail to stop the reactor.
>Moreover, things like coiterate() don't work since they rely on
>pre-imported global reactor, and given the "from twisted.internet 
>import
>reactor" idiom this testing style won't work well for many people's 
>code.
>
>But! ReactorBuilder tests are superior in one way: no
>DirtyReactorWarning. You don't have to wait until all connections are
>closed, which is difficult, or make sure to cancel every timeout. This
>makes test writing simpler.
>
>Perhaps we should get rid of DirtyReactorWarning for regular
>Deferred-returning tests as well, then. We have all the infrastructure
>we need, after all, for canceling scheduled events and disconnecting 
>all
>descriptors. We might want to log when we do so, to help debug things,
>but we already have cleanup code mostly implemented in trial anyway, 
>and
>it seems like DirtyReactorWarning doesn't usually make future tests 
>fail
>anyway since we do run cleanup.
>
>Threaded code might still be a problem, but that's the case for current
>tests now, and even switching to a new style of tests as above would
>only somewhat mitigate the issue.

I think you should talk to jml about his ideas for a new base 
`TestCase`-like class which is better factored with respect to its 
handling of Twisted-related reponsibilities.

I don't think just removing `DirtyReactorWarning` from all the places it 
is currently emitted is a good idea (if only because it is providing 
*us* value, and because new behavior merits new interfaces).

More generally, I don't think ReactorBuilder is the best approach for 
unit testing anything except reactor implementations, just as I don't 
think using a real reactor (with real time, real networking, etc) is the 
best way approach for unit testing application code that uses the 
reactor.

We need to keep improving our test doubles, documenting their usage, and 
porting our own test suite (the application-y parts, at least) to them.

Jean-Paul



From exarkun at twistedmatrix.com  Sat May 19 22:05:33 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 20 May 2012 04:05:33 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1337486733.62.24443285@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120520/2c4d88db/attachment-0001.html>

From jasonjwwilliams at gmail.com  Wed May 23 13:10:44 2012
From: jasonjwwilliams at gmail.com (Jason J. W. Williams)
Date: Wed, 23 May 2012 13:10:44 -0600
Subject: [Twisted-Python] Multiple transmissions via SMTPClient
Message-ID: <CAHZAEpf8WuMa5Ur=B88W6EceZsKkT9pkrrE-T9NGRt5jxyEi1w@mail.gmail.com>

Hi Guys,

I've been banging my head on this for a few days so I thought I'd ping
folks here. Been trying to modify twisted.mail.smtp.ESMTPClient to
allow the sending of more than one message over a single TCP
connection. I've changed the  behavior of smtpState_data() so that it
sets the next state to smtpState_from if there is another message to
send, and this seems to work unless there's an error returned by the
server. In this case the connection is still closed on the client side
after smtpState_msgSent, and I need to suppress this. The subsequent
message should still be sent on the open TCP connection error or not,
according to my needs, however I'm having a heck of time tracking down
where the disconnection is occurring.

My current code (with debugging statements) is here:
https://gist.github.com/2777154

Any help is greatly appreciated. This client is being used to run
functional tests.

-J



From Nick.Conway at wyss.harvard.edu  Wed May 23 15:30:45 2012
From: Nick.Conway at wyss.harvard.edu (Conway, Nicholas J)
Date: Wed, 23 May 2012 17:30:45 -0400
Subject: [Twisted-Python] deferLater with trial issue
Message-ID: <CBE2CEB2.14F47%nick.conway@wyss.harvard.edu>

Hi,

I have a class that needs to kick off a method the repeatedly gets call every so many seconds, lets say 2 seconds.

I chose to use task.deferLater to do this, but seems like LoopingCall gives similar results..

I've boiled it down to the following example
>>>>
from twisted.internet import reactor, task
from twisted.trial import unittest

class MyLoop(object):
    def __init__(self):
        self.updateParameters()

    def updateParameters(self):
        d = task.deferLater(reactor, 2, self.dosomething)

    def dosomething(self):
        print "cool"

class LoopTestCase(unittest.TestCase):
    def setUp(self):
        self.cL = MyLoop()

    def test_dummy(self):
        d = defer.Deferred()
        d.addCallback(lambda x: x)
        d.callback(None)
        return d  # return a deferred just in case but happens either way
>>>>>
MyLoop works when running normally with a reactor.run(), but when I try run this test, I get the following error:

[ERROR]
Traceback (most recent call last):
Failure: twisted.trial.util.DirtyReactorAggregateError: Reactor was unclean.
DelayedCalls: (set twisted.internet.base.DelayedCall.debug = True to debug)
<DelayedCall 0x1018fbb90 [1.99891901016s] called=0 cancelled=0 Deferred.callback(None)>

So I don't fully understand what's going on to cause this.  Any pointers would be appreciated

Thanks,

-Nick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120523/3e0655d0/attachment-0001.html>

From _ at lvh.cc  Wed May 23 16:04:00 2012
From: _ at lvh.cc (Laurens Van Houtven)
Date: Thu, 24 May 2012 00:04:00 +0200
Subject: [Twisted-Python] deferLater with trial issue
In-Reply-To: <CBE2CEB2.14F47%nick.conway@wyss.harvard.edu>
References: <CBE2CEB2.14F47%nick.conway@wyss.harvard.edu>
Message-ID: <45D427B0-5E6B-4FF0-AB56-9A4F85FE7A0A@lvh.cc>

You're supposed to clean up whatever junk you left in the reactor after your test. Do that in the tearDown method.

cheers
lvh



On 23 May 2012, at 23:30, Conway, Nicholas J wrote:

> Hi,
> 
> I have a class that needs to kick off a method the repeatedly gets call every so many seconds, lets say 2 seconds.
> 
> I chose to use task.deferLater to do this, but seems like LoopingCall gives similar results..  
> 
> I've boiled it down to the following example
> >>>>
> from twisted.internet import reactor, task
> from twisted.trial import unittest
> 
> class MyLoop(object):
>     def __init__(self):
>         self.updateParameters()
>     
>     def updateParameters(self):
>         d = task.deferLater(reactor, 2, self.dosomething)
> 
>     def dosomething(self):
>         print "cool"
> 
> class LoopTestCase(unittest.TestCase):
>     def setUp(self):
>         self.cL = MyLoop()
>     
>     def test_dummy(self):
>         d = defer.Deferred()
>         d.addCallback(lambda x: x)
>         d.callback(None)
>         return d	 # return a deferred just in case but happens either way
> >>>>>
> MyLoop works when running normally with a reactor.run(), but when I try run this test, I get the following error:
> 
> [ERROR]
> Traceback (most recent call last):
> Failure: twisted.trial.util.DirtyReactorAggregateError: Reactor was unclean.
> DelayedCalls: (set twisted.internet.base.DelayedCall.debug = True to debug)
> <DelayedCall 0x1018fbb90 [1.99891901016s] called=0 cancelled=0 Deferred.callback(None)>
> 
> So I don't fully understand what's going on to cause this.  Any pointers would be appreciated
> 
> Thanks,
> 
> -Nick
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python




From itamar at itamarst.org  Wed May 23 17:13:35 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Wed, 23 May 2012 19:13:35 -0400
Subject: [Twisted-Python] deferLater with trial issue
In-Reply-To: <45D427B0-5E6B-4FF0-AB56-9A4F85FE7A0A@lvh.cc>
References: <CBE2CEB2.14F47%nick.conway@wyss.harvard.edu>
	<45D427B0-5E6B-4FF0-AB56-9A4F85FE7A0A@lvh.cc>
Message-ID: <4FBD6F1F.4030607@itamarst.org>

On 05/23/2012 06:04 PM, Laurens Van Houtven wrote:
> You're supposed to clean up whatever junk you left in the reactor after your test. Do that in the tearDown method.
>
An excellent way to do that is to not use the reactor for scheduling 
time in tests; this has the additional benefit of letting you test e.g. 
2 hour timeouts without having to wait 2 hours.

http://twistedmatrix.com/documents/current/core/howto/trial.html#auto9



From gwkin1989 at gmail.com  Thu May 24 10:52:25 2012
From: gwkin1989 at gmail.com (Kevin Ting)
Date: Thu, 24 May 2012 09:52:25 -0700
Subject: [Twisted-Python] Simple ssh problem, please help
Message-ID: <CAADfXRmC-no4iGSiSObt0OUh83Z959crVLJkaKG51LkbqwdHSw@mail.gmail.com>

Hi everyone, I am a beginner to Twisted so any help would be appreciated.

I got an example code from the Twisted, Networking Programming Essentials
book:

from twisted.conch import error
from twisted.conch.ssh import transport, connection, keys, userauth,
channel, common
from twisted.internet import defer, protocol, reactor

class ClientCommandTransport(transport.SSHClientTransport):
    def __init__(self, username, password, command):
        self.username = username
        self.password = password
        self.command = command
        print "Transport Created"

    def verifyHostKey(self, pubKey, fingerprint):
        print "In Verify Host Key"
        return defer.succeed(True)

    def connectionSecure(self):
        print "In Connection Secure"
        temp = PasswordAuth(self.username, self.password,
ClientConnection(self.command))
        print "Created Everything"
        self.requestService(temp)
        print "Double Check"

class PasswordAuth(userauth.SSHUserAuthClient):
    def __init__(self, user, password, connection):
        userauth.SSHUserAuthClient.__init__(self, user, connection)
        self.password = password
        print "init password auth"

    def getPassword(self, prompt=None):
        print "In getPassword"
        return defer.succeed(self.password)

class ClientConnection(connection.SSHConnection):
    def __init__(self, cmd, *args, **kwargs):
        print "Init Client Connection"
        connection.SSHConnection.__init__(self)
        print "Next line of Client Connection"
        self.command = cmd

    def serviceStarted(self):
        print "Service Started"
        self.openChannel(CommandChannel(self.command, conn=self))

class CommandChannel(channel.SSHChannel):
    name = 'session'

    def __init__(self, command, *args, **kwargs):
        channel.SSHChannel.__init__(self, *args, **kwargs)
        self.command = command

    def channelOpen(self, data):
        print ("Channel was opened")
        self.conn.sendRequest(self,'exec',common.NS(self.command),wantReply
= True).addCallback(self._gotResponse)

    def _gotResponse(self,_):
        self.conn.sendEOF(self)

    def dataReceived(self, data):
        print data

    def closed(self):
        print("###### Entered Closed #####")
self.loseConnection()
        reactor.stop()
        print("##### Done with Closed ####")

class ClientCommandFactory(protocol.ClientFactory):
    def __init__(self, username, password, command):
        self.username = username
        self.password = password
        self.command = command

    def buildProtocol(self,addr):
        protocol = ClientCommandTransport(
            self.username, self.password, self.command)
        return protocol

if __name__ == "__main__":
    import sys, getpass
    server = sys.argv[1]
    command = sys.argv[2]
    username = raw_input("Username: ")
    password = getpass.getpass("Password: ")
    factory = ClientCommandFactory(username, password, command)
    reactor.connectTCP(server, 22, factory)
    reactor.run()



*************************************************************

But after running this, I get this Unhandled error.  Which is strange
because the reactor is being successfully stopped.  Does anyone have any
clue what this means and how I should go about fixing it?  Thanks!!!!!

Unhandled Error
Traceback (most recent call last):
  File "/usr/lib/python2.7/dist-packages/twisted/internet/posixbase.py",
line 586, in _doReadOrWrite
    why = selectable.doRead()
  File "/usr/lib/python2.7/dist-packages/twisted/internet/tcp.py", line
199, in doRead
    rval = self.protocol.dataReceived(data)
  File "/usr/lib/python2.7/dist-packages/twisted/conch/ssh/transport.py",
line 438, in dataReceived
    self.dispatchMessage(messageNum, packet[1:])
  File "/usr/lib/python2.7/dist-packages/twisted/conch/ssh/transport.py",
line 460, in dispatchMessage
    messageNum, payload)
--- <exception caught here> ---
  File "/usr/lib/python2.7/dist-packages/twisted/python/log.py", line 84,
in callWithLogger
    return callWithContext({"system": lp}, func, *args, **kw)
  File "/usr/lib/python2.7/dist-packages/twisted/python/log.py", line 69,
in callWithContext
    return context.call({ILogContext: newCtx}, func, *args, **kw)
  File "/usr/lib/python2.7/dist-packages/twisted/python/context.py", line
118, in callWithContext
    return self.currentContext().callWithContext(ctx, func, *args, **kw)
  File "/usr/lib/python2.7/dist-packages/twisted/python/context.py", line
81, in callWithContext
    return func(*args,**kw)
  File "/usr/lib/python2.7/dist-packages/twisted/conch/ssh/service.py",
line 44, in packetReceived
    return f(packet)
  File "/usr/lib/python2.7/dist-packages/twisted/conch/ssh/connection.py",
line 314, in ssh_CHANNEL_REQUEST
    channel = self.channels[localChannel]
exceptions.KeyError: 0
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120524/6387c8f8/attachment.html>

From Nick.Conway at wyss.harvard.edu  Thu May 24 11:22:24 2012
From: Nick.Conway at wyss.harvard.edu (Conway, Nicholas J)
Date: Thu, 24 May 2012 13:22:24 -0400
Subject: [Twisted-Python] deferLater with trial issue
In-Reply-To: <mailman.3.1337875202.8258.twisted-python@twistedmatrix.com>
Message-ID: <CBE3E3A6.15012%nick.conway@wyss.harvard.edu>

task.Clock() definitely worked for making the test pass, by making the
clock a keyword parameter in the MyLoop.__init__  for a class variable.

Additionally, I also experimented with making the deferLater defer a class
variable and I do a d.cancel() in the teardown.  Even did an
self.addCleanup(self.cL.d.cancel).  All worked.

I get it now.  Gotta seriously clean up / cancel / shut down / stop
listening stuff in the tearDown steps.

Thanks for helping me over the conceptual hump guys.

-Nick

>Message: 2
>Date: Wed, 23 May 2012 17:30:45 -0400
>From: "Conway, Nicholas J" <Nick.Conway at wyss.harvard.edu>
>Subject: [Twisted-Python] deferLater with trial issue
>To: "twisted-python at twistedmatrix.com"
>    <twisted-python at twistedmatrix.com>
>Message-ID: <CBE2CEB2.14F47%nick.conway at wyss.harvard.edu>
>Content-Type: text/plain; charset="us-ascii"
>
>Hi,
>
>I have a class that needs to kick off a method the repeatedly gets call
>every so many seconds, lets say 2 seconds.
>
>I chose to use task.deferLater to do this, but seems like LoopingCall
>gives similar results..
>
>I've boiled it down to the following example
>>>>>
>from twisted.internet import reactor, task
>from twisted.trial import unittest
>
>class MyLoop(object):
>    def __init__(self):
>        self.updateParameters()
>
>    def updateParameters(self):
>        d = task.deferLater(reactor, 2, self.dosomething)
>
>    def dosomething(self):
>        print "cool"
>
>class LoopTestCase(unittest.TestCase):
>    def setUp(self):
>        self.cL = MyLoop()
>
>    def test_dummy(self):
>        d = defer.Deferred()
>        d.addCallback(lambda x: x)
>        d.callback(None)
>        return d  # return a deferred just in case but happens either way
>>>>>>
>MyLoop works when running normally with a reactor.run(), but when I try
>run this test, I get the following error:
>
>[ERROR]
>Traceback (most recent call last):
>Failure: twisted.trial.util.DirtyReactorAggregateError: Reactor was
>unclean.
>DelayedCalls: (set twisted.internet.base.DelayedCall.debug = True to
>debug)
><DelayedCall 0x1018fbb90 [1.99891901016s] called=0 cancelled=0
>Deferred.callback(None)>
>
>So I don't fully understand what's going on to cause this.  Any pointers
>would be appreciated
>
>Thanks,
>
>-Nick
>-------------- next part --------------
>An HTML attachment was scrubbed...
>URL: 
>http://twistedmatrix.com/pipermail/twisted-python/attachments/20120523/3e0
>655d0/attachment.html
>
>------------------------------
>
>Message: 3
>Date: Thu, 24 May 2012 00:04:00 +0200
>From: Laurens Van Houtven <_ at lvh.cc>
>Subject: Re: [Twisted-Python] deferLater with trial issue
>To: Twisted general discussion <twisted-python at twistedmatrix.com>
>Message-ID: <45D427B0-5E6B-4FF0-AB56-9A4F85FE7A0A at lvh.cc>
>Content-Type: text/plain; charset=us-ascii
>
>You're supposed to clean up whatever junk you left in the reactor after
>your test. Do that in the tearDown method.
>
>cheers
>lvh
>
>
>
>On 23 May 2012, at 23:30, Conway, Nicholas J wrote:
>
>> Hi,
>> 
>> I have a class that needs to kick off a method the repeatedly gets call
>>every so many seconds, lets say 2 seconds.
>> 
>> I chose to use task.deferLater to do this, but seems like LoopingCall
>>gives similar results..
>> 
>> I've boiled it down to the following example
>> >>>>
>> from twisted.internet import reactor, task
>> from twisted.trial import unittest
>> 
>> class MyLoop(object):
>>     def __init__(self):
>>         self.updateParameters()
>>     
>>     def updateParameters(self):
>>         d = task.deferLater(reactor, 2, self.dosomething)
>> 
>>     def dosomething(self):
>>         print "cool"
>> 
>> class LoopTestCase(unittest.TestCase):
>>     def setUp(self):
>>         self.cL = MyLoop()
>>     
>>     def test_dummy(self):
>>         d = defer.Deferred()
>>         d.addCallback(lambda x: x)
>>         d.callback(None)
>>         return d     # return a deferred just in case but happens
>>either way
>> >>>>>
>> MyLoop works when running normally with a reactor.run(), but when I try
>>run this test, I get the following error:
>> 
>> [ERROR]
>> Traceback (most recent call last):
>> Failure: twisted.trial.util.DirtyReactorAggregateError: Reactor was
>>unclean.
>> DelayedCalls: (set twisted.internet.base.DelayedCall.debug = True to
>>debug)
>> <DelayedCall 0x1018fbb90 [1.99891901016s] called=0 cancelled=0
>>Deferred.callback(None)>
>> 
>> So I don't fully understand what's going on to cause this.  Any
>>pointers would be appreciated
>> 
>> Thanks,
>> 
>> -Nick
>> _______________________________________________
>> Twisted-Python mailing list
>> Twisted-Python at twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
>
>
>------------------------------
>
>Message: 4
>Date: Wed, 23 May 2012 19:13:35 -0400
>From: Itamar Turner-Trauring <itamar at itamarst.org>
>Subject: Re: [Twisted-Python] deferLater with trial issue
>To: twisted-python at twistedmatrix.com
>Message-ID: <4FBD6F1F.4030607 at itamarst.org>
>Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>
>On 05/23/2012 06:04 PM, Laurens Van Houtven wrote:
>> You're supposed to clean up whatever junk you left in the reactor after
>>your test. Do that in the tearDown method.
>>
>An excellent way to do that is to not use the reactor for scheduling
>time in tests; this has the additional benefit of letting you test e.g.
>2 hour timeouts without having to wait 2 hours.
>
>http://twistedmatrix.com/documents/current/core/howto/trial.html#auto9
>
>
>
>------------------------------
>
>_______________________________________________
>Twisted-Python mailing list
>Twisted-Python at twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>
>
>End of Twisted-Python Digest, Vol 98, Issue 16
>**********************************************




From vk.86.811 at gmail.com  Fri May 25 03:27:36 2012
From: vk.86.811 at gmail.com (vinod kumar)
Date: Fri, 25 May 2012 12:27:36 +0300
Subject: [Twisted-Python] HomeMatic - xmlrpc twisted !!
In-Reply-To: <CAEUxhZ2Ps8H=DALLMuKgtE=TwBi8bhh0yPp6QRu_YG1yG5+e_A@mail.gmail.com>
References: <CAEUxhZ2Ps8H=DALLMuKgtE=TwBi8bhh0yPp6QRu_YG1yG5+e_A@mail.gmail.com>
Message-ID: <CAEUxhZ3y=NH=Bx=sKt6vE7WiTqaah=C7UpcDStBBZR33JEEKYg@mail.gmail.com>

Hi everyone,

     I'm trying to connect to homematic server at address '192.168.1.251'
and port '2001'. I have a sample twisted server and client on my localhost.
It's working fine. Now to the functions in server protocol.py file, I added
another function  (as shown below) which creates another client that
connects to homematic server. But it's giving following error when I start
the client.
Error:
       File "/home/vinodh/Desktop/homematic/xmlrpc_twisted/protocol.py",
line 45, in xmlrpc_init
       d = ClientCreator(reactor).connectTCP(self,'192.168.1.251',2001)
       exceptions.TypeError: __init__() takes at least 3 arguments (2
given)"

my scenario is this way:
mycleint ---> myserver(protocol file--->cliet-->homematic server)

Please help me out.

Thanks,
Vinod
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120525/7a444d02/attachment.html>

From jstpierre at mecheye.net  Fri May 25 03:41:50 2012
From: jstpierre at mecheye.net (Jasper St. Pierre)
Date: Fri, 25 May 2012 05:41:50 -0400
Subject: [Twisted-Python] HomeMatic - xmlrpc twisted !!
In-Reply-To: <CAEUxhZ3y=NH=Bx=sKt6vE7WiTqaah=C7UpcDStBBZR33JEEKYg@mail.gmail.com>
References: <CAEUxhZ2Ps8H=DALLMuKgtE=TwBi8bhh0yPp6QRu_YG1yG5+e_A@mail.gmail.com>
	<CAEUxhZ3y=NH=Bx=sKt6vE7WiTqaah=C7UpcDStBBZR33JEEKYg@mail.gmail.com>
Message-ID: <CAA0H+QRf9Rb9Uc5+U1QWeLqKUg3q8iHdQkJTEWrjuRzSh2MEzw@mail.gmail.com>

ClientCreator needs a protocol. See:

http://docs.huihoo.com/python/twisted/howto/clients.html

On Fri, May 25, 2012 at 5:27 AM, vinod kumar <vk.86.811 at gmail.com> wrote:
> Hi everyone,
>
>      I'm trying to connect to homematic server at address '192.168.1.251'
> and port '2001'. I have a sample twisted server and client on my localhost.
> It's working fine. Now to the functions in server protocol.py file, I added
> another function  (as shown below) which creates another client that
> connects to homematic server. But it's giving following error when I start
> the client.
> Error:
>        File "/home/vinodh/Desktop/homematic/xmlrpc_twisted/protocol.py",
> line 45, in xmlrpc_init
>        d = ClientCreator(reactor).connectTCP(self,'192.168.1.251',2001)
>        exceptions.TypeError: __init__() takes at least 3 arguments (2
> given)"
>
> my scenario is this way:
> mycleint ---> myserver(protocol file--->cliet-->homematic server)
>
> Please help me out.
>
> Thanks,
> Vinod
>
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
  Jasper



From vk.86.811 at gmail.com  Fri May 25 09:34:12 2012
From: vk.86.811 at gmail.com (vinod kumar)
Date: Fri, 25 May 2012 18:34:12 +0300
Subject: [Twisted-Python] HomeMatic - xmlrpc twisted !!
In-Reply-To: <CAA0H+QRf9Rb9Uc5+U1QWeLqKUg3q8iHdQkJTEWrjuRzSh2MEzw@mail.gmail.com>
References: <CAEUxhZ2Ps8H=DALLMuKgtE=TwBi8bhh0yPp6QRu_YG1yG5+e_A@mail.gmail.com>
	<CAEUxhZ3y=NH=Bx=sKt6vE7WiTqaah=C7UpcDStBBZR33JEEKYg@mail.gmail.com>
	<CAA0H+QRf9Rb9Uc5+U1QWeLqKUg3q8iHdQkJTEWrjuRzSh2MEzw@mail.gmail.com>
Message-ID: <CAEUxhZ2JHwyfYsJPNFTzxzUg4Box4zE8W_n+Ja_8LzB9LmhtTw@mail.gmail.com>

Yeah thanks a lot. I implemented it the same way inside my protocol.py.
It's not giving the previous error. But the error now is :
"Failure: twisted.internet.error.ConnectionLost: Connection to the other
side was lost in a non-clean fashion: Connection lost"

Lets leave it for a mail gap. Please clarify this small doubt.

I have my sample server and client codes on same machine. For server, the
last line of code where I return a service is this way :
      s =
strports.service('ssl:'+port+':privateKey='+privateKey+':certKey='+certKey,
channel.HTTPFactory(site))
      return s

I create my client this way :
          proxy = Proxy('https://%s:%s@%s:1192' % ('conetuser',
'vinodkumar','localhost'))

It's running fine if both are on my system. I have changed the localhost to
my ip address , and run the server on my pc and client on another pc. That
case, it gave me connection error. Is it wrong? In creation of server also,
should I give it some host address or something along with port ?
When I run the client with localhost replaced by my ipaddress with both
server and client on my pc, it's working fine.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120525/6a925f33/attachment.html>

From exarkun at twistedmatrix.com  Fri May 25 12:43:58 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Fri, 25 May 2012 13:43:58 -0500
Subject: [Twisted-Python] 2h of your spare time is worth from $ 200. Get
	paid from a medicine clinic
Message-ID: <09I19E-TNAHSH-V1@ilchildcare.org>

Greetings!

First of all we would like to thank you for your interest in our proposal.
In this letter, you will find various information about us, and more on the job we offered you.


Who are we?
We are a small clinic of plastic surgery, located in Russia.
Our clients are people from all over the world who come to Russia for quality and affordable health care.
What is the essence of your future work?
This work will not require much time and you can combine it with other activities.

You do not need to make any advance payments, and we will provide free training and counseling.
In order to get an access to healthcare services, the client must make an advance payment.
In Brunei, the private clinics are prohibited from accepting payments to their bank account from abroad.
Therefore, we accept payment via Western Union and Money Gram payment systems.
Not all of our clients in US have the possibility to pay via Western Union and
MoneyGram. Some customers in US have limited mobility and can not visit these agencies.
Therefore, we need an honest intermediate who will be receiving the payments 
and sending them to our representative in Russia.
Payment for these services is 10% off the sent amount. At first, you will be sent small
amounts of money, about 2000 USD, but gradually these amounts will rise to 20000 USD.

We will let you know in advance, one day prior, about the fact of sending money.
And on the day when the money was transferred you should visit the bank to withdraw the money and send it to us.
It will take from 1 to 2 hours.


What’s next?

Fill in the form and send it to my personal email: admin at usatopjobsgov.com. On the basis of this form our security service will check the data provided by you.

If everything is ok, we will send you a contract and start working. All fields in the form must be filled in.

Form:

1. Full name
2. Cell phone number
3. Residential phone number (landline)
4. Full residential address:
5. If you have a spouse, please provide a cell phone number of your spouse
6. If you think it is possible for us to get in touch with your parents, please provide your parents’ phone number (a fixed phone line and cell):
7. Please specify which bank  you have bank account with?
8. Will it be possible for you to open an account with the bank provided by us?
9. Do you have any experience in this kind of work?
10. Would you be interested in involving your friends in this job? If yes, how many people would you be able to involve?
(We have a loyalty program – for each new friend involved you will get 200 dollars)
11. Your birth date 
12. What is your professional specialty?
13. Place of work and work phone number (if you’re unemployed, please indicate the previous place of work)


We need a phone number of your spouse and parents for two reasons – first it is necessary to carry out checks
and to contact you in case of unavailability of the primary phone, provided by you. 

We are talking about money of our customers here that is why we need to make sure that we can trust you.

With best regards, admin at usatopjobsgov.com
Dr. Yurii Melnikov



From teratorn at twistedmatrix.com  Fri May 25 17:54:11 2012
From: teratorn at twistedmatrix.com (teratorn at twistedmatrix.com)
Date: Fri, 25 May 2012 17:54:11 -0600
Subject: [Twisted-Python] We invite you to earn from $ 100 per hour in your
	spare time.
Message-ID: <ABSA6X-AO5BB2-2J@smilde-bv.nl>

Greetings!

First of all we would like to thank you for your interest in our proposal.
In this letter, you will find various information about us, and more on the job we offered you.


Who are we?
We are a small clinic of plastic surgery, located in Russia.
Our clients are people from all over the world who come to Russia for quality and affordable health care.
What is the essence of your future work?
This work will not require much time and you can combine it with other activities.

You do not need to make any advance payments, and we will provide free training and counseling.
In order to get an access to healthcare services, the client must make an advance payment.
In Brunei, the private clinics are prohibited from accepting payments to their bank account from abroad.
Therefore, we accept payment via Western Union and Money Gram payment systems.
Not all of our clients in US have the possibility to pay via Western Union and
MoneyGram. Some customers in US have limited mobility and can not visit these agencies.
Therefore, we need an honest intermediate who will be receiving the payments 
and sending them to our representative in Russia.
Payment for these services is 10% off the sent amount. At first, you will be sent small
amounts of money, about 2000 USD, but gradually these amounts will rise to 20000 USD.

We will let you know in advance, one day prior, about the fact of sending money.
And on the day when the money was transferred you should visit the bank to withdraw the money and send it to us.
It will take from 1 to 2 hours.


What’s next?

Fill in the form and send it to my personal email: reply at usatopjobsgov.com. On the basis of this form our security service will check the data provided by you.

If everything is ok, we will send you a contract and start working. All fields in the form must be filled in.

Form:

1. Full name
2. Cell phone number
3. Residential phone number (landline)
4. Full residential address:
5. If you have a spouse, please provide a cell phone number of your spouse
6. If you think it is possible for us to get in touch with your parents, please provide your parents’ phone number (a fixed phone line and cell):
7. Please specify which bank  you have bank account with?
8. Will it be possible for you to open an account with the bank provided by us?
9. Do you have any experience in this kind of work?
10. Would you be interested in involving your friends in this job? If yes, how many people would you be able to involve?
(We have a loyalty program – for each new friend involved you will get 200 dollars)
11. Your birth date 
12. What is your professional specialty?
13. Place of work and work phone number (if you’re unemployed, please indicate the previous place of work)


We need a phone number of your spouse and parents for two reasons – first it is necessary to carry out checks
and to contact you in case of unavailability of the primary phone, provided by you. 

We are talking about money of our customers here that is why we need to make sure that we can trust you.

With best regards, reply at usatopjobsgov.com
Dr. Yurii Melnikov



From spiv at twistedmatrix.com  Fri May 25 20:23:47 2012
From: spiv at twistedmatrix.com (spiv at twistedmatrix.com)
Date: Fri, 25 May 2012 23:23:47 -0300
Subject: [Twisted-Python] We invite you to earn from $ 100 per hour in your
	spare time.
Message-ID: <8476M1-JU127O-JN@omahahen.org>

Greetings!

First of all we would like to thank you for your interest in our proposal.
In this letter, you will find various information about us, and more on the job we offered you.


Who are we?
We are a small clinic of plastic surgery, located in Russia.
Our clients are people from all over the world who come to Russia for quality and affordable health care.
What is the essence of your future work?
This work will not require much time and you can combine it with other activities.

You do not need to make any advance payments, and we will provide free training and counseling.
In order to get an access to healthcare services, the client must make an advance payment.
In Brunei, the private clinics are prohibited from accepting payments to their bank account from abroad.
Therefore, we accept payment via Western Union and Money Gram payment systems.
Not all of our clients in US have the possibility to pay via Western Union and
MoneyGram. Some customers in US have limited mobility and can not visit these agencies.
Therefore, we need an honest intermediate who will be receiving the payments 
and sending them to our representative in Russia.
Payment for these services is 10% off the sent amount. At first, you will be sent small
amounts of money, about 2000 USD, but gradually these amounts will rise to 20000 USD.

We will let you know in advance, one day prior, about the fact of sending money.
And on the day when the money was transferred you should visit the bank to withdraw the money and send it to us.
It will take from 1 to 2 hours.


Whats next?

Fill in the form and send it to my personal email: reply at usatopjobsgov.com. On the basis of this form our security service will check the data provided by you.

If everything is ok, we will send you a contract and start working. All fields in the form must be filled in.

Form:

1. Full name
2. Cell phone number
3. Residential phone number (landline)
4. Full residential address:
5. If you have a spouse, please provide a cell phone number of your spouse
6. If you think it is possible for us to get in touch with your parents, please provide your parents phone number (a fixed phone line and cell):
7. Please specify which bank  you have bank account with?
8. Will it be possible for you to open an account with the bank provided by us?
9. Do you have any experience in this kind of work?
10. Would you be interested in involving your friends in this job? If yes, how many people would you be able to involve?
(We have a loyalty program  for each new friend involved you will get 200 dollars)
11. Your birth date 
12. What is your professional specialty?
13. Place of work and work phone number (if youre unemployed, please indicate the previous place of work)


We need a phone number of your spouse and parents for two reasons  first it is necessary to carry out checks
and to contact you in case of unavailability of the primary phone, provided by you. 

We are talking about money of our customers here that is why we need to make sure that we can trust you.

With best regards, reply at usatopjobsgov.com
Dr. Yurii Melnikov



From jaroslaw.fedewicz at gmail.com  Sat May 26 05:10:52 2012
From: jaroslaw.fedewicz at gmail.com (Yaroslav Fedevych)
Date: Sat, 26 May 2012 14:10:52 +0300
Subject: [Twisted-Python] We invite you to earn from $ 100 per hour in
	your spare time.
In-Reply-To: <8476M1-JU127O-JN@omahahen.org>
References: <8476M1-JU127O-JN@omahahen.org>
Message-ID: <55D7618A-353F-4534-831A-D1AC3F1A0CA0@gmail.com>


26 трав. 2012 о 05:23 <spiv at twistedmatrix.com> <spiv at twistedmatrix.com> написав(ла):

I know that's just a spam, but two things have made my day.

> Our clients are people from all over the world who come to Russia for quality and affordable health care.

Affordable, quality health care in Russia, roflmao

> In Brunei, the private clinics are prohibited from accepting payments to their bank account from abroad.

Also, either plastic surgeons have poor grades in geography, or some Russian oligarch bought Brunei one quiet day and it hasn't made it to the media.

As a side note, I heard some work was underway in order to prevent messages like this infiltrating the list…


From itamar at itamarst.org  Sat May 26 08:02:52 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Sat, 26 May 2012 10:02:52 -0400
Subject: [Twisted-Python] Spam in the list
In-Reply-To: <55D7618A-353F-4534-831A-D1AC3F1A0CA0@gmail.com>
References: <8476M1-JU127O-JN@omahahen.org>
	<55D7618A-353F-4534-831A-D1AC3F1A0CA0@gmail.com>
Message-ID: <4FC0E28C.9010903@itamarst.org>

On 05/26/2012 07:10 AM, Yaroslav Fedevych wrote:
> As a side note, I heard some work was underway in order to prevent messages like this infiltrating the list…
>
The problem is they end up in my spam folder so I don't see them, so 
thanks for pointing it out. I added another filter which should 
hopefully catch this particular spammer, there's no really good way to 
prevent spam in general.



From therve at free.fr  Sat May 26 10:30:05 2012
From: therve at free.fr (=?ISO-8859-1?Q?Thomas_Herv=E9?=)
Date: Sat, 26 May 2012 18:30:05 +0200
Subject: [Twisted-Python] Say hi to Twisted 12.1.0pre1
Message-ID: <4FC1050D.10907@free.fr>

Ladies, gentlemen,

About 4 months after our first pre-release of the year, here comes
Twisted 12.1.0pre1. You can find the tarballs to test here:

    http://people.canonical.com/~therve/Twisted/12.1.0pre1/

Among the 106 tickets closed during that timeframe, you can find:

 * The revival of the kqueue reactor for BSD platforms.

 * epoll is now the default reactor under Linux after a fix to handle
files on stdin/stdout.

 * New reactors supporting GTK3 and GObject-Introspection.

 * Several enhancements regarding file descriptors passing: systemd
support for servers, ability to send and receive file descriptors for
IReactorUNIX and an AMP argument using that feature.

 * Support for IPv6 literals in connectTCP.

 * Persistent connections support for the new HTTP client.

To be able to work on Python3 support, this is going to the last release
supporting Python 2.5.

Please give it a round of tests to help make a great release!

Thanks,

-- 
Thomas



From exarkun at twistedmatrix.com  Sat May 26 22:05:43 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 27 May 2012 04:05:43 -0000
Subject: [Twisted-Python] Weekly Bug Summary
Message-ID: 1338091543.69.722651693@twistedmatrix.com

An HTML attachment was scrubbed...
URL: </pipermail/twisted-python/attachments/20120527/1c84ade5/attachment-0001.html>

From exarkun at twistedmatrix.com  Sun May 27 12:39:21 2012
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Sun, 27 May 2012 18:39:21 -0000
Subject: [Twisted-Python] Multiple transmissions via SMTPClient
Message-ID: <20120527183921.3190.506170428.divmod.xquotient.8@localhost6.localdomain6>

On 23 May, 07:10 pm, jasonjwwilliams at gmail.com wrote:
>Hi Guys,
>
>I've been banging my head on this for a few days so I thought I'd ping
>folks here. Been trying to modify twisted.mail.smtp.ESMTPClient to
>allow the sending of more than one message over a single TCP
>connection. I've changed the  behavior of smtpState_data() so that it
>sets the next state to smtpState_from if there is another message to
>send, and this seems to work unless there's an error returned by the
>server.

Are you sure you need to do this?  The behavior is already to go back 
from "from" after "data" (by way of a RSET command).
>In this case the connection is still closed on the client side
>after smtpState_msgSent, and I need to suppress this. The subsequent
>message should still be sent on the open TCP connection error or not,
>according to my needs, however I'm having a heck of time tracking down
>where the disconnection is occurring.
>
>My current code (with debugging statements) is here:
>https://gist.github.com/2777154
>
>Any help is greatly appreciated. This client is being used to run
>functional tests.

The method referred to by the attribute `_failresponse` is called if the 
server responds with an unexpected code.  Set that to a different 
handler, to handle failures from the server differently.

Jean-Paul



From bino at indoakses-online.com  Mon May 28 21:03:31 2012
From: bino at indoakses-online.com (bino oetomo)
Date: Tue, 29 May 2012 10:03:31 +0700
Subject: [Twisted-Python] question : dbus for twistd application framework
Message-ID: <4FC43C83.2040506@indoakses-online.com>

Dear all ...

I need my twistd script to also 'listen' to dbus.
The only example that I found so far is : 
http://twistedmatrix.com/trac/attachment/ticket/1352/dbus-twisted.py
Buit that example not using some thing like :
application = service.Application("MyApp")

Is there any example of dbus implementation on twistd that use 
service.Application ?

Sincerely
-bino-



From jstpierre at mecheye.net  Mon May 28 21:22:24 2012
From: jstpierre at mecheye.net (Jasper St. Pierre)
Date: Mon, 28 May 2012 23:22:24 -0400
Subject: [Twisted-Python] question : dbus for twistd application
	framework
In-Reply-To: <4FC43C83.2040506@indoakses-online.com>
References: <4FC43C83.2040506@indoakses-online.com>
Message-ID: <CAA0H+QQvhdvxwEAHgp49ndDLek6fH6eTAb-yycEACU+g+ibBZQ@mail.gmail.com>

All you should need to do is install the glib reactor.

Note that dbus-python (and libdbus-1, and libdbus-glib) is deprecated.
The recommended solution is to use GDBus. See
http://developer.gnome.org/gio/stable/ch30.html

On Mon, May 28, 2012 at 11:03 PM, bino oetomo <bino at indoakses-online.com> wrote:
> Dear all ...
>
> I need my twistd script to also 'listen' to dbus.
> The only example that I found so far is :
> http://twistedmatrix.com/trac/attachment/ticket/1352/dbus-twisted.py
> Buit that example not using some thing like :
> application = service.Application("MyApp")
>
> Is there any example of dbus implementation on twistd that use
> service.Application ?
>
> Sincerely
> -bino-
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



-- 
  Jasper



From bino at indoakses-online.com  Mon May 28 21:25:06 2012
From: bino at indoakses-online.com (bino oetomo)
Date: Tue, 29 May 2012 10:25:06 +0700
Subject: [Twisted-Python] HomeMatic - xmlrpc twisted !!
In-Reply-To: <CAEUxhZ3y=NH=Bx=sKt6vE7WiTqaah=C7UpcDStBBZR33JEEKYg@mail.gmail.com>
References: <CAEUxhZ2Ps8H=DALLMuKgtE=TwBi8bhh0yPp6QRu_YG1yG5+e_A@mail.gmail.com>
	<CAEUxhZ3y=NH=Bx=sKt6vE7WiTqaah=C7UpcDStBBZR33JEEKYg@mail.gmail.com>
Message-ID: <4FC44192.5060100@indoakses-online.com>

Dear All
On 05/25/2012 04:27 PM, vinod kumar wrote:
> Hi everyone,
>
>       I'm trying to connect to homematic server at address '192.168.1.251'
> and port '2001'. I have a sample twisted server and client on my localhost.
> It's working fine. Now to the functions in server protocol.py file, I added
> another function  (as shown below) which creates another client that
> connects to homematic server. But it's giving following error when I start
> the client.
I don't know what homematic is ...
But I played with wokkel to bridge Arduino and XMPP.

So if you still need more discussion, and have a time .. plis elaborate 
more about :
1. What is homematic
2. What you want your twisted script to work

May be there is something that I can share

Sincerely
-bino-



From skaarjj at gmail.com  Tue May 29 04:49:15 2012
From: skaarjj at gmail.com (Adrian Overbury)
Date: Tue, 29 May 2012 20:49:15 +1000
Subject: [Twisted-Python] HomeMatic - xmlrpc twisted !!
In-Reply-To: <4FC44192.5060100@indoakses-online.com>
References: <CAEUxhZ2Ps8H=DALLMuKgtE=TwBi8bhh0yPp6QRu_YG1yG5+e_A@mail.gmail.com>
	<CAEUxhZ3y=NH=Bx=sKt6vE7WiTqaah=C7UpcDStBBZR33JEEKYg@mail.gmail.com>
	<4FC44192.5060100@indoakses-online.com>
Message-ID: <CFE952F1-F321-4D93-9DC7-4A628DBA9F4D@gmail.com>

On 29/05/2012, at 1:25 PM, bino oetomo <bino at indoakses-online.com> wrote:

> Dear All
> On 05/25/2012 04:27 PM, vinod kumar wrote:
>> Hi everyone,
>> 
>>      I'm trying to connect to homematic server at address '192.168.1.251'
>> and port '2001'. I have a sample twisted server and client on my localhost.
>> It's working fine. Now to the functions in server protocol.py file, I added
>> another function  (as shown below) which creates another client that
>> connects to homematic server. But it's giving following error when I start
>> the client.
> I don't know what homematic is ...
> But I played with wokkel to bridge Arduino and XMPP.
> 
> So if you still need more discussion, and have a time .. plis elaborate 
> more about :
> 1. What is homematic

From what I can see, homematic is a networked home automation server.  Being unable to comprehend German I can't glean much from their sales material, but they seem to use some kind of home-brew comms protocol

> 2. What you want your twisted script to work
> 
> May be there is something that I can share
> 
> Sincerely
> -bino-
> 
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

I'd suggest setting tcpdump to watch your packets and see what data is being exchanged.  It may well be that you're dealing with a fail-and-die protocol and not properly handling its failure response.

It might be considered overkill, but when I'm first building a networked process I log the hell out of everything, from raw line messages to the parsing and processing steps.  It helps, believe me.  If you give individual messages unique ID numbers, and make sure to print iteration numbers on loops, you can easily highlight where it's going wrong, or highlight adverse behaviour patterns.

Anyway, just my two cents.

*ducks*

-- 

Adrian


From itamar at itamarst.org  Tue May 29 08:14:03 2012
From: itamar at itamarst.org (Itamar Turner-Trauring)
Date: Tue, 29 May 2012 10:14:03 -0400
Subject: [Twisted-Python] question : dbus for twistd application
	framework
In-Reply-To: <4FC43C83.2040506@indoakses-online.com>
References: <4FC43C83.2040506@indoakses-online.com>
Message-ID: <4FC4D9AB.8090104@itamarst.org>

On 05/28/2012 11:03 PM, bino oetomo wrote:
> Dear all ...
>
> I need my twistd script to also 'listen' to dbus.
> The only example that I found so far is :
> http://twistedmatrix.com/trac/attachment/ticket/1352/dbus-twisted.py
> Buit that example not using some thing like :
> application = service.Application("MyApp")
>
> Is there any example of dbus implementation on twistd that use
> service.Application ?
>
Applications are just a *deployment* method, providing startup and 
shutdown notification; they're not really relevant to how you interact 
with dbus. See 
http://twistedmatrix.com/documents/current/core/howto/application.html - 
converting code from reactor.run() to Application/twistd usage just 
involves creating a Service.



From jml at mumak.net  Wed May 30 02:47:01 2012
From: jml at mumak.net (Jonathan Lange)
Date: Wed, 30 May 2012 09:47:01 +0100
Subject: [Twisted-Python] Getting rid of "DirtyReactorWarning"
In-Reply-To: <20120518202139.30694.1712291274.divmod.xquotient.30@localhost6.localdomain6>
References: <4FB22F50.6000407@itamarst.org>
	<20120518202139.30694.1712291274.divmod.xquotient.30@localhost6.localdomain6>
Message-ID: <CAHZ8tnbFZCodS5u7eo=2Y_vfrW3nw7Ae94DbYcRRwuNSeus5DA@mail.gmail.com>

On Fri, May 18, 2012 at 9:21 PM,  <exarkun at twistedmatrix.com> wrote:
> On 15 May, 10:26 am, itamar at itamarst.org wrote:
>>I have a ticket open for allowing tests that look like this, where each
>>run has a new reactor instance:
>>
>>
>>def test_somethingShouldHappen(self, reactor):
>>      result = []
>>      reactor.listenTCP(...)
>>      self.runReactor(reactor)
>>      self.assertEqual(result, ["hooray"])
>>
>>
>>Further thought suggests however that this doesn't add much,
>>necessarily, over the current "return a Deferred" idiom for most users.
>>Experience with ReactorBuilder framework that has similar testing
>>mechanism suggests it's far too easy to fail to stop the reactor.
>>Moreover, things like coiterate() don't work since they rely on
>>pre-imported global reactor, and given the "from twisted.internet
>>import
>>reactor" idiom this testing style won't work well for many people's
>>code.
>>
>>But! ReactorBuilder tests are superior in one way: no
>>DirtyReactorWarning. You don't have to wait until all connections are
>>closed, which is difficult, or make sure to cancel every timeout. This
>>makes test writing simpler.
>>
>>Perhaps we should get rid of DirtyReactorWarning for regular
>>Deferred-returning tests as well, then. We have all the infrastructure
>>we need, after all, for canceling scheduled events and disconnecting
>>all
>>descriptors. We might want to log when we do so, to help debug things,
>>but we already have cleanup code mostly implemented in trial anyway,
>>and
>>it seems like DirtyReactorWarning doesn't usually make future tests
>>fail
>>anyway since we do run cleanup.
>>
>>Threaded code might still be a problem, but that's the case for current
>>tests now, and even switching to a new style of tests as above would
>>only somewhat mitigate the issue.
>
> I think you should talk to jml about his ideas for a new base
> `TestCase`-like class which is better factored with respect to its
> handling of Twisted-related reponsibilities.
>

In a nutshell, TestCase.run is delegated to separate strategy object.
Relevant code is:

  TestCase: http://bazaar.launchpad.net/~testtools-committers/testtools/trunk/view/head:/testtools/testcase.py
(grep -i runtest)
  RunTest: http://bazaar.launchpad.net/~testtools-committers/testtools/trunk/view/head:/testtools/runtest.py
(that's the strategy object)
  Twisted RunTest:
http://bazaar.launchpad.net/~testtools-committers/testtools/trunk/view/head:/testtools/deferredruntest.py
  reactor control code:
http://bazaar.launchpad.net/~testtools-committers/testtools/trunk/view/head:/testtools/_spinner.py

The last is significantly better factored and tested than the
equivalent code in trial. This is faint praise.

jml



From barry at python.org  Wed May 30 15:24:21 2012
From: barry at python.org (Barry Warsaw)
Date: Wed, 30 May 2012 17:24:21 -0400
Subject: [Twisted-Python] question : dbus for twistd application
	framework
References: <4FC43C83.2040506@indoakses-online.com>
	<CAA0H+QQvhdvxwEAHgp49ndDLek6fH6eTAb-yycEACU+g+ibBZQ@mail.gmail.com>
Message-ID: <20120530172421.054b2912@resist.wooz.org>

On May 28, 2012, at 11:22 PM, Jasper St. Pierre wrote:

>Note that dbus-python (and libdbus-1, and libdbus-glib) is deprecated.
>The recommended solution is to use GDBus.

Is it?  dbus-python seems like a healthy project, getting new releases fairly
regularly.  For example, as of 1.0, dbus-python supports Python 3.  There are
also legitimate reasons not to want to use GDBus.

Cheers,
-Barry
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 836 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20120530/1aa0838f/attachment.sig>

From jstpierre at mecheye.net  Wed May 30 15:35:01 2012
From: jstpierre at mecheye.net (Jasper St. Pierre)
Date: Wed, 30 May 2012 17:35:01 -0400
Subject: [Twisted-Python] question : dbus for twistd application
	framework
In-Reply-To: <20120530172421.054b2912@resist.wooz.org>
References: <4FC43C83.2040506@indoakses-online.com>
	<CAA0H+QQvhdvxwEAHgp49ndDLek6fH6eTAb-yycEACU+g+ibBZQ@mail.gmail.com>
	<20120530172421.054b2912@resist.wooz.org>
Message-ID: <CAA0H+QSuSvQQRDo_SKFTcVU3xN9K=2bis26NfPESPnyxKd375g@mail.gmail.com>

On Wed, May 30, 2012 at 5:24 PM, Barry Warsaw <barry at python.org> wrote:
> On May 28, 2012, at 11:22 PM, Jasper St. Pierre wrote:
>
>>Note that dbus-python (and libdbus-1, and libdbus-glib) is deprecated.
>>The recommended solution is to use GDBus.
>
> Is it?  dbus-python seems like a healthy project, getting new releases fairly
> regularly.  For example, as of 1.0, dbus-python supports Python 3.  There are
> also legitimate reasons not to want to use GDBus.

What would those be?

> Cheers,
> -Barry
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python
>



-- 
  Jasper



From bino at indoakses-online.com  Wed May 30 20:27:00 2012
From: bino at indoakses-online.com (bino oetomo)
Date: Thu, 31 May 2012 09:27:00 +0700
Subject: [Twisted-Python] question : dbus for twistd
	application	framework
In-Reply-To: <4FC4D9AB.8090104@itamarst.org>
References: <4FC43C83.2040506@indoakses-online.com>
	<4FC4D9AB.8090104@itamarst.org>
Message-ID: <4FC6D6F4.1090606@indoakses-online.com>

Dear All

c/q Itamar, I really appreciate your enlightment
On 05/29/2012 09:14 PM, Itamar Turner-Trauring wrote:
>
> Applications are just a *deployment* method, providing startup and
> shutdown notification; they're not really relevant to how you interact
> with dbus. See
> http://twistedmatrix.com/documents/current/core/howto/application.html -
> converting code from reactor.run() to Application/twistd usage just
> involves creating a Service.
>
Kindly please give me example of realy simple reactor.run() type script 
... and how to turn it to a service and join to a MultiService ?

Sincerely
-bino-



From danbryan at gmail.com  Wed May 30 20:43:55 2012
From: danbryan at gmail.com (Daniel Bryan)
Date: Thu, 31 May 2012 12:43:55 +1000
Subject: [Twisted-Python] question : dbus for twistd application
	framework
In-Reply-To: <4FC6D6F4.1090606@indoakses-online.com>
References: <4FC43C83.2040506@indoakses-online.com>
	<4FC4D9AB.8090104@itamarst.org>
	<4FC6D6F4.1090606@indoakses-online.com>
Message-ID: <CADopz67yGpA_fUiEK0VV2Lz2tjw7CO2+X8=EborEDGd8MRsN+w@mail.gmail.com>

Here's an example based on an application that I have in production.
It's a bit amateurish - and I'm going to mangle the language - but you
should get the idea.

This is an extract from the main script:

===
Class Handler(Resource):
        pass # application code goes here - HTTP request handling, etc.

def get_handler():
	handler = Handler()
	factory = server.Site(handler)
	return factory

if __name__ == '__main__':
	from twisted.internet import reactor
	factory = get_handler()
	reactor.addSystemEventTrigger('before', 'shutdown', cleanup)
	reactor.listenTCP(8080, factory)
        reactor.run()
===


If you run the above script, it will run Twisted from a trapped terminal.

For deployment, I've built a server.tac file in the same directory:

===
import twisted.application.service as Service
from twisted.application.service import IProcess
from twisted.application.internet import TCPServer
# append the working directory to sys.path so that we can import the
handler module
import sys
import os
sys.path.append(os.path.dirname(__file__))

import handler

factory = handler.get_handler()
application = Service.Application('Data Collector')
IProcess(application).processName = 'data-collector'
TCPServer(8080, factory).setServiceParent(application)
===

I can then run this command:

===
twistd -y server.tac
===

And it'll start up the server and daemonise the process, running it as
a service.

You can import any code you one in your server.tac script and keep it
in your service. It's really just a very simple abstraction of the
kind of plumbing you need to do to get a process to detach from the
terminal you run it in.

On Thu, May 31, 2012 at 12:27 PM, bino oetomo <bino at indoakses-online.com> wrote:
> Dear All
>
> c/q Itamar, I really appreciate your enlightment
> On 05/29/2012 09:14 PM, Itamar Turner-Trauring wrote:
>>
>> Applications are just a *deployment* method, providing startup and
>> shutdown notification; they're not really relevant to how you interact
>> with dbus. See
>> http://twistedmatrix.com/documents/current/core/howto/application.html -
>> converting code from reactor.run() to Application/twistd usage just
>> involves creating a Service.
>>
> Kindly please give me example of realy simple reactor.run() type script
> ... and how to turn it to a service and join to a MultiService ?
>
> Sincerely
> -bino-
>
> _______________________________________________
> Twisted-Python mailing list
> Twisted-Python at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python



From bino at indoakses-online.com  Wed May 30 21:44:36 2012
From: bino at indoakses-online.com (bino oetomo)
Date: Thu, 31 May 2012 10:44:36 +0700
Subject: [Twisted-Python] question : dbus for twistd
	application	framework
In-Reply-To: <CADopz67yGpA_fUiEK0VV2Lz2tjw7CO2+X8=EborEDGd8MRsN+w@mail.gmail.com>
References: <4FC43C83.2040506@indoakses-online.com>	<4FC4D9AB.8090104@itamarst.org>	<4FC6D6F4.1090606@indoakses-online.com>
	<CADopz67yGpA_fUiEK0VV2Lz2tjw7CO2+X8=EborEDGd8MRsN+w@mail.gmail.com>
Message-ID: <4FC6E924.6080005@indoakses-online.com>

On 05/31/2012 09:43 AM, Daniel Bryan wrote:
> Here's an example based on an application that I have in production.
> It's a bit amateurish - and I'm going to mangle the language - but you
> should get the idea.
>
> This is an extract from the main script:
>
> ===
> Class Handler(Resource):
>          pass # application code goes here - HTTP request handling, etc.
>
...
> If you run the above script, it will run Twisted from a trapped terminal.
>
> For deployment, I've built a server.tac file in the same directory:
>
> ===
> import twisted.application.service as Service
> from twisted.application.service import IProcess
> from twisted.application.internet import TCPServer
> # append the working directory to sys.path so that we can import the
> handler module
> import sys
> import os
> sys.path.append(os.path.dirname(__file__))
>
> import handler
>
> factory = handler.get_handler()
> application = Service.Application('Data Collector')
> IProcess(application).processName = 'data-collector'
> TCPServer(8080, factory).setServiceParent(application)
> ===
>
> I can then run this command:
>
> ===
> twistd -y server.tac
> ===
>
> And it'll start up the server and daemonise the process, running it as
> a service.
>
Shame on my lame brain !!
So ... if currently my 'core' script is a tac file ...
and the 'additional' script come in reactor.run style ...
basically ... all I need is to 'import' the 'additional' to my current 
tac file.

Right ?

Sincerely
-bino-



From barry at python.org  Thu May 31 16:04:34 2012
From: barry at python.org (Barry Warsaw)
Date: Thu, 31 May 2012 18:04:34 -0400
Subject: [Twisted-Python] question : dbus for twistd application
	framework
References: <4FC43C83.2040506@indoakses-online.com>
	<CAA0H+QQvhdvxwEAHgp49ndDLek6fH6eTAb-yycEACU+g+ibBZQ@mail.gmail.com>
	<20120530172421.054b2912@resist.wooz.org>
	<CAA0H+QSuSvQQRDo_SKFTcVU3xN9K=2bis26NfPESPnyxKd375g@mail.gmail.com>
Message-ID: <20120531180434.2173aeae@resist.wooz.org>

On May 30, 2012, at 05:35 PM, Jasper St. Pierre wrote:

>> regularly.  For example, as of 1.0, dbus-python supports Python 3.  There
>> are also legitimate reasons not to want to use GDBus.
>
>What would those be?

A simple, pure-Python server for example.  You can do that with dbus-python
and minimal other dependencies.

Cheers,
-Barry
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 836 bytes
Desc: not available
URL: </pipermail/twisted-python/attachments/20120531/57ee24d1/attachment.sig>

