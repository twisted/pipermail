<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Twisted, medusa, ZServer, and VFS's
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Twisted%2C%20medusa%2C%20ZServer%2C%20and%20VFS%27s&In-Reply-To=1002692939.3bc3e14b67441%40minkirri.apana.org.au">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000481.html">
   <LINK REL="Next"  HREF="000486.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Twisted, medusa, ZServer, and VFS's</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Twisted%2C%20medusa%2C%20ZServer%2C%20and%20VFS%27s&In-Reply-To=1002692939.3bc3e14b67441%40minkirri.apana.org.au"
       TITLE="[Twisted-Python] Twisted, medusa, ZServer, and VFS's">glyph at twistedmatrix.com
       </A><BR>
    <I>Wed Oct 10 04:56:38 EDT 2001</I>
    <P><UL>
        <LI>Previous message: <A HREF="000481.html">[Twisted-Python] Twisted, medusa, ZServer, and VFS's
</A></li>
        <LI>Next message: <A HREF="000486.html">[Twisted-Python] Twisted, medusa, ZServer, and VFS's
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#484">[ date ]</a>
              <a href="thread.html#484">[ thread ]</a>
              <a href="subject.html#484">[ subject ]</a>
              <a href="author.html#484">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm only responding to the twisted-python list, since the cross-post 
seemed excessive.  Feel free to rebroadcast this if ensuing discussion 
on other lists is interesting.

On Wednesday, October 10, 2001, at 12:48  AM, Donovan Baarda wrote:

&gt;<i> G'day,
</I>&gt;<i>
</I>&gt;<i> I've just been looking at Twisted Python for the past hour or two, read 
</I>&gt;<i> the
</I>&gt;<i> mailing list archives, and have some comments and questions.
</I>
Thank you for your interest.  Here's a twisted way of looking at your 
questions :-)

&gt;<i> First my impressions of the three contenders; Twisted, Medusa, ZServer. 
</I>&gt;<i> Please
</I>&gt;<i> correct me if I'm wrong in the following summaries;
</I>&gt;<i>
</I>&gt;<i> Medusa seems to be the daddy of them all.
</I>
I don't see what you mean by that; about the only things that Medusa and 
Twisted share is that they are both asynchronous networking frameworks.  
They seem to have a fairly different approach to how protocols are 
written and integrated, and in what their scope for future development 
is.

&gt;<i> It's the oldest, which has benefits and problems. It is a little messy 
</I>&gt;<i> from its evolution, but seems pretty mature. It uses an async select 
</I>&gt;<i> loop to drive everything. It uses &quot;asynchat&quot; derived class objects to 
</I>&gt;<i> communicate on sockets. Data can be sent by pushing &quot;producers&quot; onto 
</I>&gt;<i> asynchat objects. Producers can be complex objects that produce data, 
</I>&gt;<i> execute callbacks, whatever. It's ftp and http server classes use a 
</I>&gt;<i> primative VFS to serve from. The asyncore and asynchat modules it is 
</I>&gt;<i> built on are now part of Python.
</I>
This sounds pretty accurate to me.

&gt;<i> Twisted seems to be a from-the-ground up re-invention of Medusa.
</I>
As Moshe said, only insofar as it's a from-the-ground-up re-invention of 
about 6 or 7 other things.

&gt;<i> It's newer, but surprisingly it's bigger, dispite it's apparently less 
</I>&gt;<i> mature feature set.
</I>
What do you mean when you say &quot;less mature&quot;?  Twisted's features have 
been around for less time (hence, &quot;newer&quot;) but compare, for example, 
twisted.spread.pb with rpc_server.  Or twisted.words with chat_server  
Would you characterize the medusa approach in any of these comparisons 
as &quot;more mature&quot;?

What is the Medusa equivalent of twisted.reality, twisted.mail, 
twisted.web.widgets, or twisted.enterprise?  These services are at 
varying levels of maturity, but surely the fact that they exist at all 
has to count for something :-).

&gt;<i> It is similar in structure to Medusa,
</I>
At some extremely superficial level, I guess this is true.  However, 
Twisted does a lot more than just clone medusa.  Even at a basic level, 
you could say that it complicates the medusa structure a great deal with 
a unified notion of authentication, automatic persistence, and 
incidentally, several full-featured applications. :-)

&gt;<i> but simplifys it by dispensing with producers.
</I>
Twisted has producers, but only when you need them.

<A HREF="http://twistedmatrix.com/users/glyph/TwistedDocs/Twisted-0.11.0/twisted/internet/">http://twistedmatrix.com/users/glyph/TwistedDocs/Twisted-0.11.0/twisted/internet/</A>
abstract_FileDescriptor.py.html#registerProducer

&gt;<i> It can use a variety of event-loops, including Tk and GTK, or it's own. 
</I>&gt;<i> It doesen't have a VFS (yet) so its ftp and http servers serve from the 
</I>&gt;<i> underlying os filesystem.
</I>
Well, it depends what you mean by VFS.  Twisted has a perception of the 
filesystem as more like a special-case of &quot;container&quot; than containers as 
a special-case of the filesystem.  There are containers which can 
respond to specifics of the HTTP protocol that are not derived from 
files; would you call that part of a &quot;VFS&quot;?  The semantics of 
&quot;__builtins__.open&quot; are not sufficiently rich to support that.

&gt;<i> In my search for Python VFS's I found PyVFS (<A HREF="http://www.pycage.de/">http://www.pycage.de/</A>). 
</I>&gt;<i> This is modelled on the Gnome/MC VFS, so it supports 
</I>&gt;<i> '/dir/somefile.tar.gz#tgz:/somepath' style paths to look inside tar, 
</I>&gt;<i> tgz, ftp, whatever. The various different VFS backends are loaded 
</I>&gt;<i> dynamicly as pluggins. These pluggins execute as a seperate process 
</I>&gt;<i> that are communicated with over a channel. The API is too simplistic 
</I>&gt;<i> for me, with files being &quot;projected&quot; out of the VFS to a local file to 
</I>&gt;<i> be manipulated/used. I don't like the pluggin-process-channel 
</I>&gt;<i> architecture either.
</I>
Why not?  It sounds clever to me.  I don't have a good picture of your 
requirements (other than &quot;HTTP and FTP&quot; at this point, so I can't fathom 
why you like or don't like this particular solution.  (Why is it 
relevant?)

&gt;<i> In the reading of the Twisted mailing list, I saw a comment to the 
</I>&gt;<i> affect that
</I>&gt;<i> the Medusa VFS was an example of how _not_ to do it, which lead to 
</I>&gt;<i> using webDAV
</I>&gt;<i> as the API for a VFS. My gut feeling is DAV is a cool protocol for a VFS
</I>&gt;<i> backend, but I dunno about using it as the primary API. Sure, it 
</I>&gt;<i> supports meta-
</I>&gt;<i> data etc, but the reality is the API that is most widely used and 
</I>&gt;<i> understood is
</I>&gt;<i> the POSIX filesytem API, as exposed in Python by the os and os.path 
</I>&gt;<i> modules.
</I>
Yes, but that's a blocking API; ergo, it does not work in an 
asynchronous framework like Twisted.  Not all &quot;files&quot; are associated 
with a file descriptor, so they may potentially support different 
operations.  Directory listing on FTP, HTTP, and WebDAV sites is not 
necessarily consistent with the files that are actually available.  
There is metadata associated with some requests, and not with others... 
in short, there are lots of subtle issues involved with supporting each 
of these types of hierarchies well, and a blanket virtual &quot;filesystem&quot; 
implementation does not satisfy all (or even a reasonably large subset) 
of them.  For different protocols, there may be API differences, unless 
some of the protocols are stripped to the &quot;lowest common denominator&quot;, 
e.g. POSIX.

&gt;<i> My solution for a VFS has been, upto now, based on Medusa's, but 
</I>&gt;<i> extending it
</I>&gt;<i> to be more like os and os.path. So far it's a filesystem class with 
</I>&gt;<i> most of the
</I>&gt;<i> os and os.path methods. One of the derived classes is a 
</I>&gt;<i> mountable_filesystem
</I>&gt;<i> that allows you to mount other VFS filesystems off it. At this point I'm
</I>&gt;<i> tempted to make a vfs module that emulates os and os.path so that you 
</I>&gt;<i> can mount
</I>&gt;<i> whatever vfs's you want first, and then just replace all your os.* 
</I>&gt;<i> calls with
</I>&gt;<i> vfs.* calls. Note that the one catch would be open() would need to be 
</I>&gt;<i> replaced
</I>&gt;<i> with vfs.open().
</I>
Not necessarily.  You could always hack up the __builtins__ module at 
runtime to point to your newer, better open().  Either way it seems like 
there are probably issues with security &amp; the presence of *real* file 
descriptors that you have to think about...

&gt;<i> I'm sort of fishing for general suggestions, comments, and interest. 
</I>&gt;<i> I'm at the
</I>&gt;<i> point where I've just convinced myself my vfs is worth finishing, and 
</I>&gt;<i> my ready
</I>&gt;<i> () patch to asynchat is worth updating, but I'm not sure what to use as 
</I>&gt;<i> the
</I>&gt;<i> http and ftp server front-end, though I'm still leaning towards medusa. 
</I>&gt;<i> It
</I>&gt;<i> looks like Twister is not ready, and ZServer would be too hard to 
</I>&gt;<i> seperate from
</I>&gt;<i> Zope.
</I>
Ready for what, is the question? :-)

Short form: HTTP yes, FTP no (but it could be with a little work), 
everything else yes.

Long form:

We do not currently have (or have any high-priority plans to produce) a 
&quot;VFS&quot;, but I would contend that such a system is not necessary when you 
look at the way that Twisted does web resources.  FTP doesn't currently 
use that model, but I don't think it would be a difficult modification; 
it uses the same Producer model that HTTP does.  I estimate that it 
would be easier to modify Twisted in this way than to undertake a 
project to do your own VFS, but since I'm not exactly sure what's going 
to make you happy, I don't have a high degree of confidence in that 
estimation.

As far as robustness (which is an implied issue with Twisted's 
&quot;maturity&quot;), Twisted is being used to run the main twistedmatrix.com 
site.  We always run the most recent development version.  So far, it's 
only served 17.422 downloads of Twisted itself and approximately three 
quarters of a million hits, and survived five or six freshmeat 
&quot;attacks&quot; :-).  It did crash, once, about 8 months ago after a major 
refactoring (before we had acceptance tests...), but that bug was 
quickly fixed.  We don't run a public FTP server, but the core parts of 
Twisted that enable one to run a website where you can download files 
are very personally important to me, so draw your own conclusions :-).

--
______      you are in a maze of twisted little applications, all
|<i>   |_\     remarkably consistent.
</I>|<i>     |          -- glyph lefkowitz, glyph @ twisted matrix . com
</I>|<i>_____|             <A HREF="http://www.twistedmatrix.com/">http://www.twistedmatrix.com/</A>
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000481.html">[Twisted-Python] Twisted, medusa, ZServer, and VFS's
</A></li>
	<LI>Next message: <A HREF="000486.html">[Twisted-Python] Twisted, medusa, ZServer, and VFS's
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#484">[ date ]</a>
              <a href="thread.html#484">[ thread ]</a>
              <a href="subject.html#484">[ subject ]</a>
              <a href="author.html#484">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
