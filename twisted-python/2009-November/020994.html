<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Telnet server: localecho &quot;ON&quot; for linux client but	not for windows client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Telnet%20server%3A%20localecho%20%22ON%22%20for%20linux%20client%20but%0A%09not%20for%20windows%20client&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020990.html">
   <LINK REL="Next"  HREF="021012.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Telnet server: localecho &quot;ON&quot; for linux client but	not for windows client</H1>
    <B>filoufake-python at yahoo.fr</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Telnet%20server%3A%20localecho%20%22ON%22%20for%20linux%20client%20but%0A%09not%20for%20windows%20client&In-Reply-To="
       TITLE="[Twisted-Python] Telnet server: localecho &quot;ON&quot; for linux client but	not for windows client">filoufake-python at yahoo.fr
       </A><BR>
    <I>Mon Nov 16 09:14:49 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="020990.html">[Twisted-Python] Weekly Bug Summary
</A></li>
        <LI>Next message: <A HREF="021012.html">[Twisted-Python] Telnet server: localecho &quot;ON&quot; for linux client	but not for windows client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20994">[ date ]</a>
              <a href="thread.html#20994">[ thread ]</a>
              <a href="subject.html#20994">[ subject ]</a>
              <a href="author.html#20994">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

Some month ago, exarkun helped me in the development of a very simplified
telnet server.

I observed that when I connect from a windows client, the LOCALECHO
is set to &quot;OFF&quot; after the authentication. I cannot set it &quot;ON&quot;
afterwards. Everything typed in the client console is hidden.
When I use a linux client, the &quot;ECHO&quot; is OFF just for typing the 
password and then ON again.

Does someone has an idea how to do with the windows client?
I tried to set the ECHO ON using self.transport.will(ECHO) but that
doesn't work.

Here is the code:

############################################################
import sys
from zope.interface import implements
from twisted.internet import protocol
from twisted.python import log
from twisted.cred import error
from twisted.cred import portal
from twisted.cred import checkers
from twisted.cred import credentials
from twisted.conch.telnet import AuthenticatingTelnetProtocol
from twisted.conch.telnet import StatefulTelnetProtocol
from twisted.conch.telnet import ITelnetProtocol
from twisted.conch.telnet import TelnetTransport
from twisted.conch.telnet import ECHO

class Realm:
  implements(portal.IRealm)

  def requestAvatar(self, avatarId, mind, *interfaces):
    if ITelnetProtocol in interfaces:
      av = MyTelnet()
      av.transport.will(ECHO)
      av.state = 'Command'
      return ITelnetProtocol, av, lambda:None
    raise NotImplementedError(&quot;Not supported by this realm&quot;)

class MyTelnet(StatefulTelnetProtocol):
  def telnet_Command(self, line):
    print &quot;line received via telnet&quot;, line
    self.sendLine('coucou man, you send me %s' % line)

def main():
  r = Realm()
  p = portal.Portal(r)
  c = checkers.InMemoryUsernamePasswordDatabaseDontUse()
  c.addUser(&quot;AA&quot;, &quot;aa&quot;)
  p.registerChecker(c)
  p.registerChecker(checkers.AllowAnonymousAccess())
  f = protocol.ServerFactory()
  f.protocol = lambda: TelnetTransport(AuthenticatingTelnetProtocol, p)
  log.startLogging(sys.stdout)
  from twisted.internet import reactor
  reactor.listenTCP(4738, f)
  reactor.run()

if __name__ == '__main__':
  main()
############################################################

Best Regards,
Philippe


      

</PRE>


















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020990.html">[Twisted-Python] Weekly Bug Summary
</A></li>
	<LI>Next message: <A HREF="021012.html">[Twisted-Python] Telnet server: localecho &quot;ON&quot; for linux client	but not for windows client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20994">[ date ]</a>
              <a href="thread.html#20994">[ thread ]</a>
              <a href="subject.html#20994">[ subject ]</a>
              <a href="author.html#20994">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
