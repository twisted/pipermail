<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Need replacement for subprocess.call within	a	pyAMF method - any suggestions?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Need%20replacement%20for%20subprocess.call%20within%0A%09a%09pyAMF%20method%20-%20any%20suggestions%3F&In-Reply-To=%3C20091104000824.3229.1269878260.divmod.xquotient.121%40localhost.localdomain%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="053345.html">
   <LINK REL="Next"  HREF="053361.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Need replacement for subprocess.call within	a	pyAMF method - any suggestions?</H1>
    <B>exarkun at twistedmatrix.com</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Need%20replacement%20for%20subprocess.call%20within%0A%09a%09pyAMF%20method%20-%20any%20suggestions%3F&In-Reply-To=%3C20091104000824.3229.1269878260.divmod.xquotient.121%40localhost.localdomain%3E"
       TITLE="[Twisted-Python] Need replacement for subprocess.call within	a	pyAMF method - any suggestions?">exarkun at twistedmatrix.com
       </A><BR>
    <I>Tue Nov  3 17:08:24 MST 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="053345.html">[Twisted-Python] Need replacement for subprocess.call within a pyAMF method - any suggestions?
</A></li>
        <LI>Next message (by thread): <A HREF="053361.html">[Twisted-Python] Need replacement for subprocess.call within a pyAMF method - any suggestions?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53346">[ date ]</a>
              <a href="thread.html#53346">[ thread ]</a>
              <a href="subject.html#53346">[ subject ]</a>
              <a href="author.html#53346">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 3 Nov, 11:55 pm, <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">rroberts at adobe.com</A> wrote:
&gt;<i>I am trying to use the twisted reactor as a basis for a Python server 
</I>&gt;<i>for a
</I>&gt;<i>Flex app, using pyAMF.  My problem is that one  of the server methods
</I>&gt;<i>requires me to run a series of command-line tools to complete parsing 
</I>&gt;<i>data
</I>&gt;<i>from a file into an XML object, with lots of Python processing on the
</I>&gt;<i>results of one command-line tool to provide the input to the next one. 
</I>&gt;<i>I
</I>&gt;<i>have been using  subprocess.call  to invoke the command-line tools, but
</I>&gt;<i>these intermittently - and frequently -  fail with an error &quot;IOError: 
</I>&gt;<i>[Errno
</I>&gt;<i>4] Interrupted system call&quot;.
</I>&gt;<i>
</I>&gt;<i>I do know that this was supposed to be fixed in twisted for Python 2.6, 
</I>&gt;<i>but
</I>&gt;<i>it doesn't seem to be.
</I>
I'm not sure why you know this.  I sure would be great if that were the 
case, but it's not.  More changes in Twisted are necessary to let things 
like subprocess.call work properly alongside Twisted's process API.
&gt;<i>I have python 2.6.3 under Mac OSX 10.5.8, and twisted
</I>&gt;<i>8.2.0. Is there a work-around for this problem, or a better way to do 
</I>&gt;<i>this
</I>&gt;<i>with twisted? I do know that I can make a command-line call with
</I>&gt;<i>reactor.callLater, and that I can return a deferred from my server 
</I>&gt;<i>method,
</I>&gt;<i>but I don't see how to easily accomplish the chain of calls that I 
</I>&gt;<i>need,
</I>&gt;<i>short of breaking up my serverMethod1 into the several sequential 
</I>&gt;<i>parts, and
</I>&gt;<i>calling each from the result handler of the previous one. I'd rather 
</I>&gt;<i>not go
</I>&gt;<i>that route, as the logic of which command-line call gets made when is
</I>&gt;<i>actually quite complicated.
</I>
Are you aware that this means your server will only be able to handle 
one request at a time?  If so and that's what you're shooting for, then 
you can fix this easily, by passing False to reactor.run.  This 
disable's Twisted's own process support and lets things like 
subprocess.call work (blockingly, of course).
&gt;<i>What I have now looks like (enormously simplified):
</I>&gt;<i>class MyPythonServer:
</I>&gt;<i>
</I>&gt;<i>    def serverMethod1(self, dummyPost, inputFilePath):
</I>&gt;<i>        # Open inputFilePath, do stuff, save results to file2
</I>&gt;<i>        subprocess.call([&quot;command1&quot;, &quot;file2&quot;, &quot;file3&quot;])
</I>&gt;<i>        # Open file3, do stuff to the data, save results to file4
</I>&gt;<i>        subprocess.call([&quot;command2&quot;, &quot;file4&quot;, &quot;file5&quot;])
</I>&gt;<i>        # Open file5, convert data to a large string containing XML.
</I>&gt;<i>        return xmlString
</I>
Of course, you can still have methods that look like this if you use 
things like inlineCallbacks (which you can, since you said you're using 
Python 2.6).  That way you preserve the style you seem to prefer and 
avoid blocking your server any time you need to launch a child process.

Jean-Paul


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="053345.html">[Twisted-Python] Need replacement for subprocess.call within a pyAMF method - any suggestions?
</A></li>
	<LI>Next message (by thread): <A HREF="053361.html">[Twisted-Python] Need replacement for subprocess.call within a pyAMF method - any suggestions?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53346">[ date ]</a>
              <a href="thread.html#53346">[ thread ]</a>
              <a href="subject.html#53346">[ subject ]</a>
              <a href="author.html#53346">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
