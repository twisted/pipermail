<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Using a custom reactor in twisted trial for	test cases?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Using%20a%20custom%20reactor%20in%20twisted%20trial%20for%0A%09test%20cases%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020833.html">
   <LINK REL="Next"  HREF="020838.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Using a custom reactor in twisted trial for	test cases?</H1>
    <B>Andrew Francis</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20Using%20a%20custom%20reactor%20in%20twisted%20trial%20for%0A%09test%20cases%3F&In-Reply-To="
       TITLE="[Twisted-Python] Using a custom reactor in twisted trial for	test cases?">andrewfr_ice at yahoo.com
       </A><BR>
    <I>Mon Nov  2 12:39:39 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="020833.html">[Twisted-Python] Using a custom reactor in twisted trial for	test cases?
</A></li>
        <LI>Next message: <A HREF="020838.html">[Twisted-Python] The case of the missing Traceback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20834">[ date ]</a>
              <a href="thread.html#20834">[ thread ]</a>
              <a href="subject.html#20834">[ subject ]</a>
              <a href="author.html#20834">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Glyph:

&gt;<i>These examples aren't the greatest, because they tend to assume that 
</I>&gt;<i>you _always_ have Stackless code that's ready to run, and you want to 
</I>&gt;<i>run at some number of &quot;frames per second&quot;.&#160;
</I>
In 2007, folks (especially myself) are still trying to figure out if
Stackless can play with Twisted correctly. I know my stuff in the
repository is old.

&gt;<i> For simple examples this makes sense, but for a system architecture 
</I>&gt;<i>this is a limiting approach.&#160; If your stackless application wants to 
</I>&gt;<i>sit idle and wait for input, you're still going to wake up once every &gt;1/30 second and checking to see if there's anything to do, burning CPU &gt;cycles and battery life.&#160; 
</I>
An approach would be for the reactor tasklet to look at the runnable 
list to see if there are any entries. If there are no entries 
(i.e., tasklets are blocked and dependent on the reactor tasklet), 
then the reactor tasklet can stop the loopingCall. This is easy enough 
to do. However I suspect one starts to get into custom reactor land. 

&gt;<i>Also, if you want to run *faster* than the arbitrary timeout you've
</I>&gt;<i>selected (1/30 second can be a very long time, especially if you're 
</I>&gt;<i>doing something pseudo-realtime, like audio playback) you're out of luck.
</I>
I believe there are two scenarios here:

1) no blocked tasklets and only runnable ones. If the runnable tasklets make no IO requests, it should be possible to put the reactor tasklet to sleep. Let the system run as fast as it can.

2) There is a mix of runnable (scheduled) and blocked tasklets. This
scenario requires a more sophisticated scheduler that is trying to
compute an optimal loopingCall value. This scenario is tricky.

&gt;<i>Better would be to have tasklets schedule *themselves* for when they 
</I>&gt;<i>want to run.&#160; 
</I>
In the Stackless world,  tasklets start running from the moment
they are created/inserted into the runnable list. Stackless in
non-preemptive mode is more about knowing when to make a tasklet 
yield to the scheduler. 

Cheers,
Andrew







      

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020833.html">[Twisted-Python] Using a custom reactor in twisted trial for	test cases?
</A></li>
	<LI>Next message: <A HREF="020838.html">[Twisted-Python] The case of the missing Traceback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20834">[ date ]</a>
              <a href="thread.html#20834">[ thread ]</a>
              <a href="subject.html#20834">[ subject ]</a>
              <a href="author.html#20834">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
