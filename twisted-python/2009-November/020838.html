<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] The case of the missing Traceback
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20The%20case%20of%20the%20missing%20Traceback&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020834.html">
   <LINK REL="Next"  HREF="020839.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] The case of the missing Traceback</H1>
    <B>Dan</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20The%20case%20of%20the%20missing%20Traceback&In-Reply-To="
       TITLE="[Twisted-Python] The case of the missing Traceback">tw.1 at pyxos.com
       </A><BR>
    <I>Tue Nov  3 13:52:45 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="020834.html">[Twisted-Python] Using a custom reactor in twisted trial for	test cases?
</A></li>
        <LI>Next message: <A HREF="020839.html">[Twisted-Python] The case of the missing Traceback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20838">[ date ]</a>
              <a href="thread.html#20838">[ thread ]</a>
              <a href="subject.html#20838">[ subject ]</a>
              <a href="author.html#20838">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
I was playing around with Twisted today and ran into a problem where 
Tracebacks aren't emitted on stderr after a deferred callback from a 
process called launched by reactor.spawnProcess.  The simplified test 
case is below.  I put &quot;x = y&quot; in the  callback function to generate 
an exception, y doesn't exist.  Uncomment &quot;x = z&quot; right before the 
callback and it produces the traceback on stderr just fine.

System is Linux, Python 2.6 and Twisted 8.2.



from twisted.internet import reactor, protocol, defer
import sys


def err(s):
     sys.stderr.write(s+'\n')
     sys.stderr.flush()


def test():
     err('test')
     cat = MyPP()
     reactor.spawnProcess(cat, &quot;/bin/cat&quot;, [&quot;cat&quot;, &quot;-&quot;], {})
     d = cat.send(&quot;Hello world&quot;)
     d.addCallback(response)


def response(resp):
     err('response called')
     x = y
     err(resp)


class MyPP(protocol.ProcessProtocol):
     def __init__(self):
         self.defer = defer.Deferred()

     def outReceived(self, data):
         err(&quot;outReceived! with %d bytes&quot; % len(data))
         err(&quot;    %s&quot; % data)
         self.defer.callback(data)

     def send(self, c):
         self.transport.write(&quot;%s\n&quot; % c)
         #x = z
         return self.defer


if(__name__=='__main__'):
     reactor.callWhenRunning(test)
     reactor.run()




</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020834.html">[Twisted-Python] Using a custom reactor in twisted trial for	test cases?
</A></li>
	<LI>Next message: <A HREF="020839.html">[Twisted-Python] The case of the missing Traceback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20838">[ date ]</a>
              <a href="thread.html#20838">[ thread ]</a>
              <a href="subject.html#20838">[ subject ]</a>
              <a href="author.html#20838">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
