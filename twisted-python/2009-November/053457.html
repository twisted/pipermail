<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Proposal (almost) to switch from Lore to Sphinx
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Proposal%20%28almost%29%20to%20switch%20from%20Lore%20to%20Sphinx&In-Reply-To=%3C562bcc10911120936g48a85732u7c52e7ce6da468e1%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="053458.html">
   <LINK REL="Next"  HREF="053498.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Proposal (almost) to switch from Lore to Sphinx</H1>
    <B>Kevin Horn</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Proposal%20%28almost%29%20to%20switch%20from%20Lore%20to%20Sphinx&In-Reply-To=%3C562bcc10911120936g48a85732u7c52e7ce6da468e1%40mail.gmail.com%3E"
       TITLE="[Twisted-Python] Proposal (almost) to switch from Lore to Sphinx">kevin.horn at gmail.com
       </A><BR>
    <I>Thu Nov 12 10:36:23 MST 2009</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="053458.html">[Twisted-Python] Proposal (almost) to switch from Lore to Sphinx
</A></li>
        <LI>Next message (by thread): <A HREF="053498.html">[Twisted-Python] Proposal (almost) to switch from Lore to Sphinx
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53457">[ date ]</a>
              <a href="thread.html#53457">[ thread ]</a>
              <a href="subject.html#53457">[ subject ]</a>
              <a href="author.html#53457">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Nov 11, 2009 at 11:22 PM, Glyph Lefkowitz
&lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt;wrote:

Excellent.  In that case (modulo several weeks of work on your part), I'm
&gt;<i> sold.
</I>&gt;<i>
</I>
Hooray!


&gt;<i> Hmmm...I hadn't considered the Divmod stuff, but you're right.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I'm glad you think so.  I do tend to be, especially about Twisted ;-).
</I>&gt;<i>
</I>&gt;<i> I think the automated conversion plan is the way to go...up to a point.  As
</I>&gt;<i> I laid out in the proposal, I think at some point, the Sphinx docs (and the
</I>&gt;<i> automated conversion process) will become &quot;good enough&quot;, and then edits
</I>&gt;<i> should be done manually to the ReST/Sphinx source files, rather than the
</I>&gt;<i> Lore files.  Otherwise you just end up with another tool to maintain
</I>&gt;<i> forever.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Well, sure.  The goal of this process is to delete all the lore files and
</I>&gt;<i> check in a bunch of sphinx files which replace them.  This should be done in
</I>&gt;<i> a branch, and reviewed like usual; the automated tool is just to make the
</I>&gt;<i> process easier and more reliable.
</I>&gt;<i>
</I>&gt;<i> You have two options regarding the Divmod projects; either you can make the
</I>&gt;<i> tool good enough that you just run it, or you can commit to putting the work
</I>&gt;<i> into the minor edits to correct the tool's deficiencies on the Divmod lore
</I>&gt;<i> docs _before_ you can remove / desupport twisted.lore.
</I>&gt;<i>
</I>
I think the second option is probably what will end up happening, though it
may not be necessary to do too much of this.  So far, I've only got 3 files
in the Twisted Lore docs that wil definitely need reworking before they can
be processed.  And they have some really strange markup.  So maybe there
won't be too much of this in the Divmod stuff. (crossing fingers!)


&gt;<i> Another thing to note in the migration plan: despite &lt;
</I>&gt;<i> <A HREF="http://twistedmatrix.com/trac/wiki/CompatibilityPolicy">http://twistedmatrix.com/trac/wiki/CompatibilityPolicy</A>&gt;, no deprecation
</I>&gt;<i> period should be necessary for lore, it can just be removed.  It has no
</I>&gt;<i> users that I'm aware of, and if anyone does still use it they can manually
</I>&gt;<i> copy their 'twisted/lore' directory and 'lore' script into new installations
</I>&gt;<i> until they have a chance to run your script.  It's not designed to be used
</I>&gt;<i> as a library anyway; it's a bit of an accident that it's even present in the
</I>&gt;<i> twisted/* tree.
</I>&gt;<i>
</I>&gt;<i> One thing to note in the migration plan is the closing of outstanding
</I>&gt;<i> branches with lore changes in them.  This would be a good topic for a
</I>&gt;<i> sprint.
</I>&gt;<i>
</I>
Yikes.  Another thing I hadn't considered.  Depending on how many branches
there, this could get nasty.  I'll have to do some thinking on this.


&gt;<i> And in my opinion, Twisted needs to get away from having it's own
</I>&gt;<i> collection of self-maintained tools as much as possible. :)
</I>&gt;<i>
</I>&gt;<i> Not just your opinion :).
</I>&gt;<i>
</I>
Glad to hear it :).

I have some basic code for the conversion process, but it's in a VERY
preliminary state, and needs a fair bit of work.  There's still several tags
it doesn't handle at all (including tables, which _might_ be a real beast),
and it needs to be refactored some.  I mostly wrote it as a proof-of-concept
for myself to prove (to myself) that automated conversion was feasible.
 That said, it _will_ generate a buildable Sphinx project (though it's
currently VERY ugly, and generates warning in the hundreds).

If there's interest, I can put up what I can generate to this point, though
it's awfully early days yet.

Release early, release often.  Most efforts like this end up moribund: you
&gt;<i> sound serious right now, but never underestimate the extent to which life
</I>&gt;<i> will get in the way.  If you put up what you've got somewhere public ASAP,
</I>&gt;<i> (A) some people will probably show up to egg you on, (B) it's possible for
</I>&gt;<i> them to contribute (and those contributions will be a motivation on days
</I>&gt;<i> when this seems like a ridiculous amount of effort just to make Twisted's
</I>&gt;<i> docs look nicer), and (C) they can pick up the slack if you need to
</I>&gt;<i> disappear, either temporarily or permanently.
</I>&gt;<i>
</I>
I'll try to put up what I've got later today.



&gt;<i> *don't* try to get your migration tools to the state where they can get
</I>&gt;<i> through Twisted code review, etc.  Hopefully we can throw these away
</I>&gt;<i> quickly.
</I>&gt;<i>
</I>
Roger that.

Also:
&gt;<i> Were my claims/assumption about Lore pretty much correct?  Did I miss
</I>&gt;<i> anything?
</I>&gt;<i>
</I>&gt;<i> Your claim about highlighting only python is correct.  See
</I>&gt;<i> twisted.lore.tree.munge (is it any wonder that we need to replace this
</I>&gt;<i> thing), specifically the bit where it calls fontifyPython and there is no
</I>&gt;<i> definition of fontifyAnythingElse.
</I>&gt;<i>
</I>
Noted.



&gt;<i> The &quot;docs errors throw build warnings&quot; thing is an extremely confusing
</I>&gt;<i> header, although I understand what you're saying.  I'd re-word the whole
</I>&gt;<i> thing in terms of test integration.  But the important point has nothing to
</I>&gt;<i> do with doctest, it's that sphinx has various bits of testing support,
</I>&gt;<i> including &quot;leave the examples outside the documentation so they're just
</I>&gt;<i> regular python and don't need to be parsed&quot;.
</I>&gt;<i>
</I>
I've just removed this whole section, as it _was_ confusing, and also mostly
redundant.



&gt;<i> There's a &quot;*&quot; for &quot;requires plugin&quot; - it's worth mentioning that Sphinx has
</I>&gt;<i> a usable, and more importantly *actually used by some people*, extension
</I>&gt;<i> API, whereas lore's extension mechanisms are... ahem.  Let's not talk about
</I>&gt;<i> lore's extension mechanism.
</I>&gt;<i>
</I>
I've added something about this.



&gt;<i> You do need to address linking *from* sphinx documentation *to* API
</I>&gt;<i> documentation, and ideally, vice versa.  Lore can do the former, via
</I>&gt;<i> 'class=&quot;API&quot;', although pydoctor still has no way to do the latter (see &lt;
</I>&gt;<i> <A HREF="http://twistedmatrix.com/trac/ticket/2801">http://twistedmatrix.com/trac/ticket/2801</A>&gt;).
</I>&gt;<i>
</I>
This should be doable.  Right now I'm thinking of doing something similar to
an existing extension, which creates links to generated Epydoc API docs.
Shouldn't be too hard to do something similar for pyDoctor.  I'll get
something in the proposal.



&gt;<i> I don't know of any other projects (besides the ones on divmod.org) which
</I>&gt;<i> currently use lore.  The only other one I'm aware of that ever did is &lt;
</I>&gt;<i> <A HREF="https://launchpad.net/thinkcspy">https://launchpad.net/thinkcspy</A>&gt;, and they switched to using sphinx input
</I>&gt;<i> a while ago.  Maybe you could bug Jeff Elkner and see if he did any
</I>&gt;<i> automation which might help?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> In your description of 'phase 0', you say &quot;once it has been verified&quot;: be
</I>&gt;<i> specific here.  Nobody is going to want to be the one who actually pulls a
</I>&gt;<i> trigger on a change this big, but it needs to get done.  Propose a specific
</I>&gt;<i> mechanism for the verification.  Lay out a timeline which culminates in the
</I>&gt;<i> ReST files being committed to trunk.  It's too early for specific dates, but
</I>&gt;<i> you can say &quot;first we will do X, then we will do Y&quot;.
</I>&gt;<i>
</I>
I'll try to get this updated a bit later.



&gt;<i> In general though, your representation of Lore seems accurate.
</I>&gt;<i>
</I>&gt;<i> Thanks again for taking this on.  Good luck!
</I>&gt;<i>
</I>
Thanks.  I have a feeling I'll need it :)

Kevin Horn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20091112/44ed29ee/attachment.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="053458.html">[Twisted-Python] Proposal (almost) to switch from Lore to Sphinx
</A></li>
	<LI>Next message (by thread): <A HREF="053498.html">[Twisted-Python] Proposal (almost) to switch from Lore to Sphinx
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53457">[ date ]</a>
              <a href="thread.html#53457">[ thread ]</a>
              <a href="subject.html#53457">[ subject ]</a>
              <a href="author.html#53457">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
