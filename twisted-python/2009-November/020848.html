<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python]  ProducerConsumerProxy problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20%20ProducerConsumerProxy%20problem&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020847.html">
   <LINK REL="Next"  HREF="020849.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python]  ProducerConsumerProxy problem</H1>
    <B>Pietro Niccoli</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=%5BTwisted-Python%5D%20%20ProducerConsumerProxy%20problem&In-Reply-To="
       TITLE="[Twisted-Python]  ProducerConsumerProxy problem">piemail at tiscali.it
       </A><BR>
    <I>Wed Nov  4 15:54:11 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="020847.html">[Twisted-Python] Unpedictable behaviour of transport.write call: Problem with return the control to reactor
</A></li>
        <LI>Next message: <A HREF="020849.html">[Twisted-Python] Trial: testing multiple test modules in one go?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20848">[ date ]</a>
              <a href="thread.html#20848">[ thread ]</a>
              <a href="subject.html#20848">[ subject ]</a>
              <a href="author.html#20848">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
I'm trying to write a simple echo server but with control flow. The program
should send back all the data it receives from a client, but if one of the
clients that are connected stop accepting the data that is sent back, my
program should tell it to stop sending data too, for preventing to run out
of memory. 
I've seen that twisted offers an iConsumer and iProducer classes, so my
class should implement both of them. I know how to write the producer part,
but I still having trouble in telling twisted that my class is a consumer
for the transport. This is because usually in a program, whenever there is
data available, the dataRecived function of the program is called, passing
the data to it, so I don't know who I can pass as a producer for my echo
class.
I know that there's a class called BasicProducerConsumerProxy in pcp that
seems to do my job, but I'm stuck in making it understand that &quot;transport&quot;
is both a consumer and a producer.
The code should be something like this:

Echo = protocols.pcp.BasicProducerConsumerProxy(self.transport) #register
transport as a consumer Echo.registerProducer(self.transport, True)
#register transport as a producer

But it doesn't work. Can you help me? An example will be greatly
appreciated. Thanks.

Pietro


</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020847.html">[Twisted-Python] Unpedictable behaviour of transport.write call: Problem with return the control to reactor
</A></li>
	<LI>Next message: <A HREF="020849.html">[Twisted-Python] Trial: testing multiple test modules in one go?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20848">[ date ]</a>
              <a href="thread.html#20848">[ thread ]</a>
              <a href="subject.html#20848">[ subject ]</a>
              <a href="author.html#20848">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
