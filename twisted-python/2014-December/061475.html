<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Python Twisted Questions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Python%20Twisted%20Questions&In-Reply-To=%3CBE1313DF-AAF9-48B0-9F04-A63C9D656130%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="029012.html">
   <LINK REL="Next"  HREF="029017.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Python Twisted Questions</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20Python%20Twisted%20Questions&In-Reply-To=%3CBE1313DF-AAF9-48B0-9F04-A63C9D656130%40twistedmatrix.com%3E"
       TITLE="[Twisted-Python] Python Twisted Questions">glyph at twistedmatrix.com
       </A><BR>
    <I>Tue Dec  2 18:21:45 MST 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="029012.html">[Twisted-Python] Python Twisted Questions
</A></li>
        <LI>Next message (by thread): <A HREF="029017.html">[Twisted-Python] Silverberg CQL Driver
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61475">[ date ]</a>
              <a href="thread.html#61475">[ thread ]</a>
              <a href="subject.html#61475">[ subject ]</a>
              <a href="author.html#61475">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On Dec 2, 2014, at 23:30, Adam &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">adam at dormchatapp.com</A>&gt; wrote:
</I>
I assume you're using this tutorial?

&lt;<A HREF="http://www.raywenderlich.com/3932/networking-tutorial-for-ios-how-to-create-a-socket-based-iphone-app-and-server">http://www.raywenderlich.com/3932/networking-tutorial-for-ios-how-to-create-a-socket-based-iphone-app-and-server</A> &lt;<A HREF="http://www.raywenderlich.com/3932/networking-tutorial-for-ios-how-to-create-a-socket-based-iphone-app-and-server">http://www.raywenderlich.com/3932/networking-tutorial-for-ios-how-to-create-a-socket-based-iphone-app-and-server</A>&gt;&gt;

It is unfortunate that this has not been updated with better information, it seems to confuse a lot of people making iOS applications ;).
&gt;<i> 1. Please find attached Python script. We have integrated the Twisted framework with iOS for chat module. Attached is our Python demo code in which we have implemented this. The issue is when we try to connect with the server through the terminal, we are getting the complete correct response without any error. But when it was integrated on the iOS app, data is getting received in chunks (i.e. if data exceeds 1366 bytes or above in json size it comes in pieces which creates a problem when sending and receiving chats)
</I>&gt;<i> 
</I>This is a frequently asked question:

&lt;<A HREF="https://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#Whyisprotocol.dataReceivedcalledwithonlypartofthedataIcalledtransport.writewith">https://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#Whyisprotocol.dataReceivedcalledwithonlypartofthedataIcalledtransport.writewith</A> &lt;<A HREF="https://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#Whyisprotocol.dataReceivedcalledwithonlypartofthedataIcalledtransport.writewith">https://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#Whyisprotocol.dataReceivedcalledwithonlypartofthedataIcalledtransport.writewith</A>&gt;&gt;

In other words, if you want a message-oriented protocol, you can't just use dataReceived.

For sending short JSON structures back and forth, line-delimited data structures are a reasonable choice.  On the Twisted side, you can use twisted.protocols.basic.LineReceiver, and override lineReceived instead of dataReceived.

On the iOS side, you need a radically different structure for buffering your input; you can't just stuff it into a buffer on the stack.  One quick hacky way to do this would be to give your object a NSString bufferString instance variable, and do bufferString = [bufferString stringByAppendingString: [[NSString alloc] initWithBytes:buffer length:len encoding:NSASCIIStringEncoding]]; NSArray* lines = [bufferString componentsSeparatedByString: @&quot;\r\n&quot;];, bufferString = [lines lastObject];, then loop over the other items in lines.

Keep in mind you also need to do this for output; as you send output to the server, you may not be able to send all of it at once, so you need to keep a buffer, and keep track of how much you've written, etc.

Or you could just build Python into your app on iOS and run Twisted in there.  If you manage to get that working be sure to let us know how it goes :-).  I am lead to believe that &lt;<A HREF="http://omz-software.com/pythonista/">http://omz-software.com/pythonista/</A>&gt; contains a template for at least getting the Python runtime going...

-glyph
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-python/attachments/20141203/bef4468e/attachment-0002.html&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="029012.html">[Twisted-Python] Python Twisted Questions
</A></li>
	<LI>Next message (by thread): <A HREF="029017.html">[Twisted-Python] Silverberg CQL Driver
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61475">[ date ]</a>
              <a href="thread.html#61475">[ thread ]</a>
              <a href="subject.html#61475">[ subject ]</a>
              <a href="author.html#61475">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
