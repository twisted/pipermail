<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-Python] Python Twisted Questions​​​​
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20%3D%3Futf-8%3Fq%3FPython_Twisted_Questions%3DE2%3D80%3D8B%3F%3D%0A%20%3D%3Futf-8%3Fb%3F4oCL4oCL4oCL%3F%3D&In-Reply-To=%3C1418927477437.094c5a46%40Nodemailer%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="061498.html">
   <LINK REL="Next"  HREF="029041.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-Python] Python Twisted Questions​​​​</H1>
    <B>Adam Michalski</B> 
    <A HREF="mailto:twisted-python%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-Python%5D%20%3D%3Futf-8%3Fq%3FPython_Twisted_Questions%3DE2%3D80%3D8B%3F%3D%0A%20%3D%3Futf-8%3Fb%3F4oCL4oCL4oCL%3F%3D&In-Reply-To=%3C1418927477437.094c5a46%40Nodemailer%3E"
       TITLE="[Twisted-Python] Python Twisted Questions​​​​">adam at dormchatapp.com
       </A><BR>
    <I>Thu Dec 18 11:31:18 MST 2014</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="061498.html">[Twisted-Python] Tubes!
</A></li>
        <LI>Next message (by thread): <A HREF="029041.html">[Twisted-Python] Scrapy spiders waiting in reactor thread when callFromThread gets call repeatedly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29039">[ date ]</a>
              <a href="thread.html#29039">[ thread ]</a>
              <a href="subject.html#29039">[ subject ]</a>
              <a href="author.html#29039">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi All!
 &#160;
 Thanks so much for the response. We&#8217;ve looked into it and here are our findings:
 &#160;
 &#160;
 We have implemented Linereceiver in our original script to receive the data.
 &#160;
 It&#8217;s working successfully if we connect to the server through terminal &#8211; i.e. we&#8217;re getting proper input from terminal client and also proper response is received to the terminal client.
 &#160;
 It fails when we try to integrate this with the iOS. i.e. it&#8217;s connecting to the server successfully but not getting the inputs properly from the iOS client.
 &#160;
 e.g., if the command is:
 &#160;
 &quot;demo:{&quot;userid&quot;:&quot;1&quot;,&quot;chatroomid&quot;:&quot;1&quot;}&quot;
 &#160;
 On server I am getting the below:
 &#160;
 demo:{
 &#160;
 Please find attached the python script.
 &#160;
 Note: This seems to be an iOS specific Python issue - when running the same script from Mac OS X it is functioning as expected. If there&#8217;s anyone you believe we should redirect the question towards, just let me know. :)
 &#160;
 Again, I really appreciate your help with this. You&#8217;ve been super helpful.
 &#160;
 -Adam
 Founder, DormChat
 dormchat.com
 
 
Begin forwarded message:

On Tuesday, Dec 2, 2014 at 8:22 PM, Glyph &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">glyph at twistedmatrix.com</A>&gt;, wrote:


 On Dec 2, 2014, at 23:30, Adam &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">adam at dormchatapp.com</A>&gt; wrote: 

I assume you're using this tutorial?
 

 &lt;<A HREF="http://www.raywenderlich.com/3932/networking-tutorial-for-ios-how-to-create-a-socket-based-iphone-app-and-server">http://www.raywenderlich.com/3932/networking-tutorial-for-ios-how-to-create-a-socket-based-iphone-app-and-server</A>&gt;
 

 It is unfortunate that this has not been updated with better information, it seems to confuse a lot of people making iOS applications ;).
  1. Please find attached Python script.&#160;We have integrated the Twisted framework with iOS for chat module. Attached is our Python demo code in which we have implemented this. The issue is when we try to connect with the server through the terminal, we are getting the complete correct response without any error. But when it was integrated on the iOS app, data is getting received in chunks (i.e. if data exceeds 1366 bytes or above in json size it comes in pieces which creates a problem when sending and receiving chats)

This is a frequently asked question:
 

 &lt;<A HREF="https://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#Whyisprotocol.dataReceivedcalledwithonlypartofthedataIcalledtransport.writewith">https://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#Whyisprotocol.dataReceivedcalledwithonlypartofthedataIcalledtransport.writewith</A>&gt;

 
In other words, if you want a message-oriented protocol, you can't just use dataReceived.
 

 For sending short JSON structures back and forth, line-delimited data structures are a reasonable choice. &#160;On the Twisted side, you can use twisted.protocols.basic.LineReceiver, and override lineReceived instead of dataReceived.
 

 On the iOS side, you need a radically different structure for buffering your input; you can't just stuff it into a buffer on the stack. &#160;One quick hacky way to do this would be to give your object a NSString bufferString instance variable, and do bufferString = [bufferString stringByAppendingString: [[NSString&#160;alloc]&#160;initWithBytes:buffer length:len encoding:NSASCIIStringEncoding]]; NSArray* lines = [bufferString componentsSeparatedByString: @&quot;\r\n&quot;];, bufferString = [lines lastObject];, then loop over the other items in lines.
 

 Keep in mind you also need to do this for output; as you send output to the server, you may not be able to send all of it at once, so you need to keep a buffer, and keep track of how much you've written, etc.
 

 Or you could just build Python into your app on iOS and run Twisted in there. &#160;If you manage to get that working be sure to let us know how it goes :-). &#160;I am lead to believe that &lt;<A HREF="http://omz-software.com/pythonista/">http://omz-software.com/pythonista/</A>&gt; contains a template for at least getting the Python runtime going...
 

 -glyph
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20141218/bee2460f/attachment.html">http://twistedmatrix.com/pipermail/twisted-python/attachments/20141218/bee2460f/attachment.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: newdemo.py
Type: application/octet-stream
Size: 9196 bytes
Desc: not available
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-python/attachments/20141218/bee2460f/attachment.obj">http://twistedmatrix.com/pipermail/twisted-python/attachments/20141218/bee2460f/attachment.obj</A>&gt;
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="061498.html">[Twisted-Python] Tubes!
</A></li>
	<LI>Next message (by thread): <A HREF="029041.html">[Twisted-Python] Scrapy spiders waiting in reactor thread when callFromThread gets call repeatedly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29039">[ date ]</a>
              <a href="thread.html#29039">[ thread ]</a>
              <a href="subject.html#29039">[ subject ]</a>
              <a href="author.html#29039">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python">More information about the Twisted-Python
mailing list</a><br>
</body></html>
