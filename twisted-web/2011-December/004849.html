<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] manually inject data into a site object
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20manually%20inject%20data%20into%20a%20site%20object&In-Reply-To=CAJcq2s0K%3DjttH18SE-SnfRXJaWmSrryZT2i-7Eb-uC%3Dg2FWxHw%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004848.html">
   <LINK REL="Next"  HREF="004850.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] manually inject data into a site object</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20manually%20inject%20data%20into%20a%20site%20object&In-Reply-To=CAJcq2s0K%3DjttH18SE-SnfRXJaWmSrryZT2i-7Eb-uC%3Dg2FWxHw%40mail.gmail.com"
       TITLE="[Twisted-web] manually inject data into a site object">glyph at twistedmatrix.com
       </A><BR>
    <I>Thu Dec 29 18:26:46 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="004848.html">[Twisted-web] manually inject data into a site object
</A></li>
        <LI>Next message: <A HREF="004850.html">[Twisted-web] Noob question about POST
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4849">[ date ]</a>
              <a href="thread.html#4849">[ thread ]</a>
              <a href="subject.html#4849">[ subject ]</a>
              <a href="author.html#4849">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Dec 26, 2011, at 5:48 PM, gary jefferson wrote:

&gt;<i> I have a web service written in twisted-web.
</I>&gt;<i> 
</I>&gt;<i> I have it running behind a NAT.
</I>&gt;<i> 
</I>&gt;<i> I have a component (based on twisted Protocol) that makes a connection
</I>&gt;<i> out from behind the NAT to a relay. Let's call this ReverseThing.
</I>
Since you're mentioning Twisted and NAT, I feel obliged to direct your attention to Vertex, which sorta solves some of these problems but badly needs a maintainer:

<A HREF="http://pypi.python.org/pypi/Vertex">http://pypi.python.org/pypi/Vertex</A>

It may not be relevant to your use-case though (and isn't relevant to your question at all).

&gt;<i> Web clients can connect to the relay to send data back over this ReverseThing.
</I>&gt;<i> 
</I>&gt;<i> Once I receive the data, how can I inject it directly into the web
</I>&gt;<i> service? Assume both these services run in the same twisted process.
</I>&gt;<i> 
</I>&gt;<i> Here's what I've tried: I can pass in the Site object to the
</I>&gt;<i> ReverseThing protocol, so that I can call p=buildProtocol() on it,
</I>&gt;<i> then I can call dataReceived() manually on that p. But obviously this
</I>&gt;<i> doesn't work, because there isn't really a transport object to call
</I>&gt;<i> things like getPeer() on.
</I>
You must call makeConnection(transport) on a Protocol before you call dataReceived.  So make a Transport object - you don't need a &quot;real&quot; one that represents a socket, just something that implements &lt;twistedmatrix.com/documents/current/api/twisted.internet.interfaces.ITransport.html&gt;.

Many tests use in-memory or otherwise faked transport objects.  Protocols must be able to deal with alternate transport implementations, at the very least in order to be able to use encrypted connections.  As of Twisted 11.1, the TLS transport is always a different object, presuming you have a recent enough version of pyOpenSSL.

&gt;<i> Is there some other way to send data to a Site, without it actually
</I>&gt;<i> coming over the wire?
</I>
You're 90% of the way there already, and you have the right idea :).

-glyph


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004848.html">[Twisted-web] manually inject data into a site object
</A></li>
	<LI>Next message: <A HREF="004850.html">[Twisted-web] Noob question about POST
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4849">[ date ]</a>
              <a href="thread.html#4849">[ thread ]</a>
              <a href="subject.html#4849">[ subject ]</a>
              <a href="author.html#4849">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
