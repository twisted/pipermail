<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Question regarding custom contextFactory for twisted.web.client.Agent
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-web%5D%20Question%20regarding%20custom%20contextFactory%20for%0A%20twisted.web.client.Agent&In-Reply-To=%3C6D4A3C18-0154-4C8A-BD3F-93CD0934B5AB%40twistedmatrix.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="005298.html">
   <LINK REL="Next"  HREF="005300.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Question regarding custom contextFactory for twisted.web.client.Agent</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-web%5D%20Question%20regarding%20custom%20contextFactory%20for%0A%20twisted.web.client.Agent&In-Reply-To=%3C6D4A3C18-0154-4C8A-BD3F-93CD0934B5AB%40twistedmatrix.com%3E"
       TITLE="[Twisted-web] Question regarding custom contextFactory for twisted.web.client.Agent">glyph at twistedmatrix.com
       </A><BR>
    <I>Sun May 14 19:49:43 MDT 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005298.html">[Twisted-web] Question regarding custom contextFactory for twisted.web.client.Agent
</A></li>
        <LI>Next message (by thread): <A HREF="005300.html">[Twisted-web] Question regarding custom contextFactory for twisted.web.client.Agent
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5299">[ date ]</a>
              <a href="thread.html#5299">[ thread ]</a>
              <a href="subject.html#5299">[ subject ]</a>
              <a href="author.html#5299">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> On May 13, 2017, at 7:36 PM, Jason Litzinger &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">jlitzingerdev at gmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> This sounds eminently sensible, and in fact sounds like Twisted, or Treq at least, really ought to do something like this on our end with some kind of small LRU cache, keeping the most-used N hostnames (where N defaults to some small number, say, 20).  I'm surprised to hear it is such a big optimization, but surprises like that are entirely the point of performance testing!
</I>&gt;<i> Thanks for taking a look!
</I>&gt;<i> 
</I>&gt;<i> I like the idea of an LRU for the last N hosts.  Given I have something
</I>&gt;<i> prototyped that I will expand on, that isn't much of a stretch.  If
</I>&gt;<i> you think it might be useful to Twisted then I can try to iterate the
</I>&gt;<i> patch until it is either rejected or accepted (following the well
</I>&gt;<i> documented steps for contributing of course), thoughts?
</I>
This sounds like exactly what you should do.  (Keeping in mind that very nearly 100% of patches are &quot;rejected&quot; on their first attempt, so please do resubmit :))

&gt;<i> If it fits more in treq then I'm more than happy to share the code, but,
</I>&gt;<i> since I'm not currently using treq the amount of effort I can
</I>&gt;<i> realistically put towards it isn't as high, though that project is very
</I>&gt;<i> appealing.
</I>
Probably the best place to put it would be Twisted proper.  I just mentioned Treq because sometimes utility functionality like this can become surprisingly complex and have a lot of dependencies, and pin Treq it's easier to make the case that it's a high-level API that should just always do the right thing, as opposed to Agent which needs to preserve maximum flexibility for all HTTP client applications.

&gt;<i> On the size of the performance increase -- I was surprised as well, and
</I>&gt;<i> there's always the possibility I made an error, but it was consistent
</I>&gt;<i> across the five tests I ran.  Regardless, I'll be doing more profiling as
</I>&gt;<i> I work toward the final implementation.
</I>
Like I said, if we were never surprised we wouldn't have to have tests :-).

&gt;&gt;<i> Nevertheless, thanks for asking!  I really wish people would ask questions about client TLS more often before doing something potentially insecure :).  In this case, the client connection creator is used to produce client connections anyway, and the connections are not shared, so there should be no worrisome mingling of state between connections.
</I>&gt;<i> Agree.  I've come to believe that assumptions mixed with TLS/security
</I>&gt;<i> related issues are my worst enemy.
</I>
Not just yours; the latin for &quot;HTTP-only hist&quot; is &quot;hostis humani generis&quot;.

&gt;<i> -Jason
</I>&gt;<i> 
</I>&gt;<i> * Completely unrelated - I still owe on my committment to ticket
</I>&gt;<i>  6597...yeah, life happened.  Luckily I saved my notes now that I'm
</I>&gt;<i>  finding some time here and there.
</I>
We do what we must, because we can.

-glyph

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005298.html">[Twisted-web] Question regarding custom contextFactory for twisted.web.client.Agent
</A></li>
	<LI>Next message (by thread): <A HREF="005300.html">[Twisted-web] Question regarding custom contextFactory for twisted.web.client.Agent
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5299">[ date ]</a>
              <a href="thread.html#5299">[ thread ]</a>
              <a href="subject.html#5299">[ subject ]</a>
              <a href="author.html#5299">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
