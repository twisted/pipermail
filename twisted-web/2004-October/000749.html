<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Passing context through/around/across webform
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Passing%20context%20through/around/across%20webform&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000787.html">
   <LINK REL="Next"  HREF="000750.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Passing context through/around/across webform</H1>
    <B>Alex Levy</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Passing%20context%20through/around/across%20webform&In-Reply-To="
       TITLE="[Twisted-web] Passing context through/around/across webform">mesozoic at polynode.com
       </A><BR>
    <I>Mon Oct 18 07:52:08 MDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000787.html">[Twisted-web] HTTP/1.1 Persistent Connections and Pipelining
</A></li>
        <LI>Next message: <A HREF="000750.html">[Twisted-web] Passing context through/around/across webform
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#749">[ date ]</a>
              <a href="thread.html#749">[ thread ]</a>
              <a href="subject.html#749">[ subject ]</a>
              <a href="author.html#749">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>So I've started to move Payago (formerly Go) towards compatibility with
Nevow 0.3's API changes; the biggest impact has been the ubiquitous context,
and not being able to rely on a Page having self.context.

Previously, I had _many_ TypedInterfaces which did something along the lines
of:

class ICanDoSomething(TypedInterface):
  def doSomething(self, arg = Choice(choicesAttribute='choices')):
    pass
  doSomething = autocallable(doSomething)

class MyPage(Page):
  __implements__ = ICanDoSomething
  def _get_choices(self):
    ## do something involving self.context
    return some_list
  choices = property(_get_choices)

Now, with the ubiquitous context changes, self.context doesn't exist. (Makes
you wonder what &quot;ubiquitous&quot; really means.) So there are a couple solutions
that I've thought of:

1. Make annotate.Choice support 'choicesMethod', which would take context as
an argument. This seems very difficult because not only webform, but
Typed.coerce(), would have to be able to retrieve the context. Then we'd
have to support Deferreds, because some crazy person would obviously want
that at some point. ;) I tried to write a patch, and it got ugly.

2. Set self.context whenever Page.locateChild or Page.renderHTTP is called.
This is a lot simpler, but it seems like a hack to me, and I'm not sure
whether this will _always_ work.

What do other people think? Is option #1 easier to implement than I'm
thinking? Is option #2 safer than it seems to me? Is there an option #3 that
I don't see right now?

-- 
Alex Levy
WWW: <A HREF="http://mesozoic.geecs.org/">http://mesozoic.geecs.org/</A>
 
&quot;Never let your sense of morals prevent you from doing what is right.&quot;
 -- Salvor Hardin, Isaac Asimov's _Foundation_

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000787.html">[Twisted-web] HTTP/1.1 Persistent Connections and Pipelining
</A></li>
	<LI>Next message: <A HREF="000750.html">[Twisted-web] Passing context through/around/across webform
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#749">[ date ]</a>
              <a href="thread.html#749">[ thread ]</a>
              <a href="subject.html#749">[ subject ]</a>
              <a href="author.html#749">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
