<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] txJSONRPC: issue accesson Session information and	returning error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20txJSONRPC%3A%20issue%20accesson%20Session%20information%20and%0A%09returning%20error&In-Reply-To=4D42076D.2090901%40goffi.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004618.html">
   <LINK REL="Next"  HREF="004620.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] txJSONRPC: issue accesson Session information and	returning error</H1>
    <B>Phil Christensen</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20txJSONRPC%3A%20issue%20accesson%20Session%20information%20and%0A%09returning%20error&In-Reply-To=4D42076D.2090901%40goffi.org"
       TITLE="[Twisted-web] txJSONRPC: issue accesson Session information and	returning error">phil at bubblehouse.org
       </A><BR>
    <I>Fri Jan 28 11:04:25 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="004618.html">[Twisted-web] txJSONRPC: issue accesson Session information and	returning error
</A></li>
        <LI>Next message: <A HREF="004620.html">[Twisted-web] txJSONRPC: issue accesson Session information	and	returning error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4619">[ date ]</a>
              <a href="thread.html#4619">[ thread ]</a>
              <a href="subject.html#4619">[ subject ]</a>
              <a href="author.html#4619">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Jan 27, 2011, at 7:01 PM, goffi wrote:
&gt;<i> G'day everybody,
</I>&gt;<i> 
</I>&gt;<i> I'm using TxJSON-RPC with twisted.web for a project.
</I>&gt;<i> In my JSON-RPC method, I want to access the Request instance to call 
</I>&gt;<i> getSession() (I need to identify the user which is calling the method 
</I>&gt;<i> with the Session instance), but the request object is not forwarded to 
</I>&gt;<i> jsonrpc_xxx methods. I don't see any other way than overidding the 
</I>&gt;<i> render method, is there any better way ?
</I>
Technically, no. The issue is just that your approach wouldn't exactly be the &quot;twisted way&quot;.

Instead, in one of your getChild/locateChild methods, you should be passing the user info as an argument to the constructor for your JSON-RPC resource instance, and saving it as an instance attribute. This will allow you to test your RPC resource more easily as well.

Ideally, you'll only use that user info for data purposes, not to delegate access to some method. If different users are to have different abilities, they should get different kinds of resource instances returned. But for simpler security setups, it's okay to cheat and just throw in a few if-statements.

&gt;<i> My other issue is that I want to be able to return a jsonrpc error (when 
</I>&gt;<i> the user is not identified), and when I send a 
</I>&gt;<i> jsonrpclib.Fail(12,&quot;hello&quot;) like in the tests, I have a HTML 500 error. 
</I>&gt;<i> Any suggestion ?
</I>
I think you might just need to use jsonrpclib.Fault, not Fail.

-phil
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004618.html">[Twisted-web] txJSONRPC: issue accesson Session information and	returning error
</A></li>
	<LI>Next message: <A HREF="004620.html">[Twisted-web] txJSONRPC: issue accesson Session information	and	returning error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4619">[ date ]</a>
              <a href="thread.html#4619">[ thread ]</a>
              <a href="subject.html#4619">[ subject ]</a>
              <a href="author.html#4619">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
