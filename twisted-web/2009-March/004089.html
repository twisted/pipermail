<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Separate function for relative redirects in 
	HTTPClientFactory
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Separate%20function%20for%20relative%20redirects%20in%20%0A%09HTTPClientFactory&In-Reply-To=2ead2fb0903050927o4776fe8bw33dfb56f31921bd5%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004088.html">
   <LINK REL="Next"  HREF="004090.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Separate function for relative redirects in 
	HTTPClientFactory</H1>
    <B>David Reid</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Separate%20function%20for%20relative%20redirects%20in%20%0A%09HTTPClientFactory&In-Reply-To=2ead2fb0903050927o4776fe8bw33dfb56f31921bd5%40mail.gmail.com"
       TITLE="[Twisted-web] Separate function for relative redirects in 
	HTTPClientFactory">dreid at dreid.org
       </A><BR>
    <I>Thu Mar  5 13:27:08 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004088.html">[Twisted-web] Separate function for relative redirects in
	HTTPClientFactory
</A></li>
        <LI>Next message: <A HREF="004090.html">[Twisted-web] Separate function for relative redirects in
	HTTPClientFactory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4089">[ date ]</a>
              <a href="thread.html#4089">[ thread ]</a>
              <a href="subject.html#4089">[ subject ]</a>
              <a href="author.html#4089">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I would suggest rewriting the test cases so you don't need to use an
internal webserver.  You really just need to be able to send blobs of data
to the HTTP client that contain different response codes and Location
headers.

I believe there are already some tests in twisted.web.test.test_webclient
that do this, such as:

<A HREF="http://twistedmatrix.com/trac/browser/trunk/twisted/web/test/test_webclient=">http://twistedmatrix.com/trac/browser/trunk/twisted/web/test/test_webclient=</A>
.py#L172
<A HREF="http://twistedmatrix.com/trac/browser/trunk/twisted/web/test/test_webclient=">http://twistedmatrix.com/trac/browser/trunk/twisted/web/test/test_webclient=</A>
.py#L711

Plus there are numerous other examples in twisted of not relying on even the
loopback network interface for tests.

-David

On Thu, Mar 5, 2009 at 9:27 AM, Aaron DeVore &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">aaron.devore at gmail.com</A>&gt; wrote:

&gt;<i> Last night I restarted my work on relative redirects in
</I>&gt;<i> HTTPClientFactory (Ticket #3384). What I had forgotten was how
</I>&gt;<i> insanely difficult it is to write the test cases, which would then be
</I>&gt;<i> significantly more bug prone than the code itself. The problem is that
</I>&gt;<i> for every possible input I need to add (1) A test_* function, (2) a
</I>&gt;<i> callback, (3) one or more children to the internal web server for the
</I>&gt;<i> test_* function to connect to.
</I>&gt;<i>
</I>&gt;<i> This morning I hit on another idea: Why not separate the code in
</I>&gt;<i> HTTPClientFactory that does the fix into a separate function? Then
</I>&gt;<i> there could be one test case to make sure the code in
</I>&gt;<i> HTTPClientFactory works, then a single test case that contains a
</I>&gt;<i> series of assertEquals that test the output of the function. How does
</I>&gt;<i> that sound? Should I put it outside of HTTPClientFactory or inside?
</I>&gt;<i>
</I>&gt;<i> Cheers!
</I>&gt;<i> Aaron DeVore
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-web mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">Twisted-web at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20090305/01=">http://twistedmatrix.com/pipermail/twisted-web/attachments/20090305/01=</A>
5589ae/attachment.htm
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004088.html">[Twisted-web] Separate function for relative redirects in
	HTTPClientFactory
</A></li>
	<LI>Next message: <A HREF="004090.html">[Twisted-web] Separate function for relative redirects in
	HTTPClientFactory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4089">[ date ]</a>
              <a href="thread.html#4089">[ thread ]</a>
              <a href="subject.html#4089">[ subject ]</a>
              <a href="author.html#4089">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
