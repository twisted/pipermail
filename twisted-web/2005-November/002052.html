<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Weird problem with XMLRPC -&gt; ('405',
	'Method Not Allowed')
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Weird%20problem%20with%20XMLRPC%20-%3E%20%28%27405%27%2C%0A%09%27Method%20Not%20Allowed%27%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002051.html">
   <LINK REL="Next"  HREF="002053.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Weird problem with XMLRPC -&gt; ('405',
	'Method Not Allowed')</H1>
    <B>Remi Cool</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Weird%20problem%20with%20XMLRPC%20-%3E%20%28%27405%27%2C%0A%09%27Method%20Not%20Allowed%27%29&In-Reply-To="
       TITLE="[Twisted-web] Weird problem with XMLRPC -&gt; ('405',
	'Method Not Allowed')">mailinglists at smartology.nl
       </A><BR>
    <I>Thu Nov 10 01:12:02 MST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002051.html">[Twisted-web] Re: why doesn't work nevow.example.callremote with IE
	(InternetExplorer)?
</A></li>
        <LI>Next message: <A HREF="002053.html">[Twisted-web] Weird problem with XMLRPC -&gt; ('405',	'Method Not
	Allowed')
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2052">[ date ]</a>
              <a href="thread.html#2052">[ thread ]</a>
              <a href="subject.html#2052">[ subject ]</a>
              <a href="author.html#2052">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've run into a problem with my twisted xmlrpc test server (using
twisted version 2.01 or 2.1).

Every time the client calls the echo function a '405 Method Not Allowed
is returned'.

This code ran in Twisted 1.3 without problems ... what's changed besides the zope interface 
implements.

Any ideas?

Here's the server code:

#!/usr/bin/env python
# -*- coding: iso-8859-15 -*-

&quot;&quot;&quot;&quot;&quot;&quot;
import sys

from twisted.application import internet, service
from twisted.internet import reactor, protocol, defer
from twisted.web import resource, server, static, xmlrpc
from twisted.python import components, rebuild
from zope.interface import Interface, implements


class myXMLRPC(xmlrpc.XMLRPC):
    &quot;&quot;&quot;This class contains all root xmlrpc methods and the modules
subhandler.&quot;&quot;&quot;
    def __init__(self, service):
        xmlrpc.XMLRPC.__init__(self)
        self.service = service
   
    def xmlrpc_echo(self, x):
        &quot;&quot;&quot;Simple echo function&quot;&quot;&quot;
        return x
       
   
def catchError(err):
    return &quot;Internal error in server&quot;
   
   
class IowwService(components.Interface):
    &quot;&quot;&quot;&quot;&quot;&quot;
    def rebuild(self, modname):
        &quot;&quot;&quot;Rebuild classes in given module&quot;&quot;&quot;
       

class httpResource(resource.Resource):

    implements(resource.IResource)
   
    def __init__(self, service):
        resource.Resource.__init__(self)
        self.service = service
        self.putChild('RPC2', myXMLRPC(self.service))      

    def render(self, request):
        self._clientIP = request.getClientIP()
        return resource.Resource.render(self, request)

    def render_GET(self, request):
        &quot;&quot;&quot;Process HTTP GET Requests.&quot;&quot;&quot;
        return '&lt;html&gt;&lt;body&gt;&lt;h3&gt;Not Implemented&lt;/h3&gt;&lt;/body&gt;&lt;/html&gt;'
       
    def getChild(self, path, request):
        &quot;&quot;&quot;This method handles http calls&quot;&quot;&quot;
        return httpResource(self.service)

components.registerAdapter(httpResource, IowwService, resource.IResource)


class owwService(service.Service):
    &quot;&quot;&quot;&quot;&quot;&quot;
    implements(IowwService)
   
    def rebuild(self, modname):
        &quot;&quot;&quot;Rebuild classes in given module&quot;&quot;&quot;
        mod = sys.modules[modname]
        rebuild.rebuild(mod)

       
def main():
    &quot;&quot;&quot;&quot;&quot;&quot;
    application = service.Application('OWW', uid=100, gid=100)
    s = owwService()
    serviceCollection = service.IServiceCollection(application)
    internet.TCPServer(7080,
server.Site(resource.IResource(s))).setServiceParent(serviceCollection)
    serviceCollection.startService() 
    reactor.run()

if __name__ == '__main__':
    main()


And the client code:

#!/usr/bin/env python

from twisted.web.xmlrpc import Proxy
from twisted.internet import reactor

def printValue(value):
    print repr(value)
    reactor.stop()

def printError(error):
    print 'error', error
    reactor.stop()

proxy = Proxy('<A HREF="http://localhost:7080'">http://localhost:7080'</A>)
proxy.callRemote('echo', 'hello world').addCallbacks(printValue, printError)
reactor.run()


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002051.html">[Twisted-web] Re: why doesn't work nevow.example.callremote with IE
	(InternetExplorer)?
</A></li>
	<LI>Next message: <A HREF="002053.html">[Twisted-web] Weird problem with XMLRPC -&gt; ('405',	'Method Not
	Allowed')
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2052">[ date ]</a>
              <a href="thread.html#2052">[ thread ]</a>
              <a href="subject.html#2052">[ subject ]</a>
              <a href="author.html#2052">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
