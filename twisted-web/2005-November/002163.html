<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Nevow Athena LiveFragment without allowedMethods
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Nevow%20Athena%20LiveFragment%20without%20allowedMethods&In-Reply-To=20051201001314.1217.924541710.divmod.quotient.2242%40ohm">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002162.html">
   <LINK REL="Next"  HREF="002164.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Nevow Athena LiveFragment without allowedMethods</H1>
    <B>Paul Reznicek</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Nevow%20Athena%20LiveFragment%20without%20allowedMethods&In-Reply-To=20051201001314.1217.924541710.divmod.quotient.2242%40ohm"
       TITLE="[Twisted-web] Nevow Athena LiveFragment without allowedMethods">maillists at ivsn.com
       </A><BR>
    <I>Wed Nov 30 22:14:25 MST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002162.html">[Twisted-web] Nevow Athena LiveFragment without allowedMethods
</A></li>
        <LI>Next message: <A HREF="002164.html">[Twisted-web] lightweight forms thing for use with athena ???
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2163">[ date ]</a>
              <a href="thread.html#2163">[ thread ]</a>
              <a href="subject.html#2163">[ subject ]</a>
              <a href="author.html#2163">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jean-Paul Calderone wrote:
&gt;<i> I'm wary of making it possible to accidentally expose a method to the 
</I>&gt;<i> client.  Without allowMethods, it seems to be a quite simple to 
</I>&gt;<i> accidentally expose things.  For example, with your patch, the following 
</I>&gt;<i> methods can be invoked by the client on any LiveFragment:
</I>&gt;<i> 
</I>&gt;<i>  get
</I>&gt;<i>  rend
</I>...
&gt;<i>  postForm
</I>&gt;<i> 
</I>...
&gt;<i> With the above list of methods in mind, does it make more sense why 
</I>&gt;<i> allowedMethods is present?
</I>
Dear Jean-Paul,

You're right, it could be dangerous, but I'm soooo lazy for typing too much!

Attached is a revisited patch, that fulfill the security and make the allowedMethods
at the same time unnecessary - this version allow only usage of NEW methods
in the subclass, no superclass methods or overriding of them are accepted, try it...
Could it be a way?

Paul
-------------- next part --------------
Index: athena.py 
=================================================================== 
--- athena.py	(Revision 3368) 
+++ athena.py	(Arbeitskopie) 
@@ -407,21 +407,19 @@ 
  
             &lt;form onsubmit=&quot;Nevow.Athena.refByDOM(this).callRemote('foo', bar); return false;&quot;&gt; 
  
-    By default, only methods named in the C{allowedMethods} mapping 
-    may be invoked by the client. 
     &quot;&quot;&quot; 
  
-    allowedMethods = {} 
- 
     def rend(self, context, data): 
         myID = self.page.addLocalObject(self) 
         context.fillSlots('nevow:athena_id', myID) 
         return super(LiveFragment, self).rend(context, data) 
  
     def locateMethod(self, ctx, methodName): 
-        if methodName in self.allowedMethods: 
-            return getattr(self, methodName) 
-        raise AttributeError(methodName) 
+        if not hasattr(super(LiveFragment, self), methodName): 
+            method = getattr(self, methodName, None) 
+            if method: 
+                return method 
+        raise AttributeError, 'Method &quot;%s&quot; not allowed' % methodName 
  
  
 # Helper for docFactories defined with stan: 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002162.html">[Twisted-web] Nevow Athena LiveFragment without allowedMethods
</A></li>
	<LI>Next message: <A HREF="002164.html">[Twisted-web] lightweight forms thing for use with athena ???
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2163">[ date ]</a>
              <a href="thread.html#2163">[ thread ]</a>
              <a href="subject.html#2163">[ subject ]</a>
              <a href="author.html#2163">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
