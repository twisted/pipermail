<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] HTTP-AUTH for web2 / Kudos on web2's operation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20HTTP-AUTH%20for%20web2%20/%20Kudos%20on%20web2%27s%20operation&In-Reply-To=EEE75A9C-2BAD-44CB-9FE6-4E1BCD354549%40fuhm.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002101.html">
   <LINK REL="Next"  HREF="002074.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] HTTP-AUTH for web2 / Kudos on web2's operation</H1>
    <B>glyph at divmod.com</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20HTTP-AUTH%20for%20web2%20/%20Kudos%20on%20web2%27s%20operation&In-Reply-To=EEE75A9C-2BAD-44CB-9FE6-4E1BCD354549%40fuhm.net"
       TITLE="[Twisted-web] HTTP-AUTH for web2 / Kudos on web2's operation">glyph at divmod.com
       </A><BR>
    <I>Fri Nov 18 14:02:26 MST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002101.html">[Twisted-web] HTTP-AUTH for web2 / Kudos on web2's operation
</A></li>
        <LI>Next message: <A HREF="002074.html">[Twisted-web] Concurrency in a twisted.web application
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2108">[ date ]</a>
              <a href="thread.html#2108">[ thread ]</a>
              <a href="subject.html#2108">[ subject ]</a>
              <a href="author.html#2108">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 18 Nov 2005 02:12:42 -0500, James Y Knight &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">foom at fuhm.net</A>&gt; wrote:

&gt;<i>On Nov 17, 2005, at 8:17 AM, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">glyph at divmod.com</A> wrote:
</I>
&gt;<i>Just some random thoughts on authentication. Userid information can  come 
</I>&gt;<i>into the app in a wide variety of ways: (...) it has to 
</I>&gt;<i>be passed through to the rest  of the site, including passing it on 
</I>&gt;<i>externally via *CGI outgoing  REQUEST_USER.
</I>
&gt;<i>I find that operation to be conceptually separate from the operation  of 
</I>&gt;<i>&quot;given an authenticated userid, give me his toplevel Resource&quot;.  Also  
</I>&gt;<i>completely separate is &quot;gimme a new session&quot;. That current guard  merges all 
</I>&gt;<i>three together into one operation is where I've always had  trouble with it. 
</I>&gt;<i>Sometimes the three intersect, sometimes they don't,  it depends upon the 
</I>&gt;<i>application.
</I>
There are definitely at least 2 separate levels of abstraction here.

At one level, you are dealing with HTTP objects.  You have resources, and you have essentially meaningless strings that allegedly represent usernames (or form fields) which must be passed to other things which require access to a username.  This is entirely a wiring problem, and the solution is irrelevant to application developers.  No request-specific application data passing APIs are required for this because all the information you just described is part of each HTTP request itself.

At another level, you are authenticating a user to an application written using Twisted.  The way Twisted applications should do this is using cred, and the web way to use cred is with guard.

Application authors are welcome to use the HTTP protocol and resource model traversal code to do something else, if their application requires it.  However, providing discrete, optional APIs for session-creation, credentials passing, and authenticated application object access would be tedious, confusing, and ultimately would break any attempts to integrate with cred objects that were not originally designed for HTTP.

Let me try to clear up a few misconceptions about cred and guard that seem to have crept into the discussion here.

- Resources are lightweight.  You can have a top-level resource object which controls your session.  In other frameworks, such an object is called a &quot;controller&quot; for good reason.  There is no reason to have a separate 'session' object. What else does a &quot;session object&quot; do, anyway?  Store a dictionary of random keys to arbitrary objects?  Namespace conflict and cruft accretion issues abound once you start seeing &quot;the session&quot; as a tiny object you can stick bigger things to.  Your top-level resource is your application's controller, and it carries both session state and authority.

- Authentication does not imply authorization.  You don't have to log in as a user with a username to use the guard style of authentication.  You can implicitly authenticate as the anonymous user, which gives you a top-level resource, which is your session.  Again, resources are lightweight.  It needn't do anything but trivially wrap the shared resource at the top level.  

  - If you are getting a LOT of hits, and individual persistent objects for sessions really are too heavyweight for you, you don't need to use guard to access the static parts of your site.  guard's SessionWrapper doesn't need to live at /, it just needs to be somewhere persistent.

- Guard is a higher-level abstraction that is based around resources.  It shouldn't be built into the request at all.  There is no need to pay its cost if your application is doing something else.

- Guard should be flexible enough to allow for several different kinds of authentication mechanisms, not simply the HTTP-form-post mechanism it provides today.  It should let resources create credentials and pass them to the realm in whatever way makes the most sense for the desired user-experience.  It is currently extremely inflexible in this regard and I think it's just broken.

- Guard should allow the session to be pluggable, using cookies, digest authentication, headers, tunable timeouts, etc.

I am open to suggestions as to how to do cred-style authentication with an interface that isn't IResource, if something else makes more sense there.  I am doubtful but not implacable.  However, web2 is definitely going to include something an awful lot like guard before its final release.  Twisted is unfortunately thin on unifying abstractions currently, and cred is the best one we have.  The alternative to cred-style authentication in web2 is a new, better unifying abstraction plus a rewrite of the relevant portions of at least SIP, IMAP4, POP3, SMTP, Telnet, SSH, FTP, and IRC.  This is what I meant by &quot;cred is non-negotiable&quot;.

</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002101.html">[Twisted-web] HTTP-AUTH for web2 / Kudos on web2's operation
</A></li>
	<LI>Next message: <A HREF="002074.html">[Twisted-web] Concurrency in a twisted.web application
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2108">[ date ]</a>
              <a href="thread.html#2108">[ thread ]</a>
              <a href="subject.html#2108">[ subject ]</a>
              <a href="author.html#2108">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
