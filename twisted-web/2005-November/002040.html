<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Problems with web2.test.test_static.TestFileSaver
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Problems%20with%20web2.test.test_static.TestFileSaver&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002039.html">
   <LINK REL="Next"  HREF="002044.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Problems with web2.test.test_static.TestFileSaver</H1>
    <B>Wilfredo S&#225;nchez Vega</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Problems%20with%20web2.test.test_static.TestFileSaver&In-Reply-To="
       TITLE="[Twisted-web] Problems with web2.test.test_static.TestFileSaver">wsanchez at wsanchez.net
       </A><BR>
    <I>Sun Nov  6 23:40:54 MST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002039.html">[Twisted-web] Re: Memory leak with twisted web server on QNX
</A></li>
        <LI>Next message: <A HREF="002044.html">[Twisted-web] Problems with web2.test.test_static.TestFileSaver
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2040">[ date ]</a>
              <a href="thread.html#2040">[ thread ]</a>
              <a href="subject.html#2040">[ subject ]</a>
              <a href="author.html#2040">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>   web2.test.test_static.TestFileSaver has been failing on my DAV  
branch.  dreid and I were looking into it at SHDH and were generally  
baffled by the breakage.

   I remain baffled, but have managed to figure out that the test  
isn't breaking due to the addition of code, but by the simple  
existence of the test modules in my code.  I can reproduce the  
problem in trunk by doing the following:

	cd twisted/web2
	mkdir dav
	touch dav/__init__.py
	mkdir test
	touch dav/test/__init__.py
	echo &quot;import twisted.web2.static&quot; &gt; dav/test/test_OPTIONS.py

   And then run &quot;trial twisted.web2&quot; and watch it blow up in  
TestFileSaver.

   In  
twisted.web2.test.test_static.TestFileSaver.testCompareFileContents 
(), when the callback gotFname() gets called, if the dav test is not  
present, then fname is being set to this string:

     fname = &quot;y&gt;\ntwisted.web2.test.test_static/TestFileSaver/ 
testCompareFileContents/2336.1/4eb6d0fcd8319ae61aa0639f3c4c1128: File  
type not allowed MimeType('text', 'plain', {})&quot;

... which is apparently including some previous error condition which  
is being passed along in a strange sort of way.

	-wsv


</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002039.html">[Twisted-web] Re: Memory leak with twisted web server on QNX
</A></li>
	<LI>Next message: <A HREF="002044.html">[Twisted-web] Problems with web2.test.test_static.TestFileSaver
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2040">[ date ]</a>
              <a href="thread.html#2040">[ thread ]</a>
              <a href="subject.html#2040">[ subject ]</a>
              <a href="author.html#2040">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
