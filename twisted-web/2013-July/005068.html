<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] twisted.web : limiting file size during upload (using python)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-web%5D%20twisted.web%20%3A%20limiting%20file%20size%20during%20upload%0A%20%28using%20python%29&In-Reply-To=%3CCANmrDMXdhydxU1acu2xt06LRJgJRtvG9XoH4Y_QQC3nBJ7UqiQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005067.html">
   <LINK REL="Next"  HREF="005069.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] twisted.web : limiting file size during upload (using python)</H1>
    <B>Shell</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-web%5D%20twisted.web%20%3A%20limiting%20file%20size%20during%20upload%0A%20%28using%20python%29&In-Reply-To=%3CCANmrDMXdhydxU1acu2xt06LRJgJRtvG9XoH4Y_QQC3nBJ7UqiQ%40mail.gmail.com%3E"
       TITLE="[Twisted-web] twisted.web : limiting file size during upload (using python)">cam.turn at gmail.com
       </A><BR>
    <I>Tue Jul 16 19:55:50 MDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="005067.html">[Twisted-web] twisted.web : limiting file size during upload (using	python)
</A></li>
        <LI>Next message: <A HREF="005069.html">[Twisted-web] twisted.web : limiting file size during upload	(using python)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5068">[ date ]</a>
              <a href="thread.html#5068">[ thread ]</a>
              <a href="subject.html#5068">[ subject ]</a>
              <a href="author.html#5068">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Pranav

I believe, assuming that this hasn't been worked on last time I looked at
the code, that this is not currently possible. The code is about half way
there.

The request processing function stores the request on the disk if it is
over a certain size. However, once the request has been uploaded, a
function from Python's cgi module is called to parse the data into
request.params. Not only does this lose some information about file uploads
(which can only be recovered by re-parsing the request), but it also loads
all data into memory.

There is also not currently a way to limit either the size of the request,
or the size of individual files in the request.

Assuming that you need a solution and don't want to work on implementing
this in Twisted, I would suggest using nginx as a reverse proxy in front of
Twisted, with the &quot;Upload&quot; module that can be found on the Addons page on
nginx's wiki. This module will place any uploaded files into files on the
disk, and include regular request parameters to tell your Twisted server
where these files are. It is also capable of putting limits in place on the
size of uploaded files.

Cameron


On 17 July 2013 01:58, Pranav Bhardwaj &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">pranavb85 at gmail.com</A>&gt; wrote:

&gt;<i> Hey
</I>&gt;<i>
</I>&gt;<i> I have a script to be able to upload logs to a twisted web server.
</I>&gt;<i>
</I>&gt;<i> I have the following requirements:
</I>&gt;<i>
</I>&gt;<i> 1) to be able to limit the size of the upload to 10MB.
</I>&gt;<i> 2)  to NOT store file in memory during the request.
</I>&gt;<i>
</I>&gt;<i> Does twisted.web provide these functionality?
</I>&gt;<i>
</I>&gt;<i> Any inputs on these would be welcome!
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Here is the *server part* os the script:
</I>&gt;<i>
</I>&gt;<i>         try:
</I>&gt;<i>             oStream = open(filename, 'wb')
</I>&gt;<i>             oStream.write(request.args['fname'][0])
</I>&gt;<i>             outputStream.close()
</I>&gt;<i>
</I>&gt;<i>         except:
</I>&gt;<i>             # handle exception
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> a test *client script:*
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &lt;!DOCTYPE html&gt;
</I>&gt;<i> &lt;html&gt;
</I>&gt;<i> &lt;form action=&quot;<A HREF="https://serverUrl">https://serverUrl</A>&quot;
</I>&gt;<i> enctype=&quot;multipart/form-data&quot;
</I>&gt;<i> method=&quot;post&quot;&gt;
</I>&gt;<i> &lt;div class=&quot;row&quot;&gt;
</I>&gt;<i> &lt;label for=&quot;fileUploadToServer&quot;&gt;Select file&lt;/label&gt;&lt;br /&gt;
</I>&gt;<i> fname : &lt;input type=&quot;file&quot; name=&quot;fname&quot; /&gt;
</I>&gt;<i> &lt;input type=&quot;submit&quot; value=&quot;submit&quot;&gt;
</I>&gt;<i> &lt;/div&gt;
</I>&gt;<i> &lt;/form&gt;
</I>&gt;<i> &lt;/html&gt;
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-web mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">Twisted-web at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20130717/b1660084/attachment.html">http://twistedmatrix.com/pipermail/twisted-web/attachments/20130717/b1660084/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005067.html">[Twisted-web] twisted.web : limiting file size during upload (using	python)
</A></li>
	<LI>Next message: <A HREF="005069.html">[Twisted-web] twisted.web : limiting file size during upload	(using python)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5068">[ date ]</a>
              <a href="thread.html#5068">[ thread ]</a>
              <a href="subject.html#5068">[ subject ]</a>
              <a href="author.html#5068">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
