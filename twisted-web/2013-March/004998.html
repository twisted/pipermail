<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Setting of TCP Receive buffer size and Flow	Control in producer/consumer
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Setting%20of%20TCP%20Receive%20buffer%20size%20and%20Flow%0A%09Control%20in%20producer/consumer&In-Reply-To=1363083349.91268.YahooMailNeo%40web122101.mail.ne1.yahoo.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004997.html">
   <LINK REL="Next"  HREF="004999.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Setting of TCP Receive buffer size and Flow	Control in producer/consumer</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Setting%20of%20TCP%20Receive%20buffer%20size%20and%20Flow%0A%09Control%20in%20producer/consumer&In-Reply-To=1363083349.91268.YahooMailNeo%40web122101.mail.ne1.yahoo.com"
       TITLE="[Twisted-web] Setting of TCP Receive buffer size and Flow	Control in producer/consumer">glyph at twistedmatrix.com
       </A><BR>
    <I>Tue Mar 12 15:27:04 EDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="004997.html">[Twisted-web] Setting of TCP Receive buffer size and Flow Control	in producer/consumer
</A></li>
        <LI>Next message: <A HREF="004999.html">[Twisted-web] Setting of TCP Receive buffer size and Flow	Control in producer/consumer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4998">[ date ]</a>
              <a href="thread.html#4998">[ thread ]</a>
              <a href="subject.html#4998">[ subject ]</a>
              <a href="author.html#4998">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Mar 12, 2013, at 3:15 AM, A Desai &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">ardesai at yahoo.com</A>&gt; wrote:

&gt;<i> Scenario:  TCP Receive Buffer on twisted HTTP server using the twisted application framework.  And its behavior when set up as producer/consumer.
</I>&gt;<i> 
</I>&gt;<i> (1) Would like to set the receive buffer size on socket.  One way to do this would be to create a derived class of TCPServer (or SSLServer) and set the buffer size and use derived class server in the .tac file.  Would like to know if there is any sample code for such usage?  For example, in which method of the derived class would one set the receive buffer size?
</I>
You don't need to subclass these classes; and in any event, it wouldn't help, TCPServer and SSLServer don't have connections of their own, they're services that hold listening sockets, not connected sockets.  If you want to set an option unsupported by Twisted, &quot;transport.getHandle()&quot; will give you the Python socket object (on those reactors which use socket objects internally, which is most of them).  You can just set SO_RCVBUF on that socket from your Protocol class.

Also, this ticket may be of interest to you: &lt;<A HREF="https://twistedmatrix.com/trac/ticket/4089">https://twistedmatrix.com/trac/ticket/4089</A>&gt;.  Tuning send and receive buffers should be more explicitly supported by Twisted.

&gt;<i> (2) When an incoming http POST request is acting as a producer of data, which is tied to a consumer resource (some other connection), how can I control the incoming tcp window size, if the consumer has paused consuming?  I presume the incoming network data will keep piling up in the 'huge' tcp buffer eventually advertising a 'tcp zero window' to the network peer of the data producer, AND the server ends up using up a large amount of memory for the paused connection.  Is there an alternative?  I realize that the TCP protocol inhibits 'reducing of an already advertised receive window', but I am wondering if pauseProducing() on an http channel could do something to at least prevent the tcp window size from increasing any further?
</I>
I don't know that much about window scaling, but won't the fact that the application isn't receiving any data from the kernel automatically prevent the window from scaling any bigger?

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20130312/579b43a5/attachment.htm">http://twistedmatrix.com/pipermail/twisted-web/attachments/20130312/579b43a5/attachment.htm</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004997.html">[Twisted-web] Setting of TCP Receive buffer size and Flow Control	in producer/consumer
</A></li>
	<LI>Next message: <A HREF="004999.html">[Twisted-web] Setting of TCP Receive buffer size and Flow	Control in producer/consumer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4998">[ date ]</a>
              <a href="thread.html#4998">[ thread ]</a>
              <a href="subject.html#4998">[ subject ]</a>
              <a href="author.html#4998">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
