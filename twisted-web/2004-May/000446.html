<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] New cache proposal
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20New%20cache%20proposal&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000445.html">
   <LINK REL="Next"  HREF="000447.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] New cache proposal</H1>
    <B>Valentino Volonghi</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20New%20cache%20proposal&In-Reply-To="
       TITLE="[Twisted-web] New cache proposal">dialtone at gmail.com
       </A><BR>
    <I>Thu May 20 04:07:08 MDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000445.html">[Twisted-web] new http
</A></li>
        <LI>Next message: <A HREF="000447.html">[Twisted-web] Nevow newbie question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#446">[ date ]</a>
              <a href="thread.html#446">[ thread ]</a>
              <a href="subject.html#446">[ subject ]</a>
              <a href="author.html#446">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've seen taht at least in ten.py and in loaders.py you cache adapters
and templates.

Not too long ago I've written a metaclass that would cache instances
based on what arguments were passed during instantiation.

<A HREF="http://mattgoodall.dyndns.org:8081/105">http://mattgoodall.dyndns.org:8081/105</A>

cache = {}
class MyMetaTemplate(type):
    def __call__(self, *args):
        cached = cache.get(args, None)
        print cache, cached
        if not cached:
            instance = type.__call__(self, *args)
            cache.update({args:instance})
            return instance
        return cached
        
class Pippo(object):
    __metaclass__ = MyMetaTemplate
    template = ''
    def __init__(self, arg1, arg2, arg3):
        self.template = arg1

a = Pippo(1,2,3)
b = Pippo(2,3,4)
c = Pippo(1,2,3)
d = Pippo(2,3,4)
e = Pippo(5,6,7)
f = Pippo(5,6,7)

print id(a), id(b), id(c), id(d), id(e), id(f)

I think the only 'drawback' is that it needs new-style classes, but It
would be easier to use since you don't need extra checking in methods
but once you instantiate you know that the object you are working on
is a new one (if it wasn't cached) or the cached one.

HTH

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000445.html">[Twisted-web] new http
</A></li>
	<LI>Next message: <A HREF="000447.html">[Twisted-web] Nevow newbie question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#446">[ date ]</a>
              <a href="thread.html#446">[ thread ]</a>
              <a href="subject.html#446">[ subject ]</a>
              <a href="author.html#446">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
