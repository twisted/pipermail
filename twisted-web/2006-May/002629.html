<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] [patch] 1/3 web2 cookies
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5Bpatch%5D%201/3%20web2%20cookies&In-Reply-To=20060517145106.GY21766%40opteron.random">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002628.html">
   <LINK REL="Next"  HREF="002630.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] [patch] 1/3 web2 cookies</H1>
    <B>Andrea Arcangeli</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5Bpatch%5D%201/3%20web2%20cookies&In-Reply-To=20060517145106.GY21766%40opteron.random"
       TITLE="[Twisted-web] [patch] 1/3 web2 cookies">andrea at cpushare.com
       </A><BR>
    <I>Wed May 17 09:53:30 CDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002628.html">[Twisted-web] [patch] 4/4 stable web2
</A></li>
        <LI>Next message: <A HREF="002630.html">[Twisted-web] [patch] 2/3 scgi logging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2629">[ date ]</a>
              <a href="thread.html#2629">[ thread ]</a>
              <a href="subject.html#2629">[ subject ]</a>
              <a href="author.html#2629">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This allows setting and getting the cookies with web2 headers. My app
uses this new API to share the code with others. (I will probably port
my standalone web2 guard code interfaced with sql as well once I will
have the time)

diff -r 493b5c24e0f3 twisted/web2/http_headers.py
--- a/twisted/web2/http_headers.py	Tue May 16 04:57:00 2006 +0000
+++ b/twisted/web2/http_headers.py	Wed May 17 15:59:28 2006 +0200
@@ -1260,6 +1260,15 @@ class Headers(object):
     def _mutateRaise(self, *args):
         raise AttributeError(&quot;This header object is immutable as the headers have already been sent.&quot;)
 
+    def getCookie(self, name):
+        for cookie in self.getHeader('cookie', ()):
+            if cookie.name == name:
+                return cookie
+    def setCookie(self, name, *args, **kwargs):
+        set_cookies = self.getHeader('set-cookie', [])
+        set_cookies.append(Cookie(name, *args, **kwargs))
+        self.setHeader('set-cookie', set_cookies)
+
 
 &quot;&quot;&quot;The following dicts are all mappings of header to list of operations
    to perform. The first operation should generally be 'tokenize' if the

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002628.html">[Twisted-web] [patch] 4/4 stable web2
</A></li>
	<LI>Next message: <A HREF="002630.html">[Twisted-web] [patch] 2/3 scgi logging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2629">[ date ]</a>
              <a href="thread.html#2629">[ thread ]</a>
              <a href="subject.html#2629">[ subject ]</a>
              <a href="author.html#2629">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
