<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] [Nevow] childFactory being called more than once
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5BNevow%5D%20childFactory%20being%20called%20more%20than%20once&In-Reply-To=45DC1CBD.5090206%40libero.it">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003281.html">
   <LINK REL="Next"  HREF="003283.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] [Nevow] childFactory being called more than once</H1>
    <B>Valentino Volonghi aka Dialtone</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5BNevow%5D%20childFactory%20being%20called%20more%20than%20once&In-Reply-To=45DC1CBD.5090206%40libero.it"
       TITLE="[Twisted-web] [Nevow] childFactory being called more than once">dialtone at divmod.com
       </A><BR>
    <I>Wed Feb 21 04:58:05 CST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="003281.html">[Twisted-web] [Nevow] childFactory being called more than once
	with
</A></li>
        <LI>Next message: <A HREF="003283.html">[Twisted-web] [Nevow] childFactory being called more than once
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3282">[ date ]</a>
              <a href="thread.html#3282">[ thread ]</a>
              <a href="subject.html#3282">[ subject ]</a>
              <a href="author.html#3282">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 21 Feb 2007 11:19:41 +0100, Manlio Perillo &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">manlio_perillo at libero.it</A>&gt; wrote:
&gt;<i>Just forget it!
</I>&gt;<i>
</I>&gt;<i>I have a personalized locateChild in the base class, where I do:
</I>&gt;<i>
</I>&gt;<i>     def locateChild(self, ctx, segments):
</I>&gt;<i>         request = inevow.IRequest(ctx)
</I>&gt;<i>         if request.args.get('login-failure'):
</I>&gt;<i>             import login
</I>&gt;<i>
</I>&gt;<i>             return login.Login(self.avatar, failure=True), ''
</I>&gt;<i>
</I>&gt;<i>         res = rend.Page.locateChild(self, ctx, segments)
</I>&gt;<i>         if res == rend.NotFound:
</I>&gt;<i>             return NotFound(self.avatar), ''
</I>&gt;<i>
</I>&gt;<i>         return rend.Page.locateChild(self, ctx, segments) # &lt;===
</I>
This code is wrong in 2 ways:

1) locateChild can return deferreds, you are not covering this aspect.
2) Why calling locateChild twice when once is enough? if the page is not rend.NotFound then it's the page you want... just return it.

&gt;<i>By the way, is this code the best way to handle a login failure?
</I>
Can't spot anything terribly wrong there.

&gt;<i>Moreover, I still do not understand why, when replacing macro with render, 
</I>&gt;<i>locateChild is called 3 times, instead of 2.
</I>
You probably have other confusions in your source. As I said there's no link _at all_ between rendering and child locating.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003281.html">[Twisted-web] [Nevow] childFactory being called more than once
	with
</A></li>
	<LI>Next message: <A HREF="003283.html">[Twisted-web] [Nevow] childFactory being called more than once
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3282">[ date ]</a>
              <a href="thread.html#3282">[ thread ]</a>
              <a href="subject.html#3282">[ subject ]</a>
              <a href="author.html#3282">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
