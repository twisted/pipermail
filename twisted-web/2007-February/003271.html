<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Confused about XML-RPC Unicode behaviour (examples
	attached).
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Confused%20about%20XML-RPC%20Unicode%20behaviour%20%28examples%0A%09attached%29.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="003272.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Confused about XML-RPC Unicode behaviour (examples
	attached).</H1>
    <B>kgi</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Confused%20about%20XML-RPC%20Unicode%20behaviour%20%28examples%0A%09attached%29.&In-Reply-To="
       TITLE="[Twisted-web] Confused about XML-RPC Unicode behaviour (examples
	attached).">iacovou at gmail.com
       </A><BR>
    <I>Wed Feb  7 12:41:41 CST 2007</I>
    <P><UL>
        
        <LI>Next message: <A HREF="003272.html">[Twisted-web] Confused about XML-RPC Unicode behaviour (examples
	attached).
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3271">[ date ]</a>
              <a href="thread.html#3271">[ thread ]</a>
              <a href="subject.html#3271">[ subject ]</a>
              <a href="author.html#3271">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi all.

I've got a bunch of Twisted XML-RPC servers that serve up a wide range of data 
types include dates. Up until now I've had some hacky code to protect against 
bad data types being returned to the serialization layer (Nones, unicodes, 
etc). However, this code turns out to be difficult to maintain, as well as 
being a modest performance hit.

I thought I see if I couldn't clean up some of the code to make it simpler and 
less hacky, and I found something rather odd: a Twisted XML-RPC server 
seemingly can't return a xmlrpc.DateTime object it has only just received 
from the deserialization layer.

I've attached a test client, using Twisted, and two test servers, one using 
Twisted, one using the standard library's SimpleXMLRPCServer.

The standard library version succeeds in returning the received 
xmlrpclib.DateTime unmolested; the Twisted version complains about the 
message containing unicode:

     File &quot;/usr/lib/python2.4/site-packages/twisted/internet/abstract.py&quot;,line 
173, in write
            raise TypeError(&quot;Data must not be unicode&quot;)
        exceptions.TypeError: Data must not be unicode

This seems wrong: surely, at the very least, the serialization and 
deserialization should allow a round-trip unmodified? Put a slightly 
different way: I don't have a fundamental problem with the restriction that 
return types not include unicode, but surely in that case, the same system 
that enforces this should see to it that I don't receive such a type in the 
first place (given that the original data type I created in the client was a 
xmlrpclib.DateTime, which is explicitly designed for serialising over 
XML-RPC!).

Are there technical/historical/political reasons for this of which I know 
nothing?

Regards,

Ricky

-------------- next part --------------
A non-text attachment was scrubbed...
Name: simpledateserver.py
Type: application/x-python
Size: 599 bytes
Desc: not available
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20070207/bf08d42f/simpledateserver.bin">http://twistedmatrix.com/pipermail/twisted-web/attachments/20070207/bf08d42f/simpledateserver.bin</A>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dateclient.py
Type: application/x-python
Size: 495 bytes
Desc: not available
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20070207/bf08d42f/dateclient.bin">http://twistedmatrix.com/pipermail/twisted-web/attachments/20070207/bf08d42f/dateclient.bin</A>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dateserver.py
Type: application/x-python
Size: 763 bytes
Desc: not available
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20070207/bf08d42f/dateserver.bin">http://twistedmatrix.com/pipermail/twisted-web/attachments/20070207/bf08d42f/dateserver.bin</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="003272.html">[Twisted-web] Confused about XML-RPC Unicode behaviour (examples
	attached).
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3271">[ date ]</a>
              <a href="thread.html#3271">[ thread ]</a>
              <a href="subject.html#3271">[ subject ]</a>
              <a href="author.html#3271">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
