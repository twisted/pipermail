From Axel.Rau at chaos1.de  Tue Nov  5 05:19:43 2013
From: Axel.Rau at chaos1.de (Axel Rau)
Date: Tue, 5 Nov 2013 13:19:43 +0100
Subject: [Twisted-web] deployment with twistd of simple web application
Message-ID: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>

Hi,

just doing my 1st dynamic web application with twisted.

I have some working python modules, where the entry point is:
---
resource = RootWeatherPage()
meteoFactory = Site(resource)
reactor.listenTCP(80, factory, interface='some IP4')
reactor.listenTCP(80, factory, interface='some IP6')
reactor.run()
---

Now I want to use twistd web.
How do I do that?

Thanks Axel
---
PGP-Key:29E99DD6  ? +49 151 2300 9283  ? computing @ chaos claudius



From _ at lvh.io  Tue Nov  5 05:25:26 2013
From: _ at lvh.io (Laurens Van Houtven)
Date: Tue, 5 Nov 2013 13:25:26 +0100
Subject: [Twisted-web] deployment with twistd of simple web application
In-Reply-To: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>
References: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>
Message-ID: <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>

Hi Axel,

You probably want to read this:

https://twistedmatrix.com/documents/current/core/howto/application.html

There's a number of ways you can use twistd web, for example with a tac
file, but personally I always opt for using a Twisted plugin, so you
instead do twistd mything :)

hth
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20131105/beb002b7/attachment.html>

From Axel.Rau at Chaos1.DE  Tue Nov  5 05:43:50 2013
From: Axel.Rau at Chaos1.DE (Axel Rau)
Date: Tue, 5 Nov 2013 13:43:50 +0100
Subject: [Twisted-web] deployment with twistd of simple web application
In-Reply-To: <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
References: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>
 <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
Message-ID: <1B011054-3131-4C0A-A423-02C86A354A21@Chaos1.DE>


Am 05.11.2013 um 13:25 schrieb Laurens Van Houtven <_ at lvh.io>:

> You probably want to read this:
> 
> https://twistedmatrix.com/documents/current/core/howto/application.html
This explains the echo service step by step, but I still do not know how to do it with twistd *web* .
Looking at the source of the web plugin did not enlighten me.
I tried:
---
meteo.tac:
---
application = service.Application('meteo')
meteoService = internet.TCPserver(80, meteoFactory(), interface=some IP4')
													# interface='some IP 6') 
meteoService.setServiceParent(application)
---
and changed my main module to
---
?
resource = RootWeatherPage()
meteoFactory = Site(resource)
#reactor.listenTCP(80, factory, interface='91.216.35.82')
#reactor.listenTCP(80, factory, interface='2a02:d40:2:2::82')
#reactor.run()?
---
twisted does not start up. Interrupting it, gives
"exceptions.ImportError: cannot import name meteoFactory"
> 
> There's a number of ways you can use twistd web, for example with a tac file, but personally I always opt for using a Twisted plugin, so you instead do twistd mything :)


Axel
---
PGP-Key:29E99DD6  ? +49 151 2300 9283  ? computing @ chaos claudius

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20131105/a5024ad4/attachment.html>

From exarkun at twistedmatrix.com  Tue Nov  5 05:48:02 2013
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Tue, 05 Nov 2013 12:48:02 -0000
Subject: [Twisted-web] deployment with twistd of simple web application
In-Reply-To: <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
References: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>
 <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
Message-ID: <20131105124802.8349.1269241650.divmod.xquotient.39@top>

On 12:25 pm, _ at lvh.io wrote:
>Hi Axel,
>
>You probably want to read this:
>
>https://twistedmatrix.com/documents/current/core/howto/application.html
>
>There's a number of ways you can use twistd web, for example with a tac
>file, but personally I always opt for using a Twisted plugin, so you
>instead do twistd mything :)

There's some confused language here.

"twistd web" sounds a lot like the command line invocation of `twistd? 
to use the `web? plugin - which sets up an HTTP server using Twisted 
web.

The Twisted plugin (twisted.plugin) system is used by twistd to 
implement its support for extensible command line parsing.  "twistd web" 
is implemented using a twistd plugin 
(twisted.plugins.twisted_web.TwistedWeb and twisted.web.tap) which is 
itself implemented using twisted.plugin.

I think the OP may have been asking how to use "twistd web" to 
accomplish what his Python snippet accomplished.

Jean-Paul


From _ at lvh.io  Tue Nov  5 05:47:48 2013
From: _ at lvh.io (Laurens Van Houtven)
Date: Tue, 5 Nov 2013 13:47:48 +0100
Subject: [Twisted-web] deployment with twistd of simple web application
In-Reply-To: <1B011054-3131-4C0A-A423-02C86A354A21@Chaos1.DE>
References: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>
 <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
 <1B011054-3131-4C0A-A423-02C86A354A21@Chaos1.DE>
Message-ID: <CAE_Hg6YpO7AFUhzrMOpY+eq5=6xuU8GM_f=Jye4=TeBk-1pDwQ@mail.gmail.com>

Hi Axel,


Looks like you're missing a bunch of imports; where is meteoService coming
from in the tac file? Are these really the files you're attempting to run?

cheers
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20131105/4ea1f387/attachment.html>

From Axel.Rau at chaos1.de  Tue Nov  5 05:51:21 2013
From: Axel.Rau at chaos1.de (Axel Rau)
Date: Tue, 5 Nov 2013 13:51:21 +0100
Subject: [Twisted-web] deployment with twistd of simple web application
In-Reply-To: <20131105124802.8349.1269241650.divmod.xquotient.39@top>
References: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>
 <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
 <20131105124802.8349.1269241650.divmod.xquotient.39@top>
Message-ID: <4A2D0D48-704B-4A7A-B15E-3B326E6BF756@Chaos1.DE>


Am 05.11.2013 um 13:48 schrieb exarkun at twistedmatrix.com:

> I think the OP may have been asking how to use "twistd web" to accomplish what his Python snippet accomplished.
Yes, that is my question.

Axel
---
PGP-Key:29E99DD6  ? +49 151 2300 9283  ? computing @ chaos claudius



From Axel.Rau at chaos1.de  Tue Nov  5 05:55:09 2013
From: Axel.Rau at chaos1.de (Axel Rau)
Date: Tue, 5 Nov 2013 13:55:09 +0100
Subject: [Twisted-web] deployment with twistd of simple web application
In-Reply-To: <CAE_Hg6YpO7AFUhzrMOpY+eq5=6xuU8GM_f=Jye4=TeBk-1pDwQ@mail.gmail.com>
References: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>
 <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
 <1B011054-3131-4C0A-A423-02C86A354A21@Chaos1.DE>
 <CAE_Hg6YpO7AFUhzrMOpY+eq5=6xuU8GM_f=Jye4=TeBk-1pDwQ@mail.gmail.com>
Message-ID: <4C41E3E8-866B-4191-AB6F-19B0F655FBBE@Chaos1.DE>


Am 05.11.2013 um 13:47 schrieb Laurens Van Houtven <_ at lvh.io>:

> Looks like you're missing a bunch of imports; where is meteoService coming from in the tac file? Are these really the files you're attempting to run?
This is the complete tac file:
---
from twisted.application import internet, service
from meteo import meteoFactory

application = service.Application('meteo')
meteoService = internet.TCPserver(80, meteoFactory(), interface='91.216.35.82')
													# interface='2a02:d40:2:2::82')
meteoService.setServiceParent(application)
---
Axel
---
PGP-Key:29E99DD6  ? +49 151 2300 9283  ? computing @ chaos claudius

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20131105/a5553bc2/attachment.html>

From Axel.Rau at chaos1.de  Tue Nov  5 06:19:43 2013
From: Axel.Rau at chaos1.de (Axel Rau)
Date: Tue, 5 Nov 2013 14:19:43 +0100
Subject: [Twisted-web] deployment with twistd of simple web application
In-Reply-To: <1B011054-3131-4C0A-A423-02C86A354A21@Chaos1.DE>
References: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>
 <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
 <1B011054-3131-4C0A-A423-02C86A354A21@Chaos1.DE>
Message-ID: <BB0B7E62-0B96-4850-AACA-6FC142E62112@Chaos1.DE>


Am 05.11.2013 um 13:43 schrieb Axel Rau <Axel.Rau at chaos1.de>:

> ---
> twisted does not start up. Interrupting it, gives
> "exceptions.ImportError: cannot import name meteoFactory"

It seems to not find my modules:
    from meteo import meteoFactory
I assumed twistd looks relative to the tac file.
Giving twistd a --rundir option does not help either.

Axel
---
PGP-Key:29E99DD6  ? +49 151 2300 9283  ? computing @ chaos claudius

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20131105/4c5c3ebd/attachment-0001.html>

From glyph at twistedmatrix.com  Tue Nov  5 11:25:27 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Tue, 5 Nov 2013 10:25:27 -0800
Subject: [Twisted-web] deployment with twistd of simple web application
In-Reply-To: <BB0B7E62-0B96-4850-AACA-6FC142E62112@Chaos1.DE>
References: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>
 <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
 <1B011054-3131-4C0A-A423-02C86A354A21@Chaos1.DE>
 <BB0B7E62-0B96-4850-AACA-6FC142E62112@Chaos1.DE>
Message-ID: <737B9A75-34C3-43B1-A238-15A791815861@twistedmatrix.com>


On Nov 5, 2013, at 5:19 AM, Axel Rau <Axel.Rau at Chaos1.DE> wrote:

> 
> Am 05.11.2013 um 13:43 schrieb Axel Rau <Axel.Rau at chaos1.de>:
> 
>> ---
>> twisted does not start up. Interrupting it, gives
>> "exceptions.ImportError: cannot import name meteoFactory"
> 
> It seems to not find my modules:
>     from meteo import meteoFactory
> I assumed twistd looks relative to the tac file.
> Giving twistd a --rundir option does not help either.

twistd is a python program, which means it finds modules based on the same rules Python uses for finding modules.

There are numerous ways you could adjust sys.path; you can use virtualenv, or set PYTHONPATH, or just sys.path.append within the tac file itself.

-glyph


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20131105/ae52cfa7/attachment.html>

From Axel.Rau at chaos1.de  Fri Nov  8 05:33:52 2013
From: Axel.Rau at chaos1.de (Axel Rau)
Date: Fri, 8 Nov 2013 13:33:52 +0100
Subject: [Twisted-web] deployment with twistd of simple web application
In-Reply-To: <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
References: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>
 <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
Message-ID: <60A58AEC-A64B-470F-8731-1381C60B0559@Chaos1.DE>


Am 05.11.2013 um 13:25 schrieb Laufens Van Houtven <_ at lvh.io>:

> You probably want to read this:
> 
> https://twistedmatrix.com/documents/current/core/howto/application.html
> 
> There's a number of ways you can use twistd web, for example with a tac file, but personally I always opt for using a Twisted plugin, so you instead do twistd mything :)


I try to write the plugin now:
?
from zope.interface import implements

from twisted.application.service import IServiceMaker
from twisted.application import internet
from twisted.plugin import IPlugin
from twisted.python import usage

from meteo import meteoFactory

class Options(usage.Options):
	optParameters = [	['port', 'p', 80, 'The port number to listen on.'],
						['ipv4_address', '4', None, 'The IPv4 address to listen on.'],
						['ipv6_address', '6', None, 'The IPv6 address to listen on.']]

class MeteoServiceMaker(object):
	implements(IServiceMaker, IPlugin)
	tapname = 'meteo'
	description = 'A web application for the meteo package'
	options = Options
	
	def makeService(self, options):
		"""
		Constructs a TCP server from a factory defined in meteo.py
		"""
		return internet.TCPServer(	int(options['port'], 
									interface=options['ipv4_address'],	## how do it set the ip6 address?
									meteoFactory())				

serviceMaker = MeteoServiceMaker()
---
--- relevant part of metro.py:	
resource = RootWeatherPage()
meteoFactory = Site(resource)
--- 
Currently, this gives following error:
---
[meteo] [www4:py-venv/meteo/meteo] root# twistd --help
Unhandled Error
Traceback (most recent call last):
  File "/usr/local/py-venv/meteo/lib/python2.7/site-packages/twisted/python/usage.py", line 450, in __str__
    return self.getSynopsis() + '\n' + self.getUsage(width=None)
  File "/usr/local/py-venv/meteo/lib/python2.7/site-packages/twisted/python/usage.py", line 486, in getUsage
    for (cmd, short, parser, desc) in self.subCommands:
  File "/usr/local/py-venv/meteo/lib/python2.7/site-packages/twisted/application/app.py", line 631, in subCommands
    for plug in sorted(plugins, key=attrgetter('tapname')):
  File "/usr/local/py-venv/meteo/lib/python2.7/site-packages/twisted/plugin.py", line 209, in getPlugins
    allDropins = getCache(package)
--- <exception caught here> ---
  File "/usr/local/py-venv/meteo/lib/python2.7/site-packages/twisted/plugin.py", line 167, in getCache
    provider = pluginModule.load()
  File "/usr/local/py-venv/meteo/lib/python2.7/site-packages/twisted/python/modules.py", line 383, in load
    return self.pathEntry.pythonPath.moduleLoader(self.name)
  File "/usr/local/py-venv/meteo/lib/python2.7/site-packages/twisted/python/_reflectpy3.py", line 266, in namedAny
    topLevelPackage = _importAndCheckStack(trialname)
  File "/usr/local/py-venv/meteo/lib/python2.7/site-packages/twisted/python/_reflectpy3.py", line 205, in _importAndCheckStack
    return __import__(importName)
exceptions.SyntaxError: invalid syntax (meteo_plugin.py, line 29)
---
Line 29 is
	serviceMaker = MeteoServiceMaker()
What is wrong there?

Thanks,
Axel
---
PGP-Key:29E99DD6  ? +49 151 2300 9283  ? computing @ chaos claudius

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20131108/a7dfbe5b/attachment.html>

From exarkun at twistedmatrix.com  Fri Nov  8 07:53:10 2013
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Fri, 08 Nov 2013 14:53:10 -0000
Subject: [Twisted-web] deployment with twistd of simple web application
In-Reply-To: <60A58AEC-A64B-470F-8731-1381C60B0559@Chaos1.DE>
References: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>
 <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
 <60A58AEC-A64B-470F-8731-1381C60B0559@Chaos1.DE>
Message-ID: <20131108145310.8349.306272576.divmod.xquotient.389@top>

On 12:33 pm, axel.rau at chaos1.de wrote:
>
>Am 05.11.2013 um 13:25 schrieb Laufens Van Houtven <_ at lvh.io>:
>>You probably want to read this:
>>
>>https://twistedmatrix.com/documents/current/core/howto/application.html
>>
>>There's a number of ways you can use twistd web, for example with a 
>>tac file, but personally I always opt for using a Twisted plugin, so 
>>you instead do twistd mything :)
>
>[snip]
>exceptions.SyntaxError: invalid syntax (meteo_plugin.py, line 29)

Unfortunately your code was mangled beyond recognition by your email 
client.

Try attaching the code instead so that we can see what you actually 
have.

Jean-Paul


From Axel.Rau at Chaos1.DE  Fri Nov  8 10:19:07 2013
From: Axel.Rau at Chaos1.DE (Axel Rau)
Date: Fri, 8 Nov 2013 18:19:07 +0100
Subject: [Twisted-web] deployment with twistd of simple web application
In-Reply-To: <20131108145310.8349.306272576.divmod.xquotient.389@top>
References: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>
 <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
 <60A58AEC-A64B-470F-8731-1381C60B0559@Chaos1.DE>
 <20131108145310.8349.306272576.divmod.xquotient.389@top>
Message-ID: <E5D71D27-FCD9-49AA-9B43-A04E34E7C9FA@Chaos1.DE>


Am 08.11.2013 um 15:53 schrieb exarkun at twistedmatrix.com:

> On 12:33 pm, axel.rau at chaos1.de wrote:
>> 
>> Am 05.11.2013 um 13:25 schrieb Laufens Van Houtven <_ at lvh.io>:
>>> You probably want to read this:
>>> 
>>> https://twistedmatrix.com/documents/current/core/howto/application.html
>>> 
>>> There's a number of ways you can use twistd web, for example with a tac file, but personally I always opt for using a Twisted plugin, so you instead do twistd mything :)
>> 
>> [snip]
>> exceptions.SyntaxError: invalid syntax (meteo_plugin.py, line 29)
> 
> Unfortunately your code was mangled beyond recognition by your email client.
> 
> Try attaching the code instead so that we can see what you actually have.
> 
Sorry.
Here it comes:
-------------- next part --------------
A non-text attachment was scrubbed...
Name: meteo_plugin.py
Type: text/x-python-script
Size: 907 bytes
Desc: not available
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20131108/2a0f5138/attachment.bin>
-------------- next part --------------
..and the backtrace: 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: backtrace.txt
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20131108/2a0f5138/attachment.txt>
-------------- next part --------------


Axel
---
PGP-Key:29E99DD6  ? +49 151 2300 9283  ? computing @ chaos claudius


From jon at multani.info  Fri Nov  8 10:23:14 2013
From: jon at multani.info (Jonathan Ballet)
Date: Fri, 08 Nov 2013 18:23:14 +0100
Subject: [Twisted-web] deployment with twistd of simple web application
In-Reply-To: <E5D71D27-FCD9-49AA-9B43-A04E34E7C9FA@Chaos1.DE>
References: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>
 <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
 <60A58AEC-A64B-470F-8731-1381C60B0559@Chaos1.DE>
 <20131108145310.8349.306272576.divmod.xquotient.389@top>
 <E5D71D27-FCD9-49AA-9B43-A04E34E7C9FA@Chaos1.DE>
Message-ID: <527D1E02.8090301@multani.info>

On 11/08/2013 06:19 PM, Axel Rau wrote:
>
> Am 08.11.2013 um 15:53 schrieb exarkun at twistedmatrix.com:
>
>> On 12:33 pm, axel.rau at chaos1.de wrote:
>>>
>>> Am 05.11.2013 um 13:25 schrieb Laufens Van Houtven <_ at lvh.io>:
>>>> You probably want to read this:
>>>>
>>>> https://twistedmatrix.com/documents/current/core/howto/application.html
>>>>
>>>> There's a number of ways you can use twistd web, for example with a tac file, but personally I always opt for using a Twisted plugin, so you instead do twistd mything :)
>>>
>>> [snip]
>>> exceptions.SyntaxError: invalid syntax (meteo_plugin.py, line 29)
>>
>> Unfortunately your code was mangled beyond recognition by your email client.
>>
>> Try attaching the code instead so that we can see what you actually have.
>>
> Sorry.
> Here it comes:

		return internet.TCPServer(	int(options['port'],
								  ^^^

You are missing a closing parentheses here.


From Axel.Rau at chaos1.de  Fri Nov  8 11:43:44 2013
From: Axel.Rau at chaos1.de (Axel Rau)
Date: Fri, 8 Nov 2013 19:43:44 +0100
Subject: [Twisted-web] deployment with twistd of simple web application
In-Reply-To: <527D1E02.8090301@multani.info>
References: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>
 <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
 <60A58AEC-A64B-470F-8731-1381C60B0559@Chaos1.DE>
 <20131108145310.8349.306272576.divmod.xquotient.389@top>
 <E5D71D27-FCD9-49AA-9B43-A04E34E7C9FA@Chaos1.DE>
 <527D1E02.8090301@multani.info>
Message-ID: <F3AC100E-19A4-4C25-A072-743617CB0E6B@Chaos1.DE>


Am 08.11.2013 um 18:23 schrieb Jonathan Ballet <jon at multani.info>:

> On 11/08/2013 06:19 PM, Axel Rau wrote:
>> 
>> Am 08.11.2013 um 15:53 schrieb exarkun at twistedmatrix.com:
>> 
>>> On 12:33 pm, axel.rau at chaos1.de wrote:
>>>> 
>>>> Am 05.11.2013 um 13:25 schrieb Laufens Van Houtven <_ at lvh.io>:
>>>>> You probably want to read this:
>>>>> 
>>>>> https://twistedmatrix.com/documents/current/core/howto/application.html
>>>>> 
>>>>> There's a number of ways you can use twistd web, for example with a tac file, but personally I always opt for using a Twisted plugin, so you instead do twistd mything :)
>>>> 
>>>> [snip]
>>>> exceptions.SyntaxError: invalid syntax (meteo_plugin.py, line 29)
>>> 
>>> Unfortunately your code was mangled beyond recognition by your email client.
>>> 
>>> Try attaching the code instead so that we can see what you actually have.
>>> 
>> Sorry.
>> Here it comes:
> 
> 		return internet.TCPServer(	int(options['port'],
> 								  ^^^
> 
> You are missing a closing parentheses here.

You are right (-;, but now I come to my real question: 
---
[meteo] [www4:py-venv/meteo/meteo] root# twistd --pidfile=/var/run/twisted/meteo.pid -u www -g www -r kqueue  meteo
Traceback (most recent call last):
  File "/usr/local/py-venv/meteo/bin/twistd", line 14, in <module>
    run()
  File "/usr/local/py-venv/meteo/lib/python2.7/site-packages/twisted/scripts/twistd.py", line 27, in run
    app.run(runApp, ServerOptions)
  File "/usr/local/py-venv/meteo/lib/python2.7/site-packages/twisted/application/app.py", line 652, in run
    runApp(config)
  File "/usr/local/py-venv/meteo/lib/python2.7/site-packages/twisted/scripts/twistd.py", line 23, in runApp
    _SomeApplicationRunner(config).run()
  File "/usr/local/py-venv/meteo/lib/python2.7/site-packages/twisted/application/app.py", line 386, in run
    self.application = self.createOrGetApplication()
  File "/usr/local/py-venv/meteo/lib/python2.7/site-packages/twisted/application/app.py", line 446, in createOrGetApplication
    ser = plg.makeService(self.config.subOptions)
  File "/usr/local/py-venv/meteo/meteo/twisted/plugins/meteo_plugin.py", line 26, in makeService
    meteoFactory(),
AttributeError: Site instance has no __call__ method
---
makeService expects a protocol factory, but I have only
	meteoFactory = Site(resource)
How do I interface the former to the http protocol?

Axel
---
PGP-Key:29E99DD6  ? +49 151 2300 9283  ? computing @ chaos claudius



From hawkowl at atleastfornow.net  Fri Nov  8 11:49:24 2013
From: hawkowl at atleastfornow.net (HawkOwl)
Date: Sat, 09 Nov 2013 02:49:24 +0800
Subject: [Twisted-web] Twisted 13.2.0 Release Announcement
Message-ID: <527D3234.1040507@atleastfornow.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On behalf of Twisted Matrix Laboratories, I am honoured to announce
the release of Twisted 13.2!

The highlights of this release are:

 * Twisted now includes a HostnameEndpoint implementation which uses
IPv4 and IPv6 in parallel, speeding up the connection by using
whichever connects first (the 'Happy Eyeballs'/RFC 6555 algorithm).
(#4859)

 * Improved support for Cancellable Deferreds by kaizhang, our GSoC
student. (#4320, #6532, #6572, #6639)

 * Improved Twisted.Mail documentation by shira, our Outreach Program
for Women intern. (#6649, #6652)

 * twistd now waits for the application to start successfully before
exiting after daemonization. (#823)

 * SSL server endpoint string descriptions now support the
specification of chain certificates. (#6499)

 * Over 70 closed tickets since 13.1.0.

For more information, check the NEWS file (link provided below).

You can find the downloads at <https://pypi.python.org/pypi/Twisted>
(or alternatively <http://twistedmatrix.com/trac/wiki/Downloads>) .
The NEWS file is also available at
<http://twistedmatrix.com/Releases/Twisted/13.2/NEWS.txt>.

Many thanks to everyone who had a part in this release - the
supporters of the Twisted Software Foundation, the developers who
contributed code as well as documentation, and all the people building
great things with Twisted!

Twisted Regards,
HawkOwl
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.15 (GNU/Linux)

iQEcBAEBAgAGBQJSfTI0AAoJECMItHnTkkoRDzgH/0hbsTLrBVklSjFXINgjNZcE
9IEwFcXsWGElv066Nmt7Nm2CQ0idIJHosx58re8LKK9F/xK3CWlCceJOeS+npNfE
y3CnuBRxJYWC+xdy/WTgLV26LkFi2TzqYJT+r6AfS8KUhOJCUJ3H+x8G2SeDlin+
eED64X4ftbs22tSz3RkCkpT++L6inPvVWhwpQhn+GqnS4oBqjbjcYpwJ8+wFfy72
6qe6OcXsoUxM72nbZ1vLg4WE5nbv3It+HnR9PYJTY9VFv8sNeGzb/VEfLpeFJG7f
bZImycCh2Flp3OKVzaELmWc+hYDsWT/TuaQYYw6IJYqvFCoTuEQFsdtJuuVBZoQ=
=Attd
-----END PGP SIGNATURE-----


From Axel.Rau at Chaos1.DE  Tue Nov 12 06:20:04 2013
From: Axel.Rau at Chaos1.DE (Axel Rau)
Date: Tue, 12 Nov 2013 14:20:04 +0100
Subject: [Twisted-web] deployment with twistd of simple web application
In-Reply-To: <F3AC100E-19A4-4C25-A072-743617CB0E6B@Chaos1.DE>
References: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>
 <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
 <60A58AEC-A64B-470F-8731-1381C60B0559@Chaos1.DE>
 <20131108145310.8349.306272576.divmod.xquotient.389@top>
 <E5D71D27-FCD9-49AA-9B43-A04E34E7C9FA@Chaos1.DE>
 <527D1E02.8090301@multani.info>
 <F3AC100E-19A4-4C25-A072-743617CB0E6B@Chaos1.DE>
Message-ID: <10D9C138-6A83-431B-938E-56EA3E61AD81@Chaos1.DE>


Am 08.11.2013 um 19:43 schrieb Axel Rau <Axel.Rau at chaos1.de>:
> 
> makeService expects a protocol factory, but I have only
> 	meteoFactory = Site(resource)
> How do I interface the former to the http protocol?
> 


After fixing my low-level Python errors (sorry for wasting you time), the attached plugin works out of the box with my original code:
---
resource = RootWeatherPage()
meteo_factory = Site(resource)
---
-------------- next part --------------
A non-text attachment was scrubbed...
Name: meteo_plugin.py
Type: text/x-python-script
Size: 911 bytes
Desc: not available
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20131112/ae0dfd76/attachment.bin>
-------------- next part --------------

Next, I have to find a way to define a 2nd interface (IPv6) for TCPServer.

Axel
---
PGP-Key:29E99DD6  ? +49 151 2300 9283  ? computing @ chaos claudius


From exarkun at twistedmatrix.com  Tue Nov 12 07:04:17 2013
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Tue, 12 Nov 2013 14:04:17 -0000
Subject: [Twisted-web] deployment with twistd of simple web application
In-Reply-To: <10D9C138-6A83-431B-938E-56EA3E61AD81@Chaos1.DE>
References: <07125AA6-BE79-4244-8514-C91F289DDBB3@chaos1.de>
 <CAE_Hg6a1SmaaApw2tA7wgELa5qOw4oQN-LngU+jwjpJGMg9NVw@mail.gmail.com>
 <60A58AEC-A64B-470F-8731-1381C60B0559@Chaos1.DE>
 <20131108145310.8349.306272576.divmod.xquotient.389@top>
 <E5D71D27-FCD9-49AA-9B43-A04E34E7C9FA@Chaos1.DE>
 <527D1E02.8090301@multani.info>
 <F3AC100E-19A4-4C25-A072-743617CB0E6B@Chaos1.DE>
 <10D9C138-6A83-431B-938E-56EA3E61AD81@Chaos1.DE>
Message-ID: <20131112140417.8349.751854392.divmod.xquotient.577@top>

On 01:20 pm, axel.rau at chaos1.de wrote:
>
>Am 08.11.2013 um 19:43 schrieb Axel Rau <Axel.Rau at chaos1.de>:
>>
>>makeService expects a protocol factory, but I have only
>>         meteoFactory = Site(resource)
>>How do I interface the former to the http protocol?
>
>
>After fixing my low-level Python errors (sorry for wasting you time), 
>the attached plugin works out of the box with my original code:
>---
>resource = RootWeatherPage()
>meteo_factory = Site(resource)
>---

If you want to run multiple services then the pattern to follow is just:


    def makeService(config):
        parent = MultiService()
        oneChild.setServiceParent(parent)
        anotherChild.setServiceParent(parent)
        ...
        return parent

You may also want to consider using offering endpoints via the command- 
line configuration options.  Instead of writing options to explicitly 
support IPv4 and IPv6, write an option that accepts an endpoint string 
description.

You can see an example of this (sort of) in the implementation of 
"twistd mail" which accepts endpoints for several of its option (eg 
`--pop3`):

https://twistedmatrix.com/trac/browser/trunk/twisted/mail/tap.py#L103

You can also read about endpoints here:

  https://twistedmatrix.com/documents/current/core/howto/endpoints.html

and here:

  https://twistedmatrix.com/documents/current/core/howto/servers.html

Jean-Paul


