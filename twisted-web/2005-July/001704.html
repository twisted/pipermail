<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] HTTP redirection from data_*/render_* methods
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20HTTP%20redirection%20from%20data_%2A/render_%2A%20methods&In-Reply-To=20050715141748.GA1080%40ospaz.ru">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001701.html">
   <LINK REL="Next"  HREF="001705.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] HTTP redirection from data_*/render_* methods</H1>
    <B>Donovan Preston</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20HTTP%20redirection%20from%20data_%2A/render_%2A%20methods&In-Reply-To=20050715141748.GA1080%40ospaz.ru"
       TITLE="[Twisted-web] HTTP redirection from data_*/render_* methods">dp at ulaluma.com
       </A><BR>
    <I>Fri Jul 15 12:45:24 MDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001701.html">[Twisted-web] HTTP redirection from data_*/render_* methods
</A></li>
        <LI>Next message: <A HREF="001705.html">[Twisted-web] HTTP redirection from data_*/render_* methods
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1704">[ date ]</a>
              <a href="thread.html#1704">[ thread ]</a>
              <a href="subject.html#1704">[ subject ]</a>
              <a href="author.html#1704">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Jul 15, 2005, at 7:17 AM, &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">en.karpachov at ospaz.ru</A>&gt;  
&lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">en.karpachov at ospaz.ru</A>&gt; wrote:

&gt;<i> On Fri, Jul 15, 2005 at 07:40:33AM -0600, Samuel Reynolds wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> At 2005-07-15 02:46 PM +0400, you wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I wondered if I can make an HTTP redirection (302) from inside of  
</I>&gt;&gt;&gt;<i> render_*
</I>&gt;&gt;&gt;<i> or data_* method. Here is a code snipped I wrote; I'd like to  
</I>&gt;&gt;&gt;<i> know if it
</I>&gt;&gt;&gt;<i> can be considered as &quot;good&quot; nevow practice?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What about
</I>&gt;&gt;<i>     request.redirect( redirectUrl )
</I>&gt;&gt;<i> possibly followed by
</I>&gt;&gt;<i>     request.finish()
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> It doesn't work when called from inside a render_something or  
</I>&gt;<i> data_smth
</I>&gt;<i> methods. If I redirect, I want the flattening process to stop  
</I>&gt;<i> immediately,
</I>&gt;<i> dropping request output accumulated so far. The only way to do it  
</I>&gt;<i> is to
</I>&gt;<i> raise an exception, cancelling normal flow.  Otherwise, flattening  
</I>&gt;<i> will
</I>&gt;<i> continue, and the request will be finished twice. Also, the http  
</I>&gt;<i> reply will
</I>&gt;<i> have non-empty body.
</I>
Even if you do raise an exception, all output generated up to that  
point will have already been sent out over the socket to the browser.  
This means the headers will already have been written, and  
redirecting will have no effect.

What you want instead is to set the &quot;buffered&quot; attribute of your Page  
class to true before it starts rendering. This will cause nevow to  
delay sending any output to the browser until the entire page is done  
rendering, allowing you to do a redirect in the middle of it.

Personally, I don't think it's a good idea. You should decide about  
the redirect up front, that way you avoid doing wasted work on the  
server. Buffering also isn't as cool, because pages will chunk in  
rather than streaming in.

Donovan


</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001701.html">[Twisted-web] HTTP redirection from data_*/render_* methods
</A></li>
	<LI>Next message: <A HREF="001705.html">[Twisted-web] HTTP redirection from data_*/render_* methods
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1704">[ date ]</a>
              <a href="thread.html#1704">[ thread ]</a>
              <a href="subject.html#1704">[ subject ]</a>
              <a href="author.html#1704">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
