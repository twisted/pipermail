<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] how are solving the calls to the children in nevow?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20how%20are%20solving%20the%20calls%20to%20the%20children%20in%20nevow%3F&In-Reply-To=42CDBF17.3020208%40pollenation.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001659.html">
   <LINK REL="Next"  HREF="001643.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] how are solving the calls to the children in nevow?</H1>
    <B>Alberto Trujillo</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20how%20are%20solving%20the%20calls%20to%20the%20children%20in%20nevow%3F&In-Reply-To=42CDBF17.3020208%40pollenation.net"
       TITLE="[Twisted-web] how are solving the calls to the children in nevow?">alberto.trujillo at ucd.ie
       </A><BR>
    <I>Fri Jul  8 04:48:44 MDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001659.html">[Twisted-web] how are solving the calls to the children in nevow?
</A></li>
        <LI>Next message: <A HREF="001643.html">[Twisted-web] how are solving the calls to the children in nevow?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1647">[ date ]</a>
              <a href="thread.html#1647">[ thread ]</a>
              <a href="subject.html#1647">[ subject ]</a>
              <a href="author.html#1647">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you very much Matt for this brief tutorial or personal class. It 
helped me a lot.

Matt Goodall wrote:

&gt;<i>Alberto Trujillo wrote:
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>Hello:
</I>&gt;&gt;<i>I have been following this example
</I>&gt;&gt;<i>&quot;<A HREF="http://nevowexamples.adytum.us/childrenhtml/&quot;to">http://nevowexamples.adytum.us/childrenhtml/&quot;to</A> know how works the
</I>&gt;&gt;<i>calls to the children with nevow, but still it's not enough clear for me.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>I even add a new child in the childFactory and some print command to
</I>&gt;&gt;<i>follow the way of the calls. Here I show you my modifications:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   def childFactory(self, ctx, name):
</I>&gt;&gt;<i>       print &quot;NAME = &quot; + name
</I>&gt;&gt;<i>       if name in ['1', '2', '3']:
</I>&gt;&gt;<i>           return ChildPage(name)
</I>&gt;&gt;<i>       elif name == 'one':
</I>&gt;&gt;<i>           return OneRoot()
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   def locateChild(self, ctx, segments):
</I>&gt;&gt;<i>       child, remainingSegments = rend.Page.locateChild(self, ctx,
</I>&gt;&gt;<i>segments)
</I>&gt;&gt;<i>       print &quot;CHILD = &quot; + str(child) + &quot; SEGMENT = &quot; +
</I>&gt;&gt;<i>str(remainingSegments)
</I>&gt;&gt;<i>       if child:
</I>&gt;&gt;<i>           print &quot;IN THE IF&quot;
</I>&gt;&gt;<i>           return child, remainingSegments
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>       return ChildPage('/'.join(segments)), []
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>My question is why each time that I call to &quot;one&quot; it goes inside
</I>&gt;&gt;<i>&quot;locateChild&quot; wheter &quot;one&quot; is place in &quot;childFactory&quot;, here is a trace
</I>&gt;&gt;<i>of my server.
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Only locateChild(self, context, segments) is part of the IResource API.
</I>&gt;<i>All the child_ and childFactory support is provided by the
</I>&gt;<i>rend.ChildLookupMixin class that rend.Page subclasses.
</I>&gt;<i>
</I>&gt;<i>What's happening in the above code is that you have an overridden
</I>&gt;<i>locateChild method that calls rend.Page.locateChild.
</I>&gt;<i>rend.Page.locateChild does the child_ and childFactory magic and calls
</I>&gt;<i>your childFactory method. Your childFactory prints the NAME and returns
</I>&gt;<i>the child resource back to your locateChild method which then also
</I>&gt;<i>prints it out as CHILD.
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>2005/07/07 13:52 IST [HTTPChannel,0,127.0.0.1] NAME = one
</I>&gt;&gt;<i>2005/07/07 13:52 IST [HTTPChannel,0,127.0.0.1] CHILD = &lt;one.OneRoot
</I>&gt;&gt;<i>object at 0x40701eac&gt; SEGMENT = ()
</I>&gt;&gt;<i>2005/07/07 13:52 IST [HTTPChannel,0,127.0.0.1] IN THE IF
</I>&gt;&gt;<i>2005/07/07 13:52 IST [HTTPChannel,0,127.0.0.1] 127.0.0.1 - -
</I>&gt;&gt;<i>[07/Jul/2005:12:52:11 +0000] &quot;GET /one?id=1 HTTP/1.1&quot; 200 47
</I>&gt;&gt;<i>&quot;<A HREF="http://localhost:8080/&quot;">http://localhost:8080/&quot;</A> &quot;Mozilla/5.0 (X11; U; Linux i686; en-US;
</I>&gt;&gt;<i>rv:1.7.8) Gecko/20050517 Firefox/1.0.4 (Debian package 1.0.4-2)&quot;
</I>&gt;&gt;<i>2005/07/07 13:52 IST [HTTPChannel,0,127.0.0.1] NAME = favicon.ico
</I>&gt;&gt;<i>2005/07/07 13:52 IST [HTTPChannel,0,127.0.0.1] CHILD = None SEGMENT = ()
</I>&gt;&gt;<i>2005/07/07 13:52 IST [HTTPChannel,0,127.0.0.1] 127.0.0.1 - -
</I>&gt;&gt;<i>[07/Jul/2005:12:52:11 +0000] &quot;GET /favicon.ico HTTP/1.1&quot; 200 684 &quot;-&quot;
</I>&gt;&gt;<i>&quot;Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.7.8) Gecko/20050517
</I>&gt;&gt;<i>Firefox/1.0.4 (Debian package 1.0.4-2)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>And when I return to the father, who call to childrenRoot class again,
</I>&gt;&gt;<i>and what is favicon.ico?. I show you the results here.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>2005/07/07 13:58 IST [HTTPChannel,1,127.0.0.1] NAME = favicon.ico
</I>&gt;&gt;<i>2005/07/07 13:58 IST [HTTPChannel,1,127.0.0.1] CHILD = None SEGMENT = ()
</I>&gt;&gt;<i>2005/07/07 13:58 IST [HTTPChannel,1,127.0.0.1] 127.0.0.1 - -
</I>&gt;&gt;<i>[07/Jul/2005:12:58:34 +0000] &quot;GET /favicon.ico HTTP/1.1&quot; 200 684 &quot;-&quot;
</I>&gt;&gt;<i>&quot;Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.7.8) Gecko/20050517
</I>&gt;&gt;<i>Firefox/1.0.4 (Debian package 1.0.4-2)&quot;
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>favicon.ico is something the browsers request. It's the annoying little
</I>&gt;<i>icon browsers add to tabs and bookmarks. I hate it. See
</I>&gt;<i>&lt;<A HREF="http://en.wikipedia.org/wiki/Favicon">http://en.wikipedia.org/wiki/Favicon</A>&gt;.
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>I would like to know as well if I must to implement all these methods
</I>&gt;&gt;<i>each time that I'm working with children, and what is segments.
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>segments is simply a tuple of the remaining URI path segments.
</I>&gt;<i>
</I>&gt;<i>A URL of <A HREF="http://localhost/foo/bar">http://localhost/foo/bar</A> has segments ('foo', 'bar'). Nevow
</I>&gt;<i>tries to turn those segments into child resources until there are no
</I>&gt;<i>more segments left. A typical sequence of events for that URL might be:
</I>&gt;<i>
</I>&gt;<i>1. Nevow asks the root resource to turn 'foo' into a resource. The root
</I>&gt;<i>resource returns a foo resource.
</I>&gt;<i>2. Nevow asks the foo resource to turn 'bar' into a resource. The foo
</I>&gt;<i>resource returns a bar resource.
</I>&gt;<i>3. Nevow seems that there are all segments have been used and asks the
</I>&gt;<i>bar resource to render itself.
</I>&gt;<i>
</I>&gt;<i>However, as you will see below the root resource could consume both
</I>&gt;<i>'foo' and 'bar' and return a bar resource directly.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>How you choose to traverse the URI depends on what you know and need to
</I>&gt;<i>do ...
</I>&gt;<i>
</I>&gt;<i>If you know the name of a child resource at development time and the
</I>&gt;<i>child resource never changes then use a child_ class attribute:
</I>&gt;<i>
</I>&gt;<i>    class Page(rend.Page):
</I>&gt;<i>        child_css = static.File('/path/to/css')
</I>&gt;<i>
</I>&gt;<i>If you know the name of a child but you need to create it in a special
</I>&gt;<i>way use a child_ method:
</I>&gt;<i>
</I>&gt;<i>    class Page(rend.Page):
</I>&gt;<i>        def child_time(self, ctx):
</I>&gt;<i>            return TimePage(time.now())
</I>&gt;<i>
</I>&gt;<i>If you don't know the name of the resource, i.e. it's a database id or
</I>&gt;<i>something similar, then use childFactory:
</I>&gt;<i>
</I>&gt;<i>    class Page(rend.Page):
</I>&gt;<i>        def childFactory(self, ctx, name):
</I>&gt;<i>            obj = db.getObj(int(name))
</I>&gt;<i>            return ChildPage(obj)
</I>&gt;<i>
</I>&gt;<i>Finally, if you want absolute control, i.e. to consume two URI segments
</I>&gt;<i>in one go, then override locateChild:
</I>&gt;<i>
</I>&gt;<i>    class Page(rend.Page):
</I>&gt;<i>       def locateChild(self, ctx, segments):
</I>&gt;<i>          if segments[:2] == ('foo', 'bar'):
</I>&gt;<i>             return BarPage(), segments[2:]
</I>&gt;<i>          return rend.Page(self, ctx, segments)
</I>&gt;<i>
</I>&gt;<i>Note how that example compares the first 2 segments and consumes both
</I>&gt;<i>'foo' and 'bar' by returning a new BarPage child and the remaining
</I>&gt;<i>segments - segments[2:]. Only locateChild is able to process more than
</I>&gt;<i>one segment at a time.
</I>&gt;<i>
</I>&gt;<i>Personally, I nearly always use child_ and childFactory. I only using
</I>&gt;<i>locateChild for more comlpex URL traversal problems.
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>Sorry I know that are a lot of question, but I don't have access to
</I>&gt;&gt;<i>the IRC channel and I couldn't understand the information in
</I>&gt;&gt;<i>&quot;inevow.IReource&quot;. 
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Hope this explains it well enough now.
</I>&gt;<i>
</I>&gt;<i>Cheers, Matt
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001659.html">[Twisted-web] how are solving the calls to the children in nevow?
</A></li>
	<LI>Next message: <A HREF="001643.html">[Twisted-web] how are solving the calls to the children in nevow?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1647">[ date ]</a>
              <a href="thread.html#1647">[ thread ]</a>
              <a href="subject.html#1647">[ subject ]</a>
              <a href="author.html#1647">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
