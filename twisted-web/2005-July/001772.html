<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Turkey questions 13-15
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Turkey%20questions%2013-15&In-Reply-To=2019.68.160.37.29.1122052632.squirrel%40www.wbsysnet.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001745.html">
   <LINK REL="Next"  HREF="001748.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Turkey questions 13-15</H1>
    <B>Matt Goodall</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Turkey%20questions%2013-15&In-Reply-To=2019.68.160.37.29.1122052632.squirrel%40www.wbsysnet.com"
       TITLE="[Twisted-web] Turkey questions 13-15">matt at pollenation.net
       </A><BR>
    <I>Mon Jul 25 16:52:58 MDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001745.html">[Twisted-web] Turkey questions 13-15
</A></li>
        <LI>Next message: <A HREF="001748.html">[Twisted-web] Remove addSlash from Nevow
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1772">[ date ]</a>
              <a href="thread.html#1772">[ thread ]</a>
              <a href="subject.html#1772">[ subject ]</a>
              <a href="author.html#1772">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">lloyd at paisite.com</A> wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> Thanks to Matt Goodall and Nils Grotnes, Techno Turkey's Twisted Adventure
</I>&gt;<i> is coming along at a slow, but sure pace. See <A HREF="http://twisted.paisite.com/">http://twisted.paisite.com/</A>
</I>&gt;<i> 
</I>&gt;<i> If you scroll down to Experiments.Twisted.Web you'll see the latest
</I>&gt;<i> experiment, Matt Goodall's Barebones Static Web Server.
</I>&gt;<i> 
</I>&gt;<i> I've done the best I can to explicate Matt's code, but not sure that I've
</I>&gt;<i> got it exactly right. Here're some questions:
</I>&gt;<i> 
</I>&gt;<i> Turkey question 13:
</I>&gt;<i> 
</I>&gt;<i> Any errors, misunderstandings, or confusing explanations so far in
</I>&gt;<i> Adventures?
</I>
Looks pretty good.

&gt;<i> 
</I>&gt;<i> Turkey question 14:
</I>&gt;<i> 
</I>&gt;<i> In the document &quot;Using Application&quot; the term &quot;service&quot; is used in a
</I>&gt;<i> technical sense. Could someone please give me a clear definition in plain
</I>&gt;<i> English?
</I>
Hmm, tricky. &quot;Service&quot; is a fairly meaningless term because it's so general.

I guess all I can say is that a service is some important part of your
application that is started and stopped in a controlled manner, i.e as
the application itself is started and stopped.

Typically a service manages resources that, without the predictable
startup and shutdown sequence, could be started too soon or left dangling.

Examples are:

  * a storage service that must open and close the store to avoid corruption
  * an integration service that opens a connection to some remote server
  * a mail service that creates and manages smtp, pop and imap servers

&gt;<i> 
</I>&gt;<i> Turkey question 15:
</I>&gt;<i> 
</I>&gt;<i> In an e-mail, Matt pointed out that the Barebones code could be &quot;easily
</I>&gt;<i> modified into something that creates a dynamic root resource.&quot;
</I>&gt;<i> 
</I>&gt;<i> What's the next logical step toward this goal? E.g. How can I modify and/or
</I>&gt;<i> add to the barebones code to support dynamic resources if, say, my
</I>&gt;<i> ultimate goal is an efficient, solid, secure production web-server that
</I>&gt;<i> supports virtual hosts and dynamic resources?
</I>
Here's a modified version of the barebones server that renders dynamic
pages instead of static pages:

-----------------------
from twisted.application import internet, service
from twisted.web import resource, server

LOGPATH = './logs/access.log'
PORT = 8080

class DynamicResource(resource.Resource):
    &quot;&quot;&quot;A simple, dynamic resource with a name.
    &quot;&quot;&quot;

    def __init__(self, name):
        resource.Resource.__init__(self)
        self.name = name

    def getChild(self, name, request):
        # If the child's name is '' - the empty segment - then return
        # myself.
        if name == '':
            return self
        # Return an instance of my type with the requested segment name.
        return DynamicResource(name)

    def render(self, request):
        return '&lt;html&gt;&lt;p&gt;I am a DynamicResource and my name is
%r.&lt;/p&gt;&lt;/html&gt;' % (self.name,)

application = service.Application('web-server')
site = server.Site(DynamicResource('root'), logPath=LOGPATH)
internet.TCPServer(PORT, site).setServiceParent(application)
-----------------------

There's really no conceptual difference between a DynamicResource and a
static.File resource. The only difference is how they choose to render
the request.

A couple of things worth pointing out here:

  * templating like that sucks. don't do it. use nevow, or one of the
    many templating libraries available for Python.
  * the name == '' bit in getChild is important for the root resource of
    a site but you often don't want that for resources deeper into the
    URL.

One other thing that needs mentioning is that the above is a twisted.web
resource. twisted.web2 (currently in development) is more flexible and
has a much stronger concept of the Response. To avoid confusion, I won't
say anymore about this. Go and read the code if you're interested.

To learn about virtual hosts you should read the &quot;Virtual Hosts&quot; section
of the twisted.web HOWTO.

<A HREF="http://twistedmatrix.com/projects/web/documentation/howto/using-twistedweb.html">http://twistedmatrix.com/projects/web/documentation/howto/using-twistedweb.html</A>

&gt;<i> 
</I>&gt;<i> In the spirit of Moshe's Finger tutorial, I'd like to take this
</I>&gt;<i> step-by-baby-step, illustrating and explaining key Twisted
</I>&gt;<i> interfaces/principles as I go.
</I>&gt;<i> 
</I>&gt;<i> Many thanks,
</I>
No problem. Hope it helps.

Cheers, Matt

-- 
     __
    /  \__     Matt Goodall, Pollenation Internet Ltd
    \__/  \    w: <A HREF="http://www.pollenation.net">http://www.pollenation.net</A>
  __/  \__/    e: <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">matt at pollenation.net</A>
 /  \__/  \    t: +44 (0)113 2252500
 \__/  \__/
 /  \	       Any views expressed are my own and do not necessarily
 \__/          reflect the views of my employer.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001745.html">[Twisted-web] Turkey questions 13-15
</A></li>
	<LI>Next message: <A HREF="001748.html">[Twisted-web] Remove addSlash from Nevow
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1772">[ date ]</a>
              <a href="thread.html#1772">[ thread ]</a>
              <a href="subject.html#1772">[ subject ]</a>
              <a href="author.html#1772">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
