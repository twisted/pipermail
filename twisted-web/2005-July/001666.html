<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Nevow patches
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Nevow%20patches&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001663.html">
   <LINK REL="Next"  HREF="001667.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Nevow patches</H1>
    <B>Tristan Seligmann</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Nevow%20patches&In-Reply-To="
       TITLE="[Twisted-web] Nevow patches">mithrandi-twisted-web at mithrandi.za.net
       </A><BR>
    <I>Tue Jul 12 03:59:40 MDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001663.html">[Twisted-web] LivePage branch complete; merged to trunk
</A></li>
        <LI>Next message: <A HREF="001667.html">[Twisted-web] liveglue.js patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1666">[ date ]</a>
              <a href="thread.html#1666">[ thread ]</a>
              <a href="subject.html#1666">[ subject ]</a>
              <a href="author.html#1666">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Just two quick Nevow patches. The first changes livepage.js.__getitem__
to accept a list or a tuple, and handle an empty sequence. The second
should fix handling of URLs containing quoted slashes.
-- 
mithrandi, i Ainil en-Balandor, a faer Ambar
-------------- next part --------------
Index: nevow/test/test_livepage.py
===================================================================
--- nevow/test/test_livepage.py	(revision 1620)
+++ nevow/test/test_livepage.py	(working copy)
@@ -172,6 +172,10 @@
         self.assertEquals(self.livepage.sent, &quot;array[5]&quot;)
         self.livepage.sendScript(livepage.js[1,2,3])
         self.assertEquals(self.livepage.sent, &quot;[1,2,3]&quot;)
+        self.livepage.sendScript(livepage.js[()])
+        self.assertEquals(self.livepage.sent, &quot;[]&quot;)
+        self.livepage.sendScript(livepage.js[[1,2,3]])
+        self.assertEquals(self.livepage.sent, &quot;[1,2,3]&quot;)
 
     def test_setAndAppend(self):
         for apiName in ['set', 'append']:
Index: nevow/livepage.py
===================================================================
--- nevow/livepage.py	(revision 1620)
+++ nevow/livepage.py	(working copy)
@@ -176,11 +176,12 @@
         return self.__class__(newchildren)
 
     def __getitem__(self, args):
-        if not isinstance(args, tuple):
+        if not isinstance(args, (tuple, list)):
             args = (args,)
         newchildren = self._children[:]
         stuff = [(x, stan.raw(',')) for x in args]
-        stuff[-1] = stuff[-1][0]
+        if stuff:
+            stuff[-1] = stuff[-1][0]
         newchildren.extend([stan.raw(&quot;[&quot;), stuff, stan.raw(&quot;]&quot;)])
         return self.__class__(newchildren)
 
-------------- next part --------------
Index: nevow/url.py
===================================================================
--- nevow/url.py	(revision 1442)
+++ nevow/url.py	(working copy)
@@ -68,7 +68,7 @@
         scheme, netloc, path, query, fragment = urlparse.urlsplit(st)
         u = klass(
             scheme, netloc,
-            [raw(urllib.unquote(seg)) for seg in path.split('/')[1:]],
+            [urllib.unquote(seg) for seg in path.split('/')[1:]],
             unquerify(query), fragment)
         return u
     fromString = classmethod(fromString)
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001663.html">[Twisted-web] LivePage branch complete; merged to trunk
</A></li>
	<LI>Next message: <A HREF="001667.html">[Twisted-web] liveglue.js patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1666">[ date ]</a>
              <a href="thread.html#1666">[ thread ]</a>
              <a href="subject.html#1666">[ subject ]</a>
              <a href="author.html#1666">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
