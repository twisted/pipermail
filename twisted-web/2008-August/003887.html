<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] newbie question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20newbie%20question&In-Reply-To=ead817660808161446kfee35ddk8c894765f98c6d9%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003886.html">
   <LINK REL="Next"  HREF="003888.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] newbie question</H1>
    <B>arun chhetri</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20newbie%20question&In-Reply-To=ead817660808161446kfee35ddk8c894765f98c6d9%40mail.gmail.com"
       TITLE="[Twisted-web] newbie question">uhcops at gmail.com
       </A><BR>
    <I>Mon Aug 18 11:15:46 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="003886.html">[Twisted-web] newbie question
</A></li>
        <LI>Next message: <A HREF="003888.html">[Twisted-web] newbie question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3887">[ date ]</a>
              <a href="thread.html#3887">[ thread ]</a>
              <a href="subject.html#3887">[ subject ]</a>
              <a href="author.html#3887">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>So, does this means that twisted.web can only handle one request at a
time,,,,, why It should do that.

thanks

On Sat, Aug 16, 2008 at 4:46 PM, Graeme Glass &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">graemeglass at gmail.com</A>&gt; wrote:

&gt;<i> On Sat, Aug 16, 2008 at 12:24 AM, arun chhetri &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">uhcops at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> hi,
</I>&gt;&gt;<i>  I have developed some twisted.web application. It connects to the other
</I>&gt;&gt;<i> server (CalDav) and then it displays back using twisted.web.
</I>&gt;&gt;<i> My problem is when a user logs into my website which is made using
</I>&gt;&gt;<i> twisted.web there is some data fetched from CALDAV server. When another =
</I>user
&gt;&gt;<i> logs into my website, even his data is downloaded from CalDav server but
</I>&gt;&gt;<i> this data overwrites the data of previous server. I think I am not able =
</I>to
&gt;&gt;<i> fork the process on each request. This is my just guess.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The Code is given below
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> from twisted.web import resource, static, server
</I>&gt;&gt;<i> import vobject
</I>&gt;&gt;<i> import calendarWebUtilities
</I>&gt;&gt;<i> import Calendar
</I>&gt;&gt;<i> import datetime
</I>&gt;&gt;<i> import re,calendar
</I>&gt;&gt;<i> import Month
</I>&gt;&gt;<i> import Week
</I>&gt;&gt;<i> import Day
</I>&gt;&gt;<i> import socket
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> class HomePage(resource.Resource):
</I>&gt;&gt;<i>     def render(self,request):
</I>&gt;&gt;<i>         return&quot;&quot;&quot;
</I>&gt;&gt;<i>     &lt;html&gt;
</I>&gt;&gt;<i>     &lt;head&gt;
</I>&gt;&gt;<i>     &lt;title&gt;VCalendar&lt;/title&gt;
</I>&gt;&gt;<i>     &lt;/head&gt;
</I>&gt;&gt;<i>     &lt;body&gt;
</I>&gt;&gt;<i>     &lt;form action=3D/optional method=3D&quot;post&quot;&gt;
</I>&gt;&gt;<i>         User Name &lt;input type=3D&quot;text&quot; name=3D&quot;username&quot;&gt;&lt;br/&gt;
</I>&gt;&gt;<i>         Pass Word &lt;input type=3D&quot;password&quot; name=3D&quot;pswd&quot;&gt;&lt;br/&gt;
</I>&gt;&gt;<i>         ServerAdd &lt;input type=3D&quot;text&quot; name=3D&quot;server&quot;&gt;&lt;br/&gt;
</I>&gt;&gt;<i>         &lt;input type=3D&quot;submit&quot; Value=3D&quot;Submit&quot;&gt;&lt;br/&gt;
</I>&gt;&gt;<i>     &lt;/form&gt;
</I>&gt;&gt;<i>     &lt;/body&gt;
</I>&gt;&gt;<i>     &lt;/html&gt;&quot;&quot;&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> class Optional(resource.Resource):
</I>&gt;&gt;<i>     def __init__(self):
</I>&gt;&gt;<i>         resource.Resource.__init__(self)
</I>&gt;&gt;<i>         self.CalendarData =3D {}
</I>&gt;&gt;<i>         self.account =3D {}
</I>&gt;&gt;<i>     def render(self,request):
</I>&gt;&gt;<i>         user =3D request.args[&quot;username&quot;]
</I>&gt;&gt;<i>         pswd =3D request.args[&quot;pswd&quot;]
</I>&gt;&gt;<i>         server =3D request.args[&quot;server&quot;]
</I>&gt;&gt;<i>         if user !=3D None:
</I>&gt;&gt;<i>             if pswd !=3D None:
</I>&gt;&gt;<i>                 if server !=3D None:
</I>&gt;&gt;<i>                     CalendarSource =3D None
</I>&gt;&gt;<i>                     CalendarSource =3D
</I>&gt;&gt;<i> Calendar.CalendarObject(user[0],pswd[0],server[0])
</I>&gt;&gt;<i>                     todayDate =3D datetime.datetime.now()
</I>&gt;&gt;<i>                     start =3D
</I>&gt;&gt;<i> datetime.datetime((todayDate.year-1),01,01,00,00)
</I>&gt;&gt;<i>                     end =3D
</I>&gt;&gt;<i> datetime.datetime((todayDate.year+1),12,31,23,59,59)
</I>&gt;&gt;<i>                     self.CalendarData['value'] =3D
</I>&gt;&gt;<i> CalendarSource.readCalendarComponent(start,end)
</I>&gt;&gt;<i>                     self.account['value'] =3D CalendarSource
</I>&gt;&gt;<i>                     self.index =3D 1
</I>&gt;&gt;<i>         request.redirect(&quot;/optional/Calendar&quot;)
</I>&gt;&gt;<i>         return &quot; &quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    def getChild(self,path,request):
</I>&gt;&gt;<i>         return MainCalendar(self.index,self.CalendarData,self.account)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> class MainCalendar(resource.Resource):
</I>&gt;&gt;<i>     def __init__(self,index,CalendarData,account):
</I>&gt;&gt;<i>         resource.Resource.__init__(self)
</I>&gt;&gt;<i>         self.index =3D index
</I>&gt;&gt;<i>         self.CalendarData =3D CalendarData
</I>&gt;&gt;<i>         self.account =3D account
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> self.putChild('Add',AddCalendarComponent(self.CalendarData,self.account))
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     def render(self,request):
</I>&gt;&gt;<i>         global Calendarata
</I>&gt;&gt;<i>         global account
</I>&gt;&gt;<i>         if request.path =3D=3D &quot;/optional/Calendar&quot; :
</I>&gt;&gt;<i>             request.redirect(&quot;/optional/Calendar/Month&quot;)
</I>&gt;&gt;<i>             return &quot; &quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     def getChild(self,path,request):
</I>&gt;&gt;<i>         if request.path =3D=3D &quot;/optional/Calendar/Month&quot;:
</I>&gt;&gt;<i>             return Month.month(self.CalendarData,self.index)
</I>&gt;&gt;<i>         elif request.path =3D=3D &quot;/optional/Calendar/Week&quot;:
</I>&gt;&gt;<i>             return Week.Week(self.CalendarData,self.index)
</I>&gt;&gt;<i>         elif request.path =3D=3D &quot;/optional/Calendar/Day&quot;:
</I>&gt;&gt;<i>             return Day.Day(self.CalendarData,self.index)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> class AddCalendarComponent(resource.Resource):
</I>&gt;&gt;<i>     def __init__(self,CalendarData,account):
</I>&gt;&gt;<i>         resource.Resource.__init__(self)
</I>&gt;&gt;<i>         self.CalendarData =3D CalendarData
</I>&gt;&gt;<i>         self.account =3D account
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     def render (self,request):
</I>&gt;&gt;<i>         #if request.args !=3D None:
</I>&gt;&gt;<i>         queryString =3D len(request.args)
</I>&gt;&gt;<i>         if queryString !=3D0:
</I>&gt;&gt;<i>             try :
</I>&gt;&gt;<i>                 summary1 =3D request.args['summary']
</I>&gt;&gt;<i>                 location1 =3D request.args['location']
</I>&gt;&gt;<i>                 startDate1 =3D request.args['startDate']
</I>&gt;&gt;<i>                 endDate1 =3D request.args['endDate']
</I>&gt;&gt;<i>                 CalendarSource =3D self.account['value']
</I>&gt;&gt;<i>                 event =3D
</I>&gt;&gt;<i> CalendarSource.convertToProperFormatAndAddToCalendar(summary1,location1,=
</I>startDate1,endDate1)
&gt;&gt;<i>                 (self.CalendarData['value']).append(event)
</I>&gt;&gt;<i>                 #CalendarData =3D {}
</I>&gt;&gt;<i>                 #print &quot;New Data Created&quot;
</I>&gt;&gt;<i>                 #print NewCalendar
</I>&gt;&gt;<i>                 #CalendarData['value'] =3D NewCalendar
</I>&gt;&gt;<i>                 request.redirect(&quot;/optional/Calendar&quot;)
</I>&gt;&gt;<i>                 return &quot; &quot;
</I>&gt;&gt;<i>             except KeyError:
</I>&gt;&gt;<i>                 request.args =3D {}
</I>&gt;&gt;<i>                 request.redirect('/optional/Calendar/Month/Add')
</I>&gt;&gt;<i>         else:
</I>&gt;&gt;<i>             return&quot;&quot;&quot;
</I>&gt;&gt;<i>         &lt;html&gt;
</I>&gt;&gt;<i>         &lt;head&gt;
</I>&gt;&gt;<i>         &lt;/head&gt;
</I>&gt;&gt;<i>         &lt;body&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         &lt;form action=3D&quot;/optional/Calendar/Add&quot; method=3D&quot;post&quot;&gt;
</I>&gt;&gt;<i>         Summary =3D &lt;INPUT type=3D&quot;text&quot; name=3D&quot;summary&quot;&gt;&lt;/br&gt;
</I>&gt;&gt;<i>         Location =3D &lt;input type=3D&quot;text&quot; name=3D&quot;location&quot;&gt;&lt;/br&gt;
</I>&gt;&gt;<i>         Start Date =3D &lt;input type=3D&quot;text&quot; name=3D&quot;startDate&quot;&gt;Should Be=
</I> in
&gt;&gt;<i> format year/MM/date/HH/MM&lt;/br&gt;
</I>&gt;&gt;<i>         End Date =3D &lt;input type=3D&quot;text&quot; name=3D&quot;endDate&quot;&gt;Should Be in =
</I>format
&gt;&gt;<i> year/MM/date/HH/MM&lt;/br&gt;
</I>&gt;&gt;<i>         &lt;input type=3D&quot;submit&quot;&gt;
</I>&gt;&gt;<i>         &lt;/form&gt;
</I>&gt;&gt;<i>         &lt;/body&gt;
</I>&gt;&gt;<i>         &lt;/html&gt;
</I>&gt;&gt;<i>         &quot;&quot;&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> if __name__ =3D=3D &quot;__main__&quot;:
</I>&gt;&gt;<i>     from twisted.internet import reactor
</I>&gt;&gt;<i>     root =3D resource.Resource()
</I>&gt;&gt;<i>     root.putChild('',HomePage())
</I>&gt;&gt;<i>     root.putChild('optional',Optional())
</I>&gt;&gt;<i>     site =3D server.Site(root)
</I>&gt;&gt;<i>     reactor.listenTCP(8000,site)
</I>&gt;&gt;<i>     reactor.run()
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I can guess there should be some method by which I can fork the root for
</I>&gt;&gt;<i> different request,, Please help.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Twisted-web mailing list
</I>&gt;&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">Twisted-web at twistedmatrix.com</A>
</I>&gt;&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> Try using a factory for your session storage instead of storing it in the
</I>&gt;<i> actually resource, that way you will be able to access your session
</I>&gt;<i> information from the resources without overriding it on every request. Ta=
</I>ke
&gt;<i> a look at twisted.internet.protocol.ServerFactory.
</I>&gt;<i>
</I>&gt;<i> HTH
</I>&gt;<i>
</I>&gt;<i> G
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-web mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">Twisted-web at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20080818/d1=">http://twistedmatrix.com/pipermail/twisted-web/attachments/20080818/d1=</A>
213144/attachment.htm
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003886.html">[Twisted-web] newbie question
</A></li>
	<LI>Next message: <A HREF="003888.html">[Twisted-web] newbie question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3887">[ date ]</a>
              <a href="thread.html#3887">[ thread ]</a>
              <a href="subject.html#3887">[ subject ]</a>
              <a href="author.html#3887">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
