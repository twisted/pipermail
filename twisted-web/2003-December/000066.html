<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Freeform/formless doesn't work with deferred properties?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000063.html">
   <LINK REL="Next"  HREF="000067.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Freeform/formless doesn't work with deferred properties?
   </H1>
    <B>Gavrie Philipson
    </B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com"
       TITLE="[Twisted-web] Freeform/formless doesn't work with deferred properties?">twisted-web@twistedmatrix.com
       </A><BR>
    <I>Mon, 22 Dec 2003 17:38:14 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="000063.html">[Twisted-web] Hierarchical data in Nevow (like Woven's submodels)?
</A></li>
        <LI> Next message: <A HREF="000067.html">[Twisted-web] Freeform/formless doesn't work with deferred properties?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#66">[ date ]</a>
              <a href="thread.html#66">[ thread ]</a>
              <a href="subject.html#66">[ subject ]</a>
              <a href="author.html#66">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is a multi-part message in MIME format.
--------------030001020902000004080608
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit

Hi,

I'm using freeform/formless to handle a form.
However, when the property returns a deferred value, it is not handled 
correctly by freeform.
Is this a bug?

Attached is an example (based on DP's examples) that shows the behavior: 
When rendering the page, instead of seeing &quot;50&quot; in the input field, it 
shows something like '&lt;Deferred at 0xbec7c30c&gt;'.

PS: A similar thing happens when returning a deferred as an attribute of 
context.tag in a render method.

-- Gavrie.

--------------030001020902000004080608
Content-Type: text/plain;
 name=&quot;formpost-defer.tac&quot;
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename=&quot;formpost-defer.tac&quot;


from twisted.application import service, internet
from twisted.internet import defer

from nevow import appserver
from nevow import renderer
from nevow import tags
from nevow import formless
from nevow import freeform


class IMyForm(formless.TypedInterface):
    foo = formless.Integer()


class FormPage(renderer.Renderer):
    __implements__ = IMyForm,

    def _getter(self):
        d = defer.Deferred()
        d.callback(50)
        return d

    foo = property(_getter)

    document = tags.html[
    tags.body[
        &quot;Hello! Here is a form:&quot;,
        freeform.configure
    ]
]


application = service.Application(&quot;nestedmenus&quot;)
internet.TCPServer(
    8080, 
    appserver.NevowSite(
        FormPage()
    )
).setServiceParent(application)

--------------030001020902000004080608--


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000063.html">[Twisted-web] Hierarchical data in Nevow (like Woven's submodels)?
</A></li>
	<LI> Next message: <A HREF="000067.html">[Twisted-web] Freeform/formless doesn't work with deferred properties?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#66">[ date ]</a>
              <a href="thread.html#66">[ thread ]</a>
              <a href="subject.html#66">[ subject ]</a>
              <a href="author.html#66">[ author ]</a>
         </LI>
       </UL>
</body></html>
