<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] data=&quot;../foo&quot;, or, how to prevent adding IData to centxt
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000003.html">
   <LINK REL="Next"  HREF="000010.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] data=&quot;../foo&quot;, or, how to prevent adding IData to centxt
   </H1>
    <B>Donovan Preston
    </B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com"
       TITLE="[Twisted-web] data=&quot;../foo&quot;, or, how to prevent adding IData to centxt">twisted-web@twistedmatrix.com
       </A><BR>
    <I>Thu, 11 Dec 2003 10:57:56 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="000003.html">[Twisted-web] data=&quot;../foo&quot;, or, how to prevent adding IData to centxt
</A></li>
        <LI> Next message: <A HREF="000010.html">[Twisted-web] data=&quot;../foo&quot;, or, how to prevent adding IData
 to centxt
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6">[ date ]</a>
              <a href="thread.html#6">[ thread ]</a>
              <a href="subject.html#6">[ subject ]</a>
              <a href="author.html#6">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>--Apple-Mail-1-509279288
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=US-ASCII;
	format=flowed


On Dec 11, 2003, at 6:58 AM, Christopher Armstrong wrote:

&gt;<i> I have a renderer:
</I>&gt;<i>
</I>&gt;<i>     def render_select(self, ctx, data):
</I>&gt;<i>         try:
</I>&gt;<i>             return ctx.keyed(data)
</I>&gt;<i>         except context.NodeNotFound:
</I>&gt;<i>             return ctx.keyed('else')
</I>
*snip*

&gt;<i> This is causing nevow to try to do IContainer(directive('usertype')) 
</I>&gt;<i> so it can get the 'addPageForm' child. addPageForm isn't a child of 
</I>&gt;<i> usertype, though, so the most obvious thing to me (coming from a 
</I>&gt;<i> Woven) background would be to use &quot;../addPageForm&quot; instead of 
</I>&gt;<i> &quot;addPageForm&quot; -- but nevow doesn't support that.
</I>
In woven, the only way to put some data onto the stack was to use a 
directive (a string indicating how to find some data). In nevow, stan 
tags can hold references to other objects using &quot;specials&quot; -- special 
attribute names which aren't used in rendering HTML directly, but are 
used to *inform* the rendering process. Data is one of those specials. 
So if you are returning a node and you don't like the data which it 
will naturally get due to it's position in the context hierarchy, you 
can tell it what data to use explicitly.

def render_select(self, ctx, data):
     try:
         rv = ctx.keyed(data)
     except context.NodeNotFound:
         rv = ctx.keyed('else')
     return rv(data=ctx.locate(IData, depth=2))

In this case, we locate a stan node using the ctx.keyed method, which 
finds a node with the given key; we then &quot;call&quot; it and pass the data we 
want that node to use. (Calling stan nodes is the method used to set 
attributes/specials.)

The &quot;depth&quot; parameter to the locate method call is the moral equivalent 
of Woven's &quot;.&quot; and &quot;..&quot; and &quot;../..&quot; directives. Calling locate with 
depth=1 will locate the current data, or &quot;.&quot;, and calling locate with 
depth=2 will locate the parent data, or &quot;..&quot;, etc.

nevow was specifically designed to allow this, as it gives your python 
code far more control over what is really going on in the rendering 
process.

dp

--Apple-Mail-1-509279288
Content-Transfer-Encoding: 7bit
Content-Type: text/enriched;
	charset=US-ASCII



On Dec 11, 2003, at 6:58 AM, Christopher Armstrong wrote:


&lt;excerpt&gt;I have a renderer:


    def render_select(self, ctx, data):

        try:

            return ctx.keyed(data)

        except context.NodeNotFound:

            return ctx.keyed('else')

&lt;/excerpt&gt;

*snip*


&lt;excerpt&gt;This is causing nevow to try to do
IContainer(directive('usertype')) so it can get the 'addPageForm'
child. addPageForm isn't a child of usertype, though, so the most
obvious thing to me (coming from a Woven) background would be to use
&quot;../addPageForm&quot; instead of &quot;addPageForm&quot; -- but nevow doesn't support
that.

&lt;/excerpt&gt;

In woven, the only way to put some data onto the stack was to use a
directive (a string indicating how to find some data). In nevow, stan
tags can hold references to other objects using &quot;specials&quot; -- special
attribute names which aren't used in rendering HTML directly, but are
used to *inform* the rendering process. Data is one of those specials.
So if you are returning a node and you don't like the data which it
will naturally get due to it's position in the context hierarchy, you
can tell it what data to use explicitly.


&lt;fontfamily&gt;&lt;param&gt;Verdana&lt;/param&gt;def render_select(self, ctx, data):

    try:

        rv = ctx.keyed(data)

    except context.NodeNotFound:

        rv = ctx.keyed('else')

    return rv(data=ctx.locate(IData, depth=2))

&lt;/fontfamily&gt;

In this case, we locate a stan node using the ctx.keyed method, which
finds a node with the given key; we then &quot;call&quot; it and pass the data
we want that node to use. (Calling stan nodes is the method used to
set attributes/specials.)


The &quot;depth&quot; parameter to the locate method call is the moral
equivalent of Woven's &quot;.&quot; and &quot;..&quot; and &quot;../..&quot; directives. Calling
locate with depth=1 will locate the current data, or &quot;.&quot;, and calling
locate with depth=2 will locate the parent data, or &quot;..&quot;, etc.


nevow was specifically designed to allow this, as it gives your python
code far more control over what is really going on in the rendering
process.


dp


--Apple-Mail-1-509279288--



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000003.html">[Twisted-web] data=&quot;../foo&quot;, or, how to prevent adding IData to centxt
</A></li>
	<LI> Next message: <A HREF="000010.html">[Twisted-web] data=&quot;../foo&quot;, or, how to prevent adding IData
 to centxt
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6">[ date ]</a>
              <a href="thread.html#6">[ thread ]</a>
              <a href="subject.html#6">[ subject ]</a>
              <a href="author.html#6">[ author ]</a>
         </LI>
       </UL>
</body></html>
