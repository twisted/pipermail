<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Problems uploading data in web2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Problems%20uploading%20data%20in%20web2&In-Reply-To=f33a4da20602060252x5465109fmbd6c8c9b842b6ef5%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002449.html">
   <LINK REL="Next"  HREF="002454.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Problems uploading data in web2</H1>
    <B>James Y Knight</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Problems%20uploading%20data%20in%20web2&In-Reply-To=f33a4da20602060252x5465109fmbd6c8c9b842b6ef5%40mail.gmail.com"
       TITLE="[Twisted-web] Problems uploading data in web2">foom at fuhm.net
       </A><BR>
    <I>Mon Feb  6 14:11:17 MST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002449.html">[Twisted-web] Problems uploading data in web2
</A></li>
        <LI>Next message: <A HREF="002454.html">[Twisted-web] Problems uploading data in web2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2450">[ date ]</a>
              <a href="thread.html#2450">[ thread ]</a>
              <a href="subject.html#2450">[ subject ]</a>
              <a href="author.html#2450">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Feb 6, 2006, at 5:52 AM, Henrik Thostrup Jensen wrote:

&gt;<i> Hi
</I>&gt;<i>
</I>&gt;<i> I'm trying to use web2 to stream uploading of data, but I ran into  
</I>&gt;<i> some problems. First I tried building from the example in  http:// 
</I>&gt;<i> twistedmatrix.com/projects/web2/documentation/examples/demo.html,  
</I>&gt;<i> however args and files objects in the request did not show  
</I>&gt;<i> anything.  However the length of stream was correct, and using  
</I>&gt;<i> tcpdump, showed the correct value. So I tried building my own  
</I>&gt;<i> uploader which look like this:
</I>
What are you actually trying to do? There's two different kinds of  
&quot;streaming upload&quot;. The simpler is just a raw data stream. If you  
just want raw data, forget POST and associated form processing, and  
just use request.stream.read() in with a PUT method. That will work  
with curl -T.

However, if you want it to be the result of a form post from a web  
browser, you'll need the MIME multipart support. The default POST  
support (with PostableResource) parses the multipart stream, and  
places all the results in memory or temporary files (depending on  
size), in the args &amp; files dicts. It parses the data incrementally,  
but doesn't give control to your &quot;render&quot; method until all the data  
has been uploaded. If all you're looking for from a streaming upload  
is to not buffer everything in memory, this will do it for you.

If that's not good enough for your application, if you really need  
access to the data as it's being uploaded, you'll need to use the  
lower level machinery in fileupload: the MultipartMimeStream class.  
You give this a raw data stream (request.stream), and the multipart  
boundary from the content-type, then call its read() method  
repeatedly to get back tuples of (fieldname, filename, ctype,  
dataStream). Then you use dataStream.read() to get back data blocks  
and can do whatever you like with them.

I can help explain any of the alternatives in more detail if you let  
me know which you're really interested in.

James
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20060206/3165b528/attachment.htm">http://twistedmatrix.com/pipermail/twisted-web/attachments/20060206/3165b528/attachment.htm</A>
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002449.html">[Twisted-web] Problems uploading data in web2
</A></li>
	<LI>Next message: <A HREF="002454.html">[Twisted-web] Problems uploading data in web2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2450">[ date ]</a>
              <a href="thread.html#2450">[ thread ]</a>
              <a href="subject.html#2450">[ subject ]</a>
              <a href="author.html#2450">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
