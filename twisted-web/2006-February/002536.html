<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Using Cheetah with twisted.web
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Using%20Cheetah%20with%20twisted.web&In-Reply-To=612023ed0602222059l758515b3v369b61cd931e41c5%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002535.html">
   <LINK REL="Next"  HREF="002537.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Using Cheetah with twisted.web</H1>
    <B>Todd Thomas</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Using%20Cheetah%20with%20twisted.web&In-Reply-To=612023ed0602222059l758515b3v369b61cd931e41c5%40mail.gmail.com"
       TITLE="[Twisted-web] Using Cheetah with twisted.web">caliban19 at gmail.com
       </A><BR>
    <I>Wed Feb 22 22:23:03 MST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002535.html">[Twisted-web] Using Cheetah with twisted.web
</A></li>
        <LI>Next message: <A HREF="002537.html">[Twisted-web] remote admin app, ssh connection costs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2536">[ date ]</a>
              <a href="thread.html#2536">[ thread ]</a>
              <a href="subject.html#2536">[ subject ]</a>
              <a href="author.html#2536">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2/22/06, Todd Thomas &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">caliban19 at gmail.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 2/22/06, Matt Helm &lt; <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">code.name.eric at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On 2/21/06, Graeme Glass wrote:
</I>&gt;<i> &gt; &gt; Would you mind posting some sample code, for refrence?
</I>&gt;<i> &gt; &gt; Many thanks.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; class Resource(resource.Resource):
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;    def render(self, request):
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;        def cheeto(r):
</I>&gt;<i> &gt;            request.write(r.__str__())
</I>&gt;<i> &gt;            request.finish()
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;        def cherr(r):
</I>&gt;<i> &gt;            request.write(&quot;Bang!&quot;)
</I>&gt;<i> &gt;            request.write(str(r))
</I>&gt;<i> &gt;            request.finish()
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;        d_cheeto = threads.deferToThread(Template, file=&quot;alf.tmpl&quot;,
</I>&gt;<i> &gt; searchList =
</I>&gt;<i> &gt; slist)
</I>&gt;<i> &gt;        d_cheeto.addCallback(cheeto)
</I>&gt;<i> &gt;        d_cheeto.addErrback(cherr)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;        return server.NOT_DONE_YET
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; resource = Resource()
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Twisted-web mailing list
</I>&gt;<i> &gt; <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">Twisted-web at twistedmatrix.com</A>
</I>&gt;<i> &gt; <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web</A>
</I>&gt;<i> &gt;
</I>&gt;<i> webexp.py
</I>&gt;<i> --------------------------------------------
</I>&gt;<i> from twisted.application import internet, service
</I>&gt;<i> from twisted.web import static, server, script
</I>&gt;<i> import CheetahMapper
</I>&gt;<i>
</I>&gt;<i> root = static.File(&quot;./&quot;)
</I>&gt;<i> root.indexNames=['index.cht']
</I>&gt;<i> root.ignoreExt(&quot;.cht&quot;)
</I>&gt;<i> root.processors = {'.cht': CheetahMapper.CheetahResource}
</I>&gt;<i> application = service.Application('web')
</I>&gt;<i> sc = service.IServiceCollection(application)
</I>&gt;<i> site = server.Site(root)
</I>&gt;<i> i = internet.TCPServer(8888, site)
</I>&gt;<i> i.setServiceParent(sc)
</I>&gt;<i>
</I>&gt;<i> CheetahMapper.py
</I>&gt;<i> ------------------------------------------------
</I>&gt;<i> from twisted.web import resource, server
</I>&gt;<i> from Cheetah.Template import Template
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> class CheetahResource(resource.Resource):
</I>&gt;<i>     isLeaf = 1
</I>&gt;<i>
</I>&gt;<i>     def __init__(self, filename, registry):
</I>&gt;<i>         self.filename = filename
</I>&gt;<i>         self.registry = registry
</I>&gt;<i>
</I>&gt;<i>     def render(self, request):
</I>&gt;<i>         tmplt = Template.compile(file=self.filename)
</I>&gt;<i>         inst=tmplt()
</I>&gt;<i>         request.write(str(inst))
</I>&gt;<i>         request.finish()
</I>&gt;<i>         return server.NOT_DONE_YET
</I>&gt;<i>
</I>&gt;<i> time.cht
</I>&gt;<i> ------------------------------------------------------
</I>&gt;<i> #import time
</I>&gt;<i> &lt;html&gt;
</I>&gt;<i> &lt;head&gt;
</I>&gt;<i> &lt;title&gt;Time Example&lt;/title&gt;
</I>&gt;<i> &lt;/head&gt;
</I>&gt;<i> &lt;body&gt;
</I>&gt;<i> It is $time.strftime(&quot;%I:%M %p&quot;).
</I>&gt;<i> &lt;br&gt;
</I>&gt;<i> Date is $time.strftime(&quot;%A, %B %D, %Y&quot;).
</I>&gt;<i> &lt;/body&gt;
</I>&gt;<i> &lt;/html&gt;
</I>&gt;<i> -----------------------------------------------------------------------
</I>&gt;<i> Not the best code in the world, but it has been useful for me for just
</I>&gt;<i> throwing together quick pages and experimenting.
</I>&gt;<i>
</I>&gt;<i> ToddB
</I>&gt;<i>
</I>There is a catch22 with cheetah and twisted that just annoys me. Cheetah has
an excellent caching mechanism built in, which would be awesome to use for
deferreds which access databases. If you basically use Cheetah via namespace
there is no way to use this caching. You could wrap cheetah class in a
deferred, then call deferred from within the template but this seems like
overkill, wish there was a way to see if result is cached then call deferred
if needed, so far I haven't found an obvious way for this to work.

ToddB
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20060222/cfd2ff48/attachment.htm">http://twistedmatrix.com/pipermail/twisted-web/attachments/20060222/cfd2ff48/attachment.htm</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002535.html">[Twisted-web] Using Cheetah with twisted.web
</A></li>
	<LI>Next message: <A HREF="002537.html">[Twisted-web] remote admin app, ssh connection costs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2536">[ date ]</a>
              <a href="thread.html#2536">[ thread ]</a>
              <a href="subject.html#2536">[ subject ]</a>
              <a href="author.html#2536">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
