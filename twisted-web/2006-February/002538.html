<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Some help with Nevow and databse I/O
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Some%20help%20with%20Nevow%20and%20databse%20I/O&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002537.html">
   <LINK REL="Next"  HREF="002539.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Some help with Nevow and databse I/O</H1>
    <B>Eric Gaumer</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Some%20help%20with%20Nevow%20and%20databse%20I/O&In-Reply-To="
       TITLE="[Twisted-web] Some help with Nevow and databse I/O">egaumer at pagecache.org
       </A><BR>
    <I>Fri Feb 24 11:11:21 MST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002537.html">[Twisted-web] remote admin app, ssh connection costs
</A></li>
        <LI>Next message: <A HREF="002539.html">[Twisted-web] Some help with Nevow and databse I/O
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2538">[ date ]</a>
              <a href="thread.html#2538">[ thread ]</a>
              <a href="subject.html#2538">[ subject ]</a>
              <a href="author.html#2538">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello everyone,

Twisted is relatively new to me but I've become fascinated by the idea of 
asynchronous network programming and I generally enjoy the feel of the 
twisted framework.

I'm developing a web application with a limited set of pages that will 
eventually serve as a bandwidth statistics application (uses SNMP to poll 
switch counters).

I'm using newvow to render some simple XML pages which basically take the form 
of:

    def data_listCusotmers(self, context, data):
        args = inevow.IRequest(context).args
        db = shelve.open('authdb')
        return db

    docFactory = loaders.xmlfile('templates/ListCustomers.html')

I have two questions that are somewhat interrelated. In my test cases I have 
authentication (using nevow session guard) setup using a SHA stored via the 
shelve module. 

The true customer info is stored in a MySQL database. I can pull that data 
doing the following:

    def data_query(self, context, data):
        return self.dbpool.runQuery('SELECT name, email, id, TransferType, 			
		basic_charge, over_charge, permitted_transfer FROM Customers')

I've read Abe's book on twisted and on page 54 he states &quot;Nevow is designed 
from the ground up for Twisted, which means you can use Deferreds everywhere&quot;

My question is do I have to use the adbapi module or can I use deferreds to 
handle database queries?

I've read the docs on deferreds but I'd be lying if I said I can fully wrap my 
brain around all aspects of the concept or how it's implemented.

I don't understand why I would need separate threads in the first place. I 
know that the query would block but isn't that transaction being done via 
sockets anyway? Why can't I use the same mechanism (deferred) I would use, to 
say, defer work waiting on a response from a mail server? Can't I submit a 
query, have the reactor go do something else, and have a callback run when 
the data becomes available? Why do I need to spawn threads to avoid blocking?

It should be pretty obvious that I don't fully grasp the concept of 
asynchronous socket programming. Can somebody provide insight that may help 
me to better understand things.

I can live with using the adbapi but wonder if it's possible to simply defer 
that work and use a callback mechanism (I'm using the original twisted.web 
not twisted.web2).

I've also read Glyf's post where he states &quot;The documentation is really poor, 
and never says this, but using Twisted, or rather ADBAPI, to convert every 
single SQL statement into a separate transaction and handle its results 
separately, has a whole slew of problems&quot;.

<A HREF="http://glyf.livejournal.com/2005/09/24/">http://glyf.livejournal.com/2005/09/24/</A>

I was pretty much heading down this road but I don't really understand how 
else to do it. I've browsed many examples and have never really come across 
one that involves session.guard, newvow, and db access all in the same 
application. Anyone have any experience they could share?

Thanks, 

-- 
Eric Gaumer
Debian GNU/Linux PPC
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">egaumer at pagecache.org</A>
<A HREF="http://egaumer.pagecache.org">http://egaumer.pagecache.org</A>
PGP/GPG Key 0xF15D41E9
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20060224/273e48e7/attachment.pgp">http://twistedmatrix.com/pipermail/twisted-web/attachments/20060224/273e48e7/attachment.pgp</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002537.html">[Twisted-web] remote admin app, ssh connection costs
</A></li>
	<LI>Next message: <A HREF="002539.html">[Twisted-web] Some help with Nevow and databse I/O
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2538">[ date ]</a>
              <a href="thread.html#2538">[ thread ]</a>
              <a href="subject.html#2538">[ subject ]</a>
              <a href="author.html#2538">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
