<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Web2 Script.py seems to be broken
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Web2%20Script.py%20seems%20to%20be%20broken&In-Reply-To=612023ed0602081340w2938bf39scdfe7b4dc0420a58%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002468.html">
   <LINK REL="Next"  HREF="002473.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Web2 Script.py seems to be broken</H1>
    <B>Todd Thomas</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Web2%20Script.py%20seems%20to%20be%20broken&In-Reply-To=612023ed0602081340w2938bf39scdfe7b4dc0420a58%40mail.gmail.com"
       TITLE="[Twisted-web] Web2 Script.py seems to be broken">caliban19 at gmail.com
       </A><BR>
    <I>Thu Feb  9 01:23:03 MST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002468.html">[Twisted-web] Web2 Script.py seems to be broken
</A></li>
        <LI>Next message: <A HREF="002473.html">[Twisted-web] Web2 Script.py seems to be broken
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2472">[ date ]</a>
              <a href="thread.html#2472">[ thread ]</a>
              <a href="subject.html#2472">[ subject ]</a>
              <a href="author.html#2472">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 2/8/06, Todd Thomas &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">caliban19 at gmail.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 2/8/06, David Reid &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">dreid at dreid.org</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Todd Thomas wrote:
</I>&gt;<i> &gt; &gt; It does support wsgi, I was playing around with it. I went back to
</I>&gt;<i> &gt; &gt; twisted-web, I like its lower level approach. Using http.request
</I>&gt;<i> &gt; &gt; directly vs. resources is nice since I can pretty much tell exactly
</I>&gt;<i> &gt; what
</I>&gt;<i> &gt; &gt; is going on. I love the fact that you can work at an extremely low
</I>&gt;<i> &gt; level
</I>&gt;<i> &gt; &gt; in twisted-web. I hope twisted-web2 doesn't get too high level.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I don't really understand this, twisted.web _has_ resources.  They're
</I>&gt;<i> &gt; not very good in that one resource is expected to return another
</I>&gt;<i> &gt; resource to consume the next segment in the path, which makes it hard to
</I>&gt;<i> &gt; stop the machinery.  But if you mean what I think you mean (which I hope
</I>&gt;<i> &gt; you don't) and that you're working with your own server.Site then I'd
</I>&gt;<i> &gt; say you need twisted.web2 more than anyone, because it's resource api
</I>&gt;<i> &gt; will allow you to make your framework work along side others.  Which is
</I>&gt;<i> &gt; one of the problems with current Nevow and part of the reason
</I>&gt;<i> &gt; twisted.web2 was started.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -David
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Twisted-web mailing list
</I>&gt;<i> &gt; <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">Twisted-web at twistedmatrix.com</A>
</I>&gt;<i> &gt; <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web</A>
</I>&gt;<i> &gt;
</I>&gt;<i> You just described exactly the problem I am currently having with
</I>&gt;<i> twisted-web2. I tried to create wsgi as a root resource, however its also
</I>&gt;<i> dependent on static files in media directory. I wasn't able to create a
</I>&gt;<i> child object due to no matter what it passes full path to the wsgi
</I>&gt;<i> application. So then I made it a child of a root resource, this sort of
</I>&gt;<i> worked. But since the root path was consumed when it is passed to the child
</I>&gt;<i> resource, when the application does a redirect, it creates the url in
</I>&gt;<i> relation to root, not the child url. In my own application I could work
</I>&gt;<i> around this without too much difficulty since I already know where my child
</I>&gt;<i> is in relation to the root object.
</I>&gt;<i>
</I>Okay, I seemed to have solved most of my problems. Only issue having now is
pysqlite2 doesn't like being called from threads seperate from the ones that
created it. It could be run as a deferred in this case since it does respond
pretty quick. But I am sure could solve this issue simply by changing to
mysql or postgresql. The solution was stupidly simple.

from twisted.application import strports, service
from twisted.web2 import static, server, http, wsgi, resource

import sys
sys.path.append(&quot;./myproject&quot;)
from django.core.handlers.wsgi import WSGIHandler
import os
os.environ['DJANGO_SETTINGS_MODULE'] = 'myproject.settings'

class toplevel(wsgi.WSGIResource):


    def child_media(self, ctx):
        return static.File(&quot;./myproject/media&quot;)


root = toplevel(WSGIHandler())
application = service.Application(&quot;web&quot;)
site = server.Site(root)
s = strports.service('tcp:8000', http.HTTPFactory(site))
s.setServiceParent(application)


It works fairly well, or would if I wasn't testing on windows. Before you
ask why windows. I have box I dual boot into and normally run secure shell
to, using ubuntu linux currently. Unfortunately my computer has sims 2 on
which my g/f has been playing religiously lately. So I am stuck using
windows at work for right now.

ToddB
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20060209/82a54bb7/attachment-0001.htm">http://twistedmatrix.com/pipermail/twisted-web/attachments/20060209/82a54bb7/attachment-0001.htm</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002468.html">[Twisted-web] Web2 Script.py seems to be broken
</A></li>
	<LI>Next message: <A HREF="002473.html">[Twisted-web] Web2 Script.py seems to be broken
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2472">[ date ]</a>
              <a href="thread.html#2472">[ thread ]</a>
              <a href="subject.html#2472">[ subject ]</a>
              <a href="author.html#2472">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
