<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Problems uploading data in web2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Problems%20uploading%20data%20in%20web2&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002448.html">
   <LINK REL="Next"  HREF="002450.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Problems uploading data in web2</H1>
    <B>Henrik Thostrup Jensen</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Problems%20uploading%20data%20in%20web2&In-Reply-To="
       TITLE="[Twisted-web] Problems uploading data in web2">thostrup at gmail.com
       </A><BR>
    <I>Mon Feb  6 03:52:06 MST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002448.html">[Twisted-web] xmlrpc and deferred result doubts
</A></li>
        <LI>Next message: <A HREF="002450.html">[Twisted-web] Problems uploading data in web2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2449">[ date ]</a>
              <a href="thread.html#2449">[ thread ]</a>
              <a href="subject.html#2449">[ subject ]</a>
              <a href="author.html#2449">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

I'm trying to use web2 to stream uploading of data, but I ran into some
problems. First I tried building from the example in
<A HREF="http://twistedmatrix.com/projects/web2/documentation/examples/demo.html,">http://twistedmatrix.com/projects/web2/documentation/examples/demo.html,</A>
however args and files objects in the request did not show anything.
However the length of stream was correct, and using tcpdump, showed the
correct value. So I tried building my own uploader which look like this:

class Uploader(resource.PostableResource):
    def http_POST(self, ctx):
        request = iweb.IRequest(ctx)
        self.parse_stream(request.stream)

    @defer.deferredGenerator
    def parse_stream(self, stream):
        from twisted.web2 import fileupload
        s = fileupload.parse_urlencoded_stream(stream)
        while True:
            datas = s.read()
            datas = fileupload.wait(datas)
            yield datas
            datas = datas.getResult()

Using the 0.1.0 release of web2 didn't get past the yield line. Using latest
from subversion (revision 15836), got past, but datas was None, even though
data had been send. I've used both cURL (using the -d switch) and wget
(using the --post-file switch) for uploading data, so I do not think the
client as malfunctioning. What am I doing wrong?

I'm aware that web2 is under development and all that, but I need streaming
upload, so the web module is not an option.

--
   - Henrik
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20060206/345e04b9/attachment.htm">http://twistedmatrix.com/pipermail/twisted-web/attachments/20060206/345e04b9/attachment.htm</A>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002448.html">[Twisted-web] xmlrpc and deferred result doubts
</A></li>
	<LI>Next message: <A HREF="002450.html">[Twisted-web] Problems uploading data in web2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2449">[ date ]</a>
              <a href="thread.html#2449">[ thread ]</a>
              <a href="subject.html#2449">[ subject ]</a>
              <a href="author.html#2449">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
