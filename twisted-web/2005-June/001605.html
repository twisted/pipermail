<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Formless, custom form layout
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Formless%2C%20custom%20form%20layout&In-Reply-To=42C4403B.3080708%40colorstudy.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001604.html">
   <LINK REL="Next"  HREF="001529.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Formless, custom form layout</H1>
    <B>Valentino Volonghi aka Dialtone</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Formless%2C%20custom%20form%20layout&In-Reply-To=42C4403B.3080708%40colorstudy.com"
       TITLE="[Twisted-web] Formless, custom form layout">dialtone at divmod.com
       </A><BR>
    <I>Thu Jun 30 13:28:24 MDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001604.html">[Twisted-web] Formless, custom form layout
</A></li>
        <LI>Next message: <A HREF="001529.html">[Twisted-web] Where is freeform, renderer, and formless
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1605">[ date ]</a>
              <a href="thread.html#1605">[ thread ]</a>
              <a href="subject.html#1605">[ subject ]</a>
              <a href="author.html#1605">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ian Bicking wrote:

&gt;<i> I'm proposing that validation and form generation be *completely*
</I>&gt;<i> seperate.  So you get several real data structures.  The validation
</I>&gt;<i> produces something like this:
</I>&gt;<i>
</I>&gt;<i>   {'field_name': 'field_value', ...}
</I>&gt;<i>   {'field_name': 'error_string', ...}
</I>
That's how forms works. Perhaps I missed some bits of my reasoning.
The validation result is exactly a dict of

{'field_name': 'field_value'..}

passed to the method which signature is:

def callback(self, ctx, form, data)

and data is the dict you want.
The same is for the error 'dict', but you won't use that since it will
be used
during re-rendering of the page with error messages.

&gt;<i> You can package that in an object or whatever, but that's the basic
</I>&gt;<i> data.  Then the form generation produces:
</I>&gt;<i>
</I>&gt;<i>   &lt;input type=&quot;text&quot; name=&quot;field_name&quot;&gt;
</I>&gt;<i>
</I>right

&gt;<i> Then a third component (like htmlfill) puts these two items together,
</I>&gt;<i> but does so with no knowledge of how the data came into being.  And
</I>&gt;<i> the actual logic for redisplaying forms and whatnot should be entirely
</I>&gt;<i> seperate, because
</I>&gt;<i>
</I>I guess htmlfill role is played by FormRenderer which is the one that
collects all the form fields and renders each of them.

&gt;<i> Traditionally form toolkits generate HTML widgets with values and
</I>&gt;<i> errors  already filled in.  This binds HTML generation to the
</I>&gt;<i> validation process, which almost always falls apart eventually,
</I>&gt;<i> because no one HTML generator is general enough (and the most general
</I>&gt;<i> HTML generator -- an actual person writing HTML by hand -- should
</I>&gt;<i> always be allowed for).
</I>
Currently forms doesn't 'support' form customization. Right now it
renders itself over this pattern:

        T.form(id=T.slot('id'), action=T.slot('action'),
class_='nevow-form', method='post', enctype='multipart/form-data',
**{'accept-charset':'utf-8'})[
            T.input(type='hidden', name='_charset_'),
            T.slot('errors'),
            T.slot('items'),
            T.div(id=T.slot('fieldId'), pattern='item',
_class=T.slot('class'))[
                T.label(_for=T.slot('id'))[T.slot('label')],
                T.div(_class='inputs')[T.slot('inputs')],
                T.slot('description'),
                T.slot('message'),
                ],
            T.div(class_='hiddenitems')[
                T.slot('hiddenitems'),
                T.invisible(pattern=&quot;hiddenitem&quot;)[T.slot('inputs')]
                ],
            T.div(class_='actions')[
                T.slot('actions'),
                ],
            ]


The div with pattern=&quot;item&quot; is the single slot. message slot is the
error message.
The FormRenderer is the thing that fills those slot taking them from the
right place (it is the controller in an MVC view).

&gt;<i> Maybe form is doing this, but at least it doesn't sound like it is. 
</I>&gt;<i> But it does sound like it uses two-way conversion/validation, which I
</I>&gt;<i> think is also a very important feature.
</I>
Yep. Particularly I'd like to show you the interfaces involved.

class IType(Interface):
    def validate(self, value):
        pass

class IWidget(Interface):
    def render(self, ctx, key, args, errors):
        pass
   
    def processInput(self, ctx, key, args):
        pass
       
class IConvertible(Interface):
    def fromType(self, value):
        pass
    def toType(self, value):
        pass
       
class IStringConvertible(IConvertible):
    pass

# other Convertibles

-- 
Valentino Volonghi aka Dialtone
Now Running MacOSX 10.4.1
Blog: <A HREF="http://vvolonghi.blogspot.com">http://vvolonghi.blogspot.com</A>
<A HREF="http://weever.berlios.de">http://weever.berlios.de</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001604.html">[Twisted-web] Formless, custom form layout
</A></li>
	<LI>Next message: <A HREF="001529.html">[Twisted-web] Where is freeform, renderer, and formless
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1605">[ date ]</a>
              <a href="thread.html#1605">[ thread ]</a>
              <a href="subject.html#1605">[ subject ]</a>
              <a href="author.html#1605">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
