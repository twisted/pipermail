<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Livepage, ClientHandle and context [continued]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Livepage%2C%20ClientHandle%20and%20context%20%5Bcontinued%5D&In-Reply-To=9B331568-A31F-4682-A46B-223774522BBD%40divmod.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001581.html">
   <LINK REL="Next"  HREF="001590.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Livepage, ClientHandle and context [continued]</H1>
    <B>Chris Were</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Livepage%2C%20ClientHandle%20and%20context%20%5Bcontinued%5D&In-Reply-To=9B331568-A31F-4682-A46B-223774522BBD%40divmod.com"
       TITLE="[Twisted-web] Livepage, ClientHandle and context [continued]">chris at feedtagger.com
       </A><BR>
    <I>Mon Jun 27 18:23:50 MDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001581.html">[Twisted-web] Nevow 0.4.1 release tarball shitlist;
	nevow 0.4.1-1 deb in incoming
</A></li>
        <LI>Next message: <A HREF="001590.html">[Twisted-web] Livepage, ClientHandle and context [continued]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1582">[ date ]</a>
              <a href="thread.html#1582">[ thread ]</a>
              <a href="subject.html#1582">[ subject ]</a>
              <a href="author.html#1582">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;&gt;<i> I expect this can be rectified in livepage.py (line 728 on my co):
</I>&gt;&gt;<i>     def locateHandler(self, ctx, path, name):
</I>&gt;&gt;<i>         ### XXX TODO: Handle path
</I>&gt;&gt;<i>         return getattr(self, 'handle_%s' % (name, ))
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The path here is meant to be a string which names a Fragment or other 
</I>&gt;<i> dispatch path. As you can see, none of this is implemented yet, but 
</I>&gt;<i> this is my solution to this problem that you and others on this list 
</I>&gt;<i> have had. Basically the API in javascript would look something like this:
</I>&gt;<i>
</I>&gt;<i> server.handleWithPath('onclick', 'some/path', 'someArgument')
</I>&gt;<i>
</I>&gt;<i> locateHandler would change to look more like locateChild, breaking 
</I>&gt;<i> apart the path into segments and consuming them until it locates the 
</I>&gt;<i> target. I'm not sure how the default locateHandler implementation will 
</I>&gt;<i> locate action targets; perhaps with dispatch_* prefixed methods? Here 
</I>&gt;<i> is a small example:
</I>&gt;<i>
</I>&gt;<i> class MainPage(Page):
</I>&gt;<i>     docFactory = loaders.xmlstring(&quot;&quot;&quot;&lt;html 
</I>&gt;<i> xmlns:n=&quot;<A HREF="http://nevow.com/ns/nevow/0.1&quot;">http://nevow.com/ns/nevow/0.1&quot;</A>&gt;
</I>&gt;<i>   &lt;a onclick=&quot;server.handleWithPath('onclick', 'someFragment', 
</I>&gt;<i> 'someArg')&quot;&gt;
</I>&gt;<i>     Click me
</I>&gt;<i>   &lt;/a&gt;
</I>&gt;<i>   &lt;span n:render=&quot;liveid&quot; /&gt;
</I>&gt;<i>   &lt;span n:render=&quot;liveglue&quot; /&gt;
</I>&gt;<i> &lt;/html&gt;&quot;&quot;&quot;)
</I>&gt;<i>
</I>&gt;<i>     def dispatch_someFragment(self, ctx):
</I>&gt;<i>         return MyFragment()
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> class MyFragment(Fragment):
</I>&gt;<i>     def handle_onclick(self, ctx, someArg):
</I>&gt;<i>          assert someArg == 'someArg'
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Suggestions on different names other than &quot;dispatch_*&quot; are welcome; 
</I>&gt;<i> the main reason I haven't implemented this functionality yet is 
</I>&gt;<i> because I can't decide what to call it! :-)
</I>
I'd say dispatch is fine (and not just because I'd like to see this
implemented ;-)
Taking from the chatola example:
return context.tag(onsubmit=livepage.handler(onSubmit,
getValue('inputline')))

What would be good is if something similar could be used with dispatch,
perhaps the following (assuming this code is within a fragment):

return context.tag(onsubmit=livepage.handler(onSubmit,
getValue('inputline',self)))
ie: livepage.handler(func,arg,fragment=None)

if this mapped the javascript to
server.handleWithPath('action','fragment','arg') and also mapped (if not
there already) the dispatch_fragment in the MainPage

Would something along those lines be feasible?

&gt;<i> I suggest using a query parameter rather than an additional URL 
</I>&gt;<i> segment. xml is a different &quot;view&quot; of the same &quot;object&quot;; in my 
</I>&gt;<i> opinion, URLs should represent &quot;objects&quot; (Resources) and query 
</I>&gt;<i> parameters should be used to parameterize how the view renders. One 
</I>&gt;<i> might also be able to use the &quot;Accept&quot; header that browsers send to 
</I>&gt;<i> negotiate the rendered content type. But this is just a suggestion. 
</I>&gt;<i> Whatever works for you is fine with me :-)
</I>
I tend to agree that xml is a different &quot;view&quot;, but I see a benefit in a
REST-like approach to have /xml at the end of an existing Resource...
perhaps the idea that /xml is an extended view to the existing Resource.

Chris.


</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001581.html">[Twisted-web] Nevow 0.4.1 release tarball shitlist;
	nevow 0.4.1-1 deb in incoming
</A></li>
	<LI>Next message: <A HREF="001590.html">[Twisted-web] Livepage, ClientHandle and context [continued]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1582">[ date ]</a>
              <a href="thread.html#1582">[ thread ]</a>
              <a href="subject.html#1582">[ subject ]</a>
              <a href="author.html#1582">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
