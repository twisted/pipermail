<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Including templates in CGI
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Including%20templates%20in%20CGI&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001533.html">
   <LINK REL="Next"  HREF="001537.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Including templates in CGI</H1>
    <B>Cliff Wells</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Including%20templates%20in%20CGI&In-Reply-To="
       TITLE="[Twisted-web] Including templates in CGI">clifford.wells at comcast.net
       </A><BR>
    <I>Sat Jun 11 02:37:28 MDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001533.html">[Twisted-web] Using lineReceived with HTTP requests
</A></li>
        <LI>Next message: <A HREF="001537.html">[Twisted-web] Including templates in CGI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1534">[ date ]</a>
              <a href="thread.html#1534">[ thread ]</a>
              <a href="subject.html#1534">[ subject ]</a>
              <a href="author.html#1534">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I just started playing with Nevow yesterday, and I've got a question.  

I've been using PHP/Smarty for doing websites because it's pretty easy
and I've been unhappy with most of the Python web frameworks I've seen
(most of them have pretty ugly template syntax or are overcomplicated).
However, PHP is um, not so good, so I thought I'd make the leap to Nevow
which seems to satisfy my need for simplicity and not-ugliness ;)

Anyway, my typical design pattern for a site is to have an index.html
template with the main layout, and then include another template
depending on a GET/POST variable (e.g. <A HREF="http://example.com?page=home">http://example.com?page=home</A>).
In PHP/Smarty, there is an &quot;include&quot; directive that will directly inject
a second template:

&lt;body&gt;
  { include file=&quot;$page.html&quot; }
&lt;/body&gt;

I haven't found an equivalent in Nevow, but I hacked this together (note
that I am using Apache/CGI, not Twisted:

index.cgi:
----------
def template(filename):
    &quot;&quot;&quot;
    Prepend the full path to the template directory
    &quot;&quot;&quot;
    return &quot;/var/www/virtual/example.com/public_html/templates/&quot; + filename

class Index(rend.Page):
    &quot;&quot;&quot;
    Looks first at the &quot;file&quot; attribute for the fragment to include, if that isn't provided
    looks at the &quot;variable&quot; attribute for the name of the get/post variable that contains the
    name of the fragment to include.  Failing that, just use a default fragment.
    &quot;&quot;&quot;
    defaultPage = 'home'
    docFactory = loaders.xmlfile(template(&quot;index.html&quot;))

    def render_include(self, ctx, data):
        filename = ctx.tag.attributes.get('file')
        if filename is None:
            filename = ctx.arg(ctx.tag.attributes.get('variable'))
        if filename is None:
            filename = self.defaultPage
        filename = template(filename + '.html')

        if os.path.exists(filename):
            fragClass = rend.Fragment
            fragClass.docFactory = loaders.xmlfile(filename, ignoreDocType=True)
            ctx.tag.fillSlots(ctx.tag.attributes.get('slot'), fragClass())
            return ctx.tag
        else:
            return &quot;Page not found.&quot;

index.html:
-----------
&lt;div id=&quot;content&quot;&gt;
  &lt;nevow:invisible nevow:render=&quot;include&quot; variable=&quot;page&quot; slot=&quot;content&quot;&gt;
    &lt;nevow:slot name=&quot;content&quot; /&gt;
  &lt;/nevow:invisible&gt;
&lt;/div&gt;

This allows me to either specify the included file by accessing a GET/POST variable:

&lt;nevow:invisible nevow:render=&quot;include&quot; variable=&quot;page&quot; slot=&quot;content&quot;&gt;

or directly specify the template like:

&lt;nevow:invisible nevow:render=&quot;include&quot; file=&quot;home&quot; slot=&quot;content&quot;&gt;

This all seems to work just fine.  However, now I'm curious if there is a better/more direct way of achieving this.

Regards,
Cliff
-- 
Cliff Wells &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">clifford.wells at comcast.net</A>&gt;


</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001533.html">[Twisted-web] Using lineReceived with HTTP requests
</A></li>
	<LI>Next message: <A HREF="001537.html">[Twisted-web] Including templates in CGI
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1534">[ date ]</a>
              <a href="thread.html#1534">[ thread ]</a>
              <a href="subject.html#1534">[ subject ]</a>
              <a href="author.html#1534">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
