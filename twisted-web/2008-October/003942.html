<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Session class
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Session%20class&In-Reply-To=200810031301.21108.maarten%40treewalker.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003941.html">
   <LINK REL="Next"  HREF="003943.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Session class</H1>
    <B>George Pauly</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Session%20class&In-Reply-To=200810031301.21108.maarten%40treewalker.org"
       TITLE="[Twisted-web] Session class">george at ringdevelopment.com
       </A><BR>
    <I>Fri Oct  3 13:27:57 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="003941.html">[Twisted-web] Session class
</A></li>
        <LI>Next message: <A HREF="003943.html">[Twisted-web] Session class
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3942">[ date ]</a>
              <a href="thread.html#3942">[ thread ]</a>
              <a href="subject.html#3942">[ subject ]</a>
              <a href="author.html#3942">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Maarten,

There are a couple  of things I don't understand about Site._mkuid() 

IANAC (I am not a cryptographer).

Md5 collisions are rare, but (I guess) might theoretically happen
depending on length of input.  Does appending the counter to the random
output with an underscore change the statistics of collision?  

Alternatively, perhaps the counter is used as a salt?  If so, the salt
does not seem _very_ secret in this case.  If a sufficiently strong
random number is used a salt would seem unnecessary.  

I've looked at some python code for session keys (Django, something on
activestate that might be Zope code) and they hash together various
things, but not counters.

I've generated session keys by appending plain-text counters (with an
offset) to random hashes.  This guarantees uniqueness &amp; is handy because
it is human readable &amp; you can quickly see how many sessions have been
used since initiation.  Of course, the counter value might be sensitive
information in some situations.  An encrypted counter might be helpful,
if the object is to have a session key that is guaranteed random and
unique.  Or you could just check to see if the key was in use, ala
Django, and leave off the counter altogether.

One idea from this code (<A HREF="http://code.activestate.com/recipes/52252/">http://code.activestate.com/recipes/52252/</A>) :


&gt;<i> 
</I>&gt;<i> # create a unique session id
</I>&gt;<i> # input - string to use as part of the data used to create the session key.
</I>&gt;<i> #         Although not required, it is best if this includes some unique 
</I>&gt;<i> #         data from the site, such as it's IP address or other environment 
</I>&gt;<i> #         information.  For ZOPE applications, pass in the entire ZOPE &quot;REQUEST&quot;
</I>&gt;<i> #         object.
</I>&gt;<i> def makeSessionId(st):
</I>&gt;<i> 	import md5, time, base64
</I>&gt;<i> 	m = md5.new()
</I>&gt;<i> 	m.update('this is a test of the emergency broadcasting system')
</I>&gt;<i> 	m.update(str(time.time()))
</I>&gt;<i> 	m.update(str(st))
</I>&gt;<i> 	return string.replace(base64.encodestring(m.digest())[:-3], '/', '$'
</I>&gt;<i> )
</I>

is to pass in environment info to defend against hijacking.  I've used a
very similar method in a stateless (on the server, for cgi) session key
using several environment vars and a salt.  This code does not seem to
worry about uniqueness (may be OK, I'm not sure).


-George


On Fri, 2008-10-03 at 13:01 +0200, Maarten ter Huurne wrote:
-- 
George Pauly
Ring Development
www.ringdevelopment.com


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003941.html">[Twisted-web] Session class
</A></li>
	<LI>Next message: <A HREF="003943.html">[Twisted-web] Session class
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3942">[ date ]</a>
              <a href="thread.html#3942">[ thread ]</a>
              <a href="subject.html#3942">[ subject ]</a>
              <a href="author.html#3942">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
