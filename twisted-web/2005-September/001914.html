<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Why not &quot;remember&quot; the clientHandle at the start of
	rendering?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Why%20not%20%22remember%22%20the%20clientHandle%20at%20the%20start%20of%0A%09rendering%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001916.html">
   <LINK REL="Next"  HREF="001917.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Why not &quot;remember&quot; the clientHandle at the start of
	rendering?</H1>
    <B>Mike C. Fletcher</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Why%20not%20%22remember%22%20the%20clientHandle%20at%20the%20start%20of%0A%09rendering%3F&In-Reply-To="
       TITLE="[Twisted-web] Why not &quot;remember&quot; the clientHandle at the start of
	rendering?">mcfletch at rogers.com
       </A><BR>
    <I>Thu Sep 15 16:59:23 MDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001916.html">[Twisted-web] Replacement for handler in LivePage?
</A></li>
        <LI>Next message: <A HREF="001917.html">[Twisted-web] A question about sequence
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1914">[ date ]</a>
              <a href="thread.html#1914">[ thread ]</a>
              <a href="subject.html#1914">[ subject ]</a>
              <a href="author.html#1914">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>When rendering a LivePage, we have a method render_liveglue which, as a 
hidden side-effect, creates a client handle in self.clientFactory (then 
promptly forgets about it, making it difficult to reference).  Thing is, 
having that clientHandle available throughout the rendering process 
would be quite convenient, so why not create it in the renderHTTP method 
and remember it there for use by anything that's wanting access to it?

    def renderHTTP(self, ctx):
        &quot;&quot;&quot;Override to store the client-handle in the main page context&quot;&quot;&quot;
        handle = self.clientFactory.newClientHandle(
            self, self.refreshInterval,self.targetTimeoutCount
        )
        ctx.remember( handle, IClientHandle )
        return super( LivePage, self ).renderHTTP( ctx )
    def render_liveglue(self, ctx, data):
        &quot;&quot;&quot;Override to use already-created client handle (from 
renderHTTP)&quot;&quot;&quot;
        if not self.cacheable:
            handle = IClientHandle( ctx )
            handleId = &quot;'&quot;, handle.handleId, &quot;'&quot;
        else:
            handleId = 'null'
        return [
            tags.script(type=&quot;text/javascript&quot;)[
                &quot;var nevow_clientHandleId = &quot;, handleId ,&quot;;&quot;],
            tags.script(type=&quot;text/javascript&quot;,
                        src=url.here.child('nevow_glue.js'))
        ]

Noticed this as I was implementing the new handler implementation posted 
about a little while ago (it now works, incidentally, with a few bumps 
and twists).

Have fun,
Mike

-- 
________________________________________________
  Mike C. Fletcher
  Designer, VR Plumber, Coder
  <A HREF="http://www.vrplumber.com">http://www.vrplumber.com</A>
  <A HREF="http://blog.vrplumber.com">http://blog.vrplumber.com</A>


</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001916.html">[Twisted-web] Replacement for handler in LivePage?
</A></li>
	<LI>Next message: <A HREF="001917.html">[Twisted-web] A question about sequence
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1914">[ date ]</a>
              <a href="thread.html#1914">[ thread ]</a>
              <a href="subject.html#1914">[ subject ]</a>
              <a href="author.html#1914">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
