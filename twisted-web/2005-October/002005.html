<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Preventing XSS when using Nevow's vhost
	functionality
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Preventing%20XSS%20when%20using%20Nevow%27s%20vhost%0A%09functionality&In-Reply-To=8F59F465-0CF4-4703-BACA-888CB3388252%40remahl.se">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002003.html">
   <LINK REL="Next"  HREF="002008.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Preventing XSS when using Nevow's vhost
	functionality</H1>
    <B>David Reid</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Preventing%20XSS%20when%20using%20Nevow%27s%20vhost%0A%09functionality&In-Reply-To=8F59F465-0CF4-4703-BACA-888CB3388252%40remahl.se"
       TITLE="[Twisted-web] Preventing XSS when using Nevow's vhost
	functionality">dreid at dreid.org
       </A><BR>
    <I>Wed Oct 19 17:52:28 MDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002003.html">[Twisted-web] Preventing XSS when using Nevow's vhost
	functionality
</A></li>
        <LI>Next message: <A HREF="002008.html">[Twisted-web] Preventing XSS when using Nevow's vhost
	functionality
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2005">[ date ]</a>
              <a href="thread.html#2005">[ thread ]</a>
              <a href="subject.html#2005">[ subject ]</a>
              <a href="author.html#2005">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Oct 19, 2005, at 4:39 PM, David Remahl wrote:
&gt;<i> I'm not familiar with web2.vhost.VHostURIRewrite, but will check it  
</I>&gt;<i> out...&quot;Configuration time&quot;, you say. I assume that means at the  
</I>&gt;<i> start of the handling of a request, not when the application is set  
</I>&gt;<i> up and configured? If so, that sounds like a good solution in many  
</I>&gt;<i> cases.
</I>
In fact configuration time does mean in the .tac.  You create a  
vhost.VHostURIRewrite resource like so:

    root = vhost.VHostURIRewrite(uri='<A HREF="http://host:port/path',">http://host:port/path',</A>  
resource=realrootresource)
    server.Site(root)

There is also a AutoVHostURIRewrite which makes use of x-app-scheme,  
x-forwarded-host, x-app-location, and x-forwarded-for headers to  
determine the real hostname port path etc and also the client ip  
address.  I'm fairly sure this isn't vulnerable to a similar attack  
as VHostMonsterResource but I haven't done an extensive audit of that  
particular code.

&gt;<i> Only allowing a single &quot;invocation&quot; of the monster resource is  
</I>&gt;<i> insufficient in certain situations, namely when http:// 
</I>&gt;<i> internalserver:1234/ is accessible from the outside and not  
</I>&gt;<i> _exclusively_ by the reverse proxy. This might also be a problem  
</I>&gt;<i> with the VHostURIRewrite approach?
</I>
It would be a problem with AutoVHostURIRewrite but not a problem with  
VHostURIRewrite, because VHostURIRewrite would mangle the request  
unconditionally and if the client clicked an absolute link would end  
up at the proper location anyway.   This unconditional mangling might  
have other implications if internalserver:1234 is accessible from  
outside but in my opinion that's just more of a reason to not have  
that kind of configuration.

-David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20051019/c5e60e62/attachment.htm">http://twistedmatrix.com/pipermail/twisted-web/attachments/20051019/c5e60e62/attachment.htm</A>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002003.html">[Twisted-web] Preventing XSS when using Nevow's vhost
	functionality
</A></li>
	<LI>Next message: <A HREF="002008.html">[Twisted-web] Preventing XSS when using Nevow's vhost
	functionality
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2005">[ date ]</a>
              <a href="thread.html#2005">[ thread ]</a>
              <a href="subject.html#2005">[ subject ]</a>
              <a href="author.html#2005">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
