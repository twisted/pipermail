<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] my first post,
	writing a Web interface to a PostgreSQL db
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20my%20first%20post%2C%0A%09writing%20a%20Web%20interface%20to%20a%20PostgreSQL%20db&In-Reply-To=4edc17eb0510140334m357d878dr7686c7ed383efa78%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001978.html">
   <LINK REL="Next"  HREF="001981.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] my first post,
	writing a Web interface to a PostgreSQL db</H1>
    <B>Valentino Volonghi aka Dialtone</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20my%20first%20post%2C%0A%09writing%20a%20Web%20interface%20to%20a%20PostgreSQL%20db&In-Reply-To=4edc17eb0510140334m357d878dr7686c7ed383efa78%40mail.gmail.com"
       TITLE="[Twisted-web] my first post,
	writing a Web interface to a PostgreSQL db">dialtone at divmod.com
       </A><BR>
    <I>Fri Oct 14 06:51:32 MDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001978.html">[Twisted-web] my first post,
	writing a Web interface to a PostgreSQL db
</A></li>
        <LI>Next message: <A HREF="001981.html">[Twisted-web] my first post,
	writing a Web interface to a PostgreSQL db
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1979">[ date ]</a>
              <a href="thread.html#1979">[ thread ]</a>
              <a href="subject.html#1979">[ subject ]</a>
              <a href="author.html#1979">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Oct 14, 2005 at 10:34:36AM +0000, Michele Simionato wrote:

Hi Michele :),

&gt;<i> I need to write a Web interface to a PostgreSQL database and I am
</I>&gt;<i> considering to use Twisted for that. So, I have a few questions.
</I>
Let's see if I can answer all of them.

&gt;<i> First of all, I would like to know if there already something available
</I>&gt;<i> that I should look at. Second, I have a more specific question.
</I>
Depends on what 'Something' means in your view.
There are 2 projects that I know of that work with twisted and databases (or
postgresql) that are worth a try.

The first one is called Tada (Twisted Async Database API):
<A HREF="http://www.darkarts.co.za/projects/tada/">http://www.darkarts.co.za/projects/tada/</A>

which is a new version of adbapi that instead of incredibly ignoring DB-API2
it makes it so that each DB-API2 method call returns a deferred. It also has
an SQLObject-like way of dealing with the database that may be useful.

Another effort is pgasync:
<A HREF="svn://svn.jamwt.com/pgasync/trunk">svn://svn.jamwt.com/pgasync/trunk</A>

pgasync is a pure python database module that uses Twisted to implement the
PostgreSQL protocol. It tries to be DB-API2 compliant although failing in some
cases (not hard to fix but requires a bit of time that you may not have). Like
Tada it returns deferreds from DB-API2 method calls, but manages to do some
magic that avoids returning a deferred in some places.

The last one is the standard abapi module that while maybe not beautiful it is
indeed very simple and well tested in real life.

&gt;<i> Suppose I have a large table with 1,000,000 records and a SELECT query
</I>&gt;<i> that returns 1000 results and takes 10 minutes.
</I>&gt;<i> 
</I>&gt;<i> I don't want my users to wait. I want to display the result of the
</I>&gt;<i> query as an HTML table of 50 rows. The user should click, wait
</I>&gt;<i> 30 seconds, see the result, then click a 'next' button to see
</I>&gt;<i> the other 50 results, etc. In other words, I am looking for a lazy query
</I>&gt;<i> functionality.
</I>
Lazy query functionality requires you to store the cursor that run the query
somewhere (togheter with the connection from which it was created) so that you
can use fetchmany() on it. There is no other way that comes to my mind.
I haven't experimented with this kind of jobs with any of the above, but I can
guess that adbapi is not the right tool for the object, whereas pgasync or
tada might be the right starting point (although they might reveal to be the
wrong approach too).

&gt;<i> Is that already available? If not, is it easy/difficult to implement?
</I>
It shouldn't be hard to implement as long as you don't need to migrate the
cursor and the connection to some other machine.

The idea that comes to mind is that you can store the connection with the
cursor in the session (or something like that, maybe the session is not the
right place but depends on the framework you are using) and reuse them for
each user. Of course if you are in a load balanced environment then you need
to be able to 'migrate' those connection from one computer to another one
(unless you are using stateful load balancers) which is extremely hard.

Another solution could be to take advantage of OFFSET and LIMIT keywords in
SQL to avoid calculating the whole 1000 results but only limiting the
resultset to the strictly necessary thus lowering response times.

Hope I've been helpful :)

-- 
Valentino Volonghi aka Dialtone
Now Running MacOSX 10.4
Blog: <A HREF="http://vvolonghi.blogspot.com">http://vvolonghi.blogspot.com</A>
<A HREF="http://weever.berlios.de">http://weever.berlios.de</A>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 186 bytes
Desc: not available
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20051014/904fdb0c/attachment.bin">http://twistedmatrix.com/pipermail/twisted-web/attachments/20051014/904fdb0c/attachment.bin</A>
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001978.html">[Twisted-web] my first post,
	writing a Web interface to a PostgreSQL db
</A></li>
	<LI>Next message: <A HREF="001981.html">[Twisted-web] my first post,
	writing a Web interface to a PostgreSQL db
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1979">[ date ]</a>
              <a href="thread.html#1979">[ thread ]</a>
              <a href="subject.html#1979">[ subject ]</a>
              <a href="author.html#1979">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
