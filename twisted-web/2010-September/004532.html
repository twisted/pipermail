<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Possible bug in nevow.testutil.FakeRequest setHeaders	and getHeaders
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Possible%20bug%20in%20nevow.testutil.FakeRequest%20setHeaders%0A%09and%20getHeaders&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004531.html">
   <LINK REL="Next"  HREF="004533.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Possible bug in nevow.testutil.FakeRequest setHeaders	and getHeaders</H1>
    <B>Peter Westlake</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Possible%20bug%20in%20nevow.testutil.FakeRequest%20setHeaders%0A%09and%20getHeaders&In-Reply-To="
       TITLE="[Twisted-web] Possible bug in nevow.testutil.FakeRequest setHeaders	and getHeaders">peter.westlake at pobox.com
       </A><BR>
    <I>Tue Sep 28 13:23:51 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="004531.html">[Twisted-web] About handling thousands of sockets connections	simultaneously
</A></li>
        <LI>Next message: <A HREF="004533.html">[Twisted-web] Possible bug in	nevow.testutil.FakeRequest	setHeaders and getHeaders
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4532">[ date ]</a>
              <a href="thread.html#4532">[ thread ]</a>
              <a href="subject.html#4532">[ subject ]</a>
              <a href="author.html#4532">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Recently my nevow web server's unit tests started to fail, because the
tests used request.getHeader() to check that request.setHeader() had
been called correctly. This used to work.

I can see from testutil.py that setHeaders sets self.headers, but
getHeaders gets a value from received_headers, and there is a test in
test_testutil.py to make sure it does. So is this really how it is meant
to work? Is setHeader really meant to set something that getHeader can't
get? If so, what's the correct method for testing the result of
setHeader?

To reproduce the problem, run this with &quot;trial&quot;:

from nevow.testutil import FakeRequest, TestCase

class TestHeaders(TestCase):
    def setUp(self):
        self.request = FakeRequest()

    def test_set(self):
        self.request.setHeader('location', 'somewhere')
        self.failUnlessEqual(self.request.getHeader('location'),
        'somewhere')

Peter.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004531.html">[Twisted-web] About handling thousands of sockets connections	simultaneously
</A></li>
	<LI>Next message: <A HREF="004533.html">[Twisted-web] Possible bug in	nevow.testutil.FakeRequest	setHeaders and getHeaders
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4532">[ date ]</a>
              <a href="thread.html#4532">[ thread ]</a>
              <a href="subject.html#4532">[ subject ]</a>
              <a href="author.html#4532">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
