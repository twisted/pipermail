<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Double tracebacks for t.web &amp; klein
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-web%5D%20Double%20tracebacks%20for%20t.web%20%26%20klein&In-Reply-To=%3C523738A7.1040808%40imperial.ac.uk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="005083.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Double tracebacks for t.web &amp; klein</H1>
    <B>Phil Mayers</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-web%5D%20Double%20tracebacks%20for%20t.web%20%26%20klein&In-Reply-To=%3C523738A7.1040808%40imperial.ac.uk%3E"
       TITLE="[Twisted-web] Double tracebacks for t.web &amp; klein">p.mayers at imperial.ac.uk
       </A><BR>
    <I>Mon Sep 16 10:58:15 MDT 2013</I>
    <P><UL>
        
        <LI>Next message: <A HREF="005083.html">[Twisted-web] Double tracebacks for t.web &amp; klein
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5082">[ date ]</a>
              <a href="thread.html#5082">[ thread ]</a>
              <a href="subject.html#5082">[ subject ]</a>
              <a href="author.html#5082">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm playing with klein for a simple rest API (because I like the 
routing, mainly).

When a method raises an exception, a traceback gets logged twice - once 
by the t.web Request.processingFailed, called from here:

<A HREF="https://github.com/twisted/klein/blob/master/klein/resource.py#L125">https://github.com/twisted/klein/blob/master/klein/resource.py#L125</A>

...and once by the deferred garbage collection, as 
Request.processingFailed doesn't eat the deferred:

<A HREF="http://twistedmatrix.com/trac/browser/tags/releases/twisted-13.1.0/twisted/web/server.py#L314">http://twistedmatrix.com/trac/browser/tags/releases/twisted-13.1.0/twisted/web/server.py#L314</A>

Obviously this double-traceback thing is hugely irritating. Who is at 
fault here? Is t.web doing the right thing by returning the failure from 
processingFailed, or is klein doing the wrong thing, either by using the 
(undocumented) processingFailed or omitting an errback further down the 
chain?

Obviously there's no way for *me* to add an errback - klein generates 
the deferred for me.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="005083.html">[Twisted-web] Double tracebacks for t.web &amp; klein
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5082">[ date ]</a>
              <a href="thread.html#5082">[ thread ]</a>
              <a href="subject.html#5082">[ subject ]</a>
              <a href="author.html#5082">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
