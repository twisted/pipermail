<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Credential questions - hide user name
	andpasswordon	login + get ip address in realm
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Credential%20questions%20-%20hide%20user%20name%0A%09andpasswordon%09login%20%2B%20get%20ip%20address%20in%20realm&In-Reply-To=E1CU5bI-0003LG-00%40pyramid.twistedmatrix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000854.html">
   <LINK REL="Next"  HREF="000834.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Credential questions - hide user name
	andpasswordon	login + get ip address in realm</H1>
    <B>Donovan Preston</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Credential%20questions%20-%20hide%20user%20name%0A%09andpasswordon%09login%20%2B%20get%20ip%20address%20in%20realm&In-Reply-To=E1CU5bI-0003LG-00%40pyramid.twistedmatrix.com"
       TITLE="[Twisted-web] Credential questions - hide user name
	andpasswordon	login + get ip address in realm">dp at divmod.org
       </A><BR>
    <I>Tue Nov 16 09:55:18 MST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000854.html">[Twisted-web] Credential questions - hide user name
	andpasswordon	login + get ip address in realm
</A></li>
        <LI>Next message: <A HREF="000834.html">[Twisted-web] getting response headers from client.getPage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#855">[ date ]</a>
              <a href="thread.html#855">[ thread ]</a>
              <a href="subject.html#855">[ subject ]</a>
              <a href="author.html#855">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Nov 16, 2004, at 7:50 AM, Alexander May wrote:

&gt;<i> Also, while on I'm on the subject of guard, is there a way to set the 
</I>&gt;<i> url a
</I>&gt;<i> user reaches after log in?  For example if the log in form is at
</I>&gt;<i> http:/foo.com/, I would like the admin log in to end up at
</I>&gt;<i> http:/foo.com/Admin/, and the non admin log in to end up at
</I>&gt;<i> http:/foo.com/Home/.  Currently, both just end up at the root url.  
</I>&gt;<i> Should
</I>&gt;<i> the respective resources returned in Realm:requestAvatar just do a 
</I>&gt;<i> redirect,
</I>&gt;<i> or is some simple way to rewrite the url?  I tried muddling with the 
</I>&gt;<i> various
</I>&gt;<i> path members of the request in locateChild with no success.
</I>
The path segments which appear after the __login__ segment in the login 
form you generate will be used as the target of the redirect after 
login. Unfortunately this doesn't solve your problem, because you want 
to redirect based on the type of login. Perhaps the resource you return 
as / can immediately do a redirect to the appropriate URL? For example:

class Redirector:
     __implements__ = inevow.IResource,

     def __init__(self, avatar):
         self.avatar = avatar

     def calculateAppropriateRedirectURL(self):
         if self.avatar.admin: return '/Admin/'
         return '/Home/'

     def locateChild(self, ctx, segments):
         return self, ()

     def renderHTTP(self, ctx):
         
inevow.IRequest(ctx).redirect(self.calculateAppropriateRedirectURL())

Perhaps also this redirect would only happen once, and set some state 
on self indicating it happened, and then do a normal page render if the 
user visited / after the first time.

dp


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000854.html">[Twisted-web] Credential questions - hide user name
	andpasswordon	login + get ip address in realm
</A></li>
	<LI>Next message: <A HREF="000834.html">[Twisted-web] getting response headers from client.getPage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#855">[ date ]</a>
              <a href="thread.html#855">[ thread ]</a>
              <a href="subject.html#855">[ subject ]</a>
              <a href="author.html#855">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
