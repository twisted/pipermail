<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Proxy Could not accept new connection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Proxy%20Could%20not%20accept%20new%20connection&In-Reply-To=5acf0ea80908101403h6dfa0b06x56745772585834dc%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004308.html">
   <LINK REL="Next"  HREF="004310.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Proxy Could not accept new connection</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Proxy%20Could%20not%20accept%20new%20connection&In-Reply-To=5acf0ea80908101403h6dfa0b06x56745772585834dc%40mail.gmail.com"
       TITLE="[Twisted-web] Proxy Could not accept new connection">glyph at twistedmatrix.com
       </A><BR>
    <I>Mon Aug 10 20:01:52 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="004308.html">[Twisted-web] Proxy Could not accept new connection
</A></li>
        <LI>Next message: <A HREF="004310.html">[Twisted-web] Invitation to connect on LinkedIn
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4309">[ date ]</a>
              <a href="thread.html#4309">[ thread ]</a>
              <a href="subject.html#4309">[ subject ]</a>
              <a href="author.html#4309">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Aug 10, 2009 at 5:03 PM, dave fowler &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">davefowler at gmail.com</A>&gt; wrote:

&gt;<i> Glyph, thanks for the great feedback.  I'm looking into all of this now.
</I>&gt;<i> I don't think it's a ulimit issue as it seems to be &quot;unlimited&quot;
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">root at Proxy1</A>:~# ulimit
</I>&gt;<i> unlimited
</I>&gt;<i>
</I>
This is a lie that your shell tells you.  Here it is on my computer:

<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">glyph at nhuvasarim</A>:~$ ulimit
unlimited
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">glyph at nhuvasarim</A>:~$ ulimit -a
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 16135
max locked memory       (kbytes, -l) 32
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) 16135
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited

as you can see, many of those values (specifically, in your case, &quot;open
files&quot;) do actually have limits.

&gt;<i>
</I>&gt;<i> I think my first step will be to just make a log observer that will simply
</I>&gt;<i> restart the proxy script when it sees (EMFILE) so that I don't have to keep
</I>&gt;<i> logging in at night to restart it myself :).
</I>&gt;<i>
</I>
That does sound like a practical measure to take :).


&gt;<i> Thanks for filing that ticket.  It would be great if there were a way to be
</I>&gt;<i> notified of the particular error inside the code.
</I>&gt;<i>
</I>
No problem; I thought it was already filed.


&gt;<i> I like your suggestion of keeping a list of my open connections.  I could
</I>&gt;<i> also keep a time stamp with them and close down the oldest, or any that are
</I>&gt;<i> over a certain time period.
</I>&gt;<i>
</I>
That's what I was thinking; or, maybe something more elaborate, like
associating connections with accounts, and kicking off the most active
connection associated with a non-administrator account, or the one which has
been idle the longest... it depends on your application and desired security
model.


&gt;<i> I'm new to twisted.  Do you know in what object of the Proxy the new
</I>&gt;<i> connections are made and how to access them to store in a list?
</I>&gt;<i>
</I>
The protocol factory is where you'd want to do this.  This FAQ deals with
the main question, I think:

&lt;
<A HREF="http://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#HowdoImakeinputononeconnectionresultinoutputonanother">http://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#HowdoImakeinputononeconnectionresultinoutputonanother</A>
&gt;<i>
</I>
Thanks again!
&gt;<i>
</I>
No problem!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20090810/792f4fc9/attachment.htm">http://twistedmatrix.com/pipermail/twisted-web/attachments/20090810/792f4fc9/attachment.htm</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004308.html">[Twisted-web] Proxy Could not accept new connection
</A></li>
	<LI>Next message: <A HREF="004310.html">[Twisted-web] Invitation to connect on LinkedIn
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4309">[ date ]</a>
              <a href="thread.html#4309">[ thread ]</a>
              <a href="subject.html#4309">[ subject ]</a>
              <a href="author.html#4309">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
