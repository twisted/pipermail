<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Is there a good way to mount both an HTTP Site and a WebSocket Server on port 80?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Is%20there%20a%20good%20way%20to%20mount%20both%20an%20HTTP%20Site%20and%20a%0A%20WebSocket%20Server%20on%20port%2080%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="004915.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Is there a good way to mount both an HTTP Site and a WebSocket Server on port 80?</H1>
    <B>Tom Sheffler</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Is%20there%20a%20good%20way%20to%20mount%20both%20an%20HTTP%20Site%20and%20a%0A%20WebSocket%20Server%20on%20port%2080%3F&In-Reply-To="
       TITLE="[Twisted-web] Is there a good way to mount both an HTTP Site and a WebSocket Server on port 80?">tom.sheffler at gmail.com
       </A><BR>
    <I>Thu Apr  5 09:55:02 EDT 2012</I>
    <P><UL>
        
        <LI>Next message: <A HREF="004915.html">[Twisted-web] Is there a good way to mount both an HTTP Site and a WebSocket Server on port 80?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4914">[ date ]</a>
              <a href="thread.html#4914">[ thread ]</a>
              <a href="subject.html#4914">[ subject ]</a>
              <a href="author.html#4914">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I was wondering about ways to mount different types of protocol handlers on
the same port.  It looks like there will be new WebSocket support
implementing a websocket Site.  We'll also have the existing HTTP Site.
 Will they both be able to live on port 80?  Is it important to be able to
do this?

In my own experiments, I've modified &quot;portforward.py&quot; to inspect an
incoming request and dispatch to one of two different servers mounted on
Unix-Domain sockets,  depending on the request path in the header.  It
looks something like the code below.  This does a lot of copying of each
data packet, but seems to be effective.

Does anyone have a better suggestion for how to mount different protocol
handlers on the same port?

Thanks.  -T

   ========
   site1 = twisted.web.server.Site(...)
   site2 = txws.WebSocketFactory(...)

   reactor.listenUNIX(&quot;site1.sck&quot;, site1)
   reactor.listenUNIX(&quot;site2.sck&quot;, site2)

   # this routes requests on port 80 to one of the two sockets
   reactor.listenTCP(80, InspectingProxyFactory(&quot;site1.sck&quot;, &quot;site2.sck&quot;)
   =======
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20120405/2d5217d2/attachment.htm">http://twistedmatrix.com/pipermail/twisted-web/attachments/20120405/2d5217d2/attachment.htm</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="004915.html">[Twisted-web] Is there a good way to mount both an HTTP Site and a WebSocket Server on port 80?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4914">[ date ]</a>
              <a href="thread.html#4914">[ thread ]</a>
              <a href="subject.html#4914">[ subject ]</a>
              <a href="author.html#4914">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
