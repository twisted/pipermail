<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] [Nevow] json serializer and strings
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5BNevow%5D%20json%20serializer%20and%20strings&In-Reply-To=c16a94ff0609091447v5eea0333lbab61d7bfd56d50e%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002995.html">
   <LINK REL="Next"  HREF="002997.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] [Nevow] json serializer and strings</H1>
    <B>Manlio Perillo</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5BNevow%5D%20json%20serializer%20and%20strings&In-Reply-To=c16a94ff0609091447v5eea0333lbab61d7bfd56d50e%40mail.gmail.com"
       TITLE="[Twisted-web] [Nevow] json serializer and strings">manlio_perillo at libero.it
       </A><BR>
    <I>Sun Sep 10 04:04:03 CDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002995.html">[Twisted-web] [Nevow] json serializer and strings
</A></li>
        <LI>Next message: <A HREF="002997.html">[Twisted-web] Web2: What is to be Done
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2996">[ date ]</a>
              <a href="thread.html#2996">[ thread ]</a>
              <a href="subject.html#2996">[ subject ]</a>
              <a href="author.html#2996">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Cory Dodt ha scritto:
&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On 9/9/06, *Manlio Perillo* &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">manlio_perillo at libero.it</A>
</I>&gt;<i> &lt;mailto:<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">manlio_perillo at libero.it</A>&gt;&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>     &gt;&gt; There are some problems with this:
</I>&gt;<i>     &gt;&gt;
</I>&gt;<i>     &gt;&gt;    elif isinstance(obj, str):
</I>&gt;<i>     &gt;&gt;        w('&quot;')
</I>&gt;<i>     &gt;&gt;        w(stringEncode(obj.decode(&quot;us-ascii&quot;))
</I>&gt;<i>     &gt;&gt;        w('&quot;')
</I>&gt;<i>     &gt;&gt; ?
</I>&gt;<i>     &gt;
</I>&gt;<i>     &gt; Yes.  What if it is not an ASCII string?
</I>&gt;<i> 
</I>&gt;<i>     Raise an arror?
</I>&gt;<i>     Is this really a problem?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Yes.  Yes it is.  Javascript strings are unicode.  Therefore the
</I>&gt;<i> implementation must be able to convert the encoded string (byte
</I>&gt;<i> representation) into Unicode when it arrives.
</I>&gt;<i> 
</I>&gt;<i> In order to convert the parameter to unicode, the API has to know what
</I>&gt;<i> encoding the original string was; or it must have it in Unicode form
</I>&gt;<i> already.  If the API accepts 8-bit str objects, then it must guess at
</I>&gt;<i> the encoding to produce a unicode object.  It will guess wrong very
</I>&gt;<i> often, which leads to bugs.  Therefore, it does not accept 8-bit str
</I>&gt;<i> objects.
</I>&gt;<i> 
</I>
I don't agree, but that's not a problem; I just can decode the keywords
dictionary by myself (or use another library).

However you say:
&quot;it does not accept 8-bit str objects&quot;.

Well, all I can say is that by doing obj.decode(&quot;us-ascii&quot;) we are
accepting 7-bit str objects!

If you like:

try:
  obj.decode(&quot;us-ascii&quot;)
except UnicodeDecodeError:
  raise ValueError(&quot;8-bit strings not supported&quot;)


This implementation is just a little more friendly since str objects are
the default in CPython:

 &gt;&gt;&gt; def foo(**kwargs):
 &gt;&gt;&gt;  print type(kwargs.keys()[0])

 &gt;&gt;&gt; foo(a=1)
 &lt;type 'str'&gt;



Regards  Manlio Perillo

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002995.html">[Twisted-web] [Nevow] json serializer and strings
</A></li>
	<LI>Next message: <A HREF="002997.html">[Twisted-web] Web2: What is to be Done
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2996">[ date ]</a>
              <a href="thread.html#2996">[ thread ]</a>
              <a href="subject.html#2996">[ subject ]</a>
              <a href="author.html#2996">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
