<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Re: Nevow and template like files
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Re%3A%20Nevow%20and%20template%20like%20files&In-Reply-To=87hczmaydj.fsf%40aka.i.naked.iki.fi">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002980.html">
   <LINK REL="Next"  HREF="002982.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Re: Nevow and template like files</H1>
    <B>Valentino Volonghi aka Dialtone</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Re%3A%20Nevow%20and%20template%20like%20files&In-Reply-To=87hczmaydj.fsf%40aka.i.naked.iki.fi"
       TITLE="[Twisted-web] Re: Nevow and template like files">dialtone at divmod.com
       </A><BR>
    <I>Tue Sep  5 19:41:22 CDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002980.html">[Twisted-web] Re: Nevow and template like files
</A></li>
        <LI>Next message: <A HREF="002982.html">[Twisted-web] Re: Nevow and template like files
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2981">[ date ]</a>
              <a href="thread.html#2981">[ thread ]</a>
              <a href="subject.html#2981">[ subject ]</a>
              <a href="author.html#2981">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 05 Sep 2006 22:48:08 +0300, Nuutti Kotivuori &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">naked at iki.fi</A>&gt; wrote:
&gt;<i>Thanks! I've looked already at that and it seems nice... except for
</I>&gt;<i>two points.
</I>&gt;<i>
</I>&gt;<i>First of all, the content is looked up like this:
</I>&gt;<i>
</I>&gt;<i>,----
</I>&gt;|<i> def macro_content(self, ctx):
</I>&gt;|<i>     return loaders.xmlfile(self.template+'.html', ignoreDocType=True,
</I>&gt;|<i>                            templateDir=conf.TEMPLATE_PATH)
</I>&gt;<i>`----
</I>&gt;<i>
</I>&gt;<i>Since I have several patterns in a single file, I would need to append
</I>&gt;<i>pattern='content' keyword into that. But if I do that, then the file
</I>
I disagree. If you use a template as a pattern container than load it completely and use inevow.IQ() to get patterns from it. Patterns are not rendered anyway so just style the real content of the template and grab patterns togheter with it. Later on you'll be able to merge the patterns inside the rendering result.

&gt;<i>will get read once by every macro that uses a pattern from it? That
</I>
Once by every macro yes, but only once per macro, not once per request per macro. It's a very light cost.

&gt;<i>I'd like to avoid - I'd like to keep the loaders in a class
</I>&gt;<i>variable nicely, or a Fragment, or something.
</I>&gt;<i>Also, if I say pattern='content', then that loader will throw a hissy
</I>&gt;<i>fit if the pattern isn't present. So I'd need a loader that would
</I>&gt;<i>return some default value when the .load() method is called and that
</I>&gt;<i>sounds like an icky solution again. No worries though, it's easy to
</I>&gt;<i>hack.
</I>
You should not hack it. Nope, what if the default value is not there too?
Use a Fragment (or rather an Element instead). Besides that I don't really think that templates containing many patterns are a good way to deal with the problem, many templates each with a Fragment associated is a much better way to solve it.

&gt;<i>So, any ideas how I could have just one loader that would load the
</I>&gt;<i>file once, and then just use normal nevow machinery to fetch the
</I>&gt;<i>patterns from it (where it is easier to get a default value if the
</I>&gt;<i>pattern does not exist)?
</I>
I told you:

loaded = loaders.xmlfile('file')
some_pattern = inevow.IQ(loaded).onePattern('whatever')

&gt;<i>Actually, I have a bit of a problem there - how do I get the whole
</I>&gt;<i>document loaded in the methods I have? I can call
</I>&gt;<i>self.docFactory.load() in every method ofcourse, but then the context
</I>&gt;<i>is a bit screwy - however, I hesitate to pass in the context that is
</I>&gt;<i>available at the time of the first call, since that might come from a
</I>&gt;<i>different page each time and I'm not sure if the render/macro methods
</I>&gt;<i>are going to be invoked from the correct object and such.
</I>
Don't pass the context, what's the problem here?

&gt;<i>I thought that the rendered/parsed version of the template resided in
</I>&gt;<i>the loaders.xmlfile instance that is created - and if I return a new
</I>&gt;<i>loaders.xmlfile instance (with a different pattern clause) from
</I>&gt;<i>several different macros, then the page would get loaded as many
</I>&gt;<i>times. Or if I returned a loaders.xmlfile instance from a render
</I>
No because the macro is not reloaded. Just try to modify a file that was compiled in macro. You'll see that unless you modify the file containing the macro nothing changes.

&gt;<i>method, then the file would be parsed on each rendition of the page -
</I>&gt;<i>am I wrong?
</I>
Yes a bit.

&gt;<i>Patterns are optional yes, but if I call
</I>&gt;<i>
</I>&gt;<i>  loaders.xmlfile(filename, pattern='foobar')
</I>&gt;<i>
</I>&gt;<i>that will throw an exception if pattern 'foobar' is not present in the
</I>
Of course... You are telling it to search exactly for a particular pattern.

&gt;<i>file. So will onePattern(), but that is easily wrapped in a try/catch
</I>&gt;<i>block (or I can use patternGenerator which does take a default
</I>&gt;<i>argument in some cases) - where as a loader being wrapped doesn't do
</I>&gt;<i>anything since the actual loading happens later (when the load()
</I>&gt;<i>method is called).
</I>
correct.

It's not very clear what's your problem though. Maybe you should either show some code or try to solve it in the way you explained which seemed reasonable anyway.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002980.html">[Twisted-web] Re: Nevow and template like files
</A></li>
	<LI>Next message: <A HREF="002982.html">[Twisted-web] Re: Nevow and template like files
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2981">[ date ]</a>
              <a href="thread.html#2981">[ thread ]</a>
              <a href="subject.html#2981">[ subject ]</a>
              <a href="author.html#2981">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
