<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] [Nevow] json serializer and strings
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5BNevow%5D%20json%20serializer%20and%20strings&In-Reply-To=450326D5.8010903%40libero.it">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002994.html">
   <LINK REL="Next"  HREF="002996.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] [Nevow] json serializer and strings</H1>
    <B>Cory Dodt</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5BNevow%5D%20json%20serializer%20and%20strings&In-Reply-To=450326D5.8010903%40libero.it"
       TITLE="[Twisted-web] [Nevow] json serializer and strings">corydodt at gmail.com
       </A><BR>
    <I>Sat Sep  9 16:47:48 CDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002994.html">[Twisted-web] [Nevow] json serializer and strings
</A></li>
        <LI>Next message: <A HREF="002996.html">[Twisted-web] [Nevow] json serializer and strings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2995">[ date ]</a>
              <a href="thread.html#2995">[ thread ]</a>
              <a href="subject.html#2995">[ subject ]</a>
              <a href="author.html#2995">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/9/06, Manlio Perillo &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">manlio_perillo at libero.it</A>&gt; wrote:
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt;&gt; There are some problems with this:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;    elif isinstance(obj, str):
</I>&gt;<i> &gt;&gt;        w('&quot;')
</I>&gt;<i> &gt;&gt;        w(stringEncode(obj.decode(&quot;us-ascii&quot;))
</I>&gt;<i> &gt;&gt;        w('&quot;')
</I>&gt;<i> &gt;&gt; ?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Yes.  What if it is not an ASCII string?
</I>&gt;<i>
</I>&gt;<i> Raise an arror?
</I>&gt;<i> Is this really a problem?
</I>


Yes.  Yes it is.  Javascript strings are unicode.  Therefore the
implementation must be able to convert the encoded string (byte
representation) into Unicode when it arrives.

In order to convert the parameter to unicode, the API has to know what
encoding the original string was; or it must have it in Unicode form
already.  If the API accepts 8-bit str objects, then it must guess at the
encoding to produce a unicode object.  It will guess wrong very often, which
leads to bugs.  Therefore, it does not accept 8-bit str objects.

You must provide Unicode objects to the API so that it does not have to
guess.  The errors you get are essentially the API telling you &quot;I refuse to
guess.&quot;  It forces the programmer to tell the API what encoding the original
string had; the way you answer it is by decoding it yourself with the right
encoding argument into a Unicode object.

<A HREF="http://gedcom-parse.sourceforge.net/doc/encoding.html">http://gedcom-parse.sourceforge.net/doc/encoding.html</A>


C
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20060909/6af8ad24/attachment.htm">http://twistedmatrix.com/pipermail/twisted-web/attachments/20060909/6af8ad24/attachment.htm</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002994.html">[Twisted-web] [Nevow] json serializer and strings
</A></li>
	<LI>Next message: <A HREF="002996.html">[Twisted-web] [Nevow] json serializer and strings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2995">[ date ]</a>
              <a href="thread.html#2995">[ thread ]</a>
              <a href="subject.html#2995">[ subject ]</a>
              <a href="author.html#2995">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
