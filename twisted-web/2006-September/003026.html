<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] fragments with child lookup
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20fragments%20with%20child%20lookup&In-Reply-To=20060922142046.1717.1954789151.divmod.quotient.56787%40ohm">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003025.html">
   <LINK REL="Next"  HREF="003027.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] fragments with child lookup</H1>
    <B>Markus Schiltknecht</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20fragments%20with%20child%20lookup&In-Reply-To=20060922142046.1717.1954789151.divmod.quotient.56787%40ohm"
       TITLE="[Twisted-web] fragments with child lookup">markus at bluegap.ch
       </A><BR>
    <I>Sat Sep 23 07:52:25 CDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="003025.html">[Twisted-web] fragments with child lookup
</A></li>
        <LI>Next message: <A HREF="003027.html">[Twisted-web] fragments with child lookup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3026">[ date ]</a>
              <a href="thread.html#3026">[ thread ]</a>
              <a href="subject.html#3026">[ subject ]</a>
              <a href="author.html#3026">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi again,

I've now had a look at your source code:

Valentino Volonghi aka Dialtone wrote:
&gt;<i> <A HREF="http://hg.stiq.it/stiq">http://hg.stiq.it/stiq</A> for some more code.
</I>
I've learned about nevow macros. I don't quite understand what the big 
difference to a renderer is, but that's another story...

I'm still trying to get my 'component' based thinking migrated to nevow. 
As an exercise, I thought I'd try to use the nevow example pastebin as a 
component. What I want to achieve is having the pastebin available under 
<A HREF="http://localhost:8080/pastebin/,">http://localhost:8080/pastebin/,</A> wrapped within my own template.
<A HREF="http://localhost:8080/">http://localhost:8080/</A>  should simply show a welcome page, within the 
same template.

For this experiment, I've simply stuffed a SuperiorRootPage class into 
pastebin.tac. The simplistic template is included as stan. The pastebin 
should be rendered inside that (so, my 'hello world' title would appear 
on top). Of course, the main pastebin template (templates/site.html) 
would need to be adjusted. But not the python code.

I don't know if I should think of the included pastebin as a Fragment? 
Certainly it's a Page, as it is.

Bellow is what I've tried. I still don't know how to make such a thing 
work. Somebody care to enlighten me?

Regards

Markus


Index: pastebin.tac
===================================================================
--- pastebin.tac        (revision 9132)
+++ pastebin.tac        (working copy)
@@ -5,6 +5,7 @@

  from nevow import appserver
  from nevow import vhost
+from nevow import inevow, rend, stan, loaders, tags as T

  from pastebin import interfaces
  from pastebin.service import FSPasteBinService
@@ -16,7 +17,31 @@
  pastebin = FSPasteBinService('data')
  pastebin.setServiceParent(application)

-appResource = pages.RootPage(pastebin)
+class SuperiorRootPage(rend.Page):
+    addSlash = True
+    docFactory = loaders.stan(
+        T.html[
+            T.head(),
+            T.body[
+                T.h1['hello world'],
+                T.invisible(macro=T.directive('content')),
+            ]])
+
+    def locateChild(self, ctx, segments):
+        self.remaining_segments = segments[1:]
+        return self, ()
+
+    child_pastebin = pages.RootPage(pastebin)
+
+    def macro_content(self, ctx):
+        print &quot;remaining_segments: %s&quot; % str(self.remaining_segments)
+        if len(self.remaining_segments) == 0:
+            return &quot;welcome!&quot;
+        else:
+            # what to return here???
+            return &quot;duh!&quot;
+
+appResource = SuperiorRootPage(pastebin)
  appResource.putChild('robots.txt', static.File('static/robots.txt'))
  vResource = vhost.VHostMonsterResource()
  appResource.putChild('vhost', vResource)


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003025.html">[Twisted-web] fragments with child lookup
</A></li>
	<LI>Next message: <A HREF="003027.html">[Twisted-web] fragments with child lookup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3026">[ date ]</a>
              <a href="thread.html#3026">[ thread ]</a>
              <a href="subject.html#3026">[ subject ]</a>
              <a href="author.html#3026">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
