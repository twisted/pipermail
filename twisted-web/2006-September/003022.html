<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] fragments with child lookup
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20fragments%20with%20child%20lookup&In-Reply-To=4513E4CA.7050404%40bluegap.ch">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003021.html">
   <LINK REL="Next"  HREF="003024.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] fragments with child lookup</H1>
    <B>Valentino Volonghi aka Dialtone</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20fragments%20with%20child%20lookup&In-Reply-To=4513E4CA.7050404%40bluegap.ch"
       TITLE="[Twisted-web] fragments with child lookup">dialtone at divmod.com
       </A><BR>
    <I>Fri Sep 22 09:20:46 CDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="003021.html">[Twisted-web] fragments with child lookup
</A></li>
        <LI>Next message: <A HREF="003024.html">[Twisted-web] fragments with child lookup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3022">[ date ]</a>
              <a href="thread.html#3022">[ thread ]</a>
              <a href="subject.html#3022">[ subject ]</a>
              <a href="author.html#3022">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 22 Sep 2006 15:27:38 +0200, Markus Schiltknecht &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">markus at bluegap.ch</A>&gt; wrote:
&gt;<i>Right. I try in nevow terms: I want to write a Page, which dynamically 
</I>&gt;<i>displays different Fragments depending on the URL. I wanted to use all the 
</I>&gt;<i>'locateChild()' mechanism for that, but this seems not possible.
</I>
Ok but this should be accomplished in a different way IMHO. You should have a Fragments container somewhere and lookup stuff in there. It doesn't make too much sense to have fragment children IMHO.

&gt;<i>Since Pages are derived from Fragments, I didn't think about using Fragments 
</I>&gt;<i>in the first place at all. (Of course, I'm 'using' Fragments, but hidden 
</I>&gt;<i>from me through the Page class, which inherits from Fragments).
</I>
Well... Pages can be used in place of the Fragments but they will be considered as Fragments with no extra functionality (even if the code is there) thus it's better to stick with Fragments entirely for this usecase.

&gt;<i>As you can see in my example, I've written my own 'locateFragmentChild()' 
</I>&gt;<i>method which does exactly what I'm describing above.
</I>
Well but you just need to lookup stuff here and there, if you need to include  different fragments in a particular fragment then I guess this locateFragmentChild is sort of useful although the name is not the best I can think of, simply locateFragment should be enough (but as I can see there's really no fixed hiararchy of Fragments and you shouldn't use the same mechanism used in locateChild, I'd rather go with a dictionary containing all of them because in the end that's what you are actually doing, including a fragment depending on the url segment).

&gt;<i>The use case is very simple and (IMHO) common: I have a top top level 
</I>&gt;<i>template containing all the HTML headers and some common design elements. 
</I>&gt;<i>Plus the top level navigation. Depending on the URL, different other 
</I>&gt;<i>templates should be inserted (Fragments?). If you know Mason (perl) or 
</I>&gt;<i>Myghty (python), I want to migrate from there. They have a structure like 
</I>&gt;<i>that:
</I>
I have never used Myghty nor Mason but I do what you are describing everytime. I use macros and Page objects with a small function that looks up the template that should be included in the macro from an attribute value of the current Page instance.

<A HREF="http://hg.stiq.it/stiq">http://hg.stiq.it/stiq</A> for some more code.

&gt;<i>autohandler                     # the default template which gets
</I>&gt;<i>                                 # rendered for every request
</I>&gt;<i>
</I>&gt;<i>dhandler                        # a default handler, called if no child
</I>&gt;<i>                                 # is given in the URL, i.e.:
</I>&gt;<i>                                 # www.mysite.com/
</I>&gt;<i>
</I>&gt;<i>foo.html                        # a normal site available at:
</I>&gt;<i>                                 # www.mysite.com/foo.html
</I>&gt;<i>                                 # it gets rendered as 'child' of the
</I>&gt;<i>                                 # toplevel autohandler, thus it
</I>&gt;<i>                                 # inherits it's methods and template.
</I>&gt;<i>
</I>&gt;<i>foo/autohandler                 # the template for subdir 'foo' on:
</I>&gt;<i>                                 # www.mysite.com/foo/*
</I>&gt;<i>
</I>&gt;<i>foo/bar.html                    # a site in the subdirectory
</I>&gt;<i>                                 # www.mysite.com/foo/bar.html
</I>&gt;<i>                                 # For this, the toplevel autohandler is
</I>&gt;<i>                                 # rendered first, then foo/autohandler
</I>&gt;<i>                                 # and then foo/bar.html
</I>
I don't see a connection between this and the fragments though.

&gt;<i>This is very usefull when writing 'hierarchical' sites, i.e. where you can 
</I>&gt;<i>navigate in a tree. What's the best way to do that in nevow?
</I>
There are many different ways of doing it depending on the exact usecase.

&gt;<i>Something else I'm very thankful about are the 'preprocessors'. It seems 
</I>&gt;<i>they have (more or less) recently been added. Any chance I can pass them 
</I>&gt;<i>arguments? Currently I simply insert a renderer in my preprocessor, but I'm 
</I>&gt;<i>not sure if I can do everything with just inserting renderers (but probably 
</I>&gt;<i>I can, I'll see).
</I>
Yes, they are a recent addition for a usecase in Quotient. You can pass arguments by using closures of course. But inserting renderers is a strage usecase, I've never needed it and pre-processors were added to change urls on the fly (I think for caching purposes) when loading templates, not for changing templates in that hard way. You might find some problems in doing that, but I've never tried.

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003021.html">[Twisted-web] fragments with child lookup
</A></li>
	<LI>Next message: <A HREF="003024.html">[Twisted-web] fragments with child lookup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3022">[ date ]</a>
              <a href="thread.html#3022">[ thread ]</a>
              <a href="subject.html#3022">[ subject ]</a>
              <a href="author.html#3022">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
