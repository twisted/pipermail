<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Re: [Nevow-commits] r3904 - server-side (fragment)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Re%3A%20%5BNevow-commits%5D%20r3904%20-%20server-side%20%28fragment%29&In-Reply-To=20060114124445.GD15897%40opteron.random">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002306.html">
   <LINK REL="Next"  HREF="002307.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Re: [Nevow-commits] r3904 - server-side (fragment)</H1>
    <B>glyph at divmod.com</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Re%3A%20%5BNevow-commits%5D%20r3904%20-%20server-side%20%28fragment%29&In-Reply-To=20060114124445.GD15897%40opteron.random"
       TITLE="[Twisted-web] Re: [Nevow-commits] r3904 - server-side (fragment)">glyph at divmod.com
       </A><BR>
    <I>Sat Jan 14 20:13:56 MST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002306.html">[Twisted-web] Re: [Nevow-commits] r3904 - server-side (fragment)
	nesting, and convenience descriptor generator
</A></li>
        <LI>Next message: <A HREF="002307.html">[Twisted-web] Re: [Nevow-commits] r3904 - server-side (fragment)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2304">[ date ]</a>
              <a href="thread.html#2304">[ thread ]</a>
              <a href="subject.html#2304">[ subject ]</a>
              <a href="author.html#2304">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On Sat, 14 Jan 2006 13:44:45 +0100, Andrea Arcangeli &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">andrea at cpushare.com</A>&gt; wrote:
&gt;<i>On Fri, Jan 13, 2006 at 07:32:21PM +0200, Tristan Seligmann wrote:
</I>&gt;&gt;<i> I don't follow this reasoning. Twisted totally depends on Python, should
</I>&gt;&gt;<i> Twisted go in the Python SVN repository? Should Python go in the Twisted
</I>&gt;&gt;<i> SVN repository?
</I>&gt;<i>
</I>&gt;<i>It's only a matter of size.
</I>
No... it isn't?

Different open source projects have different requirements, and different audiences.  They also have different release cycles and different expectations of maturity.  Finally they have different release managers and different pressures which affect releases.

&gt;<i>If it wasn't because of the checkout size (both for space it takes, and
</I>&gt;<i>network bandwidth it requires), it could as well be all in a single SVN.
</I>&gt;<i>But those are significant sized project so there is different people
</I>&gt;<i>working on them, so splitting make administration a bit simpler.
</I>
Exactly the same things are true of Divmod and Twisted; Divmod, like Twisted, contains several projects (Nevow Axiom Epsilon ...), it's just that Divmod started out with the goal of having them well-separated, whereas Twisted didn't realize that until many years into its life.

&gt;<i>But this is not true for epsilon, epsilon a is a few bytes, nevow is 14M
</I>&gt;<i>Twisted is 51M. Furthermore if epsilon contains twisted fixes needed by
</I>&gt;<i>divmod to become productive with old twisted version there's no chance
</I>&gt;<i>that the fine Nevow can depend on such a dirty package that workaround
</I>&gt;<i>twisted bugs.
</I>
Epsilon only contains bug-fixes that have already been contributed to Twisted.  It only installs them if a package specifically requires a fix.  If Nevow wants to require unreleased fixes to Twisted, Epsilon would be one way to go about it; rather than requiring users to upgrade to unreleased versions of Twisted so that we can do a release of Nevow, Nevow's developers can simply drop in the appropriate Twisted fix, and then use it.  The fix will only be enabled when it is requested, so it will not conflict with other libraries which depend on the buggy behavior unless they are being used by the same process.

If such a thing were necessary, Nevow could quite easily depend upon it.  That probably will not be a requirement until Nevow is mature enough to have a 1.0 release, however.

One way to avoid this would be for you to volunteer to be the release manager of Twisted and be very responsive to release requests.  If arbitrary Divmod project releases could easily depend upon Twisted releases being made very quickly, a work-around package would be less important.

&gt;<i>I have one twisted-workaround lib in my app, but the whole point of this
</I>&gt;<i>lib is __not__ to require people to run apt get. If they require to run
</I>&gt;<i>apt get to install epsilon to workaround twisted bugs, then they should
</I>&gt;<i>have run apt get to upgrade twisted instead!!!
</I>
That requires that every version of Epsilon (and Nevow, and Axiom) have a paired release of Twisted.

The release manager for Twisted (Christopher Armstrong) knows the Divmod team well, and vice versa.  He certainly wouldn't mind doing us a favor every so often.

However, when we need to publish a release of Divmod, perhaps for some internal goal, perhaps because one of our contracting clients requires it, we don't employ Chris.  We can't call him up and say, &quot;do a release now, becuase it is your job&quot;.  Maybe Twisted can't release the appropriate subproject for some reason - a release goal hasn't been met, several buildslaves have been taken offline for days' worth of maintenance - whatever.

&gt;<i>The whole point of a workaround-lib that fixes bugs in older twisted
</I>&gt;<i>releases is to avoid running apt get at all and to run the app, so to
</I>&gt;<i>_remove_ dependencies, not to add new ones. The only possible reason one
</I>&gt;<i>can want to workaround twisted bugs is to remove dependencies, there's
</I>&gt;<i>no chance one would ever add a epsilon dependency to install with apt to
</I>&gt;<i>workaround a twisted bug. In suse we even use binary diff deltas to
</I>&gt;<i>optimize the upgrade of big packages, just replace epsilon with a good
</I>&gt;<i>package manager that supports diff deltas (dunno if apt supports that).
</I>
Before we get to apt or yast or whatever, we have to produce upstream releases.  Producing an upstream release of Twisted is substantially more work than producing an upstream release of a Divmod product, even Nevow.  Producing a release of Epsilon requires at most an hour or two of work.

&gt;<i>Furthremore Nevow is a fine open source project, it's not Divmod
</I>&gt;<i>product. If Divmod want to customize Nevow to run on older Twisted
</I>&gt;<i>release they have to _fork_ it, the same way the distro fork the kernel
</I>&gt;<i>to customize it for their customers (i.e. freeze and stabilize 2.6 for
</I>&gt;<i>months, backport stric fixes etc..). You can't screw the official nevow
</I>&gt;<i>repository at your commercial gain. That would be something I'm against,
</I>&gt;<i>because I only care about the code, so if code becomes worse in any way
</I>&gt;<i>due divmod commercial constraints or schedule, that concerns me a lot.
</I>&gt;<i>I don't care where those packages are located.
</I>
Hahahahahahahaha.

You may be confused by the fact that Nevow discussion takes place on this list, because it is a popular Twisted-capable web framework.  However:  go to nevow.com.  Where does that take you?  What is the *first word* on the page that you see?  What is the SVN URL for Nevow?  Are you detecting a theme yet?

I really appreciate the open-source contributions from the Nevow community.  They have been substantial, and it certainly wouldn't be the product it is today if we hadn't had them.  However, its full name is &quot;*Divmod* Nevow&quot;.  Divmod has paid for every stage of its development, and written the vast majority of its code (&gt;80%).  Its primary author, Donovan Preston, stopped working on it when he left Divmod, and maintenance has been taken over by JP Calderone, who currently works -- surprise, surprise -- at Divmod.

&gt;<i>However I'd prefer Twisted and Nevow to be in the same repository, be it
</I>&gt;<i>divmod.org or twistedmatrix.com. Apparently the .com one is the
</I>&gt;<i>no-profit community one, and the .org one is the commercial one, weird.
</I>
Yeah, the story behind that is kind of weird.  twistedmatrix.com is an older domain, that I bought when I was 16 or so, and *everybody* was registering .com names.  Domain squatters have long since purchased .org and .net.  When Divmod was registered, we got the .org for our open-source works and the .com for our commercial service.

&gt;<i>So apparently the .com one is more appropriate for nevow as well.
</I>
No, it isn't, because Divmod develops Nevow, and the Twisted team develops Twisted.

&gt;<i>Then you can fork Nevow from twistedmatrix.com into divmod.org and
</I>&gt;<i>customize it with epsilon (or you can create a branch called divmod into
</I>&gt;<i>the twistedmatrix.com to add the epsilon dependency to fix bugs).
</I>
None of this fixes the release-management problem I've described repeatedly, which doesn't seem to concern you at all.  I understand that you don't use a package manager, or even downloaded tarballs of released version of projects, but that is an extreme minority position.  In many companies where it is allowed to use open source at all, it is *strictly* disallowed to use un-released and/or unpackaged versions on production machines.

&gt;<i>You all have checkin rights in both, so I don't see why should you care
</I>&gt;<i>too. If you want more stuff into divmod.org to get the credit of its
</I>&gt;<i>development that's fine with me, merge Twisted into divmod.org too then,
</I>&gt;<i>if that can help writing better code and to remove any interest in
</I>&gt;<i>creating divmod packages like epsilon that workaround twisted bugs.
</I>
Not true.  Moe, for example, has checkin rights to Divmod and not Twisted.  There are plenty of people who have commit access to Twisted who would not even want to work on any Divmod projects.  I certainly don't think that all Twisted committers should have automatic commit access to Divmod, and I definitely don't think that Twisted committers would be happy if a job at Divmod automatically resulted in getting Twisted commit with no feedback from the rest of the community.

&gt;<i>I'm very serious when I say this, it's a matter of perception, you can't
</I>&gt;<i>base Nevow on a tiny package that totally depends on twisted and that
</I>&gt;<i>even includes twisted workarounds. Perhaps if that was a _stable_ branch
</I>&gt;<i>of nevow, that would be remotely acceptable. But like every open source
</I>&gt;<i>project out there, the _trunk_ must be aligned for the long term, and
</I>&gt;<i>definitely not for the short term gain of some commercial entity.
</I>
It's worth noting, by the way, that we *did* honor the community's request to elide that dependency when it wasn't providing any significant benefit, and Nevow doesn't depend on Epsilon yet.  If and when it does, there will be a good reason.

&gt;<i>Many mistakes happened already, the obsolescence of too many apis is the
</I>&gt;<i>proof. I understand that one always want to learn from its own mistakes
</I>&gt;<i>and that you won't believe others until you scratched you head on it,
</I>&gt;<i>but you may as well decide to trust me and not to add silly dependencies.
</I>
This argument boils down to &quot;you have made mistakes (unrelated to what we are discussing) in the past, so you should not take any actions which may have consequences, because they too might be mistakes&quot;.  If I listened to this, I would never do anything, I would be afraid to even get out of bed in the morning.

&gt;<i>The important thing is not yast2 -i or apt get that will get everything
</I>&gt;<i>right automaticaly, the important thing is that &quot;python setup.py&quot; will
</I>&gt;<i>just work. Requiring a &quot;python setup.py install&quot; of a tiny package is
</I>&gt;<i>silly.
</I>
So - you want the convenience of a package manager (installations that work instantly and with no manual intervention to install dependencies) but you also want to be on the absolute bleeding edge of SVN development?

Sorry, but you can't have it both ways.  Packaging systems are a lot of work.  Dependencies are hard to manage.  Communication between projects is hard - Divmod and Twisted are managed by very similar and very friendly groups of people (which overlap significantly) and even *that* communication is hard.

If you want this kind of ease, help us produce eggs, or debs, or improve our installation instructions.  I thought this thread began as a helpful (albeit misguided) suggestion, but it is quickly devolving into a simple whine: &quot;why doesn't divmod do everything the way I want?&quot;

Let's say you did convince everyone involved that this was a really good idea, and the various repositories should be merged.  It is still probably several weeks of work to do this.  What about bugtrackers?  What about repository performance (doubling the size of the repository in one commit is not going to make SVN happy).  What about merge history on outstanding branches?

&gt;<i>Note that there is people out there that must be in violent agreement
</I>&gt;<i>with me. Please try to run setup.py install of zope3, does it ask for
</I>&gt;<i>anything? No, it just runs. Then go in src/twisted. Hey surprise,
</I>&gt;<i>there's twisted in there. That twisted copy takes 28M on my harddisk,
</I>&gt;<i>not 700K like zope.interface. To avoid a dependency they waste 28M of
</I>&gt;<i>HD, and yet you refuse to copy zope.interface into twisted repository
</I>&gt;<i>and you require an external checkout or rpm install (and I believe you're
</I>&gt;<i>losing users because of that, again it's a matter of perception and
</I>&gt;<i>solidity and self-containment of the project). Not to tell about epsilon
</I>&gt;<i>that is just a few bytes.
</I>
Twisted already includes a zope.interface tarball in sumo releases.  The expectation is that if you are working from the repository, you should not be doing setup.py install anyway - that pollutes your installed directory with an unspecified development version.

Your main point, that people are in &quot;violent agreement&quot; with, is that obstacles to installation should be removed.  The Divmod team agrees with that too, which is why Epsilon and Nevow are *already* in the same repository, and in fact, if you use Combinator to set them up, they will both be in you sys.path automatically.

In the event that we did make Nevow depend upon Epsilon, it would take you less time to contribute all the appropriate patches to bundle a release of Epsilon inside Nevow, or copy it during setup.py install from an SVN export, than it has to write all the messages in this thread.  I suggest you conserve your energy and do that.

&gt;<i>Epsilon repository should be deleted, the good parts of it must be
</I>&gt;<i>merged into twisted repository as twisted.epsilon or twisted.python or
</I>&gt;<i>whatever twisted.*, and the bug workarounds must be dropped. This is
</I>&gt;<i>about the community development, I don't care if you fork one of those
</I>&gt;<i>packages for your needs, but you can only mess in the divmod-fork, you're not
</I>&gt;<i>allowed to screwup the trunk developed by the community. In the
</I>&gt;<i>community developed one the fixes must go into mainline twisted, not in
</I>&gt;<i>a epsilon package!
</I>
1. Epsilon isn't a separate repository, it's a package within Divmod trunk.

2. &quot;You're not allowed to screwup the trunk developed by the community?&quot;  Pardon me, but we are an integral part of the community.  'svn blame' does not seem to think that *you* are.  This really had me laughing.  &quot;You are not allowed to commit things I do not like to your projects, Divmod!  Go to your room!&quot;

3.  The Twisted fixes, which Divmod developers we put versions into Epsilon *to make installing Divmod projects easier*, which is something that you want.  Do you even have any idea what these fixes are?  Have you read any of the code you are claiming to be such an expert on, that we should &quot;trust you&quot; about?

&gt;<i>This as long as you think a community really exists around twisted and
</I>&gt;<i>nevow, and that you're not the only users of twisted and nevow. Your
</I>&gt;<i>behaviour would be perfectly ok if Divmod was the only nevow user.
</I>
We do not always see eye-to-eye with the community on what is best for Nevow, but other productive contributors (who do not have anything to do with Divmod) have already disagreed with you publicly.  They do not seem to have a problem with our &quot;behavior&quot;.

&gt;<i>Note that I'm overall very happy with the development happening, sadly
</I>&gt;<i>when I have to send emails is because I think something is going wrong,
</I>&gt;<i>time is limited and when things goes well one doesn't need to send
</I>&gt;<i>emails.
</I>
Thank you kindly.

&gt;<i>But as much as I like the development, sometime I see some
</I>&gt;<i>frightening nosenses too (new formless api wasted effort, atop wasted
</I>&gt;<i>effort, many twisted api going obsolete) and this epsilon thing is one
</I>&gt;<i>of those nosense. So this time I'm trying to help before you scratch
</I>&gt;<i>your head into it by yourself and before you risk to scare people away
</I>&gt;<i>from the project. And again, there is people who understand things that
</I>&gt;<i>lives very close to you, you just have to look at the zope folks merging
</I>&gt;<i>twisted in to avoid external checkouts to understand this, how can
</I>&gt;<i>explain the fact they merged twisted and they waste 28M of disk and
</I>&gt;<i>bandwidth when you refuse to merge a few bytes into twisted just becasue
</I>&gt;<i>it's not a divmod.org?
</I>
Since you keep repeating yourself, I will keep repeating myself to make sure you hear the answer: Twisted fixes are merged to Twisted before they are replicaetd in Epsilon.  There is only one such fix so far.  Read epsilon.hotfix for details.  If Epsilon discovers that it is running on a Twisted version with the appropriate fix already made, it does nothing.  The hotfix facility is just a way for bits of Divmod code to say &quot;I really need this particular bugfix/feature in library XXX, called YYY, but you do not need to upgrade that library to SVN&quot;

&gt;<i>I cannot care less who gains what and what url I have to checkout, I
</I>&gt;<i>only care about code and there's no chance I can agree with an epsilon
</I>&gt;<i>dependency if it's the nevow trunk you're talking about, you're free to
</I>&gt;<i>add it in a nevow-divmod trunk, that's perfect!
</I>
&gt;<i>So please trust me on this. Thanks!
</I>
Andrea, I have a lot of respect for you, but in this case you quite literally do not know what you are talking about.  You also haven't expressed yourself very clearly: what is it you want exactly?  *Why* is an Epsilon dependency a problem?  The reasons you have given -- it's harder to install, I can't run it from an SVN checkout, I have to use apt, Divmod is not giving changes back to Twisted -- are all wrong.  Sometimes they are confusing and wrong, sometimes they are insulting and wrong, but there are very few actual facts you have offered.  Your suggestions for a remedy are also extremely labor-intensive on the part of the Twisted community, the Nevow community, and Divmod.  While we would not implement these changes either way, it would have been a nice show of good faith for you to offer to do some of the work required yourself.

What started this discussion was MG objecting to an unnecessary dependency.  He was correct: every dependency has a cost, and therefore there must be a benefit to establishing the dependency that exceeds that cost.  The change being discussed was basically zero benefit, so even if the cost was tiny it should not be introduced.  I understood this criticism, I agreed with it, and I corrected the mistake.  What you're saying, though, is that adding a dependency on a project which is small on disk is the WORST thing that ANY project can do EVER.  That is simply not true.  You are objecting to a hypothetical dependency which is being introduced for some hypothetical reason, which since it is hypothetical, could be totally awesome.

I know you also think the zope.interface dependency was a bad idea - again, you find yourself in a tiny minority.  Everyone who knew the old Twisted components system seems to agree that the Zope people did a *much* better job and it is a great thing that we are using their components system.  Everyone who knew Twisted pre-interfaces seems to agree that introducing them (even the crappy, pre-zope interfaces) simplified a lot of things and improved the documentation.

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002306.html">[Twisted-web] Re: [Nevow-commits] r3904 - server-side (fragment)
	nesting, and convenience descriptor generator
</A></li>
	<LI>Next message: <A HREF="002307.html">[Twisted-web] Re: [Nevow-commits] r3904 - server-side (fragment)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2304">[ date ]</a>
              <a href="thread.html#2304">[ thread ]</a>
              <a href="subject.html#2304">[ subject ]</a>
              <a href="author.html#2304">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
