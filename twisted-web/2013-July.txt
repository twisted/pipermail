From p.mayers at imperial.ac.uk  Mon Jul  1 04:06:58 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Mon, 01 Jul 2013 11:06:58 +0100
Subject: [Twisted-web] Where to begin
In-Reply-To: <7A0AF043-3839-404E-9DD0-176500946A0F@ronallensmith.com>
References: <7A0AF043-3839-404E-9DD0-176500946A0F@ronallensmith.com>
Message-ID: <51D154C2.9000504@imperial.ac.uk>

On 07/01/2013 02:40 AM, Ron Allen Smith wrote:
> Hi,
>
> I'm a newbie to Python, but not programming.  However, my problem is
> replacing an antiquated web-based classroom-attendance oriented
> software app.
>
> I need to serve out an environment where teachers can sign in and
> take attendance for students in their classrooms.  That's the general
> idea.  Python was recommended, but I've not used it before.  So, I'm
> looking for directions on what the best overall components would be.
> I just so happened to have started with the web server first--Twisted
> Web was at the top of the list on the
> http://wiki.python.org/moin/WebServers page and seemed intriguing.
>

I love Twisted, but... consider carefully if an asynchronous webserver 
is what you need. A more traditional framework, like Django running 
under Apache/mod_wsgi, may suit your needs. Then again, it may not...

> That's the background on my search/inquiry.
>
> I think I'll need components to help with authenticating people, a
> database to capture attendance data, components to help with
> presenting data back to the user's browser, etc.

In which case for Twisted you'll need to research:

  * core twisted concepts like async/nonblocking patters, the "deferred" 
pattern and use of the reactor
  * web, of course
  * cred, for authenticating users
  * adbapi, for talking to SQL
  * template, for generating HTML

See here:

http://twistedmatrix.com/documents/current/web/howto/web-in-60/index.html

...for a really good start.


From lozinski at freerecruiting.com  Mon Jul  1 16:45:17 2013
From: lozinski at freerecruiting.com (Christopher Lozinski)
Date: Mon, 01 Jul 2013 17:45:17 -0500
Subject: [Twisted-web] Twisted-web Digest, Vol 110, Issue 1
In-Reply-To: <mailman.7.1372701602.17205.twisted-web@twistedmatrix.com>
References: <mailman.7.1372701602.17205.twisted-web@twistedmatrix.com>
Message-ID: <51D2067D.2050303@freerecruiting.com>

On 7/1/13 1:00 PM,Phil Mayers <p.mayers at imperial.ac.uk> wrote:
> >
> > I'm a newbie to Python, but not programming.  However, my problem is
> > replacing an antiquated web-based classroom-attendance oriented
> > software app.
If you are looking at python, you have a lot of choices.

The first choice is which database to use, object-oriented, or relational.

If you choose relational, then django is the mainstream choice.

If you choose object oriented, then you can consider ZODB.  It stores a
persistent network of objects.  Which leads to either the Zope 3 /
ZTFY.org web framework, or else
pyramid.  Pyramid is good for simpler applications, as they get more
complicated, I would recommend ztfy.org.  and wiki.ztfy.org

Better yet, just get a complete school application at

schooltool.org

built on top of zope 3, very easy to make any customizations you want,
that is the greatest strength of Zope 3. 

Regards
Chris
http://zopache.com


From p.mayers at imperial.ac.uk  Mon Jul  1 17:14:22 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Tue, 02 Jul 2013 00:14:22 +0100
Subject: [Twisted-web] Twisted-web Digest, Vol 110, Issue 1
In-Reply-To: <51D2067D.2050303@freerecruiting.com>
References: <mailman.7.1372701602.17205.twisted-web@twistedmatrix.com>
 <51D2067D.2050303@freerecruiting.com>
Message-ID: <51D20D4E.8090909@imperial.ac.uk>

On 07/01/2013 11:45 PM, Christopher Lozinski wrote:

> built on top of zope 3, very easy to make any customizations you want,
> that is the greatest strength of Zope 3.

There are a lot of things I could say in response to this email. I'll 
restrict it to this, since it's getting OT (I tried to make the 2nd half 
of my mail t.web-relevant), and I won't reply:

I've used zope 2 and 3 a *lot* (for over a decade). I would no longer 
recommend them, nor would I recommend ZODB. I won't argue the point - 
people can take the suggestion or leave it.

Cheers,
Phil


From glyph at twistedmatrix.com  Mon Jul  1 18:24:37 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Mon, 1 Jul 2013 17:24:37 -0700
Subject: [Twisted-web] Where to begin
In-Reply-To: <51D154C2.9000504@imperial.ac.uk>
References: <7A0AF043-3839-404E-9DD0-176500946A0F@ronallensmith.com>
 <51D154C2.9000504@imperial.ac.uk>
Message-ID: <201DF9D3-8E85-4514-B5DE-56DA156BAED7@twistedmatrix.com>


On Jul 1, 2013, at 3:06 AM, Phil Mayers <p.mayers at imperial.ac.uk> wrote:

> I love Twisted, but... consider carefully if an asynchronous webserver is what you need. A more traditional framework, like Django running under Apache/mod_wsgi, may suit your needs. Then again, it may not...

If you are going to use Twisted, consider using it in combination with Klein <https://github.com/twisted/klein>.  Klein is a little bit higher level and helps you build the scaffolding necessary to assemble a site out of a bunch of objects.

However, I think Phil's correct insofar as he recommends that Django might be better suited towards the web application parts of your problem.  mod_wsgi, though?  No need for that :).

Another combination, the one I would recommend, would be Django running under Twisted.  Twisted's WSGI container can run Django just fine (although it will need a little help - <https://github.com/clemesha/twisted-wsgi-django> - since Django isn't really a WSGI app, it's a WSGI-plus-some-stuff app).

Twisted (mostly) a web server, for doling out resources, where as Django is (mostly) a web framework for developing web applications.

You can use either for either, of course; Twisted has a web app framework and Django has a built-in web server.

Although Twisted's web-frameworky bits (twisted.web.template, adbapi, cred, guard) are encouraged more for production use than Django's web-server-y bits (runserver.py), if you're developing a reasonably standard web app that just needs to manipulate a little database state, Django will be a lot easier to work with, not to mention fantastically documented.

The web-frameworky bits of Twisted tend to have advantages when one is making web interfaces to things which aren't simply database-backed HTML applications.  For example, a web interface which allows you to view live data-flows, or controls some kind of hardware.  Or, for developing the web interface for something which has a model that might also be accessed by other protocols, like IMAP, DNS, NNTP, and so on.

For example, Twisted doesn't have an ORM of any kind (since your state might live in any kind of database, or no database at all!), and it's still a bit of an open question in the community what the best way to interact with database-backed state from Twisted is.  By contrast, Django has an ORM that can automatically generate a web interface to allow administrators to manipulate any Django model in your application.

Plus, if you use Django to develop your application but run it within a Twisted WSGI container, you can leverage the power of Twisted at any time.  Itamar has even recently released a tool to help you do this almost automatically, Crochet: <http://blog.futurefoundries.com/2013/05/announcing-crochet-07-easily-use.html>.

Hope this is helpful!

-glyph
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130701/72e1bc60/attachment.html>

From lozinski at freerecruiting.com  Mon Jul  1 21:08:02 2013
From: lozinski at freerecruiting.com (Christopher Lozinski)
Date: Mon, 01 Jul 2013 22:08:02 -0500
Subject: [Twisted-web] Nginx vs Twisted Web
In-Reply-To: <51D20D4E.8090909@imperial.ac.uk>
References: <mailman.7.1372701602.17205.twisted-web@twistedmatrix.com>
 <51D2067D.2050303@freerecruiting.com> <51D20D4E.8090909@imperial.ac.uk>
Message-ID: <51D24412.9080506@freerecruiting.com>

 I am just choosing a web server, and I thought it would be good to
consult with this mailing list, since twisted web was on my short list.

 I run a python moinmoin wiki, a static site, a zope 2 site, and a zope
3 site on a VPS.

The thing I care about most, is ease of use.  None of my websites are
very high traffic.  And I have way way too much complexity in my life to
manage.

The next thing I care about is reliability.

The thing I care least about is performance.  Would that I had that
problem.

So Apache is the obvious first choice.  But it is so complicated.  They
threw in everything but the kitchen sink.  I just do not like it, nor do
I want to spend the time wrestling with it to get it to do the needful. 
And you have to restart apache everytime the config files change.

Nginx is the next obvious choice.  "Apache is like Microsoft Word, it
has a million options but you only need six. Nginx does those six
things, and it does five of them 50 times faster than Apache."

Lightpd is an option, but perhaps it does not support wsgi.  Maybe
lightpd2 does.

Cherokee showed up on my radar, it has a nice web admin GUI, but hard to
configure with moinmoin.

There are 20 or 30 other web servers, all of which I am ignoring.  But
one that I have looked at closely is twisted web.

TwistedWeb is very interesting.  When I read the Apache documentation,
my eyes glaze over.  When I read the twisted documentation, my eyes
light up.
What an intelligent object model of networking.  Twisted Web is also
closely related to Zope.  At the very least, it is also using Zope
Component Architecture, which I like.

So here is my comparison of twisted web and nginx.

With Twisted web, first I wonder about configuration.  Nginx is just
some configuration files.  Perhaps easier then editing a python program.

Then I wonder about reliability.  Nginx has a larger installed base,
more bug reports presumably more reliable.   Plus it includes a process
monitor that
keeps things running.  I think twisted web includes monitoring software,
but perhaps not as robust and mature.

The next nice thing about Nginx is that you can drop configuration files
and the server recognizes them, and does the right thing.  No need to
reboot.
The twisted web python program I would have to restart.

Finally I worry about the performance.  You can see a bunch of
interesting results for python servers here.
http://nichol.as/benchmark-of-python-web-servers

In general twisted web does not seem that fast, nor reliable.  High
error rates.  Bummer.

What is my conclusion?  Well I think Twisted web is a brilliant object
model for networking software.  But dedicated software for web serving,
like nginx performs way better
and is much more reliable. 

So I think I am going to use Nginx in front of my moinmoin, zope 2, zope
3 and static servers.   Is that the right decision?   Pity, I really
like twisted web.

Anyhow I thought I would post this here, and see what people have to
say.  Presumably I made some mistakes in this document.  Please let me
know what they are.  


From dynamicgl at gmail.com  Mon Jul  1 21:31:34 2013
From: dynamicgl at gmail.com (Gelin Yan)
Date: Tue, 2 Jul 2013 11:31:34 +0800
Subject: [Twisted-web] Nginx vs Twisted Web
In-Reply-To: <51D24412.9080506@freerecruiting.com>
References: <mailman.7.1372701602.17205.twisted-web@twistedmatrix.com>
 <51D2067D.2050303@freerecruiting.com>
 <51D20D4E.8090909@imperial.ac.uk>
 <51D24412.9080506@freerecruiting.com>
Message-ID: <CABkOF6TUFtan-dgHJSy3AZFM92FmqNmvCU6PA3kk57ZubYxqjA@mail.gmail.com>

On Tue, Jul 2, 2013 at 11:08 AM, Christopher Lozinski <
lozinski at freerecruiting.com> wrote:

>  I am just choosing a web server, and I thought it would be good to
> consult with this mailing list, since twisted web was on my short list.
>
>  I run a python moinmoin wiki, a static site, a zope 2 site, and a zope
> 3 site on a VPS.
>
> The thing I care about most, is ease of use.  None of my websites are
> very high traffic.  And I have way way too much complexity in my life to
> manage.
>
> The next thing I care about is reliability.
>
> The thing I care least about is performance.  Would that I had that
> problem.
>
> So Apache is the obvious first choice.  But it is so complicated.  They
> threw in everything but the kitchen sink.  I just do not like it, nor do
> I want to spend the time wrestling with it to get it to do the needful.
> And you have to restart apache everytime the config files change.
>
> Nginx is the next obvious choice.  "Apache is like Microsoft Word, it
> has a million options but you only need six. Nginx does those six
> things, and it does five of them 50 times faster than Apache."
>
> Lightpd is an option, but perhaps it does not support wsgi.  Maybe
> lightpd2 does.
>
> Cherokee showed up on my radar, it has a nice web admin GUI, but hard to
> configure with moinmoin.
>
> There are 20 or 30 other web servers, all of which I am ignoring.  But
> one that I have looked at closely is twisted web.
>
> TwistedWeb is very interesting.  When I read the Apache documentation,
> my eyes glaze over.  When I read the twisted documentation, my eyes
> light up.
> What an intelligent object model of networking.  Twisted Web is also
> closely related to Zope.  At the very least, it is also using Zope
> Component Architecture, which I like.
>
> So here is my comparison of twisted web and nginx.
>
> With Twisted web, first I wonder about configuration.  Nginx is just
> some configuration files.  Perhaps easier then editing a python program.
>
> Then I wonder about reliability.  Nginx has a larger installed base,
> more bug reports presumably more reliable.   Plus it includes a process
> monitor that
> keeps things running.  I think twisted web includes monitoring software,
> but perhaps not as robust and mature.
>
> The next nice thing about Nginx is that you can drop configuration files
> and the server recognizes them, and does the right thing.  No need to
> reboot.
> The twisted web python program I would have to restart.
>
> Finally I worry about the performance.  You can see a bunch of
> interesting results for python servers here.
> http://nichol.as/benchmark-of-python-web-servers
>
> In general twisted web does not seem that fast, nor reliable.  High
> error rates.  Bummer.
>
> What is my conclusion?  Well I think Twisted web is a brilliant object
> model for networking software.  But dedicated software for web serving,
> like nginx performs way better
> and is much more reliable.
>
> So I think I am going to use Nginx in front of my moinmoin, zope 2, zope
> 3 and static servers.   Is that the right decision?   Pity, I really
> like twisted web.
>
> Anyhow I thought I would post this here, and see what people have to
> say.  Presumably I made some mistakes in this document.  Please let me
> know what they are.
>
> _______________________________________________
> Twisted-web mailing list
> Twisted-web at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>

Hi

   you can take a look at cyclone (http://www.cyclone.io) it is not bad. I
use it daily.

Regards

gelin yan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130702/efb8621b/attachment-0001.html>

From p.mayers at imperial.ac.uk  Tue Jul  2 00:45:39 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Tue, 02 Jul 2013 07:45:39 +0100
Subject: [Twisted-web] Where to begin
In-Reply-To: <201DF9D3-8E85-4514-B5DE-56DA156BAED7@twistedmatrix.com>
References: <7A0AF043-3839-404E-9DD0-176500946A0F@ronallensmith.com>
 <51D154C2.9000504@imperial.ac.uk>
 <201DF9D3-8E85-4514-B5DE-56DA156BAED7@twistedmatrix.com>
Message-ID: <51D27713.9040700@imperial.ac.uk>

On 07/02/2013 01:24 AM, Glyph wrote:
>
> On Jul 1, 2013, at 3:06 AM, Phil Mayers <p.mayers at imperial.ac.uk
> <mailto:p.mayers at imperial.ac.uk>> wrote:
>
>> I love Twisted, but... consider carefully if an asynchronous webserver
>> is what you need. A more traditional framework, like Django running
>> under Apache/mod_wsgi, may suit your needs. Then again, it may not...
>
> If you are going to use Twisted, consider using it in combination with
> Klein

Hey, that's neat. I hadn't seen that before.

> However, I think Phil's correct insofar as he recommends that Django
> might be better suited towards the web application parts of your
> problem.  mod_wsgi, though?  No need for that :).

FWIW the main reasons we use Apache/mod_wsgi (aside from it being a 
recommended deployment model) are the plethora of features available in 
Apache, including mod_auth_kerb, mod_cosign, and various other 
authentication handlers.

Does the Twisted/Django integration run multi-threaded or multi-process? 
Because the latter obviously dodges the GIL, the former not.

> Twisted (mostly) a web /server/, for doling out resources, where as
> Django is (mostly) a web /framework/ for developing web applications.

I should add it's a really rather good web server, and is very useful if 
you don't want to worry about thread/process pool size issues with 
long-running requests. This is where Twisted shines; want 500 
simultaneous XMLRPC requests which wait on a 10-20 second timeout, but 
not a thread/process pool 500-big? Easy.

> Plus, if you use Django to develop your application but run it within a
> Twisted WSGI container, you can leverage the power of Twisted at any
> time.  Itamar has even recently released a tool to help you do this
> almost automatically, Crochet:

That I did know about, but had forgotten - thanks for pointing it out.


From exarkun at twistedmatrix.com  Tue Jul  2 05:26:22 2013
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Tue, 02 Jul 2013 11:26:22 -0000
Subject: [Twisted-web] Nginx vs Twisted Web
In-Reply-To: <51D24412.9080506@freerecruiting.com>
References: <mailman.7.1372701602.17205.twisted-web@twistedmatrix.com>
 <51D2067D.2050303@freerecruiting.com>
 <51D20D4E.8090909@imperial.ac.uk>
 <51D24412.9080506@freerecruiting.com>
Message-ID: <20130702112622.28793.1192856368.divmod.xquotient.595@top>

On 03:08 am, lozinski at freerecruiting.com wrote:
>I am just choosing a web server, and I thought it would be good to
>consult with this mailing list, since twisted web was on my short list.
>
>I run a python moinmoin wiki, a static site, a zope 2 site, and a zope
>3 site on a VPS.
>
>The thing I care about most, is ease of use.  None of my websites are
>very high traffic.  And I have way way too much complexity in my life 
>to
>manage.
>
>The next thing I care about is reliability.

Twisted Web is rather reliable.  http://twistedmatrix.com/ has run on 
Twisted Web for many years now.  From time to time an issue arises, but 
my experience is that it requires less attention than an Apache 
deployment.  This is just my experience, of course.
>The thing I care least about is performance.  Would that I had that
>problem.

That is an excellent attitude!  I'll just note that Twisted Web is fast 
enough for just about anything you might want to do, though.  More on 
this later.
>So Apache is the obvious first choice.  But it is so complicated.  They
>threw in everything but the kitchen sink.  I just do not like it, nor 
>do
>I want to spend the time wrestling with it to get it to do the needful.
>And you have to restart apache everytime the config files change.

You'll almost certainly have to restart your Twisted Web server every 
time you want to change its configuration.  Nothing stops you from 
building a server using Twisted Web for which this is not the case, but 
it's a lot of careful, detail-oriented work for not a lot of gain.
>[snip - lighttpd etc]
>
>TwistedWeb is very interesting.  When I read the Apache documentation,
>my eyes glaze over.  When I read the twisted documentation, my eyes
>light up.
>What an intelligent object model of networking.  Twisted Web is also
>closely related to Zope.  At the very least, it is also using Zope
>Component Architecture, which I like.

Minor correction, Twisted Web uses Zope Interface (as does the rest of 
Twisted) and some of the same ideas as ZCA, it doesn't actually use ZCA 
itself.
>So here is my comparison of twisted web and nginx.
>
>With Twisted web, first I wonder about configuration.  Nginx is just
>some configuration files.  Perhaps easier then editing a python 
>program.

As I think you've learned, Twisted Web doesn't come with a set of 
standard configuration files.  It is configurable using Python.  It's up 
to you to build a maintainable configuration system out of this base. 
http://twistedmatrix.com/ uses something very descriptively named 
"twisted-web" for configuration.  This is a vaguely (*very* vaguely) 
apache-style configuration system, but it's still built out of Python 
and it's also not currently maintained as far as I know.

Fortunately configuration of most features of Twisted Web only takes a 
couple lines of Python at most.  I find this doesn't get too bad.  Also, 
I tend to follow the rule that when configuration does get longer than a 
few lines, it is time to turn it into *software* with documentation and 
unit tests, and then *use* it from the configuration.
>Then I wonder about reliability.  Nginx has a larger installed base,
>more bug reports presumably more reliable.   Plus it includes a process
>monitor that
>keeps things running.  I think twisted web includes monitoring 
>software,
>but perhaps not as robust and mature.

Twisted Web doesn't include any monitoring software, although Twisted 
Runner does include "procmon" which launches and re-launches a program 
as necessary, so perhaps this is what you're referring to here.

There are also lots of other projects that do what "procmon" does (as 
well or better) and are entirely compatible with Twisted Web, so there's 
no shortage of options here.

Returning to http://twistedmatrix.com/, the Twisted Web server deployed 
there does *not* run as a managed process controlled by one of these 
types of tools.  It just keeps running and never needs restarting.

What kind of reliability concerns do you have apart from the process 
aborting, segfaulting, or otherwise crashing due to implementation bugs?
>The next nice thing about Nginx is that you can drop configuration 
>files
>and the server recognizes them, and does the right thing.  No need to
>reboot.
>The twisted web python program I would have to restart.

Yep.
>Finally I worry about the performance.  You can see a bunch of
>interesting results for python servers here.
>http://nichol.as/benchmark-of-python-web-servers
>
>In general twisted web does not seem that fast, nor reliable.  High
>error rates.  Bummer.

Please disregard those results. :(

First, all of the servers he benchmarked performed remarkably well.  500 
requests/second translates to 2ms/request of overhead.  Perhaps your 
moinmoin requests will take 5ms and your zope requests will take 15ms (I 
just made those number up, I have no idea how moinmoin or zope perform). 
So your per-request cost is now 7ms and 17ms - that's 142 
requests/second and 58 requests/second respectively.  I suspect that's 
fast enough for you, but the real point is to compare this to an ideal 
server with 0ms/request of overhead.  On such a server, you would get 
200 requests/second on moinmoin and 66 requests/second on zope.  Is the 
difference between 142 and 200, or 58 and 66 significant for you?

Second, no attempt has been made to explore or explain what "errors" 
mean in the survey.  That said, my suspicion is that they're caused by 
high load on the platform TCP/IP stack and would not typically be 
observed in real world usage where clients *don't* run on the same host 
as the server.  Regardless, as there's no discussion on the write-up and 
in real-world use I haven't observed problems like this, I have assumed 
the errors are spurious and due to the test setup (and await a 
correction from anyone who can demonstrate otherwise).

Third, the benchmark use the WSGI system of Twisted Web.  Perhaps WSGI 
is the only feature you care about in a web server (if so, then you 
don't need to think too hard about picking a WSGI container, since they 
are extremely interchangeable - if the one you pick has a problem, 
switch to another, it's the work of 15 minutes or so at worst). 
However, no attempt has been made to configure the system for maximum 
performance (the default threadpool size is used - a value tuned for DNS 
requests, not WSGI threads) and the benchmark comparison puts this up 
against several "fake" WSGI implementations ("lightweight threads" and 
"callback/generator" flavors are not real WSGI containers).  If you 
wanted to push performance higher, there's every reason to expect you 
could.  And if you don't use WSGI, then performance automatically jumps 
dramatically.
>What is my conclusion?  Well I think Twisted web is a brilliant object
>model for networking software.  But dedicated software for web serving,
>like nginx performs way better
>and is much more reliable.

If you go into more detail about what you mean by "reliable" here, 
someone may be able to speak to it.  As I mentioned above, the 
deployments of Twisted Web I've managed are quite reliable, they just 
keep working year after year with minimal maintenance.
>So I think I am going to use Nginx in front of my moinmoin, zope 2, 
>zope
>3 and static servers.   Is that the right decision?   Pity, I really
>like twisted web.
>
>Anyhow I thought I would post this here, and see what people have to
>say.  Presumably I made some mistakes in this document.  Please let me
>know what they are.

Thanks for writing this up and sending it to the list.  I hope some of 
my responses have been useful or at least interesting.  Good luck in 
whatever you choose to deploy!

Jean-Paul


From stephen.c.waterbury at nasa.gov  Tue Jul  2 05:39:12 2013
From: stephen.c.waterbury at nasa.gov (Stephen Waterbury)
Date: Tue, 2 Jul 2013 07:39:12 -0400
Subject: [Twisted-web] Where to begin
In-Reply-To: <51D27713.9040700@imperial.ac.uk>
References: <7A0AF043-3839-404E-9DD0-176500946A0F@ronallensmith.com>
 <51D154C2.9000504@imperial.ac.uk>
 <201DF9D3-8E85-4514-B5DE-56DA156BAED7@twistedmatrix.com>
 <51D27713.9040700@imperial.ac.uk>
Message-ID: <51D2BBE0.6020605@nasa.gov>

On 07/02/2013 02:45 AM, Phil Mayers wrote:
> On 07/02/2013 01:24 AM, Glyph wrote:
>> However, I think Phil's correct insofar as he recommends that Django
>> might be better suited towards the web application parts of your
>> problem.  mod_wsgi, though?  No need for that :).
>
> FWIW the main reasons we use Apache/mod_wsgi (aside from it being a
> recommended deployment model) are the plethora of features available in
> Apache, including mod_auth_kerb, mod_cosign, and various other
> authentication handlers.

Same here.  mod_auth_kerb is essential for enterprise web apps
here, as it works with Active Directory (amazingly,
M$ implemented the protocol correctly ;).  I would
love to use twisted here someday, but Kerberos auth is
the blocker for now.

Steve


From p.mayers at imperial.ac.uk  Tue Jul  2 05:41:13 2013
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Tue, 02 Jul 2013 12:41:13 +0100
Subject: [Twisted-web] Where to begin
In-Reply-To: <51D2BBE0.6020605@nasa.gov>
References: <7A0AF043-3839-404E-9DD0-176500946A0F@ronallensmith.com>
 <51D154C2.9000504@imperial.ac.uk>
 <201DF9D3-8E85-4514-B5DE-56DA156BAED7@twistedmatrix.com>
 <51D27713.9040700@imperial.ac.uk> <51D2BBE0.6020605@nasa.gov>
Message-ID: <51D2BC59.9020009@imperial.ac.uk>

On 02/07/13 12:39, Stephen Waterbury wrote:
> On 07/02/2013 02:45 AM, Phil Mayers wrote:
>> On 07/02/2013 01:24 AM, Glyph wrote:
>>> However, I think Phil's correct insofar as he recommends that Django
>>> might be better suited towards the web application parts of your
>>> problem.  mod_wsgi, though?  No need for that :).
>>
>> FWIW the main reasons we use Apache/mod_wsgi (aside from it being a
>> recommended deployment model) are the plethora of features available in
>> Apache, including mod_auth_kerb, mod_cosign, and various other
>> authentication handlers.
>
> Same here.  mod_auth_kerb is essential for enterprise web apps
> here, as it works with Active Directory (amazingly,
> M$ implemented the protocol correctly ;).  I would
> love to use twisted here someday, but Kerberos auth is
> the blocker for now.

Ah, well as it happens...

http://twistedmatrix.com/trac/ticket/3532

;o)


From stephen.c.waterbury at nasa.gov  Tue Jul  2 05:53:22 2013
From: stephen.c.waterbury at nasa.gov (Stephen Waterbury)
Date: Tue, 2 Jul 2013 07:53:22 -0400
Subject: [Twisted-web] Where to begin
In-Reply-To: <51D2BC59.9020009@imperial.ac.uk>
References: <7A0AF043-3839-404E-9DD0-176500946A0F@ronallensmith.com>
 <51D154C2.9000504@imperial.ac.uk>
 <201DF9D3-8E85-4514-B5DE-56DA156BAED7@twistedmatrix.com>
 <51D27713.9040700@imperial.ac.uk> <51D2BBE0.6020605@nasa.gov>
 <51D2BC59.9020009@imperial.ac.uk>
Message-ID: <51D2BF32.3020509@nasa.gov>

On 07/02/2013 07:41 AM, Phil Mayers wrote:
> On 02/07/13 12:39, Stephen Waterbury wrote:
>> On 07/02/2013 02:45 AM, Phil Mayers wrote:
>>> On 07/02/2013 01:24 AM, Glyph wrote:
>>>> However, I think Phil's correct insofar as he recommends that Django
>>>> might be better suited towards the web application parts of your
>>>> problem.  mod_wsgi, though?  No need for that :).
>>>
>>> FWIW the main reasons we use Apache/mod_wsgi (aside from it being a
>>> recommended deployment model) are the plethora of features available in
>>> Apache, including mod_auth_kerb, mod_cosign, and various other
>>> authentication handlers.
>>
>> Same here.  mod_auth_kerb is essential for enterprise web apps
>> here, as it works with Active Directory (amazingly,
>> M$ implemented the protocol correctly ;).  I would
>> love to use twisted here someday, but Kerberos auth is
>> the blocker for now.
>
> Ah, well as it happens...
>
> http://twistedmatrix.com/trac/ticket/3532
>
> ;o)

Yes, I remember that one ...
"...testing kerberos is extremely hard."  For sure.  ;)

Steve


From burak.arslan at arskom.com.tr  Tue Jul  2 06:48:33 2013
From: burak.arslan at arskom.com.tr (Burak Arslan)
Date: Tue, 02 Jul 2013 15:48:33 +0300
Subject: [Twisted-web] Nginx vs Twisted Web
In-Reply-To: <51D24412.9080506@freerecruiting.com>
References: <mailman.7.1372701602.17205.twisted-web@twistedmatrix.com>
 <51D2067D.2050303@freerecruiting.com> <51D20D4E.8090909@imperial.ac.uk>
 <51D24412.9080506@freerecruiting.com>
Message-ID: <51D2CC21.9000402@arskom.com.tr>

On 07/02/13 06:08, Christopher Lozinski wrote:
> What is my conclusion?  Well I think Twisted web is a brilliant object
> model for networking software.  But dedicated software for web serving,
> like nginx performs way better
> and is much more reliable.


Hi,

I had to make a similar decision recently and chose to have nginx serve
static files (/assets/*) and forward other requests to twisted because
nginx supports sendfile. (see man 2 sendfile,
http://wiki.nginx.org/HttpCoreModule#sendfile) Not that I need the
miliseconds it shaves off of my response times, but I just think it
makes sense to use (tools that use) the right tool for the job.

I don't think there'd be much difference between the perceived
"reliability" of the  two approaches though -- both are fairly mature
code bases. Yes nginx is able to reload configuration without
restarting, but what good are static files if your app server is down
anyway?

I hope that helps,

Best regards,
Burak



From m-lists at the-moon.net  Tue Jul  2 07:25:35 2013
From: m-lists at the-moon.net (Richard Wall)
Date: Tue, 2 Jul 2013 14:25:35 +0100
Subject: [Twisted-web] Nginx vs Twisted Web
In-Reply-To: <20130702112622.28793.1192856368.divmod.xquotient.595@top>
References: <mailman.7.1372701602.17205.twisted-web@twistedmatrix.com>
 <51D2067D.2050303@freerecruiting.com>
 <51D20D4E.8090909@imperial.ac.uk>
 <51D24412.9080506@freerecruiting.com>
 <20130702112622.28793.1192856368.divmod.xquotient.595@top>
Message-ID: <CABefbUo6npj6DC+pYKJhk234nwKdv__gJv+j2C2QYNHpvCs4fA@mail.gmail.com>

On 2 July 2013 12:26,  <exarkun at twistedmatrix.com> wrote:
> On 03:08 am, lozinski at freerecruiting.com wrote:
<snip>
>> Then I wonder about reliability.  Nginx has a larger installed base,
>> more bug reports presumably more reliable.   Plus it includes a process
>> monitor that
>> keeps things running.  I think twisted web includes monitoring software,
>> but perhaps not as robust and mature.
>
> Twisted Web doesn't include any monitoring software, although Twisted Runner
> does include "procmon" which launches and re-launches a program as
> necessary, so perhaps this is what you're referring to here.
>
> There are also lots of other projects that do what "procmon" does (as well
> or better) and are entirely compatible with Twisted Web, so there's no
> shortage of options here.

Worth mentioning that Twisted works very well with Systemd for process
monitoring. And it supports Systemd socket activation too (unlike
Nginx)
 * https://twistedmatrix.com/documents/current/core/howto/systemd.html
 * http://trac.nginx.org/nginx/ticket/237

This may also partly satisfy your configuration reload requirement. In
so far as you can restart the Twisted process without dropping any new
connections. Systemd keeps listening on port 80 queuing up new
connections until Twisted starts up again.

What I don't know is whether you can shutdown Twisted web gracefully
ie wait for established connections to close.

I also don't know if systemd would start a new twisted process until
the old one had died.

Another problem is that Twisted doesn't yet support SSL on adopted sockets.

-RichardW.


From mithrandi at mithrandi.net  Tue Jul  2 08:25:29 2013
From: mithrandi at mithrandi.net (Tristan Seligmann)
Date: Tue, 2 Jul 2013 16:25:29 +0200
Subject: [Twisted-web] Nginx vs Twisted Web
In-Reply-To: <CABefbUo6npj6DC+pYKJhk234nwKdv__gJv+j2C2QYNHpvCs4fA@mail.gmail.com>
References: <mailman.7.1372701602.17205.twisted-web@twistedmatrix.com>
 <51D2067D.2050303@freerecruiting.com>
 <51D20D4E.8090909@imperial.ac.uk>
 <51D24412.9080506@freerecruiting.com>
 <20130702112622.28793.1192856368.divmod.xquotient.595@top>
 <CABefbUo6npj6DC+pYKJhk234nwKdv__gJv+j2C2QYNHpvCs4fA@mail.gmail.com>
Message-ID: <CAMcKhMTpjHjzNLbdhntA-Cu3hO8=7LfLkQ-vZdBTr4_njyT0Vw@mail.gmail.com>

On Tue, Jul 2, 2013 at 3:25 PM, Richard Wall <m-lists at the-moon.net> wrote:

>
> Another problem is that Twisted doesn't yet support SSL on adopted sockets.
>

Is there a bug report for this? I would have expected it to Just Work
(using twisted.protocols.tls, that is).
-- 
mithrandi, i Ainil en-Balandor, a faer Ambar
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130702/71165e27/attachment-0001.html>

From exarkun at twistedmatrix.com  Tue Jul  2 08:41:43 2013
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Tue, 02 Jul 2013 14:41:43 -0000
Subject: [Twisted-web] Nginx vs Twisted Web
In-Reply-To: <CAMcKhMTpjHjzNLbdhntA-Cu3hO8=7LfLkQ-vZdBTr4_njyT0Vw@mail.gmail.com>
References: <mailman.7.1372701602.17205.twisted-web@twistedmatrix.com>
 <51D2067D.2050303@freerecruiting.com>
 <51D20D4E.8090909@imperial.ac.uk>
 <51D24412.9080506@freerecruiting.com>
 <20130702112622.28793.1192856368.divmod.xquotient.595@top>
 <CABefbUo6npj6DC+pYKJhk234nwKdv__gJv+j2C2QYNHpvCs4fA@mail.gmail.com>
 <CAMcKhMTpjHjzNLbdhntA-Cu3hO8=7LfLkQ-vZdBTr4_njyT0Vw@mail.gmail.com>
Message-ID: <20130702144143.28793.1735275754.divmod.xquotient.600@top>

On 02:25 pm, mithrandi at mithrandi.net wrote:
>On Tue, Jul 2, 2013 at 3:25 PM, Richard Wall <m-lists at the-moon.net> 
>wrote:
>>
>>Another problem is that Twisted doesn't yet support SSL on adopted 
>>sockets.
>
>Is there a bug report for this? I would have expected it to Just Work
>(using twisted.protocols.tls, that is).

It works, if you write the code to do it.  I think what Richard meant
is that there is no endpoint that says "add fd 17 to the reactor and
start speaking TLS over it".

This is perhaps blocked on someone inventing a way to compose endpoints,
so that either the existing systemd endpoint and the existing tls 
endpoint
could be combined to create this feature, or at least new endpoints 
could
be written which could be combined to create this feature (rather than
requiring a new endpoint for each possible combination).

Jean-Paul


From m-lists at the-moon.net  Tue Jul  2 08:41:46 2013
From: m-lists at the-moon.net (Richard Wall)
Date: Tue, 2 Jul 2013 15:41:46 +0100
Subject: [Twisted-web] Nginx vs Twisted Web
In-Reply-To: <CAMcKhMTpjHjzNLbdhntA-Cu3hO8=7LfLkQ-vZdBTr4_njyT0Vw@mail.gmail.com>
References: <mailman.7.1372701602.17205.twisted-web@twistedmatrix.com>
 <51D2067D.2050303@freerecruiting.com>
 <51D20D4E.8090909@imperial.ac.uk>
 <51D24412.9080506@freerecruiting.com>
 <20130702112622.28793.1192856368.divmod.xquotient.595@top>
 <CABefbUo6npj6DC+pYKJhk234nwKdv__gJv+j2C2QYNHpvCs4fA@mail.gmail.com>
 <CAMcKhMTpjHjzNLbdhntA-Cu3hO8=7LfLkQ-vZdBTr4_njyT0Vw@mail.gmail.com>
Message-ID: <CABefbUoFuJ5NKq5rmuiY7JDNhPh93wvey2REWYyEE22pU-ppCg@mail.gmail.com>

On 2 July 2013 15:25, Tristan Seligmann <mithrandi at mithrandi.net> wrote:
> On Tue, Jul 2, 2013 at 3:25 PM, Richard Wall <m-lists at the-moon.net> wrote:
>> Another problem is that Twisted doesn't yet support SSL on adopted
>> sockets.
> Is there a bug report for this? I would have expected it to Just Work (using
> twisted.protocols.tls, that is).

Well I assumed it wasn't possible when I wrote the systemd howto, but
actually I'm not 100% sure. I've never actually tried it.

There was this comment by exarkun
 * https://twistedmatrix.com/trac/ticket/5248#comment:6

Which I didn't undestand at the time, but perhaps you can just pass a
prewrapped factory to the listen or adoptStreamPort methods.

-RichardW.


From m-lists at the-moon.net  Tue Jul  2 14:22:04 2013
From: m-lists at the-moon.net (Richard Wall)
Date: Tue, 2 Jul 2013 21:22:04 +0100
Subject: [Twisted-web] Nginx vs Twisted Web
In-Reply-To: <20130702144143.28793.1735275754.divmod.xquotient.600@top>
References: <mailman.7.1372701602.17205.twisted-web@twistedmatrix.com>
 <51D2067D.2050303@freerecruiting.com>
 <51D20D4E.8090909@imperial.ac.uk>
 <51D24412.9080506@freerecruiting.com>
 <20130702112622.28793.1192856368.divmod.xquotient.595@top>
 <CABefbUo6npj6DC+pYKJhk234nwKdv__gJv+j2C2QYNHpvCs4fA@mail.gmail.com>
 <CAMcKhMTpjHjzNLbdhntA-Cu3hO8=7LfLkQ-vZdBTr4_njyT0Vw@mail.gmail.com>
 <20130702144143.28793.1735275754.divmod.xquotient.600@top>
Message-ID: <CABefbUpw-HUgAY+wA5a4AXyQe2iqju16V=E1-p6-Ju=3s=6PQQ@mail.gmail.com>

On 2 July 2013 15:41,  <exarkun at twistedmatrix.com> wrote:
<snip>
> It works, if you write the code to do it.  I think what Richard meant
> is that there is no endpoint that says "add fd 17 to the reactor and
> start speaking TLS over it".

Yes, I was also ignorant of TLS in Twisted.
I assumed that it required a new IReactorSocket method to specifically
return a t.internet.ssl.Port.

I managed to get it working with the following code:
 * https://gist.github.com/wallrj/5911925

Much simpler than I expected.

> This is perhaps blocked on someone inventing a way to compose endpoints,
> so that either the existing systemd endpoint and the existing tls endpoint
> could be combined to create this feature, or at least new endpoints could
> be written which could be combined to create this feature (rather than
> requiring a new endpoint for each possible combination).

There's just been a short discussion about it on #twisted.web

habnabit wrote this:
 * https://github.com/habnabit/txsocksx/blob/parsley/txsocksx/ssl.py

We'll create some tickets.

-RichardW


From zooko at zooko.com  Sun Jul  7 12:09:39 2013
From: zooko at zooko.com (zooko)
Date: Sun, 7 Jul 2013 22:09:39 +0400
Subject: [Twisted-web] Nginx vs Twisted Web
In-Reply-To: <51D24412.9080506@freerecruiting.com>
References: <mailman.7.1372701602.17205.twisted-web@twistedmatrix.com>
 <51D2067D.2050303@freerecruiting.com>
 <51D20D4E.8090909@imperial.ac.uk>
 <51D24412.9080506@freerecruiting.com>
Message-ID: <20130707180939.GG13116@zooko.com>

My startup company, https://LeastAuthority.com, uses Twisted Web for the
public-facing web server and the customer signup server. We chose it for
security. Even though we like nginx and use nginx for other purposes (e.g.
https://tahoe-lafs.org), we think the Twisted codebase is less likely to harbor
exploitable bugs, in part because it is written in Python instead of C, and in
part because it has fewer features. Also, because the Twisted development
process seems likely to limit the rate of dangerous bugs being added in new
releases.

On the topic of reliability, the way we use it is just to start it with a
cronjob when the server boots up. The Twisted Web process has never yet died of
its own accord, and if it ever did we would manually restart it, and
investigate in the attempt to ascertain what had happened, rather than just
automatically restart it.

Oh, there are some potential security problems, too, with Twisted Web! In its
default configuration it offers to use single-DES for encryption, which is a
bad idea even though it isn't clear (to me) whether an attacker could take
advantage of that.

http://twistedmatrix.com/trac/ticket/5514

It also has compression turned on, apparently, which could lead to a
vulnerability in very specific circumstances (called "CRIME"), and it by
default supports RC4, which has recently been condemned by cryptographers as
potentially unsafe.

Also, it does not, at least with default configuration, support forward
secrecy.

Here's a report from ssllabs.com about the settings of
https://LeastAuthority.com:

https://www.ssllabs.com/ssltest/analyze.html?d=https%3A%2F%2Fleastauthority.com

Although I would like to see those things improved (I would like for the report
to look more like this:
https://www.ssllabs.com/ssltest/analyze.html?d=https%3A%2F%2Fzooko.com , which
is an nginx installation), none of them are as important to us as reducing the
chance that an attacker could exploit a bug in the software to gain access to
the server.

Regards,

Zooko


From lozinski at freerecruiting.com  Sun Jul  7 16:06:35 2013
From: lozinski at freerecruiting.com (Christopher Lozinski)
Date: Sun, 07 Jul 2013 17:06:35 -0500
Subject: [Twisted-web] Nginx vs Twisted Web
In-Reply-To: <mailman.1259.1372735901.1888.twisted-web@twistedmatrix.com>
References: <mailman.1259.1372735901.1888.twisted-web@twistedmatrix.com>
Message-ID: <51D9E66B.5010307@freerecruiting.com>

 Thank so much to all of you for the excellent discussion on this topic.

I particularly liked Jean Paul from Twisted matrix's careful response.

And Burak Arslan's comment about Nginx supporting SendFile was hugely
interesting. *

*So which one of those two did I choose?  At first I was going to go to
Nginx, but then a developer I am cooperating with, who is also doing a
Zope 3 server
went with Cherokee, and I followed in his lead.  Why???  Well Cherokee
has a web GUI, that hugely simplifies my life, and the guy I am
cooperating with and I can support each other.  Really ease of use
trumps all other issues for me.  I just have way way too much complexity
that I am managing in life.

You can read more about my decision here.

http://zopache.com/ApacheNginxCherokeeTwistedWeb

If people want to continue this discussion, I would love to see a
comparison of Twisted Web and Cherokee.  Best to start a new thread for
that.

And if there were a web gui for Twisted Web, I would certainly have gone
with that, even if it were an early release.  I can imagine one could
create resources TTW Through The Web,
and store them in the ZODB.   Eventually I would like to see a tighter
integration between Twisted Web and Zope 3.  I am starting with the 
ZTFY.org release of Zope 3.  But all things take time. 

Regards
Christopher Lozinski
*

*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130707/96f56b3f/attachment.html>

From glyph at twistedmatrix.com  Mon Jul  8 09:18:12 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Mon, 8 Jul 2013 08:18:12 -0700
Subject: [Twisted-web] Nginx vs Twisted Web
In-Reply-To: <20130707180939.GG13116@zooko.com>
References: <mailman.7.1372701602.17205.twisted-web@twistedmatrix.com>
 <51D2067D.2050303@freerecruiting.com> <51D20D4E.8090909@imperial.ac.uk>
 <51D24412.9080506@freerecruiting.com> <20130707180939.GG13116@zooko.com>
Message-ID: <C2607AD9-50FF-42B0-B383-02DF3A76E005@twistedmatrix.com>


On Jul 7, 2013, at 11:09 AM, zooko <zooko at zooko.com> wrote:

> Oh, there are some potential security problems, too, with Twisted Web! In its
> default configuration it offers to use single-DES for encryption, which is a
> bad idea even though it isn't clear (to me) whether an attacker could take
> advantage of that.
> 
> http://twistedmatrix.com/trac/ticket/5514
> 
> It also has compression turned on, apparently, which could lead to a
> vulnerability in very specific circumstances (called "CRIME"), and it by
> default supports RC4, which has recently been condemned by cryptographers as
> potentially unsafe.
> 
> Also, it does not, at least with default configuration, support forward
> secrecy.

As far as I understand it, these are all just bad defaults that Twisted inherits from OpenSSL, and whoever built your particular OpenSSL.  (I'm pretty sure there are compile-time options for OpenSSL to not include DES, or at least to disable it by default.)  That's not to say that we shouldn't offer *better* defaults, but Twisted is not a cryptography library, and for better or worse we rely on OpenSSL's judgement because it's currently the only crypto library we support.

Twisted should have a better cipher-suite defaults and some better command-line options for 'twistd web' (probably in the form of better options for the SSL string endpoint syntax) for modifying those defaults if the user has a good reason to.  But really, it would be nicer to just defer to the judgement of a transport layer security library that has *good* judgement about defaults rather than re-hashing every questionable decision that OpenSSL makes.

-glyph


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130708/219257a0/attachment.html>

From alexei at alexeicolin.com  Sat Jul 13 13:15:50 2013
From: alexei at alexeicolin.com (Alexei Colin)
Date: Sat, 13 Jul 2013 15:15:50 -0400
Subject: [Twisted-web] Add response logging to logging-proxy.py example
Message-ID: <51E1A766.9020808@alexeicolin.com>

Hello,

The example logging-proxy.py processes the request, but not the
response. Yes, one can learn how to do that from the docs and from
stackoverflow, but that is an avoidable time burden. Sometimes this
example is all one needs, if only it were complete with both directions.

Could the example be revised or new one added with something like the
attached? Thank you for the consideration.

-alexei
-------------- next part --------------
A non-text attachment was scrubbed...
Name: logging-proxy.py
Type: text/x-python
Size: 2377 bytes
Desc: not available
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130713/8ada3d4c/attachment.py>

From glyph at twistedmatrix.com  Sun Jul 14 19:13:19 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Sun, 14 Jul 2013 18:13:19 -0700
Subject: [Twisted-web] Add response logging to logging-proxy.py example
In-Reply-To: <51E1A766.9020808@alexeicolin.com>
References: <51E1A766.9020808@alexeicolin.com>
Message-ID: <3E4F2CA7-5FC9-46D5-84A7-CA7DA25F1599@twistedmatrix.com>


On Jul 13, 2013, at 12:15 PM, Alexei Colin <alexei at alexeicolin.com> wrote:

> Hello,
> 
> The example logging-proxy.py processes the request, but not the
> response. Yes, one can learn how to do that from the docs and from
> stackoverflow, but that is an avoidable time burden. Sometimes this
> example is all one needs, if only it were complete with both directions.
> 
> Could the example be revised or new one added with something like the
> attached? Thank you for the consideration.

This sounds like a great idea to me.  The first step would be to explain your enhancement on a bug report, and attach a patch modifying the example file, as described on the various things linked from <http://twistedmatrix.com/trac/wiki/ContributingToTwistedLabs>.

If you need any help figuring that process out, don't hesitate to ask :).

Thanks for your contribution!

-glyph
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130714/2ecf3ca0/attachment.html>

From pranavb85 at gmail.com  Tue Jul 16 18:58:57 2013
From: pranavb85 at gmail.com (Pranav Bhardwaj)
Date: Tue, 16 Jul 2013 17:58:57 -0700
Subject: [Twisted-web] twisted.web : limiting file size during upload (using
	python)
Message-ID: <CAMSA=VSOzoBwzRJ+satyDwDaB+cxLX0V3jpvXUXpCn5ScYTEkw@mail.gmail.com>

Hey

I have a script to be able to upload logs to a twisted web server.

I have the following requirements:

1) to be able to limit the size of the upload to 10MB.
2)  to NOT store file in memory during the request.

Does twisted.web provide these functionality?

Any inputs on these would be welcome!



Here is the *server part* os the script:

        try:
            oStream = open(filename, 'wb')
            oStream.write(request.args['fname'][0])
            outputStream.close()

        except:
            # handle exception


a test *client script:*


<!DOCTYPE html>
<html>
<form action="https://serverUrl"
enctype="multipart/form-data"
method="post">
<div class="row">
<label for="fileUploadToServer">Select file</label><br />
fname : <input type="file" name="fname" />
<input type="submit" value="submit">
</div>
</form>
</html>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130716/c98fbba9/attachment.html>

From cam.turn at gmail.com  Tue Jul 16 19:55:50 2013
From: cam.turn at gmail.com (Shell)
Date: Wed, 17 Jul 2013 02:55:50 +0100
Subject: [Twisted-web] twisted.web : limiting file size during upload
 (using python)
In-Reply-To: <CAMSA=VSOzoBwzRJ+satyDwDaB+cxLX0V3jpvXUXpCn5ScYTEkw@mail.gmail.com>
References: <CAMSA=VSOzoBwzRJ+satyDwDaB+cxLX0V3jpvXUXpCn5ScYTEkw@mail.gmail.com>
Message-ID: <CANmrDMXdhydxU1acu2xt06LRJgJRtvG9XoH4Y_QQC3nBJ7UqiQ@mail.gmail.com>

Pranav

I believe, assuming that this hasn't been worked on last time I looked at
the code, that this is not currently possible. The code is about half way
there.

The request processing function stores the request on the disk if it is
over a certain size. However, once the request has been uploaded, a
function from Python's cgi module is called to parse the data into
request.params. Not only does this lose some information about file uploads
(which can only be recovered by re-parsing the request), but it also loads
all data into memory.

There is also not currently a way to limit either the size of the request,
or the size of individual files in the request.

Assuming that you need a solution and don't want to work on implementing
this in Twisted, I would suggest using nginx as a reverse proxy in front of
Twisted, with the "Upload" module that can be found on the Addons page on
nginx's wiki. This module will place any uploaded files into files on the
disk, and include regular request parameters to tell your Twisted server
where these files are. It is also capable of putting limits in place on the
size of uploaded files.

Cameron


On 17 July 2013 01:58, Pranav Bhardwaj <pranavb85 at gmail.com> wrote:

> Hey
>
> I have a script to be able to upload logs to a twisted web server.
>
> I have the following requirements:
>
> 1) to be able to limit the size of the upload to 10MB.
> 2)  to NOT store file in memory during the request.
>
> Does twisted.web provide these functionality?
>
> Any inputs on these would be welcome!
>
>
>
> Here is the *server part* os the script:
>
>         try:
>             oStream = open(filename, 'wb')
>             oStream.write(request.args['fname'][0])
>             outputStream.close()
>
>         except:
>             # handle exception
>
>
> a test *client script:*
>
>
> <!DOCTYPE html>
> <html>
> <form action="https://serverUrl"
> enctype="multipart/form-data"
> method="post">
> <div class="row">
> <label for="fileUploadToServer">Select file</label><br />
> fname : <input type="file" name="fname" />
> <input type="submit" value="submit">
> </div>
> </form>
> </html>
>
> _______________________________________________
> Twisted-web mailing list
> Twisted-web at twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130717/b1660084/attachment.html>

From glyph at twistedmatrix.com  Thu Jul 18 11:12:44 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Thu, 18 Jul 2013 10:12:44 -0700
Subject: [Twisted-web] twisted.web : limiting file size during upload
	(using python)
In-Reply-To: <CANmrDMXdhydxU1acu2xt06LRJgJRtvG9XoH4Y_QQC3nBJ7UqiQ@mail.gmail.com>
References: <CAMSA=VSOzoBwzRJ+satyDwDaB+cxLX0V3jpvXUXpCn5ScYTEkw@mail.gmail.com>
 <CANmrDMXdhydxU1acu2xt06LRJgJRtvG9XoH4Y_QQC3nBJ7UqiQ@mail.gmail.com>
Message-ID: <F18C76A3-E2A5-472A-86E0-0323B54A452D@twistedmatrix.com>


On Jul 16, 2013, at 6:55 PM, Shell <cam.turn at gmail.com> wrote:

> I believe, assuming that this hasn't been worked on last time I looked at the code, that this is not currently possible. The code is about half way there.
> 
> The request processing function stores the request on the disk if it is over a certain size. However, once the request has been uploaded, a function from Python's cgi module is called to parse the data into request.params. Not only does this lose some information about file uploads (which can only be recovered by re-parsing the request), but it also loads all data into memory.

The trick to doing this with present twisted.web is to override the 'handleContentChunk' method of Request, rather than trying to catch the streaming-upload behavior in your Resource class.  Of course, the right thing to do is to help get <https://tm.tl/#288> fixed :).

-glyph
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130718/c048a5c5/attachment.html>

From briank at kimmel.biz  Mon Jul 29 12:01:20 2013
From: briank at kimmel.biz (D Brian Kimmel)
Date: Mon, 29 Jul 2013 14:01:20 -0400
Subject: [Twisted-web] Need Help
Message-ID: <3349512.pbxp4b3vY6@alki-4.site>

Howdy,

I have a large home automation project that uses twisted.
I am adding a web interface and need athena for COMET activity.

I have been having a very hard time finding any current documentation to help 
me get the athena part working.
I am looking for brains to pick on getting this portion working bi-
directionally.

I am also looking for others who may be interested in working on this type of 
software.

github -> DBrianKimmel/PyHouse

Thanks
Brian


From george at ringdevelopment.com  Mon Jul 29 13:48:35 2013
From: george at ringdevelopment.com (George Pauly)
Date: Mon, 29 Jul 2013 15:48:35 -0400
Subject: [Twisted-web] Need Help
In-Reply-To: <3349512.pbxp4b3vY6@alki-4.site>
References: <3349512.pbxp4b3vY6@alki-4.site>
Message-ID: <1375127315.4324.158.camel@corylus.JORDAN>

Hi Brian,

On Mon, 2013-07-29 at 14:01 -0400, D Brian Kimmel wrote:
> Howdy,
> 
> I have a large home automation project that uses twisted.
> I am adding a web interface and need athena for COMET activity.
> 
> I have been having a very hard time finding any current documentation to help 
> me get the athena part working.
> I am looking for brains to pick on getting this portion working bi-
> directionally.

websockets is the way to go.  Very simple on both ends.  You may still
need to import this separately into your code, however it seems pretty
well developed.  Except docs.  However, docs are hardly needed, just
follow an example.

George



From _ at lvh.io  Mon Jul 29 14:38:48 2013
From: _ at lvh.io (Laurens Van Houtven)
Date: Mon, 29 Jul 2013 22:38:48 +0200
Subject: [Twisted-web] Need Help
In-Reply-To: <1375127315.4324.158.camel@corylus.JORDAN>
References: <3349512.pbxp4b3vY6@alki-4.site>
 <1375127315.4324.158.camel@corylus.JORDAN>
Message-ID: <CAE_Hg6YSMaSMT99QUUR=We1GfvmxMp3r_Xj3DYDDrfnMSaOzOg@mail.gmail.com>

Hi guys,

On Mon, Jul 29, 2013 at 9:48 PM, George Pauly <george at ringdevelopment.com>wrote:

> websockets is the way to go.
>

I'd like to additionally recommend txsockjs. It's a third party project
that implements the server side for the SockJS protocol, which is basically
"websockets, damnit!" for pretty much all browsers, all the way down to
IE6, without Flash. On any browsers where WebSockets are well supported,
SockJS just turns into WebSockets.

It supports operation directly as a protocol, as well as an IResource
(which makes it easy to integrate with other webby stuff. Works a charm
over TLS, too.

Oh, and it's maintained by nice people, so if you have a patch or
something, it has a pretty good chance of getting in.

For some reason, Fugiman/sockjs-twisted is missing, but
DesertBus/sockjs-twisted is still going strong. The former is still what
the PyPI page refers to though. No idea what's going on there :)

pozdrawiam
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130729/ef63126c/attachment.html>

From glyph at twistedmatrix.com  Mon Jul 29 14:42:46 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Mon, 29 Jul 2013 13:42:46 -0700
Subject: [Twisted-web] Need Help
In-Reply-To: <1375127315.4324.158.camel@corylus.JORDAN>
References: <3349512.pbxp4b3vY6@alki-4.site>
 <1375127315.4324.158.camel@corylus.JORDAN>
Message-ID: <069A0AA6-11F1-498F-A724-86D9F342B1F3@twistedmatrix.com>

On Jul 29, 2013, at 12:48 PM, George Pauly <george at ringdevelopment.com> wrote:

> Hi Brian,
> 
> On Mon, 2013-07-29 at 14:01 -0400, D Brian Kimmel wrote:
>> Howdy,
>> 
>> I have a large home automation project that uses twisted.
>> I am adding a web interface and need athena for COMET activity.
>> 
>> I have been having a very hard time finding any current documentation to help 
>> me get the athena part working.
>> I am looking for brains to pick on getting this portion working bi-
>> directionally.
> 
> websockets is the way to go.  Very simple on both ends.  You may still
> need to import this separately into your code, however it seems pretty
> well developed.  Except docs.  However, docs are hardly needed, just
> follow an example.

Athena is more portable than websockets, and besides, does a lot more.  You could replace the implementation of Athena's message passing with websockets for better performance on browsers that support it, and the interface to the user would not visibly change.

So I would say stick with Nevow and maybe send a patch to it to add websocket support if you need it.

(Contingent, of course, upon you finding someone to help you with it...)

Some docs are available here: <http://divmod.readthedocs.org/en/latest/products/nevow/index.html>.  Although they're incomplete (a partial snapshot of a wiki lost to a hardware failure), they might be able to get you started.

Good luck,

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130729/05b3e7d8/attachment.html>

From werner at thieprojects.ch  Mon Jul 29 16:10:17 2013
From: werner at thieprojects.ch (Werner Thie)
Date: Mon, 29 Jul 2013 12:10:17 -1000
Subject: [Twisted-web] Need Help
In-Reply-To: <069A0AA6-11F1-498F-A724-86D9F342B1F3@twistedmatrix.com>
References: <3349512.pbxp4b3vY6@alki-4.site>
 <1375127315.4324.158.camel@corylus.JORDAN>
 <069A0AA6-11F1-498F-A724-86D9F342B1F3@twistedmatrix.com>
Message-ID: <51F6E849.2020003@thieprojects.ch>

On 7/29/13 10:42 AM, Glyph wrote:
> On Jul 29, 2013, at 12:48 PM, George Pauly <george at ringdevelopment.com
> <mailto:george at ringdevelopment.com>> wrote:
>
>> Hi Brian,
>>
>> On Mon, 2013-07-29 at 14:01 -0400, D Brian Kimmel wrote:
>>> Howdy,
>>>
>>> I have a large home automation project that uses twisted.
>>> I am adding a web interface and need athena for COMET activity.
>>>
>>> I have been having a very hard time finding any current documentation
>>> to help
>>> me get the athena part working.
>>> I am looking for brains to pick on getting this portion working bi-
>>> directionally.
>>
>> websockets is the way to go.  Very simple on both ends.  You may still
>> need to import this separately into your code, however it seems pretty
>> well developed.  Except docs.  However, docs are hardly needed, just
>> follow an example.
>
> Athena is more portable than websockets, and besides, does a lot more.
>   You could replace the implementation of Athena's message passing with
> websockets for better performance on browsers that support it, and the
> interface to the user would not visibly change.
>
> So I would say stick with Nevow and maybe send a patch to it to add
> websocket support if you need it.
>
> (Contingent, of course, upon you finding someone to help you with it...)
>
> Some docs are available here:
> <http://divmod.readthedocs.org/en/latest/products/nevow/index.html>.
>   Although they're incomplete (a partial snapshot of a wiki lost to a
> hardware failure), they might be able to get you started.
>
> Good luck,

Hi Brian

I've written a few Nevow/Athena based game servers in the last years, 
and I'm still convinced that I have chosen the right technology for the 
problems at hand. Time given, I might tackle the coding to have the 
underlying transport to be switched to websockets when available as 
Glyph suggested, but currently I see no performance issues and the 
servers are running with uptimes now measured in years.

So, I'm offering my brain to be picked - Werner



From glyph at twistedmatrix.com  Mon Jul 29 16:31:37 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Mon, 29 Jul 2013 15:31:37 -0700
Subject: [Twisted-web] Need Help
In-Reply-To: <51F6E849.2020003@thieprojects.ch>
References: <3349512.pbxp4b3vY6@alki-4.site>
 <1375127315.4324.158.camel@corylus.JORDAN>
 <069A0AA6-11F1-498F-A724-86D9F342B1F3@twistedmatrix.com>
 <51F6E849.2020003@thieprojects.ch>
Message-ID: <3E16223B-10F3-4A16-8883-2C2BBD92F834@twistedmatrix.com>


On Jul 29, 2013, at 3:10 PM, Werner Thie <werner at thieprojects.ch> wrote:

> I've written a few Nevow/Athena based game servers in the last years, and I'm still convinced that I have chosen the right technology for the problems at hand. Time given, I might tackle the coding to have the underlying transport to be switched to websockets when available as Glyph suggested, but currently I see no performance issues and the servers are running with uptimes now measured in years.

To be honest, the main reason to add websocket support is not so much that there is a significant performance problem that needs to be addressed, but rather that people are going to show up _expecting_ that there's a significant performance problems because they've heard on some JavaScript forum that websockets are fast :).  If Nevow can just tick that box on the feature list, there's that much less to argue about.

Glad that Nevow has been working well for you, though :)

-glyph

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130729/592aa0e5/attachment.html>

From mithrandi at mithrandi.net  Mon Jul 29 18:00:28 2013
From: mithrandi at mithrandi.net (Tristan Seligmann)
Date: Tue, 30 Jul 2013 02:00:28 +0200
Subject: [Twisted-web] Need Help
In-Reply-To: <3E16223B-10F3-4A16-8883-2C2BBD92F834@twistedmatrix.com>
References: <3349512.pbxp4b3vY6@alki-4.site>
 <1375127315.4324.158.camel@corylus.JORDAN>
 <069A0AA6-11F1-498F-A724-86D9F342B1F3@twistedmatrix.com>
 <51F6E849.2020003@thieprojects.ch>
 <3E16223B-10F3-4A16-8883-2C2BBD92F834@twistedmatrix.com>
Message-ID: <CAMcKhMTzasaMxRnGaU0VqC45YYtP2phtrq8jjs_8ptay9Rpr9w@mail.gmail.com>

On Tue, Jul 30, 2013 at 12:31 AM, Glyph <glyph at twistedmatrix.com> wrote:

>
> On Jul 29, 2013, at 3:10 PM, Werner Thie <werner at thieprojects.ch> wrote:
>
> I've written a few Nevow/Athena based game servers in the last years, and
> I'm still convinced that I have chosen the right technology for the
> problems at hand. Time given, I might tackle the coding to have the
> underlying transport to be switched to websockets when available as Glyph
> suggested, but currently I see no performance issues and the servers are
> running with uptimes now measured in years.
>
>
> To be honest, the main reason to add websocket support is not so much that
> there is a significant performance problem that needs to be addressed, but
> rather that people are going to show up _expecting_ that there's a
> significant performance problems because they've heard on some JavaScript
> forum that websockets are fast :).  If Nevow can just tick that box on the
> feature list, there's that much less to argue about.
>

I'd like to add that I'm aware of at least one significant performance
problem[1] in Athena (not sure if there's a bug report lying around for it
anymore, although I think there was one in Trac-that-was), but it's to do
with the reliable delivery transport that Athena runs on top of long
polling (which I believe would still be required on top of websockets),
rather than the long polling / HTTP itself. Long polling in general is
pretty reliable, the main problem is with proxy servers that time the
connection out faster than Athena recycles it, but this value is
configurable so the problem is easily worked around.

[1] When sending several messages "at once" with Athena under some specific
set of circumstances (I'm not sure exactly what they are, but the behaviour
is repeatable), the one side will ACK the first message before processing
the second message, leading to the other side retransmitting the remaining
messages even though they were not lost. This shows up as multiple "Athena
transport duplicate message, discarding: ..." log messages, and has the
result of increasing bandwidth usage / latency; depending on the number /
size of the retransmitted messages, the impact may be negligible or
noticeable.
-- 
mithrandi, i Ainil en-Balandor, a faer Ambar
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130730/50f4f153/attachment-0001.html>

From glyph at twistedmatrix.com  Mon Jul 29 18:18:59 2013
From: glyph at twistedmatrix.com (Glyph)
Date: Mon, 29 Jul 2013 17:18:59 -0700
Subject: [Twisted-web] Need Help
In-Reply-To: <CAMcKhMTzasaMxRnGaU0VqC45YYtP2phtrq8jjs_8ptay9Rpr9w@mail.gmail.com>
References: <3349512.pbxp4b3vY6@alki-4.site>
 <1375127315.4324.158.camel@corylus.JORDAN>
 <069A0AA6-11F1-498F-A724-86D9F342B1F3@twistedmatrix.com>
 <51F6E849.2020003@thieprojects.ch>
 <3E16223B-10F3-4A16-8883-2C2BBD92F834@twistedmatrix.com>
 <CAMcKhMTzasaMxRnGaU0VqC45YYtP2phtrq8jjs_8ptay9Rpr9w@mail.gmail.com>
Message-ID: <444EC23E-55F5-4C1D-B3AE-6116C5FA824E@twistedmatrix.com>


On Jul 29, 2013, at 5:00 PM, Tristan Seligmann <mithrandi at mithrandi.net> wrote:

> On Tue, Jul 30, 2013 at 12:31 AM, Glyph <glyph at twistedmatrix.com> wrote:
> 
> On Jul 29, 2013, at 3:10 PM, Werner Thie <werner at thieprojects.ch> wrote:
> 
>> I've written a few Nevow/Athena based game servers in the last years, and I'm still convinced that I have chosen the right technology for the problems at hand. Time given, I might tackle the coding to have the underlying transport to be switched to websockets when available as Glyph suggested, but currently I see no performance issues and the servers are running with uptimes now measured in years.
> 
> To be honest, the main reason to add websocket support is not so much that there is a significant performance problem that needs to be addressed, but rather that people are going to show up _expecting_ that there's a significant performance problems because they've heard on some JavaScript forum that websockets are fast :).  If Nevow can just tick that box on the feature list, there's that much less to argue about.
> 
> I'd like to add that I'm aware of at least one significant performance problem[1] in Athena (not sure if there's a bug report lying around for it anymore, although I think there was one in Trac-that-was), but it's to do with the reliable delivery transport that Athena runs on top of long polling (which I believe would still be required on top of websockets), rather than the long polling / HTTP itself. Long polling in general is pretty reliable, the main problem is with proxy servers that time the connection out faster than Athena recycles it, but this value is configurable so the problem is easily worked around.
> 
> [1] When sending several messages "at once" with Athena under some specific set of circumstances (I'm not sure exactly what they are, but the behaviour is repeatable), the one side will ACK the first message before processing the second message, leading to the other side retransmitting the remaining messages even though they were not lost. This shows up as multiple "Athena transport duplicate message, discarding: ..." log messages, and has the result of increasing bandwidth usage / latency; depending on the number / size of the retransmitted messages, the impact may be negligible or noticeable.

This does sound like a real bug :).  My point is that it's not one that would necessarily be addressed *just* by switching to websockets...

-g
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130729/0a5a02d3/attachment.html>

From mithrandi at mithrandi.net  Mon Jul 29 18:35:39 2013
From: mithrandi at mithrandi.net (Tristan Seligmann)
Date: Tue, 30 Jul 2013 02:35:39 +0200
Subject: [Twisted-web] Need Help
In-Reply-To: <444EC23E-55F5-4C1D-B3AE-6116C5FA824E@twistedmatrix.com>
References: <3349512.pbxp4b3vY6@alki-4.site>
 <1375127315.4324.158.camel@corylus.JORDAN>
 <069A0AA6-11F1-498F-A724-86D9F342B1F3@twistedmatrix.com>
 <51F6E849.2020003@thieprojects.ch>
 <3E16223B-10F3-4A16-8883-2C2BBD92F834@twistedmatrix.com>
 <CAMcKhMTzasaMxRnGaU0VqC45YYtP2phtrq8jjs_8ptay9Rpr9w@mail.gmail.com>
 <444EC23E-55F5-4C1D-B3AE-6116C5FA824E@twistedmatrix.com>
Message-ID: <CAMcKhMTi=KTaQzZDdgYV8hwaG4y5QZ4MRntua+W4MxH3f0c3pQ@mail.gmail.com>

On Tue, Jul 30, 2013 at 2:18 AM, Glyph <glyph at twistedmatrix.com> wrote:

>
> This does sound like a real bug :).  My point is that it's not one that
> would necessarily be addressed *just* by switching to websockets...
>

Yes, certainly not. My comment was meant in the spirit of "the one issue
that I /am/ aware of wouldn't be addressed by websockets".
-- 
mithrandi, i Ainil en-Balandor, a faer Ambar
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130730/a83e7523/attachment.html>

From _ at lvh.io  Tue Jul 30 06:01:06 2013
From: _ at lvh.io (Laurens Van Houtven)
Date: Tue, 30 Jul 2013 14:01:06 +0200
Subject: [Twisted-web] Need Help
In-Reply-To: <CAMcKhMTi=KTaQzZDdgYV8hwaG4y5QZ4MRntua+W4MxH3f0c3pQ@mail.gmail.com>
References: <3349512.pbxp4b3vY6@alki-4.site>
 <1375127315.4324.158.camel@corylus.JORDAN>
 <069A0AA6-11F1-498F-A724-86D9F342B1F3@twistedmatrix.com>
 <51F6E849.2020003@thieprojects.ch>
 <3E16223B-10F3-4A16-8883-2C2BBD92F834@twistedmatrix.com>
 <CAMcKhMTzasaMxRnGaU0VqC45YYtP2phtrq8jjs_8ptay9Rpr9w@mail.gmail.com>
 <444EC23E-55F5-4C1D-B3AE-6116C5FA824E@twistedmatrix.com>
 <CAMcKhMTi=KTaQzZDdgYV8hwaG4y5QZ4MRntua+W4MxH3f0c3pQ@mail.gmail.com>
Message-ID: <CAE_Hg6ax9bq=vqKe+AqxxLg-5Lk6uySmRSuiAsCt9-Xmzp4hPg@mail.gmail.com>

ISTR my reason for not picking Athena was that the cross-domain story isn't
great. You can do cross-domain stuff with CNAME hacks, except then you
don't get TLS, unless Twisted suddenly does SNI or you have a cert with ten
gazillion alternative CNs.

WebSockets don't have the above problem, and IIUC neither does SockJS.

I realize this is an issue for few people :)

cheers
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130730/ea3e38ce/attachment.html>

From exarkun at twistedmatrix.com  Tue Jul 30 07:43:09 2013
From: exarkun at twistedmatrix.com (exarkun at twistedmatrix.com)
Date: Tue, 30 Jul 2013 13:43:09 -0000
Subject: [Twisted-web] Need Help
In-Reply-To: <CAE_Hg6ax9bq=vqKe+AqxxLg-5Lk6uySmRSuiAsCt9-Xmzp4hPg@mail.gmail.com>
References: <3349512.pbxp4b3vY6@alki-4.site>
 <1375127315.4324.158.camel@corylus.JORDAN>
 <069A0AA6-11F1-498F-A724-86D9F342B1F3@twistedmatrix.com>
 <51F6E849.2020003@thieprojects.ch>
 <3E16223B-10F3-4A16-8883-2C2BBD92F834@twistedmatrix.com>
 <CAMcKhMTzasaMxRnGaU0VqC45YYtP2phtrq8jjs_8ptay9Rpr9w@mail.gmail.com>
 <444EC23E-55F5-4C1D-B3AE-6116C5FA824E@twistedmatrix.com>
 <CAMcKhMTi=KTaQzZDdgYV8hwaG4y5QZ4MRntua+W4MxH3f0c3pQ@mail.gmail.com>
 <CAE_Hg6ax9bq=vqKe+AqxxLg-5Lk6uySmRSuiAsCt9-Xmzp4hPg@mail.gmail.com>
Message-ID: <20130730134309.26068.418791602.divmod.xquotient.3@top>

On 12:01 pm, _ at lvh.io wrote:
>ISTR my reason for not picking Athena was that the cross-domain story 
>isn't
>great. You can do cross-domain stuff with CNAME hacks, except then you
>don't get TLS, unless Twisted suddenly does SNI or you have a cert with 
>ten
>gazillion alternative CNs.

There's no problem doing SNI with Twisted.

Jean-Paul
>WebSockets don't have the above problem, and IIUC neither does SockJS.
>
>I realize this is an issue for few people :)
>
>cheers
>lvh


From _ at lvh.io  Tue Jul 30 07:50:10 2013
From: _ at lvh.io (Laurens Van Houtven)
Date: Tue, 30 Jul 2013 15:50:10 +0200
Subject: [Twisted-web] Need Help
In-Reply-To: <20130730134309.26068.418791602.divmod.xquotient.3@top>
References: <3349512.pbxp4b3vY6@alki-4.site>
 <1375127315.4324.158.camel@corylus.JORDAN>
 <069A0AA6-11F1-498F-A724-86D9F342B1F3@twistedmatrix.com>
 <51F6E849.2020003@thieprojects.ch>
 <3E16223B-10F3-4A16-8883-2C2BBD92F834@twistedmatrix.com>
 <CAMcKhMTzasaMxRnGaU0VqC45YYtP2phtrq8jjs_8ptay9Rpr9w@mail.gmail.com>
 <444EC23E-55F5-4C1D-B3AE-6116C5FA824E@twistedmatrix.com>
 <CAMcKhMTi=KTaQzZDdgYV8hwaG4y5QZ4MRntua+W4MxH3f0c3pQ@mail.gmail.com>
 <CAE_Hg6ax9bq=vqKe+AqxxLg-5Lk6uySmRSuiAsCt9-Xmzp4hPg@mail.gmail.com>
 <20130730134309.26068.418791602.divmod.xquotient.3@top>
Message-ID: <CAE_Hg6a60j7PnYLmmK4bcOCCtOAuc1PwcZgwpmO92qAvj=EsGg@mail.gmail.com>

On Tue, Jul 30, 2013 at 3:43 PM, <exarkun at twistedmatrix.com> wrote:

> On 12:01 pm, _ at lvh.io wrote:
>
>> ISTR my reason for not picking Athena was that the cross-domain story
>> isn't
>> great. You can do cross-domain stuff with CNAME hacks, except then you
>> don't get TLS, unless Twisted suddenly does SNI or you have a cert with
>> ten
>> gazillion alternative CNs.
>>
>
> There's no problem doing SNI with Twisted.
>

Right, you can do SNI (figuring out how is kind of non-trivial, presumably
less so if you're the PyOpenSSL maintainer :)) and Twisted doesn't really
help nor get in the way, sorry.

I think my actual issue (this was a while ago) with SNI wasn't the server
side, it was terrible clients that don't understand SNI, particularly IE on
WinXP.

Anyway, my point is that the cases where you Athena can't cut it are small,
and it's probably good enough, which I guess has been made before in this
thread ;)

cheers
lvh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://twistedmatrix.com/pipermail/twisted-web/attachments/20130730/8f11b006/attachment.html>

