<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] HTTPClientFactory questions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20HTTPClientFactory%20questions&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001151.html">
   <LINK REL="Next"  HREF="001158.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] HTTPClientFactory questions</H1>
    <B>snacktime</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20HTTPClientFactory%20questions&In-Reply-To="
       TITLE="[Twisted-web] HTTPClientFactory questions">snacktime at gmail.com
       </A><BR>
    <I>Tue Feb  8 23:25:20 MST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001151.html">[Twisted-web] HTTP Post with getPage
</A></li>
        <LI>Next message: <A HREF="001158.html">[Twisted-web] HTTPClientFactory questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1152">[ date ]</a>
              <a href="thread.html#1152">[ thread ]</a>
              <a href="subject.html#1152">[ subject ]</a>
              <a href="author.html#1152">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm trying to figure out the best way to catch all the different
possible errors when using HTTPClientFactory and am kind of stuck.

First, what is the best way to catch errors before or during the
connection, such as connection time outs or dns lookup errors? If a
response isn't sent to the client, status,version, and message will
never get set.  I need the status code for all responses, but I need a
way to catch all errors that don't set the status so I know if status
is available or not.

I tried inheriting HTTPClientFactory and providing my own
clientConnectionFailed() method, and that's when I ran into another
issue.  I happened to try connecting to a host that gave me an ssl
handshake failure, and an exception was caught in twisted.internet.tcp
and printed.  However it didn't register an errback but went ahead
with the callback (complete code is below).


from twisted.internet import reactor,ssl
from twisted.web.client import HTTPClientFactory
import sys

class Test:

  def Start(self):
      self.factory = HTTPClientFactory('<A HREF="https://www.he.net',method='GET'">https://www.he.net',method='GET'</A>)
      contextFactory = ssl.ClientContextFactory()
      reactor.connectSSL('www.he.net', 443, self.factory, contextFactory)
      self.factory.deferred.addCallback(self.Success)
      self.factory.deferred.addErrback(self.Error)
      reactor.run()

  def Success(self,data):
    print &quot;Success: %s &quot; % data
    reactor.stop()

  def Error(self,data):
     print &quot;Error: %s &quot; % data
     reactor.stop()


c = Test()
c.Start()

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001151.html">[Twisted-web] HTTP Post with getPage
</A></li>
	<LI>Next message: <A HREF="001158.html">[Twisted-web] HTTPClientFactory questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1152">[ date ]</a>
              <a href="thread.html#1152">[ thread ]</a>
              <a href="subject.html#1152">[ subject ]</a>
              <a href="author.html#1152">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
