<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] _nevow_carryover_
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20_nevow_carryover_&In-Reply-To=uvf5q3gpx.fsf%40yahoo.co.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001461.html">
   <LINK REL="Next"  HREF="001464.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] _nevow_carryover_</H1>
    <B>Donovan Preston</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20_nevow_carryover_&In-Reply-To=uvf5q3gpx.fsf%40yahoo.co.uk"
       TITLE="[Twisted-web] _nevow_carryover_">dp at ulaluma.com
       </A><BR>
    <I>Tue May 10 17:10:25 MDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001461.html">[Twisted-web] _nevow_carryover_
</A></li>
        <LI>Next message: <A HREF="001464.html">[Twisted-web] _nevow_carryover_
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1462">[ date ]</a>
              <a href="thread.html#1462">[ thread ]</a>
              <a href="subject.html#1462">[ subject ]</a>
              <a href="author.html#1462">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On May 10, 2005, at 2:37 PM, Paul Moore wrote:


&gt;<i> Can someone tell me what the _nevow_carryover_ argument that gets
</I>&gt;<i> added to URLs as part of form processing is for? Is there any way of
</I>&gt;<i> suppressing it (and presumably handling the functionality in an
</I>&gt;<i> alternative way)? It looks session-related, but if I delete it and
</I>&gt;<i> re-enter the base URL, there seems to be no difference.
</I>&gt;<i>
</I>&gt;<i> I've looked at the source code, but it baffles me :-(
</I>&gt;<i>
</I>&gt;<i> Is it another of these redirect loop hacks, like __start_session__?
</I>&gt;<i>
</I>
This is used to implement the formless &quot;IHand&quot; when no guard session  
or cookie-based session is present (and it is always used regardless  
of whether they are present).

I know this annoys people. It annoys me that it annoys people :-) But  
I would like to fix it once and for all.

The IHand is the return result of an autocallable. It is stored in a  
global dictionary, keyed by the _nevow_carryover_ value, and after  
the POST to GET redirect occurs (with the _nevow_carryover_ parameter  
added), the value is retrieved out of the dictionary and stored as  
IHand on the context.

Solutions to removing this annoyance:

1) If the autocallable returns None, or returns a Deferred which  
fires with None, do not add _nevow_carryover_ and do not set IHand.  
This will cover a large number of the man-_nevow_carryover_-is- 
annoying cases.

If someone is using formless to expose methods as autocallable, and  
merely does database munging in the autocallable, and does not ever  
return a result, then they will never see _nevow_carryover_.

2) If the user actually is returning values from the autocallable,  
and is actually looking for the result in the IHand of the next  
request: Check to see if there is a guard session. If so, store the  
hand there for the duration of the redirect.

This will solve cases where people actually are using the IHand  
(probably rare) AND are using guard sessions (Probably 100% of the  
rare cases)

3) Finally, if people ARE returning results from autocallables, AND  
ARE NOT using guard AND are still annoyed with _nevow_carryover_, I  
have an idea which involves putting the mini-session key in the &lt;form  
action=&quot;&quot;&gt; instead of the redirect. Since users only see the action  
url during the time it takes their browser to redirect, and the  
redirected request can pull the mini-session key out of the referrer,  
this would work.

dp



</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001461.html">[Twisted-web] _nevow_carryover_
</A></li>
	<LI>Next message: <A HREF="001464.html">[Twisted-web] _nevow_carryover_
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1462">[ date ]</a>
              <a href="thread.html#1462">[ thread ]</a>
              <a href="subject.html#1462">[ subject ]</a>
              <a href="author.html#1462">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
