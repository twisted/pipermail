<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> Nevow URL flattening (was Re: [Twisted-web] livepage)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=Nevow%20URL%20flattening%20%28was%20Re%3A%20%5BTwisted-web%5D%20livepage%29&In-Reply-To=42760B6C.9080702%40pollenation.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001433.html">
   <LINK REL="Next"  HREF="001437.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Nevow URL flattening (was Re: [Twisted-web] livepage)</H1>
    <B>Matt Goodall</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=Nevow%20URL%20flattening%20%28was%20Re%3A%20%5BTwisted-web%5D%20livepage%29&In-Reply-To=42760B6C.9080702%40pollenation.net"
       TITLE="Nevow URL flattening (was Re: [Twisted-web] livepage)">matt at pollenation.net
       </A><BR>
    <I>Mon May  2 05:24:57 MDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001433.html">[Twisted-web] livepage
</A></li>
        <LI>Next message: <A HREF="001437.html">[Twisted-web] livepage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1434">[ date ]</a>
              <a href="thread.html#1434">[ thread ]</a>
              <a href="subject.html#1434">[ subject ]</a>
              <a href="author.html#1434">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matt Goodall wrote:

&gt;<i>Tommi Virtanen wrote:
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>Christopher Zorn wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>As I was the first to make this mistake, I'll answer : if you use Nevow
</I>&gt;&gt;&gt;&gt;<i>behing a
</I>&gt;&gt;&gt;&gt;<i>proxy (really, it's a proxy ? what did you mean by firewall ?), you
</I>&gt;&gt;&gt;&gt;<i>should look
</I>&gt;&gt;&gt;&gt;<i>after nevow.vhost.VHostMonsterResource.
</I>&gt;&gt;&gt;&gt;<i>        
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Sorry, a reverse proxy. I have an apache reverse proxy to get to the
</I>&gt;&gt;&gt;<i>server
</I>&gt;&gt;&gt;<i>running the nevow livepage application. How will
</I>&gt;&gt;&gt;<i>nevow.vhost.VHostMonsterResource
</I>&gt;&gt;&gt;<i>fix this?
</I>&gt;&gt;&gt;<i>The problem is, when I call render_liveglue it gives a tag similar to
</I>&gt;&gt;&gt;<i>&lt;script src=<A HREF="http://server.behind.the.firewall.tld/nevow_glue.js">http://server.behind.the.firewall.tld/nevow_glue.js</A> /&gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>It needs to be the correct server or just nevow_glue.js in order to
</I>&gt;&gt;&gt;<i>work correctly.
</I>&gt;&gt;&gt;<i>      
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>Just wanted to confirm this quickly: you must use VHostMonsterResource,
</I>&gt;&gt;<i>and the code change you suggested is not needed. Without
</I>&gt;&gt;<i>VHostMonsterResource, many other things will fail too; first you are
</I>&gt;&gt;<i>likely to notice are redirects.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>To all nevow developers:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>On the other hand, if you want to link to a resource in the current
</I>&gt;&gt;<i>directory, url.here is really unnecessary -- please try to use relative
</I>&gt;&gt;<i>URLs when they work. 
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>I don't think is a good recommendation until rend.Page stops always
</I>&gt;<i>handling an additional empty segment regardless of the value of
</I>&gt;<i>addSlash. This behaviour has already been deprecated but not yet
</I>&gt;<i>removed. See nevow.rend.Page.child_.
</I>&gt;<i>
</I>&gt;<i>Right now, there's no way the developer can know if the URL the user
</I>&gt;<i>used to reach the page is /foo or /foo/ and that makes it difficult to
</I>&gt;<i>construct a correct relative URL.
</I>&gt;<i>
</I>&gt;<i>I guess it's time to remove the deprecated child_ stuff.
</I>&gt;<i>
</I>Of course, we could just improve the URL flattener to write out relative
URLs whenever possible. That should make it a lot easier to deploy Nevow
apps behind proxies.

The only issue with doing that is that the URL instance's attributes all
need flattening before we can compare them to the current URL, and last
time I tried doing something like that I got into all sorts of
strangeness ;-).

Can anyone see a reason for *not* doing this? I might take a crack at
this sometime soon.

- Matt

-- 
     __
    /  \__     Matt Goodall, Pollenation Internet Ltd
    \__/  \    w: <A HREF="http://www.pollenation.net">http://www.pollenation.net</A>
  __/  \__/    e: <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">matt at pollenation.net</A>
 /  \__/  \    t: +44 (0)113 2252500
 \__/  \__/
 /  \	       Any views expressed are my own and do not necessarily
 \__/          reflect the views of my employer.


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001433.html">[Twisted-web] livepage
</A></li>
	<LI>Next message: <A HREF="001437.html">[Twisted-web] livepage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1434">[ date ]</a>
              <a href="thread.html#1434">[ thread ]</a>
              <a href="subject.html#1434">[ subject ]</a>
              <a href="author.html#1434">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
