From mrodrigox at yahoo.com  Tue Aug  2 05:13:44 2005
From: mrodrigox at yahoo.com (Rodrigo Monteiro)
Date: Tue Aug  2 05:14:17 2005
Subject: [Twisted-web] twisted with apache for punjab + jwchat
Message-ID: <20050802111344.99358.qmail@web53911.mail.yahoo.com>

in the punjab website
(http://punjab.sourceforge.net/jwchat.html) there is
an manual to install and configure punjab + jwchat.
for punjab it says that require python, twisted and
zopeinterface installed and configured. i install
python and zopeinterface, but how to install and
configure twisted? sorry for the dumb question...
regards,
Rodrigo.


		
____________________________________________________
Start your day with Yahoo! - make it your home page 
http://www.yahoo.com/r/hs 
 

From dialtone at divmod.com  Tue Aug  2 05:32:23 2005
From: dialtone at divmod.com (Valentino Volonghi aka Dialtone)
Date: Tue Aug  2 05:32:18 2005
Subject: [Twisted-web] twisted with apache for punjab + jwchat
In-Reply-To: <20050802111344.99358.qmail@web53911.mail.yahoo.com>
References: <20050802111344.99358.qmail@web53911.mail.yahoo.com>
Message-ID: <42EF59C7.3010007@divmod.com>

Rodrigo Monteiro wrote:

>in the punjab website
>(http://punjab.sourceforge.net/jwchat.html) there is
>an manual to install and configure punjab + jwchat.
>for punjab it says that require python, twisted and
>zopeinterface installed and configured. i install
>python and zopeinterface, but how to install and
>configure twisted? sorry for the dumb question...
>regards,
>  
>
Just installing Twisted Sumo with PyOpenSSL and PyCrypto if you need SSL.

This should be enough.

-- 
Valentino Volonghi aka Dialtone
Now Running MacOSX 10.4.1
Blog: http://vvolonghi.blogspot.com
http://weever.berlios.de


From mary-twisted at puzzling.org  Tue Aug  2 07:21:24 2005
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Tue Aug  2 07:21:07 2005
Subject: [Twisted-web] Sydney Twisted Sprint (19-21/8): Linux Australia
	grants
Message-ID: <20050802132124.GB4807@sourdust.home.puzzling.org>

Hi everyone,

Another reminder about the Sydney Twisted Sprint on 19th-21st August,
but this time a reminder with a difference... Linux Australia is
sponsoring the sprint and is providing a few grants. They are providing
two subsidised domestic airfares and three accommodation subsidies to
needy Twisted folk, and further provided some funding for a sprint
dinner.

I need to hear from people wanting the airfares or accommodation
subsidies by this Friday by email. People wanting to come to the dinner
just need to RSVP on the wiki.

Info is at these pages:

 - http://users.puzzling.org/users/mary/TwistedSprint/moin.cgi/SponsoredFlights
 - http://users.puzzling.org/users/mary/TwistedSprint/moin.cgi/SponsoredAccommodation
 - http://users.puzzling.org/users/mary/TwistedSprint/moin.cgi/SponsoredDinner

General information on the sprint is available at
http://users.puzzling.org/users/mary/TwistedSprint/moin.cgi/FrontPage

Thanks very much to both Linux Australia and to Matthew Beauregard of
UTS's Programming Society (Matthew got the venue together for us).

-Mary

From mrodrigox at yahoo.com  Tue Aug  2 07:28:58 2005
From: mrodrigox at yahoo.com (Rodrigo Monteiro)
Date: Tue Aug  2 07:29:31 2005
Subject: [Twisted-web] twisted with apache for punjab + jwchat
In-Reply-To: <42EF59C7.3010007@divmod.com>
Message-ID: <20050802132858.52478.qmail@web53903.mail.yahoo.com>

thanks! i installed it ok.
now i'm stuck on with the configuration.
do you know anything about this configuration?
i did exactly what was in the punjab site
(http://punjab.sourceforge.net/jwchat.html) and it
don't connect in the jabber (jive messenger).
i don't know what to do more.
i'vre tryied the .war file to work with resin and it
just connect when the jabber client port is the
default (5222). i need to use 2510.
if anyone can help me...
regards,
Rodrigo.

--- Valentino Volonghi aka Dialtone
<dialtone@divmod.com> wrote:

> Rodrigo Monteiro wrote:
> 
> >in the punjab website
> >(http://punjab.sourceforge.net/jwchat.html) there
> is
> >an manual to install and configure punjab + jwchat.
> >for punjab it says that require python, twisted and
> >zopeinterface installed and configured. i install
> >python and zopeinterface, but how to install and
> >configure twisted? sorry for the dumb question...
> >regards,
> >  
> >
> Just installing Twisted Sumo with PyOpenSSL and
> PyCrypto if you need SSL.
> 
> This should be enough.
> 
> -- 
> Valentino Volonghi aka Dialtone
> Now Running MacOSX 10.4.1
> Blog: http://vvolonghi.blogspot.com
> http://weever.berlios.de
> 
> 
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
>
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
> 


__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 

From dialtone at divmod.com  Tue Aug  2 07:45:21 2005
From: dialtone at divmod.com (Valentino Volonghi aka Dialtone)
Date: Tue Aug  2 07:45:16 2005
Subject: [Twisted-web] twisted with apache for punjab + jwchat
In-Reply-To: <20050802132858.52478.qmail@web53903.mail.yahoo.com>
References: <20050802132858.52478.qmail@web53903.mail.yahoo.com>
Message-ID: <42EF78F1.1050304@divmod.com>

Rodrigo Monteiro wrote:

>thanks! i installed it ok.
>now i'm stuck on with the configuration.
>do you know anything about this configuration?
>i did exactly what was in the punjab site
>(http://punjab.sourceforge.net/jwchat.html) and it
>don't connect in the jabber (jive messenger).
>i don't know what to do more.
>i'vre tryied the .war file to work with resin and it
>just connect when the jabber client port is the
>default (5222). i need to use 2510.
>if anyone can help me...
>regards,
>
Twisted doesn't need to be configured. Once twistd works it is ok.
Check that you have all twisted installed like twisted.xish and
twisted.words
(/usr/lib/python2.X/site-packages/twisted/{xish,words}) and others if
needed.

Other than that requires attention from punjab authors and I guess you
should head to
their mailing list.

-- 
Valentino Volonghi aka Dialtone
Now Running MacOSX 10.4.1
Blog: http://vvolonghi.blogspot.com
http://weever.berlios.de


From mrodrigox at yahoo.com  Tue Aug  2 10:52:07 2005
From: mrodrigox at yahoo.com (Rodrigo Monteiro)
Date: Tue Aug  2 10:52:39 2005
Subject: [Twisted-web] twisted with apache for punjab + jwchat
In-Reply-To: <42EF78F1.1050304@divmod.com>
Message-ID: <20050802165207.11641.qmail@web53901.mail.yahoo.com>


when i do "mktap punjab --help" is says this about
twisted.python.plugin
is that some problem?

thanks Valentino

********
root@CESEC-17-4575:/opt/punjab# mktap punjab --help
/usr/local/lib/python2.3/site-packages/punjab/plugins.tml:3:
DeprecationWarning: The twisted.python.plugin system
is deprecated.  See twisted.plugin for the revised
edition.
  type='tap', tapname='punjab')
which: no dia in
(/usr/local/sbin:/usr/sbin:/sbin:/usr/local/bin:/usr/bin:/bin:/usr/X11R6/bin:/usr/games:/usr/lib/java/bin:/usr/lib/java/jre/bin:/opt/kde/bin:/usr/lib/qt/bin:/usr/share/texmf/bin)
Usage:    mktap [options] <command> [command options]
punjab [options]
Options:
  -v, --verbose       Show traffic
      --host=         [default: localhost]
      --port=         [default: 5280]
  -b, --httpb=
  -p, --httpp=
  -s, --soap=
  -x, --xmlrpc=
      --html_dir=     [default: ./html]
      --ssl=
      --ssl_privkey=  [default: ssl.key]
      --ssl_cert=     [default: ssl.crt]
      --version
      --help          Display this help and exit.

***********

--- Valentino Volonghi aka Dialtone
<dialtone@divmod.com> wrote:

> Rodrigo Monteiro wrote:
> 
> >thanks! i installed it ok.
> >now i'm stuck on with the configuration.
> >do you know anything about this configuration?
> >i did exactly what was in the punjab site
> >(http://punjab.sourceforge.net/jwchat.html) and it
> >don't connect in the jabber (jive messenger).
> >i don't know what to do more.
> >i'vre tryied the .war file to work with resin and
> it
> >just connect when the jabber client port is the
> >default (5222). i need to use 2510.
> >if anyone can help me...
> >regards,
> >
> Twisted doesn't need to be configured. Once twistd
> works it is ok.
> Check that you have all twisted installed like
> twisted.xish and
> twisted.words
>
(/usr/lib/python2.X/site-packages/twisted/{xish,words})
> and others if
> needed.
> 
> Other than that requires attention from punjab
> authors and I guess you
> should head to
> their mailing list.
> 
> -- 
> Valentino Volonghi aka Dialtone
> Now Running MacOSX 10.4.1
> Blog: http://vvolonghi.blogspot.com
> http://weever.berlios.de
> 
> 
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
>
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
> 


__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 

From dialtone at divmod.com  Tue Aug  2 10:59:18 2005
From: dialtone at divmod.com (Valentino Volonghi aka Dialtone)
Date: Tue Aug  2 10:59:13 2005
Subject: [Twisted-web] twisted with apache for punjab + jwchat
In-Reply-To: <20050802165207.11641.qmail@web53901.mail.yahoo.com>
References: <20050802165207.11641.qmail@web53901.mail.yahoo.com>
Message-ID: <42EFA666.8060907@divmod.com>

Rodrigo Monteiro wrote:

>when i do "mktap punjab --help" is says this about
>twisted.python.plugin
>is that some problem?
>  
>
No. Why would it be? If you don't have 'dia' install it (although it
doesn't seem to be required).
mktap punjab -the -options -that -you -need

twistd punjab.tap

-- 
Valentino Volonghi aka Dialtone
Now Running MacOSX 10.4.1
Blog: http://vvolonghi.blogspot.com
http://weever.berlios.de


From maillists at ivsn.com  Tue Aug  2 13:11:08 2005
From: maillists at ivsn.com (Paul Reznicek)
Date: Tue Aug  2 13:11:49 2005
Subject: [Twisted-web] Nevow svn  examples formbuilder broken
Message-ID: <42EFC54C.6080202@ivsn.com>

The example did not show the first form, where you can add elements.
Any idea?
-Paul

From dialtone at divmod.com  Tue Aug  2 14:04:33 2005
From: dialtone at divmod.com (Valentino Volonghi aka Dialtone)
Date: Tue Aug  2 14:04:28 2005
Subject: [Twisted-web] Nevow svn  examples formbuilder broken
In-Reply-To: <42EFC54C.6080202@ivsn.com>
References: <42EFC54C.6080202@ivsn.com>
Message-ID: <42EFD1D1.1000503@divmod.com>

Paul Reznicek wrote:

> The example did not show the first form, where you can add elements.
> Any idea?

Probably due to latest 'fixes' to formless in svn.

-- 
Valentino Volonghi aka Dialtone
Now Running MacOSX 10.4.1
Blog: http://vvolonghi.blogspot.com
http://weever.berlios.de


From alberto.trujillo at ucd.ie  Thu Aug  4 04:18:38 2005
From: alberto.trujillo at ucd.ie (Alberto Trujillo)
Date: Thu Aug  4 04:14:47 2005
Subject: [Twisted-web] History Object in Nevow?
Message-ID: <42F1EB7E.40501@ucd.ie>

I would like to know if there is a history object in Nevow? I need to 
get the url that I have visited before, to redirect the user, and I 
don't know how. It there something like the history.back() of html, that 
I can use in nevow with out Stan?

Thank

From flashbuster at gmail.com  Thu Aug  4 04:21:09 2005
From: flashbuster at gmail.com (Sebastian Schulze)
Date: Thu Aug  4 04:21:43 2005
Subject: [Twisted-web] History Object in Nevow?
In-Reply-To: <42F1EB7E.40501@ucd.ie>
References: <42F1EB7E.40501@ucd.ie>
Message-ID: <c2959a4205080403211b21f73a@mail.gmail.com>

If I'm not mistaken a browser sends the site he is coming from in the headers,
so, this should be available already.
On the other hand, i guess that many browsers have disabled this, or
spoof the information, for privacy reason..


2005/8/4, Alberto Trujillo <alberto.trujillo@ucd.ie>:
> I would like to know if there is a history object in Nevow? I need to
> get the url that I have visited before, to redirect the user, and I
> don't know how. It there something like the history.back() of html, that
> I can use in nevow with out Stan?
> 
> Thank
> 
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>

From matt at pollenation.net  Thu Aug  4 05:46:03 2005
From: matt at pollenation.net (Matt Goodall)
Date: Thu Aug  4 05:46:08 2005
Subject: [Twisted-web] History Object in Nevow?
In-Reply-To: <c2959a4205080403211b21f73a@mail.gmail.com>
References: <42F1EB7E.40501@ucd.ie> <c2959a4205080403211b21f73a@mail.gmail.com>
Message-ID: <42F1FFFB.9050804@pollenation.net>

Sebastian Schulze wrote:
> If I'm not mistaken a browser sends the site he is coming from in the headers,
> so, this should be available already.

Yes, it's the referrer URL:

    inevow.IRequest(ctx).getHeader('Referer')

Note the incorrect spelling of the header name.

> On the other hand, i guess that many browsers have disabled this, or
> spoof the information, for privacy reason..

In my experience, it's not too common for the referrer header to be
disabled but it's certainly not something that can relied on completely.

The only way I know to reliably redirect back to where they came from is
to pass the initial page's URL through as a request parameter. Horrible,
I know.

- Matt

> 
> 
> 2005/8/4, Alberto Trujillo <alberto.trujillo@ucd.ie>:
> 
>>I would like to know if there is a history object in Nevow? I need to
>>get the url that I have visited before, to redirect the user, and I
>>don't know how. It there something like the history.back() of html, that
>>I can use in nevow with out Stan?
>>
>>Thank
>>
>>_______________________________________________
>>Twisted-web mailing list
>>Twisted-web@twistedmatrix.com
>>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>>
> 
> 
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web

-- 
     __
    /  \__     Matt Goodall, Pollenation Internet Ltd
    \__/  \    w: http://www.pollenation.net
  __/  \__/    e: matt@pollenation.net
 /  \__/  \    t: +44 (0)113 2252500
 \__/  \__/
 /  \          Any views expressed are my own and do not necessarily
 \__/          reflect the views of my employer.

From snacktime at gmail.com  Sat Aug  6 17:23:11 2005
From: snacktime at gmail.com (snacktime)
Date: Sat Aug  6 17:23:44 2005
Subject: [Twisted-web] Introduction, newbie confusion plus an offer
In-Reply-To: <3d87b12b05070616052be29876@mail.gmail.com>
References: <1978.129.44.180.6.1120674823.squirrel@www.wbsysnet.com>
	<1120675815.9458.19.camel@207-118-73-152.dyn.centurytel.net>
	<3d87b12b05070616052be29876@mail.gmail.com>
Message-ID: <1f060c4c0508061623cafcf76@mail.gmail.com>

On 7/6/05, Kieran Holland <kieran.holland@gmail.com> wrote:
> Partly in an effort to clear up my own confusion, I have just been
> putting together some documentation on Stan, Nevow's document object
> model.  This is my first draft and I am fairly new to Nevow so don't
> take it as gospel:
> 
> http://dictator.kieranholland.com/prose/Meet%20Stan.html
> 
> I would greatly value feedback from more experienced Nevow users.
> 
> Kieran

I think what is needed more is feeback from inexperienced users like
myself, because we are the ones that need this type of documentation. 
Your documentation and the xhtml templates tutorial by Donovan Preston
that you had a link to are just great.  But why didn't I find them on
the divmod.org site or on Nevow's home page?  There appears to
actually be quite a bit of documentation floating around, but you have
to dig and dig to find it!

The examples in the distribution are very good.  But not linked to
from divmod.org or nevow.og.  Your tutorial isn't linked to from
either of these sites either.  The wiki doesn't have links to these I
could find, nor links to the examples included in the distribution. 
It seems it would take very little effort to just update the wiki with
links to some of this stuff, and make some quick changes to divmod.org
and nevow.org to at least point to the wiki.  Ok well the divmod.org
Nevow page does have a link to the wiki, but it's in small text as the
very last line on the page!!

Writing new documenation is a lot of work, and the stuff that Kieran
and Donovan wrote is very good, not too mention the examples in the
distribution which look like they took a considerable amount of effort
to put together.  It's a shame they are so difficult to find.

Chris

From exarkun at divmod.com  Sat Aug  6 18:05:20 2005
From: exarkun at divmod.com (Jp Calderone)
Date: Sat Aug  6 18:05:22 2005
Subject: [Twisted-web] Introduction, newbie confusion plus an offer
In-Reply-To: <1f060c4c0508061623cafcf76@mail.gmail.com>
Message-ID: <20050807000520.3914.1727480996.divmod.quotient.3039@ohm>

On Sat, 6 Aug 2005 16:23:11 -0700, snacktime <snacktime@gmail.com> wrote:
>On 7/6/05, Kieran Holland <kieran.holland@gmail.com> wrote:
>> Partly in an effort to clear up my own confusion, I have just been
>> putting together some documentation on Stan, Nevow's document object
>> model.  This is my first draft and I am fairly new to Nevow so don't
>> take it as gospel:
>>
>> http://dictator.kieranholland.com/prose/Meet%20Stan.html
>>
>> I would greatly value feedback from more experienced Nevow users.
>>
>> Kieran
>
>I think what is needed more is feeback from inexperienced users like
>myself, because we are the ones that need this type of documentation.
>Your documentation and the xhtml templates tutorial by Donovan Preston
>that you had a link to are just great.  But why didn't I find them on
>the divmod.org site or on Nevow's home page?  There appears to
>actually be quite a bit of documentation floating around, but you have
>to dig and dig to find it!

I've added a couple links to the end of the divmod.org Nevow Project page.  If there are other good resources out there that aren't linked, please let me know and I'll update the page again.

Thanks for agitating,

Jp

From kieran.holland at gmail.com  Sat Aug  6 18:30:34 2005
From: kieran.holland at gmail.com (Kieran Holland)
Date: Sat Aug  6 18:31:06 2005
Subject: [Twisted-web] Introduction, newbie confusion plus an offer
In-Reply-To: <20050807000520.3914.1727480996.divmod.quotient.3039@ohm>
References: <1f060c4c0508061623cafcf76@mail.gmail.com>
	<20050807000520.3914.1727480996.divmod.quotient.3039@ohm>
Message-ID: <3d87b12b0508061730219fb4cb@mail.gmail.com>

> I've added a couple links to the end of the divmod.org Nevow Project page.  If there are other > good resources out there that aren't linked, please let me know and I'll update the page again.
> 
> Thanks for agitating,
> 
> Jp

I am touching up the article 'Meet Stan' as I pick up new things and,
if I can find the time, I would like to try to tackle a few other
topics causing mass-confusion.

If people are finding my article useful then I wonder if it, and
purported future vapour-articles, would be better hosted on divmod? 
Personally I wouldn't trust the existing URL not to disappear off the
face of the earth without reasonable warning.  I would be happy to
refactor out the introductory spiel and end-musings to give it more of
a documentation flavour.

Kieran

From matt at pollenation.net  Sun Aug  7 03:57:25 2005
From: matt at pollenation.net (Matt Goodall)
Date: Sun Aug  7 03:57:41 2005
Subject: [Twisted-web] Introduction, newbie confusion plus an offer
In-Reply-To: <3d87b12b0508061730219fb4cb@mail.gmail.com>
References: <1f060c4c0508061623cafcf76@mail.gmail.com>	<20050807000520.3914.1727480996.divmod.quotient.3039@ohm>
	<3d87b12b0508061730219fb4cb@mail.gmail.com>
Message-ID: <42F5DB05.1080509@pollenation.net>

Kieran Holland wrote:
>>I've added a couple links to the end of the divmod.org Nevow Project page.  If there are other > good resources out there that aren't linked, please let me know and I'll update the page again.
>>
>>Thanks for agitating,
>>
>>Jp
> 
> 
> I am touching up the article 'Meet Stan' as I pick up new things and,
> if I can find the time, I would like to try to tackle a few other
> topics causing mass-confusion.

That would be wonderful!

> 
> If people are finding my article useful then I wonder if it, and
> purported future vapour-articles, would be better hosted on divmod? 
> Personally I wouldn't trust the existing URL not to disappear off the
> face of the earth without reasonable warning.  I would be happy to
> refactor out the introductory spiel and end-musings to give it more of
> a documentation flavour.

It's probably best to include "Meet Stan" in Nevow's source. Those
documents are currently published on divmod.org (although not in a great
place) so this one would get added to the list on next update.

- Matt

-- 
     __
    /  \__     Matt Goodall, Pollenation Internet Ltd
    \__/  \    w: http://www.pollenation.net
  __/  \__/    e: matt@pollenation.net
 /  \__/  \    t: +44 (0)113 2252500
 \__/  \__/
 /  \	       Any views expressed are my own and do not necessarily
 \__/          reflect the views of my employer.

From snacktime at gmail.com  Sun Aug  7 18:04:53 2005
From: snacktime at gmail.com (snacktime)
Date: Sun Aug  7 18:05:25 2005
Subject: [Twisted-web] Nevow and forms
Message-ID: <1f060c4c0508071704be31505@mail.gmail.com>

I'm just looking for some suggestions on the best tool for the job
given the situation.

I will be using xhtml templates with nevow to create forms.  Most of
the forms will be used to add/edit information in an sql database. 
One of my concerns with formless is being able to create form
interfaces with the same design flexibility that I have with plain
html/xhtml.  I'm curious in what types of situations formless is a
good choice, and what are it's  primary limitations at this time?

Chris

From alberto.trujillo at ucd.ie  Mon Aug  8 08:10:29 2005
From: alberto.trujillo at ucd.ie (Alberto Trujillo)
Date: Mon Aug  8 08:06:35 2005
Subject: [Twisted-web] multiple choice select box
Message-ID: <42F767D5.2090403@ucd.ie>

Hello:
I have found a problem with the multiple selection in the select box 
component. I only can receive the last item that I has choosen.
I'm working with html templates plus the nevow files, and I don't know 
how to received all the selection that I have clicked in my form. Here 
there is a part of my code. Can anybody help me?

Thank.

user.html
----------------
                    <select multiple="true" name="groups" size="8" 
nevow:data="selectgroups" nevow:render="sequence">
                        <option nevow:pattern="item" 
nevow:render="selectgroups">
                        <nevow:attr name="value"><nevow:slot 
name="value" /></nevow:attr>
                        <nevow:slot name="label">select...</nevow:slot>
                        </option>
                    </select>

user.py
-------------

    def executeAddUser(self, ctx):
        """Execute the process for add a new user"""
        session = ctx.locate(inevow.ISession)
        login = ctx.arg('login')
        passwd = ctx.arg('passwd')
        firstname = ctx.arg('firstname')
        lastname = ctx.arg('lastname')
        email = ctx.arg('email')
        groups = ctx.arg('groups')
        print "Groups" + str(groups)
        if session.da.addUser(login, passwd, firstname, lastname, email, 
groups):   
            session.msg = 'User add succefully!'
            session.prevurl = 'ugp'
        else:
            session.msg = "Error adding user!"
            session.prevurl = 'userdetails'
        return 'displaymsg'


From dkuhlman at cutter.rexx.com  Tue Aug  9 16:00:57 2005
From: dkuhlman at cutter.rexx.com (Dave Kuhlman)
Date: Tue Aug  9 16:01:01 2005
Subject: [Twisted-web] twisted.web.xmlrpc.Proxy plus user and password
Message-ID: <20050809220057.GA15539@cutter.rexx.com>

I'm trying to write an XML-RPC client that will send requests to
an XML-RPC server which requires a user ID and password.  In
xmlrpclib, the URL format for this is:

    http://userid:password@somehost:aport/...

But, twisted.web.xmlrpc.Proxy does not seem to support this.

So, is there a way to write a Twisted XML-RPC client that passes
in user name and password?  And, if so, how do I do that?

I've searched the documentation and done some other searches, but
can't find this.

Thanks for any help.

Dave


-- 
Dave Kuhlman
http://www.rexx.com/~dkuhlman

From grendel at caudium.net  Tue Aug  9 17:26:57 2005
From: grendel at caudium.net (Marek Habersack)
Date: Tue Aug  9 17:27:16 2005
Subject: [Twisted-web] Enforcing SSL for non-SSL requests
Message-ID: <20050809232657.GA5886@beowulf.thanes.org>

Hello everybody,
 
  I'm trying to find a way for a Nevow-based application to enforce SSL
connection on the client when they come in using insecure HTTP. Currently
when the client comes in using a http://site.com URL typed in the browser,
they will get no error and no response from the server as the connection is
closed. The application log reveals the following:

2005/08/09 12:12 CEST [HTTPChannel,0,127.0.0.1] Traceback (most recent call last):
 File "/usr/local/lib/python2.4/site-packages/twisted/python/log.py", line 56, in callWithLogger
  return callWithContext({"system": lp}, func, *args, **kw)
 File "/usr/local/lib/python2.4/site-packages/twisted/python/log.py", line 41, in callWithContext
  return context.call({ILogContext: newCtx}, func, *args, **kw)
 File "/usr/local/lib/python2.4/site-packages/twisted/python/context.py", line 31, in callWithContext
  return func(*args,**kw)
 File "/usr/local/lib/python2.4/site-packages/twisted/internet/pollreactor.py", line 160, in _doReadOrWrite
  why = selectable.doRead()
 --- <exception caught here> ---
 File "/usr/local/lib/python2.4/site-packages/twisted/internet/tcp.py", line 111, in doRead
  return Connection.doRead(self)
 File "/usr/local/lib/python2.4/site-packages/twisted/internet/tcp.py", line 343, in doRead
  data = self.socket.recv(self.bufferSize)
 OpenSSL.SSL.Error: [('SSL routines', 'SSL23_GET_CLIENT_HELLO', 'http request')]

The error above is obvious and the solution would be to either redirect the
client to https://site.com or present them with some information that the
site requires secure connections and have them click a link that would send
them to https://site.com. My meager knowledge of Twisted/Nevow tells me that
it isn't possible to subclass the Connection class to handle the situation
in some generic way without having to rewrite parts of Twisted. Ideally, it
should be possible to be able to handle that situation by either providing a
handler for the exception to the SSLServer object (which is the class I'm
using) or by subclassing SSLServer or, perhaps, by putting the code to
handle the situation deeper inside Twisted so that the solution is more
generic and not limited to SSLServer. It is entirely possible that such
solution already exists and I'm simply not aware of it :) - I would
appreciate any help/hints/pointers/rtfms on the issue,

tia,

marek
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-web/attachments/20050810/22366205/attachment.bin
From radeex at gmail.com  Tue Aug  9 19:30:42 2005
From: radeex at gmail.com (Christopher Armstrong)
Date: Tue Aug  9 19:30:44 2005
Subject: [Twisted-web] Enforcing SSL for non-SSL requests
In-Reply-To: <20050809232657.GA5886@beowulf.thanes.org>
References: <20050809232657.GA5886@beowulf.thanes.org>
Message-ID: <60ed19d4050809183048017fba@mail.gmail.com>

On 8/10/05, Marek Habersack <grendel@caudium.net> wrote:
> Hello everybody,
> 
>   I'm trying to find a way for a Nevow-based application to enforce SSL
> connection on the client when they come in using insecure HTTP. Currently
> when the client comes in using a http://site.com URL typed in the browser,
> they will get no error and no response from the server as the connection is
> closed. The application log reveals the following:



My application started out using twisted.web.util.ChildRedirector to
the https URL for *all* plain http requests, but then we realised we
needed some resources to be accessible over non-HTTPS (for various
boring reasons) we wrote our own FancyRedirectory that looked a lot
like ChildRedirector but made exceptions for certain paths in
getChild.


-- 
  Twisted   |  Christopher Armstrong: International Man of Twistery
   Radix    |    -- http://radix.twistedmatrix.com
            |  Release Manager, Twisted Project
  \\\V///   |    -- http://twistedmatrix.com
   |o O|    |  
w----v----w-+

From tjs at nunatak.com.au  Tue Aug  9 20:31:28 2005
From: tjs at nunatak.com.au (Timothy Stebbing)
Date: Tue Aug  9 20:32:21 2005
Subject: [Twisted-web] twisted.web.xmlrpc.Proxy plus user and password
In-Reply-To: <20050809220057.GA15539@cutter.rexx.com>
References: <20050809220057.GA15539@cutter.rexx.com>
Message-ID: <42F96700.5040207@nunatak.com.au>

Dave Kuhlman wrote:

>I'm trying to write an XML-RPC client that will send requests to
>an XML-RPC server which requires a user ID and password.  In
>xmlrpclib, the URL format for this is:
>
>    http://userid:password@somehost:aport/...
>
>But, twisted.web.xmlrpc.Proxy does not seem to support this.
>
>So, is there a way to write a Twisted XML-RPC client that passes
>in user name and password?  And, if so, how do I do that?
>
>I've searched the documentation and done some other searches, but
>can't find this.
>
>Thanks for any help.
>
>Dave
>
>
>  
>
We wrote this at work a while back for communicating with zope xmlrpc, 
hope it helps:

"""
A slight extension to twisted.web.xmlrpc for basic auth support.

Eventually this should be cleaned up and integrated with Twisted as
general auth support for twisted.web.xmlrpc.

$Id: xmlrpc.py 1660 2005-07-15 07:14:57Z tjs $
"""
# vi:ts=4 tw=80

import base64, urlparse, xmlrpclib
from twisted.internet import reactor
from twisted.web import xmlrpc

class QueryProtocol(xmlrpc.QueryProtocol):
    def connectionMade(self):
        self.sendCommand('POST', self.factory.url)
        self.sendHeader('User-Agent', 'Twisted/XMLRPClib')
        self.sendHeader('Host', self.factory.host)
        if self.factory.authString is not None:
            cred = base64.encodestring(self.factory.authString)
            self.sendHeader('Authorization', 'Basic ' + cred[:-1])
        self.sendHeader('Content-type', 'text/xml')
        self.sendHeader('Content-length', str(len(self.factory.payload)))
        self.endHeaders()
        self.transport.write(self.factory.payload)

class QueryFactory(xmlrpc.QueryFactory):
    protocol = QueryProtocol
    def __init__(self, url, host, method, authString=None, *args):
        self.authString = authString
        xmlrpc.QueryFactory.__init__(self, url, host, method, *args)

# rape'n'paste from twisted.web.xmlrpc.Proxy.
# "#!" means modified from original.
class Proxy:
    """A Proxy for making remote XML-RPC calls.

    Pass the URL of the remote XML-RPC server to the constructor.

    Use proxy.callRemote('foobar', *args) to call remote method
    'foobar' with *args.
    """

    def __init__(self, url):
        parts = urlparse.urlparse(url)
        self.url = urlparse.urlunparse(('', '')+parts[2:])
        self.auth = None #!
        if self.url == "":
            self.url = "/"
        if ':' in parts[1]:
            #! vvv
            if '@' in parts[1]:
                self.auth, address = parts[1].split('@')
            else:
                address = parts[1]
                self.authHost = None
            self.host, self.port = address.split(':')
            if self.auth is not None:
                self.authHost = '@'.join([self.auth, self.host])
            #! ^^^
            self.port = int(self.port)
        else:
            self.host, self.port = parts[1], None
        self.secure = parts[0] == 'https'

    def callRemote(self, method, *args):
        factory = QueryFactory(self.url, self.host,
                               method, self.auth, *args) #!
        if self.secure:
            from twisted.internet import ssl
            reactor.connectSSL(self.host, self.port or 443,
                               factory, ssl.ClientContextFactory())
        else:
            reactor.connectTCP(self.host, self.port or 80, factory)
        return factory.deferred



From chris.were at gmail.com  Wed Aug 10 01:16:39 2005
From: chris.were at gmail.com (Chris (FeedTagger))
Date: Wed Aug 10 01:17:22 2005
Subject: [Twisted-web] nevow sessions and twisted.cred integration
Message-ID: <35bb4269050810001613672eae@mail.gmail.com>

Hi,

I'm working on a project with nevow and required persistent sessions
with more flexibility than was currently available. I also required
integration with twisted.cred in a similar fashion to guard.py

Unfortunately I'm on a very tight timeline so I've whipped up a quick
explanatory page here:
http://www.chriswere.com/code/nevow_sessions.html

I figure it's better for others involved in nevow to establish if any
of the code can be useful and if so address any backwards
compatability issues etc. I had initially wanted to modify guard.py to
use the new session objects, but instead wrote a similar wrapper
(sessionguard.py) that works quite similarly, but was written from
scratch.

In theory my code can stand independent of something like guard.py and
be used in the situation where more control over session's are
required, but I'm not fussed (hell if it doesn't fit at all, don't use
any of the code :)

Cheers,
Chris

From grendel at caudium.net  Wed Aug 10 03:45:45 2005
From: grendel at caudium.net (Marek Habersack)
Date: Wed Aug 10 03:46:13 2005
Subject: [Twisted-web] Enforcing SSL for non-SSL requests
In-Reply-To: <60ed19d4050809183048017fba@mail.gmail.com>
References: <20050809232657.GA5886@beowulf.thanes.org>
	<60ed19d4050809183048017fba@mail.gmail.com>
Message-ID: <20050810094544.GA4708@beowulf.thanes.org>

On Wed, Aug 10, 2005 at 11:30:42AM +1000, Christopher Armstrong scribbled:
> On 8/10/05, Marek Habersack <grendel@caudium.net> wrote:
> > Hello everybody,
> > 
> >   I'm trying to find a way for a Nevow-based application to enforce SSL
> > connection on the client when they come in using insecure HTTP. Currently
> > when the client comes in using a http://site.com URL typed in the browser,
> > they will get no error and no response from the server as the connection is
> > closed. The application log reveals the following:
> 
> 
> 
> My application started out using twisted.web.util.ChildRedirector to
> the https URL for *all* plain http requests, but then we realised we
> needed some resources to be accessible over non-HTTPS (for various
> boring reasons) we wrote our own FancyRedirectory that looked a lot
> like ChildRedirector but made exceptions for certain paths in
> getChild.
That sounds simple and logical, but I'm having trouble fitting it in my
code, so forgive my ignorance, please, and bear with me while I ask a few more
stupid and obvious questions :). My application will use very few static
resources and all the virtual ones will be handled by a single class,
MainPage, which will call down to non-twisted/nevow code for specific urls
to handle requests. The entire application is guarded with
guard.SessionWrapper and requires the user to log in to access any and all
resources. Here is the code fragment that sets this up:

realm = SCRealm()
portl = portal.Portal(realm)
sCChecker = checkers.InMemoryUsernamePasswordDatabaseDontUse()
sCChecker.addUser("test", "test")
portl.registerChecker(checkers.AllowAnonymousAccess(),credentials.IAnonymous)
portl.registerChecker(sCChecker)
root = guard.SessionWrapper(portl, "SC", useCookies=True)
application = service.Application("SC")

internet.SSLServer(8080,
                   appserver.NevowSite(root, logPath=config.web_log_path),
                   ServerContextFactory()).setServiceParent(application)

Very simple, but works well. Then the SCRealm class:

class SCRealm:
    implements(portal.IRealm)

    def prepareI18N(self, p):
        p.remember(I18NConfig(domain="sc",localeDir=config.localeDirectory), inevow.II18NConfig)
        return p
    
    def requestAvatar(self, avatarId, mind, *interfaces):
        for iface in interfaces:
            if iface is inevow.IResource:
                resc = None
                if avatarId is checkers.ANONYMOUS:
                    resc = self.prepareI18N(MainPage.MainPage())
                    logoutCallable = noLogout
                else:
                    resc = self.prepareI18N(MainPage.MainPage(avatarId))
                    logoutCallable = resc.logout
                if resc is not None:
                    resc.realm = self
                    
                return (inevow.IResource, resc, logoutCallable)
        raise NotImplementedError(_("Cannot support this interface"))

So, I suppose I could use the redirector class instead of MainPage.MainPage()
(or derive MainPage.MainPage from ChildRedirector) above, but it will still 
come after the internet.SSLServer attempts to handle the connection. What I'm 
not seeing is - how can I layout the setup code above so that I can put the 
redirector before the portal (I guess I could handle that inside the
requestAvatar method when avatarId is checkers.ANONYMOUS and do the redirect
there instead of presenting the login form) and how to handle the SSLServer's 
exception shown in the previous mail. A short code example on how to handle 
the exception would be greately appreciated ;)

I would love to avoid having to listen on two different ports to handle that, 
so the ideal thing to have would be a ConditionalSSLServer class which would start 
the SSL session if the client started the SSL handshake and would let the
programmer handle the situation when the incoming connection is a plain one.
How hard would it be to implement such a thing?

thanks a lot,

marek
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-web/attachments/20050810/91826bb8/attachment.bin
From radeex at gmail.com  Wed Aug 10 04:26:03 2005
From: radeex at gmail.com (Christopher Armstrong)
Date: Wed Aug 10 04:26:05 2005
Subject: [Twisted-web] Enforcing SSL for non-SSL requests
In-Reply-To: <20050810094544.GA4708@beowulf.thanes.org>
References: <20050809232657.GA5886@beowulf.thanes.org>
	<60ed19d4050809183048017fba@mail.gmail.com>
	<20050810094544.GA4708@beowulf.thanes.org>
Message-ID: <60ed19d40508100326509bd90f@mail.gmail.com>

On 8/10/05, Marek Habersack <grendel@caudium.net> wrote:
> I would love to avoid having to listen on two different ports to handle that,
> so the ideal thing to have would be a ConditionalSSLServer class which would start
> the SSL session if the client started the SSL handshake and would let the
> programmer handle the situation when the incoming connection is a plain one.
> How hard would it be to implement such a thing?

Listening on two different ports is exactly what you should be doing.
The http port is 80, and the https port is 443. So put the
ChildRedirector on your TCPServer on port 80, and your regular site on
an SSLServer on port 443. That way when people go to "http://foo.com/"
they can be redirected to "https://foo.com".

-- 
  Twisted   |  Christopher Armstrong: International Man of Twistery
   Radix    |    -- http://radix.twistedmatrix.com
            |  Release Manager, Twisted Project
  \\\V///   |    -- http://twistedmatrix.com
   |o O|    |  
w----v----w-+

From tv at twistedmatrix.com  Wed Aug 10 10:33:50 2005
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Wed Aug 10 10:33:59 2005
Subject: [Twisted-web] Enforcing SSL for non-SSL requests
In-Reply-To: <20050809232657.GA5886@beowulf.thanes.org>
References: <20050809232657.GA5886@beowulf.thanes.org>
Message-ID: <42FA2C6E.7050509@twistedmatrix.com>

Marek Habersack wrote:
>   I'm trying to find a way for a Nevow-based application to enforce SSL
> connection on the client when they come in using insecure HTTP. Currently
> when the client comes in using a http://site.com URL typed in the browser,
> they will get no error and no response from the server as the connection is
> closed. The application log reveals the following:

Your SSL problem has to do with trying to talk non-SSL protocols to an
SSL port, as mentioned elsewhere in this thread.

Apart from that, here's what I've done before:

class MakeSecure(object):
    __implements__ = inevow.IResource,

    def __init__(self, wrapped, port=None, *a, **kw):
        super(MakeSecure, self).__init__(*a, **kw)
        self.wrapped = wrapped
        self.port = port

    def locateChild(self, ctx, segments):
        request = inevow.IRequest(ctx)
        if request.isSecure():
            return self.wrapped, segments
        else:
            u = url.URL.fromRequest(request)
            for seg in segments:
                u = u.child(seg)
            return u.secure(port=self.port), ()

    def renderHTTP(self, ctx):
        request = inevow.IRequest(ctx)
        if request.isSecure():
            return self.wrapped.renderHTTP(ctx)
        else:
            u = url.URL.fromRequest(request)
            u = u.secure(port=self.port)
            return inevow.IResource(u).renderHTTP(ctx)

for that, svn co http://divmod.org/svn/Nevow/sandbox/tv and see the
makesecure subdirectory.

You may also be interested in the branchsecure directory.


From grendel at caudium.net  Wed Aug 10 13:19:52 2005
From: grendel at caudium.net (Marek Habersack)
Date: Wed Aug 10 13:20:19 2005
Subject: [Twisted-web] Enforcing SSL for non-SSL requests
In-Reply-To: <42FA2C6E.7050509@twistedmatrix.com>
References: <20050809232657.GA5886@beowulf.thanes.org>
	<42FA2C6E.7050509@twistedmatrix.com>
Message-ID: <20050810191952.GA3896@beowulf.thanes.org>

On Wed, Aug 10, 2005 at 07:33:50PM +0300, Tommi Virtanen scribbled:
> Marek Habersack wrote:
> >   I'm trying to find a way for a Nevow-based application to enforce SSL
> > connection on the client when they come in using insecure HTTP. Currently
> > when the client comes in using a http://site.com URL typed in the browser,
> > they will get no error and no response from the server as the connection is
> > closed. The application log reveals the following:
> 
> Your SSL problem has to do with trying to talk non-SSL protocols to an
> SSL port, as mentioned elsewhere in this thread.
Yes, I know, the client isn't starting the SSL handshake when it is expected
to - the real question was how to work around it using a single port (my 
client's requirement), but it seems I will have to use the standard two-port 
approach here.

> Apart from that, here's what I've done before:
> 
> class MakeSecure(object):
>     __implements__ = inevow.IResource,
> 
>     def __init__(self, wrapped, port=None, *a, **kw):
>         super(MakeSecure, self).__init__(*a, **kw)
>         self.wrapped = wrapped
>         self.port = port
> 
>     def locateChild(self, ctx, segments):
>         request = inevow.IRequest(ctx)
>         if request.isSecure():
>             return self.wrapped, segments
>         else:
>             u = url.URL.fromRequest(request)
>             for seg in segments:
>                 u = u.child(seg)
>             return u.secure(port=self.port), ()
> 
>     def renderHTTP(self, ctx):
>         request = inevow.IRequest(ctx)
>         if request.isSecure():
>             return self.wrapped.renderHTTP(ctx)
>         else:
>             u = url.URL.fromRequest(request)
>             u = u.secure(port=self.port)
>             return inevow.IResource(u).renderHTTP(ctx)
> 
> for that, svn co http://divmod.org/svn/Nevow/sandbox/tv and see the
> makesecure subdirectory.
> 
> You may also be interested in the branchsecure directory.
Thanks a million, I think this will do the trick :)

best regards,

marek
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-web/attachments/20050810/5fe59c34/attachment.bin
From db3l at fitlinxx.com  Wed Aug 10 17:37:38 2005
From: db3l at fitlinxx.com (David Bolen)
Date: Wed Aug 10 17:38:48 2005
Subject: [Twisted-web] nevow and twisted.web2
Message-ID: <uvf2dfjnh.fsf@fitlinxx.com>

To this point for our in house projects, we've still been using
twisted.web and doing our own rendering with ZPT for templating (e.g.,
not using nevow).  I'm looking to try nevow (which wasn't around when
we started the other projects) for an experimental project, but am
also looking to utilize twisted.web2 so I can take advantage of some
of its newer features as well.

Is that combination possible?  I haven't been following the
relationship between nevow and twisted.web2, but it would appear that
nevow still uses its own system layered on twisted.web2. I see both a
web2 and web2-2 tree in SVN for nevow, so do I still need to use one
of them (and are they relatively up to date with the trunk)?

Thanks.

-- David


From dkuhlman at cutter.rexx.com  Wed Aug 10 17:41:25 2005
From: dkuhlman at cutter.rexx.com (Dave Kuhlman)
Date: Wed Aug 10 17:41:28 2005
Subject: [Twisted-web] twisted.web.xmlrpc.Proxy plus user and password
In-Reply-To: <42F96700.5040207@nunatak.com.au>
References: <20050809220057.GA15539@cutter.rexx.com>
	<42F96700.5040207@nunatak.com.au>
Message-ID: <20050810234125.GA35284@cutter.rexx.com>

On Wed, Aug 10, 2005 at 12:31:28PM +1000, Timothy Stebbing wrote:
> Dave Kuhlman wrote:
> 
> >I'm trying to write an XML-RPC client that will send requests to
> >an XML-RPC server which requires a user ID and password.  In
> >xmlrpclib, the URL format for this is:
> >
> >   http://userid:password@somehost:aport/...
> >
> >But, twisted.web.xmlrpc.Proxy does not seem to support this.
> >
> >So, is there a way to write a Twisted XML-RPC client that passes
> >in user name and password?  And, if so, how do I do that?
> >
> >I've searched the documentation and done some other searches, but
> >can't find this.
> >
> >Thanks for any help.
> >
> >Dave
> >
> We wrote this at work a while back for communicating with zope xmlrpc, 
> hope it helps:
> 

Timothy -

Thanks.  This is great.  It's just what I needed.

And, I definitely vote that this capability (to authenticate with
the XML-RPC server using user name and password) be added
to twisted/web/xmlrpc.py in the TwistedWeb distribution.

And, FYI, I'm also communicating with Zope.  Actually, I'm making
XML-RPC calls to CPS, which is a CMS built on top of Zope.  CPS
exposes some document management functions through XML-RPC.

I'm writing a document on how to use the XML-RPC interface exposed
by CPS.  In addition to code samples of clients implemented with
xmlrpclib, I also wanted to provide an example of a client
implemented with Twisted, which is why I wanted to be able to
write the Twisted XML-RPC client.

You can find my document here:

    http://www.rexx.com/~dkuhlman/cps_remote_controller.html

Thanks again.

Dave

[snip]


-- 
Dave Kuhlman
http://www.rexx.com/~dkuhlman

From tv at twistedmatrix.com  Wed Aug 10 22:31:55 2005
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Wed Aug 10 22:32:08 2005
Subject: [Twisted-web] Enforcing SSL for non-SSL requests
In-Reply-To: <20050810191952.GA3896@beowulf.thanes.org>
References: <20050809232657.GA5886@beowulf.thanes.org>
	<42FA2C6E.7050509@twistedmatrix.com>
	<20050810191952.GA3896@beowulf.thanes.org>
Message-ID: <42FAD4BB.2010604@twistedmatrix.com>

Marek Habersack wrote:
>>Your SSL problem has to do with trying to talk non-SSL protocols to an
>>SSL port, as mentioned elsewhere in this thread.
> 
> Yes, I know, the client isn't starting the SSL handshake when it is expected
> to - the real question was how to work around it using a single port (my 
> client's requirement), but it seems I will have to use the standard two-port 
> approach here.

For HTTP, you can't do it (cleanly).

For SMTP, IMAP, POP, LDAP, etc., use STARTTLS.

For your own protocol, add a STARTTLS feature to the protocol.

From grendel at caudium.net  Thu Aug 11 04:01:31 2005
From: grendel at caudium.net (Marek Habersack)
Date: Thu Aug 11 04:01:37 2005
Subject: [Twisted-web] Enforcing SSL for non-SSL requests
In-Reply-To: <42FAD4BB.2010604@twistedmatrix.com>
References: <20050809232657.GA5886@beowulf.thanes.org>
	<42FA2C6E.7050509@twistedmatrix.com>
	<20050810191952.GA3896@beowulf.thanes.org>
	<42FAD4BB.2010604@twistedmatrix.com>
Message-ID: <20050811100131.GB6013@beowulf.thanes.org>

On Thu, Aug 11, 2005 at 07:31:55AM +0300, Tommi Virtanen scribbled:
> Marek Habersack wrote:
> >>Your SSL problem has to do with trying to talk non-SSL protocols to an
> >>SSL port, as mentioned elsewhere in this thread.
> > 
> > Yes, I know, the client isn't starting the SSL handshake when it is expected
> > to - the real question was how to work around it using a single port (my 
> > client's requirement), but it seems I will have to use the standard two-port 
> > approach here.
> 
> For HTTP, you can't do it (cleanly).
yeah, I know... the problem was that the client of mine saw that done under
IIS (I believe) and he wanted to have the same feature, but I guess I'll
convince them that it's a bad idea.

thanks for your help, best regards

marek
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-web/attachments/20050811/9d782d8a/attachment.bin
From agross at irobot.com  Thu Aug 11 07:35:09 2005
From: agross at irobot.com (Gross, Ashley)
Date: Thu Aug 11 07:39:05 2005
Subject: [Twisted-web] form submission issues
Message-ID: <712A2DEC228C7448978CBD7A7AD5B0900220EDA6@fever.wardrobe.irobot.com>

Good morning,
I'm currently having a problem with formless.  I've created a form on the site http://localhost/config, but when I submit the form, the post is called on http://localhost.  Is this the way it's supposed to behave?  How do I get it to maintain its current url?

Thanks,
Ashley
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/ms-tnef
Size: 2483 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-web/attachments/20050811/b3b757d0/attachment.bin
From dcf at europe.renre.com  Thu Aug 11 08:02:24 2005
From: dcf at europe.renre.com (Duncan Foster)
Date: Thu Aug 11 08:10:42 2005
Subject: [Twisted-web] SOAP over SSL
Message-ID: <42FB5A70.20506@europe.renre.com>

hey all,
This is my first post to this list so play nice :-)

I want to use SSL, providing a client cert, to access a SOAP webservice. 
Looking at the code in twisted/web/soap.py and client.py  it seems that 
while the client getPage method can take a contextFactory arg, there's 
no way to pass this in from the soap.Proxy. Is this an oversight? Should 
I simply copy and modify the code from soap.py??

Thanks,
D


From dialtone at divmod.com  Thu Aug 11 10:12:41 2005
From: dialtone at divmod.com (Valentino Volonghi aka Dialtone)
Date: Thu Aug 11 10:12:46 2005
Subject: [Twisted-web] nevow and twisted.web2
In-Reply-To: <uvf2dfjnh.fsf@fitlinxx.com>
References: <uvf2dfjnh.fsf@fitlinxx.com>
Message-ID: <42FB78F9.7050301@divmod.com>

David Bolen wrote:

>To this point for our in house projects, we've still been using
>twisted.web and doing our own rendering with ZPT for templating (e.g.,
>not using nevow).  I'm looking to try nevow (which wasn't around when
>we started the other projects) for an experimental project, but am
>also looking to utilize twisted.web2 so I can take advantage of some
>of its newer features as well.
>
>Is that combination possible?  I haven't been following the
>relationship between nevow and twisted.web2, but it would appear that
>nevow still uses its own system layered on twisted.web2. I see both a
>web2 and web2-2 tree in SVN for nevow, so do I still need to use one
>of them (and are they relatively up to date with the trunk)?
>  
>
The web2 branch in my branches subdirectory kida works with web2. It
needs testing and
some more hacking to work with formless but everything else should be
working fine.

Get it, test it, patch it :)

After the next nevow release we will be working on moving it to web2.

-- 
Valentino Volonghi aka Dialtone
Now Running MacOSX 10.4.1
Blog: http://vvolonghi.blogspot.com
http://weever.berlios.de


From wsanchez at wsanchez.net  Fri Aug 12 16:05:46 2005
From: wsanchez at wsanchez.net (=?ISO-8859-1?Q?Wilfredo_S=E1nchez_Vega?=)
Date: Fri Aug 12 16:06:23 2005
Subject: [Twisted-web] [PATCH] Unquote URI when converting to filesystem path
Message-ID: <5434569B-2C5D-4828-B7A6-35925B916304@wsanchez.net>

   The following patch fixes web2 to unquote a path string derived  
from a request URI before sticking into a filesystem path.   
Otherwise, URIs like "/foo%20bar" don't get properly translated to "/ 
foo bar".

     -wsv


Index: twisted/web2/static.py
===================================================================
--- twisted/web2/static.py      (revision 14235)
+++ twisted/web2/static.py      (working copy)
@@ -6,7 +6,7 @@
"""
# System Imports
-import os, time, stat
+import os, time, stat, urllib
# Sibling Imports
from twisted.web2 import http_headers, resource
@@ -177,7 +177,7 @@
              return None, ()
          if path:
-            fpath = self.fp.child(path)
+            fpath = self.fp.child(urllib.unquote(path))
          else:
              fpath = self.fp.childSearchPreauth(*self.indexNames)
              if fpath is None:


-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 3057 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-web/attachments/20050812/39976be5/smime.bin
From jonathan.lange at gmail.com  Mon Aug 15 07:14:21 2005
From: jonathan.lange at gmail.com (Jonathan Lange)
Date: Mon Aug 15 07:15:21 2005
Subject: [Twisted-web] PATCH: Make nevow.URL.__str__ return a string
Message-ID: <d06a5cd305081506144b019c21@mail.gmail.com>

I said, wtf
exarkun said, patches accepted
unit tests said, sure, why not
radix said, mail it to twisted-web
-------------- next part --------------
A non-text attachment was scrubbed...
Name: nevow.url.patch
Type: application/octet-stream
Size: 358 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-web/attachments/20050815/7ec26465/nevow.url.obj
From JRBoverhof at lbl.gov  Tue Aug 16 23:43:31 2005
From: JRBoverhof at lbl.gov (Joshua Boverhof)
Date: Tue Aug 16 23:44:07 2005
Subject: [Twisted-web] Garbage SSL application data
Message-ID: <4302CE83.40200@lbl.gov>

I'm using the twisted.web.getPage for https, but for some reason garbage 
application data is preceeding the data I'm specifying (it completes the 
handshake).   This is causing a java server to bomb because it is 
expecting a POST or GET command:  It does a readLine, gets nothing and 
throws an IOException. 

A twisted.web server digests the message w/o problem, apparently it's 
ignoring the garbage bytes (which change w/each invocation).

I'm also getting a few failures w/ "twisted.test.test_ssl".  I'm 
interpretting the error message below "startTLS doesn't empty buffer 
before starting TLS. :(" as the cause of my problem...

I'm seeing this behavior w/clients running on a Tiger laptop and a Linux 
box w/the following packages:

    Twisted-2.0
    TwistedWeb-0.5
    pyOpenSSL-0.6/openssl-0.9.7

thanks,
-josh

Code

    f = client.getPage(url,
            contextFactory=None,
            postdata=DATA,
            agent=agent,
            method=method,
            headers=headers)


SSLDump after handshake

    ---------------------------------------------------------------
2 13 0.6668 (0.0629)  C>SV3.0(24)  application_data
    ---------------------------------------------------------------
application_data(23)/major(3)/minor(0)/length(24)

17 03 00 00 18
        a7 f3 45 ee 7b e1 19 d6 0c 0f fa 7a 9d a4 eb 98 ce 84 7f e3 1e 
a1 cc 70
        GARBAGE


    ---------------------------------------------------------------
2 14 0.6668 (0.0000)  C>SV3.0(1224)  application_data
    ---------------------------------------------------------------
application_data(23)/major(3)/minor(0)/length(1224)

17 03 00 04 c8
        50 4f 53 54 20 2f 77 73 72 66 2f  .....
        P  O  S  T     /  w  s  r  f  /   .....



bundy:~/Desktop/Python/Twisted-2.0.0/bin boverhof$ ./trial 
twisted.test.test_ssl
....
....

[TODO]: testTLS (twisted.test.test_ssl.SpammyTLSTestCase)

startTLS doesn't empty buffer before starting TLS. :(


  File 
"/Users/boverhof/Desktop/Python/Twisted-2.0.0/twisted/internet/defer.py", 
line 117, in maybeDeferred
    result = f(*args, **kw)
  File 
"/Users/boverhof/Desktop/Python/Twisted-2.0.0/twisted/test/test_ssl.py", 
line 285, in testTLS
    TLSTestCase.testTLS(self)
  File 
"/Users/boverhof/Desktop/Python/Twisted-2.0.0/twisted/test/test_ssl.py", 
line 225, in testTLS
    UnintelligentProtocol.pretext + UnintelligentProtocol.posttext
  File 
"/Users/boverhof/Desktop/Python/Twisted-2.0.0/twisted/trial/unittest.py", 
line 415, in <lambda>
    failUnlessEqual = lambda self, a, b, msg=None: failUnlessEqual(a, b, 
msg)
  File 
"/Users/boverhof/Desktop/Python/Twisted-2.0.0/twisted/trial/assertions.py", 
line 77, in failUnlessEqual
    raise FailTest, (msg or '%r != %r' % (first, second))
twisted.trial.assertions.FailTest: ['first line', 'last thing before tls 
starts', 'STARTTLS'] != ['first line', 'last thing before tls starts', 
'STARTTLS', 'first thing after tls started', 'last thing ever']
-------------------------------------------------------------------------------
Ran 10 tests in 5.512s

PASSED (expectedFailures=3, successes=7)

From grendel at caudium.net  Wed Aug 17 08:17:08 2005
From: grendel at caudium.net (Marek Habersack)
Date: Wed Aug 17 08:17:27 2005
Subject: [Twisted-web] Dynamic SSL context
Message-ID: <20050817141708.GB4644@beowulf.thanes.org>

Hello,

  I am wondering, is it possible with Twisted to delay creating the SSL
context till the connection time? I would need something like that to
support virtual hosts on the same interface:port with different SSL certs.

tia,

marek
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-web/attachments/20050817/0fdfd0a9/attachment.bin
From exarkun at divmod.com  Wed Aug 17 22:50:05 2005
From: exarkun at divmod.com (Jp Calderone)
Date: Wed Aug 17 22:50:08 2005
Subject: [Twisted-web] Dynamic SSL context
In-Reply-To: <20050817141708.GB4644@beowulf.thanes.org>
Message-ID: <20050818045005.3914.1866057051.divmod.quotient.5638@ohm>

On Wed, 17 Aug 2005 16:17:08 +0200, Marek Habersack <grendel@caudium.net> wrote:
>Hello,
>
>  I am wondering, is it possible with Twisted to delay creating the SSL
>context till the connection time? I would need something like that to
>support virtual hosts on the same interface:port with different SSL certs.

Connection time is too early.  You have to wait until you get the "Host" header to know which cert to pick for a vhosting server.  And by then, it's too late!  HTTP doesn't include a provision for negotiating transport layer security.  Either you use SSL for everything or you use SSL for nothing.

There are some experiments that add STARTTLS-like functionality to HTTP, but as far as I know, none are widely (>0.1% of clients) supported.

Jp

From tv at twistedmatrix.com  Wed Aug 17 23:54:55 2005
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Wed Aug 17 23:55:06 2005
Subject: [Twisted-web] Garbage SSL application data
In-Reply-To: <4302CE83.40200@lbl.gov>
References: <4302CE83.40200@lbl.gov>
Message-ID: <430422AF.5020507@twistedmatrix.com>

Joshua Boverhof wrote:
> I'm using the twisted.web.getPage for https, but for some reason garbage
> application data is preceeding the data I'm specifying (it completes the
> handshake).   This is causing a java server to bomb because it is
> expecting a POST or GET command:  It does a readLine, gets nothing and
> throws an IOException.
> A twisted.web server digests the message w/o problem, apparently it's
> ignoring the garbage bytes (which change w/each invocation).

Hearing that "twisted parses this ok, my custom HTTP implementation
doesn't" always makes me suspicious. Maybe you should try dropping the
SSL, just to see how things behave without it.

> I'm also getting a few failures w/ "twisted.test.test_ssl".  I'm
> interpretting the error message below "startTLS doesn't empty buffer
> before starting TLS. :(" as the cause of my problem...

HTTP doesn't use STARTTLS.

From tv at twistedmatrix.com  Wed Aug 17 23:56:39 2005
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Wed Aug 17 23:56:46 2005
Subject: [Twisted-web] Dynamic SSL context
In-Reply-To: <20050818045005.3914.1866057051.divmod.quotient.5638@ohm>
References: <20050818045005.3914.1866057051.divmod.quotient.5638@ohm>
Message-ID: <43042317.7030209@twistedmatrix.com>

Jp Calderone wrote:
> There are some experiments that add STARTTLS-like functionality to HTTP,
> but as far as I know, none are widely (>0.1% of clients) supported.

Also, there's been talk of adding the equivalent of a Host: header to
TLS.

In the real world, one IP+port just doesn't serve with multiple
certificates.

From JRBoverhof at lbl.gov  Thu Aug 18 01:51:24 2005
From: JRBoverhof at lbl.gov (Joshua Boverhof)
Date: Thu Aug 18 01:51:59 2005
Subject: [Twisted-web] Garbage SSL application data
In-Reply-To: <430422AF.5020507@twistedmatrix.com>
References: <4302CE83.40200@lbl.gov> <430422AF.5020507@twistedmatrix.com>
Message-ID: <43043DFC.30408@lbl.gov>

Tommi Virtanen wrote:

>Joshua Boverhof wrote:
>  
>
>>I'm using the twisted.web.getPage for https, but for some reason garbage
>>application data is preceeding the data I'm specifying (it completes the
>>handshake).   This is causing a java server to bomb because it is
>>expecting a POST or GET command:  It does a readLine, gets nothing and
>>throws an IOException.
>>A twisted.web server digests the message w/o problem, apparently it's
>>ignoring the garbage bytes (which change w/each invocation).
>>    
>>
>
>Hearing that "twisted parses this ok, my custom HTTP implementation
>doesn't" always makes me suspicious. Maybe you should try dropping the
>SSL, just to see how things behave without it.
>  
>

that works just fine.  I'm only having a problem w/HTTPS via 
twisted.web.client.  I can use httplib.HTTPSConnection just fine, it 
doesn't have the "garbage" ssl application data.

It's a globus-4.0.1 SOAP Axis server, not my custom HTTP implementation, 
that is having trouble with twisted.web.client


>>I'm also getting a few failures w/ "twisted.test.test_ssl".  I'm
>>interpretting the error message below "startTLS doesn't empty buffer
>>before starting TLS. :(" as the cause of my problem...
>>    
>>
>
>HTTP doesn't use STARTTLS.
>  
>
I figure if there are problems w/ test_ssl it's probably got something 
to do w/my problem...
-josh





From tv at twistedmatrix.com  Thu Aug 18 02:08:13 2005
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Thu Aug 18 02:08:18 2005
Subject: [Twisted-web] Garbage SSL application data
In-Reply-To: <43043DFC.30408@lbl.gov>
References: <4302CE83.40200@lbl.gov> <430422AF.5020507@twistedmatrix.com>
	<43043DFC.30408@lbl.gov>
Message-ID: <430441ED.5050001@twistedmatrix.com>

Joshua Boverhof wrote:
> that works just fine.  I'm only having a problem w/HTTPS via
> twisted.web.client.  I can use httplib.HTTPSConnection just fine, it
> doesn't have the "garbage" ssl application data.

Make the server end be "openssl s_server -accept 443 -www ...", see
what that tells you.

>>> I'm also getting a few failures w/ "twisted.test.test_ssl".  I'm
>>> interpretting the error message below "startTLS doesn't empty buffer
>>> before starting TLS. :(" as the cause of my problem...
>> HTTP doesn't use STARTTLS.
> I figure if there are problems w/ test_ssl it's probably got something
> to do w/my problem...

As far as I understand, the failing test covers _only_ this case:

there is outgoing data in a buffer
twisted is told to use starttls
it switches to TLS immediately, including the data in the buffer

For non-STARTTLS protocols, TLS is used from the very beginning, so
there really can't be anything in the buffer.

From grendel at caudium.net  Thu Aug 18 02:08:18 2005
From: grendel at caudium.net (Marek Habersack)
Date: Thu Aug 18 02:08:35 2005
Subject: [Twisted-web] Dynamic SSL context
In-Reply-To: <20050818045005.3914.1866057051.divmod.quotient.5638@ohm>
References: <20050817141708.GB4644@beowulf.thanes.org>
	<20050818045005.3914.1866057051.divmod.quotient.5638@ohm>
Message-ID: <20050818080818.GA4024@beowulf.thanes.org>

On Thu, Aug 18, 2005 at 12:50:05AM -0400, Jp Calderone scribbled:
> On Wed, 17 Aug 2005 16:17:08 +0200, Marek Habersack <grendel@caudium.net> 
> wrote:
> >Hello,
> >
> > I am wondering, is it possible with Twisted to delay creating the SSL
> >context till the connection time? I would need something like that to
> >support virtual hosts on the same interface:port with different SSL certs.
> 
> Connection time is too early.  You have to wait until you get the "Host" 
> header to know which cert to pick for a vhosting server.  And by then, it's 
That's true, haven't thought about it

> too late!  HTTP doesn't include a provision for negotiating transport layer 
> security.  Either you use SSL for everything or you use SSL for nothing.
> 
> There are some experiments that add STARTTLS-like functionality to HTTP, 
> but as far as I know, none are widely (>0.1% of clients) supported.
I guess that's what I was thinking about, didn't know it was that
uncommon yet. Is the STARTTLS-like thingie being standarized/is a standard?

thanks,

marek

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://twistedmatrix.com/pipermail/twisted-web/attachments/20050818/520b46cc/attachment.bin
From fritcher at corp.earthlink.net  Thu Aug 18 12:10:08 2005
From: fritcher at corp.earthlink.net (Jason Fritcher)
Date: Thu Aug 18 12:10:14 2005
Subject: [Twisted-web] Dynamic SSL context
In-Reply-To: <20050818045005.3914.1866057051.divmod.quotient.5638@ohm>
References: <20050818045005.3914.1866057051.divmod.quotient.5638@ohm>
Message-ID: <4304CF00.4030603@corp.earthlink.net>

Jp Calderone wrote:
> There are some experiments that add STARTTLS-like functionality to HTTP,
> but as far as I know, none are widely (>0.1% of clients) supported.

Apache 2.1/2 is implementing RFC 2817, Upgrading to TLS Within HTTP/1.1.
So atleast there is a standard for doing so now.

-- 
Jason Fritcher
Software Engineer
Core Infrastructure Services & Strategy
Earthlink, Inc
fritcher@corp.earthlink.net
(404) 748-7262, x22262
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 253 bytes
Desc: OpenPGP digital signature
Url : http://twistedmatrix.com/pipermail/twisted-web/attachments/20050818/5efbe271/signature.bin
From foom at fuhm.net  Thu Aug 18 22:43:22 2005
From: foom at fuhm.net (James Y Knight)
Date: Thu Aug 18 22:43:34 2005
Subject: [Twisted-web] Dynamic SSL context
In-Reply-To: <4304CF00.4030603@corp.earthlink.net>
References: <20050818045005.3914.1866057051.divmod.quotient.5638@ohm>
	<4304CF00.4030603@corp.earthlink.net>
Message-ID: <1ADC415A-49DC-40A9-9AB9-519B8C522BD3@fuhm.net>

On Aug 18, 2005, at 2:10 PM, Jason Fritcher wrote:
> Jp Calderone wrote:
>
>> There are some experiments that add STARTTLS-like functionality to  
>> HTTP,
>> but as far as I know, none are widely (>0.1% of clients) supported.
>>
>
> Apache 2.1/2 is implementing RFC 2817, Upgrading to TLS Within HTTP/ 
> 1.1.
> So atleast there is a standard for doing so now.

Ugh. That standard has been around for a while now. However, it's  
broken and will never be implemented in browsers. I hope. Cause, even  
if it is, it's completely broken in the face of proxies. I'm  
surprised apache bothered to implement it.
See also the thread <http://jis.mit.edu/pipermail/saag/ 
2001q4/000253.html>

Especially also this message: <http://jis.mit.edu/pipermail/saag/ 
2001q4/000265.html>

Ah, I see in the bug report requesting the behavior the original for  
apache they say they just committed it because they were going to  
change other things and didn't want to lose the patch (but I can't  
imagine why not, really...) <http://issues.apache.org/bugzilla/ 
show_bug.cgi?id=14703>

James

From alberto.trujillo at ucd.ie  Fri Aug 19 05:14:07 2005
From: alberto.trujillo at ucd.ie (Alberto Trujillo)
Date: Fri Aug 19 05:10:02 2005
Subject: [Twisted-web] Getting URL
Message-ID: <4305BEFF.9010201@ucd.ie>

Could anybody help me with this piece of code. I would like to add to 
the url the information that is placed in the line "50", but looks not 
possible. The url shoul be like the url in the line "51".

    def data_header(self, ctx, data):
        """return the content for the head of the template"""
        http_equiv = ''
        content = ''
        self.loginOK = False
        myform = ctx.arg('form')
        if (myform == 'login') and (self.executeLogin(ctx)):
            self.loginOk = True
            http_equiv = 'refresh'
            href = url.here.curdir()
            href = href.add('content', 'home')
50        #content = '3;URL=' + href
51         content = '2;URL=http://localhost:8088/'
        return {'http_equiv':http_equiv, 'content':content}

Another question.
While I'm processing the call from an url, is possible to change the 
values from the arguments? I mean, in this example I have a template 
that calls to different fragments (header, navigation, content, footer), 
the data_header method inside the template is the first one in the 
calls. Could I change here the value of one argumentin such a way that 
when the data_content method inside the template is called, this one 
receives the new value.

Thank you very much

From fritcher at corp.earthlink.net  Fri Aug 19 11:10:23 2005
From: fritcher at corp.earthlink.net (Jason Fritcher)
Date: Fri Aug 19 11:10:29 2005
Subject: [Twisted-web] Dynamic SSL context
In-Reply-To: <1ADC415A-49DC-40A9-9AB9-519B8C522BD3@fuhm.net>
References: <20050818045005.3914.1866057051.divmod.quotient.5638@ohm>	<4304CF00.4030603@corp.earthlink.net>
	<1ADC415A-49DC-40A9-9AB9-519B8C522BD3@fuhm.net>
Message-ID: <4306127F.2020307@corp.earthlink.net>

James Y Knight wrote:
> Ugh. That standard has been around for a while now. However, it's 
> broken and will never be implemented in browsers. I hope. Cause, even 
> if it is, it's completely broken in the face of proxies. I'm  surprised
> apache bothered to implement it.

Thanks for the links, they were rather interesting. I don't work with
proxies much, so I didn't think of the brokeness regarding them.

-- 
Jason Fritcher
Software Engineer
Core Infrastructure Services & Strategy
Earthlink, Inc
fritcher@corp.earthlink.net
(404) 748-7262, x22262
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 253 bytes
Desc: OpenPGP digital signature
Url : http://twistedmatrix.com/pipermail/twisted-web/attachments/20050819/109d4893/signature.bin
From psanchez at nortel.com  Fri Aug 19 17:14:34 2005
From: psanchez at nortel.com (Pedro Sanchez)
Date: Fri Aug 19 17:12:30 2005
Subject: [Twisted-web] On Flatteners and Adapters
Message-ID: <1124493274.22514.29.camel@pcard0ze.ca.nortel.com>

Hello,

I'm trying to implement a menu with the attached code, but it fails with
the following error:

exceptions.NotImplementedError: There is no flattener function
registered for object <Menu object at 0xb76dd42c> of type <class
'Menu'>.

Locals
flattener
None
obj
<Menu object at 0xb76dd42c>
context
WovenContext(tag=Tag('li',
children=[<Menu object at
0xb76dd42c>]))


I'm using http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/286260
as a reference for this sample implementation. The idea is to define two
objects, Menu and MenuItem, and then to define and to register adapters
for each object type.

I don't understand why it complains about flatteners not defined. Isn't
that covered by the registered adapters? I'd appreciate any help.

Thank you,

-- 
Pedro

PS. I test the program running:

$ twistd -noy menu.py


-------------- next part --------------
A non-text attachment was scrubbed...
Name: menu.py
Type: text/x-python
Size: 1791 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-web/attachments/20050819/db8e7765/menu.py
From indigo at bitglue.com  Fri Aug 19 17:29:19 2005
From: indigo at bitglue.com (Phil Frost)
Date: Fri Aug 19 17:29:20 2005
Subject: [Twisted-web] On Flatteners and Adapters
In-Reply-To: <1124493274.22514.29.camel@pcard0ze.ca.nortel.com>
References: <1124493274.22514.29.camel@pcard0ze.ca.nortel.com>
Message-ID: <20050819232919.GA10371@unununium.org>

On Fri, Aug 19, 2005 at 07:14:34PM -0400, Pedro Sanchez wrote:
> Hello,
> 
> I'm trying to implement a menu with the attached code, but it fails with
> the following error:
> 
> exceptions.NotImplementedError: There is no flattener function
> registered for object <Menu object at 0xb76dd42c> of type <class
> 'Menu'>.
> 
> ...
> 
> I don't understand why it complains about flatteners not defined. Isn't
> that covered by the registered adapters? I'd appreciate any help.
> 
> Thank you,
> 
> -- 
> Pedro

It used to work like that. A while ago, a change was made to how
flatteners are registered; nevow.flat.registerFlattener is the new way
to do it:

from nevow import flat

class Bleh(object):
    pass

def flattenBleh(original, context):
    return 'a bleh thing'

flat.registerFlattener(flattenBleh, Bleh)

From psanchez at nortel.com  Sat Aug 20 06:37:44 2005
From: psanchez at nortel.com (Pedro Sanchez)
Date: Sat Aug 20 06:39:07 2005
Subject: [Twisted-web] On Flatteners and Adapters
In-Reply-To: <20050819232919.GA10371@unununium.org>
References: <1124493274.22514.29.camel@pcard0ze.ca.nortel.com>
	<20050819232919.GA10371@unununium.org>
Message-ID: <43072418.1090104@nortelnetworks.com>



Phil Frost wrote:
> On Fri, Aug 19, 2005 at 07:14:34PM -0400, Pedro Sanchez wrote:
> 
>>Hello,
>>
>>I'm trying to implement a menu with the attached code, but it fails with
>>the following error:
>>
>>exceptions.NotImplementedError: There is no flattener function
>>registered for object <Menu object at 0xb76dd42c> of type <class
>>'Menu'>.
>>
>>...
>>
>>I don't understand why it complains about flatteners not defined. Isn't
>>that covered by the registered adapters? I'd appreciate any help.
>>
>>Thank you,
>>
>>-- 
>>Pedro
> 
> 
> It used to work like that. A while ago, a change was made to how
> flatteners are registered; nevow.flat.registerFlattener is the new way
> to do it:
> 
> from nevow import flat
> 
> class Bleh(object):
>     pass
> 
> def flattenBleh(original, context):
>     return 'a bleh thing'
> 
> flat.registerFlattener(flattenBleh, Bleh)
> 

Thanks,

I will check this. However, the recipe in the Python cookbook website 
works well and it doesn't use the interface you mention. So my code 
should in theory work, provided I fix whatever is broken :)

-- 
Pedro

> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
> 

From psanchez at nortel.com  Sat Aug 20 07:10:44 2005
From: psanchez at nortel.com (Pedro Sanchez)
Date: Sat Aug 20 07:11:24 2005
Subject: [Twisted-web] On Flatteners and Adapters
In-Reply-To: <43072418.1090104@nortelnetworks.com>
References: <1124493274.22514.29.camel@pcard0ze.ca.nortel.com>	<20050819232919.GA10371@unununium.org>
	<43072418.1090104@nortelnetworks.com>
Message-ID: <43072BD4.7010701@nortelnetworks.com>

The original version of my program registers Adapters and fails because 
of flatteners. Following your suggestion, here is a version registering 
flatteners instead. And it fails because of Adapters :|

twisted.python.components.CannotAdapt: <Menu object at 0xb77581ec> to 
<MetaInterface nevow.inevow.IRenderer>

I'd appreciate any suggestions.

Thanks,

-- 
Pedro



Sanchez, Pedro [CAR:1A10:EXCH] wrote:
> 
> 
> Phil Frost wrote:
> 
>> On Fri, Aug 19, 2005 at 07:14:34PM -0400, Pedro Sanchez wrote:
>>
>>> Hello,
>>>
>>> I'm trying to implement a menu with the attached code, but it fails with
>>> the following error:
>>>
>>> exceptions.NotImplementedError: There is no flattener function
>>> registered for object <Menu object at 0xb76dd42c> of type <class
>>> 'Menu'>.
>>>
>>> ...
>>>
>>> I don't understand why it complains about flatteners not defined. Isn't
>>> that covered by the registered adapters? I'd appreciate any help.
>>>
>>> Thank you,
>>>
>>> -- 
>>> Pedro
>>
>>
>>
>> It used to work like that. A while ago, a change was made to how
>> flatteners are registered; nevow.flat.registerFlattener is the new way
>> to do it:
>>
>> from nevow import flat
>>
>> class Bleh(object):
>>     pass
>>
>> def flattenBleh(original, context):
>>     return 'a bleh thing'
>>
>> flat.registerFlattener(flattenBleh, Bleh)
>>
> 
> Thanks,
> 
> I will check this. However, the recipe in the Python cookbook website 
> works well and it doesn't use the interface you mention. So my code 
> should in theory work, provided I fix whatever is broken :)
> 
-------------- next part --------------
from twisted.application import internet, service
from nevow import appserver, inevow, rend, compy, loaders, url
from nevow import tags as T
from nevow import flat

class Menu(object):
    def __init__(self, title, *items):
        self.title = title
        self.items = items

class MenuItem(object):
    def __init__(self, title, target):
        self.title = title
        self.target = target

def MenuView(original, context):
    return T.div[
        T.p[original.title],
        T.ul[[T.li[x] for x in original.items]]
        ]

def MenuItemView(original, context):
    return T.a(href=original.title)[original.target]

flat.registerFlattener(MenuView, Menu)
flat.registerFlattener(MenuItemView, MenuItem)

# some data
menu = Menu('Main Menu',
            Menu('Item 1',
                 MenuItem('1-1', url.root.child('oneone')),
                 MenuItem('1-2', url.root.child('onetwo')),
                 ),
            MenuItem('2', url.root.child('two')),
            MenuItem('3', url.root.child('three'))
            )


class Page(rend.Page):
    def render_menu(self, context, data):
        return inevow.IRenderer(data)

    def data_menu(self, context, data):
        return menu

    docFactory = loaders.stan(
    T.html[
        T.body[
            T.invisible(render=T.directive('menu'), data=T.directive('menu'))
        ]
    ])

site = appserver.NevowSite(Page())
application = service.Application("menu")
httpd = internet.TCPServer(8000, site).setServiceParent(application)
From mary-twisted at puzzling.org  Sat Aug 20 23:57:14 2005
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Sat Aug 20 23:58:18 2005
Subject: [Twisted-web] Generating cache headers for dymanic data
Message-ID: <20050821055714.GA17329@sourdust.home.puzzling.org>

I think this is round 2 of this discussion, but I'd appreciate thoughts
anyway.

I have a Nevow application. It has the following properties:
 1. it is the same for all users, there is no user specific output
 2. part of the data source, and hence some of the pages (say 5-10 out
    600 odd) changes about twice a week
 3. the vast majority of pages remain the same for periods of weeks or
    months

As far as I can tell, this makes it a pretty good candidate for the
various cache headers (Last-Modified and ETag). In fact I'm sure it's a
pretty good candidate, because I've seen how much bandwidth the
Googlebot and the RSS aggregators suck if I don't use them.

The problem is giving a sufficient guarentee of byte-equality. As I
understand the purpose of those headers, if a page has a Last-Modified
unchanged from the last time it was accessed, or has an ETag unchanged
from the last time it was accessed, the body of the response should be
guarenteed to be byte-for-byte identical in so far as that is possible.
(I think foom told me that in practice, Apache regards mtime, file size
and inode numbers as a sufficient guarentee of this.)

As best I can tell, a realistic and reasonably bullet-proof way for me
to tell if there's been a change in my output would be:
 - the same version of Nevow
 - the same version of my Nevow application
 - the same template (as checked by the above logic of Apache's)
 - the same data source (mine are files on disk, so again I can use the
   above logic)

So that's all well and good for the last two, but does anyone have any
ways to detect the first two in any other way than storing a version
variable in my source code and in Nevow source code?

-Mary

From tv at twistedmatrix.com  Mon Aug 22 06:39:43 2005
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Mon Aug 22 06:40:00 2005
Subject: [Twisted-web] Generating cache headers for dymanic data
In-Reply-To: <20050821055714.GA17329@sourdust.home.puzzling.org>
References: <20050821055714.GA17329@sourdust.home.puzzling.org>
Message-ID: <4309C78F.1030500@twistedmatrix.com>

Mary Gardiner wrote:
> I have a Nevow application. It has the following properties:
>  1. it is the same for all users, there is no user specific output
>  2. part of the data source, and hence some of the pages (say 5-10 out
>     600 odd) changes about twice a week
>  3. the vast majority of pages remain the same for periods of weeks or
>     months

I'd say if your data updates so rarely, it's not really dynamic,
and you might be better off serving static files that you update
when needed.

From mary-twisted at puzzling.org  Mon Aug 22 15:29:31 2005
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Mon Aug 22 15:29:13 2005
Subject: [Twisted-web] Generating cache headers for dymanic data
In-Reply-To: <4309C78F.1030500@twistedmatrix.com>
References: <20050821055714.GA17329@sourdust.home.puzzling.org>
	<4309C78F.1030500@twistedmatrix.com>
Message-ID: <20050822212931.GD15924@sourdust.home.puzzling.org>

On Mon, Aug 22, 2005, Tommi Virtanen wrote:
> I'd say if your data updates so rarely, it's not really dynamic,
> and you might be better off serving static files that you update
> when needed.

Does Nevow have good support for this? Because it updates sufficiently
often that hand-writing the HTML is a pain, which is why I spent about
60 man-hours implementing it in Nevow and still consider that a good use
of time :)

-Mary

From tv at twistedmatrix.com  Tue Aug 23 05:07:08 2005
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Tue Aug 23 05:07:17 2005
Subject: [Twisted-web] Generating cache headers for dymanic data
In-Reply-To: <20050822212931.GD15924@sourdust.home.puzzling.org>
References: <20050821055714.GA17329@sourdust.home.puzzling.org>	<4309C78F.1030500@twistedmatrix.com>
	<20050822212931.GD15924@sourdust.home.puzzling.org>
Message-ID: <430B035C.7080904@twistedmatrix.com>

Mary Gardiner wrote:
>>I'd say if your data updates so rarely, it's not really dynamic,
>>and you might be better off serving static files that you update
>>when needed.
> Does Nevow have good support for this? Because it updates sufficiently
> often that hand-writing the HTML is a pain, which is why I spent about
> 60 man-hours implementing it in Nevow and still consider that a good use
> of time :)

I use renderString all the time to write out static html.

From p.mayers at imperial.ac.uk  Tue Aug 23 13:43:06 2005
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Tue Aug 23 13:43:42 2005
Subject: [Twisted-web] Higher level application servers
Message-ID: <430B7C4A.6010003@imperial.ac.uk>

OR: Zope is great, but...

I've got a large web-based application (forms-based SQL-backed, but a 
very very comprehensive app) written over a period of about 4 years in 
Zope. I have been overall very impressed by some features of Zope, but I 
feel it's increasingly moving away from where I want to be - there's a 
heavy CMF/doc repository/company intranet feel to the new X3 releases, 
and the benefits of async versus threadpool-based and multiprotocol 
support are just too much.

But I don't want to lose a lot of what Zope does offer, in particular:

  * transaction manager - integrated ZODB, SQL (and other) 
transaction(s) wrapping rendering of the entire requests
  * TTW editing - very hand for RAD
  * rollback of changes / versioning of code/data objects

I can turn around new (good, well thought out) features very quickly 
using a combinaton of Zopes PythonScripts and/or templated SQL, and if I 
make a coding error, the exception rolls back any transactions for any 
and *all* transactional-aware components used in that request (SQL, 
LDAP, filestore) without me doing any work, then I take a look at the 
exact diff of what I typed and maybe rollback the changes. A great crutch!

Of course writing all these would be relatively trivial, but the time 
spent piles up. I'm aware the divmod suite has an app server (Mantissa) 
but to be frank I don't like Atop. I'm quite happy (actually I prefer) 
filesystem-backed code.

So what's the state of play for layers between t.web -> (appserver) -> 
appcode. I would expect the obvious choice for components within the app 
server to be t.e.adbapi, nevow, t.cred and then onto the more narrow 
components like a caching framework, indexing, etc.

Thoughts?

From michal at pasternak.in  Tue Aug 23 14:30:12 2005
From: michal at pasternak.in (Michal Pasternak)
Date: Tue Aug 23 14:30:13 2005
Subject: [Twisted-web] Higher level application servers
In-Reply-To: <430B7C4A.6010003@imperial.ac.uk>
References: <430B7C4A.6010003@imperial.ac.uk>
Message-ID: <200508232230.14009.michal@pasternak.in>

Dnia Tuesday 23 August 2005 21:43, Phil Mayers napisa?:
[...]
>
> But I don't want to lose a lot of what Zope does offer, in particular:

From what do I see, you're not asking about Nevow. Nevow is about the web (or, 
about creating Python applications that utilize HTTP protocol). You're 
neither asking about the web, nor about http, so this is going to be pretty 
offtopic, but what the heck...

> I can turn around new (good, well thought out) features very quickly
> using a combinaton of Zopes PythonScripts and/or templated SQL, and if I
> make a coding error, the exception rolls back any transactions for any
> and *all* transactional-aware components used in that request (SQL,
> LDAP, filestore) without me doing any work, then I take a look at the
> exact diff of what I typed and maybe rollback the changes. A great crutch!

pgasync is pretty good for writing Twisted apps which use PostgreSQL backend. 
It has some glitches, none of which are really real (not working mailing 
list, NOTIFY/LISTEN unsupported ATM, some trouble with good reaction for 
server shutdown message).

About LDAP and filestore... well, you just need a transaction-aware library, 
that does what you need. 

Tracking code changes? Well, that's what subversion is good for. Perhaps it 
won't be as convinient as what you have integrated into ZOPE, but there are 
GUI frontends available.

> Of course writing all these would be relatively trivial, but the time
> spent piles up. I'm aware the divmod suite has an app server (Mantissa)
> but to be frank I don't like Atop. I'm quite happy (actually I prefer)
> filesystem-backed code.

Well, as far as I know, atop is passe.

Check out Glyph's journal at 
http://www.livejournal.com/users/glyf/39104.html . I think both he and the 
whole Divmod crew is coming up with some exciting stuff, as usual. 

I think that Axiom and new Mantissa is what you want. 

> So what's the state of play for layers between t.web -> (appserver) ->
> appcode. I would expect the obvious choice for components within the app
> server to be t.e.adbapi, nevow, t.cred and then onto the more narrow
> components like a caching framework, indexing, etc.
>
> Thoughts?

Yes.

Let's leave Nevow doing web stuff. That's the way things should be done.

For high-level webapplication stuff, consult Divmod's development lists, check 
out Axiom and Mantissa, share your ideas with the team. I think, that this is 
the Nevow-based thing you need.

Take care,
-- 
"(Man) tries to live his own life as if he were telling a story. But you
 have to choose: live or tell." -- Sartre

From p.mayers at imperial.ac.uk  Tue Aug 23 15:09:24 2005
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Tue Aug 23 15:09:59 2005
Subject: [Twisted-web] Higher level application servers
In-Reply-To: <200508232230.14009.michal@pasternak.in>
References: <430B7C4A.6010003@imperial.ac.uk>
	<200508232230.14009.michal@pasternak.in>
Message-ID: <430B9084.7020604@imperial.ac.uk>

Michal Pasternak wrote:
> Dnia Tuesday 23 August 2005 21:43, Phil Mayers napisa?:
> [...]
> 
>>But I don't want to lose a lot of what Zope does offer, in particular:
> 
> 
> From what do I see, you're not asking about Nevow. Nevow is about the web (or, 
> about creating Python applications that utilize HTTP protocol). You're 
> neither asking about the web, nor about http, so this is going to be pretty 
> offtopic, but what the heck...

I'm afraid you've misunderstood me, or I was unclear (though you then 
seem to answer me at the bottom, so maybe not):

I'm asking about Twisted-based (native asynchronous) HTTP application 
servers that provide higher levels of abstraction than http.Request and 
rend.Page - specifically high-level services such as per-HTTP-request 
transaction managers, TTW object editing and the other examples I listed 
(and more maybe). Zope is the closest comparison. Zope is a higher-layer 
server written on top of (heavily retooled) medusa, a threadpool, ZODB 
and DTML/ZPT/PythonScripts. This unspecified app server would be written 
on top of Twisted, twisted.web, nevow (and other stuff).

I had assumed that was about as on-topic as you could get for 
"twisted-web" list, but maybe not.

re: LDAP, filestores, and so forth, I was using those as examples of the 
kind of high-level services such an app framework may provide, rather 
then specific features I need.

> pgasync is pretty good for writing Twisted apps which use PostgreSQL backend. 

I'm using it. It has some issues, but none that are insurmountable. It's 
certainly very good, but a DBAPI2 (or rather, ADBAPI) connector hardly 
counts as a high-level component.

> It has some glitches, none of which are really real (not working mailing 
> list, NOTIFY/LISTEN unsupported ATM, some trouble with good reaction for 
> server shutdown message).
> 
> About LDAP and filestore... well, you just need a transaction-aware library, 
> that does what you need. 

...erm, and a transaction manager integrated to the HTTP request 
handler, which is an application server feature...

> 
> Tracking code changes? Well, that's what subversion is good for. Perhaps it 

We'll have to agree to disagree there I'm afraid. Subversion appears to 
be "good for" getting Berkeley database errors and being a lot slower 
than CVS, all so we can "mv" files and run over HTTP? Big woop...

(That was a joke)

> won't be as convinient as what you have integrated into ZOPE, but there are 
> GUI frontends available.
> 
> 
>>Of course writing all these would be relatively trivial, but the time
>>spent piles up. I'm aware the divmod suite has an app server (Mantissa)
>>but to be frank I don't like Atop. I'm quite happy (actually I prefer)
>>filesystem-backed code.
> 
> 
> Well, as far as I know, atop is passe.
> 
> Check out Glyph's journal at 
> http://www.livejournal.com/users/glyf/39104.html . I think both he and the 
> whole Divmod crew is coming up with some exciting stuff, as usual. 

SQLite eh? Interesting.



> 
> I think that Axiom and new Mantissa is what you want. 
> 
> 
>>So what's the state of play for layers between t.web -> (appserver) ->
>>appcode. I would expect the obvious choice for components within the app
>>server to be t.e.adbapi, nevow, t.cred and then onto the more narrow
>>components like a caching framework, indexing, etc.
>>
>>Thoughts?
> 
> 
> Yes.
> 
> Let's leave Nevow doing web stuff. That's the way things should be done.

I did not intend to suggest otherwise. I think you have misunderstood 
portions of my email, or read stuff into it that I did not mean to 
imply; or I have been unclear.

> 
> For high-level webapplication stuff, consult Divmod's development lists, check 
> out Axiom and Mantissa, share your ideas with the team. I think, that this is 
> the Nevow-based thing you need.
> 
> Take care,

I'll take a look at that.

I'm surprised there isn't something a little more lightweight though. 
Quite what it would look like I don't know, which is why I'm asking.

From raphaelarbuz at netcourrier.com  Wed Aug 24 07:13:49 2005
From: raphaelarbuz at netcourrier.com (Raphael Arbuz)
Date: Wed Aug 24 07:14:35 2005
Subject: [Twisted-web] resolving a hostname problem
Message-ID: <008a01c5a8ad$aad23a80$0e33a992@win.doc.ic.ac.uk>

Hi to all of you,

I;m trying to impleting hostname resolution in a program that aimed to
exchange UDP packets with his peers.

What I do is add the two lines:
    dd = reactor.resolve(IP)
    dd.addCallback(self.call, distPort, password, destroy)

To my program, but when I do that, I don't reach the call function. Seems
like something would be missing. Does anyone have a clue?

Cheers!

Raphael


From tv at twistedmatrix.com  Wed Aug 24 11:15:56 2005
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Wed Aug 24 11:16:03 2005
Subject: [Twisted-web] resolving a hostname problem
In-Reply-To: <008a01c5a8ad$aad23a80$0e33a992@win.doc.ic.ac.uk>
References: <008a01c5a8ad$aad23a80$0e33a992@win.doc.ic.ac.uk>
Message-ID: <430CAB4C.9060508@twistedmatrix.com>

Raphael Arbuz wrote:
> I;m trying to impleting hostname resolution in a program that aimed to
> exchange UDP packets with his peers.
> 
> What I do is add the two lines:
>     dd = reactor.resolve(IP)
>     dd.addCallback(self.call, distPort, password, destroy)
> 
> To my program, but when I do that, I don't reach the call function. Seems
> like something would be missing. Does anyone have a clue?

Yes, we do.

What is missing is the rest of your program; that is, the parts
that contain the bug.

You owe the Oracle a bottle of crystal ball polish[1].


[1] You ain't an old beard if you don't know what that refers to.[2]

[2] Yes, the grovel _was_ insufficient.

From raphaelarbuz at netcourrier.com  Wed Aug 24 11:28:34 2005
From: raphaelarbuz at netcourrier.com (Raphael Arbuz)
Date: Wed Aug 24 11:29:21 2005
Subject: [Twisted-web] resolving a hostname problem
References: <008a01c5a8ad$aad23a80$0e33a992@win.doc.ic.ac.uk>
	<430CAB4C.9060508@twistedmatrix.com>
Message-ID: <014201c5a8d1$447c3870$0e33a992@win.doc.ic.ac.uk>

Sorry, here is a more complete listing of the part that could help:

import wx
from threading import Thread
from twisted.internet import reactor
from twisted.python import threadable
from twisted.internet.defer import maybeDeferred, Deferred
from twisted.internet import defer
from time import sleep
from time import time
from communication import Communication

from twisted.internet.task import LoopingCall
from twisted.internet.protocol import DatagramProtocol

import sys, traceback
import audio
import Queue

import ConnectionManager

class TwistedThread(Thread, DatagramProtocol):

    def __init__(self, appliClass, fileID, queue):
        Thread.__init__(self) # initialize the thread

        self.appliClass = appliClass
        self.fileID = fileID
        self.queue = queue

    def run(self):
        """after the thread is launched"""
        threadable.init(1)
        self.waitForCalls()
        while 1:
            msg = self.queue.get(1)
            if msg[0]=="call":
                  self.resolve(IP = msg[1], password = msg[2])
                break

    def waitForCalls(self):
        """open MAX_NB_CORRESPONDENTS ports to listen to incoming
connections"""
        print "waiting for calls"
        for counter in range(self.appliClass.MAX_NB_CORRESPONDENTS):
            correspondent = ConnectionManager.ConnectionManager(self,
self.sendPointer, False)
            try:
                reactor.listenUDP(8000+counter,
self.correspondents[counter])
            except:
                pass
        reactor.run(installSignalHandlers=0)

    def resolve(self, IP, distPort= 8000, password = "", destroy = False):
        print "on res"
        dd = reactor.resolve(IP)
        dd.addCallback(self.call, distPort, password, destroy)

    def call(self, IP, distPort = 8000, password = "", destroy = False):
        print "res done"
        """place a phone call"""
        print "Calling the IP " + str(IP) + " on port " + str(distPort)
        self.confPassword = password #set the conference password
....


Hope it is clearer.

Thanks a lot for your time

Raphael



----- Original Message -----
From: "Tommi Virtanen" <tv@twistedmatrix.com>
To: "Discussion of twisted.web, Nevow, and Woven"
<twisted-web@twistedmatrix.com>
Sent: Wednesday, August 24, 2005 6:15 PM
Subject: Re: [Twisted-web] resolving a hostname problem


> Raphael Arbuz wrote:
> > I;m trying to impleting hostname resolution in a program that aimed to
> > exchange UDP packets with his peers.
> >
> > What I do is add the two lines:
> >     dd = reactor.resolve(IP)
> >     dd.addCallback(self.call, distPort, password, destroy)
> >
> > To my program, but when I do that, I don't reach the call function.
Seems
> > like something would be missing. Does anyone have a clue?
>
> Yes, we do.
>
> What is missing is the rest of your program; that is, the parts
> that contain the bug.
>
> You owe the Oracle a bottle of crystal ball polish[1].
>
>
> [1] You ain't an old beard if you don't know what that refers to.[2]
>
> [2] Yes, the grovel _was_ insufficient.
>
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>


From michal at pasternak.in  Wed Aug 24 12:57:39 2005
From: michal at pasternak.in (Michal Pasternak)
Date: Wed Aug 24 12:57:37 2005
Subject: [Twisted-web] Higher level application servers
In-Reply-To: <430B9084.7020604@imperial.ac.uk>
References: <430B7C4A.6010003@imperial.ac.uk>
	<200508232230.14009.michal@pasternak.in>
	<430B9084.7020604@imperial.ac.uk>
Message-ID: <200508242057.40505.michal@pasternak.in>

Dnia Tuesday 23 August 2005 23:09, Phil Mayers napisa?:
>
> > Tracking code changes? Well, that's what subversion is good for. Perhaps
> > it
>
> We'll have to agree to disagree there I'm afraid. Subversion appears to
> be "good for" getting Berkeley database errors and being a lot slower
> than CVS, all so we can "mv" files and run over HTTP? Big woop...

It's getting more and more offtopic... anyway, about SVN: everyone use fsfs 
now (man svnadmin(8)).

Second, if you prefer doing things fast instead of doing things right, well, 
you should swich your PostgreSQL backend to MySQL ;)

> > Check out Glyph's journal at
> > http://www.livejournal.com/users/glyf/39104.html . I think both he and
> > the whole Divmod crew is coming up with some exciting stuff, as usual.
>
> SQLite eh? Interesting.

It's only a backend for Axiom - Divmod's database. As with atop you didn't use 
bsddb directly, the same is for Axiom and SQLite.

> I'm surprised there isn't something a little more lightweight though.
> Quite what it would look like I don't know, which is why I'm asking.

Zope has many components and is a very complicated product. Maybe first you 
should try to define, what functionality that imaginary nevow-based product 
would have instead of giving examples (and, as you said, filestore, SQL db 
and LDAP you mentioned were only examples).

And, about that development environment part of ZOPE... creating a web-based 
development environment for componentized Nevow apps - and, as I believe, 
this is the functionality that Zope already has, as you mentioned it - yes, 
of course, it would be cool to have that, but hey... can I use Emacs to edit 
textarea boxes on a webpage?

Take care, 
-- 
"(Man) tries to live his own life as if he were telling a story. But you
 have to choose: live or tell." -- Sartre

From alengarbage at yahoo.com  Wed Aug 24 21:31:20 2005
From: alengarbage at yahoo.com (Lenny G Arbage)
Date: Wed Aug 24 21:31:53 2005
Subject: [Twisted-web] URL length limits in twisted-web
Message-ID: <20050825033120.30567.qmail@web31504.mail.mud.yahoo.com>

I'm noticing silent failures using HTTPClientFactory
with len(url) >= 16400.  The factory's deferred object
immediately calls its associated callBack() method
without sending any data  (the server is likewise
written with twisted python, but it doesn't appear to
ever receive data).  The errorBack() doesn't fire
either.

A url with len <= 16398 works just fine, firing the
callback /after/ sending the data.

According to RFC 2616, arbitrary length URLs are
allowed by HTTP, but I understand that there are
practical limitations in many implementations.  Is the
16400 url-length ceiling a known limitation in
twisted, or am I banging up against something else?

thanks,
Lenny


		
____________________________________________________
Start your day with Yahoo! - make it your home page 
http://www.yahoo.com/r/hs 
 

From exarkun at divmod.com  Wed Aug 24 23:31:57 2005
From: exarkun at divmod.com (Jp Calderone)
Date: Wed Aug 24 23:31:59 2005
Subject: [Twisted-web] resolving a hostname problem
In-Reply-To: <014201c5a8d1$447c3870$0e33a992@win.doc.ic.ac.uk>
Message-ID: <20050825053157.3914.300531404.divmod.quotient.8034@ohm>

On Wed, 24 Aug 2005 18:28:34 +0100, Raphael Arbuz <raphaelarbuz@netcourrier.com> wrote:
>Sorry, here is a more complete listing of the part that could help:

The program calls functions from the wrong thread.  Almost every single Twisted API may only be invoked from the reactor thread.

Why are you using threads at all?  Most programs don't need them.

Jp

From en.karpachov at ospaz.ru  Thu Aug 25 01:11:57 2005
From: en.karpachov at ospaz.ru (en.karpachov@ospaz.ru)
Date: Thu Aug 25 01:12:57 2005
Subject: [Twisted-web] registerAdapter and implemented interfaces
Message-ID: <20050825111157.1e3244ef.jk@ospaz.ru>

In nevow, when I adapt a context to ISession, I get a
twisted.web.server.Session object by default. If I want to adapt this
session-like object to my custom IUser interface, I register an adapter:

components.registerAdapter(UserAdapter, twisted.web.server.Session, IUser)

so I could write:

     session = ISession(ctx)
     user = IUser(session)

But, if I eventually move to the nevow guard, this code won't work because
ISession adapter now returns an object of nevow.guard.GuardSession.

What is the right way to register an adapter so the code won't break?

components.registerAdapter(UserAdapter, <what is here?>, IUser)

I can use the Componentized class, but it is not obvious and there is no
guarantee either that ISession will always adapt to the Componentized.

It would be easier if there was a precondition that an adapter itself
implemented the interface it adapts to, so one could write:

components.registerAdapter(UserAdapter, ISession, IUser)

Is there any rationale not to have such a precondition? What I missed here?

-- 
jk

From tv at twistedmatrix.com  Thu Aug 25 03:28:11 2005
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Thu Aug 25 03:28:18 2005
Subject: [Twisted-web] URL length limits in twisted-web
In-Reply-To: <20050825033120.30567.qmail@web31504.mail.mud.yahoo.com>
References: <20050825033120.30567.qmail@web31504.mail.mud.yahoo.com>
Message-ID: <430D8F2B.4060502@twistedmatrix.com>

Lenny G Arbage wrote:
> I'm noticing silent failures using HTTPClientFactory
> with len(url) >= 16400.  The factory's deferred object
> immediately calls its associated callBack() method
> without sending any data  (the server is likewise
> written with twisted python, but it doesn't appear to
> ever receive data).  The errorBack() doesn't fire
> either.
> 
> A url with len <= 16398 works just fine, firing the
> callback /after/ sending the data.
> 
> According to RFC 2616, arbitrary length URLs are
> allowed by HTTP, but I understand that there are
> practical limitations in many implementations.  Is the
> 16400 url-length ceiling a known limitation in
> twisted, or am I banging up against something else?

There's this DoS-avoidance bit:

class LineReceiver(protocol.Protocol, _PauseableMixin):
    ...
    MAX_LENGTH = 16384

From raphaelarbuz at netcourrier.com  Thu Aug 25 07:06:07 2005
From: raphaelarbuz at netcourrier.com (Raphael Arbuz)
Date: Thu Aug 25 07:06:56 2005
Subject: [Twisted-web] resolving a hostname problem
References: <20050825053157.3914.300531404.divmod.quotient.8034@ohm>
Message-ID: <00b801c5a975$c1f25880$0e33a992@win.doc.ic.ac.uk>

Hi Jp,

thanks  for your answer but what do you mean byt the "wrong" thread? this
one is the one where all my reactor things are.

Thanks

Raph
----- Original Message -----
From: "Jp Calderone" <exarkun@divmod.com>
To: <Discussion@netcourrier.com>; <of@netcourrier.com>;
<twisted.web@netcourrier.com>; <Nevow@netcourrier.com>; "and Woven"
<twisted-web@twistedmatrix.com>
Sent: Thursday, August 25, 2005 6:31 AM
Subject: Re: [Twisted-web] resolving a hostname problem


> On Wed, 24 Aug 2005 18:28:34 +0100, Raphael Arbuz
<raphaelarbuz@netcourrier.com> wrote:
> >Sorry, here is a more complete listing of the part that could help:
>
> The program calls functions from the wrong thread.  Almost every single
Twisted API may only be invoked from the reactor thread.
>
> Why are you using threads at all?  Most programs don't need them.
>
> Jp
>
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>


From psanchez at nortel.com  Thu Aug 25 08:12:02 2005
From: psanchez at nortel.com (Pedro Sanchez)
Date: Thu Aug 25 08:10:23 2005
Subject: [Twisted-web] How to "monitor" parallel executions of Deferreds
Message-ID: <1124979123.12847.35.camel@pcard0ze.ca.nortel.com>

My apologies.
Sorry, this should have gone to twisted-python instead.

==========

Hello,

I need to implement a function (say, myfunc) that fires several
independent Deferreds (using deferToThread), and that returns a deferred
itself. A client of this function (say, client) is expected to do
something like this:

def client():
    def done(success)
        if success:
           print 'd1 and d2 are done'

    d = myfunc()
    d.addCallback(done)
    ...


myfuct() above does something like this:

def myfunc():
    def checkFunc1(success):
    ...

    def checkFunc2(success):
    ...

    d = defer.Deferred()
    d1 = deferToThread(func1).addCallback(checkFunc1)
    d2 = deferToThread(func2).addCallback(checkFunc2)
    d.addCallback(????)

    return d

Clearly d, d1, and d2 in the above are disconnected. And I don't want to
serialize d1 and d2 which would be a way to connect them all.

The problem is I don't know how d should be defined. The idea is that
the 'done' function in the client function is only called when both
threads d1 and d2 are done.

Can you give me any suggestions on how to implement myfunc()?

Thank you,

-- 
Pedro




From marian.schubert at gmail.com  Thu Aug 25 08:34:20 2005
From: marian.schubert at gmail.com (Marian Schubert)
Date: Thu Aug 25 08:34:55 2005
Subject: [Twisted-web] How to "monitor" parallel executions of Deferreds
In-Reply-To: <1124979123.12847.35.camel@pcard0ze.ca.nortel.com>
References: <1124979123.12847.35.camel@pcard0ze.ca.nortel.com>
Message-ID: <a0839b8905082507342f09bbcd@mail.gmail.com>

Hello,

check twisted.internet.defer.DeferredList


cu,
Maio
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-web/attachments/20050825/90e0a98f/attachment.htm
From psanchez at nortel.com  Thu Aug 25 08:09:37 2005
From: psanchez at nortel.com (Pedro Sanchez)
Date: Thu Aug 25 08:51:07 2005
Subject: [Twisted-web] How to "monitor" parallel executions of Deferreds
Message-ID: <1124978977.12847.33.camel@pcard0ze.ca.nortel.com>

Hello,

I need to implement a function (say, myfunc) that fires several
independent Deferreds (using deferToThread), and that returns a deferred
itself. A client of this function (say, client) is expected to do
something like this:

def client():
    def done(success)
        if success:
           print 'd1 and d2 are done'

    d = myfunc()
    d.addCallback(done)
    ...


myfuct() above does something like this:

def myfunc():
    def checkFunc1(success):
    ...

    def checkFunc2(success):
    ...

    d = defer.Deferred()
    d1 = deferToThread(func1).addCallback(checkFunc1)
    d2 = deferToThread(func2).addCallback(checkFunc2)
    d.addCallback(????)

    return d

Clearly d, d1, and d2 in the above are disconnected. And I don't want to
serialize d1 and d2 which would be a way to connect them all.

The problem is I don't know how d should be defined. The idea is that
the 'done' function in the client function is only called when both
threads d1 and d2 are done.

Can you give me any suggestions on how to implement myfunc()?

Thank you,

-- 
Pedro




From alengarbage at yahoo.com  Thu Aug 25 12:13:23 2005
From: alengarbage at yahoo.com (Lenny G Arbage)
Date: Thu Aug 25 12:13:55 2005
Subject: [Twisted-web] Re: URL length limits in twisted-web
Message-ID: <20050825181323.10157.qmail@web31513.mail.mud.yahoo.com>


--- Tommi Virtanen wrote:
>
> There's this DoS-avoidance bit:
> 
> class LineReceiver(protocol.Protocol,
_PauseableMixin):
>     ...
>     MAX_LENGTH = 16384


  Thanks, Tommi.  That appears to be it (16898 -
len('http://') and the non "path" part of my URL = the
more sane number of 16384).

  The 'silent failure' feature doesn't seem quite
right to me.  LineReceiver.dataReceived() returns
self.lineLengthExceeded(line), which calls
self.transport.loseConnection(), which means that
neither http.HTTPClient.lineReceived() nor
http.HTTPChannel.lineReceived() ever get called.  If
I'm following the code correctly, loseConnection()
does its job silently, and the caller never knows what
happened, but is led to believe that the request was
sent successfully.

  I changed LineReceiver.lineLengthReceived() as
follows:

def lineLengthExceeded(self, line):
        """Called when the maximum line length has
been reached.
        Override if it needs to be dealt with in some
special way.
        """
        #return self.transport.loseConnection()
        self.transport.loseConnection()
        raise error.ConnectionLost('Line length
exceeded')

  Which now does what I would expect (raises an
exception if I try to send URLs that exceed the
maximum), but I'm sure there are reasons not to raise
an exception here (other classes that rely on
LineReceiver, etc).

  What is the proper solution to this issue?

Lenny


		
____________________________________________________
Start your day with Yahoo! - make it your home page 
http://www.yahoo.com/r/hs 
 

From exarkun at divmod.com  Thu Aug 25 20:30:58 2005
From: exarkun at divmod.com (Jp Calderone)
Date: Thu Aug 25 20:31:00 2005
Subject: [Twisted-web] Re: URL length limits in twisted-web
In-Reply-To: <20050825181323.10157.qmail@web31513.mail.mud.yahoo.com>
Message-ID: <20050826023058.3914.1121082557.divmod.quotient.8562@ohm>

On Thu, 25 Aug 2005 11:13:23 -0700 (PDT), Lenny G Arbage <alengarbage@yahoo.com> wrote:
>
>--- Tommi Virtanen wrote:
>>
>> There's this DoS-avoidance bit:
>>
>> class LineReceiver(protocol.Protocol,
>_PauseableMixin):
>>     ...
>>     MAX_LENGTH = 16384
>
>
>  Thanks, Tommi.  That appears to be it (16898 -
>len('http://') and the non "path" part of my URL = the
>more sane number of 16384).
>
>  The 'silent failure' feature doesn't seem quite
>right to me.

It isn't a silent failure.  The connection is dropped, as you notice.  The client is entirely capable of noticing that the server never responded to its request.  If no response is received, the correct thing to do is /not/ to assume everything worked perfectly.  Especially if the response was supposed to be a page.  twisted.web.client may well be buggy in its handling of this case (I've noticed several other bugs of this variety, though I'm not sure I've seen this one in particular).
> 
> [snip]
>
>  I changed LineReceiver.lineLengthReceived() as
>follows:
>
>def lineLengthExceeded(self, line):
>        """Called when the maximum line length has
>been reached.
>        Override if it needs to be dealt with in some
>special way.
>        """
>        #return self.transport.loseConnection()
>        self.transport.loseConnection()
>        raise error.ConnectionLost('Line length
>exceeded')
>
>  Which now does what I would expect (raises an
>exception if I try to send URLs that exceed the
>maximum), but I'm sure there are reasons not to raise
>an exception here (other classes that rely on
>LineReceiver, etc).

This just throws a random exception up into the reactor.  This is not allowed, but Twisted kindly catches it, logs it, and makes sure the protocol is not given any further data.  It's not an error condition you can reasonably deal with, it's just loud and ugly and obnoxious to make sure you notice your program is horribly broken and should be fixed.

>
>  What is the proper solution to this issue?

A better HTTP client.  Some people have been working in this area.  Perhaps they will grace us with a progress report.

Jp

From lloyd at paisite.com  Fri Aug 26 10:20:12 2005
From: lloyd at paisite.com (lloyd@paisite.com)
Date: Fri Aug 26 10:23:39 2005
Subject: [Twisted-web] T. Turkley blog
In-Reply-To: <014201c5a8d1$447c3870$0e33a992@win.doc.ic.ac.uk>
References: <008a01c5a8ad$aad23a80$0e33a992@win.doc.ic.ac.uk>
	<430CAB4C.9060508@twistedmatrix.com>
	<014201c5a8d1$447c3870$0e33a992@win.doc.ic.ac.uk>
Message-ID: <4533.151.199.39.33.1125073212.squirrel@www.wbsysnet.com>

Hello,

Techno Turkey now has a blog of his own dedicated to better documentation
for Twisted:

http://tturkey.blogspot.com/

Best wishes,

Lloyd






From michal at pasternak.in  Mon Aug 29 15:24:13 2005
From: michal at pasternak.in (Michal Pasternak)
Date: Mon Aug 29 15:23:33 2005
Subject: [Twisted-web] Tabbed pane
Message-ID: <200508292324.14449.michal@pasternak.in>

Hi,

I've noticed, that tabbed pane stopped working in MSIE (and, I firmly believe 
it worked some time ago).

Also, in konqueror, the tabs display, but can't be changed.

Safari, opera and firefox work ok.

Any ideas on introducing a working (and not proper) implementation for MSIE to 
Nevow again? I think, that the main reason it doesn't work right now are CSS. 
Having 2 CSS would clobber Nevow code, so... ideas?

Take care,
-- 
"(Man) tries to live his own life as if he were telling a story. But you
 have to choose: live or tell." -- Sartre
 
http://www.bykom-stop.avx.pl/ - popieraj!

From therve at free.fr  Tue Aug 30 03:34:32 2005
From: therve at free.fr (Thomas HERVE)
Date: Tue Aug 30 03:36:41 2005
Subject: [Twisted-web] MochiKit, Nevow
Message-ID: <20050830113432.pa5j66poaodck8og@itchy.wasabout.net>

I didn't see anyone talking about MochiKit here, but as it's someone of Twisted
community I think it's not unknown among developpers.

MochiKit (http://mochikit.com/) is a Javascript framework started by Bob
Ippolito, which brings great functionnalities on client side. Especially it
defines Deffered what I would love use with LivePage, as I find this very
consistent with server part. There are also Iter and DOM (stan in Javascript).
I began to make some mods en nevow_glue.js for using MochiKit, and it removes
all the ugly parts (XMLHttpRequest, events, DOM creation). I think having a
Mochi-ized nevow_glue would be great, even if keeping the standard one is
necessary for users (MochiKit could be a strong requirement for an
application).

I wanted to make all the changes, but as the LivePage API seems to change in
nevow 0.5, I'll wait a bit. Some comes my second topic : when can we hope
having a nevow release ?
I'm not telling "hey, please hurry up guys", but more "is there any todo list,
critical bugs and/or tests needs where I could have a look and maybe help for
the release ?". Also, is the svn-trunk version stable enough (for LivePage ?)
that we could use it ?

Regards,

-- 
Thomas

From dialtone at divmod.com  Tue Aug 30 03:59:20 2005
From: dialtone at divmod.com (Valentino Volonghi aka Dialtone)
Date: Tue Aug 30 03:59:24 2005
Subject: [Twisted-web] MochiKit, Nevow
In-Reply-To: <20050830113432.pa5j66poaodck8og@itchy.wasabout.net>
References: <20050830113432.pa5j66poaodck8og@itchy.wasabout.net>
Message-ID: <43142DF8.9020502@divmod.com>

Thomas HERVE wrote:

>MochiKit (http://mochikit.com/) is a Javascript framework started by Bob
>Ippolito, which brings great functionnalities on client side. Especially it
>defines Deffered what I would love use with LivePage, as I find this very
>consistent with server part. There are also Iter and DOM (stan in Javascript).
>I began to make some mods en nevow_glue.js for using MochiKit, and it removes
>all the ugly parts (XMLHttpRequest, events, DOM creation). I think having a
>Mochi-ized nevow_glue would be great, even if keeping the standard one is
>necessary for users (MochiKit could be a strong requirement for an
>application).
>  
>
We all know MochiKit and Bob. And we were talking about something like
this (changing the glue to
use mochikit and ship mochikit with nevow). I totally agree with this
patch and proposal.

>I wanted to make all the changes, but as the LivePage API seems to change in
>nevow 0.5, I'll wait a bit. Some comes my second topic : when can we hope
>having a nevow release ?
>  
>
Some months ago. ;P.

>I'm not telling "hey, please hurry up guys", but more "is there any todo list,
>critical bugs and/or tests needs where I could have a look and maybe help for
>the release ?". 
>
The TODO list is not clear, I guess everything is practically ready and
only needs to be tested to avoid the
problems we had with release 0.4.1. The only missing thing (but I don't
know the current state) is fragment
dispatching for livepage.

>Also, is the svn-trunk version stable enough (for LivePage ?)
>that we could use it ?
>  
>
Yes

-- 
Valentino Volonghi aka Dialtone
Now Running MacOSX 10.4.1
Blog: http://vvolonghi.blogspot.com
http://weever.berlios.de


From exarkun at divmod.com  Tue Aug 30 12:38:54 2005
From: exarkun at divmod.com (Jp Calderone)
Date: Tue Aug 30 12:38:55 2005
Subject: [Twisted-web] MochiKit, Nevow
In-Reply-To: <20050830113432.pa5j66poaodck8og@itchy.wasabout.net>
Message-ID: <20050830183854.3914.1053739595.divmod.quotient.10269@ohm>

On Tue, 30 Aug 2005 11:34:32 +0200, Thomas HERVE <therve@free.fr> wrote:
>I didn't see anyone talking about MochiKit here, but as it's someone of Twisted
>community I think it's not unknown among developpers.
>
>MochiKit (http://mochikit.com/) is a Javascript framework started by Bob
>Ippolito, which brings great functionnalities on client side. Especially it
>defines Deffered what I would love use with LivePage, as I find this very
>consistent with server part. There are also Iter and DOM (stan in Javascript).
>I began to make some mods en nevow_glue.js for using MochiKit, and it removes
>all the ugly parts (XMLHttpRequest, events, DOM creation). I think having a
>Mochi-ized nevow_glue would be great, even if keeping the standard one is
>necessary for users (MochiKit could be a strong requirement for an
>application).
>
>I wanted to make all the changes, but as the LivePage API seems to change in
>nevow 0.5, I'll wait a bit. Some comes my second topic : when can we hope
>having a nevow release ?
>I'm not telling "hey, please hurry up guys", but more "is there any todo list,
>critical bugs and/or tests needs where I could have a look and maybe help for
>the release ?". Also, is the svn-trunk version stable enough (for LivePage ?)
>that we could use it ?
>

I've started implementing a version of server.handle() which returns a Deferred that fires with the return value of the handle_ method on the server.  I'll be working on this in /branches/exarkun/callLater/, for anyone who is interested in following development, contributing patches, or making suggestions.

There's no code checked in at the moment, but since there seems to be interest I'll commit what I have so far later tonight.

Regarding the second topic, I'd really like to see a Nevow release too :)  I don't think there's anything critical blocking a 0.5 release right now aside from hopes that 0.5 would include a particular set of feature enhancements that aren't all complete yet.  I don't see any point delaying a release to wait for these: someday they'll be ready, and if Nevow releases are done regularly, then someday shortly afterwards, they'll be available in a release :)

Jp


>Regards,
>
>--
>Thomas
>
>_______________________________________________
>Twisted-web mailing list
>Twisted-web@twistedmatrix.com
>http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>

From alberto.trujillo at ucd.ie  Wed Aug 31 04:15:26 2005
From: alberto.trujillo at ucd.ie (Alberto Trujillo)
Date: Wed Aug 31 04:11:18 2005
Subject: [Twisted-web] Problems with the new lines
Message-ID: <4315833E.40405@ucd.ie>

Hello:
I have some troubles with nevow and the new lines. I'm taking datas from 
one form and after try to display them in a different page, like a 
simple text between simple "<td>" tags. Well, the problem is that the 
new lines are not display in the new page.
Could anybody tell me how to fix this. Thank you very much.

Here is the code

form.html
-----------------
< form method="post" name="formrecipients" nevow:render="formrecipients">
< nevow:attr name="action">< nevow:slot name="action"/></ nevow:attr>
...
           < td colspan="2">
               < textarea name="description" rows="5" cols="50" 
class="formelements"></ textarea>
           </ td>
...
</ from>

file.html
----------------
< td colspan="3" class="wktdcontent" width="50px">
     < div ID="demodiv" class="demo" style="display: none;">
     < nevow:attr name="id">< nevow:slot name="id"/></ nevow:attr>
     < nevow:slot name="description">Description</ nevow:slot>
      </ div>
</ td>

file.py
--------------
   def render_messages(self, ctx, data):
       ctx.fillSlots("id", data.id)
       ctx.fillSlots("subject", data.subject)
       ctx.fillSlots("sender", data.sender)
       ctx.fillSlots("date", data.date)
       ctx.fillSlots("description", data.description)
       return ctx.tag


From dialtone at divmod.com  Wed Aug 31 04:29:21 2005
From: dialtone at divmod.com (Valentino Volonghi aka Dialtone)
Date: Wed Aug 31 04:29:26 2005
Subject: [Twisted-web] Problems with the new lines
In-Reply-To: <4315833E.40405@ucd.ie>
References: <4315833E.40405@ucd.ie>
Message-ID: <43158681.5080703@divmod.com>

Alberto Trujillo wrote:

> Hello:
> I have some troubles with nevow and the new lines. I'm taking datas
> from one form and after try to display them in a different page, like
> a simple text between simple "<td>" tags. Well, the problem is that
> the new lines are not display in the new page.
> Could anybody tell me how to fix this. Thank you very much.

if you want to display newlines with html you have to change them into
<br> or <br /> (depending on which markup you are using).
HTML/xHTML are substantially space and newline agnostic.

-- 
Valentino Volonghi aka Dialtone
Now Running MacOSX 10.4.1
Blog: http://vvolonghi.blogspot.com
http://weever.berlios.de


From alberto.trujillo at ucd.ie  Wed Aug 31 04:44:07 2005
From: alberto.trujillo at ucd.ie (Alberto Trujillo)
Date: Wed Aug 31 04:39:53 2005
Subject: [Twisted-web] Problems with the new lines
In-Reply-To: <43158681.5080703@divmod.com>
References: <4315833E.40405@ucd.ie> <43158681.5080703@divmod.com>
Message-ID: <431589F7.7050607@ucd.ie>

Valentino Volonghi aka Dialtone wrote:

>Alberto Trujillo wrote:
>
>  
>
>>Hello:
>>I have some troubles with nevow and the new lines. I'm taking datas
>>from one form and after try to display them in a different page, like
>>a simple text between simple "<td>" tags. Well, the problem is that
>>the new lines are not display in the new page.
>>Could anybody tell me how to fix this. Thank you very much.
>>    
>>
>
>if you want to display newlines with html you have to change them into
><br> or <br /> (depending on which markup you are using).
>HTML/xHTML are substantially space and newline agnostic.
>
>  
>
Do you know if there is any function in nevow that do this 
automatically. I don't mind to implement one, for the new line, but I'll 
allways have this problem with the specials characters.

From exarkun at divmod.com  Wed Aug 31 04:51:01 2005
From: exarkun at divmod.com (Jp Calderone)
Date: Wed Aug 31 04:51:03 2005
Subject: [Twisted-web] MochiKit, Nevow
In-Reply-To: <20050830183854.3914.1053739595.divmod.quotient.10269@ohm>
Message-ID: <20050831105101.3914.1229493998.divmod.quotient.10513@ohm>

On Tue, 30 Aug 2005 14:38:54 -0400, Jp Calderone <exarkun@divmod.com> wrote:
> [snip]
>
>I've started implementing a version of server.handle() which returns a 
>Deferred that fires with the return value of the handle_ method on the 
>server.  I'll be working on this in /branches/exarkun/callLater/, for anyone 
>who is interested in following development, contributing patches, or making 
>suggestions.

Ahem.  The branch is called "callRemote", not "callLater".  And there's stuff in it now.

Jp

From alberto.trujillo at ucd.ie  Wed Aug 31 04:59:27 2005
From: alberto.trujillo at ucd.ie (Alberto Trujillo)
Date: Wed Aug 31 04:54:59 2005
Subject: [Twisted-web] Multiple select box
Message-ID: <43158D8F.9020401@ucd.ie>

If I have a multiple select box, how can I receive all the selected items?
The next line only give me one value:
    items = contex.arg('selectbox')

Thanks

From dialtone at divmod.com  Wed Aug 31 04:54:57 2005
From: dialtone at divmod.com (Valentino Volonghi aka Dialtone)
Date: Wed Aug 31 04:55:03 2005
Subject: [Twisted-web] Problems with the new lines
In-Reply-To: <431589F7.7050607@ucd.ie>
References: <4315833E.40405@ucd.ie> <43158681.5080703@divmod.com>
	<431589F7.7050607@ucd.ie>
Message-ID: <43158C81.7000609@divmod.com>

Alberto Trujillo wrote:

> Do you know if there is any function in nevow that do this
> automatically. I don't mind to implement one, for the new line, but
> I'll allways have this problem with the specials characters.

No there is none. You might want to use something like markdown (or
napalm for the partial python implementation of Markdown in my sandbox)
or ReST (you have to install docutils) or textile or one of the many others.

If you just need to substitute the \n with <br /> just run a replace

description.replace('\n', '<br />')
before filling the slot so that you don't actually the original that the
user inserted.

-- 
Valentino Volonghi aka Dialtone
Now Running MacOSX 10.4.1
Blog: http://vvolonghi.blogspot.com
http://weever.berlios.de


From alberto.trujillo at ucd.ie  Wed Aug 31 05:36:52 2005
From: alberto.trujillo at ucd.ie (Alberto Trujillo)
Date: Wed Aug 31 05:32:38 2005
Subject: [Twisted-web] Problems with the new lines
In-Reply-To: <43158C81.7000609@divmod.com>
References: <4315833E.40405@ucd.ie> <43158681.5080703@divmod.com>
	<431589F7.7050607@ucd.ie> <43158C81.7000609@divmod.com>
Message-ID: <43159654.1080106@ucd.ie>

Valentino Volonghi aka Dialtone wrote:

>Alberto Trujillo wrote:
>
>  
>
>>Do you know if there is any function in nevow that do this
>>automatically. I don't mind to implement one, for the new line, but
>>I'll allways have this problem with the specials characters.
>>    
>>
>
>No there is none. You might want to use something like markdown (or
>napalm for the partial python implementation of Markdown in my sandbox)
>or ReST (you have to install docutils) or textile or one of the many others.
>
>If you just need to substitute the \n with <br /> just run a replace
>
>description.replace('\n', '<br />')
>before filling the slot so that you don't actually the original that the
>user inserted.
>
>  
>
Hi again Valentino. I've tried the method that you told me ...

description = data.description.replace('\n', '<br />')
ctx.fillSlots('description', description)

but now what I see is the next result:

line one<br />line 2

What's wrong?

From mary-twisted at puzzling.org  Wed Aug 31 05:54:01 2005
From: mary-twisted at puzzling.org (Mary Gardiner)
Date: Wed Aug 31 05:53:55 2005
Subject: [Twisted-web] Problems with the new lines
In-Reply-To: <43159654.1080106@ucd.ie>
References: <4315833E.40405@ucd.ie> <43158681.5080703@divmod.com>
	<431589F7.7050607@ucd.ie> <43158C81.7000609@divmod.com>
	<43159654.1080106@ucd.ie>
Message-ID: <20050831115401.GG19740@sourdust.home.puzzling.org>

On Wed, Aug 31, 2005, Alberto Trujillo wrote:
> but now what I see is the next result:
> 
> line one<br /> line 2

If you have a look at the source of the page you're downloading, you'll
probably see that what the web browser received was:
    line one&lt;br /&gt;line 2

That is, Nevow has escaped the HTML tag <br /> for you. This is the
default behaviour, to force it to not escape things, see this
http://divmod.org/users/wiki.twistd/nevow/moin.cgi/FrequentlyAskedQuestions#head-8d1353dfa7189fd6ee8d540737a44f1c3ba71dc6

Since Nevow is designed to produce XML from Python objects, you may find
that it's a better design to actually split up your string and use
tags.br where you want line breaks, rather than starting to use Nevow to
put tags in some places, but bypassing Nevow and inserting them directly
in other places.

-Mary

