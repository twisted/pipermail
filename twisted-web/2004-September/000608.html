<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] how to set charset of html page
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20how%20to%20set%20charset%20of%20html%20page&In-Reply-To=41362081.1040600%40yahoo.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000607.html">
   <LINK REL="Next"  HREF="000609.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] how to set charset of html page</H1>
    <B>Donovan Preston</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20how%20to%20set%20charset%20of%20html%20page&In-Reply-To=41362081.1040600%40yahoo.de"
       TITLE="[Twisted-web] how to set charset of html page">dp at ulaluma.com
       </A><BR>
    <I>Wed Sep  1 14:14:12 MDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000607.html">[Twisted-web] how to set charset of html page
</A></li>
        <LI>Next message: <A HREF="000609.html">[Twisted-web] Getting started using the twisted web server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#608">[ date ]</a>
              <a href="thread.html#608">[ thread ]</a>
              <a href="subject.html#608">[ subject ]</a>
              <a href="author.html#608">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Sep 1, 2004, at 3:18 PM, Benjamin Ferrari wrote:

&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> I just started with twisted, so I guess this is a very easy question:
</I>&gt;<i>
</I>&gt;<i> I run a twisted.web server with mktap:
</I>&gt;<i>
</I>&gt;<i> % mktap web --path /path/to/content
</I>&gt;<i> % twistd -nf web.tap
</I>&gt;<i>
</I>&gt;<i> and then put a simple html page into the path folder:
</I>&gt;<i>
</I>&gt;<i> &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; 
</I>&gt;<i> &quot;DTD/xhtml1-strict.dtd&quot;&gt;
</I>&gt;<i> &lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml&quot;">http://www.w3.org/1999/xhtml&quot;</A>&gt;
</I>&gt;<i> &lt;head&gt;
</I>&gt;<i>   &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; 
</I>&gt;<i> charset=iso-8859-1&quot;&gt;
</I>&gt;<i> &lt;/head&gt;
</I>&gt;<i> &lt;body&gt;...&lt;/body&gt;
</I>&gt;<i>
</I>&gt;<i> unfortunately, browsers (tested with firefox 0.9.3 and IE6) completly 
</I>&gt;<i> ignore the &lt;meta/&gt; tag and detect the page as UTF-8 instead of 
</I>&gt;<i> iso-8859-1.
</I>&gt;<i>
</I>&gt;<i> with apache, I can set a default charset to use with
</I>&gt;<i>
</I>&gt;<i> AddDefaultCharset iso-8859-1
</I>&gt;<i>
</I>&gt;<i> How can I do that with the twisted server ?
</I>
It's not a terribly easy question, although it should be. The trick is 
modify the contentTypes dictionary on the root twisted.web.static.File 
instance which was created when you ran mktap web. You should be able 
to do this with COIL, which is meant to allow you to configure 
application objects created with mktap using a nice GUI, but COIL 
hasn't been finished and nobody has been working on it recently. You 
could do this with manhole, which gives you a python interpreter inside 
your running server, but it might be a pain to get at the File 
instance.

So here is the solution I came up with. Instead of using mktap to 
create a generic application object, write a tac file instead, which is 
just a Python script that creates a custom application object. Modify 
the contentTypes dictionary in this script. Then, start the server 
using twistd -y instead of -f

Here is the script:

from twisted.application import service, internet
from twisted.web import server, static

application = service.Application(&quot;My web server&quot;)
root = static.File(&quot;/Users/dp&quot;)
root.contentTypes['.html'] = 'text/html; charset=iso-8859-1'
internet.TCPServer(8080, 
server.Site(root)).setServiceParent(application)

-- 
Donovan


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000607.html">[Twisted-web] how to set charset of html page
</A></li>
	<LI>Next message: <A HREF="000609.html">[Twisted-web] Getting started using the twisted web server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#608">[ date ]</a>
              <a href="thread.html#608">[ thread ]</a>
              <a href="subject.html#608">[ subject ]</a>
              <a href="author.html#608">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
