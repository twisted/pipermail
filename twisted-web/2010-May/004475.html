<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Newbie question : client connection lost
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Newbie%20question%20%3A%20client%20connection%20lost&In-Reply-To=4BE94580.2080201%40imperial.ac.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004474.html">
   <LINK REL="Next"  HREF="004476.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Newbie question : client connection lost</H1>
    <B>Sebastien PASTOR</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Newbie%20question%20%3A%20client%20connection%20lost&In-Reply-To=4BE94580.2080201%40imperial.ac.uk"
       TITLE="[Twisted-web] Newbie question : client connection lost">sebastien.pastor at gmx.com
       </A><BR>
    <I>Tue May 11 09:46:36 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="004474.html">[Twisted-web] Newbie question : client connection lost
</A></li>
        <LI>Next message: <A HREF="004476.html">[Twisted-web] Newbie question : client connection lost
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4475">[ date ]</a>
              <a href="thread.html#4475">[ thread ]</a>
              <a href="subject.html#4475">[ subject ]</a>
              <a href="author.html#4475">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It looks to me that this is what i am doin ... I really might be
doing something wrong here but can t see what.
The only difference with the livejournal's code is that i am trying to
run a blocking code so i am doing a threads.deferToThread instead of doing a 
callLater. 
To test the connection lost, client side i am disabling the wifi while
the server is blocking (sleeping). At the end of the blocking code:
request.write() and finish() are done as if the connection was available
and my ErrCallBack is not called.

I hope i am clear... in attachment the code i am using 


Thanks for your time

Seb






On Tue, May 11, 2010 at 12:54:40PM +0100, Phil Mayers wrote:
&gt;<i> On 11/05/10 13:23, Sebastien PASTOR wrote:
</I>&gt;<i> &gt; Thanks Phil,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I managed to be notified when the connection is cleanly closed by the
</I>&gt;<i> &gt; client (ie: browser is stop or close window).
</I>&gt;<i> &gt; But i could not handle non-clean connection closure (ie: when wifi  goes
</I>&gt;<i> &gt; down client side for instance). request.finish() does not event raise
</I>&gt;<i> &gt; any error. ...
</I>&gt;<i> &gt; I am a bit stuck here. .. any ideas ?
</I>&gt;<i> 
</I>&gt;<i> I'm not sure I follow.
</I>&gt;<i> 
</I>&gt;<i> Have a look at this to make sure you're using it properly:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://jcalderone.livejournal.com/50890.html">http://jcalderone.livejournal.com/50890.html</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-web mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">Twisted-web at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web</A>
</I>-------------- next part --------------
A non-text attachment was scrubbed...
Name: delay.py
Type: text/x-python
Size: 1083 bytes
Desc: not available
Url : <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20100511/36415b90/attachment.py">http://twistedmatrix.com/pipermail/twisted-web/attachments/20100511/36415b90/attachment.py</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004474.html">[Twisted-web] Newbie question : client connection lost
</A></li>
	<LI>Next message: <A HREF="004476.html">[Twisted-web] Newbie question : client connection lost
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4475">[ date ]</a>
              <a href="thread.html#4475">[ thread ]</a>
              <a href="subject.html#4475">[ subject ]</a>
              <a href="author.html#4475">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
