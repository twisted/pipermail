<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] How to pass invisible values with
	annotate.TypedInterface
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20How%20to%20pass%20invisible%20values%20with%0A%09annotate.TypedInterface&In-Reply-To=1103895356.25071.10.camel%40localhost.localdomain">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000990.html">
   <LINK REL="Next"  HREF="000991.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] How to pass invisible values with
	annotate.TypedInterface</H1>
    <B>Michael Wilson</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20How%20to%20pass%20invisible%20values%20with%0A%09annotate.TypedInterface&In-Reply-To=1103895356.25071.10.camel%40localhost.localdomain"
       TITLE="[Twisted-web] How to pass invisible values with
	annotate.TypedInterface">michael.wilson at gmail.com
       </A><BR>
    <I>Sat Dec 25 01:09:03 MST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000990.html">[Twisted-web] How to pass invisible values with
	annotate.TypedInterface
</A></li>
        <LI>Next message: <A HREF="000991.html">[Twisted-web] Re: [Nevow-commits] r1003 - Don't call getInterfaces
	over and over and over again
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#993">[ date ]</a>
              <a href="thread.html#993">[ thread ]</a>
              <a href="subject.html#993">[ subject ]</a>
              <a href="author.html#993">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Matt,

I took your advice, but I've run into a snag:

My URLs look like this: &quot;/admin/&quot; is a menu of options,
&quot;/admin/edit/2&quot; is, as you suggest, a page to edit something with an
id of 2. The code looks something like this:

class Admin(rend.page):
...
def locateChild(self, ctx, childsegments):
  function, id = map(str, childSegments)
  if function == &quot;edit&quot;:
    return Edit(id), []
...

Then:

class Edit(rend.page):

class IEdit(annotate.TypedInterface):
    
    def edit(
        self,
        ctx = annotate.Context(),
        name = annotate.String(required=True, label=&quot;Name&quot;,
          requiredFailMessage=&quot;Please enter the name&quot;)
        ):
        &quot;&quot;&quot;Editl

        Please enter information. &quot;&quot;&quot;
    edit = annotate.autocallable(edit)

class Edit(rend.Page):
    &quot;&quot;&quot;Render a custom and normal form for an ISomething.
    &quot;&quot;&quot;
    __implements__ = IEditSchool, rend.Page.__implements__
    addSlash = False
    
    child_webform_css = webform.defaultCSS
    
    def __init__(self,  id):
      rend.Page.__init__(self)
      self.id = int(float(id))
   
   .......
   docfactory = webform.renderForms()[aform]
   .........

The problem is this: when the child form is redered, the post URL is
&quot;edit/freeform_post!!edit&quot;, rather than &quot;./freeform_post!edit&quot;, as it
is when I don't use locateChild.

Second, the post is getting routed through the parent's locateChild,
and I'm not quite sure what to do with the &quot;freeform_post&quot;.

I can provide a more complete example, but it's very puzzling. I think
what I need to do is:

1. Get the form post URL to NOT include the parent(s), and/or
2. Get the form post routed correctly to the child's code (which is
where the form came from anyway).

Any ideas? 

P.S. Merry Christmas/Happy Holidays/etc :-)

On Fri, 24 Dec 2004 13:35:56 +0000, Matt Goodall &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">matt at pollenation.net</A>&gt; wrote:
&gt;<i> On Fri, 2004-12-24 at 00:35 -0800, Michael Wilson wrote:
</I>&gt;<i> &gt; My forms are modeled after the examples in examples/customform.py, and
</I>&gt;<i> &gt; I try and use this standard form definition in multiple places.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; In some cases, I would like to pass an invisible value with the form.
</I>&gt;<i> &gt; I know of two ways to do this:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 1. By adding arguments to the form URL (
</I>&gt;<i> &gt; action=&quot;./freeform_post!!doSomething?myarg1=...&quot;)
</I>&gt;<i> &gt; 2. By adding invisible fields to the form.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; What's the best way to do this?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; P.S. I've looked at the examples and the code, can't find the answer.
</I>&gt;<i> 
</I>&gt;<i> The renderer annotate.String tests for a hidden attribute. You can use
</I>&gt;<i> that to include a hidden field, i.e. foo=annotate.String(hidden=True).
</I>&gt;<i> However, hidden fields are not often that useful; perhaps you could make
</I>&gt;<i> better use of the URL?
</I>&gt;<i> 
</I>&gt;<i> A common use of hidden form fields is to include some object id in the
</I>&gt;<i> form so that, when the form is posted, you get the id back again. If
</I>&gt;<i> that's why you want a hidden field then you should seriously look at
</I>&gt;<i> using a URL like &quot;<A HREF="http://foo.com/news/1&quot;">http://foo.com/news/1&quot;</A> instead of
</I>&gt;<i> &quot;<A HREF="http://foo.com/news?id=1&quot;.">http://foo.com/news?id=1&quot;.</A> Request parameters are not a good way to
</I>&gt;<i> identify resources, IMHO.
</I>&gt;<i> 
</I>&gt;<i> Of course, if you have a different use case for a hidden form field then
</I>&gt;<i> please post an example. Perhaps it's something that formless/webform
</I>&gt;<i> should support in a more obvious way.
</I>&gt;<i> 
</I>&gt;<i> Cheers, Matt
</I>&gt;<i> 
</I>&gt;<i>
</I>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000990.html">[Twisted-web] How to pass invisible values with
	annotate.TypedInterface
</A></li>
	<LI>Next message: <A HREF="000991.html">[Twisted-web] Re: [Nevow-commits] r1003 - Don't call getInterfaces
	over and over and over again
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#993">[ date ]</a>
              <a href="thread.html#993">[ thread ]</a>
              <a href="subject.html#993">[ subject ]</a>
              <a href="author.html#993">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
