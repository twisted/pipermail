<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Re: [Nevow-commits] r952 - adding documentation for
	inevow.ISession
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Re%3A%20%5BNevow-commits%5D%20r952%20-%20adding%20documentation%20for%0A%09inevow.ISession&In-Reply-To=E1CeeR7-0004Ya-7M%40tesla.divmod.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000953.html">
   <LINK REL="Next"  HREF="000959.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Re: [Nevow-commits] r952 - adding documentation for
	inevow.ISession</H1>
    <B>Matt Goodall</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Re%3A%20%5BNevow-commits%5D%20r952%20-%20adding%20documentation%20for%0A%09inevow.ISession&In-Reply-To=E1CeeR7-0004Ya-7M%40tesla.divmod.com"
       TITLE="[Twisted-web] Re: [Nevow-commits] r952 - adding documentation for
	inevow.ISession">matt at pollenation.net
       </A><BR>
    <I>Wed Dec 15 13:34:38 MST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000953.html">[Twisted-web] Accessing ISession from formless autocallable
</A></li>
        <LI>Next message: <A HREF="000959.html">[Twisted-web] Re: [Nevow-commits] r952 - adding documentation for
	inevow.ISession
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#958">[ date ]</a>
              <a href="thread.html#958">[ thread ]</a>
              <a href="subject.html#958">[ subject ]</a>
              <a href="author.html#958">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 2004-12-15 at 14:03 -0500, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">dialtone at divmod.net</A> wrote:
&gt;<i> Author: dialtone
</I>&gt;<i> Date: Wed Dec 15 14:03:44 2004
</I>&gt;<i> New Revision: 952
</I>&gt;<i> 
</I>&gt;<i> Modified:
</I>&gt;<i>    trunk/nevow/inevow.py
</I>&gt;<i> Log:
</I>&gt;<i> adding documentation for inevow.ISession
</I>
Great stuff!

I'm just about to eat dinner so this is a bit rushed ...

I think we should differentiate between a typical session and a
guard/cred session. Most applications don't (and probably shouldn't)
care about the cred side of things except for some way to locate the
avatar.

It also looks like there's a good case for extracting a IComponentized
interface. Perhaps that's already been done for twisted 2?

So, how about a class hierarchy more like:

        class IComponentized(Interface):
            pass
        
        class ISession(IComponentized):
            pass
            
        class I(Guard|Cred)Session(ISession):
            pass

&gt;<i>From the (newly) current ISession class ...
</I>
setComponent, getComponent, unsetComponent, removeComponent would be
IComponentized methods, although unsetComponent looks unnecessary unless
it's the opposite of setComponent and there should also be an
addComponent.

getLoggedInRoot, resourceForPortal, setResourceForPortal, portalLogout,
are IGuardSession methods. However, getLoggedInRoot sounds strange, and
resourceForPortal and setResourceForPortal sound like guard
implementation.

setLifetime, notifyOnExpire, expire, touch, checkExpired are ISession
methods. However, IIRC checkExpired is an implementation method used as
the timed callback to automatically expire individual sessions.

Finally, of the attributes listed in the class docstring, I think only
uid and guard are part of the interface and guard should be part of
IGuardSession.

Hope that makes sense and that I didn't miss anything.

What do others think?

Cheers, Matt

&gt;<i> 
</I>&gt;<i> Modified: trunk/nevow/inevow.py
</I>&gt;<i> ==============================================================================
</I>&gt;<i> --- trunk/nevow/inevow.py	(original)
</I>&gt;<i> +++ trunk/nevow/inevow.py	Wed Dec 15 14:03:44 2004
</I>&gt;<i> @@ -378,13 +378,94 @@
</I>&gt;<i>      &quot;&quot;&quot;A web session
</I>&gt;<i>  
</I>&gt;<i>      You can locate a Session object to represent a unique web session using
</I>&gt;<i> -    ctx.locate(ISession). This default session implementation uses cookies to
</I>&gt;<i> +    ISession(ctx). This default session implementation uses cookies to
</I>&gt;<i>      store a session identifier in the user's browser. 
</I>&gt;<i> -    
</I>&gt;<i> +
</I>&gt;<i> +    guard: SessionWrapper object
</I>&gt;<i> +    uid: Session uid
</I>&gt;<i> +    expireCallbacks: callbacks for expiration event
</I>&gt;<i> +    checkExpiredID
</I>&gt;<i> +    portals: portals in which the session is logged in
</I>&gt;<i> +
</I>&gt;<i>      TODO: Need better docs; what's a session and why and how do you use it
</I>&gt;<i>      &quot;&quot;&quot;
</I>&gt;<i> -    
</I>&gt;<i> +    def getLoggedInRoot(self):
</I>&gt;<i> +        &quot;&quot;&quot;Get the most-recently-logged-in avatar.
</I>&gt;<i> +        &quot;&quot;&quot;
</I>&gt;<i> +
</I>&gt;<i> +    def resourceForPortal(self, port):
</I>&gt;<i> +        &quot;&quot;&quot;Gather the resource set for the portal port
</I>&gt;<i> +        &quot;&quot;&quot;
</I>&gt;<i> +
</I>&gt;<i> +    def setResourceForPortal(self, rsrc, port, logout):
</I>&gt;<i> +        &quot;&quot;&quot;Set returned resource when asking for something in portal port
</I>&gt;<i> +        logout is called when logged out from the resource
</I>&gt;<i> +        &quot;&quot;&quot;
</I>&gt;<i> +
</I>&gt;<i> +    def portalLogout(self, port):
</I>&gt;<i> +        &quot;&quot;&quot;Logout from portal port
</I>&gt;<i> +        &quot;&quot;&quot;
</I>&gt;<i> +
</I>&gt;<i> +    def setLifetime(self, lifetime):
</I>&gt;<i> +        &quot;&quot;&quot;Set the approximate lifetime of this session, in seconds.
</I>&gt;<i> +
</I>&gt;<i> +        This is highly imprecise, but it allows you to set some general
</I>&gt;<i> +        parameters about when this session will expire.  A callback will be
</I>&gt;<i> +        scheduled each 'lifetime' seconds, and if I have not been 'touch()'ed
</I>&gt;<i> +        in half a lifetime, I will be immediately expired.
</I>&gt;<i> +        
</I>&gt;<i> +        If you need to change the lifetime of all the sessions change sessionsLifeTime
</I>&gt;<i> +        attribute in class guard.SessionWrapper
</I>&gt;<i> +        &quot;&quot;&quot;
</I>&gt;<i> +
</I>&gt;<i> +    def notifyOnExpire(self, callback):
</I>&gt;<i> +        &quot;&quot;&quot;Call this callback when the session expires or logs out.
</I>&gt;<i> +        &quot;&quot;&quot;
</I>&gt;<i> +
</I>&gt;<i> +    def expire(self):
</I>&gt;<i> +        &quot;&quot;&quot;Expire/logout of the session.
</I>&gt;<i> +        &quot;&quot;&quot;
</I>&gt;<i> +
</I>&gt;<i> +    def touch(self):
</I>&gt;<i> +        &quot;&quot;&quot;Refresh the session
</I>&gt;<i> +        &quot;&quot;&quot;
</I>&gt;<i> +        
</I>&gt;<i> +    def checkExpired(self):
</I>&gt;<i> +        &quot;&quot;&quot; Check expiration state for the session
</I>&gt;<i> +        &quot;&quot;&quot;
</I>&gt;<i> +
</I>&gt;<i> +    def setComponent(self):
</I>&gt;<i> +        &quot;&quot;&quot;
</I>&gt;<i> +        Add a component to me, for all appropriate interfaces.
</I>&gt;<i> +        &quot;&quot;&quot;
</I>&gt;<i> +
</I>&gt;<i> +    def getComponent(self, interface, registry=None, default=None):
</I>&gt;<i> +        &quot;&quot;&quot;Create or retrieve an adapter for the given interface.
</I>&gt;<i> +
</I>&gt;<i> +        If such an adapter has already been created, retrieve it from the cache
</I>&gt;<i> +        that this instance keeps of all its adapters.  Adapters created through
</I>&gt;<i> +        this mechanism may safely store system-specific state.
</I>&gt;<i> +
</I>&gt;<i> +        If you want to register an adapter that will be created through
</I>&gt;<i> +        getComponent, but you don't require (or don't want) your adapter to be
</I>&gt;<i> +        cached and kept alive for the lifetime of this Componentized object,
</I>&gt;<i> +        set the attribute 'temporaryAdapter' to True on your adapter class.
</I>&gt;<i> +
</I>&gt;<i> +        If you want to automatically register an adapter for all appropriate
</I>&gt;<i> +        interfaces (with addComponent), set the attribute 'multiComponent' to
</I>&gt;<i> +        True on your adapter class.
</I>&gt;<i> +        &quot;&quot;&quot;
</I>&gt;<i> +        
</I>&gt;<i> +    def unsetComponent(self, interfaceClass):
</I>&gt;<i> +        &quot;&quot;&quot;Remove my component specified by the given interface class.&quot;&quot;&quot;
</I>&gt;<i> +
</I>&gt;<i> +    def removeComponent(self, component):
</I>&gt;<i> +        &quot;&quot;&quot;
</I>&gt;<i> +        Remove the given component from me entirely, for all interfaces for which
</I>&gt;<i> +        it has been registered.
</I>&gt;<i>  
</I>&gt;<i> +        @return: a list of the interfaces that were removed.
</I>&gt;<i> +        &quot;&quot;&quot;  
</I>&gt;<i>  
</I>&gt;<i>  class IRemainingSegments(compy.Interface):
</I>&gt;<i>      &quot;&quot;&quot;During the URL traversal process, requesting this from the context
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Nevow-commits mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">Nevow-commits at divmod.org</A>
</I>&gt;<i> <A HREF="http://divmod.org/users/mailman.twistd/listinfo/nevow-commits">http://divmod.org/users/mailman.twistd/listinfo/nevow-commits</A>
</I>

</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000953.html">[Twisted-web] Accessing ISession from formless autocallable
</A></li>
	<LI>Next message: <A HREF="000959.html">[Twisted-web] Re: [Nevow-commits] r952 - adding documentation for
	inevow.ISession
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#958">[ date ]</a>
              <a href="thread.html#958">[ thread ]</a>
              <a href="subject.html#958">[ subject ]</a>
              <a href="author.html#958">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
