<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Nevow: How to use sessions?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Nevow%3A%20How%20to%20use%20sessions%3F&In-Reply-To=915562750.1103016255%40%5B192.168.1.76%5D">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000938.html">
   <LINK REL="Next"  HREF="000941.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Nevow: How to use sessions?</H1>
    <B>Donovan Preston</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Nevow%3A%20How%20to%20use%20sessions%3F&In-Reply-To=915562750.1103016255%40%5B192.168.1.76%5D"
       TITLE="[Twisted-web] Nevow: How to use sessions?">dp at ulaluma.com
       </A><BR>
    <I>Tue Dec 14 09:01:06 MST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000938.html">[Twisted-web] Nevow: How to use sessions?
</A></li>
        <LI>Next message: <A HREF="000941.html">[Twisted-web] Nevow: How to use sessions?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#939">[ date ]</a>
              <a href="thread.html#939">[ thread ]</a>
              <a href="subject.html#939">[ subject ]</a>
              <a href="author.html#939">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Dec 14, 2004, at 6:24 AM, Mohamed Lrhazi wrote:

&gt;<i> Can someone give a helloworld example of how to store and retrieve 
</I>&gt;<i> objects specific to a session ? maybe a counter example. The objects 
</I>&gt;<i> would need to be destroyed automatically when the session expires.
</I>
The object returned from ISession(ctx) is yours to do with as you 
please. If your application is the only application which will be 
running on the server, then you can get and set attributes on it to 
store whatever information you like:

ISession(ctx).foo = 1

then later...

getattr(ISession(ctx), 'foo', None)

Which is kind of a pain...

However, if your application might be mixed and matched with other 
people's applications (not super likely at the moment) you may want to 
set a component on the session using an interface unique to your 
application:

&gt;<i> In the examples I see things like:
</I>&gt;<i>
</I>&gt;<i> def setupSession(self, ctx):
</I>&gt;<i>        #need to place the user, usermanager in the session
</I>&gt;<i>        inevow.ISession(ctx).setComponent(ICurrentUser, self.user)
</I>&gt;<i>        inevow.ISession(ctx).setComponent(IUserManager, 
</I>&gt;<i> self.userManager)
</I>&gt;<i> and
</I>&gt;<i>
</I>&gt;<i> self.userManager = request.session.getComponent(IUserManager)
</I>&gt;<i>
</I>&gt;<i> Can I just do that to store any object? do I have to create an 
</I>&gt;<i> interface for it?
</I>
If you want to do that, yes, you can do that. Just subclass 
compy.Interface and use any object as the component value. Instead of 
using request.session.getComponent, I would use the spelling:

IUserManager(ISession(ctx))

This will fail if the session has not had an IUserManager component set 
on it yet, however. You can pass a default value to the IUserManager 
adaption, or you can register an IUserManager adapter for GuardSession 
so that the adapter will automatically be constructed and set as a 
component on the session if it has not already. For example:

compy.registerAdapter(UserManager, GuardSession, IUserManager)

In this way, when you say IUserManager(ISession(ctx)) without having 
previously called setComponent on the session with the IUserManager 
interface, your UserManager adapter will be constructed and set on the 
session for you automatically. Future calls to 
IUserManager(ISession(ctx)) will return the same instance.

Hope this helps,
dp


</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000938.html">[Twisted-web] Nevow: How to use sessions?
</A></li>
	<LI>Next message: <A HREF="000941.html">[Twisted-web] Nevow: How to use sessions?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#939">[ date ]</a>
              <a href="thread.html#939">[ thread ]</a>
              <a href="subject.html#939">[ subject ]</a>
              <a href="author.html#939">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
