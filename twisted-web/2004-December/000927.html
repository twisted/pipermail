<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] maxlength input with formless
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20maxlength%20input%20with%20formless&In-Reply-To=20041204173522.GA13244%40dualathlon.random">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000923.html">
   <LINK REL="Next"  HREF="000935.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] maxlength input with formless</H1>
    <B>Tommi Virtanen</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20maxlength%20input%20with%20formless&In-Reply-To=20041204173522.GA13244%40dualathlon.random"
       TITLE="[Twisted-web] maxlength input with formless">tv at twistedmatrix.com
       </A><BR>
    <I>Sun Dec  5 01:05:43 MST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000923.html">[Twisted-web] maxlength input with formless
</A></li>
        <LI>Next message: <A HREF="000935.html">[Twisted-web] maxlength input with formless
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#927">[ date ]</a>
              <a href="thread.html#927">[ thread ]</a>
              <a href="subject.html#927">[ subject ]</a>
              <a href="author.html#927">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Andrea Arcangeli wrote:

&gt;<i>How can I define a maxlength for my input fields in a form? Do I need to
</I>&gt;<i>modify the formless module or is there a trick?
</I>&gt;<i>  
</I>&gt;<i>
</I>from formless import annotate

class MaxLenString(annotate.String):
    maxlen = 100

    def __init__(self, *args, **kwargs):
       if 'maxlen' in kwargs:
          self.maxlen = kwargs['maxlen']
          del kwargs['maxlen']
       super(MaxLenString, self).__init__(*args, **kwargs)

    def coerce(self, val, configurable):
       r = super(MaxLenString, self).coerce(val, configurable)
       if len(r) &gt; self.maxlen:
          raise annotate.InputError, &quot;%r is too long, maximum is %d.&quot; % 
(val, self.maxlen)
       return r

&gt;<i>Or can I use the css to set the maxlength based on the id? (I tried
</I>&gt;<i>that, but I couldn't find a way to do it with the css yet ;)
</I>&gt;<i>  
</I>&gt;<i>
</I>I think that while you can use CSS to set the size of the input box, 
there is
no CSS way to control the maximum number of characters one can input.

You can always override the renderer. I wish there was a nice way to not 
reimplement
the whole function..

from nevow import flat
from formless import iformless

class MaxLenStringRenderer(BaseInputRenderer):
    def input(self, context, slot, data, name, value):
        if data.typedValue.getAttribute('hidden'):
            T=&quot;hidden&quot;
        else:
            T=&quot;text&quot;
        return slot[
            input(id=keyToXMLID(context.key), type=T, name=name, 
value=value, maxlength=self.maxlen,
                  _class='freeform-input-%s' % T)]

flat.registerFlattener(MaxLenStringRenderer, MaxLenString, 
iformless.ITypedRenderer)


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000923.html">[Twisted-web] maxlength input with formless
</A></li>
	<LI>Next message: <A HREF="000935.html">[Twisted-web] maxlength input with formless
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#927">[ date ]</a>
              <a href="thread.html#927">[ thread ]</a>
              <a href="subject.html#927">[ subject ]</a>
              <a href="author.html#927">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
