<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Re: static file performance
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Re%3A%20static%20file%20performance&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003687.html">
   <LINK REL="Next"  HREF="003638.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Re: static file performance</H1>
    <B>David Bolen</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Re%3A%20static%20file%20performance&In-Reply-To="
       TITLE="[Twisted-web] Re: static file performance">db3l.net at gmail.com
       </A><BR>
    <I>Tue Mar  4 19:13:03 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="003687.html">[Twisted-web] static file performance
</A></li>
        <LI>Next message: <A HREF="003638.html">[Twisted-web] Re: static file performance
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3637">[ date ]</a>
              <a href="thread.html#3637">[ thread ]</a>
              <a href="subject.html#3637">[ subject ]</a>
              <a href="author.html#3637">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Phil Christensen &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">phil at bubblehouse.org</A>&gt; writes:

&gt;<i> Hi All,
</I>&gt;<i>
</I>&gt;<i> The previous thread about http server performance made me think of
</I>&gt;<i> something I've been meaning to ask about for a while.
</I>&gt;<i>
</I>&gt;<i> What is the best way to send static files to the client in
</I>&gt;<i> twisted.web? I know web2 had some preliminary support for mmap for
</I>&gt;<i> small files, but I know it didn't work the last time I checked, and
</I>&gt;<i> I'm trying to stick with twisted.web for now, anyways.
</I>&gt;<i>
</I>&gt;<i> I've just been using Apache to serve static content, but I'd love to
</I>&gt;<i> be able to use a pure-twisted solution.
</I>
I just use twisted.web.static.File - works fine.  You can subclass if
you want to give it a directory to provide access to all of its files,
but without enabling a directory listing (just override
directoryListing to return an error).

For single files, just instantiate static.File for the appropriate
file (on the fly or at startup), setting the content type if the
default mapping doesn't work.  For example, here's how I link in a
favorite icon file in one of my apps:

   favicon = static.File(os.path.join(static_dir, 'favicon.ico'),
                         defaultType='image/vnd.microsoft.icon')
   self.root.putChild('favicon.ico', favicon)

For large files, they're streamed appropriately (you can use the same
approach for your own dynamic content with static.FileTransfer, which I've
done for dynamic zip or mov file generation).

Generally, I structure my twisted.web applications so that on startup,
they construct an appropriate set of static.File objects and link them
into my root objects to provide full access to any static content.
Thus everything works in development with just the Twisted code.
Depending on deployment, you can leave it all that way, or if you
want, capture some of the static trees (like images) in a front end
server, so the requests never get to the Twisted app.  I often do
this, but it's probably more habit than anything else.

To be honest, while I'm sure there's a measurable overhead to serving
static content through Python/Twisted rather than a front end server
like Apache, I've never seen it be an issue.  Certainly streaming
large files are going to be more I/O bound than CPU bound anyway.

-- David


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003687.html">[Twisted-web] static file performance
</A></li>
	<LI>Next message: <A HREF="003638.html">[Twisted-web] Re: static file performance
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3637">[ date ]</a>
              <a href="thread.html#3637">[ thread ]</a>
              <a href="subject.html#3637">[ subject ]</a>
              <a href="author.html#3637">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
