<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] streaming request (was: status of Twisted Web
	and Web 2)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20streaming%20request%20%28was%3A%20status%20of%20Twisted%20Web%0A%09and%20Web%202%29&In-Reply-To=20080306173339.GB13580%40mcnabbs.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003671.html">
   <LINK REL="Next"  HREF="003678.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] streaming request (was: status of Twisted Web
	and Web 2)</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20streaming%20request%20%28was%3A%20status%20of%20Twisted%20Web%0A%09and%20Web%202%29&In-Reply-To=20080306173339.GB13580%40mcnabbs.org"
       TITLE="[Twisted-web] streaming request (was: status of Twisted Web
	and Web 2)">exarkun at divmod.com
       </A><BR>
    <I>Thu Mar  6 13:00:44 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="003671.html">[Twisted-web] streaming request (was: status of Twisted Web
	and Web 2)
</A></li>
        <LI>Next message: <A HREF="003678.html">[Twisted-web] streaming request (was: status of Twisted Web
	and Web 2)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3673">[ date ]</a>
              <a href="thread.html#3673">[ thread ]</a>
              <a href="subject.html#3673">[ subject ]</a>
              <a href="author.html#3673">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 6 Mar 2008 10:33:39 -0700, Andrew McNabb &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">amcnabb at mcnabbs.org</A>&gt; wrote:
&gt;<i>On Thu, Mar 06, 2008 at 12:22:04PM -0500, Christopher Armstrong wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Ok, so the new interface is request.getStreamingData(). So the
</I>&gt;&gt;<i> explanation of the new feature is either:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &quot;Implement dataReceived and call getStreamingData on the request and
</I>&gt;&gt;<i> add self.dataReceived as a callback&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> or
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &quot;declare implements(IStreamingRequestHandler) and implement dataReceived&quot;.
</I>&gt;<i>
</I>&gt;<i>Now we understand each other.
</I>&gt;<i>
</I>&gt;&gt;<i> Is the former really simpler? Does it really offer any benefit?
</I>&gt;<i>
</I>&gt;<i>I am opposed to creating a brand new IStreamingRequestHandler.  That's
</I>&gt;<i>just more conceptual overhead.  However, if it were to use something
</I>&gt;<i>that already exists, like IProtocol as Glyph suggested, I would be more
</I>&gt;<i>accepting.
</I>
FWIW, IConsumer is a better match here than IProtocol (that's a more or
less irrelevant detail, though).

&gt;<i>
</I>&gt;<i>In that case the difference is that the former has an event-driven feel
</I>&gt;<i>and the latter doesn't.  Which is better?  It depends on what you're
</I>&gt;<i>doing.  If you have multiple places that need notification that data
</I>&gt;<i>have arrived (as is the case in my situation), there are some definite
</I>&gt;<i>advantages to the event-driven approach.  However, the latter is
</I>&gt;<i>probably a little faster.
</I>&gt;<i>
</I>
They're equally &quot;event-driven&quot;, so I think the feeling you have is only
due to familiarity or personal preference. :)

That said, here's where I see IStreamingRequestHandler as better than
re-using an existing interface like IProtocol or IConsumer:

  * IConsumer is a very general interface.  It provides no clues about its
    interaction with the HTTP protocol implementation.  There's no way to
    deduce that if an IResource is also an IConsumer that uploads will be
    streamed to it instead of delivered all at once at the end.  On the
    other hand, IStreamingRequestHandler can have documentation which
    describes its purpose and behavior.

  * IConsumer has existing semantics.  There's no reason an existing
    IResource implementation might not already be an IConsumer as well,
    for a completely unrelated reason.  If it suddenly starts to receive
    streaming upload data, it will almost certainly break.  On the other
    hand, IStreamingRequestHandler is a new interface, so it cannot be
    misinterpreted.

  * IConsumer isn't actually sufficiently expressive for this case.  It
    would be quite useful if the resource had a chance to look at the
    request headers before streaming begins (okay, I didn't bring this up
    earlier, so it may have seemed like IConsumer was sufficient).  On the
    other hand, IStreamingRequestHandler can have a method which takes the
    request as an argument.

It may be the case that the right method for IStreamingRequestHandler to
have, though, is one which takes the request and returns an IConsumer to
which the request body will be streamed.

Jean-Paul

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003671.html">[Twisted-web] streaming request (was: status of Twisted Web
	and Web 2)
</A></li>
	<LI>Next message: <A HREF="003678.html">[Twisted-web] streaming request (was: status of Twisted Web
	and Web 2)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3673">[ date ]</a>
              <a href="thread.html#3673">[ thread ]</a>
              <a href="subject.html#3673">[ subject ]</a>
              <a href="author.html#3673">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
