<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> WSGI support (was [Twisted-web] Re: status of Twisted Web and
	Web	2)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=WSGI%20support%20%28was%20%5BTwisted-web%5D%20Re%3A%20status%20of%20Twisted%20Web%20and%0A%09Web%092%29&In-Reply-To=47D040CC.6050606%40libero.it">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003677.html">
   <LINK REL="Next"  HREF="003685.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>WSGI support (was [Twisted-web] Re: status of Twisted Web and
	Web	2)</H1>
    <B>David Reid</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=WSGI%20support%20%28was%20%5BTwisted-web%5D%20Re%3A%20status%20of%20Twisted%20Web%20and%0A%09Web%092%29&In-Reply-To=47D040CC.6050606%40libero.it"
       TITLE="WSGI support (was [Twisted-web] Re: status of Twisted Web and
	Web	2)">dreid at dreid.org
       </A><BR>
    <I>Thu Mar  6 18:17:59 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="003677.html">WSGI support (was [Twisted-web] Re: status of Twisted Web and
	Web	2)
</A></li>
        <LI>Next message: <A HREF="003685.html">WSGI support (was [Twisted-web] Re: status of Twisted Web and Web
	2)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3683">[ date ]</a>
              <a href="thread.html#3683">[ thread ]</a>
              <a href="subject.html#3683">[ subject ]</a>
              <a href="author.html#3683">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Mar 6, 2008, at 11:06 AM, Manlio Perillo wrote:

&gt;<i> Phil Christensen ha scritto:
</I>&gt;&gt;<i> On Mar 6, 2008, at 10:56 AM, David Reid wrote:
</I>&gt;&gt;&gt;<i> On Mar 6, 2008, at 2:00 AM, Manlio Perillo wrote:
</I>&gt;&gt;&gt;&gt;<i> I think that having a &quot;pure&quot; asynchronous WSGI implementation in  
</I>&gt;&gt;&gt;&gt;<i> Twisted Web that implements this extension can be a good starting  
</I>&gt;&gt;&gt;&gt;<i> point for trying to standardize asynchronous web applications.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> P.S.: the wsgi.pause_output extension, proposed some years ago  
</I>&gt;&gt;&gt;&gt;<i> here by Donovan Preston should be very easy to implement using  
</I>&gt;&gt;&gt;&gt;<i> ngx.poll, and a pipe.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Does anyone support said extension?  Does everyone support the  
</I>&gt;&gt;&gt;<i> same pause_output? Or just functions of the same name?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> It shouldn't be very hard to add support for it to Twisted.web2's  
</I>&gt;&gt;&gt;<i> WSGI implementation either, but I don't much see the point if no  
</I>&gt;&gt;&gt;<i> one else supports it.  I'm not convinced that WSGI is at all a  
</I>&gt;&gt;&gt;<i> useful means of writing asynchronous web applications.  I think  
</I>&gt;&gt;&gt;<i> WSGI's only benefit is that it allows you to almost write your  
</I>&gt;&gt;&gt;<i> application code once and run it on multiple containers.
</I>&gt;&gt;<i> I'd have to disagree (slightly). There's nothing about WSGI that  
</I>&gt;&gt;<i> makes it only applicable to one approach or another (that is,  
</I>&gt;&gt;<i> synchronous versus asynchronous).
</I>&gt;<i>
</I>&gt;<i> Right.
</I>&gt;<i> This is what makes WSGI great.
</I>
Read: &quot;So the thing I like about WSGI is that it's actually poorly  
specified&quot;

Why is attempting to adapt a currently synchronous API (the WSGI  
application API is synchronous) It's supposed to allow you to write  
web applications that may be able to run singlethreaded, multithreaded  
or in a multiprocess environment, it doesn't specify an asynchronous  
API.   If it did applications would still need to be written in an  
asynchronous manner.

Threads are the only way to make blocking code appear to be non- 
blocking.
Processes are the only way to make blocking code actually not block.

&gt;&gt;<i> It's just as easy to write a Deferred-using asynchronous  
</I>&gt;&gt;<i> application as a blocking one.
</I>
It would be, except it's not at all specified that that is a thing you  
can do.  PEP 333 sure has no mention of Deferreds.

&gt;&gt;<i> The real issue is that a &quot;proper&quot; WSGI app gets informed of it's  
</I>&gt;&gt;<i> environment by the wsgi.multithreaded and wsgi.multiprocess environ  
</I>&gt;&gt;<i> variables, so if you really wanted a write-once-run-anywhere, you'd  
</I>&gt;&gt;<i> need to be able to handle both scenarios.
</I>&gt;<i>
</I>&gt;<i> By the way, some time ago I proposed a wsgi.asynchronous enviroment  
</I>&gt;<i> variable.
</I>
I don't get it.  I don't see the point at all.  I can't make blocking  
code magically not-block.  I could use a middlewear that translated  
from wsgi.asynchronous to a wsgi.multithreaded or wsgi.multiprocess  
implementation for running my synchronous code, but I don't think  
there are any benefits to a wsgi.asynchronous API at all.

I can reasonably write an application that honestly doesn't care if  
it's being serialized, run in threads, or run in seperate processes.   
As soon as you throw wsgi.asynchronous into the mix I lose that ability.

&gt;<i>
</I>&gt;&gt;<i> As far as Twisted's WSGI implementation, it should probably support  
</I>&gt;&gt;<i> both approaches, maybe where some kind of argument to the  
</I>&gt;&gt;<i> WSGIResource class constructor determines what it specifies in the  
</I>&gt;&gt;<i> environ dictionary. It should be the responsibility of the WSGI  
</I>&gt;&gt;<i> application itself to do the right thing depending on what's inside  
</I>&gt;&gt;<i> the environ dict.
</I>&gt;<i>
</I>&gt;<i> I'm not sure that this is possible.
</I>&gt;<i> An application is asynchronous or synchronous.
</I>
Exactly so why should we try to make the same API do both?
&gt;<i>
</I>
All that being said I'm perfectly happy to accept patches that enhance  
twisted's wsgi support, but I feel no inclination to support anything  
out of spec.

-David

&quot;Usually the protocol is this: I appoint someone for a task,
which they are not qualified to do.  Then, they have to fight
a bear if they don't want to do it.&quot; -- Glyph Lefkowitz







</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003677.html">WSGI support (was [Twisted-web] Re: status of Twisted Web and
	Web	2)
</A></li>
	<LI>Next message: <A HREF="003685.html">WSGI support (was [Twisted-web] Re: status of Twisted Web and Web
	2)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3683">[ date ]</a>
              <a href="thread.html#3683">[ thread ]</a>
              <a href="subject.html#3683">[ subject ]</a>
              <a href="author.html#3683">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
