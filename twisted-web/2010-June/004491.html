<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] parsing xml coming from a socket
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20parsing%20xml%20coming%20from%20a%20socket&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="004492.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] parsing xml coming from a socket</H1>
    <B>Antonis Kaklis</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20parsing%20xml%20coming%20from%20a%20socket&In-Reply-To="
       TITLE="[Twisted-web] parsing xml coming from a socket">kaklis at gmail.com
       </A><BR>
    <I>Tue Jun  1 09:46:58 EDT 2010</I>
    <P><UL>
        
        <LI>Next message: <A HREF="004492.html">[Twisted-web] parsing xml coming from a socket
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4491">[ date ]</a>
              <a href="thread.html#4491">[ thread ]</a>
              <a href="subject.html#4491">[ subject ]</a>
              <a href="author.html#4491">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi to all, and since this is my first post, congratulations for the perfect
framework.
i have the following code

class SimpleServer(LineReceiver):

    def connectionMade(self):
        print 'Connection from: ', self.transport.client

    def connectionLost(self, reason):
        print self.transport.client, 'Disconnected'

    def dataReceived(self, line):
        &quot;&quot;&quot;Here the XML Parser&quot;&quot;&quot;

        p = xml.parsers.expat.ParserCreate()

        p.StartElementHandler = start_element
        p.EndElementHandler = end_element
        p.CharacterDataHandler = char_data
        p.Parse(line, 1)

I got the following error
--- &lt;exception caught here&gt; ---
  File &quot;/usr/lib/python2.6/site-packages/Twisted-10.0.0-py2.6-linux-
x86_64.egg/twisted/internet/selectreactor.py&quot;, line 146, in
_doReadOrWrite
    why = getattr(selectable, method)()
  File &quot;/usr/lib/python2.6/site-packages/Twisted-10.0.0-py2.6-linux-
x86_64.egg/twisted/internet/tcp.py&quot;, line 460, in doRead
    return self.protocol.dataReceived(data)
  File &quot;stdiodemo.py&quot;, line 419, in dataReceived
    p.Parse(line, 1)
xml.parsers.expat.ExpatError: syntax error: line 1, column 0

The XML Message is coming in the form of:

POST /test/pcp/Listener HTTP/1.1
user-agent:hjahs
Host:127.0.0.1
Content-Length: 547

&lt;pttv_control_message version=&quot;1.0-M4-SNAPSHOT&quot; build=&quot;599&quot;
xmlns=&quot;<A HREF="http://1270.0.01/pttv&lt;http://www.google.com/url?sa=D&amp;q=http://1270.0.01/pttv&amp;usg=AFQjCNEPqmRku5kV0nsb3RICWIxQ8vOV9A">http://1270.0.01/pttv&lt;http://www.google.com/url?sa=D&amp;q=http://1270.0.01/pttv&amp;usg=AFQjCNEPqmRku5kV0nsb3RICWIxQ8vOV9A</A>&gt;&quot;&gt;

  &lt;cmdReply&gt;
    &lt;code&gt;200&lt;/code&gt;
    &lt;message&gt;OK, found 5 session entries&lt;/message&gt;
    &lt;sessionList&gt;
      &lt;session&gt;
        &lt;id&gt;06d4d59bfdfe10139dd874&lt;/id&gt;
        &lt;subscriberId&gt;82&lt;/subscriberId&gt;
        &lt;deviceClass&gt;and&lt;/deviceClass&gt;
      &lt;/session&gt;
    &lt;/sessionList&gt;
  &lt;/cmdReply&gt;
&lt;/pttv_control_message&gt;
Please give me some hints.
How to parse the incoming XML and how to ommit the headers from the
beginning of the message?

Thanks in advance
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20100601/af08609e/attachment.htm">http://twistedmatrix.com/pipermail/twisted-web/attachments/20100601/af08609e/attachment.htm</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="004492.html">[Twisted-web] parsing xml coming from a socket
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4491">[ date ]</a>
              <a href="thread.html#4491">[ thread ]</a>
              <a href="subject.html#4491">[ subject ]</a>
              <a href="author.html#4491">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
