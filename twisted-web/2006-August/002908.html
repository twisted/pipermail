<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] [Nevow] about new guard in sandbox
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5BNevow%5D%20about%20new%20guard%20in%20sandbox&In-Reply-To=20060731205247.1717.2093160798.divmod.quotient.9709%40ohm">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002923.html">
   <LINK REL="Next"  HREF="002909.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] [Nevow] about new guard in sandbox</H1>
    <B>Manlio Perillo</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5BNevow%5D%20about%20new%20guard%20in%20sandbox&In-Reply-To=20060731205247.1717.2093160798.divmod.quotient.9709%40ohm"
       TITLE="[Twisted-web] [Nevow] about new guard in sandbox">manlio_perillo at libero.it
       </A><BR>
    <I>Tue Aug  1 03:40:20 CDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002923.html">[Twisted-web] Re: FileSaver bug
</A></li>
        <LI>Next message: <A HREF="002909.html">[Twisted-web] [Nevow] about new guard in sandbox
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2908">[ date ]</a>
              <a href="thread.html#2908">[ thread ]</a>
              <a href="subject.html#2908">[ subject ]</a>
              <a href="author.html#2908">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Valentino Volonghi aka Dialtone ha scritto:
&gt;<i> On Mon, 31 Jul 2006 21:05:26 +0200, Manlio Perillo
</I>&gt;<i> &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">manlio_perillo at libero.it</A>&gt; wrote:
</I>&gt;&gt;<i> Hi again.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have read the draft implementation of guard in Valentino's sandbox and
</I>&gt;&gt;<i> I like it.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> However I have some questions:
</I>&gt;&gt;<i> - why the ISessionMenager interface does not include a name attribute
</I>&gt;&gt;<i>  (since the default Session class uses the private _name)?
</I>&gt;<i> 
</I>&gt;<i> The reason why it misses the name in the interface is that it's not
</I>&gt;<i> meant to be accessible from the outside. It's a pretty important
</I>&gt;<i> internal detail in _this_ SessionManager implementation. There might be
</I>&gt;<i> many other ways to deal with distributed session rather than simply
</I>&gt;<i> using name attribute on the sessionmanager and ISessionManager ought to
</I>&gt;<i> be as generic as possible.
</I>&gt;<i> 
</I>
Ok.
Now I also understand your concern about identifying who creates a session.

Only a question: in the example you only store (in the database)
&quot;permanent&quot; sessions.
Not sure about this, but I think that all sessions, except those for
anonymous access, should be persisted in the database (to avoid problems
in a distributed system).

&gt;&gt;<i> - why Session.authenticatedAs has to be a property?
</I>&gt;<i> 
</I>&gt;<i> Because I wasn't able to find a better name that was somewhat compatible
</I>&gt;<i> to using an explicit get/set. And because it's cleaner IMHO.
</I>&gt;<i> 
</I>
Not sure. ;-)

&gt;&gt;<i> - I think that there is no need to store tha password but only the
</I>&gt;&gt;<i>  username, so authenticatedAs -&gt; avatarID
</I>&gt;<i> 
</I>&gt;<i> Not really... Authentication is rerun for each request because the
</I>&gt;<i> avatar is not saved and this is the most important detail of that new
</I>&gt;<i> guard. 
</I>
Here I'm not sure to understand.
You mean that the avatarID (username) is not stored in the session
object? This seems not the case.

Another thing: is it really necessary to create a session for anonymous
access?

And what about to store the authenticated username in the context
(instead of hacking on the site.makeSession)?

&gt;<i> Also the avatarId is not available in guard because it's a cred
</I>&gt;<i> implementation detail. And the avatarId might be any object. But I'm
</I>&gt;<i> open for alternative solutions.
</I>&gt;<i> 
</I>

&gt;&gt;<i> - what's the use for the guard attribute in Session?
</I>&gt;<i> 
</I>&gt;<i> It's explained in the docstring of loggedIn (somehow). It's because it
</I>&gt;<i> makes
</I>&gt;<i> it easier to access the guard that created the session.
</I>&gt;<i> 
</I>&gt;&gt;<i> - I think that ISessionManager should not have the loggedIn method.
</I>&gt;<i> 
</I>&gt;<i> Why? It allows to change how the application should react to a successfully
</I>&gt;<i> logged in session without going through guard code overriding a
</I>&gt;<i> callback, of a very big method, defined as a closure. IMHO it's a lot
</I>&gt;<i> cleaner to have it this way unless your reasons are sensible.
</I>&gt;<i> 
</I>
I'm against this because I whould like to have a realy reusable
SessionManager.

The SessionManager is really an useful class and it should not depend
over a SessionWrapper (because I can choose to not use a SessionWrapper
al all).

&gt;&gt;<i> - as I can see the code in SessionManager._tick causes the log
</I>&gt;&gt;<i>  &quot;Session %r expired&quot; to be issued two times.
</I>&gt;<i> 
</I>&gt;<i> True.
</I>&gt;<i> 
</I>&gt;&gt;<i> - what's the use for mind in a web authentication?
</I>&gt;<i> 
</I>&gt;<i> I have no idea. There might be a usage, why should you make it impossible
</I>&gt;<i> to have a usage of it?
</I>&gt;<i> 
</I>&gt;&gt;<i> - why credInterface is a variable? It can be something different from
</I>&gt;&gt;<i>  IResource?
</I>&gt;<i> 
</I>&gt;<i> iweb2.IResource? Anyway this is absolutely not a valid concern it's simply
</I>&gt;<i> a refactoring to allow changing that interface from application level
</I>&gt;<i> code (again without the need to dig through the code).
</I>&gt;<i> 
</I>
Yes, this is not a valid concern but I like to have code that is as much
symple as possible, where I don't have to try to understand every
statement. ;-)

&gt;<i> [...]
</I>
&gt;<i> Also keep in mind that the most developed version of that code lies in:
</I>&gt;<i> <A HREF="http://hg.stiq.it/index.cgi/stiq?f=b9671c61c96b;file=stiq/guard.py;style=gitweb">http://hg.stiq.it/index.cgi/stiq?f=b9671c61c96b;file=stiq/guard.py;style=gitweb</A>
</I>&gt;<i> 
</I>&gt;<i> and
</I>&gt;<i> <A HREF="http://hg.stiq.it/index.cgi/stiq?f=eef00c91fd79;file=stiq/session.py;style=gitweb">http://hg.stiq.it/index.cgi/stiq?f=eef00c91fd79;file=stiq/session.py;style=gitweb</A>
</I>&gt;<i>
</I>

Ok, thanks.
Now I'm trying to learn as much as possible about web authentication
because it seems that it does not exists an unique solution.

As an example a valid alternative to store state in the server is to
store it in the cookie.

NEVOW_SESSION=&quot;username=manlio&amp;last_accessed=...&amp;created=...&quot;

of course using some cryptography.

This has the advantage to work &quot;as is&quot; in a distributed system and to
not depend on the number of sessions/users.




Thanks and regards  Manlio Perillo

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002923.html">[Twisted-web] Re: FileSaver bug
</A></li>
	<LI>Next message: <A HREF="002909.html">[Twisted-web] [Nevow] about new guard in sandbox
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2908">[ date ]</a>
              <a href="thread.html#2908">[ thread ]</a>
              <a href="subject.html#2908">[ subject ]</a>
              <a href="author.html#2908">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
