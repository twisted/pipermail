<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] web2: handling data from an http PUT request?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20web2%3A%20handling%20data%20from%20an%20http%20PUT%20request%3F&In-Reply-To=20060811180858.AC44F84C238%40cube2.nefud.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002960.html">
   <LINK REL="Next"  HREF="002962.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] web2: handling data from an http PUT request?</H1>
    <B>David Reid</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20web2%3A%20handling%20data%20from%20an%20http%20PUT%20request%3F&In-Reply-To=20060811180858.AC44F84C238%40cube2.nefud.org"
       TITLE="[Twisted-web] web2: handling data from an http PUT request?">dreid at dreid.org
       </A><BR>
    <I>Fri Aug 11 15:46:02 CDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002960.html">[Twisted-web] web2: handling data from an http PUT request?
</A></li>
        <LI>Next message: <A HREF="002962.html">[Twisted-web] t.i.e.ConnectionDone: Connection was closed cleanly
	error, using getPage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2961">[ date ]</a>
              <a href="thread.html#2961">[ thread ]</a>
              <a href="subject.html#2961">[ subject ]</a>
              <a href="author.html#2961">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Aug 11, 2006 at 11:08:58AM -0700, Allan Bailey wrote:
&gt;<i> 
</I>&gt;<i> Does anyone have an example of how to handle data from an http PUT method?
</I>&gt;<i> 
</I>&gt;<i> So far I'm only getting partial data from the below example.
</I>&gt;<i> 
</I>&gt;<i> Note: I'm fairly new to twisted and using deferred's.  So if I'm missing something
</I>&gt;<i> please let me know, or send pointers.
</I>&gt;<i> 
</I>&gt;<i> thanks,
</I>&gt;<i> -allan
</I>&gt;<i> 
</I>&gt;<i>         data = req.stream.read()
</I>
This only reads the data that is immediately available, if no data is
immediately available it returns a deferred that results in the data.
Only calling read once can not possibly guarantee that all the data
has been read.  Instead you need to call read until it returns None.
Luckily there is a convenience API for doing just that.

from twisted.web2.stream import readStream

data = []

def gotData(newdata):
    data += newdata

d = readStream(req.stream, gotData)

def _finishedReading(ignore):
    doSomethingWith(data)

d.addCallback(_finishedReading)

&gt;<i>     def http_PUT(self, req):
</I>&gt;<i>         return self.render_PUT(req)
</I>
This seems silly.

-David

-- 
&quot;Usually the protocol is this: I appoint someone for a task,
which they are not qualified to do.  Then, they have to fight
a bear if they don't want to do it.&quot; -- Glyph Lefkowitz

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002960.html">[Twisted-web] web2: handling data from an http PUT request?
</A></li>
	<LI>Next message: <A HREF="002962.html">[Twisted-web] t.i.e.ConnectionDone: Connection was closed cleanly
	error, using getPage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2961">[ date ]</a>
              <a href="thread.html#2961">[ thread ]</a>
              <a href="subject.html#2961">[ subject ]</a>
              <a href="author.html#2961">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
