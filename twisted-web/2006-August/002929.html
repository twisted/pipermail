<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] [Nevow] new chapter about authentication
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5BNevow%5D%20new%20chapter%20about%20authentication&In-Reply-To=20060802005506.1717.1333780701.divmod.quotient.11617%40ohm">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002922.html">
   <LINK REL="Next"  HREF="002930.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] [Nevow] new chapter about authentication</H1>
    <B>Manlio Perillo</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5BNevow%5D%20new%20chapter%20about%20authentication&In-Reply-To=20060802005506.1717.1333780701.divmod.quotient.11617%40ohm"
       TITLE="[Twisted-web] [Nevow] new chapter about authentication">manlio_perillo at libero.it
       </A><BR>
    <I>Thu Aug  3 05:17:03 CDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002922.html">[Twisted-web] [Nevow] new chapter about authentication
</A></li>
        <LI>Next message: <A HREF="002930.html">[Twisted-web] [Nevow] new chapter about authentication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2929">[ date ]</a>
              <a href="thread.html#2929">[ thread ]</a>
              <a href="subject.html#2929">[ subject ]</a>
              <a href="author.html#2929">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Valentino Volonghi aka Dialtone ha scritto:
&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Tue, 01 Aug 2006 21:09:55 +0200, Manlio Perillo
</I>&gt;<i> &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">manlio_perillo at libero.it</A>&gt; wrote:
</I>&gt;&gt;<i> Hi.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have written a new chapter for authentication.
</I>&gt;&gt;<i> It is still a draft (as always), and don't forget that I'm not an expert.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="http://svn.python.it/twisted/trunk/contrib/nevow/doc/txt/nevow-authentication.txt">http://svn.python.it/twisted/trunk/contrib/nevow/doc/txt/nevow-authentication.txt</A>
</I>&gt;&gt;<i>
</I>
First of all, thanks for your review.

&gt;<i> 
</I>&gt;<i> Line 13:
</I>&gt;<i> stateful is totally wrong and the opposite. Should be stateless.
</I>&gt;<i>
</I>
Yes, a mistake.

&gt;<i> Line 15:
</I>&gt;<i> Authenticate user means not only to assure that a user is who claims
</I>&gt;<i> he is, but also to assure that a hostile user can gain unauthorized
</I>                                               ^^^^
                                               can not
&gt;<i> access.
</I>&gt;<i> 
</I>&gt;<i> I think this is wrong. 
</I>
Yes.

&gt;<i> Authentication is just recognizing who is the
</I>&gt;<i> user. Authorization is a different aspect that should be dealt with at a
</I>&gt;<i> different level, although using the avatar concept it can be done in one
</I>&gt;<i> step at cred level.
</I>&gt;<i> 
</I>
I'm interested in this.
Are there any examples?

I would like to add a section on authorization, too.

&gt;<i> Line 19:
</I>&gt;<i> The most secure way is to use HTTPS, based on SSL. But SSL can cause
</I>&gt;<i> too burden on an application.
</I>&gt;<i> 
</I>&gt;<i> The most secure way to do what?
</I>&gt;<i> 
</I>
To use sessions.

&gt;<i> Line 25:
</I>&gt;<i> The standard way to do authentication is via HTTP Basic
</I>&gt;<i> Authentication, witch is supported in Twisted Web.
</I>&gt;<i> 
</I>&gt;<i> Since this is a Nevow tutorial this should mention that it is supported
</I>&gt;<i> by Nevow.guard. 
</I>
Yes, you are right.

&gt;<i> The simple example is good although with guard it's even
</I>&gt;<i> less than that.
</I>&gt;<i> 
</I>
Ok, but I think it is better a bottom up approach.
This allow one to understand (and appreciate) better what Nevow offers.

&gt;<i> Line 82:
</I>&gt;<i> * when an user want to change the email and you send the forgotten
</I>&gt;<i>  password via email, ask for the password.
</I>&gt;<i> 
</I>&gt;<i> This is just senseless. I forgot the password and I want it back. To
</I>&gt;<i> have it back I should insert it? Didn't I forget it?
</I>&gt;<i> 
</I>
No, you misunderstand what I have written ;-).

The system should ask for the user password when the user wants to
change its email address.
This is important *if* the system allow an user to ask for its forgotten
password and this is sent to its email address.

An attacker (that obtained a valid session ID) can change the account
email address and ask for the password!

&gt;<i> Line 90:
</I>&gt;<i> IMHO this section is not clear enough (if at all).
</I>&gt;<i> 
</I>
Well, I just put in some things I have read, without some review.

However note that I'm considering HTTP Basic Authentication without
sessions, so an user is required to supply credentials for every resource.

This means that there is no support for anonymous user.


&gt;<i> Session section:
</I>&gt;<i> Why is it suggested to use cookies when at the end of the same
</I>&gt;<i> subsection you say that this approach has several flaws?
</I>&gt;<i> 
</I>
Because, by design, sessions are not good for authentication.
However cookies based sessions are better that URL based sessions or
form based sessions.

The only flaw of a well written session management system (as I can
understand) is a replication attack (done by someone that can see the
traffic beetwen client and server).

This assuming that one isn't using permanent sessions.

&gt;<i> Line 244:
</I>&gt;<i> The difference between random/urandom is not that one returns a string
</I>&gt;<i> and the other doesn't. urandom uses /dev/urandom on UNIXes (not
</I>&gt;<i> available on Windows) while random.random uses a pseudo random number
</I>&gt;<i> generator.
</I>&gt;<i> 
</I>
I'm not saying this (but I must explain better the difference beetwen
urandom and random).

Really, there I'm asking: &quot;why to use a float number?&quot; ;-)

&gt;<i> Line 404:
</I>&gt;<i> The &quot;Remember Me&quot; feature is more than that. It's a persistent session
</I>&gt;<i> and cookie. 
</I>
Ok, I have to add some more words.

&gt;<i> A persistent cookie for a day or so can be used when a
</I>&gt;<i> simple login is done. Transient cookies and session for anonymous sessions.
</I>&gt;<i> 
</I>&gt;<i> Line 41x:
</I>&gt;<i> This looks WAAAAAAY too paranoid for the real risks. Just use HTTPS is
</I>&gt;<i> you are so scared of people stealing other's passwords.
</I>&gt;<i> 
</I>
No, because HTTPS **is not** needed to keep user's password safe.
It is only need for the login page.

&gt;<i> I don't think it's safe to show code in sandboxes in documentation. That
</I>&gt;<i> code is in sandboxes for a reason. Also the session.py &quot;example&quot; is not
</I>&gt;<i> very tested and should not be used as a reference implementation. 
</I>
Ok, but I just don't want to add too many code in the document ;-).

&gt;<i> You
</I>&gt;<i> should explain what a &quot;smart&quot; load balancer is (stateful?).
</I>&gt;<i> 
</I>
This comment should go away!

The load balancer of Lighttp is not as &quot;smart&quot; as I was hoping.
It just can generate an hash over the request-uri and make sure that the
same request URI is sent to always the same host.


&gt;<i> The most powerful feature of guard is being able to write the
</I>&gt;<i> authentication code once and reuse it forever. You can return different
</I>&gt;<i> resources even without it.
</I>&gt;<i> 
</I>
Ok.
I just have to say that guard *is* cred integration (maybe adding an
example of usage).

&gt;<i> guard is not **very** complex. guard is actually pretty transparent for
</I>&gt;<i> the userlevel code, that's exactly why it is like it is.
</I>&gt;<i>
</I>
Yes.

&gt;<i> The current guard does not login into the realm each time. 
</I>
Ok.

&gt;<i> That's an
</I>&gt;<i> optimization. And the custom dynamic request is done for every
</I>&gt;<i> locateChild method call togheter with tons of Contexts.
</I>&gt;<i> 
</I>
No.
I can create a complete &quot;static&quot; site, with all Resources created at
start time.

Of course I can always cache Resources on the portal.

Maybe I need to add some examples.
And I would like to do some benchmark to understand the cost of creating
every resource object on the fly.

&gt;<i> Overall:
</I>&gt;<i> This is (or should be) a Nevow specific document. Not talking
</I>&gt;<i> extensively about guard is a sign that it is not yet complete. 
</I>
You are right: but when writing the document I totally forgot about
guard ;-).


&gt;<i> The code
</I>&gt;<i> that doesn't use it in the rest of the document is good to explain what
</I>&gt;<i> guard does and not to avoid using it. 
</I>
This is what I want.

&gt;<i> guard is not only more flexible,
</I>&gt;<i> but also more tested and more functional than most of the ad-hoc code.
</I>
And guard has some (avoidable) security problems, too...
It uses URLs based sessions without my permission.

&gt;<i> It is also made to avoid changing ANY application level code just
</I>&gt;<i> because you are adding authentication. 
</I>
Yes, this is a great thing.

&gt;<i> It is also made to be easily
</I>&gt;<i> added to an existing Twisted application since it would reuse the same
</I>&gt;<i> portal/realm removing the need to write that code. 
</I>

Here I'm really curious.
Is cred + guard really so reusable?

As an example, how easy it is to write an integrated authentication code
(as an example on Windows's Active Directory)?


&gt;<i> guard user level API
</I>&gt;<i> is also arguably simpler than writing an auth solution for any of your
</I>&gt;<i> applications.
</I>&gt;<i> 
</I>
The session handling code can be factored out in a Mixin class.
This mixin only have to check for a session and, if available, to set
the username attribute on the request object (or None, if no session
exists).

Of course I can reuse your Session Manager class (this is why I like it).
Maybe I would prefer to factor out the cookie handling code (an
ICookieFactory interface?).

This allow one to write custom code, as an example one can create an
additional cookie with a signed and crypted client address, using the
same interface.

Or, more paranoic, one can create an additional cookie with a signed and
 maybe encrypted serial number.
This number is incremented at every request (both on the session cookie
and on the session object) and checked.



&gt;<i> This document needs a grammar review.
</I>&gt;<i> 
</I>
Of course!


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002922.html">[Twisted-web] [Nevow] new chapter about authentication
</A></li>
	<LI>Next message: <A HREF="002930.html">[Twisted-web] [Nevow] new chapter about authentication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2929">[ date ]</a>
              <a href="thread.html#2929">[ thread ]</a>
              <a href="subject.html#2929">[ subject ]</a>
              <a href="author.html#2929">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
