<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] [Nevow] about new guard in sandbox
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5BNevow%5D%20about%20new%20guard%20in%20sandbox&In-Reply-To=20060801095349.1717.926465725.divmod.quotient.10632%40ohm">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002909.html">
   <LINK REL="Next"  HREF="002916.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] [Nevow] about new guard in sandbox</H1>
    <B>Manlio Perillo</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5BNevow%5D%20about%20new%20guard%20in%20sandbox&In-Reply-To=20060801095349.1717.926465725.divmod.quotient.10632%40ohm"
       TITLE="[Twisted-web] [Nevow] about new guard in sandbox">manlio_perillo at libero.it
       </A><BR>
    <I>Tue Aug  1 12:10:23 CDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002909.html">[Twisted-web] [Nevow] about new guard in sandbox
</A></li>
        <LI>Next message: <A HREF="002916.html">[Twisted-web] [Nevow] about new guard in sandbox
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2913">[ date ]</a>
              <a href="thread.html#2913">[ thread ]</a>
              <a href="subject.html#2913">[ subject ]</a>
              <a href="author.html#2913">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Valentino Volonghi aka Dialtone ha scritto:
&gt;<i> On Tue, 01 Aug 2006 10:40:20 +0200, Manlio Perillo
</I>&gt;<i> &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">manlio_perillo at libero.it</A>&gt; wrote:
</I>&gt;&gt;<i> Only a question: in the example you only store (in the database)
</I>&gt;&gt;<i> &quot;permanent&quot; sessions.
</I>&gt;&gt;<i> Not sure about this, but I think that all sessions, except those for
</I>&gt;&gt;<i> anonymous access, should be persisted in the database (to avoid problems
</I>&gt;&gt;<i> in a distributed system).
</I>&gt;<i> 
</I>&gt;<i> Not really unless you want your system on its knees begging for some
</I>&gt;<i> holidays. Just think about the chance for 1M people to visit your
</I>&gt;<i> website each day. Your sessions database will shortly be the biggest
</I>&gt;<i> bottleneck of the application.
</I>&gt;<i> 
</I>
But then why store sessions in a database at all?

&gt;&gt;<i> Here I'm not sure to understand.
</I>&gt;&gt;<i> You mean that the avatarID (username) is not stored in the session
</I>&gt;&gt;<i> object? This seems not the case.
</I>&gt;<i> 
</I>&gt;<i> First of all the avatarID is not the username. The avatarID is the
</I>&gt;<i> avatarID. Then I repeat that I do not store the avatar anywhere which
</I>&gt;<i> means that I have to pass through portal.login() for each request and
</I>&gt;<i> portal.login() requires full credentials. Then I cannot get the avatarId
</I>&gt;<i> because it is only passed to requestAvatar and the SessionWrapper only
</I>&gt;<i> sees the result of that call.
</I>&gt;<i> 
</I>
Ok, I missed this.

&gt;&gt;<i> Another thing: is it really necessary to create a session for anonymous
</I>&gt;&gt;<i> access?
</I>&gt;<i> 
</I>&gt;<i> This is an interesting question. I think I'll probably say yes.
</I>&gt;<i> 
</I>
I will do some tests.

&gt;&gt;<i> And what about to store the authenticated username in the context
</I>&gt;&gt;<i> (instead of hacking on the site.makeSession)?
</I>&gt;<i> 
</I>&gt;<i> Maybe you didn't notice but... The context is going away we have been
</I>&gt;<i> talking about this for ages and using the context means that the code
</I>&gt;<i> will need to be trashed in not so long.
</I>&gt;<i> 
</I>
Yes, I know.
I was searching for an object with the &quot;right&quot; lifetime, forgetting
about the request.

By the way: what's the difference beetwen ctx.remember/locate and
storing attributes on the context/request?


&gt;&gt;<i> I'm against this because I whould like to have a realy reusable
</I>&gt;&gt;<i> SessionManager.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The SessionManager is really an useful class and it should not depend
</I>&gt;&gt;<i> over a SessionWrapper (because I can choose to not use a SessionWrapper
</I>&gt;&gt;<i> al all).
</I>&gt;<i> 
</I>&gt;<i> And what does this have to do with the loggedIn method? The reason it is
</I>&gt;<i> like that is because cookies are dealt with in the sessionwrapper and
</I>&gt;<i> not in the sessionmanager, 
</I>
Of course!

&gt;<i> but having 2 places to check the rememberMe
</I>&gt;<i> argument was sub-optimal. If you don't need the sessionmanager you can
</I>&gt;<i> clearly avoid implementing loggedIn at all, but this doesn't mean the
</I>&gt;<i> rest of the developers don't need such a callback.
</I>&gt;<i> 
</I>
Sorry, I did not noticed that it was a callback!
Only a question: sessionwrapper is self.guard?


&gt;<i> [...]
</I>
&gt;&gt;<i> As an example a valid alternative to store state in the server is to
</I>&gt;&gt;<i> store it in the cookie.
</I>&gt;<i> 
</I>&gt;&gt;<i> NEVOW_SESSION=&quot;username=manlio&amp;last_accessed=...&amp;created=...&quot;
</I>&gt;<i> 
</I>&gt;&gt;<i> of course using some cryptography.
</I>&gt;<i> 
</I>&gt;&gt;<i> This has the advantage to work &quot;as is&quot; in a distributed system and to
</I>&gt;&gt;<i> not depend on the number of sessions/users.
</I>&gt;<i> 
</I>&gt;<i> You will still need a session object on the serverside. Sessions are a
</I>&gt;<i> serverside detail and saving state in the database is not hard at all.
</I>

I think that serverside state is not needed here, cookies come for this.
Sometimes one only needs to know the authenticated username (to
personalize some portions of a page).

Of course having a full dynamic solution like those offered by guard,
with cred integration, is a great thing ang I like it.

Another use cases can be to have the login and logout page as fixed
resource (and, maybe, on a SSL connection).

This solution needs a custom, but I can reuse your SessionManager interface!



Thanks and regards  Manlio Perillo

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002909.html">[Twisted-web] [Nevow] about new guard in sandbox
</A></li>
	<LI>Next message: <A HREF="002916.html">[Twisted-web] [Nevow] about new guard in sandbox
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2913">[ date ]</a>
              <a href="thread.html#2913">[ thread ]</a>
              <a href="subject.html#2913">[ subject ]</a>
              <a href="author.html#2913">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
