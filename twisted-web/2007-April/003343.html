<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] web2.server: returning a deferred from
	IResource.render()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20web2.server%3A%20returning%20a%20deferred%20from%0A%09IResource.render%28%29&In-Reply-To=200704122255.36761.ibu%40radempa.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003342.html">
   <LINK REL="Next"  HREF="003344.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] web2.server: returning a deferred from
	IResource.render()</H1>
    <B>L. Daniel Burr</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20web2.server%3A%20returning%20a%20deferred%20from%0A%09IResource.render%28%29&In-Reply-To=200704122255.36761.ibu%40radempa.de"
       TITLE="[Twisted-web] web2.server: returning a deferred from
	IResource.render()">ldanielburr at mac.com
       </A><BR>
    <I>Thu Apr 12 16:12:42 CDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="003342.html">[Twisted-web] web2.server: returning a deferred from
	IResource.render()
</A></li>
        <LI>Next message: <A HREF="003344.html">[Twisted-web] confusion with general web serving
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3343">[ date ]</a>
              <a href="thread.html#3343">[ thread ]</a>
              <a href="subject.html#3343">[ subject ]</a>
              <a href="author.html#3343">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 12 Apr 2007 15:55:36 -0500, ibu &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">ibu at radempa.de</A>&gt; wrote:

&gt;<i> from twisted.web2 import server, http, resource, channel, http_headers
</I>&gt;<i> from twisted.internet import defer
</I>&gt;<i> class Handler:
</I>&gt;<i>     def __init__(self, request):
</I>&gt;<i>         self.request = request
</I>&gt;<i>     def err(self, e):
</I>&gt;<i>         print &quot;---- errb&quot;, e
</I>&gt;<i>     def getResponse(self, result = None):
</I>&gt;<i>         rep = &quot;The output which shall be transferred to the browser.&quot;
</I>&gt;<i>         res = http.Response( 200,
</I>&gt;<i>             {'content-type': http_headers.MimeType('text','plain')},
</I>&gt;<i>             rep)
</I>&gt;<i>         print &quot;---- getResponse returning: &quot;, res
</I>&gt;<i>         return res
</I>&gt;<i>     def getDeferredResponse(self):
</I>&gt;<i>         print &quot;---- getDeferredResponse beginning&quot;
</I>&gt;<i>         d = defer.Deferred()
</I>&gt;<i>         d.addCallback(self.getResponse)
</I>&gt;<i>         d.addErrback(self.err)
</I>&gt;<i>         print &quot;---- getDeferredResponse returning: &quot;, d
</I>&gt;<i>         return d
</I>
Deferreds don't just automatically schedule themselves to
be fired, they fire in response to some event.  In other
words some event must occur in which d.callback gets
invoked.

Your code, as written, never causes the Deferred's
callback to be fired.

In this example, you'd need to cause the callback to
be invoked yourself, like so:

def getDeferredResponse(self):
     print &quot;---- getDeferredResponse beginning&quot;
     d = defer.Deferred()
     d.addCallback(self.getResponse)
     d.addErrback(self.err)
     print &quot;---- getDeferredResponse returning: &quot;, d
     reactor.callLater(1, d.callback, None)
     return d

Hope this helps,

L. Daniel Burr

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003342.html">[Twisted-web] web2.server: returning a deferred from
	IResource.render()
</A></li>
	<LI>Next message: <A HREF="003344.html">[Twisted-web] confusion with general web serving
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3343">[ date ]</a>
              <a href="thread.html#3343">[ thread ]</a>
              <a href="subject.html#3343">[ subject ]</a>
              <a href="author.html#3343">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
