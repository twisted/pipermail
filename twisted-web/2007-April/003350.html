<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] web2 post/put examples
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20web2%20post/put%20examples&In-Reply-To=auto-000014520966%40execdsl.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003349.html">
   <LINK REL="Next"  HREF="003351.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] web2 post/put examples</H1>
    <B>L. Daniel Burr</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20web2%20post/put%20examples&In-Reply-To=auto-000014520966%40execdsl.com"
       TITLE="[Twisted-web] web2 post/put examples">ldanielburr at mac.com
       </A><BR>
    <I>Tue Apr 17 16:25:54 CDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="003349.html">[Twisted-web] web2 post/put examples
</A></li>
        <LI>Next message: <A HREF="003351.html">[Twisted-web] excess-transports-1938-3 fixes athena problem with IE7
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3350">[ date ]</a>
              <a href="thread.html#3350">[ thread ]</a>
              <a href="subject.html#3350">[ subject ]</a>
              <a href="author.html#3350">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Mark,

On Tue, 17 Apr 2007 15:49:10 -0500, Mark Feldman  
&lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">feldman+twisted-web at shinkuro.com</A>&gt; wrote:

&gt;<i> Does anyone have a simple example of processing either a post or put on  
</I>&gt;<i> the server side using web2?  I've had no problem serving up web pages  
</I>&gt;<i> from a variety of sources (files, database backends).   The changes  
</I>&gt;<i> needed to support data back fro the user -- undoubtedly a set of  
</I>&gt;<i> deferred methods in the right place -- escape me.  Thanks.
</I>&gt;<i>
</I>
For POST, you could use resource.PostableResource, which will take
care of parsing your run-of-the-mill form posting.  Just subclass
resource.PostableResource, and implement the &quot;render&quot; method.

For PUT, and also for cases where your are POSTING non-form data,
e.g., an XML payload, you need to subclass resource.Resource,
implement the desired method (http_POST, http_PUT), and then hook
the request.stream up to a processing chain.

Example:

 from twisted.web2 import resource, stream


class Foo(resource.Resource):
     _allowedMethods = ('POST', 'PUT')

     def _finished(self, result, request):
         # return some http.Response

     def _failed(self, reason, request):
         # return some http.Response

     def http_POST(self, request):
         def handleData(data):
             # process each chunk of data as it arrives

         # readStream will keep calling handleData until the
         # entire stream has been read.
         d = stream.readStream(request.stream, handleData)

         # these callbacks/errbacks will be called when readStream
         # has finished reading the stream.
         d.addCallbacks(
             self._finished,
             self._failed,
             callbackArgs=(request,),
             errbackArgs=(request,)
         )

         # Catch any errors that occur in self._finished.
         d.addErrback(self._failed, request)

         return d

     def http_PUT(self, request):
         # Just handle things the same way POST does
         return self.http_POST(request)


Hope this helps,

L. Daniel Burr

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003349.html">[Twisted-web] web2 post/put examples
</A></li>
	<LI>Next message: <A HREF="003351.html">[Twisted-web] excess-transports-1938-3 fixes athena problem with IE7
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3350">[ date ]</a>
              <a href="thread.html#3350">[ thread ]</a>
              <a href="subject.html#3350">[ subject ]</a>
              <a href="author.html#3350">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
