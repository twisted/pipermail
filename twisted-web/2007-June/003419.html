<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Obvious stuff... just not to me,
	re: Failure to Install...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Obvious%20stuff...%20just%20not%20to%20me%2C%0A%09re%3A%20Failure%20to%20Install...&In-Reply-To=95868F71-36B1-4570-B1A8-E1EDBD443085%40securme.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003418.html">
   <LINK REL="Next"  HREF="003420.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Obvious stuff... just not to me,
	re: Failure to Install...</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Obvious%20stuff...%20just%20not%20to%20me%2C%0A%09re%3A%20Failure%20to%20Install...&In-Reply-To=95868F71-36B1-4570-B1A8-E1EDBD443085%40securme.net"
       TITLE="[Twisted-web] Obvious stuff... just not to me,
	re: Failure to Install...">exarkun at divmod.com
       </A><BR>
    <I>Sun Jun 17 19:54:44 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="003418.html">[Twisted-web] Obvious stuff... just not to me,
	re: Failure to Install...
</A></li>
        <LI>Next message: <A HREF="003420.html">[Twisted-web] Obvious stuff... just not to me,	re: Failure to
	Install...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3419">[ date ]</a>
              <a href="thread.html#3419">[ thread ]</a>
              <a href="subject.html#3419">[ subject ]</a>
              <a href="author.html#3419">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, 17 Jun 2007 19:25:29 -0400, Dav Clark &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">dav at securme.net</A>&gt; wrote:
&gt;<i>I'm slowly beginning to wrap my head around Nevow.  For one, while  it's not 
</I>&gt;<i>explicit anywhere, it seems really clear that the intention  is simply to 
</I>&gt;<i>add the Nevow root directory to your python path.
</I>
The Nevow install process is more or less the same as the install process
for any other Python package.  Yep, the package directories need to be in
sys.path somehow, either by having their parents added to PYTHONPATH or by
being copied to a directory which is in the default search path.

&gt;<i>In my  case, I'm using 
</I>&gt;<i>the easy_install develop workaround:
</I>&gt;<i>
</I>&gt;<i>python -c &quot;import setuptools; execfile('setup.py')&quot; develop
</I>&gt;<i>
</I>&gt;<i>from the .../Nevow path.  This means I can svn update, and that  version is 
</I>&gt;<i>working without any more reinstalls.
</I>&gt;<i>
</I>
This may indeed work, although setuptools isn't really supported (meaning
there is no automated test coverage for setuptools working, and further none
of the primary Nevow developers use setuptools, so if it is working now, we
might break it unintentionally and unknowingly at some future time).

I use Combinator to manage my Python import path.  If you're tracking svn
<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">trunk at HEAD</A>, you might want to consider it too.  Or you can just edit your
shell's startup script to add the checkout directory to PYTHONPATH.

&gt;<i>In addition, I got thrown for a loop with the Athena tutorial,  because it 
</I>&gt;<i>suggests that to understand the Nevow plugin search  system, you should just 
</I>&gt;<i>look at the Twisted plugin search system.   This had me with a custom 
</I>&gt;<i>&lt;emph&gt;twisted&lt;/emph&gt;/plugins directory, and  using pdb to step through code 
</I>&gt;<i>to see why it wasn't getting loaded by  Nevow, when clearly the Twisted 
</I>&gt;<i>plugin system was populating this  with the normal 'dropin.cache' and 
</I>&gt;<i>soforth.
</I>&gt;<i>
</I>&gt;<i>But now I understand that the nevow/plugins and the twisted/plugins  are 
</I>&gt;<i>similarly handled but distinct repo's.
</I>&gt;<i>
</I>
Oops, that sounds like some unfortunately misleading documentation.  Do you
think you could correct the wiki page in question to make this explicit?

&gt;<i>So, while I have a borderline unhealthy desire to learn twisted &amp;  nevow, 
</I>&gt;<i>and will work through this stuff, I recon a lot of people  might have a look 
</I>&gt;<i>and say, &quot;WTF!&quot; and go to Django or something.  I'd  like to help fix the 
</I>&gt;<i>documentation as I learn, but I don't want to  write the wrong thing either. 
</I>&gt;<i>So, here are some changes I would make  if OK to the Nevow and Athena docs 
</I>&gt;<i>on the Wiki:
</I>&gt;<i>
</I>&gt;<i>1) This is the only obviously wrong thing - on the Athena page, it  says 
</I>&gt;<i>that you should install modules into a plugin directory under  Nevow instead 
</I>&gt;<i>of nevow.  This is confusing and had me creating a  Nevow/plugins directory 
</I>&gt;<i>in my private PYTHONPATH (which makes sense  at first, as there is a Nevow 
</I>&gt;<i>directory as well as a nevow directory  if you checkout from svn).
</I>
Aha.  Yes, please do fix this. :)

&gt;<i>
</I>&gt;<i>2) Modify the Nevow install instructions to explain that neither ./ setup.py 
</I>&gt;<i>install or easy_install are fully supported.  Suggest  easy_install develop 
</I>&gt;<i>or similar as preferred alternative, outright  copying or adding the Nevow 
</I>&gt;<i>direcotry to your PYTHONPATH as a  secondary (as well as setting up scripts 
</I>&gt;<i>somewhere in your PATH).  I  would just fix the install to work properly, 
</I>&gt;<i>but I'm not sure what  would be &quot;right&quot; more on that below.
</I>
setup.py is basically fully supported.  If you find bugs in it, we will do
our best to fix them.  easy_install isn't really supported at all; please
don't suggest it or anything related to setuptools.

&gt;<i>
</I>&gt;<i>3) Regarding, e.g. javascript plugins, it seems that the convention  is to 
</I>&gt;<i>install both user and 3rd party packages into the nevow  package.  This is 
</I>&gt;<i>very different than what most people are used to,  but quite similar to the 
</I>&gt;<i>way e.g. an in-place Zope install behaves  (particularly if you are doing an 
</I>&gt;<i>in-place install as I describe  above).  I don't like doing this - as it 
</I>&gt;<i>moves me away from a clean  separation of &quot;my&quot; code from &quot;your&quot; code.
</I>&gt;<i>
</I>&gt;<i>3a) So, for example, after getting the thing working with the stock 
</I>&gt;<i>nevow/plugins directory, I standardized on having a local nevow/ plugins 
</I>&gt;<i>directory as a sibling of my tac file.  I would suggest this  be the 
</I>&gt;<i>recommended (or at least an alternative) method described in  the wiki - 
</I>&gt;<i>this keeps all example files bundled under the same root  dir.  This also 
</I>&gt;<i>allows the possibility of bundling a tar or zip of an  athena package, you 
</I>&gt;<i>un-archive it, and the example just works with  twistd -ny example.tac from 
</I>&gt;<i>where it sits.  (well, you need to alter  the /path/to/your/file to 
</I>&gt;<i>sibpath(__file__, 'mymodule.js')).
</I>
I'm not totally clear on what you're suggesting here.  As described on the
wiki, the plugin system does let you keep all of your source files beneath
one directory.  Maybe I'm not understanding your concern, or maybe you're
still missing something about how plugins work.  Could you describe this
issue further?

&gt;<i>
</I>&gt;<i>3b)  I would go a step further and suggest that, as in zope, a way to 
</I>&gt;<i>create &quot;instances&quot; be created.  This would just mean populating a  directory 
</I>&gt;<i>with things like a plugins direcotry, a js dir for 
</I>&gt;<i>nevow.athena.autoJSPackage to load and other stuff I haven't learned  about 
</I>&gt;<i>yet.  A set of scripts localized for that instance would add  the 
</I>&gt;<i>appropriate root to the python path before running.  Or, you  could just 
</I>&gt;<i>require people to run twistd from the root dir of the  bundle.  This would 
</I>&gt;<i>be remarkably similar to the &quot;solution&quot; for 3a.
</I>
Requiring extra programs in order to run the actually interesting program
doesn't interest me very much.  Beyond this, I'm not really sure how this
suggestion differs much from the current system, except that it explicitly
makes environment setup something that goes into a helper script, rather
than relying on each user to have an environment which is &quot;correctly&quot;
configured.  Perhaps the documentation should go into more detail about
what Nevow considers a &quot;correct&quot; environment?

&gt;<i>
</I>&gt;<i>3c) I'm still a bit unclear on how python deals with identically  named 
</I>&gt;<i>packages in different directories in the path.  So, for  example, I know 
</I>&gt;<i>have two nevow/plugins directories on my path.   Everything seems to work 
</I>&gt;<i>fine, and indeed, the athena.JSDependencies  seems to be able to find files 
</I>&gt;<i>from both.  Even if I add an  __init__.py file to my own nevow/plugins 
</I>&gt;<i>directory, the autoJSPackage  call from the default 
</I>&gt;<i>nevow/plugins/__init__.py seems to fire  correctly.  But at some point, name 
</I>&gt;<i>collisions are necessarily going  to be a problem.  I could see some _very_ 
</I>&gt;<i>funny errors arising from  this, e.g. if the python interpreter simply uses 
</I>&gt;<i>the first file it  finds, it could load a .py file from one directory, then 
</I>&gt;<i>load an  __init__.py file from another directory which overrides the objects 
</I>&gt;<i>loaded from that first .py file... pointers would be appreciated on  this.
</I>
The plugin system uses some advanced features of the Python package system.
Normally Python packages wouldn't let you have multiple packages or modules
with the same name (and even here it doesn't really - the nevow/plugins and
nevow directories you create to add plugins are just directories, rather than
packages, although nevow/plugins/ does _contribute_ to &quot;the&quot; nevow.plugins
package).

There is necessarily the potential for a name conflict here, since multiple
authors are contributing to the same namespace.  This is the same as the
problem of top-level Python packages, since two authors might choose to name
their package the same thing.  However, unlike that case, it is trivially
resolved, since the names of things in nevow/plugins/ are essentially
irrelevant.  At packaging or installation time, the name can be changed to
resolve a conflict without breaking the plugins (this might be a problem
for unit tests, though, if they try to import from the plugins package in
order to test functionality it provides - they will be broken by the name
change, probably).

&gt;<i>
</I>&gt;<i>3d) Speaking of strange .js includes, some system (correctly?)  associates 
</I>&gt;<i>the nevow/empty.js file with most Nevow classes.  But for  root classes, you 
</I>&gt;<i>also get these __init__.js associations, which are  non-existent *.js files. 
</I>&gt;<i>Is this a bug?
</I>
Hmm, could be.  Can you describe this further?

&gt;<i>
</I>&gt;<i>4) Perhaps have a page describing Divmod wiki etiquette... answering  the 
</I>&gt;<i>question of this e-mail, which is &quot;How liberal should I be in  editing the 
</I>&gt;<i>Wiki(s)?&quot;
</I>&gt;<i>
</I>&gt;<i>5) Why do all examples have twistd -noy, when -y implies -o?
</I>&gt;<i>
</I>
Historic reasons.  The people writing these wiki pages probably still have
finger memory from before -y implied -o. :)  Feel free to fix this.

&gt;<i>Anyway, as I've said, I'd like to leave some breadcrumbs for those  right 
</I>&gt;<i>behind me before I forget what it's like to be such a noob!   Any feedback 
</I>&gt;<i>or guidance on appropriate help is appreciated.  In  particular, how I 
</I>&gt;<i>should proceed now and in future with Wiki /  documentation edits.
</I>&gt;<i>
</I>
Thanks for digging into this and collecting your experiences in this email!

Jean-Paul

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003418.html">[Twisted-web] Obvious stuff... just not to me,
	re: Failure to Install...
</A></li>
	<LI>Next message: <A HREF="003420.html">[Twisted-web] Obvious stuff... just not to me,	re: Failure to
	Install...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3419">[ date ]</a>
              <a href="thread.html#3419">[ thread ]</a>
              <a href="subject.html#3419">[ subject ]</a>
              <a href="author.html#3419">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
