<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Slot/pattern/key changes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000167.html">
   <LINK REL="Next"  HREF="000172.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Slot/pattern/key changes
   </H1>
    <B>Matt Goodall
    </B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com"
       TITLE="[Twisted-web] Slot/pattern/key changes">twisted-web@twistedmatrix.com
       </A><BR>
    <I>Wed, 11 Feb 2004 09:32:40 +0000</I>
    <P><UL>
        <LI> Previous message: <A HREF="000167.html">[Twisted-web] Slot/pattern/key changes
</A></li>
        <LI> Next message: <A HREF="000172.html">[Twisted-web] Slot/pattern/key changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#170">[ date ]</a>
              <a href="thread.html#170">[ thread ]</a>
              <a href="subject.html#170">[ subject ]</a>
              <a href="author.html#170">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 2004-02-10 at 22:58, Matt Goodall wrote:
&gt;<i> On Tue, 2004-02-10 at 21:30, James Y Knight wrote:
</I>&gt;<i> &gt; This is a set of *BACKWARDS-INCOMPATIBLE* changes that simplifies and 
</I>&gt;<i> &gt; clarifies the set of attributes nevow has for finding elements. Tests 
</I>&gt;<i> &gt; pass, and my app works (both after being updated slightly for the API 
</I>&gt;<i> &gt; changes).
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; There used to be 3 attributes you could put on elements to locate them: 
</I>&gt;<i> &gt; slot, pattern, and key. They all did similar but slightly different 
</I>&gt;<i> &gt; things.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; - Filling slots with data is a useful concept but 'slot' shouldn' t be 
</I>&gt;<i> &gt; an attribute. A slot is something that gets replaced with the given 
</I>&gt;<i> &gt; data, and is thus better as a standalone element. It has been replaced 
</I>&gt;<i> &gt; with the following:
</I>&gt;<i> &gt; slot('slotname') in a stan tree, or &lt;nevow:slot name=&quot;slotname&quot; /&gt; in 
</I>&gt;<i> &gt; an (X)HTML template.
</I>&gt;<i> &gt; context.slotted() (which could locate a slot) has been eliminated and 
</I>&gt;<i> &gt; replaced with context.fillSlots(slotname, stantree). Note that you 
</I>&gt;<i> &gt; cannot locate slots, you can just specify data for them to fill 
</I>&gt;<i> &gt; themselves with.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; - Assigning unique keys is also a useful concept, but it doesn't 
</I>&gt;<i> &gt; require the &quot;context.keyed()&quot; method. That method has been eliminated. 
</I>&gt;<i> &gt; HTMLRenderer used it to find the key=&quot;content&quot; in HTML files used as 
</I>&gt;<i> &gt; sub-renderers, now it uses pattern=&quot;content&quot;.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; - Patterns remain as the only way to locate a sub-element of your 
</I>&gt;<i> &gt; renderer. There are now 3 methods to locate them, depending on what you 
</I>&gt;<i> &gt; want to do. patternGenerator() replaces patterns(), onePattern() 
</I>&gt;<i> &gt; semi-replaces keyed(), and allPatterns() replaces the direct use of 
</I>&gt;<i> &gt; specialMatches that the sequence renderer previous did. Please see the 
</I>&gt;<i> &gt; docs in context.py for these three methods for precise behavior.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; So, in summary, to convert your old code to new code:
</I>&gt;<i> &gt; 1) If you had &quot;div(style=&quot;border:1px&quot;, slot=&quot;myslot&quot;)&quot; replace it with 
</I>&gt;<i> &gt; div(style=&quot;border: 1px&quot;)[slot(&quot;myslot&quot;)].
</I>&gt;<i> &gt; 2) If you had a template with &quot;&lt;div style=&quot;border:1px&quot; 
</I>&gt;<i> &gt; nevow:slot=&quot;myslot&quot; /&gt;&quot; replace it with &quot;&lt;div 
</I>&gt;<i> &gt; style=&quot;border:1px&quot;&gt;&lt;nevow:slot name=&quot;myslot&quot; /&gt;&lt;/div&gt;
</I>&gt;<i> &gt; 3) If you had &quot;context.slotted(&quot;myslot&quot;).clear()[a(href=&quot;foo&quot;)[&quot;bar&quot;]] 
</I>&gt;<i> &gt; replace it with context.fillSlot(&quot;myslot&quot;, a(href=&quot;foo&quot;)[&quot;bar&quot;]]
</I>&gt;<i> &gt; 4) If you used keyed(), convert key= to pattern= and keyed() to 
</I>&gt;<i> &gt; onePattern().
</I>&gt;<i> &gt; 5) If you used patterns(), just rename it to patternGenerator()
</I>&gt;<i> 
</I>&gt;<i> I have one more use case that is not possible/easy with the proposed
</I>&gt;<i> change:
</I>&gt;<i> 
</I>&gt;<i> HTML:
</I>&gt;<i> &lt;a nevow:slot=&quot;email&quot; class=&quot;whatever&quot; href=&quot;email:&quot;&gt;email&lt;/a&gt;
</I>&gt;<i> 
</I>&gt;<i> Rendered by:
</I>&gt;<i> context.slotted('email')(href=['mailto:','<A HREF="mailto:a@bc.com">a@bc.com</A>'])['Mr X']
</I>&gt;<i> 
</I>&gt;<i> Result:
</I>&gt;<i> &lt;a class=&quot;whatever&quot; href=&quot;email:<A HREF="mailto:a@bc.com">a@bc.com</A>&quot;&gt;Mr X&lt;/a&gt;
</I>
It looks like this should be possible using something like this:

HTML:
&lt;nevow:slot name=&quot;email&quot;/&gt;&lt;a pattern=&quot;email&quot; href=&quot;#&quot;
class=&quot;whatever&quot;&gt;name&lt;/a&gt;

Rendered by:
context.fillSlots(
    'email',
    context.onePattern('email')(href=['mailto:<A HREF="mailto:a@bc.com">a@bc.com</A>'])['Mr X']
)

Although James's patch needs a couple of small changes to make that
work.

&gt;<i> 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Also included in this patch are doc cleanups, removing excess xml() 
</I>&gt;<i> &gt; wrappings, replacing yield by return when possible, and the ability to 
</I>&gt;<i> &gt; use the &quot;&lt;nevow:invisible&gt;&quot; element in a (x)html template file, with 
</I>&gt;<i> &gt; the same behavior as the invisible stan tag.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; James
</I>-- 
     __
    /  \__     Matt Goodall, Pollenation Internet Ltd
    \__/  \    w: <A HREF="http://www.pollenation.net">http://www.pollenation.net</A>
  __/  \__/    e: <A HREF="mailto:matt@pollenation.net">matt@pollenation.net</A>
 /  \__/  \    t: +44 (0)113 2252500
 \__/  \__/
 /  \          Any views expressed are my own and do not necessarily
 \__/          reflect the views of my employer.



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000167.html">[Twisted-web] Slot/pattern/key changes
</A></li>
	<LI> Next message: <A HREF="000172.html">[Twisted-web] Slot/pattern/key changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#170">[ date ]</a>
              <a href="thread.html#170">[ thread ]</a>
              <a href="subject.html#170">[ subject ]</a>
              <a href="author.html#170">[ author ]</a>
         </LI>
       </UL>
</body></html>
