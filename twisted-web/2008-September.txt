From wthie at thiengineering.ch  Sat Sep 13 03:38:16 2008
From: wthie at thiengineering.ch (Werner Thie)
Date: Sat Sep 13 03:39:01 2008
Subject: [Twisted-web] .js File caching behavior on different browsers
In-Reply-To: <4877B585.3020707@libero.it>
References: <20080711112751.4714.1283843994.divmod.quotient.19330@ohm>
	<4877B585.3020707@libero.it>
Message-ID: <48CB6DE8.2030705@thiengineering.ch>

Hi all

Tried to send this to divmod-dev@divmod.org, but post didn't show up 
after 12hours.

Might be an insanly stupid question but, is there a simple way to force
the reload of JScript code for nevow LivePages via a server issued 
directive?

I ask because Firefox seems to cling to the JScript files until the user
forces it to forget them with 'Clear Private Data', which leads to ugly
mismatches between server and client side code.

Thxs, Werner


From lasizoillo at gmail.com  Sat Sep 13 04:00:24 2008
From: lasizoillo at gmail.com (lasizoillo)
Date: Sat Sep 13 04:00:28 2008
Subject: [Twisted-web] .js File caching behavior on different browsers
In-Reply-To: <48CB6DE8.2030705@thiengineering.ch>
References: <20080711112751.4714.1283843994.divmod.quotient.19330@ohm>
	<4877B585.3020707@libero.it> <48CB6DE8.2030705@thiengineering.ch>
Message-ID: <49414f570809130100k73b9013cg8f22e8b978070924@mail.gmail.com>

2008/9/13 Werner Thie <wthie@thiengineering.ch>:
> Hi all
>
> Tried to send this to divmod-dev@divmod.org, but post didn't show up after
> 12hours.
>
> Might be an insanly stupid question but, is there a simple way to force
> the reload of JScript code for nevow LivePages via a server issued
> directive?

I never expire a javascript file, I change his url. If I have a
script.js file, I import script.js?v=1, script.js?v=2, ... This force
a client reload only with new deploys.

>
> I ask because Firefox seems to cling to the JScript files until the user
> forces it to forget them with 'Clear Private Data', which leads to ugly
> mismatches between server and client side code.
>
> Thxs, Werner
>
>
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>

From wthie at thiengineering.ch  Sat Sep 13 04:51:35 2008
From: wthie at thiengineering.ch (Werner Thie)
Date: Sat Sep 13 04:52:16 2008
Subject: [Twisted-web] .js File caching behavior on different browsers
In-Reply-To: <49414f570809130100k73b9013cg8f22e8b978070924@mail.gmail.com>
References: <20080711112751.4714.1283843994.divmod.quotient.19330@ohm>	<4877B585.3020707@libero.it>
	<48CB6DE8.2030705@thiengineering.ch>
	<49414f570809130100k73b9013cg8f22e8b978070924@mail.gmail.com>
Message-ID: <48CB7F17.3060300@thiengineering.ch>

Thxs, although I thought about doing that it is so against all 
versioning and release practices and only brings up a burp from the 
seventies :-((

Thxs, Werner

lasizoillo wrote:
> 2008/9/13 Werner Thie <wthie@thiengineering.ch>:
>> Hi all
>>
>> Tried to send this to divmod-dev@divmod.org, but post didn't show up after
>> 12hours.
>>
>> Might be an insanly stupid question but, is there a simple way to force
>> the reload of JScript code for nevow LivePages via a server issued
>> directive?
> 
> I never expire a javascript file, I change his url. If I have a
> script.js file, I import script.js?v=1, script.js?v=2, ... This force
> a client reload only with new deploys.
> 
>> I ask because Firefox seems to cling to the JScript files until the user
>> forces it to forget them with 'Clear Private Data', which leads to ugly
>> mismatches between server and client side code.
>>
>> Thxs, Werner
>>
>>
>> _______________________________________________
>> Twisted-web mailing list
>> Twisted-web@twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>>
> 
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web

From exarkun at divmod.com  Sat Sep 13 08:24:10 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sat Sep 13 08:24:27 2008
Subject: [Twisted-web] .js File caching behavior on different browsers
In-Reply-To: <49414f570809130100k73b9013cg8f22e8b978070924@mail.gmail.com>
Message-ID: <20080913122410.29191.1449085521.divmod.quotient.25475@ohm>

On Sat, 13 Sep 2008 10:00:24 +0200, lasizoillo <lasizoillo@gmail.com> wrote:
>2008/9/13 Werner Thie <wthie@thiengineering.ch>:
>> Hi all
>>
>> Tried to send this to divmod-dev@divmod.org, but post didn't show up after
>> 12hours.
>>
>> Might be an insanly stupid question but, is there a simple way to force
>> the reload of JScript code for nevow LivePages via a server issued
>> directive?
>
>I never expire a javascript file, I change his url. If I have a
>script.js file, I import script.js?v=1, script.js?v=2, ... This force
>a client reload only with new deploys.

Athena effectively does this automatically.  If JavaScript source files
are changing but the browser isn't requesting the new versions, then
there's a bug somewhere that needs to be fixed.

Jean-Paul

From kozneb at gmail.com  Mon Sep 15 14:23:31 2008
From: kozneb at gmail.com (=?UTF-8?Q?Harald_Bl=C3=A5tand?=)
Date: Mon Sep 15 14:23:37 2008
Subject: [Twisted-web] Athena & browser 2-connection limit
Message-ID: <1ff309e60809151123h518d1029w8004123185427aa1@mail.gmail.com>

SGkgdGhlcmUsCgpCZWVuIHRoaW5raW5nIGFib3V0IHRoaXMuIEl0IF93b3VsZF8gYmUgY29vbCBp
ZiB5b3UgY291bGQgaGF2ZSBtb3JlIHRoYW4gb25lCkxpdmVQYWdlIHBlciBicm93c2VyIHNlc3Np
b24sIGxpa2UgaW4gcG9wdXBzLCBvciBldmVuIGZyYW1lcy4KCldoYXQgZG8geW91IHRoaW5rOiBJ
cyB0aGVyZSBhbnkgb2J2aW91cyAmIGZ1bmRhbWVudGFsIHJlYXNvbiB3aHkgdGhlClJlbGlhYmxl
TWVzc2FnZURlbGl2ZXJ5IHN0dWZmIGNvdWxkbid0IGJlIG1vZGlmaWVkLCBzbyB0aGF0IG9uZSBp
bnN0YW5jZSBvZgppdCBjb3VsZCBiZSBzaGFyZWQgYmV0d2VlbiBzZXZlcmFsIFBhZ2VXaWRnZXRz
PwoKSGFyYWxkCi0tLS0tLS0tLS0tLS0tIG5leHQgcGFydCAtLS0tLS0tLS0tLS0tLQpBbiBIVE1M
IGF0dGFjaG1lbnQgd2FzIHNjcnViYmVkLi4uClVSTDogaHR0cDovL3R3aXN0ZWRtYXRyaXguY29t
L3BpcGVybWFpbC90d2lzdGVkLXdlYi9hdHRhY2htZW50cy8yMDA4MDkxNS9kNzdlZmJkZC9hdHRh
Y2htZW50Lmh0bQo=
From wthie at thiengineering.ch  Tue Sep 16 03:08:28 2008
From: wthie at thiengineering.ch (Werner Thie)
Date: Tue Sep 16 03:09:15 2008
Subject: [Twisted-web] Athena & browser 2-connection limit
In-Reply-To: <1ff309e60809151123h518d1029w8004123185427aa1@mail.gmail.com>
References: <1ff309e60809151123h518d1029w8004123185427aa1@mail.gmail.com>
Message-ID: <48CF5B6C.7030405@thiengineering.ch>

Hello Harald

Try the following before you proceed:

Run the nevow examples, go to calculator with IE7 or greater, then hit 
F5 for reload in rapid sequence. You will hit the point where the 
browser sits there seemingly deactivated with a waiting cursor. Wait for 
the time it takes for the socket to come out of its TIME_WAIT state and 
see the browser window come alive again.

You can provoke this behavior also by providing a sequence of LivePages, 
going from one LivePage to the other.

The Athena implementation which was rewritten at SVN version 13786 to 
implement a better disconnect logic collides in my experience with the 
limited connections IE's developer decided to use. At any particular 
time the browser accepts only two open sockets and if the user is fast 
enough to close and open a series of independent windows such that the 
tearing down of one connection provokes a 'half open' socket in 
TIME_WAIT state, IE7 & IE8 wait for the that socket to close completely. 
This problem is amplified by higher latency systems such when running IP 
traffic over satellite or mobile networks.

This is in my opinion a fundamental flaw in the current Athena 
implementation and leads to problems no end, because users WILL simply 
NOT behave and will do the impossible. User feedback in our case was so, 
that I was forced to live with the 'old' Athena stuff.

I have a site up which consists of almost only LivePages doing dialogs 
and fancy stuff, but it's using nevow/athena at SVN version 13786 and it 
  took me an arm and a leg to bring it up to the point where it was 
running smoothly, now serving a constant load of more than 100 users 
24/7. (see www.samschtigjass.ch, goto 'Einzelspieler-Version' for a 
guest game)

If you or anybody else sees a solution to that IE/TIME_WAIT problem I 
would be more than happy to invest time into furthering Athenas 
evolution, I like the concepts underneath and if they're coupled with a 
decent JScript library the 'real app in the browser' becomes a reality.

Werner


Harald Bl?tand wrote:
> Hi there,
>  
> Been thinking about this. It _would_ be cool if you could have more than 
> one LivePage per browser session, like in popups, or even frames.
>  
> What do you think: Is there any obvious & fundamental reason why the 
> ReliableMessageDelivery stuff couldn't be modified, so that one instance 
> of it could be shared between several PageWidgets?
>  
> Harald
>  
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web

From wthie at thiengineering.ch  Tue Sep 16 03:23:05 2008
From: wthie at thiengineering.ch (Werner Thie)
Date: Tue Sep 16 03:23:45 2008
Subject: [Twisted-web] .js File caching behavior on different browsers
In-Reply-To: <20080913122410.29191.1449085521.divmod.quotient.25475@ohm>
References: <20080913122410.29191.1449085521.divmod.quotient.25475@ohm>
Message-ID: <48CF5ED9.7050309@thiengineering.ch>

Jean-Paul
Jean-Paul Calderone wrote:
> On Sat, 13 Sep 2008 10:00:24 +0200, lasizoillo <lasizoillo@gmail.com> 
> wrote:
>> 2008/9/13 Werner Thie <wthie@thiengineering.ch>:
>>> Hi all
>>>
>>> Tried to send this to divmod-dev@divmod.org, but post didn't show up 
>>> after
>>> 12hours.
>>>
>>> Might be an insanly stupid question but, is there a simple way to force
>>> the reload of JScript code for nevow LivePages via a server issued
>>> directive?
>>
>> I never expire a javascript file, I change his url. If I have a
>> script.js file, I import script.js?v=1, script.js?v=2, ... This force
>> a client reload only with new deploys.
> 
> Athena effectively does this automatically.  If JavaScript source files
> are changing but the browser isn't requesting the new versions, then
> there's a bug somewhere that needs to be fixed.

If JScript code is brought to the page via the javaScript classvar
class LP(athena.Livepage):
   javaScript = ('scripts/somescripts.js, 'scripts/otherscripts.js')

I end up with a static path to the scripts and they cling to Firefox.

How would you suggest to bring in additional (foreign, third party) 
libraries?

Do I have to use the naming kludge or is there a better way.

Thxs, Werner


From p.mayers at imperial.ac.uk  Tue Sep 16 03:49:44 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Tue Sep 16 03:50:22 2008
Subject: [Twisted-web] .js File caching behavior on different browsers
In-Reply-To: <48CF5ED9.7050309@thiengineering.ch>
References: <20080913122410.29191.1449085521.divmod.quotient.25475@ohm>
	<48CF5ED9.7050309@thiengineering.ch>
Message-ID: <48CF6518.9010408@imperial.ac.uk>

>> Athena effectively does this automatically.  If JavaScript source files
>> are changing but the browser isn't requesting the new versions, then
>> there's a bug somewhere that needs to be fixed.
> 
> If JScript code is brought to the page via the javaScript classvar
> class LP(athena.Livepage):
>   javaScript = ('scripts/somescripts.js, 'scripts/otherscripts.js')
> 
> I end up with a static path to the scripts and they cling to Firefox.
> 
> How would you suggest to bring in additional (foreign, third party) 
> libraries?
> 
> Do I have to use the naming kludge or is there a better way.

The correct way is to set the HTTP headers appropriately. I presume 
/scripts is a static.File - it would be nice generally if static.File 
had a way to set the Cache-Control values

From mithrandi at mithrandi.net  Tue Sep 16 06:22:00 2008
From: mithrandi at mithrandi.net (Tristan Seligmann)
Date: Tue Sep 16 06:22:42 2008
Subject: [Twisted-web] Athena & browser 2-connection limit
In-Reply-To: <48CF5B6C.7030405@thiengineering.ch>
References: <1ff309e60809151123h518d1029w8004123185427aa1@mail.gmail.com>
	<48CF5B6C.7030405@thiengineering.ch>
Message-ID: <20080916102200.GA23508@mithrandi.net>

KiBXZXJuZXIgVGhpZSA8d3RoaWVAdGhpZW5naW5lZXJpbmcuY2g+IFsyMDA4LTA5LTE2IDA5OjA4
OjI4ICswMjAwXToKCj4gSWYgeW91IG9yIGFueWJvZHkgZWxzZSBzZWVzIGEgc29sdXRpb24gdG8g
dGhhdCBJRS9USU1FX1dBSVQgcHJvYmxlbSBJICAKPiB3b3VsZCBiZSBtb3JlIHRoYW4gaGFwcHkg
dG8gaW52ZXN0IHRpbWUgaW50byBmdXJ0aGVyaW5nIEF0aGVuYXMgIAo+IGV2b2x1dGlvbiwgSSBs
aWtlIHRoZSBjb25jZXB0cyB1bmRlcm5lYXRoIGFuZCBpZiB0aGV5J3JlIGNvdXBsZWQgd2l0aCBh
ICAKPiBkZWNlbnQgSlNjcmlwdCBsaWJyYXJ5IHRoZSAncmVhbCBhcHAgaW4gdGhlIGJyb3dzZXIn
IGJlY29tZXMgYSByZWFsaXR5LgoKRldJVywgaXQncyBub3QgdGhlIFRJTUVfV0FJVCBzb2NrZXRz
IHRoYXQgYXJlIHRoZSBwcm9ibGVtLCBidXQgdGhlCkNPTk5FQ1RFRCBzb2NrZXRzOyBpdCBsb29r
cyB0aGUgY29kZSBpbiBBdGhlbmEgdGhhdCB0cmllcyB0byBob29rIHVwIGFuCm9uYmVmb3JldW5s
b2FkIGhhbmRsZXIgaXMgYXBwYXJlbnRseSBkb2luZyBzb21ldGhpbmcgSUUgZG9lc24ndCBsaWtl
LCBzbwp0aGUgaGFuZGxlciBpc24ndCBhY3R1YWxseSBob29rZWQgdXAuIEFzIGEgcmVzdWx0LCB0
aGUgY29kZSB0aGF0IHdvdWxkCmNhdXNlIHRoZSB0cmFuc3BvcnQgY29ubmVjdGlvbihzKSB0byBi
ZSB0b3JuIGRvd24gbmV2ZXIgZXhlY3V0ZXMsIGFuZAp0aGV5IG9ubHkgZ28gYXdheSBvbmNlIHRo
ZSB0aW1lb3V0ICg1IG1pbnV0ZXMgYnkgZGVmYXVsdCwgSSBiZWxpZXZlKSBoYXMKZXhwaXJlZC4K
LS0gCm1pdGhyYW5kaSwgaSBBaW5pbCBlbi1CYWxhbmRvciwgYSBmYWVyIEFtYmFyCi0tLS0tLS0t
LS0tLS0tIG5leHQgcGFydCAtLS0tLS0tLS0tLS0tLQpBIG5vbi10ZXh0IGF0dGFjaG1lbnQgd2Fz
IHNjcnViYmVkLi4uCk5hbWU6IG5vdCBhdmFpbGFibGUKVHlwZTogYXBwbGljYXRpb24vcGdwLXNp
Z25hdHVyZQpTaXplOiAxOTcgYnl0ZXMKRGVzYzogRGlnaXRhbCBzaWduYXR1cmUKVXJsIDogaHR0
cDovL3R3aXN0ZWRtYXRyaXguY29tL3BpcGVybWFpbC90d2lzdGVkLXdlYi9hdHRhY2htZW50cy8y
MDA4MDkxNi85MGQ4MDE1NC9hdHRhY2htZW50LnBncAo=
From kozneb at gmail.com  Tue Sep 16 06:50:48 2008
From: kozneb at gmail.com (=?UTF-8?Q?Harald_Bl=C3=A5tand?=)
Date: Tue Sep 16 06:50:51 2008
Subject: [Twisted-web] Athena & browser 2-connection limit
In-Reply-To: <20080916102200.GA23508@mithrandi.net>
References: <1ff309e60809151123h518d1029w8004123185427aa1@mail.gmail.com>
	<48CF5B6C.7030405@thiengineering.ch>
	<20080916102200.GA23508@mithrandi.net>
Message-ID: <1ff309e60809160350i2c75a356td0ece3a6f1f0bd85@mail.gmail.com>

SGkgVHJpc3RhbiwgaG93IGFyZSB5b3U/CgoKCk9uIFR1ZSwgU2VwIDE2LCAyMDA4IGF0IDEyOjIy
IFBNLCBUcmlzdGFuIFNlbGlnbWFubiA8bWl0aHJhbmRpQG1pdGhyYW5kaS5uZXQKPiB3cm90ZToK
Cj4gKiBXZXJuZXIgVGhpZSA8d3RoaWVAdGhpZW5naW5lZXJpbmcuY2g+IFsyMDA4LTA5LTE2IDA5
OjA4OjI4ICswMjAwXToKPgo+ID4gSWYgeW91IG9yIGFueWJvZHkgZWxzZSBzZWVzIGEgc29sdXRp
b24gdG8gdGhhdCBJRS9USU1FX1dBSVQgcHJvYmxlbSBJCj4gPiB3b3VsZCBiZSBtb3JlIHRoYW4g
aGFwcHkgdG8gaW52ZXN0IHRpbWUgaW50byBmdXJ0aGVyaW5nIEF0aGVuYXMKPiA+IGV2b2x1dGlv
biwgSSBsaWtlIHRoZSBjb25jZXB0cyB1bmRlcm5lYXRoIGFuZCBpZiB0aGV5J3JlIGNvdXBsZWQg
d2l0aCBhCj4gPiBkZWNlbnQgSlNjcmlwdCBsaWJyYXJ5IHRoZSAncmVhbCBhcHAgaW4gdGhlIGJy
b3dzZXInIGJlY29tZXMgYSByZWFsaXR5Lgo+Cj4gRldJVywgaXQncyBub3QgdGhlIFRJTUVfV0FJ
VCBzb2NrZXRzIHRoYXQgYXJlIHRoZSBwcm9ibGVtLCBidXQgdGhlCj4gQ09OTkVDVEVEIHNvY2tl
dHM7IGl0IGxvb2tzIHRoZSBjb2RlIGluIEF0aGVuYSB0aGF0IHRyaWVzIHRvIGhvb2sgdXAgYW4K
PiBvbmJlZm9yZXVubG9hZCBoYW5kbGVyIGlzIGFwcGFyZW50bHkgZG9pbmcgc29tZXRoaW5nIElF
IGRvZXNuJ3QgbGlrZSwgc28KPiB0aGUgaGFuZGxlciBpc24ndCBhY3R1YWxseSBob29rZWQgdXAu
IEFzIGEgcmVzdWx0LCB0aGUgY29kZSB0aGF0IHdvdWxkCj4gY2F1c2UgdGhlIHRyYW5zcG9ydCBj
b25uZWN0aW9uKHMpIHRvIGJlIHRvcm4gZG93biBuZXZlciBleGVjdXRlcywgYW5kCj4gdGhleSBv
bmx5IGdvIGF3YXkgb25jZSB0aGUgdGltZW91dCAoNSBtaW51dGVzIGJ5IGRlZmF1bHQsIEkgYmVs
aWV2ZSkgaGFzCj4gZXhwaXJlZC4KPiAtLQo+CgoKRXIuLiBEbyB5b3UgcmVtZW1iZXIgd2UgdGFs
a2VkIGFib3V0IHRlYXJpbmcgZG93biBJRSdzIGNvbm5lY3Rpb25zIHNvbWUgdGltZQphZ28/IEkg
ZGlkIHNvbWV0aGluZyB0byBEaXZtb2QuQmFzZS5qcyB0aGF0IG1ha2VzIHRoaXMgd29yayAoc28g
d2UgaGF2ZSBubwpwcm9ibGVtcyB3aXRoIHRoaXMgYW55bW9yZSk7IHRoaW5rIEkgZXZlbiBwb3N0
ZWQgaXQuIEhhZCBhIGxvb2sgYXQgdGhlCnVwY29taW5nIE5ldm93IDAuOS4zMiBTVk4gbGFzdCB3
ZWVrIHRob3VnaCwgYW5kIGNvdWxkbid0IGZpbmQgaXQuIFNob3VsZCBJCmhhdmUgc2VudCBpdCBl
bHNld2hlcmU7IG1heWJlIGNyZWF0ZWQgYSB0aWNrZXQ/IEFyZSBvcmRpbmFyeSBjaXRpemVucwph
bGxvd2VkIHRvIGNyZWF0ZSB0aWNrZXRzIGluIERpdm1vZCdzIHRyYWM/CgpXb3VsZCBiZSB2ZXJ5
IGludGVyZXN0ZWQgaW4geW91ciB0aG91Z2h0cyBvbiB0aGUgb3JpZ2luYWwgcXVlc3Rpb24gaW4g
dGhpcwp0aHJlYWQgLSBob3cgZG8geW91IGZlZWwgYWJvdXQgdGhhdD8/CgpDaGVlcnMsCkhhcmFs
ZAotLS0tLS0tLS0tLS0tLSBuZXh0IHBhcnQgLS0tLS0tLS0tLS0tLS0KQW4gSFRNTCBhdHRhY2ht
ZW50IHdhcyBzY3J1YmJlZC4uLgpVUkw6IGh0dHA6Ly90d2lzdGVkbWF0cml4LmNvbS9waXBlcm1h
aWwvdHdpc3RlZC13ZWIvYXR0YWNobWVudHMvMjAwODA5MTYvNDgwZmYxZWEvYXR0YWNobWVudC5o
dG0K
From glyph at divmod.com  Tue Sep 16 06:56:44 2008
From: glyph at divmod.com (glyph@divmod.com)
Date: Tue Sep 16 06:53:11 2008
Subject: [Twisted-web] Athena & browser 2-connection limit
In-Reply-To: <48CF5B6C.7030405@thiengineering.ch>
References: <1ff309e60809151123h518d1029w8004123185427aa1@mail.gmail.com>
	<48CF5B6C.7030405@thiengineering.ch>
Message-ID: <20080916105644.32597.1060423567.divmod.xquotient.234@weber.divmod.com>

On 07:08 am, wthie@thiengineering.ch wrote:
>Hello Harald
>
>Try the following before you proceed:
>
>Run the nevow examples, go to calculator with IE7 or greater, then hit 
>F5 for reload in rapid sequence. You will hit the point where the 
>browser sits there seemingly deactivated with a waiting cursor. Wait 
>for the time it takes for the socket to come out of its TIME_WAIT state 
>and see the browser window come alive again.
>
>You can provoke this behavior also by providing a sequence of 
>LivePages, going from one LivePage to the other.
>
>The Athena implementation which was rewritten at SVN version 13786 to

This doesn't look like a rewrite of Athena:

    http://divmod.org/trac/changeset/13786

I think you meant SVN version 14017?

    http://divmod.org/trac/changeset/14017

Or maybe something else?
>implement a better disconnect logic collides in my experience with the 
>limited connections IE's developer decided to use. At any particular 
>time the browser accepts only two open sockets (...)

>This is in my opinion a fundamental flaw in the current Athena 
>implementation and leads to problems no end, because users WILL simply 
>NOT behave and will do the impossible. User feedback in our case was 
>so, that I was forced to live with the 'old' Athena stuff.

I don't think the flaw is in any way "fundamental".  The whole design of 
Athena is based around the idea that all the pieces are pluggable and 
can be substituted.  For example, ReliableMessageDelivery is a separate 
class specifically so that it can be modified in isolation and we can 
change this strategy without touching the rest of athena.
>If you or anybody else sees a solution to that IE/TIME_WAIT problem I 
>would be more than happy to invest time into furthering Athenas 
>evolution, I like the concepts underneath and if they're coupled with a 
>decent JScript library the 'real app in the browser' becomes a reality.

Several things come to mind.

One is that you could simply submit a patch to ReliableMessageDelivery 
to make it better.  There are a number of obvious flaws with the current 
implementation and it would be nice if it could be fixed.  This is not a 
very specific idea because browsers are awful, and I don't know of any 
collection of pure-Javascript gross kludges to work around their 
awfulness better than the current collection of gross kludges.

Another is that we could abuse a browser extension that supports real 
sockets - say, Flash - to provide a better "default" experience, but 
fall back to the current crummy behavior for the few users that don't 
have it.  A long time ago we did this, and there was a flash movie 
called 'flashconduit' included with Nevow's predecessor (Woven).  At the 
time this was impossible to build and test either in an automated way or 
on an open-source platform, so we abandoned that strategy.

Recently I've been playing with Flex, which is (among other things) a 
toolkit for building Flash movies out of actual source code rather than 
the atrocity that is a .FLA file.  It's also amenable to automated 
builds and testing, which FLA files had impeded in the past.

Java is another option, and although the typically long startup time for 
applets wouldn't make it ideal, it might be a reasonable backup option. 
I hear .NET has something called "no touch deployment", and Firefox has 
a socket API for extensions which an extension could selectively expose 
to the web page context.

Anyway, all of these options are really just different ways that the RDM 
might be adjusted; all of them could be implemented and the best option 
selected automatically based on the user's browser.  Given that you seem 
to have some specific requirements based on specific user experiences, I 
hope that you'll contribute patches that we can discuss and test in a 
variety of different browser situations.

From mithrandi at mithrandi.net  Tue Sep 16 07:15:54 2008
From: mithrandi at mithrandi.net (Tristan Seligmann)
Date: Tue Sep 16 07:16:29 2008
Subject: [Twisted-web] Athena & browser 2-connection limit
In-Reply-To: <1ff309e60809160350i2c75a356td0ece3a6f1f0bd85@mail.gmail.com>
References: <1ff309e60809151123h518d1029w8004123185427aa1@mail.gmail.com>
	<48CF5B6C.7030405@thiengineering.ch>
	<20080916102200.GA23508@mithrandi.net>
	<1ff309e60809160350i2c75a356td0ece3a6f1f0bd85@mail.gmail.com>
Message-ID: <20080916111554.GC23508@mithrandi.net>

KiBIYXJhbGQgQmzDpXRhbmQgPGtvem5lYkBnbWFpbC5jb20+IFsyMDA4LTA5LTE2IDEyOjUwOjQ4
ICswMjAwXToKCj4gRXIuLiBEbyB5b3UgcmVtZW1iZXIgd2UgdGFsa2VkIGFib3V0IHRlYXJpbmcg
ZG93biBJRSdzIGNvbm5lY3Rpb25zIHNvbWUgdGltZQo+IGFnbz8gSSBkaWQgc29tZXRoaW5nIHRv
IERpdm1vZC5CYXNlLmpzIHRoYXQgbWFrZXMgdGhpcyB3b3JrIChzbyB3ZSBoYXZlIG5vCj4gcHJv
YmxlbXMgd2l0aCB0aGlzIGFueW1vcmUpOyB0aGluayBJIGV2ZW4gcG9zdGVkIGl0LiBIYWQgYSBs
b29rIGF0IHRoZQo+IHVwY29taW5nIE5ldm93IDAuOS4zMiBTVk4gbGFzdCB3ZWVrIHRob3VnaCwg
YW5kIGNvdWxkbid0IGZpbmQgaXQuIFNob3VsZCBJCj4gaGF2ZSBzZW50IGl0IGVsc2V3aGVyZTsg
bWF5YmUgY3JlYXRlZCBhIHRpY2tldD8gQXJlIG9yZGluYXJ5IGNpdGl6ZW5zCj4gYWxsb3dlZCB0
byBjcmVhdGUgdGlja2V0cyBpbiBEaXZtb2QncyB0cmFjPwoKWWVzLCBhbHRob3VnaCBJIGJlbGll
dmUgeW91IHdpbGwgbmVlZCB0byBjcmVhdGUgYW4gYWNjb3VudC4gQSB0aWNrZXQKd291bGQgZGVm
aW5pdGVseSBiZSBhIGdvb2Qgd2F5IHRvIG1ha2Ugc3VyZSBpdCBkb2Vzbid0IGdldCBsb3N0LgoK
PiBXb3VsZCBiZSB2ZXJ5IGludGVyZXN0ZWQgaW4geW91ciB0aG91Z2h0cyBvbiB0aGUgb3JpZ2lu
YWwgcXVlc3Rpb24gaW4gdGhpcwo+IHRocmVhZCAtIGhvdyBkbyB5b3UgZmVlbCBhYm91dCB0aGF0
Pz8KCkl0J3MgYW4gaW50ZXJlc3RpbmcgaWRlYSwgYnV0IGlzIGl0IGFjdHVhbGx5IHBvc3NpYmxl
IHRvIHNoYXJlIGl0IGxpa2UKdGhhdD8gSSdtIG5vdCB2ZXJ5IGZhbWlsaWFyIHdpdGggSlMgc2Vj
dXJpdHkgcHJvdG9jb2xzIGluIHRoZSBicm93c2VyLApzbyBJJ20gbm90IHN1cmUgaWYgaXQgd291
bGQgcnVuIGFmb3VsIG9mIHRob3NlIHJlc3RyaWN0aW9ucyBvciBub3QuIEl0CndvdWxkIGFsc28g
bWVhbiBpbnRyb2R1Y2luZyBhIHNlcGFyYXRlIGxheWVyIHRvIG11bHRpcGxleCBiZXR3ZWVuIGFs
bAphY3RpdmUgbGl2ZXBhZ2VzLCBzaW5jZSB0aGV5IHdvdWxkIGJlIHNoYXJpbmcgdGhlIHNhbWUg
dHJhbnNwb3J0cy4KSWRlYWxseSwgYnJvd3NlcnMgd291bGQganVzdCBzdG9wIGJlaW5nIHNvIHJl
c3RyaWN0aXZlIGFib3V0IHRoZXNlCnRoaW5ncyA7KQotLSAKbWl0aHJhbmRpLCBpIEFpbmlsIGVu
LUJhbGFuZG9yLCBhIGZhZXIgQW1iYXIKLS0tLS0tLS0tLS0tLS0gbmV4dCBwYXJ0IC0tLS0tLS0t
LS0tLS0tCkEgbm9uLXRleHQgYXR0YWNobWVudCB3YXMgc2NydWJiZWQuLi4KTmFtZTogbm90IGF2
YWlsYWJsZQpUeXBlOiBhcHBsaWNhdGlvbi9wZ3Atc2lnbmF0dXJlClNpemU6IDE5NyBieXRlcwpE
ZXNjOiBEaWdpdGFsIHNpZ25hdHVyZQpVcmwgOiBodHRwOi8vdHdpc3RlZG1hdHJpeC5jb20vcGlw
ZXJtYWlsL3R3aXN0ZWQtd2ViL2F0dGFjaG1lbnRzLzIwMDgwOTE2L2E4MTA5YWJjL2F0dGFjaG1l
bnQtMDAwMS5wZ3AK
From exarkun at divmod.com  Tue Sep 16 09:49:51 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Tue Sep 16 09:50:09 2008
Subject: [Twisted-web] .js File caching behavior on different browsers
In-Reply-To: <48CF5ED9.7050309@thiengineering.ch>
Message-ID: <20080916134951.29191.857636133.divmod.quotient.26776@ohm>

On Tue, 16 Sep 2008 09:23:05 +0200, Werner Thie <wthie@thiengineering.ch> wrote:
>Jean-Paul
>Jean-Paul Calderone wrote:
>>On Sat, 13 Sep 2008 10:00:24 +0200, lasizoillo <lasizoillo@gmail.com> 
>>wrote:
>>>2008/9/13 Werner Thie <wthie@thiengineering.ch>:
>>>>Hi all
>>>>
>>>>Tried to send this to divmod-dev@divmod.org, but post didn't show up 
>>>>after
>>>>12hours.
>>>>
>>>>Might be an insanly stupid question but, is there a simple way to force
>>>>the reload of JScript code for nevow LivePages via a server issued
>>>>directive?
>>>
>>>I never expire a javascript file, I change his url. If I have a
>>>script.js file, I import script.js?v=1, script.js?v=2, ... This force
>>>a client reload only with new deploys.
>>
>>Athena effectively does this automatically.  If JavaScript source files
>>are changing but the browser isn't requesting the new versions, then
>>there's a bug somewhere that needs to be fixed.
>
>If JScript code is brought to the page via the javaScript classvar
>class LP(athena.Livepage):
>   javaScript = ('scripts/somescripts.js, 'scripts/otherscripts.js')
>

`javaScript`?  I don't know what that is - it's not a feature provided
by Athena.

Jean-Paul

From wthie at thiengineering.ch  Tue Sep 16 10:39:06 2008
From: wthie at thiengineering.ch (Werner Thie)
Date: Tue Sep 16 10:39:43 2008
Subject: [Twisted-web] Athena & browser 2-connection limit
In-Reply-To: <20080916102200.GA23508@mithrandi.net>
References: <1ff309e60809151123h518d1029w8004123185427aa1@mail.gmail.com>	<48CF5B6C.7030405@thiengineering.ch>
	<20080916102200.GA23508@mithrandi.net>
Message-ID: <48CFC50A.5070503@thiengineering.ch>

There are some post revolving around onbeforeunload/IE7 and a quick 
debugging session shows that no code is ever executed for onbeforeunload 
with IE.

Posts suggest that returning values from a func assigned to 
onbeforeunload are a nogo and that nulling the func is also leading to 
problems.

http://bustedmug.blogspot.com/2007/01/onbeforeunload-ie7-assigning-event.html

MS has comfirmed that the onbeforeunload event handler has an issue:
http://support.microsoft.com/kb/946214/en-us

I would be more than happy to move up to the current implementation of 
nevow if there is a fix for this problem.python

I brought this issue up on the list last year when testing with IE7 beta 
  but nobody was able to help ending in a few posts to divmod-dev on 
11/14/2007

Thanks for your help, Werner


Tristan Seligmann wrote:
> * Werner Thie <wthie@thiengineering.ch> [2008-09-16 09:08:28 +0200]:
> 
>> If you or anybody else sees a solution to that IE/TIME_WAIT problem I  
>> would be more than happy to invest time into furthering Athenas  
>> evolution, I like the concepts underneath and if they're coupled with a  
>> decent JScript library the 'real app in the browser' becomes a reality.
> 
> FWIW, it's not the TIME_WAIT sockets that are the problem, but the
> CONNECTED sockets; it looks the code in Athena that tries to hook up an
> onbeforeunload handler is apparently doing something IE doesn't like, so
> the handler isn't actually hooked up. As a result, the code that would
> cause the transport connection(s) to be torn down never executes, and
> they only go away once the timeout (5 minutes by default, I believe) has
> expired.
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web

From phil at bubblehouse.org  Tue Sep 16 10:46:19 2008
From: phil at bubblehouse.org (Phil Christensen)
Date: Tue Sep 16 10:46:31 2008
Subject: [Twisted-web] Athena & browser 2-connection limit
In-Reply-To: <1ff309e60809151123h518d1029w8004123185427aa1@mail.gmail.com>
References: <1ff309e60809151123h518d1029w8004123185427aa1@mail.gmail.com>
Message-ID: <6B50A4AD-DAF6-4475-B21A-EFDD04FF4BBE@bubblehouse.org>

On Sep 15, 2008, at 2:23 PM, Harald Bl?tand wrote:
> Hi there,
>
> Been thinking about this. It _would_ be cool if you could have more  
> than one LivePage per browser session, like in popups, or even frames.
>
> What do you think: Is there any obvious & fundamental reason why the  
> ReliableMessageDelivery stuff couldn't be modified, so that one  
> instance of it could be shared between several PageWidgets?

I'm not sure if I understand exactly what you're trying to do, but I  
have implemented a multi-window Athena app by sharing the LiveElement  
among the windows.

The drawback is that if the window holding your rendered LiveElement  
goes away, your child windows will lose their connection to the server.

In my case, I just have one LiveElement that handles all the  
communication between client and server. This is part of the main  
window, which also has a function like this:

     function getConnector(){
         return Nevow.Athena.Widget.get($('athenaid:1-client- 
connector'));
     }

At this point I can callRemote() on the returned object instance.

This works for me because of the simplicity of my application; with  
only the one LiveElement it seems that the Athena ID never changes, so  
this has been working really well for popping up editors and complex  
dialogs and so forth.

Also, I don't think I've ever tested this very thoroughly on IE, so  
YMMV.

-phil
From phil at bubblehouse.org  Tue Sep 16 11:04:40 2008
From: phil at bubblehouse.org (Phil Christensen)
Date: Tue Sep 16 11:05:00 2008
Subject: [Twisted-web] Athena & browser 2-connection limit
In-Reply-To: <6B50A4AD-DAF6-4475-B21A-EFDD04FF4BBE@bubblehouse.org>
References: <1ff309e60809151123h518d1029w8004123185427aa1@mail.gmail.com>
	<6B50A4AD-DAF6-4475-B21A-EFDD04FF4BBE@bubblehouse.org>
Message-ID: <D706FF0F-70DC-46B5-8226-AC38BA12A87C@bubblehouse.org>

On Sep 16, 2008, at 10:46 AM, Phil Christensen wrote:
> On Sep 15, 2008, at 2:23 PM, Harald Bl?tand wrote:
>> Hi there,
>>
>> Been thinking about this. It _would_ be cool if you could have more  
>> than one LivePage per browser session, like in popups, or even  
>> frames.
>>
>> What do you think: Is there any obvious & fundamental reason why  
>> the ReliableMessageDelivery stuff couldn't be modified, so that one  
>> instance of it could be shared between several PageWidgets?
>
> I'm not sure if I understand exactly what you're trying to do, but I  
> have implemented a multi-window Athena app by sharing the  
> LiveElement among the windows.
>
> The drawback is that if the window holding your rendered LiveElement  
> goes away, your child windows will lose their connection to the  
> server.
>
> In my case, I just have one LiveElement that handles all the  
> communication between client and server. This is part of the main  
> window, which also has a function like this:
>
>    function getConnector(){
>        return Nevow.Athena.Widget.get($('athenaid:1-client- 
> connector'));
>    }

Just wanted to mention that $ is just an alias for  
document.getElementById, it's not prototype or jquery or anything like  
that.

> At this point I can callRemote() on the returned object instance.
>
> This works for me because of the simplicity of my application; with  
> only the one LiveElement it seems that the Athena ID never changes,  
> so this has been working really well for popping up editors and  
> complex dialogs and so forth.
>
> Also, I don't think I've ever tested this very thoroughly on IE, so  
> YMMV.


From kozneb at gmail.com  Tue Sep 16 12:30:33 2008
From: kozneb at gmail.com (=?UTF-8?Q?Harald_Bl=C3=A5tand?=)
Date: Tue Sep 16 12:30:38 2008
Subject: [Twisted-web] Athena & browser 2-connection limit
In-Reply-To: <48CFC50A.5070503@thiengineering.ch>
References: <1ff309e60809151123h518d1029w8004123185427aa1@mail.gmail.com>
	<48CF5B6C.7030405@thiengineering.ch>
	<20080916102200.GA23508@mithrandi.net>
	<48CFC50A.5070503@thiengineering.ch>
Message-ID: <1ff309e60809160930u70f60fa1n6ff80b05b7f04bef@mail.gmail.com>

T24gVHVlLCBTZXAgMTYsIDIwMDggYXQgNDozOSBQTSwgV2VybmVyIFRoaWUgPHd0aGllQHRoaWVu
Z2luZWVyaW5nLmNoPndyb3RlOgoKPiBUaGVyZSBhcmUgc29tZSBwb3N0IHJldm9sdmluZyBhcm91
bmQgb25iZWZvcmV1bmxvYWQvSUU3IGFuZCBhIHF1aWNrCj4gZGVidWdnaW5nIHNlc3Npb24gc2hv
d3MgdGhhdCBubyBjb2RlIGlzIGV2ZXIgZXhlY3V0ZWQgZm9yIG9uYmVmb3JldW5sb2FkCj4gd2l0
aCBJRS4KPgo+Cj4+Cj4gSSBjYW1lIHVwIHdpdGggdGhlIGZvbGxvd2luZyBzb21lIG1vbnRocyBh
Z28uIFNpbmNlIHRoZW4sIHdlJ3JlIG5vdCBzZWVpbmcKdGhlIHByb2JsZW0gb24gSUU2IG9yIDcu
IFdvdWxkIGJlIGludGVyZXN0ZWQgaW4gaGVhcmluZyB3aGV0aGVyIGl0IHdvcmtzIGZvcgp5b3Uu
IChXb3VsZCBoYXZlIGVudGVyZWQgaXQgYXMgYSBEaXZtb2QgdGlja2V0LCBidXQgY2FuJ3Qgc2Vl
bSB0byBmaW5kIGEgd2F5CnRvIGNyZWF0ZSBvbmUsIG5vciB0byBjcmVhdGUgYW4gYWNjb3VudC4u
LikKCkhhcmFsZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tCkhlcmUncyB3aGF0IEkndmUgY2hhbmdlZCBpbiB0aGUgMC45LjMx
IEpTIGNvZGU6CgotLS0tLS0tLS0tLS0tLS0tLS0gTmV2b3cvQXRoZW5hL19faW5pdF9fLmpzICgy
IGFkZGl0aW9ucykKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KTmV2b3cuQXRoZW5hLldpZGdl
dC5faW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKCkgewogICAgRGl2bW9kLmRlYnVnKCJ3aWRnZXQiLCAi
SW5zdGFudGlhdGluZyBsaXZlIHdpZGdldHMiKTsKICAgIE5ldm93LkF0aGVuYS5XaWRnZXQuX3Bh
Z2VMb2FkZWQgPSB0cnVlOwogICAgLy8gV2l0aCB0aGUgbmV4dCBsaW5lLCBzZW5kQ2xvc2VNZXNz
YWdlIHdpbGwgZ2V0IGNhbGxlZCBpbiBJRS4gLy8gSGFyYWxkCiAgICBEaXZtb2QuQmFzZS5hZGRV
bkxvYWRFdmVudChOZXZvdy5BdGhlbmEucGFnZS5kZWxpdmVyeUNoYW5uZWwpOyAvLyBIYXJhbGQK
ICAgIE5ldm93LkF0aGVuYS5XaWRnZXQuX2luc3RhbnRpYXRlV2lkZ2V0cygpOwogICAgRGl2bW9k
LmRlYnVnKCJ3aWRnZXQiLCAiRmluaXNoZWQgaW5zdGFudGlhdGluZyBsaXZlIHdpZGdldHMiKTsK
fTsKTmV2b3cuQXRoZW5hLmJvb3RzdHJhcCA9IGZ1bmN0aW9uIChwYWdlQ2xhc3NOYW1lLCBjbGll
bnRJRCkgewogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgdmFyIHBhZ2VDbGFzcyA9IERpdm1vZC5u
YW1lZEFueShwYWdlQ2xhc3NOYW1lKTsKICAgIHNlbGYucGFnZSA9IHBhZ2VDbGFzcyhjbGllbnRJ
RCwgTmV2b3cuQXRoZW5hLl9jcmVhdGVNZXNzYWdlRGVsaXZlcnkpOwogICAgTmV2b3cuQXRoZW5h
LnBhZ2UgPSBzZWxmLnBhZ2U7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBIYXJh
bGQKICAgIHNlbGYucGFnZS5iaW5kRXZlbnRzKHdpbmRvdyk7CiAgICAuLi4uLgoKLS0tLS0tLS0t
LS0tLS0tLS0tIERpdm1vZC9CYXNlLmpzICgxIGFkZGVkIGZ1bmN0aW9uIGF0IHRoZSBlbmQpCi0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCkRpdm1vZC5CYXNlLmFkZFVuTG9hZEV2ZW50ID0gZnVu
Y3Rpb24oY2hhbm5lbCkgewogICAgLyoqKgogICAgICAgIEhhcmFsZCdzIGRlc3BlcmF0ZSB0cnkg
dG8gZ2V0IElFIHBhZ2UgcmVmcmVzaCB0byB3b3JrLi4uCiAgICAqKiovCiAgICB3aW5kb3cuYXR0
YWNoRXZlbnQoIm9udW5sb2FkIiwgZnVuY3Rpb24gKGUpCntjaGFubmVsLnNlbmRDbG9zZU1lc3Nh
Z2UoKTt9KTsKfTsKRGl2bW9kLkJhc2UuanNvblJlZ2lzdHJ5ID0gRGl2bW9kLkJhc2UuQWRhcHRl
clJlZ2lzdHJ5KCk7CgpJJ20gbm90IHVzZWQgdG8gdGhpcyBjb2Rpbmcgc3R5bGUsIHNvIGl0J3Mg
YSBiaXQgb2YgdHJpYWwgJiBlcnJvci4gQW55d2F5LApiZWZvcmUsIHNlbmRDbG9zZU1lc3NhZ2Ug
d291bGQgX25vdF8gYmUgY2FsbGVkOyBub3cgaXQgaXMsIGFuZCBJIGNhbiByZWZyZXNoCmFkIGxp
YiBvbiBJRSA2LmFuZCA3LgotLS0tLS0tLS0tLS0tLSBuZXh0IHBhcnQgLS0tLS0tLS0tLS0tLS0K
QW4gSFRNTCBhdHRhY2htZW50IHdhcyBzY3J1YmJlZC4uLgpVUkw6IGh0dHA6Ly90d2lzdGVkbWF0
cml4LmNvbS9waXBlcm1haWwvdHdpc3RlZC13ZWIvYXR0YWNobWVudHMvMjAwODA5MTYvMTUxNDgw
ZjIvYXR0YWNobWVudC5odG0K
From wthie at thiengineering.ch  Tue Sep 16 12:35:51 2008
From: wthie at thiengineering.ch (Werner Thie)
Date: Tue Sep 16 12:36:28 2008
Subject: [Twisted-web] Athena & browser 2-connection limit
In-Reply-To: <D706FF0F-70DC-46B5-8226-AC38BA12A87C@bubblehouse.org>
References: <1ff309e60809151123h518d1029w8004123185427aa1@mail.gmail.com>	<6B50A4AD-DAF6-4475-B21A-EFDD04FF4BBE@bubblehouse.org>
	<D706FF0F-70DC-46B5-8226-AC38BA12A87C@bubblehouse.org>
Message-ID: <48CFE067.3080407@thiengineering.ch>


>>> Been thinking about this. It _would_ be cool if you could have more 
>>> than one LivePage per browser session, like in popups, or even frames.
>>>
>>> What do you think: Is there any obvious & fundamental reason why the 
>>> ReliableMessageDelivery stuff couldn't be modified, so that one 
>>> instance of it could be shared between several PageWidgets?

Do you think 'multiple browser windows'?

If so, how would you cope with the different implementations the 
browsers have concerning their information sharing between windows, tabs?

IE, Chrome Safari, Opera handle session information differently  from 
Firefox, which shares a lot of information between windows and tabs. How 
would you distinguish tabs and windows?

Session and LivePages I have successfully used combined although one has 
to be careful with the toremember dict used in sessions and in general 
how state information is stored, because its very easy to run into non 
collectable garbage problems.

I am currently trying to combine ext2.2 with athena, which is in my 
opinion one of the possible ways to go for RIAs. I am also very 
interested in AFLAX on the client side but have very limited time to do 
experiments.

Werner

From glyph at divmod.com  Tue Sep 16 15:46:35 2008
From: glyph at divmod.com (glyph@divmod.com)
Date: Tue Sep 16 15:43:01 2008
Subject: [Twisted-web] Athena & browser 2-connection limit
In-Reply-To: <1ff309e60809160930u70f60fa1n6ff80b05b7f04bef@mail.gmail.com>
References: <1ff309e60809151123h518d1029w8004123185427aa1@mail.gmail.com>
	<48CF5B6C.7030405@thiengineering.ch>
	<20080916102200.GA23508@mithrandi.net>
	<48CFC50A.5070503@thiengineering.ch>
	<1ff309e60809160930u70f60fa1n6ff80b05b7f04bef@mail.gmail.com>
Message-ID: <20080916194635.32597.1428478773.divmod.xquotient.255@weber.divmod.com>


On 04:30 pm, kozneb@gmail.com wrote:
>On Tue, Sep 16, 2008 at 4:39 PM, Werner Thie 
><wthie@thiengineering.ch>wrote:
>>There are some post revolving around onbeforeunload/IE7 and a quick
>>debugging session shows that no code is ever executed for 
>>onbeforeunload
>>with IE.
>>>
>>I came up with the following some months ago. Since then, we're not 
>>seeing
>the problem on IE6 or 7. Would be interested in hearing whether it 
>works for
>you. (Would have entered it as a Divmod ticket, but can't seem to find 
>a way
>to create one, nor to create an account...)

Please feel free to enter a ticket, and to attach a patch.

We disabled registration due to some problems with spam and forgot to 
turn it back on.  It's on for now, but I'd recommend registering soon 
because we are likely to turn it off again if we start having spam 
problems again :).

When you do file a ticket, please file it with a description of the 
*problem*, not a description of your changes.  i.e.  "Reloading an 
athena page in IE 6 and 7 causes a socket leak", not, "Make 
sendCloseMessage work in IE".  It would be helpful if you were as 
detailed as possible about the problem.

It would also be very helpful if you could write some tests which 
demonstrate the problem; since the main development team of athena does 
very little testing in IE, a test object which thoroughly documents and 
fakes each version of IE's behavior with respect to these hooks would be 
especially helpful.

From kozneb at gmail.com  Tue Sep 16 16:28:42 2008
From: kozneb at gmail.com (=?UTF-8?Q?Harald_Bl=C3=A5tand?=)
Date: Tue Sep 16 16:28:48 2008
Subject: [Twisted-web] Athena & browser 2-connection limit
In-Reply-To: <20080916194635.32597.1428478773.divmod.xquotient.255@weber.divmod.com>
References: <1ff309e60809151123h518d1029w8004123185427aa1@mail.gmail.com>
	<48CF5B6C.7030405@thiengineering.ch>
	<20080916102200.GA23508@mithrandi.net>
	<48CFC50A.5070503@thiengineering.ch>
	<1ff309e60809160930u70f60fa1n6ff80b05b7f04bef@mail.gmail.com>
	<20080916194635.32597.1428478773.divmod.xquotient.255@weber.divmod.com>
Message-ID: <1ff309e60809161328t364d925av8845529338f3a955@mail.gmail.com>

T24gVHVlLCBTZXAgMTYsIDIwMDggYXQgOTo0NiBQTSwgPGdseXBoQGRpdm1vZC5jb20+IHdyb3Rl
OgoKPgo+IFBsZWFzZSBmZWVsIGZyZWUgdG8gZW50ZXIgYSB0aWNrZXQsIGFuZCB0byBhdHRhY2gg
YSBwYXRjaC4KPgo+IFdlIGRpc2FibGVkIHJlZ2lzdHJhdGlvbiBkdWUgdG8gc29tZSBwcm9ibGVt
cyB3aXRoIHNwYW0gYW5kIGZvcmdvdCB0byB0dXJuCj4gaXQgYmFjayBvbi4gIEl0J3Mgb24gZm9y
IG5vdywgYnV0IEknZCByZWNvbW1lbmQgcmVnaXN0ZXJpbmcgc29vbiBiZWNhdXNlIHdlCj4gYXJl
IGxpa2VseSB0byB0dXJuIGl0IG9mZiBhZ2FpbiBpZiB3ZSBzdGFydCBoYXZpbmcgc3BhbSBwcm9i
bGVtcyBhZ2FpbiA6KS4KPgoKClRoYW5rcyBnbHlwaDsgd2UncmUgYWxtb3N0IHRoZXJlIDotKQoK
RXJyb3JUaGUgcGFzc3dvcmQgZmlsZSBjb3VsZCBub3QgYmUgdXBkYXRlZC4gVHJhYyByZXF1aXJl
cyByZWFkIGFuZCB3cml0ZQphY2Nlc3MgdG8gYm90aCB0aGUgcGFzc3dvcmQgZmlsZSBhbmQgaXRz
IHBhcmVudCBkaXJlY3RvcnkuCi0tLS0tLS0tLS0tLS0tIG5leHQgcGFydCAtLS0tLS0tLS0tLS0t
LQpBbiBIVE1MIGF0dGFjaG1lbnQgd2FzIHNjcnViYmVkLi4uClVSTDogaHR0cDovL3R3aXN0ZWRt
YXRyaXguY29tL3BpcGVybWFpbC90d2lzdGVkLXdlYi9hdHRhY2htZW50cy8yMDA4MDkxNi81NzM0
YjY1My9hdHRhY2htZW50Lmh0bQo=
From glyph at divmod.com  Tue Sep 16 17:33:55 2008
From: glyph at divmod.com (glyph@divmod.com)
Date: Tue Sep 16 17:30:19 2008
Subject: [Twisted-web] Athena & browser 2-connection limit
In-Reply-To: <1ff309e60809161328t364d925av8845529338f3a955@mail.gmail.com>
References: <1ff309e60809151123h518d1029w8004123185427aa1@mail.gmail.com>
	<48CF5B6C.7030405@thiengineering.ch>
	<20080916102200.GA23508@mithrandi.net>
	<48CFC50A.5070503@thiengineering.ch>
	<1ff309e60809160930u70f60fa1n6ff80b05b7f04bef@mail.gmail.com>
	<20080916194635.32597.1428478773.divmod.xquotient.255@weber.divmod.com>
	<1ff309e60809161328t364d925av8845529338f3a955@mail.gmail.com>
Message-ID: <20080916213355.32597.1689919220.divmod.xquotient.257@weber.divmod.com>

On 08:28 pm, kozneb@gmail.com wrote:
>On Tue, Sep 16, 2008 at 9:46 PM, <glyph@divmod.com> wrote:

>>We disabled registration due to some problems with spam and forgot to 
>>turn
>>it back on.  It's on for now, but I'd recommend registering soon 
>>because we
>>are likely to turn it off again if we start having spam problems again 
>>:).

>Thanks glyph; we're almost there :-)

>Error (...)

OK, it should *actually* work now :).

From chenglim at imeem.com  Thu Sep 18 21:03:34 2008
From: chenglim at imeem.com (Chenglim Ear)
Date: Thu Sep 18 21:03:42 2008
Subject: [Twisted-web] how do I handle file upload (on the server) using
	twisted.web
Message-ID: <0A3A6EA86530E64EA3BEA603EC4401CA0455AF9E@dexbe014-8.exch014.msoutlookonline.net>

I have an http server set up using twistd.  I searched for some answers
on the web and saw something regarding getting the uploaded file from
request.content.  I tried calling  request.content.read and did not get
the file uploaded.  I was able to see something  if I call
request.content.seek(0) first, but the information is just the name of
the input field and the filename of the file that I uploaded.  Am I
forgetting to do something to ensure that the file is actually
transferred?  If somebody can point me to information about what's
available from the "request" object and how to use it, especially to
extract the uploaded file, that would really be helpful.

 

Chenglim.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-web/attachments/20080918/bdb65d80/attachment.htm
From listsin at integrateddevcorp.com  Fri Sep 19 21:06:13 2008
From: listsin at integrateddevcorp.com (s s)
Date: Fri Sep 19 21:06:51 2008
Subject: [Twisted-web] HTTPPageDownloader closes 'file-like object',
	file-like object goes bye-bye
Message-ID: <80B77F72-CC64-4B4E-8668-C2201E2D2EF6@integrateddevcorp.com>

Hi,

	This is my first post to this list.

	I've been using Twisted for a few (like three) days.  My wife had a  
baby two days ago, no, really.  I just got the other two kids to bed  
and thought I'd ask...sorry if this has been answered eleven-thousand  
times before but I did search the archives first.

	I'm writing a client app that needs to get the contents of a URL,  
usually just a web page.

	I'm trying to use client.py's downloadPage(url, file,  
contextFactory=None, *args, **kwargs):

	It claims to use a 'file' which, according to the docstring, can be a  
file or file-like object.
	
	It uses the HTTPDownloader class to perform the actual download.

	In the pageEnd(): method of HTTPDownloader, the 'file' is closed.

	Unfortunately, for 'file-like' objects, like StringIOs, this trashes  
the 'file'; not so useful since I need to work with the result.

	I realize I can subclass and override and such but it seems odd that  
a function that is documented to use a file-like object uses a class  
that will destroy something that's not a 'file.'

	I'm sure I'm missing something...or maybe nobody uses this 'cause  
there's something way better that I haven't discovered yet.

	Clues?

Thanks,

S,
AKA: Steve Steiner


	




From p.mayers at imperial.ac.uk  Sat Sep 20 06:44:30 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Sat Sep 20 06:45:08 2008
Subject: [Twisted-web] HTTPPageDownloader closes 'file-like object',
	file-like object goes bye-bye
In-Reply-To: <80B77F72-CC64-4B4E-8668-C2201E2D2EF6@integrateddevcorp.com>
References: <80B77F72-CC64-4B4E-8668-C2201E2D2EF6@integrateddevcorp.com>
Message-ID: <48D4D40E.3060403@imperial.ac.uk>

s s wrote:
> Hi,
> 
>     This is my first post to this list.
> 
>     I've been using Twisted for a few (like three) days.  My wife had a 
> baby two days ago, no, really.  I just got the other two kids to bed and 
> thought I'd ask...sorry if this has been answered eleven-thousand times 
> before but I did search the archives first.
> 
>     I'm writing a client app that needs to get the contents of a URL, 
> usually just a web page.
> 
>     I'm trying to use client.py's downloadPage(url, file, 
> contextFactory=None, *args, **kwargs):
> 
>     It claims to use a 'file' which, according to the docstring, can be 
> a file or file-like object.
>     
>     It uses the HTTPDownloader class to perform the actual download.
> 
>     In the pageEnd(): method of HTTPDownloader, the 'file' is closed.
> 
>     Unfortunately, for 'file-like' objects, like StringIOs, this trashes 
> the 'file'; not so useful since I need to work with the result.

Huh, so it does. That's a pretty rubbish feature of StringIO

> 
>     I realize I can subclass and override and such but it seems odd that 
> a function that is documented to use a file-like object uses a class 
> that will destroy something that's not a 'file.'

My guess is that calling "close" is to ensure that data is actually 
written to the file before returning, but I agree it's not helpful.

Since you obviously want the page as a string, I recommend you use 
t.w.client.getPage which returns the result as a deferred(string):

from twisted.internet import reactor
from twisted.web import client

def got(text):
   print "page is", len(text), "bytes"

client.getPage('http://www.google.com').addCallback(got)
reactor.run()



> 
>     I'm sure I'm missing something...or maybe nobody uses this 'cause 
> there's something way better that I haven't discovered yet.
> 
>     Clues?
> 
> Thanks,
> 
> S,
> AKA: Steve Steiner
> 
> 
>     
> 
> 
> 
> 
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web


From hancock.robert at gmail.com  Sun Sep 21 18:13:54 2008
From: hancock.robert at gmail.com (Robert Hancock)
Date: Sun Sep 21 18:13:57 2008
Subject: [Twisted-web] Proxy Authentication with a Password Protected Site
Message-ID: <613d56580809211513l29a67b04xe2f2a28af51dce74@mail.gmail.com>

from twisted.web import client
from twisted.internet import reactor
import base64
import sys

def printPage(data):
    print data
    reactor.stop()

def printError(failure):
    print >> sys.stderr, "Error:", failure.getErrorMessage()
    reactor.stop()

if len(sys.argv) == 4:
    url = sys.argv[1]
    username = sys.argv[2]
    password = sys.argv[3]

    basicAuth = base64.encodestring('%s:%s' % (username, password))
    authHeader = "Basic " + basicAuth.strip()

    client.getPage(url, headers={"Authorization":
	authHeader}).addCallback(printPage).addErrback(printError)
    reactor.run()
else:
    print 'Usage: get_web_page.py <URL>'

If I run this against a password protected HTTP(S) site from a host
that has direct access to the Internet it works fine.  I now have to
move it behind a proxy that requires authentication.  The Twisted
documentation did not make it clear (to me) how to add proxy
authentication and I cannot find an example on the Internet.

I've tried adding an additional Proxy-Authentication header to the
call, but that doesn't help  Any ideas would be greatly appreciated.

From p.mayers at imperial.ac.uk  Mon Sep 22 04:57:25 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Mon Sep 22 04:58:04 2008
Subject: [Twisted-web] Proxy Authentication with a Password Protected Site
In-Reply-To: <613d56580809211513l29a67b04xe2f2a28af51dce74@mail.gmail.com>
References: <613d56580809211513l29a67b04xe2f2a28af51dce74@mail.gmail.com>
Message-ID: <48D75DF5.1090300@imperial.ac.uk>

> 
> If I run this against a password protected HTTP(S) site from a host
> that has direct access to the Internet it works fine.  I now have to
> move it behind a proxy that requires authentication.  The Twisted
> documentation did not make it clear (to me) how to add proxy
> authentication and I cannot find an example on the Internet.
> 
> I've tried adding an additional Proxy-Authentication header to the
> call, but that doesn't help  Any ideas would be greatly appreciated.

"Didn't help" how? What didn't work?

What kind of proxy is it?

From hancock.robert at gmail.com  Mon Sep 22 09:38:57 2008
From: hancock.robert at gmail.com (Robert Hancock)
Date: Mon Sep 22 09:39:04 2008
Subject: [Twisted-web] Proxy Authentication with a Password Protected Site
In-Reply-To: <48D75DF5.1090300@imperial.ac.uk>
References: <613d56580809211513l29a67b04xe2f2a28af51dce74@mail.gmail.com>
	<48D75DF5.1090300@imperial.ac.uk>
Message-ID: <613d56580809220638l9e0bb83i557e63c3f7747621@mail.gmail.com>

Didn't help in that I receive an HTTP 407 Proxy Authentication required.

It is a proxy that requires Basic HTTP authentication.

On Mon, Sep 22, 2008 at 4:57 AM, Phil Mayers <p.mayers@imperial.ac.uk> wrote:
>>
>> If I run this against a password protected HTTP(S) site from a host
>> that has direct access to the Internet it works fine.  I now have to
>> move it behind a proxy that requires authentication.  The Twisted
>> documentation did not make it clear (to me) how to add proxy
>> authentication and I cannot find an example on the Internet.
>>
>> I've tried adding an additional Proxy-Authentication header to the
>> call, but that doesn't help  Any ideas would be greatly appreciated.
>
> "Didn't help" how? What didn't work?
>
> What kind of proxy is it?
>
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>

From p.mayers at imperial.ac.uk  Mon Sep 22 09:43:36 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Mon Sep 22 09:44:11 2008
Subject: [Twisted-web] Proxy Authentication with a Password Protected Site
In-Reply-To: <613d56580809220638l9e0bb83i557e63c3f7747621@mail.gmail.com>
References: <613d56580809211513l29a67b04xe2f2a28af51dce74@mail.gmail.com>	<48D75DF5.1090300@imperial.ac.uk>
	<613d56580809220638l9e0bb83i557e63c3f7747621@mail.gmail.com>
Message-ID: <48D7A108.1020700@imperial.ac.uk>

Robert Hancock wrote:
> Didn't help in that I receive an HTTP 407 Proxy Authentication required.

I don't see what bit of that code actually sends the traffic to the proxy?

From exarkun at divmod.com  Mon Sep 22 09:44:48 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Mon Sep 22 09:45:05 2008
Subject: [Twisted-web] Proxy Authentication with a Password Protected Site
In-Reply-To: <613d56580809220638l9e0bb83i557e63c3f7747621@mail.gmail.com>
Message-ID: <20080922134448.29191.1114859536.divmod.quotient.29706@ohm>

On Mon, 22 Sep 2008 09:38:57 -0400, Robert Hancock <hancock.robert@gmail.com> wrote:
>On Mon, Sep 22, 2008 at 4:57 AM, Phil Mayers <p.mayers@imperial.ac.uk> wrote:
>>>
>>> If I run this against a password protected HTTP(S) site from a host
>>> that has direct access to the Internet it works fine.  I now have to
>>> move it behind a proxy that requires authentication.  The Twisted
>>> documentation did not make it clear (to me) how to add proxy
>>> authentication and I cannot find an example on the Internet.
>>>
>>> I've tried adding an additional Proxy-Authentication header to the
>>> call, but that doesn't help  Any ideas would be greatly appreciated.
>>
>> "Didn't help" how? What didn't work?
>>
>> What kind of proxy is it?
>>
>
>Didn't help in that I receive an HTTP 407 Proxy Authentication required.
>
>It is a proxy that requires Basic HTTP authentication.
>

Maybe you meant to add the "Proxy-Authenticate" header instead of the
"Proxy-Authentication" header?

Twisted Web provides no particular support for authenticating with proxies,
but it doesn't do anything that would prevent you from handling this in your
code, either.

Jean-Paul

From hancock.robert at gmail.com  Mon Sep 22 10:08:56 2008
From: hancock.robert at gmail.com (Robert Hancock)
Date: Mon Sep 22 10:09:01 2008
Subject: [Twisted-web] Proxy Authentication with a Password Protected Site
In-Reply-To: <20080922134448.29191.1114859536.divmod.quotient.29706@ohm>
References: <613d56580809220638l9e0bb83i557e63c3f7747621@mail.gmail.com>
	<20080922134448.29191.1114859536.divmod.quotient.29706@ohm>
Message-ID: <613d56580809220708k2349432bvc4fa211a9b7c88e9@mail.gmail.com>

proxyUsername = 'bob_hancock'
proxyPassword = 'myproxypass'
proxyAuth = base64.encodestring('%s:%s' % (proxyUsername, proxyPassword))
proxy_authHeader = "Basic " + proxyAuth.strip()

url = "https:/www.myexampl.com" #password protected site
username = "bob_hancock"
password = "myremotepass"
basicAuth = base64.encodestring('%s:%s' % (username, password))
authHeader = "Basic " + basicAuth.strip()

return client.getPage(url, headers={"Authorization": authHeader,
"Proxy-Authenticate": proxy_authHeader})

Is this the approach?  I'm behind a corporate proxy/firewall so that
if I make a direct HTTPS request I receive an HTTP 407 response.

Thanks for the rapid reply. This is my first attempt at Twisted.


On Mon, Sep 22, 2008 at 9:44 AM, Jean-Paul Calderone <exarkun@divmod.com> wrote:
> On Mon, 22 Sep 2008 09:38:57 -0400, Robert Hancock
> <hancock.robert@gmail.com> wrote:
>>
>> On Mon, Sep 22, 2008 at 4:57 AM, Phil Mayers <p.mayers@imperial.ac.uk>
>> wrote:
>>>>
>>>> If I run this against a password protected HTTP(S) site from a host
>>>> that has direct access to the Internet it works fine.  I now have to
>>>> move it behind a proxy that requires authentication.  The Twisted
>>>> documentation did not make it clear (to me) how to add proxy
>>>> authentication and I cannot find an example on the Internet.
>>>>
>>>> I've tried adding an additional Proxy-Authentication header to the
>>>> call, but that doesn't help  Any ideas would be greatly appreciated.
>>>
>>> "Didn't help" how? What didn't work?
>>>
>>> What kind of proxy is it?
>>>
>>
>> Didn't help in that I receive an HTTP 407 Proxy Authentication required.
>>
>> It is a proxy that requires Basic HTTP authentication.
>>
>
> Maybe you meant to add the "Proxy-Authenticate" header instead of the
> "Proxy-Authentication" header?
>
> Twisted Web provides no particular support for authenticating with proxies,
> but it doesn't do anything that would prevent you from handling this in your
> code, either.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>

From exarkun at divmod.com  Mon Sep 22 10:25:09 2008
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Mon Sep 22 10:25:26 2008
Subject: [Twisted-web] Proxy Authentication with a Password Protected Site
In-Reply-To: <613d56580809220708k2349432bvc4fa211a9b7c88e9@mail.gmail.com>
Message-ID: <20080922142509.29191.801776661.divmod.quotient.29713@ohm>

On Mon, 22 Sep 2008 10:08:56 -0400, Robert Hancock <hancock.robert@gmail.com> wrote:
>On Mon, Sep 22, 2008 at 9:44 AM, Jean-Paul Calderone <exarkun@divmod.com> wrote:
>> On Mon, 22 Sep 2008 09:38:57 -0400, Robert Hancock
>> <hancock.robert@gmail.com> wrote:
>>>
>>> On Mon, Sep 22, 2008 at 4:57 AM, Phil Mayers <p.mayers@imperial.ac.uk>
>>> wrote:
>>>>>
>>>>> If I run this against a password protected HTTP(S) site from a host
>>>>> that has direct access to the Internet it works fine.  I now have to
>>>>> move it behind a proxy that requires authentication.  The Twisted
>>>>> documentation did not make it clear (to me) how to add proxy
>>>>> authentication and I cannot find an example on the Internet.
>>>>>
>>>>> I've tried adding an additional Proxy-Authentication header to the
>>>>> call, but that doesn't help  Any ideas would be greatly appreciated.
>>>>
>>>> "Didn't help" how? What didn't work?
>>>>
>>>> What kind of proxy is it?
>>>>
>>>
>>> Didn't help in that I receive an HTTP 407 Proxy Authentication required.
>>>
>>> It is a proxy that requires Basic HTTP authentication.
>>>
>>
>> Maybe you meant to add the "Proxy-Authenticate" header instead of the
>> "Proxy-Authentication" header?
>>
>> Twisted Web provides no particular support for authenticating with proxies,
>> but it doesn't do anything that would prevent you from handling this in your
>> code, either.
>>
>> Jean-Paul
>>
>
>proxyUsername = 'bob_hancock'
>proxyPassword = 'myproxypass'
>proxyAuth = base64.encodestring('%s:%s' % (proxyUsername, proxyPassword))
>proxy_authHeader = "Basic " + proxyAuth.strip()
>
>url = "https:/www.myexampl.com" #password protected site
>username = "bob_hancock"
>password = "myremotepass"
>basicAuth = base64.encodestring('%s:%s' % (username, password))
>authHeader = "Basic " + basicAuth.strip()
>
>return client.getPage(url, headers={"Authorization": authHeader,
>"Proxy-Authenticate": proxy_authHeader})
>
>Is this the approach?  I'm behind a corporate proxy/firewall so that
>if I make a direct HTTPS request I receive an HTTP 407 response.
>
>Thanks for the rapid reply. This is my first attempt at Twisted.
>

This looks largely correct to me.  I don't have a proxy (and I definitely
don't have /your/ proxy) to actually test it against, so I may be missing
something.  One thing that does come to mind is that a proxy might require
that the request URL is absolute rather than relative (<http://foo/bar>
instead of </bar>).  I'm not sure when exactly this is required, nor how
to convince `getPage? to make a request of that form.  This might be related
to <http://twistedmatrix.com/trac/ticket/2714>.

Jean-Paul

From p.mayers at imperial.ac.uk  Mon Sep 22 11:13:14 2008
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Mon Sep 22 11:13:49 2008
Subject: [Twisted-web] Proxy Authentication with a Password Protected Site
In-Reply-To: <20080922142509.29191.801776661.divmod.quotient.29713@ohm>
References: <20080922142509.29191.801776661.divmod.quotient.29713@ohm>
Message-ID: <48D7B60A.9020108@imperial.ac.uk>


>>
>> Thanks for the rapid reply. This is my first attempt at Twisted.
>>
> 
> This looks largely correct to me.  I don't have a proxy (and I definitely
> don't have /your/ proxy) to actually test it against, so I may be missing
> something.  One thing that does come to mind is that a proxy might require
> that the request URL is absolute rather than relative (<http://foo/bar>
> instead of </bar>).  I'm not sure when exactly this is required, nor how
> to convince `getPage? to make a request of that form.  This might be 
> related
> to <http://twistedmatrix.com/trac/ticket/2714>.

Most transparent proxies do not, but AFAIK transparent proxies can't 
authenticate, for obvious reasons.

See also:

http://twistedmatrix.com/pipermail/twisted-python/2008-July/018150.html

From mithrandi at mithrandi.net  Mon Sep 22 20:51:08 2008
From: mithrandi at mithrandi.net (Tristan Seligmann)
Date: Mon Sep 22 20:51:52 2008
Subject: [Twisted-web] HTTPPageDownloader closes 'file-like object',
	file-like object goes bye-bye
In-Reply-To: <48D4D40E.3060403@imperial.ac.uk>
References: <80B77F72-CC64-4B4E-8668-C2201E2D2EF6@integrateddevcorp.com>
	<48D4D40E.3060403@imperial.ac.uk>
Message-ID: <20080923005108.GB17231@mithrandi.net>

KiBQaGlsIE1heWVycyA8cC5tYXllcnNAaW1wZXJpYWwuYWMudWs+IFsyMDA4LTA5LTIwIDExOjQ0
OjMwICswMTAwXToKCj4+ICAgICBVbmZvcnR1bmF0ZWx5LCBmb3IgJ2ZpbGUtbGlrZScgb2JqZWN0
cywgbGlrZSBTdHJpbmdJT3MsIHRoaXMgCj4+IHRyYXNoZXMgdGhlICdmaWxlJzsgbm90IHNvIHVz
ZWZ1bCBzaW5jZSBJIG5lZWQgdG8gd29yayB3aXRoIHRoZSByZXN1bHQuCj4KPiBIdWgsIHNvIGl0
IGRvZXMuIFRoYXQncyBhIHByZXR0eSBydWJiaXNoIGZlYXR1cmUgb2YgU3RyaW5nSU8KClBlcmhh
cHMgeW91IGNvdWxkIHN1YmNsYXNzIFN0cmluZ0lPIHRvICJuZXV0cmFsaXplIiB0aGUgZGF0YS1k
ZXN0cm95aW5nCmZ1bmN0aW9uYWxpdHkgb2YgY2xvc2UoKT8KLS0gCm1pdGhyYW5kaSwgaSBBaW5p
bCBlbi1CYWxhbmRvciwgYSBmYWVyIEFtYmFyCi0tLS0tLS0tLS0tLS0tIG5leHQgcGFydCAtLS0t
LS0tLS0tLS0tLQpBIG5vbi10ZXh0IGF0dGFjaG1lbnQgd2FzIHNjcnViYmVkLi4uCk5hbWU6IG5v
dCBhdmFpbGFibGUKVHlwZTogYXBwbGljYXRpb24vcGdwLXNpZ25hdHVyZQpTaXplOiAxOTcgYnl0
ZXMKRGVzYzogRGlnaXRhbCBzaWduYXR1cmUKVXJsIDogaHR0cDovL3R3aXN0ZWRtYXRyaXguY29t
L3BpcGVybWFpbC90d2lzdGVkLXdlYi9hdHRhY2htZW50cy8yMDA4MDkyMy8wNGNjYzZkOC9hdHRh
Y2htZW50LnBncAo=
From hancock.robert at gmail.com  Tue Sep 23 15:05:14 2008
From: hancock.robert at gmail.com (Robert Hancock)
Date: Tue Sep 23 15:05:17 2008
Subject: [Twisted-web] Proxy Authentication with a Password Protected Site
In-Reply-To: <48D7B60A.9020108@imperial.ac.uk>
References: <20080922142509.29191.801776661.divmod.quotient.29713@ohm>
	<48D7B60A.9020108@imperial.ac.uk>
Message-ID: <613d56580809231205w32977390p3a17f31cda93c28e@mail.gmail.com>

Thank  you for all your help.  This worked.

        # Proxy credentials
        proxyAuth = base64.encodestring('%s:%s' % (proxy_username,
proxy_password))
        proxy_authHeader = "Basic " + proxyAuth.strip()

        # Web site credentials
        basicAuth = base64.encodestring('%s:%s' % (username, password))
        authHeader = "Basic " + basicAuth.strip()

        return client.getPage(url, headers={"Authorization":
authHeader, 'Proxy-Authenticate': proxy_authHeader})


On Mon, Sep 22, 2008 at 11:13 AM, Phil Mayers <p.mayers@imperial.ac.uk> wrote:
>
>>>
>>> Thanks for the rapid reply. This is my first attempt at Twisted.
>>>
>>
>> This looks largely correct to me.  I don't have a proxy (and I definitely
>> don't have /your/ proxy) to actually test it against, so I may be missing
>> something.  One thing that does come to mind is that a proxy might require
>> that the request URL is absolute rather than relative (<http://foo/bar>
>> instead of </bar>).  I'm not sure when exactly this is required, nor how
>> to convince `getPage? to make a request of that form.  This might be
>> related
>> to <http://twistedmatrix.com/trac/ticket/2714>.
>
> Most transparent proxies do not, but AFAIK transparent proxies can't
> authenticate, for obvious reasons.
>
> See also:
>
> http://twistedmatrix.com/pipermail/twisted-python/2008-July/018150.html
>
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>

