<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Re: Twisted &amp; legacy code - Unorthodox? Opinions
	wanted
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Re%3A%20Twisted%20%26%20legacy%20code%20-%20Unorthodox%3F%20Opinions%0A%09wanted&In-Reply-To=9F028CC77827D611ACEE0002A5F12F0703ECC3A8%40semldsntmsx208.seml.astrazeneca.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000393.html">
   <LINK REL="Next"  HREF="000399.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Re: Twisted &amp; legacy code - Unorthodox? Opinions
	wanted</H1>
    <B>Alex Levy</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Re%3A%20Twisted%20%26%20legacy%20code%20-%20Unorthodox%3F%20Opinions%0A%09wanted&In-Reply-To=9F028CC77827D611ACEE0002A5F12F0703ECC3A8%40semldsntmsx208.seml.astrazeneca.net"
       TITLE="[Twisted-web] Re: Twisted &amp; legacy code - Unorthodox? Opinions
	wanted">mesozoic at polynode.com
       </A><BR>
    <I>Thu Apr 22 10:24:02 MDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000393.html">[Twisted-web] Twisted &amp; legacy code - Unorthodox? Opinions wanted
</A></li>
        <LI>Next message: <A HREF="000399.html">[Twisted-web] Re: session, quick one
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#394">[ date ]</a>
              <a href="thread.html#394">[ thread ]</a>
              <a href="subject.html#394">[ subject ]</a>
              <a href="author.html#394">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 2004-04-22 at 08:22, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">Harald.Nyman at astrazeneca.com</A> wrote:
&gt;<i> What's described could be a creative approach to dealing with legacy code,
</I>&gt;<i> but it could also be an ugly hack, and I would really benefit from the views
</I>&gt;<i> of you gurus as to whether this looks like a good/acceptable/bad way to use
</I>&gt;<i> Twisted. (If 'bad' - any immediate suggestions? :))
</I>
Certainly.

&gt;<i> Creating the request in the browser:
</I>&gt;<i> All links in the page are modified to NOT trigger a GET/POST, but use
</I>&gt;<i> javascript to
</I>&gt;<i>  - scan form input (&lt;INPUT&gt;, &lt;SELECT&gt;, etc) and build formInputDict (&quot;{name:
</I>&gt;<i> value, ...}&quot;)
</I>&gt;<i>  - create a similar representation of the cookies, as cookiesDict
</I>&gt;<i>  - send the &quot;::&quot;-delimited string using a small applet
</I>
Unless you are being _very_ selective and _very_ careful in how this
dictionary is formed and interpreted, it seems like this might open up
unwarranted vulnerabilities.

&gt;<i> The browser
</I>&gt;<i>  - receives the generated HTML string through the applet
</I>&gt;<i>  - parses the cookies
</I>&gt;<i>  - displays the HTML, using document.write
</I>
Yikes!

&gt;<i> Is this really a valid way to use Twisted?
</I>
I would say any use of Twisted is a valid use, but that doesn't mean
it's the best way to leverage the library's real strengths.

&quot;Luke, if only you knew the power...&quot;

&gt;<i> Will it scale? Will it work with future Twisted versions?
</I>
Probably, but again, you're not really taking advantage of all the
flexibility and modularity that Twisted offers. You're force-feeding the
server in order to squeeze out some performance benefits, and doing so
in a way that (to me) seems destined to become a developer's nightmare.

&gt;<i> It can't be used through a firewall.
</I>
See below for an application design that _can_ go through a firewall.

&gt;<i> We don't want to rely on and maintain home-written javascript.
</I>&gt;<i>  - Good point. However,
</I>&gt;<i>    1) We're talking about roughly 2 A4 pages
</I>
It will grow.

&gt;<i>    2) The javascript to handle form input &amp; cookies is meant to be general,
</I>&gt;<i> and once it's validated, we should not need to touch it much.
</I>
Unless security issues come along. And they will.

&gt;<i> We can't do unit tests on the javascript.
</I>&gt;<i>  - Correct. See previous point.
</I>
False. Unit tests are entirely possible in Javascript. Whether you
actually _want_ to do them is a different issue. Hint: you don't. :)

You should take a look at how Nevow &lt;<A HREF="http://www.nevow.com/">http://www.nevow.com/</A>&gt; has
implemented its Freeform module. I'm not saying you need to port your
entire app to Nevow (though it is worth considering), but I think you're
trying to do roughly the same thing. Maybe by emulating some of Nevow's
design decisions, you could get equal performance benefits with a lot
less Javascript magic. An example query:

1. You have a Twisted server running, which serves up web pages. For
example, going to /tasks will show you your task list for today. (I'm
pretending I know anything about what your web app does.)

2. The HTML code for /tasks renders a form, &quot;foo&quot;, with a checklist or a
bunch of text fields or whatever else you want.

3. You type in some fields, change values, uncheck stuff, whatever.
Click the Submit button, and it sends a POST to /tasks/formpost!foo.

4. Your Twisted server, receiving this POST, attempts to find the Python
object responsible for handling the URL /tasks/formpost!foo:

 a. First it finds &quot;/&quot;, your site root, and asks for &quot;tasks&quot;.

 b. Next finds &quot;tasks&quot;, which is your TasksPage instance (or something
like that). Twisted asks the TasksPage instance to find a child named
&quot;formpost!foo&quot;.

 c. Your TasksPage says, &quot;AHA! I recognize this! It's not really
requesting a separate page. That weird URL tells me to interpret the
form data, modify some internal state or business objects, and then go
right back to the tasks page where I started. Done!&quot;

5. Profit.

This is, with a _lot_ of technical detail missing, what Freeform is all
about -- designing a process for designing objects for which forms can
be automatically rendered and interpreted, with minimal effort on your
part. I'm already using it to design a non-fancy CMS that will power my
web page very soon.

Nevow is currently undergoing some serious reorganization, and after the
refactor, Freeform will have gone from a really cool gizmo to a very
strong, flexible engine. If you're interested in using such a framework,
I suggest getting more information from those developers more closely
involved in the process. (If you don't have an aversion to IRC, the best
place to get the latest scoop is in #twisted.web on irc.freenode.net.)

However, if your team isn't comfortable working with a platform that is
still going through serious changes, just implementing the above process
on your own would, in my view, result in a much better platform for web
development than the Javascript/socket mess you've suggested above.

One man's opinion, writ large. Anyone else?

-- 
Alex Levy
WWW: <A HREF="http://mesozoic.geecs.org/">http://mesozoic.geecs.org/</A>

&quot;Never let your sense of morals prevent you from doing what is right.&quot;
-- Salvor Hardin, Isaac Asimov's _Foundation_
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : <A HREF="http://pyramid.twistedmatrix.com/pipermail/twisted-web/attachments/20040422/e701716c/attachment.bin">http://pyramid.twistedmatrix.com/pipermail/twisted-web/attachments/20040422/e701716c/attachment.bin</A>
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000393.html">[Twisted-web] Twisted &amp; legacy code - Unorthodox? Opinions wanted
</A></li>
	<LI>Next message: <A HREF="000399.html">[Twisted-web] Re: session, quick one
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#394">[ date ]</a>
              <a href="thread.html#394">[ thread ]</a>
              <a href="subject.html#394">[ subject ]</a>
              <a href="author.html#394">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
