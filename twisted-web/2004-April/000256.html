<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] [PATCH] nevow.static.File directory listing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5BPATCH%5D%20nevow.static.File%20directory%20listing&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000255.html">
   <LINK REL="Next"  HREF="000257.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] [PATCH] nevow.static.File directory listing</H1>
    <B>Lee Harr</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5BPATCH%5D%20nevow.static.File%20directory%20listing&In-Reply-To="
       TITLE="[Twisted-web] [PATCH] nevow.static.File directory listing">missive at hotmail.com
       </A><BR>
    <I>Fri Apr  2 20:40:57 MST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000255.html">[Twisted-web] Re: list archives?
</A></li>
        <LI>Next message: <A HREF="000257.html">[Twisted-web] Re: list archives?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#256">[ date ]</a>
              <a href="thread.html#256">[ thread ]</a>
              <a href="subject.html#256">[ subject ]</a>
              <a href="author.html#256">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I was getting an infinitely recursive redirect trying to do something
like this ...



from nevow import rend, static
from nevow import appserver

from twisted.application import service
from twisted.application import internet


class ADir(rend.Page):
    def locateChild(self, request, segments):
        path = '/'.join(segments)
        return static.File(path), ()


application = service.Application('ADirlist')
webservice = internet.TCPServer(
    8080,
    appserver.NevowSite(ADir())
)
webservice.setServiceParent(application)




This patch to nevow.static.File fixes the problem for me.

274c274,279
&lt;             return self.redirect(request)
---
&gt;<i>             return dirlist.DirectoryLister(self.fp.path,
</I>&gt;<i>                                             None,
</I>&gt;<i>                                             self.contentTypes,
</I>&gt;<i>                                             self.contentEncodings,
</I>&gt;<i>                                             self.defaultType)
</I>&gt;<i>             #return self.redirect(request)
</I>
_________________________________________________________________
Add photos to your messages with MSN 8. Get 2 months FREE*. 
<A HREF="http://join.msn.com/?page=features/featuredemail">http://join.msn.com/?page=features/featuredemail</A>


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000255.html">[Twisted-web] Re: list archives?
</A></li>
	<LI>Next message: <A HREF="000257.html">[Twisted-web] Re: list archives?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#256">[ date ]</a>
              <a href="thread.html#256">[ thread ]</a>
              <a href="subject.html#256">[ subject ]</a>
              <a href="author.html#256">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
