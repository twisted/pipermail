From christopher.zorn at gmail.com  Sun May  1 09:34:37 2005
From: christopher.zorn at gmail.com (Christopher Zorn)
Date: Sun May  1 09:35:10 2005
Subject: [Twisted-web] livepage
Message-ID: <149014b905050108345e47ad2@mail.gmail.com>

Hey, I was using livepage through a proxy. I had to make a small change to get
it to work, I just want to let you guys know.

def render_liveglue(self, ctx, data):
   #return tags.script(src=url.here.child('nevow_glue.js'))
   return tags.script(src='nevow_glue.js')

url.here gave the url that was on the server behind the firewall.

From therve at free.fr  Sun May  1 10:45:13 2005
From: therve at free.fr (Thomas HERVE)
Date: Sun May  1 10:46:29 2005
Subject: [Twisted-web] livepage
In-Reply-To: <149014b905050108345e47ad2@mail.gmail.com>
References: <149014b905050108345e47ad2@mail.gmail.com>
Message-ID: <20050501184513.okqixzc2ljwg00oo@itchy.wasabout.net>

Quoting Christopher Zorn <christopher.zorn@gmail.com>:

> Hey, I was using livepage through a proxy. I had to make a small 
> change to get
> it to work, I just want to let you guys know.
>
> def render_liveglue(self, ctx, data):
>   #return tags.script(src=url.here.child('nevow_glue.js'))
>   return tags.script(src='nevow_glue.js')
>
> url.here gave the url that was on the server behind the firewall.

As I was the first to make this mistake, I'll answer : if you use Nevow 
behing a
proxy (really, it's a proxy ? what did you mean by firewall ?), you 
should look
after nevow.vhost.VHostMonsterResource.

Good luck,

-- 
Thomas


From christopher.zorn at gmail.com  Sun May  1 19:31:07 2005
From: christopher.zorn at gmail.com (Christopher Zorn)
Date: Sun May  1 19:31:40 2005
Subject: [Twisted-web] livepage
In-Reply-To: <20050501184513.okqixzc2ljwg00oo@itchy.wasabout.net>
References: <149014b905050108345e47ad2@mail.gmail.com>
	<20050501184513.okqixzc2ljwg00oo@itchy.wasabout.net>
Message-ID: <149014b90505011831630763e7@mail.gmail.com>

On 5/1/05, Thomas HERVE <therve@free.fr> wrote:
> Quoting Christopher Zorn <christopher.zorn@gmail.com>:
> 
> > Hey, I was using livepage through a proxy. I had to make a small
> > change to get
> > it to work, I just want to let you guys know.
> >
> > def render_liveglue(self, ctx, data):
> >   #return tags.script(src=url.here.child('nevow_glue.js'))
> >   return tags.script(src='nevow_glue.js')
> >
> > url.here gave the url that was on the server behind the firewall.
> 
> As I was the first to make this mistake, I'll answer : if you use Nevow
> behing a
> proxy (really, it's a proxy ? what did you mean by firewall ?), you
> should look
> after nevow.vhost.VHostMonsterResource.

Sorry, a reverse proxy. I have an apache reverse proxy to get to the server
running the nevow livepage application. How will
nevow.vhost.VHostMonsterResource
fix this? 

The problem is, when I call render_liveglue it gives a tag similar to
<script src=http://server.behind.the.firewall.tld/nevow_glue.js />

It needs to be the correct server or just nevow_glue.js in order to
work correctly.



> 
> Good luck,
> 
> --
> Thomas
> 
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>

From tv at twistedmatrix.com  Sun May  1 22:48:01 2005
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Sun May  1 22:48:29 2005
Subject: [Twisted-web] livepage
In-Reply-To: <149014b90505011831630763e7@mail.gmail.com>
References: <149014b905050108345e47ad2@mail.gmail.com>	<20050501184513.okqixzc2ljwg00oo@itchy.wasabout.net>
	<149014b90505011831630763e7@mail.gmail.com>
Message-ID: <4275B101.4040400@twistedmatrix.com>

Christopher Zorn wrote:
>>As I was the first to make this mistake, I'll answer : if you use Nevow
>>behing a
>>proxy (really, it's a proxy ? what did you mean by firewall ?), you
>>should look
>>after nevow.vhost.VHostMonsterResource.
> 
> Sorry, a reverse proxy. I have an apache reverse proxy to get to the server
> running the nevow livepage application. How will
> nevow.vhost.VHostMonsterResource
> fix this? 
> 
> The problem is, when I call render_liveglue it gives a tag similar to
> <script src=http://server.behind.the.firewall.tld/nevow_glue.js />
> 
> It needs to be the correct server or just nevow_glue.js in order to
> work correctly.

Just wanted to confirm this quickly: you must use VHostMonsterResource,
and the code change you suggested is not needed. Without
VHostMonsterResource, many other things will fail too; first you are
likely to notice are redirects.


To all nevow developers:

On the other hand, if you want to link to a resource in the current
directory, url.here is really unnecessary -- please try to use relative
URLs when they work.

From matt at pollenation.net  Mon May  2 05:13:48 2005
From: matt at pollenation.net (Matt Goodall)
Date: Mon May  2 05:13:56 2005
Subject: [Twisted-web] livepage
In-Reply-To: <4275B101.4040400@twistedmatrix.com>
References: <149014b905050108345e47ad2@mail.gmail.com>	<20050501184513.okqixzc2ljwg00oo@itchy.wasabout.net>	<149014b90505011831630763e7@mail.gmail.com>
	<4275B101.4040400@twistedmatrix.com>
Message-ID: <42760B6C.9080702@pollenation.net>

Tommi Virtanen wrote:

> Christopher Zorn wrote:
>
>>> As I was the first to make this mistake, I'll answer : if you use Nevow
>>> behing a
>>> proxy (really, it's a proxy ? what did you mean by firewall ?), you
>>> should look
>>> after nevow.vhost.VHostMonsterResource.
>>
>>
>> Sorry, a reverse proxy. I have an apache reverse proxy to get to the
>> server
>> running the nevow livepage application. How will
>> nevow.vhost.VHostMonsterResource
>> fix this?
>> The problem is, when I call render_liveglue it gives a tag similar to
>> <script src=http://server.behind.the.firewall.tld/nevow_glue.js />
>>
>> It needs to be the correct server or just nevow_glue.js in order to
>> work correctly.
>
>
> Just wanted to confirm this quickly: you must use VHostMonsterResource,
> and the code change you suggested is not needed. Without
> VHostMonsterResource, many other things will fail too; first you are
> likely to notice are redirects.
>
>
> To all nevow developers:
>
> On the other hand, if you want to link to a resource in the current
> directory, url.here is really unnecessary -- please try to use relative
> URLs when they work. 

I don't think is a good recommendation until rend.Page stops always
handling an additional empty segment regardless of the value of
addSlash. This behaviour has already been deprecated but not yet
removed. See nevow.rend.Page.child_.

Right now, there's no way the developer can know if the URL the user
used to reach the page is /foo or /foo/ and that makes it difficult to
construct a correct relative URL.

I guess it's time to remove the deprecated child_ stuff.

- Matt

-- 
     __
    /  \__     Matt Goodall, Pollenation Internet Ltd
    \__/  \    w: http://www.pollenation.net
  __/  \__/    e: matt@pollenation.net
 /  \__/  \    t: +44 (0)113 2252500
 \__/  \__/
 /  \	       Any views expressed are my own and do not necessarily
 \__/          reflect the views of my employer.


From matt at pollenation.net  Mon May  2 05:24:57 2005
From: matt at pollenation.net (Matt Goodall)
Date: Mon May  2 05:25:10 2005
Subject: Nevow URL flattening (was Re: [Twisted-web] livepage)
In-Reply-To: <42760B6C.9080702@pollenation.net>
References: <149014b905050108345e47ad2@mail.gmail.com>	<20050501184513.okqixzc2ljwg00oo@itchy.wasabout.net>	<149014b90505011831630763e7@mail.gmail.com>	<4275B101.4040400@twistedmatrix.com>
	<42760B6C.9080702@pollenation.net>
Message-ID: <42760E09.6020606@pollenation.net>

Matt Goodall wrote:

>Tommi Virtanen wrote:
>
>  
>
>>Christopher Zorn wrote:
>>
>>    
>>
>>>>As I was the first to make this mistake, I'll answer : if you use Nevow
>>>>behing a
>>>>proxy (really, it's a proxy ? what did you mean by firewall ?), you
>>>>should look
>>>>after nevow.vhost.VHostMonsterResource.
>>>>        
>>>>
>>>Sorry, a reverse proxy. I have an apache reverse proxy to get to the
>>>server
>>>running the nevow livepage application. How will
>>>nevow.vhost.VHostMonsterResource
>>>fix this?
>>>The problem is, when I call render_liveglue it gives a tag similar to
>>><script src=http://server.behind.the.firewall.tld/nevow_glue.js />
>>>
>>>It needs to be the correct server or just nevow_glue.js in order to
>>>work correctly.
>>>      
>>>
>>Just wanted to confirm this quickly: you must use VHostMonsterResource,
>>and the code change you suggested is not needed. Without
>>VHostMonsterResource, many other things will fail too; first you are
>>likely to notice are redirects.
>>
>>
>>To all nevow developers:
>>
>>On the other hand, if you want to link to a resource in the current
>>directory, url.here is really unnecessary -- please try to use relative
>>URLs when they work. 
>>    
>>
>
>I don't think is a good recommendation until rend.Page stops always
>handling an additional empty segment regardless of the value of
>addSlash. This behaviour has already been deprecated but not yet
>removed. See nevow.rend.Page.child_.
>
>Right now, there's no way the developer can know if the URL the user
>used to reach the page is /foo or /foo/ and that makes it difficult to
>construct a correct relative URL.
>
>I guess it's time to remove the deprecated child_ stuff.
>
Of course, we could just improve the URL flattener to write out relative
URLs whenever possible. That should make it a lot easier to deploy Nevow
apps behind proxies.

The only issue with doing that is that the URL instance's attributes all
need flattening before we can compare them to the current URL, and last
time I tried doing something like that I got into all sorts of
strangeness ;-).

Can anyone see a reason for *not* doing this? I might take a crack at
this sometime soon.

- Matt

-- 
     __
    /  \__     Matt Goodall, Pollenation Internet Ltd
    \__/  \    w: http://www.pollenation.net
  __/  \__/    e: matt@pollenation.net
 /  \__/  \    t: +44 (0)113 2252500
 \__/  \__/
 /  \	       Any views expressed are my own and do not necessarily
 \__/          reflect the views of my employer.


From garnaez at gmail.com  Mon May  2 23:36:45 2005
From: garnaez at gmail.com (gerardo arnaez)
Date: Mon May  2 23:37:17 2005
Subject: [Twisted-web] Context?
In-Reply-To: <42760B6C.9080702@pollenation.net>
References: <149014b905050108345e47ad2@mail.gmail.com>
	<20050501184513.okqixzc2ljwg00oo@itchy.wasabout.net>
	<149014b90505011831630763e7@mail.gmail.com>
	<4275B101.4040400@twistedmatrix.com>
	<42760B6C.9080702@pollenation.net>
Message-ID: <148eea7105050222364d832ac3@mail.gmail.com>

Hello all.

I have slowly been working my way through the nevow examples
I have start look at the base classes to understand what is going on,
but Im still stuck on what "context" is supposed to mean
in say (self, context,data)
I understand self, and understand data,
but dont understand the function or what the argument *context* is doing?

I have been going thought the examples and it is just not clear.

Any enlightening insight would be much appreciated

From paolo_veronelli at libero.it  Tue May  3 03:20:51 2005
From: paolo_veronelli at libero.it (User Paolino)
Date: Tue May  3 02:26:24 2005
Subject: [Twisted-web] Context?
In-Reply-To: <148eea7105050222364d832ac3@mail.gmail.com>
References: <149014b905050108345e47ad2@mail.gmail.com>	<20050501184513.okqixzc2ljwg00oo@itchy.wasabout.net>	<149014b90505011831630763e7@mail.gmail.com>	<4275B101.4040400@twistedmatrix.com>	<42760B6C.9080702@pollenation.net>
	<148eea7105050222364d832ac3@mail.gmail.com>
Message-ID: <42774273.6060204@libero.it>

gerardo arnaez wrote:

>Hello all.
>
>I have slowly been working my way through the nevow examples
>I have start look at the base classes to understand what is going on,
>but Im still stuck on what "context" is supposed to mean
>in say (self, context,data)
>I understand self, and understand data,
>but dont understand the function or what the argument *context* is doing?
>
>I have been going thought the examples and it is just not clear.
>
>Any enlightening insight would be much appreciated
>
>  
>
#The context in which the rendering is happening.
#Apart from very useful information you can already get from it:

from nevow.inevow import IRequest
from nevow import rend

class Rendering(rend.Fragment):
  def  render_try(self,context,data):
     argumentsOfRquest=IRequest(context).args
     .....
#you can pass your own to it

from nevow import compy
class IContent(compy.Interface):
    pass

class Another(rend.Fragment):
  def  render_try(self,context,data):
     content="this is something I want all the methods in this rendering
process to get known about"
     context.remember(content,IContent)
     ......

# all the rendering methods called after that can retrieve the 'content'
from context with IContent(context)

Probably there are more useful things context is supposed to be used for
.....


Ciao



From tv at twistedmatrix.com  Mon May  2 11:52:48 2005
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Tue May  3 04:18:13 2005
Subject: [Twisted-web] livepage
In-Reply-To: <42760B6C.9080702@pollenation.net>
References: <149014b905050108345e47ad2@mail.gmail.com>	<20050501184513.okqixzc2ljwg00oo@itchy.wasabout.net>	<149014b90505011831630763e7@mail.gmail.com>	<4275B101.4040400@twistedmatrix.com>
	<42760B6C.9080702@pollenation.net>
Message-ID: <427668F0.3080001@twistedmatrix.com>

Matt Goodall wrote:
> I don't think is a good recommendation until rend.Page stops always
> handling an additional empty segment regardless of the value of
> addSlash. This behaviour has already been deprecated but not yet
> removed. See nevow.rend.Page.child_.
> 
> Right now, there's no way the developer can know if the URL the user
> used to reach the page is /foo or /foo/ and that makes it difficult to
> construct a correct relative URL.
> 
> I guess it's time to remove the deprecated child_ stuff.

Good point -- I try to be very careful about that in my own apps,
so I didn't even realize someone might write code that really does
not even know how it is used.

From matt at pollenation.net  Tue May  3 09:21:00 2005
From: matt at pollenation.net (Matt Goodall)
Date: Tue May  3 09:20:51 2005
Subject: [Twisted-web] livepage
In-Reply-To: <427668F0.3080001@twistedmatrix.com>
References: <149014b905050108345e47ad2@mail.gmail.com>	<20050501184513.okqixzc2ljwg00oo@itchy.wasabout.net>	<149014b90505011831630763e7@mail.gmail.com>	<4275B101.4040400@twistedmatrix.com>	<42760B6C.9080702@pollenation.net>
	<427668F0.3080001@twistedmatrix.com>
Message-ID: <427796DC.2050903@pollenation.net>

Tommi Virtanen wrote:

> Matt Goodall wrote:
>
>> I don't think is a good recommendation until rend.Page stops always
>> handling an additional empty segment regardless of the value of
>> addSlash. This behaviour has already been deprecated but not yet
>> removed. See nevow.rend.Page.child_.
>>
>> Right now, there's no way the developer can know if the URL the user
>> used to reach the page is /foo or /foo/ and that makes it difficult to
>> construct a correct relative URL.
>>
>> I guess it's time to remove the deprecated child_ stuff.
>
>
> Good point -- I try to be very careful about that in my own apps,
> so I didn't even realize someone might write code that really does
> not even know how it is used. 

As those subscribed to the nevow commits list already know (sorry for
the spam ;-)), I started cleaning out much of the deprecated cruft in
Nevow last night. The above child_ behaviour is something that has now
been removed.

Right now, the changes are sitting in a branch but I'll merge to trunk
soon(ish).

Cheers, Matt

-- 
     __
    /  \__     Matt Goodall, Pollenation Internet Ltd
    \__/  \    w: http://www.pollenation.net
  __/  \__/    e: matt@pollenation.net
 /  \__/  \    t: +44 (0)113 2252500
 \__/  \__/
 /  \          Any views expressed are my own and do not necessarily
 \__/          reflect the views of my employer.


From ARyan at co.linn.or.us  Wed May  4 10:27:05 2005
From: ARyan at co.linn.or.us (Ryan, Adam)
Date: Wed May  4 10:27:42 2005
Subject: [Twisted-web] Shell commands on Windows XP
Message-ID: <8292E3D1E5E2EF4A94C36FE80D2443A83A82C4@linnms,>


I'm new to twisted, on a Windows XP box, reading through the documentaion,
and not sure how to use the shell commands.  I tried opening twistenv.bat
and running mktap but I'm missing something.  I get:

-:- -:- -:- -:- -:--:- -:- -:- -:- -:--:- -:- -:- -:- -:- Commands available
in twisted: twistd mktap manhole tapconvert ckeygen trial coi l lore
websetroot
-:- -:- -:- -:- -:--:- -:- -:- -:- -:--:- -:- -:- -:- -:-

C:\>mktap
'mktap' is not recognized as an internal or external command, operable
program or batch file.

Any help to get me started would be great.  Cheers,

Adam Ryan

From dddwd at gala.net  Wed May  4 12:04:07 2005
From: dddwd at gala.net (Dan Shidlovsky)
Date: Wed May  4 12:04:19 2005
Subject: [Twisted-web] Shell commands on Windows XP
References: <8292E3D1E5E2EF4A94C36FE80D2443A83A82C4@linnms,>
Message-ID: <008b01c550d3$ad9e6e50$3a64c152@xp>

> and running mktap but I'm missing something.  

 Seems you have passed reading the documentation. 
 http://twistedmatrix.com/projects/core/documentation/howto/plugin.html


From ARyan at co.linn.or.us  Wed May  4 12:16:40 2005
From: ARyan at co.linn.or.us (Ryan, Adam)
Date: Wed May  4 12:17:14 2005
Subject: [Twisted-web] Shell commands on Windows XP
Message-ID: <8292E3D1E5E2EF4A94C36FE80D2443A83A82C6@linnms,>

You're right...

> -----Original Message-----
> From: Dan Shidlovsky [mailto:dddwd@gala.net] 
> Sent: Wednesday, May 04, 2005 11:04 AM
> To: Discussion of twisted.web, Nevow, and Woven
> Subject: Re: [Twisted-web] Shell commands on Windows XP
> 
> 
> > and running mktap but I'm missing something.
> 
>  Seems you have passed reading the documentation. 
>  
> http://twistedmatrix.com/projects/core/documentation/howto/plugin.html
> 
> 
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com 
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
> 

From corydodt at twistedmatrix.com  Wed May  4 12:27:56 2005
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Wed May  4 12:27:14 2005
Subject: [Twisted-web] Shell commands on Windows XP
In-Reply-To: <8292E3D1E5E2EF4A94C36FE80D2443A83A82C4@linnms,>
References: <8292E3D1E5E2EF4A94C36FE80D2443A83A82C4@linnms,>
Message-ID: <4279142C.5050600@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

What version of the installer did you install?  This was fixed in the latest
windows installer release, posted to twisted-python@twistedmatrix.com.

C


Ryan, Adam wrote:
| I'm new to twisted, on a Windows XP box, reading through the documentaion,
| and not sure how to use the shell commands.  I tried opening twistenv.bat
| and running mktap but I'm missing something.  I get:
|
| -:- -:- -:- -:- -:--:- -:- -:- -:- -:--:- -:- -:- -:- -:- Commands available
| in twisted: twistd mktap manhole tapconvert ckeygen trial coi l lore
| websetroot
| -:- -:- -:- -:- -:--:- -:- -:- -:- -:--:- -:- -:- -:- -:-
|
| C:\>mktap
| 'mktap' is not recognized as an internal or external command, operable
| program or batch file.
|
| Any help to get me started would be great.  Cheers,
|
| Adam Ryan
|
| _______________________________________________
| Twisted-web mailing list
| Twisted-web@twistedmatrix.com
| http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (MingW32)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQFCeRQs3A5SrXAiHQcRAgu4AJ9w/LMLIgqTO9Aybu5U1howlK104ACeO943
O6g9a/b1M4Rkw91BVSTUv3Y=
=w1Qf
-----END PGP SIGNATURE-----

From andrea at cpushare.com  Thu May  5 16:53:38 2005
From: andrea at cpushare.com (Andrea Arcangeli)
Date: Thu May  5 16:53:09 2005
Subject: [Twisted-web] NamedAnyError
Message-ID: <20050505225338.GD3877@opteron.random>

I'm getting these errors:

2005/05/06 00:45 CEST [-] NamedAnyError: <function FunctionSerializer at 0x2aaaae6c6b18> stackless.function
2005/05/06 00:45 CEST [-] NamedAnyError: <function MethodSerializer at 0x2aaaae6c6c08> stackless.instancemethod
2005/05/06 00:45 CEST [-] NamedAnyError: <function URLSerializer at 0x2aaaae5d4500> nevow.url.URLPath

Is this only a debugging print?

From matt at pollenation.net  Thu May  5 17:20:05 2005
From: matt at pollenation.net (Matt Goodall)
Date: Thu May  5 17:20:24 2005
Subject: [Twisted-web] NamedAnyError
In-Reply-To: <20050505225338.GD3877@opteron.random>
References: <20050505225338.GD3877@opteron.random>
Message-ID: <427AAA25.2080407@pollenation.net>

Andrea Arcangeli wrote:

>I'm getting these errors:
>
>2005/05/06 00:45 CEST [-] NamedAnyError: <function FunctionSerializer at 0x2aaaae6c6b18> stackless.function
>2005/05/06 00:45 CEST [-] NamedAnyError: <function MethodSerializer at 0x2aaaae6c6c08> stackless.instancemethod
>2005/05/06 00:45 CEST [-] NamedAnyError: <function URLSerializer at 0x2aaaae5d4500> nevow.url.URLPath
>
>Is this only a debugging print?
>
Yes. Unless, for you, it's not carrying on anyway and working?

- Matt

-- 
     __
    /  \__     Matt Goodall, Pollenation Internet Ltd
    \__/  \    w: http://www.pollenation.net
  __/  \__/    e: matt@pollenation.net
 /  \__/  \    t: +44 (0)113 2252500
 \__/  \__/
 /  \	       Any views expressed are my own and do not necessarily
 \__/          reflect the views of my employer.


From dp at ulaluma.com  Thu May  5 17:31:45 2005
From: dp at ulaluma.com (Donovan Preston)
Date: Thu May  5 17:31:50 2005
Subject: [Twisted-web] NamedAnyError
In-Reply-To: <20050505225338.GD3877@opteron.random>
References: <20050505225338.GD3877@opteron.random>
Message-ID: <D102AE52-5808-4E8A-80A4-BF6EC45F26C2@ulaluma.com>


On May 5, 2005, at 3:53 PM, Andrea Arcangeli wrote:

> I'm getting these errors:
>
> 2005/05/06 00:45 CEST [-] NamedAnyError: <function  
> FunctionSerializer at 0x2aaaae6c6b18> stackless.function
> 2005/05/06 00:45 CEST [-] NamedAnyError: <function MethodSerializer  
> at 0x2aaaae6c6c08> stackless.instancemethod
> 2005/05/06 00:45 CEST [-] NamedAnyError: <function URLSerializer at  
> 0x2aaaae5d4500> nevow.url.URLPath
>
> Is this only a debugging print?

The first two are because you aren't using stackless; they can  
safely  be ignored. The last one is genuine cruft. The registration  
of an  adapter against the old name nevow.url.URLPath should be  
removed from  nevow.__init__.

Donovan


From andrea at cpushare.com  Fri May  6 11:10:29 2005
From: andrea at cpushare.com (Andrea Arcangeli)
Date: Fri May  6 11:09:48 2005
Subject: [Twisted-web] NamedAnyError
In-Reply-To: <427AAA25.2080407@pollenation.net>
References: <20050505225338.GD3877@opteron.random>
	<427AAA25.2080407@pollenation.net>
Message-ID: <20050506171029.GE10937@opteron.random>

On Fri, May 06, 2005 at 12:20:05AM +0100, Matt Goodall wrote:
> Andrea Arcangeli wrote:
> 
> >I'm getting these errors:
> >
> >2005/05/06 00:45 CEST [-] NamedAnyError: <function FunctionSerializer at 0x2aaaae6c6b18> stackless.function
> >2005/05/06 00:45 CEST [-] NamedAnyError: <function MethodSerializer at 0x2aaaae6c6c08> stackless.instancemethod
> >2005/05/06 00:45 CEST [-] NamedAnyError: <function URLSerializer at 0x2aaaae5d4500> nevow.url.URLPath
> >
> >Is this only a debugging print?
> >
> Yes. Unless, for you, it's not carrying on anyway and working?

It works fine but I'm receiving some debugging email during startup
since this spawns some warnings even despite I keep "python -W ingore"
in production ;). So I'd like if it was at least turned off when python
-W ingore is selected.

From andrea at cpushare.com  Fri May  6 11:13:14 2005
From: andrea at cpushare.com (Andrea Arcangeli)
Date: Fri May  6 11:12:31 2005
Subject: [Twisted-web] NamedAnyError
In-Reply-To: <D102AE52-5808-4E8A-80A4-BF6EC45F26C2@ulaluma.com>
References: <20050505225338.GD3877@opteron.random>
	<D102AE52-5808-4E8A-80A4-BF6EC45F26C2@ulaluma.com>
Message-ID: <20050506171314.GF10937@opteron.random>

On Thu, May 05, 2005 at 04:31:45PM -0700, Donovan Preston wrote:
> The first two are because you aren't using stackless; they can  

Should I be using stackless then? I never understood what this stackless
thing is all about, I thought it was just a change for some embedded
thing with some weird memory requirements like palmos (now obsolete with
linux cellphones ;).

> safely  be ignored. The last one is genuine cruft. The registration  
> of an  adapter against the old name nevow.url.URLPath should be  
> removed from  nevow.__init__.

Ok.

I'd suggest to keep those disabled when "python -W ignore" is selected.

Thanks a lot!

From dialtone at divmod.com  Fri May  6 13:00:47 2005
From: dialtone at divmod.com (Valentino Volonghi aka Dialtone)
Date: Fri May  6 13:01:06 2005
Subject: [Twisted-web] NamedAnyError
In-Reply-To: <20050506171314.GF10937@opteron.random>
References: <20050505225338.GD3877@opteron.random>	<D102AE52-5808-4E8A-80A4-BF6EC45F26C2@ulaluma.com>
	<20050506171314.GF10937@opteron.random>
Message-ID: <427BBEDF.2040702@divmod.com>

Andrea Arcangeli wrote:

>Should I be using stackless then? I never understood what this stackless
>thing is all about, I thought it was just a change for some embedded
>thing with some weird memory requirements like palmos (now obsolete with
>linux cellphones ;).
>  
>
Stackless is a patched version of CPython that has support for
microthreads, done with tasklets and greenlets.
you can simulate continuations for example.

In Nevow stackless or greenlets (available as a different package) could
be used with wolf (in phunt sandbox) to have a
kind of seaside2 clone.

usually stackless is used in games where there are tons of threads that
it can handle without much hassles. :)

-- 
Valentino Volonghi aka Dialtone
Now Running MacOSX 10.3.8
Blog: http://vvolonghi.blogspot.com
http://weever.berlios.de


From andrea at cpushare.com  Fri May  6 21:58:00 2005
From: andrea at cpushare.com (Andrea Arcangeli)
Date: Fri May  6 21:58:07 2005
Subject: [Twisted-web] NamedAnyError
In-Reply-To: <427BBEDF.2040702@divmod.com>
References: <20050505225338.GD3877@opteron.random>
	<D102AE52-5808-4E8A-80A4-BF6EC45F26C2@ulaluma.com>
	<20050506171314.GF10937@opteron.random>
	<427BBEDF.2040702@divmod.com>
Message-ID: <20050507035800.GA4926@g5.random>

On Fri, May 06, 2005 at 09:00:47PM +0200, Valentino Volonghi wrote:
> Stackless is a patched version of CPython that has support for
> microthreads, done with tasklets and greenlets.
> you can simulate continuations for example.

Ok, since this is not the official python, I wonder why it warns then,
what I advantage would I get if I would patch python with stackless when
using it with twisted/nevow?

> usually stackless is used in games where there are tons of threads that
> it can handle without much hassles. :)

But still it won't scale at all in HT/multicore/smp ;). What about the
syscalls, will they block hanging the whole thing like it would happen
with twisted?

BTW, this is my whole patch against SVN, it also switch off the warning
in production with -W ingore, plus it adds caching and it removes the
annoying __start_* that breaks wget. Feel free to pick whatever you find
good enough for merging into SVN. thanks!

Index: Nevow/nevow/flat/ten.py
===================================================================
--- Nevow/nevow/flat/ten.py	(revision 1502)
+++ Nevow/nevow/flat/ten.py	(working copy)
@@ -37,7 +37,7 @@
             flattener = util._namedAnyWithBuiltinTranslation(flattener)
             forType = util._namedAnyWithBuiltinTranslation(forType)
         except util._NamedAnyError:
-            print "NamedAnyError:", flattener, forType
+            warnings.warn('NamedAnyError: %r %r' % (flattener, forType))
 
     if not isinstance(forType, interface.InterfaceClass):
         # fix up __implements__ if it's old style
Index: Nevow/nevow/compy.py
===================================================================
--- Nevow/nevow/compy.py	(revision 1502)
+++ Nevow/nevow/compy.py	(working copy)
@@ -32,7 +32,7 @@
             origInterface = _namedAnyWithBuiltinTranslation(origInterface)
             interfaceClasses = [_namedAnyWithBuiltinTranslation(x) for x in interfaceClasses]
         except _NamedAnyError, nae:
-            print 'NamedAnyError:', nae
+            warnings.warn('NamedAnyError: %r' % nae)
             return
         # print "_registerAdapter:",adapterFactory, origInterface, interfaceClasses
     if 'nevow.inevow.ISerializable' in interfaceClasses or filter(
Index: Nevow/nevow/rend.py
===================================================================
--- Nevow/nevow/rend.py	(revision 1502)
+++ Nevow/nevow/rend.py	(working copy)
@@ -31,6 +31,7 @@
 from nevow import flat
 from nevow.util import log
 from nevow import util
+from nevow import url
 
 import formless
 from formless import iformless
@@ -402,6 +403,8 @@
         self.children[name] = child
     
 
+_CACHE = {}
+
 class Page(Fragment, ConfigurableFactory, ChildLookupMixin):
     """A page is the main Nevow resource and renders a document loaded
     via the document factory (docFactory).
@@ -415,8 +418,37 @@
     afterRender = None
     addSlash = None
 
+    cache = False
+    lifetime = -1
+    __lastCacheRendering = 0
+
     flattenFactory = lambda self, *args: flat.flattenFactory(*args)
 
+    def hasCache(self, ctx):
+        if not self.cache:
+            return
+
+        _now = now() # run gettimeofday only once
+        timeout = _now > self.__lastCacheRendering + self.lifetime and \
+                  self.lifetime >= 0
+        c = self.lookupCache(ctx)
+        if timeout or c is None:
+            # stop other renders
+            self.__lastCacheRendering = _now
+            c = None
+        return c
+    def cacheRendered(self, ctx, c):
+        if not self.cache:
+            return
+        # overwrite the deferred with the data
+        self.storeCache(ctx, c)
+    def cacheIDX(self, ctx):
+        return str(url.URL.fromContext(ctx))
+    def storeCache(self, ctx, c):
+        _CACHE[self.cacheIDX(ctx)] = c
+    def lookupCache(self, ctx):
+        return _CACHE.get(self.cacheIDX(ctx))
+
     def renderHTTP(self, ctx):
         if self.beforeRender is not None:
             return util.maybeDeferred(self.beforeRender,ctx).addCallback(
@@ -441,11 +473,18 @@
             if self.afterRender is not None:
                 return util.maybeDeferred(self.afterRender,ctx)
 
-        if self.buffered:
+        c = self.hasCache(ctx)
+        if c is not None:
+            finishRequest()
+            return c
+
+        if self.buffered or self.cache:
             io = StringIO()
             writer = io.write
             def finisher(result):
-                request.write(io.getvalue())
+                c = io.getvalue()
+                self.cacheRendered(ctx, c)
+                request.write(c)
                 return util.maybeDeferred(finishRequest).addCallback(lambda r: result)
         else:
             writer = request.write
@@ -529,7 +568,6 @@
             else:
                 ## Use the redirectAfterPost url
                 ref = str(redirectAfterPost)
-            from nevow import url
             refpath = url.URL.fromString(ref)
             magicCookie = '%s%s%s' % (now(),request.getClientIP(),random.random())
             refpath = refpath.replace('_nevow_carryover_', magicCookie)
Index: Nevow/nevow/guard.py
===================================================================
--- Nevow/nevow/guard.py	(revision 1502)
+++ Nevow/nevow/guard.py	(working copy)
@@ -263,7 +263,8 @@
         if path.startswith(SESSION_KEY):
             key = path[len(SESSION_KEY):]
             if key not in self.sessions:
-                return urlToChild(request, *segments[1:], **{'__start_session__':1}), ()
+                #return urlToChild(request, *segments[1:], **{'__start_session__':1}), ()
+                return urlToChild(request, *segments[1:]), ()
             self.sessions[key].setLifetime(self.sessionLifetime)
             if cookie == key:
                 # /sessionized-url/${SESSION_KEY}aef9c34aecc3d9148/foo
@@ -271,7 +272,8 @@
                 #                  we are this getChild
                 # with a matching cookie
                 self.sessions[key].sessionJustStarted = True
-                return urlToChild(request, *segments[1:], **{'__session_just_started__':1}), ()
+                #return urlToChild(request, *segments[1:], **{'__session_just_started__':1}), ()
+                return urlToChild(request, *segments[1:]), ()
             else:
                 # We attempted to negotiate the session but failed (the user
                 # probably has cookies disabled): now we're going to return the

From mordaha at gmail.com  Sun May  8 02:18:56 2005
From: mordaha at gmail.com (Little)
Date: Sun May  8 02:19:29 2005
Subject: [Twisted-web] nested nevow:data
Message-ID: <899dbb705050801183871931b@mail.gmail.com>

How can i use nested nevow:data construction?

<div n:data="items">
  ...
  <div n:data="subitems">

  </div>
</div>

this construction won't working at all...

For example, first data is array of years ('1997', '1998', e.t.c)
and second data is "select * from .. where year=%s"

And i whant a page with many tables - one table, one year

So i desided to make nested n:data tags:

<div n:data="years" n:render="years">
 <div n:pattern="year">
   <table>
   <div n:data="year" n:render="year" >
       <div n:pattern="item">
          tr td td td
       </div>
  </div>
 </div>

But it doesn't work

Any solution?

From carl at clingfire.net  Sun May  8 16:31:45 2005
From: carl at clingfire.net (Carl Shimer)
Date: Sun May  8 16:31:56 2005
Subject: [Twisted-web] appropriate way to use patternGenerator
Message-ID: <E1DUuJX-0007r8-00@pyramid.twistedmatrix.com>


Hi,

I spent the last couple of hours trying to get the nevow LivePage stuff to
work.  The problem was on this line of my code:

Inevow.IQ(self.docFactory).patternGenerator('foo')

After a big of debugging (well, a lot of debugging) I figured out that the
problem was that my stan tree (self.docFactory) wasn't fully complete,
rather due to my setup it contained functions that weren't evaluated yet.
patternGenerator() would fail because foo wasn't defined yet - it would be
defined later (perhaps after the page was rendered?)

Anway, my work around was to do this:

Inevow.IQ(self.tagfragments()).patternGenerator('foo') where tagfragments()
returns a partial stan tree.

Questions:

1) my solution seems like a hack :)  is there a way I can run
patternGenerator on the fully evaluated tree?
2) The way I am doing code reuse is via inheritance.  The parent object
(derived from rend.Page) has all the code for common elements like the page
header, doctype, and the docFactory.  The docFactory embeds a number of
entry points which may later overridden by a derived class.  So the child
page always overrides the content() function to render the main body of the
page.  Is the appropriate mechanism?  I read somewhere about the Fragment
class but didn't quite understand it.

Thanks,
Carl


From foom at fuhm.net  Mon May  9 08:23:32 2005
From: foom at fuhm.net (James Y Knight)
Date: Mon May  9 08:23:49 2005
Subject: [Twisted-web] nested nevow:data
In-Reply-To: <899dbb705050801183871931b@mail.gmail.com>
References: <899dbb705050801183871931b@mail.gmail.com>
Message-ID: <766B26CF-14BB-4290-A0DE-AC2BE4FE757D@fuhm.net>

On May 8, 2005, at 4:18 AM, Little wrote:
> How can i use nested nevow:data construction?
>

The next data is always looked up in the current data. At the top  
level, the current data is the page you're rendering, with its data_  
methods. As you saw, when you nest one inside another, the current  
data when looking up the inner data is the outer data, rather than  
the page.

A workaround is to use a renderer instead of a data directive. I  
believe something like this should work:

def render_getyeardata(self, ctx, data):
   d = runQuery("select * from ... where year="%s")

   def rememberIt(result):
     ctx.remember(result, inevow.IData)
     return ctx.tag
   d.addCallback(rememberIt)
   return d

Then in your page,
<div n:data="years" n:render="years">
  <div n:pattern="year">
    <table>
    <n:invisible render="getyeardata"><div n:render="year">
etc.

The real solution is to patch nevow to allow for some sort of data  
navigation, like data="/year", where the leading slash means "from  
the page". Someone was working on that, but I don't know where it  
went. It'd be good to have that capability built-in.

James

From foom at fuhm.net  Mon May  9 08:36:24 2005
From: foom at fuhm.net (James Y Knight)
Date: Mon May  9 08:36:40 2005
Subject: [Twisted-web] appropriate way to use patternGenerator
In-Reply-To: <E1DUuJX-0007r8-00@pyramid.twistedmatrix.com>
References: <E1DUuJX-0007r8-00@pyramid.twistedmatrix.com>
Message-ID: <70850FA6-3743-4874-923A-7A721AEFDA15@fuhm.net>


On May 8, 2005, at 6:31 PM, Carl Shimer wrote:
> I spent the last couple of hours trying to get the nevow LivePage  
> stuff to
> work.  The problem was on this line of my code:
>
> Inevow.IQ(self.docFactory).patternGenerator('foo')
>

It sounds like you're doing things the hard way, but I don't quite  
understand your description of what you want to do -- it's a bit too  
abstract for me. Patterns are designed for use by the immediately  
enclosing renderer, so they operate on the unrendered tree, not the  
rendered tree.

This is how most pattern uses look. A renderer which uses them,  
immediately enclosing the patterns themselves.
def render_boolean(self, ctx, data):
   return IQ(ctx).allPatterns(data and 'true' or 'false')

<div n:data="foo" n:render="boolean">
<span n:pattern="true">True!</span>
<span n:pattern="false">False!</span>
</div>

Perhaps your use case would be better served by filling slots?

James

From carl at clingfire.net  Mon May  9 09:43:08 2005
From: carl at clingfire.net (Carl Shimer)
Date: Mon May  9 09:43:05 2005
Subject: [Twisted-web] appropriate way to use patternGenerator
In-Reply-To: <70850FA6-3743-4874-923A-7A721AEFDA15@fuhm.net>
Message-ID: <E1DVAPP-0006Yn-00@pyramid.twistedmatrix.com>

 

Ok... I think I understand this issue a bit better.  I am deriving most of
my work in this area from the chatola example.  In chatola the pattern is
created at object initialization time (which won't work in my scenario).

 

The pattern needs to be used in the server side handler that is invoked by
the client javascript.  Excerpt from my class:

 

def on_submit(self,client,inputname,inputtags):

      # THIS IS THE HACK RIGHT here

      self.locelpattern
=inevow.IQ(self._maincontentimpl(None,None)).patternGenerator('loc_el')

      # slot filling time

 
client.append('placecontent',self.locelpattern.fillSlots('foobar',inputname)
.fillSlots('foobaz',inputtags))

      #client.sendScript("focusInput();")

 

def render_input(self,ctx,data):

      return ctx.tag(onsubmit=livepage.handler(self.on_submit,
getValue('inputname'),getValue('inputtags')))

 

 

My solution (based on your comments):

 

1)    put a method in the stan tree prior to the set of tags that I want to
generate a pattern for

2)    store the pattern on the object for later use by on_submit.

 

def render_pattern(self,ctx,data):

            self.locelpattern = inevow.IQ(ctx).patternGenerator('loc_el')

            return ''

 

excepts from the stan tree:

 

T.div(_id='content')[

      self.render_pattern,

      T.div(pattern='loc_el',_pattern='loc_el')[

      T.div(_class='row')[

      T.span[T.slot(name='foobar')],T.span[T.slot(name='foobaz')]

      ]

 

 

-----Original Message-----
From: twisted-web-bounces@twistedmatrix.com
[mailto:twisted-web-bounces@twistedmatrix.com] On Behalf Of James Y Knight
Sent: Monday, May 09, 2005 9:36 AM
To: Discussion of twisted.web, Nevow,and Woven
Subject: Re: [Twisted-web] appropriate way to use patternGenerator

 

 

On May 8, 2005, at 6:31 PM, Carl Shimer wrote:

> I spent the last couple of hours trying to get the nevow LivePage  

> stuff to

> work.  The problem was on this line of my code:

> 

> Inevow.IQ(self.docFactory).patternGenerator('foo')

> 

 

It sounds like you're doing things the hard way, but I don't quite  

understand your description of what you want to do -- it's a bit too  

abstract for me. Patterns are designed for use by the immediately  

enclosing renderer, so they operate on the unrendered tree, not the  

rendered tree.

 

This is how most pattern uses look. A renderer which uses them,  

immediately enclosing the patterns themselves.

def render_boolean(self, ctx, data):

   return IQ(ctx).allPatterns(data and 'true' or 'false')

 

<div n:data="foo" n:render="boolean">

<span n:pattern="true">True!</span>

<span n:pattern="false">False!</span>

</div>

 

Perhaps your use case would be better served by filling slots?

 

James

 

_______________________________________________

Twisted-web mailing list

Twisted-web@twistedmatrix.com

http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-web/attachments/20050509/c7a51d50/attachment.htm
From pf_moore at yahoo.co.uk  Mon May  9 15:08:22 2005
From: pf_moore at yahoo.co.uk (Paul Moore)
Date: Mon May  9 15:10:58 2005
Subject: [Twisted-web] Re: NamedAnyError
References: <20050505225338.GD3877@opteron.random>
	<D102AE52-5808-4E8A-80A4-BF6EC45F26C2@ulaluma.com>
Message-ID: <uy8ao85vd.fsf@yahoo.co.uk>

Donovan Preston <dp@ulaluma.com> writes:

> On May 5, 2005, at 3:53 PM, Andrea Arcangeli wrote:
>
>> I'm getting these errors:
>>
>> 2005/05/06 00:45 CEST [-] NamedAnyError: <function
>> FunctionSerializer at 0x2aaaae6c6b18> stackless.function
>> 2005/05/06 00:45 CEST [-] NamedAnyError: <function MethodSerializer
>> at 0x2aaaae6c6c08> stackless.instancemethod
>> 2005/05/06 00:45 CEST [-] NamedAnyError: <function URLSerializer at
>> 0x2aaaae5d4500> nevow.url.URLPath
>>
>> Is this only a debugging print?
>
> The first two are because you aren't using stackless; they can  
> safely  be ignored.

Given that stackless is non-standard, can these warnings be
suppressed unless stackless is present? (When they presumably won't
be generated anyway!)

To put it another way - what are these warnings telling me? That I
must install stackless? Why? What isn't working?

As you can tell, I didlike applications producing spurious warnings :-)

Paul.
-- 
Any sufficiently complicated C or Fortran program contains an ad hoc
informally-specified bug-ridden slow implementation of half of Common
Lisp. -- Philip Greenspun


From pf_moore at yahoo.co.uk  Tue May 10 06:04:07 2005
From: pf_moore at yahoo.co.uk (Paul Moore)
Date: Tue May 10 06:13:16 2005
Subject: [Twisted-web] Re: NamedAnyError
References: <20050505225338.GD3877@opteron.random>
	<D102AE52-5808-4E8A-80A4-BF6EC45F26C2@ulaluma.com>
	<uy8ao85vd.fsf@yahoo.co.uk>
Message-ID: <loom.20050510T135407-594@post.gmane.org>

Paul Moore <pf_moore@...> writes:

> Given that stackless is non-standard, can these warnings be
> suppressed unless stackless is present? (When they presumably won't
> be generated anyway!)

I think the attached patch does the right thing (if it didn't get mangled by 
the web interface I'm using :-() Obviously (!) I can't test it with stackless, 
as I don't have that...

Oh, and by the way - nevow.url.URLPath doesn't exist (also referenced in the 
list of flatteners in __init__.py). I don't know what replaces it' so I can't 
include that in my patch.

Hope this helps (at least it's better than just whingeing :-))
Paul.

--- nevow\__init__.py.orig	2005-04-28 20:55:12.000000000 +0100
+++ nevow\__init__.py	2005-05-10 12:59:59.926640800 +0100
@@ -165,10 +165,8 @@
 nevow.flat.flatstan.ListSerializer                __builtin__.tuple
 nevow.flat.flatstan.ListSerializer                __builtin__.generator
 nevow.flat.flatstan.FunctionSerializer            __builtin__.function
-nevow.flat.flatstan.FunctionSerializer            stackless.function
 nevow.flat.flatstan.FunctionSerializer            __builtin__.type
 nevow.flat.flatstan.MethodSerializer              __builtin__.instancemethod
-nevow.flat.flatstan.MethodSerializer              stackless.instancemethod
 nevow.flat.flatstan.RendererSerializer            nevow.inevow.IRenderer
 nevow.flat.flatstan.DirectiveSerializer           nevow.stan.directive
 nevow.flat.flatstan.SlotSerializer                nevow.stan.slot
@@ -201,6 +199,16 @@
 nevow.i18n.flattenL10n              nevow.i18n.PlaceHolder
 """
 
+flatteners_stackless = """
+nevow.flat.flatstan.FunctionSerializer            stackless.function
+nevow.flat.flatstan.MethodSerializer              stackless.instancemethod
+"""
+try:
+    import stackless
+    flatteners += flatteners_stackless
+except ImportError:
+    pass
+
 flatteners_2_4 = """
 nevow.flat.flatstan.StringCastSerializer          decimal.Decimal
 """



From pf_moore at yahoo.co.uk  Tue May 10 06:24:32 2005
From: pf_moore at yahoo.co.uk (Paul Moore)
Date: Tue May 10 06:33:12 2005
Subject: [Twisted-web] Re: NamedAnyError
References: <20050505225338.GD3877@opteron.random>
	<D102AE52-5808-4E8A-80A4-BF6EC45F26C2@ulaluma.com>
	<uy8ao85vd.fsf@yahoo.co.uk>
	<loom.20050510T135407-594@post.gmane.org>
Message-ID: <loom.20050510T141735-74@post.gmane.org>

Paul Moore <pf_moore <at> yahoo.co.uk> writes:
> Oh, and by the way - nevow.url.URLPath doesn't exist (also referenced in the 
> list of flatteners in __init__.py). I don't know what replaces it' so I can't 
> include that in my patch.

While I'm staring at __init__.py, I notice that basic_adapters, flatteners and 
__all__ reference liveevil, which is deprecated. Should these references just 
be removed, or should they be replaced by the livepage equivalents (as the 
warning which is generated suggests)?

Paul.


From matt at pollenation.net  Tue May 10 07:01:42 2005
From: matt at pollenation.net (Matt Goodall)
Date: Tue May 10 07:01:36 2005
Subject: [Twisted-web] Re: NamedAnyError
In-Reply-To: <loom.20050510T135407-594@post.gmane.org>
References: <20050505225338.GD3877@opteron.random>	<D102AE52-5808-4E8A-80A4-BF6EC45F26C2@ulaluma.com>	<uy8ao85vd.fsf@yahoo.co.uk>
	<loom.20050510T135407-594@post.gmane.org>
Message-ID: <4280B0B6.5000704@pollenation.net>

Paul Moore wrote:

>Paul Moore <pf_moore@...> writes:
>
>  
>
>>Given that stackless is non-standard, can these warnings be
>>suppressed unless stackless is present? (When they presumably won't
>>be generated anyway!)
>>    
>>
>
>I think the attached patch does the right thing (if it didn't get mangled by 
>the web interface I'm using :-() Obviously (!) I can't test it with stackless, 
>as I don't have that...
>  
>
Hi Paul,

Firstly, thanks for the stackless patch. I have a "cleanup" Nevow branch
where I have started removing the deprecated bits; I'll commit this
patch on that branch. I'm also using the branch to remove redundant
imports and, in a few places, adding required imports :-/.

The URL for the branch is svn://divmod.org/svn/Nevow/branches/cleanup.

I think there's probably another evening of work before I can merge the
branch to trunk but any feedback/patches would be much appreciated.

If you have any other patches or comments could you add them to the
Nevow tracker (http://divmod.org/users/roundup.twistd/nevow/) with
"[cleanup]" in the Title so I can review and commit them. Thanks a lot.

>Oh, and by the way - nevow.url.URLPath doesn't exist (also referenced in the 
>list of flatteners in __init__.py). I don't know what replaces it' so I can't 
>include that in my patch.
>  
>
URLPath has already been removed on the branch I mention above.

Cheers, Matt

-- 
     __
    /  \__     Matt Goodall, Pollenation Internet Ltd
    \__/  \    w: http://www.pollenation.net
  __/  \__/    e: matt@pollenation.net
 /  \__/  \    t: +44 (0)113 2252500
 \__/  \__/
 /  \          Any views expressed are my own and do not necessarily
 \__/          reflect the views of my employer.


From pf_moore at yahoo.co.uk  Tue May 10 14:20:28 2005
From: pf_moore at yahoo.co.uk (Paul Moore)
Date: Tue May 10 14:21:38 2005
Subject: [Twisted-web] Re: NamedAnyError
References: <20050505225338.GD3877@opteron.random>
	<D102AE52-5808-4E8A-80A4-BF6EC45F26C2@ulaluma.com>
	<uy8ao85vd.fsf@yahoo.co.uk> <loom.20050510T135407-594@post.gmane.org>
	<4280B0B6.5000704@pollenation.net>
Message-ID: <ud5ryvnn7.fsf@yahoo.co.uk>

Matt Goodall <matt@pollenation.net> writes:

> Firstly, thanks for the stackless patch. I have a "cleanup" Nevow branch
> where I have started removing the deprecated bits; I'll commit this
> patch on that branch. I'm also using the branch to remove redundant
> imports and, in a few places, adding required imports :-/.
>
> The URL for the branch is svn://divmod.org/svn/Nevow/branches/cleanup.

Cool. Thanks for the pointer, I'll certainly have a look.

> I think there's probably another evening of work before I can merge the
> branch to trunk but any feedback/patches would be much appreciated.

I'll see what I can do.

> If you have any other patches or comments could you add them to the
> Nevow tracker (http://divmod.org/users/roundup.twistd/nevow/) with
> "[cleanup]" in the Title so I can review and commit them. Thanks a lot.

No problem. I wasn't aware of the tracker (well, I have a vague
recollection of seeing a mention of it). One of the difficulties I
find with Nevow is finding the resources - nevow.org and divmod.org
don't have many pointers to anywhere else. I can never recall where
the wiki is - luckily it's easy to find via Google.

Paul.
-- 
Ooh, how Gothic. Barring the milk.


From dreid at dreid.org  Tue May 10 14:41:21 2005
From: dreid at dreid.org (David Reid)
Date: Tue May 10 14:38:28 2005
Subject: [Twisted-web] Re: NamedAnyError
In-Reply-To: <ud5ryvnn7.fsf@yahoo.co.uk>
References: <20050505225338.GD3877@opteron.random>	<D102AE52-5808-4E8A-80A4-BF6EC45F26C2@ulaluma.com>	<uy8ao85vd.fsf@yahoo.co.uk>
	<loom.20050510T135407-594@post.gmane.org>	<4280B0B6.5000704@pollenation.net>
	<ud5ryvnn7.fsf@yahoo.co.uk>
Message-ID: <42811C71.5090904@dreid.org>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Paul Moore wrote:

> No problem. I wasn't aware of the tracker (well, I have a vague
> recollection of seeing a mention of it). One of the difficulties I
> find with Nevow is finding the resources - nevow.org and divmod.org
> don't have many pointers to anywhere else. I can never recall where
> the wiki is - luckily it's easy to find via Google.

Yes that's a big problem, and probably the reason the wiki is kind of
stale.  We should badger Donovan to fix it.  Or let someone else
volunteer to fix it.

- -David
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.5 (GNU/Linux)

iD8DBQFCgRxxrsrO6aeULcgRAlwnAJ9c7o5OzGShQIdfZMVftyeiyxMhLQCfT5lJ
PWz9f+JRxInKO1Juqpwg3x8=
=9mpO
-----END PGP SIGNATURE-----

From pf_moore at yahoo.co.uk  Tue May 10 15:37:30 2005
From: pf_moore at yahoo.co.uk (Paul Moore)
Date: Tue May 10 15:39:25 2005
Subject: [Twisted-web] _nevow_carryover_
Message-ID: <uvf5q3gpx.fsf@yahoo.co.uk>

Can someone tell me what the _nevow_carryover_ argument that gets
added to URLs as part of form processing is for? Is there any way of
suppressing it (and presumably handling the functionality in an
alternative way)? It looks session-related, but if I delete it and
re-enter the base URL, there seems to be no difference.

I've looked at the source code, but it baffles me :-(

Is it another of these redirect loop hacks, like __start_session__?

Paul.
-- 
There is a theory which states that if ever anybody discovers exactly
what the Universe is for and why it is here, it will instantly
disappear and be replaced by something even more bizarre and
inexplicable. There is another theory which states that this has
already happened. -- Douglas Adams


From dp at ulaluma.com  Tue May 10 17:10:25 2005
From: dp at ulaluma.com (Donovan Preston)
Date: Tue May 10 17:10:29 2005
Subject: [Twisted-web] _nevow_carryover_
In-Reply-To: <uvf5q3gpx.fsf@yahoo.co.uk>
References: <uvf5q3gpx.fsf@yahoo.co.uk>
Message-ID: <10CFBDD1-87CB-4DA7-8C17-FDA792FF710B@ulaluma.com>


On May 10, 2005, at 2:37 PM, Paul Moore wrote:


> Can someone tell me what the _nevow_carryover_ argument that gets
> added to URLs as part of form processing is for? Is there any way of
> suppressing it (and presumably handling the functionality in an
> alternative way)? It looks session-related, but if I delete it and
> re-enter the base URL, there seems to be no difference.
>
> I've looked at the source code, but it baffles me :-(
>
> Is it another of these redirect loop hacks, like __start_session__?
>

This is used to implement the formless "IHand" when no guard session  
or cookie-based session is present (and it is always used regardless  
of whether they are present).

I know this annoys people. It annoys me that it annoys people :-) But  
I would like to fix it once and for all.

The IHand is the return result of an autocallable. It is stored in a  
global dictionary, keyed by the _nevow_carryover_ value, and after  
the POST to GET redirect occurs (with the _nevow_carryover_ parameter  
added), the value is retrieved out of the dictionary and stored as  
IHand on the context.

Solutions to removing this annoyance:

1) If the autocallable returns None, or returns a Deferred which  
fires with None, do not add _nevow_carryover_ and do not set IHand.  
This will cover a large number of the man-_nevow_carryover_-is- 
annoying cases.

If someone is using formless to expose methods as autocallable, and  
merely does database munging in the autocallable, and does not ever  
return a result, then they will never see _nevow_carryover_.

2) If the user actually is returning values from the autocallable,  
and is actually looking for the result in the IHand of the next  
request: Check to see if there is a guard session. If so, store the  
hand there for the duration of the redirect.

This will solve cases where people actually are using the IHand  
(probably rare) AND are using guard sessions (Probably 100% of the  
rare cases)

3) Finally, if people ARE returning results from autocallables, AND  
ARE NOT using guard AND are still annoyed with _nevow_carryover_, I  
have an idea which involves putting the mini-session key in the <form  
action=""> instead of the redirect. Since users only see the action  
url during the time it takes their browser to redirect, and the  
redirected request can pull the mini-session key out of the referrer,  
this would work.

dp



From dp at ulaluma.com  Tue May 10 17:18:54 2005
From: dp at ulaluma.com (Donovan Preston)
Date: Tue May 10 17:19:04 2005
Subject: [Twisted-web] Re: NamedAnyError
In-Reply-To: <42811C71.5090904@dreid.org>
References: <20050505225338.GD3877@opteron.random>	<D102AE52-5808-4E8A-80A4-BF6EC45F26C2@ulaluma.com>	<uy8ao85vd.fsf@yahoo.co.uk>
	<loom.20050510T135407-594@post.gmane.org>	<4280B0B6.5000704@pollenation.net>
	<ud5ryvnn7.fsf@yahoo.co.uk> <42811C71.5090904@dreid.org>
Message-ID: <919E582E-3D79-4B26-8A38-52DB521760CB@ulaluma.com>


On May 10, 2005, at 1:41 PM, David Reid wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Paul Moore wrote:
>
>
>> No problem. I wasn't aware of the tracker (well, I have a vague
>> recollection of seeing a mention of it). One of the difficulties I
>> find with Nevow is finding the resources - nevow.org and divmod.org
>> don't have many pointers to anywhere else. I can never recall where
>> the wiki is - luckily it's easy to find via Google.
>>
>
> Yes that's a big problem, and probably the reason the wiki is kind of
> stale.  We should badger Donovan to fix it.  Or let someone else
> volunteer to fix it.

Yes, badger me to fix it :-)

dp


From tv at twistedmatrix.com  Thu May 12 05:51:54 2005
From: tv at twistedmatrix.com (Tommi Virtanen)
Date: Thu May 12 05:53:28 2005
Subject: [Twisted-web] _nevow_carryover_
In-Reply-To: <10CFBDD1-87CB-4DA7-8C17-FDA792FF710B@ulaluma.com>
References: <uvf5q3gpx.fsf@yahoo.co.uk>
	<10CFBDD1-87CB-4DA7-8C17-FDA792FF710B@ulaluma.com>
Message-ID: <4283435A.7060009@twistedmatrix.com>

Donovan Preston wrote:
>> Can someone tell me what the _nevow_carryover_ argument that gets
>> added to URLs as part of form processing is for? Is there any way of
> This is used to implement the formless "IHand" when no guard session  or
> cookie-based session is present (and it is always used regardless  of
> whether they are present).

Actually, that's not true. Carryover is used even when we have a
session.

> 2) If the user actually is returning values from the autocallable,  and
> is actually looking for the result in the IHand of the next  request:
> Check to see if there is a guard session. If so, store the  hand there
> for the duration of the redirect.

That won't really work -- I've had multiple browser windows open
belonging to the same session many times, having just one IHand per
session just isn't going to work.

> 3) Finally, if people ARE returning results from autocallables, AND  ARE
> NOT using guard AND are still annoyed with _nevow_carryover_, I  have an
> idea which involves putting the mini-session key in the <form 
> action=""> instead of the redirect. Since users only see the action  url
> during the time it takes their browser to redirect, and the  redirected
> request can pull the mini-session key out of the referrer,  this would
> work.

..you assume referrers work reliably :(

From dp at ulaluma.com  Thu May 12 12:21:04 2005
From: dp at ulaluma.com (Donovan Preston)
Date: Thu May 12 12:21:11 2005
Subject: [Twisted-web] _nevow_carryover_
In-Reply-To: <4283435A.7060009@twistedmatrix.com>
References: <uvf5q3gpx.fsf@yahoo.co.uk>
	<10CFBDD1-87CB-4DA7-8C17-FDA792FF710B@ulaluma.com>
	<4283435A.7060009@twistedmatrix.com>
Message-ID: <E08ACC77-9439-4438-ADF1-7FB5EC37227C@ulaluma.com>


On May 12, 2005, at 4:51 AM, Tommi Virtanen wrote:


> Donovan Preston wrote:
>
>> This is used to implement the formless "IHand" when no guard  
>> session  or
>> cookie-based session is present (and it is always used regardless  of
>> whether they are present).
>>
>
> Actually, that's not true. Carryover is used even when we have a
> session.
>

I know. I was just stating a case where appending garbage to some URL  
is impossible to avoid.


>> 2) If the user actually is returning values from the  
>> autocallable,  and
>> is actually looking for the result in the IHand of the next  request:
>> Check to see if there is a guard session. If so, store the  hand  
>> there
>> for the duration of the redirect.
>>


> That won't really work -- I've had multiple browser windows open
> belonging to the same session many times, having just one IHand per
> session just isn't going to work.
>

A very good point, although the chances of two forms being submitted  
simultaneously and one redirected render getting the other redirected  
render's hand is impossibly small. The IHand should only be available  
during the duration of the request which occurs after the browser has  
been redirected from the original post.


>> 3) Finally, if people ARE returning results from autocallables,  
>> AND  ARE
>> NOT using guard AND are still annoyed with _nevow_carryover_, I   
>> have an
>> idea which involves putting the mini-session key in the <form
>> action=""> instead of the redirect. Since users only see the  
>> action  url
>> during the time it takes their browser to redirect, and the   
>> redirected
>> request can pull the mini-session key out of the referrer,  this  
>> would
>> work.
>>
>
> ..you assume referrers work reliably :(
>

In what way do they not work reliably?

In any case, 1), not appending gunk to the URL if an autocallable  
returns None, will probably reduce newbie annoyance significantly and  
shouldn't harm anything. So I will at least do that.

Donovan



From andrea at cpushare.com  Sat May 14 05:56:06 2005
From: andrea at cpushare.com (Andrea Arcangeli)
Date: Sat May 14 05:56:21 2005
Subject: [Twisted-web] _nevow_carryover_
In-Reply-To: <E08ACC77-9439-4438-ADF1-7FB5EC37227C@ulaluma.com>
References: <uvf5q3gpx.fsf@yahoo.co.uk>
	<10CFBDD1-87CB-4DA7-8C17-FDA792FF710B@ulaluma.com>
	<4283435A.7060009@twistedmatrix.com>
	<E08ACC77-9439-4438-ADF1-7FB5EC37227C@ulaluma.com>
Message-ID: <20050514115606.GF13985@g5.random>

Hello Donovan,

On Thu, May 12, 2005 at 11:21:04AM -0700, Donovan Preston wrote:
> A very good point, although the chances of two forms being submitted  
> simultaneously and one redirected render getting the other redirected  
> render's hand is impossibly small. The IHand should only be available  

This is generally true but every race will trigger eventually, so I'd
suggest not make this assumptions in the core of the server. This would
be a problem especially if tons of users are given the same account
credentials to access a part of the website.

The only problem I have with carryover personally is the lack of
timeout. Each carryover should have a timestamp and periodically there
should be a scan of all carryovers (with some volountary preemption in
between the scan, so perhaps done with a timer with 0 timeout to avoid
hanging twisted for an extended period of time). Too old carryovers
should be deleted from the hash. I'd suggest to keep the timeout
configurable for the app (like the session timeout is also
configurable), so depending on the load and memory of the system one can
tune it. A default to the same default of the session timeout sounds
reasonable.

The weird URL of the carryover is fine with me, this will never be a
robot posting a form and saving the wierd filename. The weird url for
the session start instead is a problem, because wget can be used there
so I removed it and apparently it didn't break anything ;).

Thanks!

From purestorm at ggnore.net  Sun May 15 17:08:31 2005
From: purestorm at ggnore.net (Manuel Holtgrewe)
Date: Sun May 15 17:08:48 2005
Subject: [Twisted-web] Bootstrapping for Nevow
Message-ID: <4840D212-46CA-4DA3-AA48-D2558BD8824F@ggnore.net>

Hi

First of all, I'd like to introduce myself in three lines:

I'm Manuel Holtgrewe, stuying computer sciences in Germany. One of my  
interested is web programming and "scripting" (or better dynamically  
typed) languages like Python and (sorry to mention it in one sentence  
with it:) PHP. I am - or better was - one of the developers of the  
Binarycloud project [1] that tried to bring structure into PHP web  
developing.

I'm currently trying to replace Binarycloud with some Python based  
for my freelancing work and have reached at Nevow.

==

Okay, now to the real reason of this mail. I talked to some of the  
Nevow community (namely dialtone, mg and others) on IRC and they  
agreed that it might be a good idea to provide some small bootstrap  
utilities to get you started with a new Nevow page without having to  
copy anything manually from your old projects etc.

This would also lead to "best practice" for a Nevow project and help  
to "standardize" things, i.e. allow to document it and to give people  
that are new to Nevow (like me) a way to see how Things Are Done With  
Nevow.

Okay, the way I would imagine such a tool is shown in the thing I  
hacked up [2]. It basically only copies some files from a skelleton  
directory and sets you up with a minimal project workspace.

A quick explanations of my thougths that went into the skelleton:

.
|-- ntools
|   |-- __init__.py
|   |-- project.py
|-- scripts
|   |-- mkproject.py
`-- skel
     |-- doc
     |-- project
     |   |-- __init__.py
     |   `-- site
     |       |-- __init__.py
     |       |-- html
     |       |   |-- index.html
     |       `-- resources
     |           `-- header-logo.png
     `-- server.tac


  - A doc directory is created in the project's directory to hold  
things like notes and diagrams.
  - There is a module package called site that holds the things that  
are specific to the current site and are not very likely to be reused  
in other applications. Those components should go into their own  
packages parallel to "site".
  - The project.site (__init__.py) module defines the "entry points"  
for the "site" component. Things are spread into other modules in the  
site package so you don't get a 1MB Python file. Maybe that's not  
good Python style, please correct me then.
  - The project.site package contains a resources and a html  
directory that contain the root template and global images, CSS files  
etc. that are not reused in other components.

  - Other components would have their own resources directory and the  
SiteRoot rend.Page subclass will provide URLs like the following so  
all resources are at one place:
     * /resources/site/someimage.png
     * /resources/forumcomponent/somecss.css
   This has the advantage that in the CSS you can have things like  
@url(../site/someimage.png). You could, of course, make the CSS be  
dynamically generated, but I like static things because they can be  
easier to maintain.



Okay, so did I head into the completely wrong direction with my "best  
practice" proposals? If yes, please tell me what you use and I can  
learn from it and we could maybe make that tool useful.

I also think we could add things like "package" generation for  
components parallel to site.

Regards,

Manuel Holtgrewe

[1] http://www.binarycloud.com
[2] http://www.ggnore.net/~mholtgrewe/misc/nevowtools.tar.gz
From andrea at cpushare.com  Mon May 16 01:52:25 2005
From: andrea at cpushare.com (Andrea Arcangeli)
Date: Mon May 16 01:53:08 2005
Subject: [Twisted-web] nested table sequences example
Message-ID: <20050516075225.GD26073@g5.random>

Hello,

Before the weekend I asked some hint to dialtone on how to eliminate an
huge cut-and-pasting in the template book of CPUShare.

He quickly told me to use the IQ(ctx).patternGenerator to fill in the
data for the tables. That was the information I needed to get on the
right track and after some fighting (worst part to figure out was how to
write the right currency in the header) I got it working. Resulting html
is exactly the same, but rendering time is down from 600msec to 250msec
and more important there's no code duplication in the rendering and
template anymore.

I'm willing to share this code for nevow documentation purposes just in
case anybody else has similar needs, since I didn't see examples
covering nested tables usages like this yet.

This below is the template. Before the weekend it was 532 lines (I was
using only many n:data="xx" and n:render="sequence", with many different
perspective calls). It was a nightmare to maintain, every time I wanted
to do a cosmetical change, I had to cut-and-paste it 5 times all over
the >500 lines file. Now after this cleanup the same template is down to
103 lines:

<n:invisible xmlns:n="http://nevow.com/ns/nevow/0.1">

<table class="book_outside" n:data="book" n:render="book_composite">

  <table class="account" n:pattern="book_sequence_bid" n:render="book_sequence">
    <n:invisible n:pattern="header" n:render="book_header">
      <caption class="book">
	<n:slot name="currency" /> Bid
      </caption>
      <tr class="account">
	<th class="account">Price</th>
	<th class="account">Time</th>
	<th class="account">Size</th>
	<th class="account">MFLOPS</th>
	<th class="account">RTT</th>
	<th class="account">RAM</th>
	<th class="account">CPUCoins</th>
      </tr>
    </n:invisible>

    <tr class="account" n:pattern="item" n:render="book_bid">
      <td class="account_right"><pre class="book_right"><n:slot name="price" /></pre></td>
      <td class="account_right"><pre class="book_right"><n:slot name="time" /></pre></td>
      <td class="account_right"><pre class="book_right"><n:slot name="size" /></pre></td>
      <td class="account_right"><pre class="book_right"><n:slot name="mflops" /></pre></td>
      <td class="account_right"><pre class="book_right"><n:slot name="rtt" /></pre></td>
      <td class="account_right"><pre class="book_right"><n:slot name="ram_mbytes" /></pre></td>
      <td class="account_right"><pre class="book_center"><n:slot name="cpucoins" /></pre></td>
    </tr>

    <tr class="account" n:pattern="item" n:render="book_bid">
      <td class="account_right_even"><pre class="book_right"><n:slot name="price" /></pre></td>
      <td class="account_right_even"><pre class="book_right"><n:slot name="time" /></pre></td>
      <td class="account_right_even"><pre class="book_right"><n:slot name="size" /></pre></td>
      <td class="account_right_even"><pre class="book_right"><n:slot name="mflops" /></pre></td>
      <td class="account_right_even"><pre class="book_right"><n:slot name="rtt" /></pre></td>
      <td class="account_right_even"><pre class="book_right"><n:slot name="ram_mbytes" /></pre></td>
      <td class="account_right_even"><pre class="book_center"><n:slot name="cpucoins" /></pre></td>
    </tr>

    <tr class="account" n:pattern="empty">
      <td class="account_dashed">-</td>
      <td class="account_dashed">-</td>
      <td class="account_dashed">-</td>
      <td class="account_dashed">-</td>
      <td class="account_dashed">-</td>
      <td class="account_dashed">-</td>
      <td class="account_dashed">-</td>
    </tr>

  </table>

  <table class="account" n:pattern="book_sequence_ask" n:render="book_sequence">
    <n:invisible n:pattern="header" n:render="book_header">
      <caption class="book">
	<n:slot name="currency" /> Ask
      </caption>
      <tr class="account">
	<th class="account">Price</th>
	<th class="account">Time</th>
	<th class="account">MFLOPS</th>
	<th class="account">RTT</th>
	<th class="account">RAM</th>
	<th class="account">CPUCoins</th>
	<th class="account">Arch</th>
      </tr>
    </n:invisible>

    <tr class="account" n:pattern="item" n:render="book_ask">
      <td class="account_right"><pre class="book_right"><n:slot name="price" /></pre></td>
      <td class="account_right"><pre class="book_right"><n:slot name="time" /></pre></td>
      <td class="account_right"><pre class="book_right"><n:slot name="mflops" /></pre></td>
      <td class="account_right"><pre class="book_right"><n:slot name="rtt" /></pre></td>
      <td class="account_right"><pre class="book_right"><n:slot name="ram_mbytes" /></pre></td>
      <td class="account_right"><pre class="book_center"><n:slot name="cpucoins" /></pre></td>
      <td class="account_right"><pre class="book_center"><n:slot name="arch" /></pre></td>
    </tr>

    <tr class="account" n:pattern="item" n:render="book_ask">
      <td class="account_right_even"><pre class="book_right"><n:slot name="price" /></pre></td>
      <td class="account_right_even"><pre class="book_right"><n:slot name="time" /></pre></td>
      <td class="account_right_even"><pre class="book_right"><n:slot name="mflops" /></pre></td>
      <td class="account_right_even"><pre class="book_right"><n:slot name="rtt" /></pre></td>
      <td class="account_right_even"><pre class="book_right"><n:slot name="ram_mbytes" /></pre></td>
      <td class="account_right_even"><pre class="book_center"><n:slot name="cpucoins" /></pre></td>
      <td class="account_right_even"><pre class="book_center"><n:slot name="arch" /></pre></td>
    </tr>

    <tr class="account" n:pattern="empty">
      <td class="account_dashed">-</td>
      <td class="account_dashed">-</td>
      <td class="account_dashed">-</td>
      <td class="account_dashed">-</td>
      <td class="account_dashed">-</td>
      <td class="account_dashed">-</td>
      <td class="account_dashed">-</td>
    </tr>

  </table>

</table>

</n:invisible>

And this is the rendering code:

BOOK_SIZE = 10
BOOK_TIME_STRFTIME = '%y%m%d %H:%M:%S'

class book_content_class(rend.Fragment):
	docFactory = loaders.xmlfile('book.xml', templateDir = XMLDIR, ignoreDocType = True)

	def data_book(self, ctx, data):
		try:
			return IPB(ctx).call('get_books', BOOK_SIZE)
		except AttributeError:
			return []
	def render_book_composite(self, ctx, data):
		ptrn_bid = inevow.IQ(ctx).patternGenerator('book_sequence_bid')
		ptrn_ask = inevow.IQ(ctx).patternGenerator('book_sequence_ask')
		return ctx.tag[[ tags.tr(_class="book_outside")
				 [tags.td(_class="book_outside")[ptrn_bid(data=(x[0], x[1]))],
				  tags.td(_class="book_outside")[ptrn_ask(data=(x[0], x[2]))]]
				 for x in data ]]
	def render_book_sequence(self, ctx, data): 
		'This is the same as "sequence" but uses data[1] instead of data'
		tag = ctx.tag
		headers = tag.allPatterns('header')
		pattern = tag.patternGenerator('item')
		divider = tag.patternGenerator('divider', default=tags.invisible)
		content = [(pattern(data=element), divider(data=element)) for element in data[1]]
		if not content:
			content = tag.allPatterns('empty')
		else:
			## No divider after the last thing.
			content[-1] = content[-1][0]
		footers = tag.allPatterns('footer')

		return tag.clear()[ headers, content, footers ]
	def render_book_header(self, ctx, data):
		ctx.fillSlots('currency', data[0])
		return ctx.tag
	def render_book_ask(self, ctx, data):
		ctx.fillSlots('price', data[0])
		ctx.fillSlots('time', time.strftime(BOOK_TIME_STRFTIME, time.localtime(data[1])))
		ctx.fillSlots('mflops', data[2])
		ctx.fillSlots('rtt', data[3])
		ctx.fillSlots('ram_mbytes', data[4])
		ctx.fillSlots('cpucoins', data[5])
		ctx.fillSlots('arch', data[6])
		return ctx.tag
	def render_book_bid(self, ctx, data):
		ctx.fillSlots('price', data[0])
		ctx.fillSlots('time', time.strftime(BOOK_TIME_STRFTIME, time.localtime(data[1])))
		ctx.fillSlots('size', data[2])
		ctx.fillSlots('mflops', data[3])
		ctx.fillSlots('rtt', data[4])
		ctx.fillSlots('ram_mbytes', data[5])
		ctx.fillSlots('cpucoins', data[6])
		return ctx.tag

The list returned by the get_books perspective client, is created by the
pb server like this: [[currency1, [bidsequence], [asksequnce]], [currency2,
[bidsequence], [asksequence]],...].

You can see that I had to create my own render_book_sequence that works
exactly like the default render_sequence, except that uses "data[1]"
instead of "data". I didn't find any other way than to create my own
render_book_sequence, to be able to fill in the currency information in
render_book_header.

Hope this helps!

From jean-marc.pouchoulon at ac-montpellier.fr  Mon May 16 07:41:37 2005
From: jean-marc.pouchoulon at ac-montpellier.fr (jean-marc.pouchoulon@ac-montpellier.fr)
Date: Mon May 16 07:42:16 2005
Subject: [Twisted-web] ldaptor , python-ldap , nevow 
Message-ID: <4288A311.6080209@ac-montpellier.fr>

Bonjour,

   I try to run ldaptor examples with python2.4.1 , twisted 2.0, nevow 
0.4.1, fedora core 3.
.05_form gives me  "Deferred instance has no attribute 'original'" and 
some warnings.
  (the previous examples  ran  correctly.)

   Does anyone has an updated code ? ( I used the latest code I've got 
from svn )

   I search also python-ldap examples with twisted and nevow.

   Thanks.

From mailinglists at shechen.at  Tue May 17 04:37:56 2005
From: mailinglists at shechen.at (stephan))
Date: Tue May 17 04:40:39 2005
Subject: [Twisted-web] SLUT, twisted based experimental graphix framework
Message-ID: <4289C984.4060100@shechen.at>



I would like to thank everybody who helped me gain knowledge about
twisted. Please feel free to check out my twisted-based thesis project:

http://slut.sourceforge.net/index.html

#stephan

From nico at tekNico.net  Tue May 17 05:15:19 2005
From: nico at tekNico.net (Nicola Larosa)
Date: Tue May 17 05:15:28 2005
Subject: [Twisted-web] 
	Re: SLUT, twisted based experimental graphix framework
In-Reply-To: <4289C984.4060100@shechen.at>
References: <4289C984.4060100@shechen.at>
Message-ID: <4289D247.6000201@tekNico.net>

> I would like to thank everybody who helped me gain knowledge about
> twisted. Please feel free to check out my twisted-based thesis project:
> 
> http://slut.sourceforge.net/index.html

Erm, "slut" is not exactly the most pleasant of words. Maybe not worse than
http://merd.sourceforge.net/ , I guess, but still... :-)

-- 
Nicola Larosa - nico@tekNico.net

I feel like we are losing our creativity and imagination. Give a 3 year
old a box of crayons and you have no idea what he will come up with.
Give a 10 year old a Playstation2 and about the best that might happen
is he'll find a way to cheat.
 -- Lee Harr, April 2005


From corydodt at twistedmatrix.com  Tue May 17 09:18:09 2005
From: corydodt at twistedmatrix.com (Cory Dodt)
Date: Tue May 17 09:17:07 2005
Subject: [Twisted-web] 	Re: SLUT,
	twisted based experimental graphix framework
In-Reply-To: <4289D247.6000201@tekNico.net>
References: <4289C984.4060100@shechen.at> <4289D247.6000201@tekNico.net>
Message-ID: <428A0B31.3020003@twistedmatrix.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I don't have any particular objection to the name, but I'd be concerned, if I
were you, about spam filters :-)

Nicola Larosa wrote:
|>I would like to thank everybody who helped me gain knowledge about
|>twisted. Please feel free to check out my twisted-based thesis project:
|>
|>http://slut.sourceforge.net/index.html
|
|
| Erm, "slut" is not exactly the most pleasant of words. Maybe not worse than
| http://merd.sourceforge.net/ , I guess, but still... :-)
|

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (MingW32)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQFCigsx3A5SrXAiHQcRAjiUAJ0QT+Fwr8/vJtB4cQG5woOXJww7tACdHXMD
qr8Q3t+DRyoUG9s08s9WtHY=
=7WPi
-----END PGP SIGNATURE-----

From purestorm at ggnore.net  Tue May 17 14:09:15 2005
From: purestorm at ggnore.net (Manuel Holtgrewe)
Date: Tue May 17 14:09:36 2005
Subject: [Twisted-web] Bootstrapping for Nevow
In-Reply-To: <4840D212-46CA-4DA3-AA48-D2558BD8824F@ggnore.net>
References: <4840D212-46CA-4DA3-AA48-D2558BD8824F@ggnore.net>
Message-ID: <6869E305-69C6-4358-B22B-56F3BD705455@ggnore.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi

dialtone requested a more verbose example on IRC, so here it is.

My basic idea is that having a common application structure would  
allow for reuseable components (I mean "embeddable applications")  
like forums, weblogs, younameit.

When developing in such a "best practice" you would create self- 
contained packages for each "logically seperated" part like such  
applications as stated above. The applications would be reuseable,  
then, and one could imagine that there could be a central repository  
of such applications.

IMO there would also be a need for a central authentication and  
permission handling package so a forum application can access the  
same data as a CMS application. All this looks a bit like the concept  
"Zope" and "Zope Products" have. I don't really like Zope because of  
its ZODB integration into everything, the templating system etc. but  
I think it is very successful because you have myriads of components  
you can base your web sites on.

If there was a "common auth infrastructure" and a definition of how  
components have to look for the outside and how you can embed them  
into your code, I think Nevow would become much more effective to  
work with since code becomes reuseable.

Maybe these are ideas are not new to the Nevow project and its  
community and they had their reasons not to create such structures,  
but I just wanted to raise the issue to see what happens ;)


Manuel

PS: Here is an example of the code layout:

# The project root contains the tac file to run the server and the "site
# specific" modules.
$PROJECT/
   server.tac

   [projectname]/
     __init__.py

     # This package contains files that are "glue" for the other  
modules like
     # the "main layout" template containing <html>...</html>.
     site/
       # This module defines rend.Page chidren like a RootPage etc.
       __init__.py
       # another module with site specific things
       somemodule.py
       html/
         sometemplate.html
         sometemplate.html
       sql/ (if desired)
         mysql.sql
         othersql.sql
       resources/
         style1.css
         style2.css
         image1.png
         image2.jpg
         moo.js

     # These are other self-contained, but site specific modules.  
This could
     # be a custom user management, a forum etc. with all the  
necessary Python
     # code, CSS, JS, images etc.
     sitespecific1/
       __init__.py
       datahandler.py
       something.py
       html/
         ...
       sql/
         ...
       resources/
         ...
     sitespecific2/
       __init__.py
       html/
         ...
       sql/
         ...
       resources/
         ...

# The "module repository" contains reuseable, "embeddable"  
applications. These
# could be a user management system that brings login forms etc, a  
forum etc.
$COMPONENTS
   # The packages here have the same structure as the packages above  
in the
   # project's directory.
   someforum/
     __init__.py
     data.py
     usermanagement.py
     forumposts.py
     html/
       ...
     resources/
       ...

   weblog/
     ...

   tictactoe/
     ...

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.0 (Darwin)

iD8DBQFCik9s+Z0vV1m84RkRAr6wAJ4rMVR+Iatt8nW2KvR4l2r33wxiKACgj0FE
SBeY43mTR/IczdPX8IGktWY=
=h2UM
-----END PGP SIGNATURE-----

From srichter at cosmos.phy.tufts.edu  Tue May 17 14:20:50 2005
From: srichter at cosmos.phy.tufts.edu (Stephan Richter)
Date: Tue May 17 14:21:00 2005
Subject: [Twisted-web] Bootstrapping for Nevow
In-Reply-To: <6869E305-69C6-4358-B22B-56F3BD705455@ggnore.net>
References: <4840D212-46CA-4DA3-AA48-D2558BD8824F@ggnore.net>
	<6869E305-69C6-4358-B22B-56F3BD705455@ggnore.net>
Message-ID: <200505171620.50661.srichter@cosmos.phy.tufts.edu>

On Tuesday 17 May 2005 16:09, Manuel Holtgrewe wrote:
> IMO there would also be a need for a central authentication and
> permission handling package so a forum application can access the
> same data as a CMS application. All this looks a bit like the concept
> "Zope" and "Zope Products" have. I don't really like Zope because of
> its ZODB integration into everything, the templating system etc. but
> I think it is very successful because you have myriads of components
> you can base your web sites on.

Have a look at Zope 3. You can easily replace or use as much or little as you 
wish. And as a bonus, Zope 3.2 will feature Twisted as the server.

Regards,
Stephan
-- 
Stephan Richter
CBU Physics & Chemistry (B.S.) / Tufts Physics (Ph.D. student)
Web2k - Web Software Design, Development and Training

From nico at tekNico.net  Tue May 17 15:47:41 2005
From: nico at tekNico.net (Nicola Larosa)
Date: Tue May 17 15:50:50 2005
Subject: [Twisted-web] Re: Bootstrapping for Nevow
In-Reply-To: <200505171620.50661.srichter@cosmos.phy.tufts.edu>
References: <4840D212-46CA-4DA3-AA48-D2558BD8824F@ggnore.net>	<6869E305-69C6-4358-B22B-56F3BD705455@ggnore.net>
	<200505171620.50661.srichter@cosmos.phy.tufts.edu>
Message-ID: <d6doon$f16$1@sea.gmane.org>

> Have a look at Zope 3. You can easily replace or use as much or little as you 
> wish. And as a bonus, Zope 3.2 will feature Twisted as the server.

Does this mean that the whole Zope+Twisted caboodle will natively run in an
asynchronous, event-driven fashion? Or are threads still part of the picture?

-- 
Nicola Larosa - nico@tekNico.net

In one sense, we're entering an age of high tech. In another sense, it's
*always* been high tech. Poster: picture of a nautilus shell.
Caption: "High Tech: It's not just where we're heading, it's where we're
coming from." -- Kirby Urner, April 2005


From srichter at cosmos.phy.tufts.edu  Tue May 17 15:57:03 2005
From: srichter at cosmos.phy.tufts.edu (Stephan Richter)
Date: Tue May 17 15:57:16 2005
Subject: [Twisted-web] Re: Bootstrapping for Nevow
In-Reply-To: <d6doon$f16$1@sea.gmane.org>
References: <4840D212-46CA-4DA3-AA48-D2558BD8824F@ggnore.net>
	<200505171620.50661.srichter@cosmos.phy.tufts.edu>
	<d6doon$f16$1@sea.gmane.org>
Message-ID: <200505171757.03253.srichter@cosmos.phy.tufts.edu>

On Tuesday 17 May 2005 17:47, Nicola Larosa wrote:
> > Have a look at Zope 3. You can easily replace or use as much or little as
> > you wish. And as a bonus, Zope 3.2 will feature Twisted as the server.
>
> Does this mean that the whole Zope+Twisted caboodle will natively run in an
> asynchronous, event-driven fashion? Or are threads still part of the
> picture?

Every request that is sent to Zope 3 will be run in a thread. This way we 
avoid locking for long transactions. The new twisted.web2.wsgi code actually 
provides that. But it will work like that for FTP as well.

Regards,
Stephan
-- 
Stephan Richter
CBU Physics & Chemistry (B.S.) / Tufts Physics (Ph.D. student)
Web2k - Web Software Design, Development and Training

From lilliput at tuxfamily.org  Tue May 17 21:24:22 2005
From: lilliput at tuxfamily.org (Lilliput)
Date: Tue May 17 21:26:22 2005
Subject: [Twisted-web] Proxy Socksv5
Message-ID: <1116386662.7931.6.camel@localhost>


Hello,

I would like to know if there is any plan soon or later to get a SocksV5
api. It would be great to be able to use for the authentification and
the UDP possibilities. I might add that almost all new network
application supporting a proxy feature have the v5.

Thanks very much

Regards
Fabien

-- 
  _
 ( >-     
 /~\      F. Bourdaire
|  \)                                                               
 \_|_     http://www.saycure.com


From eric.faurot at gmail.com  Thu May 19 08:55:56 2005
From: eric.faurot at gmail.com (Eric Faurot)
Date: Thu May 19 08:56:33 2005
Subject: [Twisted-web] nevow meets docutils
Message-ID: <e012d6b505051907554e12be46@mail.gmail.com>

Hi all,

I've written a bit of code to:
- make docutils somewhat useable for the programer,
- use nevow for rendering document in a flexible way.

It is maybe a bit hackish, but it suits my needs for now.
People using docutils and/or nevow might be interrested.
Feedback would be appreciated (is it utter crap?).

Run nevowdemo.py to try out (produces nevowdemo.html from
nevowdemo.txt). You'll need a recent docutils, nevow and
zope.interface.

Eric.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: rsthelpers.tgz
Type: application/x-gzip
Size: 8303 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-web/attachments/20050519/d1481b96/rsthelpers.bin
From foom at fuhm.net  Thu May 19 14:55:23 2005
From: foom at fuhm.net (James Y Knight)
Date: Thu May 19 14:55:33 2005
Subject: [Twisted-web] Proxy Socksv5
In-Reply-To: <1116386662.7931.6.camel@localhost>
References: <1116386662.7931.6.camel@localhost>
Message-ID: <0CBCC9D2-E06E-4ECE-8BFA-A9EB8C21A708@fuhm.net>

I don't know of anybody working on writing such a thing.

James

On May 17, 2005, at 11:24 PM, Lilliput wrote:

>
> Hello,
>
> I would like to know if there is any plan soon or later to get a  
> SocksV5
> api. It would be great to be able to use for the authentification and
> the UDP possibilities. I might add that almost all new network
> application supporting a proxy feature have the v5.
>
> Thanks very much
>
> Regards
> Fabien
>
> -- 
>   _
>  ( >-
>  /~\      F. Bourdaire
> |  \)
>  \_|_     http://www.saycure.com
>
>
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>
>


From ellers at ellerton.net  Thu May 19 15:54:51 2005
From: ellers at ellerton.net (ellers@ellerton.net)
Date: Thu May 19 15:54:47 2005
Subject: [Twisted-web] broadcast events; sessions
Message-ID: <1985.80.218.228.20.1116539691.squirrel@80.218.228.20>

Hello all :)

Can anyone help me with these questions?

- I need to include in my server the ability to sent a broadcast of an
event out to listeners.

  The listeners will be GUIs that are normally communicating with the
server by calling XML-RPC. Naturally, when the server wants to broadcast
an event back it will need some other mechanism. Is UDP what I should be
looking for?

  Although my app is a system monitoring tool, I guess this in this
respect the behaviour I want is similar a chat server, as in the demo
chatserver.py?


- The server will have a HTTP interface as well as XML-RPC (I know XML-RPC
is HTTP but you know what I mean) and I need the flow to go like

   (a) user logs in with SSL
   (b) user redirected to non-SSL page
   (c) subsequent operations in web pages use session info like username
   (d) XML-RPC calls should also have same SSL/login sequence

  I figure this requires the use of cookies and sessions.
  Are there any tips or fully functional "rich" demos that cover this ground?
  (I'm thankful for the demos online and test progs ... but what I REALLY
need is substantial docs and/or samples, fully functional extensive
applications)


Thanks for any tips - much appreciated :)

Ellers


From jadestorm at nc.rr.com  Thu May 19 18:25:00 2005
From: jadestorm at nc.rr.com (Daniel Henninger)
Date: Thu May 19 18:24:57 2005
Subject: [Twisted-web] Proxy Socksv5
In-Reply-To: <0CBCC9D2-E06E-4ECE-8BFA-A9EB8C21A708@fuhm.net>
References: <1116386662.7931.6.camel@localhost>
	<0CBCC9D2-E06E-4ECE-8BFA-A9EB8C21A708@fuhm.net>
Message-ID: <51115.10.0.0.9.1116548700.squirrel@www.vorpalcloud.org>

One of the folk who uses my jabber transports (pyicq-t and pyaim-t)
actually wrote in socks5 support that integrates with twisted.  Perhaps I
should encourage him to submit it to twisted proper?

Daniel

-- 
"The most addictive drug in the world is music."
     - The Lost Boyz

> I don't know of anybody working on writing such a thing.
>
> James
>
> On May 17, 2005, at 11:24 PM, Lilliput wrote:
>
>>
>> Hello,
>>
>> I would like to know if there is any plan soon or later to get a
>> SocksV5
>> api. It would be great to be able to use for the authentification and
>> the UDP possibilities. I might add that almost all new network
>> application supporting a proxy feature have the v5.
>>
>> Thanks very much
>>
>> Regards
>> Fabien
>>
>> --
>>   _
>>  ( >-
>>  /~\      F. Bourdaire
>> |  \)
>>  \_|_     http://www.saycure.com
>>
>>
>> _______________________________________________
>> Twisted-web mailing list
>> Twisted-web@twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>>
>>
>
>
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>
>
>



From andreas.destefani at ucd.ie  Fri May 20 11:38:02 2005
From: andreas.destefani at ucd.ie (Andreas De Stefani)
Date: Fri May 20 11:38:05 2005
Subject: [Twisted-web] twisted web / reactor.callInThread()
Message-ID: <428E207A.4020900@ucd.ie>

hi all,

I am using reactor.callInThread(methodname, args ...) to start a 
function in a new thread from a twisted web application. Today i got 
problems with my server, and when i looked at the currently running 
processes there where about 50 twisted processes running, some of them 
where days/weeks old.

I increased the Threadpoolsize previously with the command

reactor.suggestThreadPoolSize(50)

to 50 in order to have more parallel executions...

Could it be that some of the threads didnt get terminated and cleaned up 
correctly, or are the processes just visible because the threadPoolSize 
was set as high? ...I'm almost sure my function terminates correctly...

any help or information about this behaviour would be appreciated

thanks

Andy

From radeex at gmail.com  Sat May 21 02:24:18 2005
From: radeex at gmail.com (Christopher Armstrong)
Date: Sat May 21 02:24:22 2005
Subject: [Twisted-web] twisted web / reactor.callInThread()
In-Reply-To: <428E207A.4020900@ucd.ie>
References: <428E207A.4020900@ucd.ie>
Message-ID: <60ed19d4050521012430650f52@mail.gmail.com>

On 5/21/05, Andreas De Stefani <andreas.destefani@ucd.ie> wrote:
> I am using reactor.callInThread(methodname, args ...) to start a
> function in a new thread from a twisted web application. Today i got
> problems with my server, and when i looked at the currently running
> processes there where about 50 twisted processes running, some of them
> where days/weeks old.
> 
> I increased the Threadpoolsize previously with the command
> 
> reactor.suggestThreadPoolSize(50)
> 
> to 50 in order to have more parallel executions...
> 
> Could it be that some of the threads didnt get terminated and cleaned up
> correctly, or are the processes just visible because the threadPoolSize
> was set as high? ...I'm almost sure my function terminates correctly...
> 
> any help or information about this behaviour would be appreciated


Well, it is a thread _pool_, that is, it keeps a pool of threads
around to do work whenever it's asked. So suggesting 50 will mean it
can get as high as 50, and as low as the minimum (whatever that's set
to).

-- 
  Twisted   |  Christopher Armstrong: International Man of Twistery
   Radix    |    -- http://radix.twistedmatrix.com
            |  Release Manager, Twisted Project
  \\\V///   |    -- http://twistedmatrix.com
   |o O|    |  Founding Member, Hobart Hacking Society
w----v----w-+    -- http://hackingsociety.org/chapters/hash

From lilliput at tuxfamily.org  Sat May 21 05:16:37 2005
From: lilliput at tuxfamily.org (Lilliput)
Date: Sat May 21 05:18:40 2005
Subject: [Twisted-web] Proxy Socksv5
In-Reply-To: <51115.10.0.0.9.1116548700.squirrel@www.vorpalcloud.org>
References: <1116386662.7931.6.camel@localhost>
	<0CBCC9D2-E06E-4ECE-8BFA-A9EB8C21A708@fuhm.net>
	<51115.10.0.0.9.1116548700.squirrel@www.vorpalcloud.org>
Message-ID: <1116674197.15816.24.camel@localhost>

Hello

Le jeudi 19 mai 2005 ? 20:25 -0400, Daniel Henninger a ?crit :
> One of the folk who uses my jabber transports (pyicq-t and pyaim-t)
> actually wrote in socks5 support that integrates with twisted.  Perhaps I
> should encourage him to submit it to twisted proper?
> 
> Daniel
> 

It would be really great. I am looking for this lib since a bit;
Would be a pleasure to be a tester.


Regards



-- 
  _
 ( >-     Fabien Bourdaire
 /~\      http://www.saycure.com/contact/                                             
|  \)                                                               
 \_|_     http://www.saycure.com


From mordaha at gmail.com  Sat May 21 10:36:13 2005
From: mordaha at gmail.com (Little)
Date: Sat May 21 10:36:45 2005
Subject: [Twisted-web] twisted+nevow in production environment
Message-ID: <899dbb70505210936951fe22@mail.gmail.com>

I'd like to read some tips/tricks/known issues/sucsessful
stories/e.t.s about twisted and nevow in production environment (e.g.
in Internet)

Server configuration, start/stop, logging, monitoring, availability
Some tips about programming style (for example, like in PHP - "never
use global variable mapping, use $_POST[] $_GET[] instead")

And so on. I'll done my project next month, and i must pulish it in internet.

Is there any official web-resources of such thematic?

From ellers at ellerton.net  Sun May 22 16:12:13 2005
From: ellers at ellerton.net (Ellers)
Date: Sun May 22 16:12:07 2005
Subject: [Twisted-web] Reactor in a multithreaded program
Message-ID: <4059.84.73.44.136.1116799933.squirrel@84.73.44.136>

Hi all

What is the right way to use a reactor in a multithreaded program?

The program I'm writing is a command line program that needs to use the
readline package. Readline blocks so I need to put the reactor (or the
readline call) in a separate thread.

I can start the reactor ok if I set installSignalHandlers=0. But calling
reactor.stop() from the main thread doesn't seem to stop it.

What is the best way?

Thanks :)
Ellers


From andrew-twisted at puzzling.org  Sun May 22 17:24:32 2005
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Sun May 22 17:24:38 2005
Subject: [Twisted-web] Reactor in a multithreaded program
In-Reply-To: <4059.84.73.44.136.1116799933.squirrel@84.73.44.136>
References: <4059.84.73.44.136.1116799933.squirrel@84.73.44.136>
Message-ID: <20050522232432.GA28253@frobozz>

On Sun, May 22, 2005 at 03:12:13PM -0700, Ellers wrote:
> Hi all
> 
> What is the right way to use a reactor in a multithreaded program?
> 
> The program I'm writing is a command line program that needs to use the
> readline package. Readline blocks so I need to put the reactor (or the
> readline call) in a separate thread.
> 
> I can start the reactor ok if I set installSignalHandlers=0. But calling
> reactor.stop() from the main thread doesn't seem to stop it.

Nothing in Twisted is thread-safe, except for reactor.callFromThread.  So,
if you want to stop the reactor from thread aside from the one the reactor
is in, you need to do reactor.callFromThread(reactor.stop).

-Andrew.


From garthk at gmail.com  Sun May 22 19:17:14 2005
From: garthk at gmail.com (Garth T Kidd)
Date: Sun May 22 19:17:46 2005
Subject: [Twisted-web] LivePage erratic under IE 6.0
Message-ID: <8aeed5d005052218177d01ebfb@mail.gmail.com>

To see whether LivePage is the right foundation for a side-project,
I've written a rudimentary ping program that updates the client DOM.
Under FireFox, all works as expected. Under IE, it worked for text
pings (handled entirely in ping()) but not for numeric pings (handled
by the Blaster class). Then it stopped working at all. I'm most
puzzled.

Versions:

    nevow 0.4.1
    twisted 2.0.0
    python 2.3.5
    IE 6.0.2800.1106.xpsp2.040919-1003CO

Script: 

from nevow import loaders
from nevow import tags
from nevow import livepage
from nevow import appserver

from twisted.internet import reactor

class Blaster: 
    def __init__(self, client, tenths): 
        self.client = client
        self.tenths = tenths
        self.now = 0.0
    def __call__(self): 
        self.client.set('head', str(self.now))
        self.now = self.now + self.tenths/10.0
        if self.now < 10:
            reactor.callLater(self.tenths/10.0, self)
            
def ping(client, payload): 
    try: 
        Blaster(client, float(payload))()
    except ValueError: 
        client.set('head', payload)
        reactor.callLater(1, client.set, 'head', "Do it again!")

ping = livepage.handler(ping, 
            livepage.document.getElementById('payload').value)

class Twister(livepage.LivePage):
    addSlash = True
    
    docFactory = loaders.stan( 
        tags.html[
            tags.head[
                tags.directive('liveid'),
                tags.directive('liveglue') 
                ],
            tags.body[
                tags.h1(id='head') ["Twist me, baby!"],
                tags.div(id='pingform') [
                    tags.form(name='ping', onsubmit=ping) [
                        tags.input(name='payload', id='payload'), 
                        tags.button['Ping!']
                        ]
                    ]
                ]
            ]
        )

if __name__ == '__main__':
    reactor.listenTCP(7080, appserver.NevowSite(Twister()))
    reactor.run()

From garthk at gmail.com  Sun May 22 19:28:21 2005
From: garthk at gmail.com (Garth T Kidd)
Date: Sun May 22 19:28:53 2005
Subject: [Twisted-web] Re: LivePage erratic under IE 6.0
In-Reply-To: <8aeed5d005052218177d01ebfb@mail.gmail.com>
References: <8aeed5d005052218177d01ebfb@mail.gmail.com>
Message-ID: <8aeed5d00505221828331ee755@mail.gmail.com>

On 23/05/05, Garth T Kidd <garthk@gmail.com> wrote:
> I've written a rudimentary ping program that updates the client DOM.
> Under FireFox, all works as expected. Under IE, it worked for text
> pings (handled entirely in ping()) but not for numeric pings (handled
> by the Blaster class). Then it stopped working at all. I'm most
> puzzled.

I just upgraded to Twisted from SVN, which might -- or might *not* --
explain the following:

The script now works in IE, but only if I hit Enter in the text box.
If I click the button, nothing happens.

What's the best way to go about debugging this? 

Regards,
Garth.

From sridharinfinity at gmail.com  Sun May 22 22:07:41 2005
From: sridharinfinity at gmail.com (Sridhar Ratna)
Date: Sun May 22 22:07:44 2005
Subject: [Twisted-web] Re: LivePage erratic under IE 6.0
In-Reply-To: <8aeed5d00505221828331ee755@mail.gmail.com>
References: <8aeed5d005052218177d01ebfb@mail.gmail.com>
	<8aeed5d00505221828331ee755@mail.gmail.com>
Message-ID: <8816fcf80505222107688c8d0b@mail.gmail.com>

On 5/23/05, Garth T Kidd <garthk@gmail.com> wrote:
> 
> 
> What's the best way to go about debugging this?
> 
> 
Set DEBUG = True (or whatever) in liveevil.py and check the twistd logs

-- 
Sridhar Ratna - http://www.livejournal.com/users/seedar/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-web/attachments/20050523/1ba710fb/attachment.htm
From ellers at ellerton.net  Mon May 23 00:20:05 2005
From: ellers at ellerton.net (Ellers)
Date: Mon May 23 00:19:56 2005
Subject: [Twisted-web] Reactor in a multithreaded program
In-Reply-To: <20050522232432.GA28253@frobozz>
References: <4059.84.73.44.136.1116799933.squirrel@84.73.44.136>
	<20050522232432.GA28253@frobozz>
Message-ID: <4183.84.73.44.136.1116829205.squirrel@84.73.44.136>

> On Sun, May 22, 2005 at 03:12:13PM -0700, Ellers wrote:
>> Hi all
>>
>> What is the right way to use a reactor in a multithreaded program?
>>
>> The program I'm writing is a command line program that needs to use the
>> readline package. Readline blocks so I need to put the reactor (or the
>> readline call) in a separate thread.
>>
>> I can start the reactor ok if I set installSignalHandlers=0. But calling
>> reactor.stop() from the main thread doesn't seem to stop it.
>
> Nothing in Twisted is thread-safe, except for reactor.callFromThread.  So,
> if you want to stop the reactor from thread aside from the one the reactor
> is in, you need to do reactor.callFromThread(reactor.stop).

Ah - that makes sense, thanks :)

I tried that, but in itself it didn't solve my problem.

Would you expect the stop() message only to be picked up when the reactor
has some activity?

Is there an advised pattern for working with the reactor with multiple
threads?

Thanks :)
Ellers


From andrew-twisted at puzzling.org  Mon May 23 00:38:16 2005
From: andrew-twisted at puzzling.org (Andrew Bennetts)
Date: Mon May 23 00:38:22 2005
Subject: [Twisted-web] Reactor in a multithreaded program
In-Reply-To: <4183.84.73.44.136.1116829205.squirrel@84.73.44.136>
References: <4059.84.73.44.136.1116799933.squirrel@84.73.44.136>
	<20050522232432.GA28253@frobozz>
	<4183.84.73.44.136.1116829205.squirrel@84.73.44.136>
Message-ID: <20050523063816.GF5425@frobozz>

On Sun, May 22, 2005 at 11:20:05PM -0700, Ellers wrote:
[...]
> > Nothing in Twisted is thread-safe, except for reactor.callFromThread.  So,
> > if you want to stop the reactor from thread aside from the one the reactor
> > is in, you need to do reactor.callFromThread(reactor.stop).
> 
> Ah - that makes sense, thanks :)
> 
> I tried that, but in itself it didn't solve my problem.
> 
> Would you expect the stop() message only to be picked up when the reactor
> has some activity?

No, the callFromThread will wake up the reactor if it is idle.

Are you sure reactor.callFromThread(reactor.stop) is being called?  And make
sure you aren't accidentally doing "reactor.callFromThread(reactor.stop())",
which is a common mistake!

> Is there an advised pattern for working with the reactor with multiple
> threads?

Yes: use callFromThread everytime you need to call a Twisted function from a
thread :)

There's a brief document on Twisted's threading facilities here:
   http://twistedmatrix.com/projects/core/documentation/howto/threading.html

It's brief because there's not much Twisted-specific knowledge to know,
beyond the advice about using callFromThread, and the APIs for using the
threadpool facilities built into Twisted.

-Andrew.


From therve at free.fr  Mon May 23 01:42:30 2005
From: therve at free.fr (Thomas HERVE)
Date: Mon May 23 01:43:28 2005
Subject: [Twisted-web] Re: LivePage erratic under IE 6.0
In-Reply-To: <8aeed5d00505221828331ee755@mail.gmail.com>
References: <8aeed5d005052218177d01ebfb@mail.gmail.com>
	<8aeed5d00505221828331ee755@mail.gmail.com>
Message-ID: <20050523094230.iqb3p928gbmsw4ws@itchy.wasabout.net>

Quoting Garth T Kidd <garthk@gmail.com>:

> [snip]
> The script now works in IE, but only if I hit Enter in the text box.
> If I click the button, nothing happens.

Try to change tags.button['Ping!'] in tags.button(type="submit")['Ping!'] (you
should specify type="text" in the input too). I think it's just some 
bad formed
HTML, which result to unpredictable behaviour.

-- 
Thomas



From ellers at ellerton.net  Mon May 23 15:08:29 2005
From: ellers at ellerton.net (Ellers)
Date: Mon May 23 15:08:24 2005
Subject: [Twisted-web] Reactor in a multithreaded program
In-Reply-To: <20050523063816.GF5425@frobozz>
References: <4059.84.73.44.136.1116799933.squirrel@84.73.44.136>
	<20050522232432.GA28253@frobozz>
	<4183.84.73.44.136.1116829205.squirrel@84.73.44.136>
	<20050523063816.GF5425@frobozz>
Message-ID: <1614.84.73.44.136.1116882509.squirrel@84.73.44.136>

> Are you sure reactor.callFromThread(reactor.stop) is being called?

Yes and no - I was sure it was being called (a print statement before) BUT
it turns out it was actually calling and returning ok.

But I found the problem! I needed this at the start:

from twisted.python import threadable
threadable.init( with_threads=1)

DOH!

> And make sure you aren't accidentally doing
> "reactor.callFromThread(reactor.stop())",
> which is a common mistake!

When I first read this I thought "damn thats what I've done" but I wasn't.

>> Is there an advised pattern for working with the reactor with multiple
>> threads?
>
> Yes: use callFromThread everytime you need to call a Twisted function
from a thread :)

;)

The following is more what I meant by a discussion of patterns. (These are
NOT real.. just designed to illustrate for discussion):

  The wxwidgets pattern: simple case is to use the wxreactor.
  However, you COULD run the GUI normally and run the reactor in a
non-main thread. Be sure to communicate with the reactor using
callFromThread or having a protocol reading a Queue.Queue() object.

  The readline pattern: you have a shell-like interface and need to call
the blocking function raw_input(). (Sure, you can use the stdin protocol
in normal twisted but that won't play with readline).

  You run the reactor in a non-main thread and communicate with it as above.


And the pattern could come with a simple proof-of-concept program, like
this one...

I also have a readline example working now. I can post it to the list if
anyone is interested.


>8 --- >8 ---

#!/bin/env python

"""Trivial demo - demonstrate the reactor in a NON main thread.

You can telnet to port 7001 and see echos of everything you type for
10 seconds. After that it should close cleanly. But it doesn't - yet.
"""

import sys
import time
import threading
from twisted.internet import reactor
from twisted.protocols import wire
from twisted.internet.protocol import Factory
from twisted.python import threadable

threadable.init( with_threads=1)

class ReactorFacade:

	def __init__( self ):
		self.reactorThread = threading.Thread(
			target=reactor.run,
			name="ReactorThread",
			kwargs={'installSignalHandlers':0},
			)

	def start(self):
		# assume not yet started
		print "Facade: starting..."
		self.reactorThread.start()
		print "Facade: started ok"

	def stop(self):
		# assume already running
		print "Facade: request stop"
		reactor.callFromThread(reactor.stop)
		print "Facade: request stopped ok"
		self.reactorThread.join()

factory = Factory()
factory.protocol = wire.Echo
reactor.listenTCP( 7001, factory ) # <-- you don't NEED a protocol, but
for example...
print "Echo on 7001"
facade = ReactorFacade()
print "Main: Starting..."
facade.start()
print "Main: Sleeping..."
time.sleep(10)
print "Main: Stopping..."
facade.stop()
print "Main: Finished" # <-- will hang here

>8 --- >8 ---




From shamrin at gmail.com  Wed May 25 05:22:08 2005
From: shamrin at gmail.com (Alexey Shamrin)
Date: Wed May 25 05:22:41 2005
Subject: [Twisted-web] Re: LivePage erratic under IE 6.0
In-Reply-To: <8816fcf80505222107688c8d0b@mail.gmail.com>
References: <8aeed5d005052218177d01ebfb@mail.gmail.com>
	<8aeed5d00505221828331ee755@mail.gmail.com>
	<8816fcf80505222107688c8d0b@mail.gmail.com>
Message-ID: <28d42ea7050525042213bf0edc@mail.gmail.com>

Hello!

> > What's the best way to go about debugging this?
>  Set DEBUG = True (or whatever) in liveevil.py and check the twistd logs

Not in liveevil.py, but in livepage.py. He is using livepage...

-- 
Alexey

From p.mayers at imperial.ac.uk  Wed May 25 08:54:40 2005
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Wed May 25 08:55:16 2005
Subject: [Twisted-web] Grouping controls in formless layouts
Message-ID: <429491B0.3000300@imperial.ac.uk>

All,

I have a table-based layout (yes I know) which uses the slots/patterns 
and an XML template to lay the form out:

<form xmlns:n="http://nevow.com/ns/nevow/0.1" n:pattern="freeform-form">
  <!-- blah, lots of stuff here -->
  <table>
    <n:invisible n:pattern="argument" n:render="remove">
      <tr><td><n:slot-name="input"/></td></tr>
    </n>
  </table>
</form>

...however I want to group some of the controls together in the table. 
The problem is that this:

<form xmlns:n="http://nevow.com/ns/nevow/0.1" n:pattern="freeform-form">
  <!-- blah, lots of stuff here -->
  <table>
    <n:invisible n:pattern="argument" n:render="remove">
      <tr>
        <td><n:slot-name="description"/></td>
        <td><n:slot-name="input"/></td>
      </tr>
    </n>

    <tr>
      <td>Age</td>
      <n:invisible n:pattern="argument!!age" n:render="remove">
        <td><n:slot-name="input"/></td>
      </n>
      <n:invisible n:pattern="argument!!ageunits" n:render="remove">
        <td><n:slot-name="input"/></td>
      </n>
  </table>
</form>

...generates this:

<table>
   <tr>
     <td>field 1</td>
     <td><input type="text" name="field1"/></td>
   </tr>

   <td><input type="text" name="age"/></td>
   <td><select name="age"><!--blah--></select></td>

   <tr>
     <td>Age</td>
   </tr>
</table>

...that is, the patterns are yanked out of their inner context (as you 
would expect I guess).

The labours of why this needs to be table-based need not be raised here 
- suffice it to say I'm not the one making the decision. Having said 
that I can see the argument that making a proper resizing gridbag-style 
layout with CSS is basically impossible (and that infuriates me).

I suspect I can subclass annotate.Typed or use the complexType stuff to 
somehow group a textbox and dropdown together into one logical bit of 
HTML that is rendered as a single "control".

Does anyone have any examples of how I might do that or similar to 
aggregate various form control?

From thomas.weholt at gmail.com  Fri May 27 01:37:46 2005
From: thomas.weholt at gmail.com (Thomas Weholt)
Date: Fri May 27 01:38:20 2005
Subject: [Twisted-web] Announce : TwistedCherry 0.0.2
Message-ID: <ffb7b7f805052700371cec6574@mail.gmail.com>

TwistedCherry is a very simple proof-of-concept project to show 
CherryPy-like development methods using the Twisted HTTP-server.
 Note ! TwistedCherry has so far only been tested with Twisted 1.3.0 and 
actually not been tested much at all. Run test_server.py and 
surf to http://localhost:8080 for a ( hopefully ) running example server. 
The code isn't 100% CherryPy, but sort of a mix of Twisted, CherryPy
and then some. You'll also need CheetahTemplate-system for the test-server 
to run.
 Anyway, I'd be glad for any comments or ideas you might have and as you'll 
probably see from the code I'm not the greatest Twisted-hacker 
alive today ;-)
 Download http://www.mrmuffin.net/software/TwistedCherry-0.0.2.tgz
 References :
  http://www.cherrypy.org
 http://cheetahtemplate.sourceforge.net/

-- 
Mvh/Best regards,
Thomas Weholt
http://www.weholt.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-web/attachments/20050527/e7a520f0/attachment.htm
From Harald.Nyman at astrazeneca.com  Fri May 27 10:45:23 2005
From: Harald.Nyman at astrazeneca.com (Harald.Nyman@astrazeneca.com)
Date: Fri May 27 10:56:52 2005
Subject: [Twisted-web] RE: [Twisted-Python] Chat by html application
Message-ID: <9F028CC77827D611ACEE0002A5F12F0708551629@semldsntmsx208.seml.astrazeneca.net>

Hi Tibi,

Nevow is probably the best. But there are other ways too. I've been
doing this for several years with a Tomcat servlet, and then there was
no Nevow. After converting to Pythonism, I switched to a Twisted server.
Haven't learned Nevow yet, despite good intentions..., but I think this
may be similar. It's essentially doing all of "What I want to do:"
below, only I'm not using it mainly for chat, but for distributing
HTML or Javascript, for viewing things together during a phone meeting.

 - the browser's background HTTPRequest sits in a threaded applet
 - someone switches on "collaboration" in his browser - the others see
   his name being added to the "virtual meeting"
 - one user drags a pointer (image) in his browser -> the pointer moves
   in the other browsers

See also some A's to your Q's, below.
Harald


On 5/26/05, Tibi Dondera <incoming@pronet-romania.com> wrote:
> Hello all,
> 
> I'm trying to develop a chat application through a browser, using
> twisted (if possible)
> What I want to do:
>  - a user logs in the website
>  - he goes to the "chat page"
>  - he has the "classic" chat interface (sent messages, list of online
> users, "send a message" field). All of these are simple "divs"
>  - when he sends a message, a post with the message is submitted to the
> server, and registered in a temporary database table (or in memory, is
> there some "temporary" memory that I can use in twisted for this purpose
> ?)
>  - for refreshing the chat area, there is an open HTTPRequest in the
> background. Twisted will do the following:
>      - accept the HTTPrequest connection
>      - keep it alive (i.e. do not send the answer, but maybe send some
> empty chars to force the browser to keep the connection open)
>      - when a new message (from the other users) is available, send it
> to the user and close the connection.
>  - in the user's browser, when the connection is closed (either with a
> message, or after a certain timeout, that cannot be avoided anyway), a
> new one will be opened, until the user quits the chat.
> 
> Questions:
> - Is this a plausible solution ?

Yes, IMHO.

> - Has this already been implemented (or at least partly) ?
> - Can this actually be done with twisted ?

Yes.

> - Can I develop this on Windows ? (production will be on linux, but
> still, I prefer developing local, and currently on windows)

Hmm.. I develop "on Windows", but with a VMWare Linux server on the
same laptop. Works great, but costs a bit. Should work with the server
on Windows, too(?)

> - Can you give me any pointers to some existing code, or where to start
> ? (maybe jabber for twisted ?)

Here's a few fragments from my server code -

class Servlet(resource.Resource):
    ...
# Send queued output to browser's background listener
    def render_GET(self, request):
        self.request = request
        session = request.getSession()
    ...
        anything = 0
        while not session.outqueue.empty():
            x = session.outqueue.get()
            request.transport.write(x)
            anything = 1
        if anything:
            request.finish()
        return server.NOT_DONE_YET
 
    def render_POST(self, request):  
        session = request.getSession()
# Browser sends a dictionary as text
        msgDict = eval(request.args['message'][0])
        request.finish()
        
        message = msgDict['message']
        mSplit = message.split()
        ... # Do work here
        return server.NOT_DONE_YET

> - How will a twisted http server coexist with my existing apache server
> on the 80 port ?

Not well, I guess. I use a different port for the Twisted server.

> - Must I subscribe to the twisted-http mailing list instead and ask this
> question there ?

Twisted-web would be better, yes. I'm posting this one there too, with all
due apologies...

> 
> Thanks for any help.
> 
> Tibi Dondera



_______________________________________________
Twisted-Python mailing list
Twisted-Python@twistedmatrix.com
http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-python

From maoy+twisted at cis.upenn.edu  Sat May 28 20:13:19 2005
From: maoy+twisted at cis.upenn.edu (Yun Mao)
Date: Sat May 28 20:13:28 2005
Subject: [Twisted-web] Nevow upgrading trouble 2.0 ->4.1
Message-ID: <Pine.LNX.4.61.0505282205200.3601@forty-thieves.cis.upenn.edu>

The following template doesn't work any more (worked with 2.0). In 
particular, my own render_status() and render_message() don't get called 
any more. This was my first and only nevow program. So, my relevant 
knowledge is quite limited. Is there any major changes between those 
versions? Any suggestions will be appreciated!!

Yun

=====begin HTML template========
<table border="0" cellspacing="1" width="90%">
   <tr>
     <td class="grey" width="5%">ID</td>
<!--
     <td class="grey" align="center">sessionID</td>
-->
     <td class="grey" align="center">remote host</td>
     <td class="grey" align="center">home agent</td>
     <td class="grey" align="center">status</td>
     <td class="grey" align="center">messages</td>
     <td class="grey" align="center">last error</td>
     <td class="grey" align="center" width="10%">
       <a nevow:data="globalSSLOption" href="?switchSSL=-1" 
nevow:render="string"
     title="Click to switch smart SSL option">SSL</a></td>
   </tr>
   <span nevow:data="session" nevow:render="sequence">
   <tr nevow:pattern="item" nevow:render="mymapping">
     <td class="blue"><nevow:slot name="myID" /></td>
     <td class="blue"><nevow:slot name="remotehost" /></td>
     <td class="blue"><nevow:slot name="homeagent" /></td>
     <td class="blue" align="center"><a nevow:pattern="status" 
nevow:render="status">running</a></td>
     <td class="blue"><a nevow:pattern="messageItem" nevow:render="message" 
href="?"> message</a>
     </td>
     <td class="blue"><nevow:slot name="error" /></td>
 	<td class="blue" align="center"><a nevow:pattern="SSLOption" 
nevow:render="SSLOption">Disabled</a></td>
   </tr>
   </span>
</table>
======END html template=========


From daverz at gmail.com  Sat May 28 21:17:26 2005
From: daverz at gmail.com (Dave Cook)
Date: Sat May 28 21:17:59 2005
Subject: [Twisted-web] Nevow upgrading trouble 2.0 ->4.1
In-Reply-To: <Pine.LNX.4.61.0505282205200.3601@forty-thieves.cis.upenn.edu>
References: <Pine.LNX.4.61.0505282205200.3601@forty-thieves.cis.upenn.edu>
Message-ID: <7a59f0250505282017587b35d0@mail.gmail.com>

On 5/28/05, Yun Mao <maoy+twisted@cis.upenn.edu> wrote:

> The following template doesn't work any more (worked with 2.0). In
> particular, my own render_status() and render_message() don't get called
> any more. This was my first and only nevow program. So, my relevant
> knowledge is quite limited. Is there any major changes between those
> versions? Any suggestions will be appreciated!!

What does your Page class look like?

Dave Cook

From maoy+twisted at cis.upenn.edu  Sat May 28 21:56:09 2005
From: maoy+twisted at cis.upenn.edu (Yun Mao)
Date: Sat May 28 21:56:14 2005
Subject: [Twisted-web] Nevow upgrading trouble 2.0 ->4.1
In-Reply-To: <7a59f0250505282017587b35d0@mail.gmail.com>
References: <Pine.LNX.4.61.0505282205200.3601@forty-thieves.cis.upenn.edu>
	<7a59f0250505282017587b35d0@mail.gmail.com>
Message-ID: <Pine.LNX.4.61.0505282351050.3601@forty-thieves.cis.upenn.edu>

This is part of it (locateChild omitted). Thanks.

Yun
==============
class SessionRoot(rend.Page):
     docFactory = loaders.htmlfile(
         templateDir = os.path.join(getAbsResourcePath(),'template'),
         template ='session.html')
     child_css = 
static.File(os.path.join(getAbsResourcePath(),'template/css'))
     child_images = 
static.File(os.path.join(getAbsResourcePath(),'template/images'))

     viewall = False # view all sessions or not

     def data_nAllSessions(self, context, data):
         return len(smanager.socks.items())
     def data_nActiveSessions(self, context, data):
         count = 0
         for k,v in smanager.socks.items():
             if v.state!="ended": count += 1
         return count
     def data_haSelection(self, context, data):
         return smanager.ha_selection
     def data_globalSSLOption(self, context, data):
         return "SSL(%s)" % (smanager.smartSSL)

     def data_session(self, context, data):
         #print inevow.IRequest(context).args

         result = []
         for k,v in smanager.socks.items():
             if not self.viewall:
                 if v.state=="ended": continue
             x = {}
             x['value'] = v
             x['myID'] = v.myID
             x['sessionID'] = v.getSessionID()
             x['remotehost'] = "%s:%s" % (v.realserver, v.realport)
             x['homeagent'] = v.getHomeAgent()

             x['status'] = v.getSessionState()
             x['message'] = v.infolog.getLatestInfo()
             x['error'] = v.errinfo
             result.append(x)
         return result

     def render_mymapping(self, context, data):
         mylog(3, 'hey!, in mymapping %s'% (str(data)))
         for k, v in data.items():
             context.fillSlots(k, v)
         return context.tag

     def render_status(self, context, data):
         mylog(3, 'hey!, in status %s'% (data['status']))

         tag = context.tag.clear()
         if data['value'].state!="ended":
             tag.attributes['href'] = "?adapt=%d" % data['myID']
             tag.attributes['title']="Click to do adaptation for session 
%d" % data['myID']

         tag.children.append(data['status'])
         return tag

     def render_message(self, context, data):
         tag = context.tag.clear()
         tag.attributes['href'] = 
here.child('msg').child(str(data['myID']))
         tag.attributes['title'] = "Click to see the detailed messages"
         msg = data['message']
         if len(msg)>43:
             msg = msg[:40]+"..."
         tag.children.append(msg)
         return tag

     def render_SSLOption(self, context, data):
         tag = context.tag.clear()
         msg = data['value'].isSSLEnabled() and "Enabled" or "Disabled"
         if data['value'].state!="ended":
             tag.attributes['href'] = "?switchSSL=%d" % data['myID']
             tag.attributes['title']="Click to %s SSL" %\
                                      (data['value'].isSSLEnabled() and 
"disable" or "enable")
         tag.children.append(msg)
         return tag
==========

On Sat, 28 May 2005, Dave Cook wrote:

> What does your Page class look like?
>
> Dave Cook

From daverz at gmail.com  Sat May 28 22:12:25 2005
From: daverz at gmail.com (Dave Cook)
Date: Sat May 28 22:12:57 2005
Subject: [Twisted-web] Nevow upgrading trouble 2.0 ->4.1
In-Reply-To: <Pine.LNX.4.61.0505282205200.3601@forty-thieves.cis.upenn.edu>
References: <Pine.LNX.4.61.0505282205200.3601@forty-thieves.cis.upenn.edu>
Message-ID: <7a59f02505052821126d8a0024@mail.gmail.com>

On 5/28/05, Yun Mao <maoy+twisted@cis.upenn.edu> wrote:

> nevow:render="status">running</a></td>
>      <td class="blue"><a nevow:pattern="messageItem" nevow:render="message"

I don't know if having both a pattern and a render method defined
causes a problem, but since you don't use this as a pattern, I'd just
leave that out and only include nevow:render="message".

Dave Cook

From maoy+twisted at cis.upenn.edu  Sat May 28 22:36:59 2005
From: maoy+twisted at cis.upenn.edu (Yun Mao)
Date: Sat May 28 22:37:10 2005
Subject: [Twisted-web] Nevow upgrading trouble 2.0 ->4.1
In-Reply-To: <7a59f02505052821126d8a0024@mail.gmail.com>
References: <Pine.LNX.4.61.0505282205200.3601@forty-thieves.cis.upenn.edu>
	<7a59f02505052821126d8a0024@mail.gmail.com>
Message-ID: <Pine.LNX.4.61.0505290033260.6771@forty-thieves.cis.upenn.edu>

Wonderful, problem solved! Thanks!!

Yun

BTW1, I just realized that I messed up with the versions -- they are 0.2 
and 0.4.1 respectively. But it seems to have caused no confusion yet. :)

BTW2, is it a "feature" of 0.2 or a bug of 0.4.1?

On Sat, 28 May 2005, Dave Cook wrote:

> On 5/28/05, Yun Mao <maoy+twisted@cis.upenn.edu> wrote:
>
>> nevow:render="status">running</a></td>
>>      <td class="blue"><a nevow:pattern="messageItem" nevow:render="message"
>
> I don't know if having both a pattern and a render method defined
> causes a problem, but since you don't use this as a pattern, I'd just
> leave that out and only include nevow:render="message".
>
> Dave Cook
>
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>

From matt at pollenation.net  Sun May 29 03:08:26 2005
From: matt at pollenation.net (Matt Goodall)
Date: Sun May 29 03:08:33 2005
Subject: [Twisted-web] Nevow upgrading trouble 2.0 ->4.1
In-Reply-To: <Pine.LNX.4.61.0505290033260.6771@forty-thieves.cis.upenn.edu>
References: <Pine.LNX.4.61.0505282205200.3601@forty-thieves.cis.upenn.edu>	<7a59f02505052821126d8a0024@mail.gmail.com>
	<Pine.LNX.4.61.0505290033260.6771@forty-thieves.cis.upenn.edu>
Message-ID: <4299868A.9060200@pollenation.net>

Yun Mao wrote:
> Wonderful, problem solved! Thanks!!
> 
> Yun
> 
> BTW1, I just realized that I messed up with the versions -- they are 0.2
> and 0.4.1 respectively. But it seems to have caused no confusion yet. :)
> 
> BTW2, is it a "feature" of 0.2 or a bug of 0.4.1?

It's ok to have a pattern and a render attribute on an element - it's
something you'll use when rendering sequence items quite often, i.e.

  <ul nevow:data="numbers" nevow:render="sequence">
    <li nevow:pattern="item" nevow:render="data">NUMBER GOES HERE</li>
  </ul>

The difference between 0.2 and 0.4.1 (I think it changed in 0.3
actually) is that patterned elements are automatically removed from the
page; unless they're found and used by a renderer, of course.

Cheers, Matt


> 
> On Sat, 28 May 2005, Dave Cook wrote:
> 
>> On 5/28/05, Yun Mao <maoy+twisted@cis.upenn.edu> wrote:
>>
>>> nevow:render="status">running</a></td>
>>>      <td class="blue"><a nevow:pattern="messageItem"
>>> nevow:render="message"
>>
>>
>> I don't know if having both a pattern and a render method defined
>> causes a problem, but since you don't use this as a pattern, I'd just
>> leave that out and only include nevow:render="message".
>>
>> Dave Cook
>>
>> _______________________________________________
>> Twisted-web mailing list
>> Twisted-web@twistedmatrix.com
>> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>>
> 
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web


-- 
     __
    /  \__     Matt Goodall, Pollenation Internet Ltd
    \__/  \    w: http://www.pollenation.net
  __/  \__/    e: matt@pollenation.net
 /  \__/  \    t: +44 (0)113 2252500
 \__/  \__/
 /  \	       Any views expressed are my own and do not necessarily
 \__/          reflect the views of my employer.

From dialtone at divmod.com  Sun May 29 03:08:17 2005
From: dialtone at divmod.com (Valentino Volonghi aka Dialtone)
Date: Sun May 29 03:08:37 2005
Subject: [Twisted-web] Nevow upgrading trouble 2.0 ->4.1
In-Reply-To: <Pine.LNX.4.61.0505282351050.3601@forty-thieves.cis.upenn.edu>
References: <Pine.LNX.4.61.0505282205200.3601@forty-thieves.cis.upenn.edu>	<7a59f0250505282017587b35d0@mail.gmail.com>
	<Pine.LNX.4.61.0505282351050.3601@forty-thieves.cis.upenn.edu>
Message-ID: <42998681.8040603@divmod.com>

Yun Mao wrote:

> This is part of it (locateChild omitted). Thanks.
>
> Yun
> ==============
> class SessionRoot(rend.Page):
>     docFactory = loaders.htmlfile(

DO NOT use htmlfile.
use xmlfile. if you don't have an xhtml template try with tidy and use
the xhtml result.

-- 
Valentino Volonghi aka Dialtone
Now Running MacOSX 10.4.1
Blog: http://vvolonghi.blogspot.com
http://weever.berlios.de


From lilliput at tuxfamily.org  Sun May 29 05:33:54 2005
From: lilliput at tuxfamily.org (Lilliput)
Date: Sun May 29 05:36:09 2005
Subject: [Twisted-web] Proxy Socksv5
In-Reply-To: <1116674197.15816.24.camel@localhost>
References: <1116386662.7931.6.camel@localhost>
	<0CBCC9D2-E06E-4ECE-8BFA-A9EB8C21A708@fuhm.net>
	<51115.10.0.0.9.1116548700.squirrel@www.vorpalcloud.org>
	<1116674197.15816.24.camel@localhost>
Message-ID: <1117366435.3946.2.camel@localhost>


Hello; 

Hi daniel,

Is that possible to contact this person ? I'm really interrested to use
such library it would be really good. 


Thanks 

Fabien


Le samedi 21 mai 2005 ? 12:16 +0100, Lilliput a ?crit :
> Hello
> 
> Le jeudi 19 mai 2005 ? 20:25 -0400, Daniel Henninger a ?crit :
> > One of the folk who uses my jabber transports (pyicq-t and pyaim-t)
> > actually wrote in socks5 support that integrates with twisted.  Perhaps I
> > should encourage him to submit it to twisted proper?
> > 
> > Daniel
> > 
> 
> It would be really great. I am looking for this lib since a bit;
> Would be a pleasure to be a tester.
> 
> 
> Regards
> 
> 
> 
-- 
  _
 ( >-     Fabien Bourdaire
 /~\      http://www.saycure.com/contact/                                             
|  \)                                                               
 \_|_     http://www.saycure.com


From mordaha at gmail.com  Sun May 29 06:42:30 2005
From: mordaha at gmail.com (Little)
Date: Sun May 29 06:43:05 2005
Subject: [Twisted-web] HELP! Formless and default values of a widgets
Message-ID: <899dbb7050529054273a83124@mail.gmail.com>

How can i set default value to a widget, if it must be looked up from a 
database?
 


---
class ISomething(annotate.TypedInterface):

def doSomething(
self,
ctx = annotate.Context(),
foo = annotate.String(*default="this string must be taked from a database at 
render time"*),
):
"""Do Something Really Exciting
---
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-web/attachments/20050529/e9557086/attachment.htm
From mordaha at gmail.com  Sun May 29 07:22:57 2005
From: mordaha at gmail.com (Little)
Date: Sun May 29 07:23:45 2005
Subject: [Twisted-web] Re: HELP! Formless and default values of a widgets
In-Reply-To: <899dbb7050529054273a83124@mail.gmail.com>
References: <899dbb7050529054273a83124@mail.gmail.com>
Message-ID: <899dbb705052906223800e2c9@mail.gmail.com>

Sorry, i got an answer in webform.renderForms doc-string :)
 Nevov is da best :)

 On 5/29/05, Little <mordaha@gmail.com> wrote: 
> 
> 
> How can i set default value to a widget, if it must be looked up from a 
> database?
>  
> 
> 
> ---
> class ISomething(annotate.TypedInterface):
> 
> def doSomething(
> self,
> ctx = annotate.Context(),
> foo = annotate.String(*default="this string must be taked from a database 
> at render time" *),
> ):
> """Do Something Really Exciting
> ---
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-web/attachments/20050529/65fc822f/attachment-0001.htm
From daverz at gmail.com  Sun May 29 08:29:18 2005
From: daverz at gmail.com (Dave Cook)
Date: Sun May 29 08:29:51 2005
Subject: [Twisted-web] Re: HELP! Formless and default values of a widgets
In-Reply-To: <899dbb705052906223800e2c9@mail.gmail.com>
References: <899dbb7050529054273a83124@mail.gmail.com>
	<899dbb705052906223800e2c9@mail.gmail.com>
Message-ID: <7a59f025050529072975d9be47@mail.gmail.com>

On 5/29/05, Little <mordaha@gmail.com> wrote:
> Sorry, i got an answer in webform.renderForms doc-string :) 
> Nevov is da best :)

What was the answer?

I use something like this:

    def setDefaults(self, ctx, data):
        formDefaults = ctx.locate(iformless.IFormDefaults)
        defaults = formDefaults.getAllDefaults(myFormName)
        for key, value in data: # my data is a sequence of tuples
             defaults[key] = value

Which seems pretty clunky.  What happened to MVC?

Dave Cook

From jadestorm at nc.rr.com  Sun May 29 08:31:22 2005
From: jadestorm at nc.rr.com (Daniel Henninger)
Date: Sun May 29 08:31:20 2005
Subject: [Twisted-web] Proxy Socksv5
In-Reply-To: <1117366435.3946.2.camel@localhost>
References: <1116386662.7931.6.camel@localhost>
	<0CBCC9D2-E06E-4ECE-8BFA-A9EB8C21A708@fuhm.net>
	<51115.10.0.0.9.1116548700.squirrel@www.vorpalcloud.org>
	<1116674197.15816.24.camel@localhost>
	<1117366435.3946.2.camel@localhost>
Message-ID: <54094.10.0.0.9.1117377082.squirrel@www.vorpalcloud.org>

I have been trying to get a hold of the person who did the work to see if
it's cool with them if I share their email address.  =)  Stay tuned.

Daniel

-- 
"The most addictive drug in the world is music."
     - The Lost Boyz

>
> Hello;
>
> Hi daniel,
>
> Is that possible to contact this person ? I'm really interrested to use
> such library it would be really good.
>
>
> Thanks
>
> Fabien
>
>
> Le samedi 21 mai 2005 ? 12:16 +0100, Lilliput a ?crit :
>> Hello
>>
>> Le jeudi 19 mai 2005 ? 20:25 -0400, Daniel Henninger a ?crit :
>> > One of the folk who uses my jabber transports (pyicq-t and pyaim-t)
>> > actually wrote in socks5 support that integrates with twisted.
>> Perhaps I
>> > should encourage him to submit it to twisted proper?
>> >
>> > Daniel
>> >
>>
>> It would be really great. I am looking for this lib since a bit;
>> Would be a pleasure to be a tester.
>>
>>
>> Regards
>>
>>
>>
> --
>   _
>  ( >-     Fabien Bourdaire
>  /~\      http://www.saycure.com/contact/
> |  \)
>  \_|_     http://www.saycure.com
>
>
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>
>
>



From therve at free.fr  Mon May 30 15:17:08 2005
From: therve at free.fr (Thomas HERVE)
Date: Mon May 30 15:18:15 2005
Subject: [Twisted-web] Livepage, ClientHandle and context
Message-ID: <20050530231708.olbnwr9uqrk00w8g@itchy.wasabout.net>

I've just started to use nevow i18n and I'm pretty happy with it, it works very
well and the automatic detection of browser language is invisible.

But my app uses livepage a lot, and I began to face problems when trying to
translate strings in "dynamic renderers". After some investigations, I found my
problem : i18n uses the i18nconfig saved in context to translate strings,  but
livepage.ClientHandle makes a new "fake" context for each calls via the
livepage.flt function.

I resolved my problem by creating my ClientHandle and ClientHandleFactory
implementations, the ClientHandle saving the context at its creation (pretty
easy, but I would have found it cleaner if clientHandleFactory was a class
variable of LivePage, Input and Output, and not a module global). Thus, the
i18nconfig remains in context.

My question is : is this choice good, or is there a good reason for ClientHandle
not to keep track of the context ? If not, wouldn't it be better to save context
in ClientHandle (it would useful for others things, getting session for example)
?


-- 
Thomas

From dialtone at divmod.com  Mon May 30 16:30:59 2005
From: dialtone at divmod.com (Valentino Volonghi aka Dialtone)
Date: Mon May 30 16:31:04 2005
Subject: [Twisted-web] Livepage, ClientHandle and context
In-Reply-To: <20050530231708.olbnwr9uqrk00w8g@itchy.wasabout.net>
References: <20050530231708.olbnwr9uqrk00w8g@itchy.wasabout.net>
Message-ID: <429B9423.2000700@divmod.com>

Thomas HERVE wrote:

>I resolved my problem by creating my ClientHandle and ClientHandleFactory
>implementations, the ClientHandle saving the context at its creation (pretty
>easy, but I would have found it cleaner if clientHandleFactory was a class
>variable of LivePage, Input and Output, and not a module global). Thus, the
>i18nconfig remains in context.
>
>My question is : is this choice good, or is there a good reason for ClientHandle
>not to keep track of the context ? If not, wouldn't it be better to save context
>in ClientHandle (it would useful for others things, getting session for example)
>?
>  
>
Or you can use closures and have the outer context stored in the closure
hence you will be able to use it
in the handler without requiring anything from the livepage.flt context

-- 
Valentino Volonghi aka Dialtone
Now Running MacOSX 10.4.1
Blog: http://vvolonghi.blogspot.com
http://weever.berlios.de


From dp at ulaluma.com  Mon May 30 17:31:33 2005
From: dp at ulaluma.com (Donovan Preston)
Date: Mon May 30 17:31:38 2005
Subject: [Twisted-web] Livepage, ClientHandle and context
In-Reply-To: <20050530231708.olbnwr9uqrk00w8g@itchy.wasabout.net>
References: <20050530231708.olbnwr9uqrk00w8g@itchy.wasabout.net>
Message-ID: <FC55D47E-6FBF-4103-9C5F-E9D117CC16CE@ulaluma.com>


On May 30, 2005, at 2:17 PM, Thomas HERVE wrote:

> I've just started to use nevow i18n and I'm pretty happy with it,  
> it works very
> well and the automatic detection of browser language is invisible.
>
> But my app uses livepage a lot, and I began to face problems when  
> trying to
> translate strings in "dynamic renderers". After some  
> investigations, I found my
> problem : i18n uses the i18nconfig saved in context to translate  
> strings,  but
> livepage.ClientHandle makes a new "fake" context for each calls via  
> the
> livepage.flt function.
>
> I resolved my problem by creating my ClientHandle and  
> ClientHandleFactory
> implementations, the ClientHandle saving the context at its  
> creation (pretty
> easy, but I would have found it cleaner if clientHandleFactory was  
> a class
> variable of LivePage, Input and Output, and not a module global).  
> Thus, the
> i18nconfig remains in context.
>
> My question is : is this choice good, or is there a good reason for  
> ClientHandle
> not to keep track of the context ? If not, wouldn't it be better to  
> save context
> in ClientHandle (it would useful for others things, getting session  
> for example)
> ?

You should take a look at the branches/dp/livepage-completion- 
notification-3 branch. It includes a lot of refactoring to livepage,  
one of which causes all of the livepage apis to take a  
JavascriptContext object instead of a ClientHandle. To use the  
ClientHandle, you'll have to get it out of the context, like you  
would other objects: IClientHandle(ctx).

This context is hooked up to the context chain from the outputConduit  
or inputConduit HTTP request, so it should be much more useful to  
you. For example, render_ methods should work properly because  
nevow'll be able to find the IRendererFactory (your Page instance,  
usually).

This branch is not yet fully backwards compatible with the previous  
livepage API. sendScript, call, set, and append are not present as  
methods of ClientHandle. Instead, there is a single ClientHandle.send  
method which takes any stan which can be rendered down to javascript.  
For example, IClientHandle(ctx).send(js("any javascript here")) will  
work, as will client.send(livepage.set('foo', 'bar')). I will  
probably add the ClientHandle convenience APIs back soon. They will  
just call send with the appropriate "stan for javascript" object.

In this branch, input handlers can also return javascript which will  
be executed as the response to the input event.

I encourage anyone who is interested in livepage to take a look at  
this branch to see where it is going. Take a look at the examples to  
see what has changed, read the code, and experiment with it. Ask  
questions if you have any. I'll be trying to merge this branch into  
the mainline (after adding some backwards compatibility) in the next  
week.

I'll also be adding some LivePage docs. I think the API will settle  
down after this last round of changes.

dp


From sifu-twisted at 0xx0.net  Tue May 31 02:11:15 2005
From: sifu-twisted at 0xx0.net (Siegmund Fuehringer)
Date: Tue May 31 02:05:03 2005
Subject: [Twisted-web] ReverseProxy subpath
Message-ID: <20050531081115.GC3692@m.0xx0.net>

hi!

i would like to setup a reverse proxy, which serves the root of an 
internal server as '/subpath' of the external server:
http://external.org/subpath -> http://internal.org/
but i can't get it to work.

my current setup requires that the internal server also serves the 
content as '/subpath':

root.putChild( 'subpath', ReverseProxyResource( '127.0.0.1', 6080, 
'/vhost/http/external.org:80/subpath' ) )


is there a way to achieve, what i would like to have?

thank you,
sifu

From qwejohn at hotmail.com  Tue May 31 04:05:39 2005
From: qwejohn at hotmail.com (John Que)
Date: Tue May 31 04:06:12 2005
Subject: [Twisted-web] twisted web and "Method Not Allowed" 
Message-ID: <BAY14-F69457B0E649FE7FD5627DAF040@phx.gbl>

Hello,

  I had posted this question in a different twisted mailing list but did not
got a solution ; I hope that maybe members of this forum can help me
a bit.

I am trying the exmaple in the python docs -
http://twistedmatrix.com/users/warner/doc-latest/web/howto/using-twis...

Configuring and Using the Twisted.Web Server - Twisted Web Development.

it says there:

"You can also create a Site instance by hand, passing it a Resource
object which will serve as the root of the site:

from twisted.web import server, resource
from twisted.internet import reactor

class Simple(resource.Resource):
    isLeaf = True
    def render_GET(self, request):
        return "<html>Hello, world!</html>"

site = server.Site(Simple())
reactor.listenTCP(8080, site)
reactor.run()   "

So I prepared a script named myhttp exactly like this and ran ./myhttp

I had made sure with netstat that indeed port 8080 was free before
running the script and after
running the script it was in a listening state.

But when pointing the Mozilla browser to http://localhost:8080 (or
http://127.0.0.1:8080)
I got the following error:

"Method Not Allowed
Your browser approached me (at /) with the method "GET". I only allow
the method here."

I had also made sure that there in no problem with iptables and that
the iptable service is down.

I had also tried:

telnet localhost 8080
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
GET / HTTP/1.0

And I got this as a response:

HTTP/1.0 405 Method Not Allowed
Date: Tue, 31 May 2005 13:45:29 GMT
Content-length: 242
Content-type: text/html
Allow: ()
Server: TwistedWeb/2.0.0

<html>
        <head><title>405 - Method Not Allowed</title></head>
        <body><h1>Method Not Allowed</h1>
            <p>Your browser approached me (at /) with the method "GET".
I only
allow the method  here.</p>
        </body></html>

Connection closed by foreign host.

Tracing this error shows that this it stems from twisted/web/server.py.
I also tried it on a second machine with the latest stable releases
(TwistedWeb-0.5.0, Twisted-2.0.1 , Python-2.4.1, and
ZopeInterface-3.0.1)
and I got the same error.

I am trying it on RedHat 9 Linux (x386 based).

Any idea ?

Am I missing something?

Any help will be appreciated.

Regards,
John

_________________________________________________________________
Express yourself instantly with MSN Messenger! Download today it's FREE! 
http://messenger.msn.click-url.com/go/onm00200471ave/direct/01/


From therve at free.fr  Tue May 31 13:03:39 2005
From: therve at free.fr (Thomas HERVE)
Date: Tue May 31 13:04:43 2005
Subject: [Twisted-web] Livepage, ClientHandle and context
In-Reply-To: <FC55D47E-6FBF-4103-9C5F-E9D117CC16CE@ulaluma.com>
References: <20050530231708.olbnwr9uqrk00w8g@itchy.wasabout.net>
	<FC55D47E-6FBF-4103-9C5F-E9D117CC16CE@ulaluma.com>
Message-ID: <20050531210339.6yho8a71w4qokwgc@itchy.wasabout.net>

Quoting Donovan Preston <dp@ulaluma.com>:

> You should take a look at the branches/dp/livepage-completion- 
> notification-3 branch. It includes a lot of refactoring to livepage,  
> one of which causes all of the livepage apis to take a  
> JavascriptContext object instead of a ClientHandle. To use the  
> ClientHandle, you'll have to get it out of the context, like you  
> would other objects: IClientHandle(ctx).

Thanks a lot for this pointer, it looks really promising. I like the 
unification
of renders with the context as argument, even if it makes write another 
line to
get client handle.

I'll give it a try as soon as possible for feedback.

-- 
Thomas




From erik at splunktechnology.com  Tue May 31 15:35:55 2005
From: erik at splunktechnology.com (Erik Swan)
Date: Tue May 31 15:36:01 2005
Subject: [Twisted-web] canceling long running soap requests
Message-ID: <EDDB4A01-E177-4665-AAC2-6F07841757C7@splunktechnology.com>

Greetings,

i have a twisted app (v1.3) that makes soap requests to another non- 
twisted server to build pages.
Sometimes these requests can take a long time and i need to provide a  
cancel mechanism that sends a second "cancel" soap message.
In my current implementation the UI is blocked until the request  
completes.

I looked into how to make the SOAP proxy defer my client requests and  
i tried to make a second TCPServer on another port to try and get my  
cancel requests out the door.
Any suggestions on how to best implement?

Kind regards,

e.


. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Erik Swan
Splunk Technology

splunk > Taking the sh out of IT
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-web/attachments/20050531/2ca1c1a1/attachment.htm
