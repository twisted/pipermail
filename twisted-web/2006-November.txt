From phil at bubblehouse.org  Wed Nov  1 09:41:06 2006
From: phil at bubblehouse.org (Phil Christensen)
Date: Wed Nov  1 09:41:21 2006
Subject: [Twisted-web] How to insert an Athena event handler using Stan?
In-Reply-To: <20061031204925.5287.1667927129.divmod.xquotient.6@joule.divmod.com>
References: <20061031204925.5287.1667927129.divmod.xquotient.6@joule.divmod.com>
Message-ID: <736F1901-D7DE-488C-A4B3-67369A92A6EE@bubblehouse.org>

On Oct 31, 2006, at 3:49 PM, glyph@divmod.com wrote:
> On 07:56 pm, exarkun@divmod.com wrote:
> >How does it fail?  Can you throw together a minimal self-contained  
> example?
> >I use this in a lot of places and it works and as far as I  
> understand there
> >is no reason it shouldn't.
>
> Not only does it work, but we are trying to move towards that being  
> the suggested style, as it generally has superior error-handling  
> characteristics.  It would be really nice to get issues with it  
> fixed, and even if this isn't a real problem, document it as a  
> possible "gotcha" so people do not feel uneasy about taking this  
> approach.
>
> So.. got a unit test? :)

I'm not entirely sure how to write a formal unit test that includes  
the javascript side testing, but I've attached a minimal test case to  
a ticket at:

	http://divmod.org/trac/ticket/1704

Basically, it appears that this might be particularly related to key  
events. My example code compares my nonstandard approach to the  
officially sanctioned version, for both text fields and buttons. It  
appears that buttons work properly, but not the text field.

-phil

From mike at mkp.ca  Wed Nov  1 09:50:16 2006
From: mike at mkp.ca (Mike Pelletier)
Date: Wed Nov  1 09:50:29 2006
Subject: [Twisted-web] How to insert an Athena event handler using Stan?
In-Reply-To: <736F1901-D7DE-488C-A4B3-67369A92A6EE@bubblehouse.org>
References: <20061031204925.5287.1667927129.divmod.xquotient.6@joule.divmod.com>
	<736F1901-D7DE-488C-A4B3-67369A92A6EE@bubblehouse.org>
Message-ID: <200611011050.17025.mike@mkp.ca>

On Wednesday 01 November 2006 10:41, Phil Christensen wrote:
> I'm not entirely sure how to write a formal unit test that includes ?
> the javascript side testing, but I've attached a minimal test case to ?
> a ticket at:

But it's so easy!  (Oww, I pulled my sarcastic muscle.)

Here is a tutorial: http://blackjml.livejournal.com/21602.html  I mention only 
for posterity.

Mike.

From phil at bubblehouse.org  Wed Nov  1 10:00:24 2006
From: phil at bubblehouse.org (Phil Christensen)
Date: Wed Nov  1 10:00:42 2006
Subject: [Twisted-web] How to insert an Athena event handler using Stan?
In-Reply-To: <200611011050.17025.mike@mkp.ca>
References: <20061031204925.5287.1667927129.divmod.xquotient.6@joule.divmod.com>
	<736F1901-D7DE-488C-A4B3-67369A92A6EE@bubblehouse.org>
	<200611011050.17025.mike@mkp.ca>
Message-ID: <9288F5B7-5999-409C-87BA-D94E9F4C3C53@bubblehouse.org>

On Nov 1, 2006, at 10:50 AM, Mike Pelletier wrote:
> On Wednesday 01 November 2006 10:41, Phil Christensen wrote:
>> I'm not entirely sure how to write a formal unit test that includes
>> the javascript side testing, but I've attached a minimal test case to
>> a ticket at:
>
> But it's so easy!  (Oww, I pulled my sarcastic muscle.)
>
> Here is a tutorial: http://blackjml.livejournal.com/21602.html  I  
> mention only
> for posterity.

Thanks for the link; I had encountered that in my research, but I  
don't understand how this could be used to test an issue with an  
event handler. This may be just be due to my extremely poor unit  
testing discipline, but any clues would be appreciated!

-phil

From exarkun at divmod.com  Wed Nov  1 10:15:36 2006
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed Nov  1 10:15:39 2006
Subject: [Twisted-web] How to insert an Athena event handler using Stan?
In-Reply-To: <9288F5B7-5999-409C-87BA-D94E9F4C3C53@bubblehouse.org>
Message-ID: <20061101161536.20948.679037719.divmod.quotient.9081@ohm>

On Wed, 1 Nov 2006 11:00:24 -0500, Phil Christensen <phil@bubblehouse.org> wrote:
>On Nov 1, 2006, at 10:50 AM, Mike Pelletier wrote:
>>On Wednesday 01 November 2006 10:41, Phil Christensen wrote:
>>>I'm not entirely sure how to write a formal unit test that includes
>>>the javascript side testing, but I've attached a minimal test case to
>>>a ticket at:
>>
>>But it's so easy!  (Oww, I pulled my sarcastic muscle.)
>>
>>Here is a tutorial: http://blackjml.livejournal.com/21602.html  I  mention 
>>only
>>for posterity.
>
>Thanks for the link; I had encountered that in my research, but I  don't 
>understand how this could be used to test an issue with an  event handler. 
>This may be just be due to my extremely poor unit  testing discipline, but 
>any clues would be appreciated!

Testing anything related to events is tricky, due to security controls
imposed on page JavaScript.  There's probably a way to deal with it, but
it hasn't been documented or codified in Athena yet.

The issue with the handler you showed me is most likely that the handler
thinks its first argument is an event, but it is actually a node.  There is
no way to access the event object right now, but I have been considering
just passing it as the next argument.

Jean-Paul

From iacovou at gmail.com  Wed Nov  1 10:53:02 2006
From: iacovou at gmail.com (kgi)
Date: Wed Nov  1 10:53:14 2006
Subject: [Twisted-web] How to insert an Athena event handler using Stan?
In-Reply-To: <20061031195619.20948.1261871051.divmod.quotient.7775@ohm>
References: <20061031195619.20948.1261871051.divmod.quotient.7775@ohm>
Message-ID: <200611011853.02742.iacovou@gmail.com>

On Tuesday 31 October 2006 21:56, Jean-Paul Calderone wrote:

> How does it fail?  Can you throw together a minimal self-contained example?
> I use this in a lot of places and it works and as far as I understand there
> is no reason it shouldn't.
>
> Jean-Paul

Here you go. At least, I hope I haven't broken it in some other way while 
whittling it down.

twistd -noy stuff.py, then browse to http://localhost:8080

stuff.py as it stands it doesn't work. However, edit line 48 of stuff.py to 
read:

    docFactory = docFactoryJS

instead of

    docFactory = docFactoryAthena

and it starts working.

I'm fully prepared for the possibility of eating humble pie over some typo, 
but if it is a typo, my eyes are incapable of seeing it :-)

Regards,

Ricky
-------------- next part --------------
A non-text attachment was scrubbed...
Name: example.tar
Type: application/x-tar
Size: 10240 bytes
Desc: not available
Url : http://twistedmatrix.com/pipermail/twisted-web/attachments/20061101/d2ac3c15/example-0001.tar
From iacovou at gmail.com  Wed Nov  1 11:05:38 2006
From: iacovou at gmail.com (kgi)
Date: Wed Nov  1 11:05:47 2006
Subject: [Twisted-web] How to insert an Athena event handler using Stan?
In-Reply-To: <20061101161536.20948.679037719.divmod.quotient.9081@ohm>
References: <20061101161536.20948.679037719.divmod.quotient.9081@ohm>
Message-ID: <200611011905.38449.iacovou@gmail.com>

On Wednesday 01 November 2006 18:15, Jean-Paul Calderone wrote:
> The issue with the handler you showed me is most likely that the handler
> thinks its first argument is an event, but it is actually a node.  There is
> no way to access the event object right now, but I have been considering
> just passing it as the next argument.

Darn, I only just now saw that there were more emails in this thread since I 
started to compose my example. That's probably the cause of the problem.

So, is:

  function doFoo ( self, node )

currently the canonical prototype for all athena event handlers, without 
exception?

Regards,

Ricky

From exarkun at divmod.com  Wed Nov  1 11:40:48 2006
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Wed Nov  1 11:40:54 2006
Subject: [Twisted-web] How to insert an Athena event handler using Stan?
In-Reply-To: <200611011905.38449.iacovou@gmail.com>
Message-ID: <20061101174048.20948.2075413986.divmod.quotient.9191@ohm>

On Wed, 1 Nov 2006 19:05:38 +0200, kgi <iacovou@gmail.com> wrote:
>On Wednesday 01 November 2006 18:15, Jean-Paul Calderone wrote:
>> The issue with the handler you showed me is most likely that the handler
>> thinks its first argument is an event, but it is actually a node.  There is
>> no way to access the event object right now, but I have been considering
>> just passing it as the next argument.
>
>Darn, I only just now saw that there were more emails in this thread since I
>started to compose my example. That's probably the cause of the problem.
>
>So, is:
>
>  function doFoo ( self, node )
>
>currently the canonical prototype for all athena event handlers, without
>exception?

Yes, though this may shortly change to

  function doFoo(self, node, event)

(which is completely backwards compatible, of course, due to the magic of
javascript sucking so much).

Jean-Paul

From nacho at kth.se  Thu Nov  9 02:20:22 2006
From: nacho at kth.se (Ignacio Mas Ivars)
Date: Thu Nov  9 02:20:49 2006
Subject: [Twisted-web] Namespace in 200 OK response from SOAP server?
Message-ID: <1163060422.5655.0.camel@localhost.localdomain>


Hi all, 
I am having a problem with a SOAP server, because the answer I am
sending does not include the namespace that comes with the request.

This is the full interaction of my server using a test python client:

POST /SOAP HTTP/1.0
Host: 127.0.0.1
User-Agent: Twisted PageGetter
Content-Length: 734
SOAPAction: get_media_URL
content-type: text/xml
connection: close

<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope
SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"
xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/"
xmlns:xsi="http://www.w3.org/1999/XMLSchema-instance"
xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/1999/XMLSchema">
<SOAP-ENV:Body>
<ns1:get_media_URL xmlns:ns1="urn:ms" SOAP-ENC:root="1">
<v1 xsi:type="xsd:string">MyContent</ns1:get_media_URL>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope>

HTTP/1.0 200 OK
Date: Wed, 08 Nov 2006 16:12:50 GMT
Content-length: 550
Content-type: text/xml; charset="UTF-8"
Server: TwistedWeb/2.4.0

<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope
SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"
xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/"
xmlns:xsi="http://www.w3.org/1999/XMLSchema-instance"
xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/1999/XMLSchema">
<SOAP-ENV:Body>
<get_media_URLResponse SOAP-ENC:root="1">
<Result xsi:type="xsd:string">Result</Result>
</get_media_URLResponse>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope>

The problem is that the real SOAP client that sends the request is
expecting an answer that contains the namespace as well, so that the
answer should be:

<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope
SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"
xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/"
xmlns:xsi="http://www.w3.org/1999/XMLSchema-instance"
xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/1999/XMLSchema">
<SOAP-ENV:Body>
<ns1:get_media_URLResponse xmlns:ns1="urn:ms" SOAP-ENC:root="1">
<Result xsi:type="xsd:string">Result</Result>
</ns1:get_media_URLResponse>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope>

The code of my server is as simple as:

def getQuote():
    return "Result"

class SOAPListener(soap.SOAPPublisher):
def __init__(self):
print "SM controller started"

def soap_get_media_URL(self, message):
        print "Got: ", message
        return getQuote()

def main():
    from twisted.internet import reactor
    root = resource.Resource()
    root.putChild('SOAP', SOAPListener())
    reactor.listenTCP(8080, server.Site(root))
    reactor.run()

if __name__ == '__main__':
    main()


Now, how can I force the server to answer back with the proper
namespace? The client refuses to understand the message back
otherwise... Any help will be greatly appreciated!

Thanks,
/Nacho

---
       ,,,
      (o o)
--ooO--(_)---Ooo-----------
Why get your news from seasoned professionals when you can get
half-witted rumors from random strangers [on the Internet]?-Joel
Achenbach 
--oo0--------0oo-----------




From joe.kim at gmail.com  Sat Nov 11 13:06:07 2006
From: joe.kim at gmail.com (joe kim)
Date: Sat Nov 11 13:06:14 2006
Subject: [Twisted-web] Implementing hanging get with twisted web
Message-ID: <35379c520611111106w7966e241t44c96f3369d3d859@mail.gmail.com>

Hi all,

I had a question about implementing hanging-gets.  A hanging get is
basically when the server "hangs" onto the http request until either a
certain period of time or until there is an event is triggered.  It is
a hack for implementing event driven messaging on top of HTTP.

Alex Russell references it in his blog:  http://alex.dojotoolkit.org/?p=545

What's the best way to implement hanging-gets using twisted?  I have a
web page that I want to immediately update everytime there is a change
to the data.  Making asynchronous javascript requests every second do
not really make sense, but I was thinking that if the javascript
continually made asynchronous requests to the server and the server
implemented hanging-gets, then that would be a good solution.

Any thoughts are appreciated.

Cheers,
Joe

From exarkun at divmod.com  Sat Nov 11 13:16:13 2006
From: exarkun at divmod.com (Jean-Paul Calderone)
Date: Sat Nov 11 13:16:17 2006
Subject: [Twisted-web] Implementing hanging get with twisted web
In-Reply-To: <35379c520611111106w7966e241t44c96f3369d3d859@mail.gmail.com>
Message-ID: <20061111191613.20948.985380715.divmod.quotient.23183@ohm>

On Sat, 11 Nov 2006 11:06:07 -0800, joe kim <joe.kim@gmail.com> wrote:
>Hi all,
>
>I had a question about implementing hanging-gets.  A hanging get is
>basically when the server "hangs" onto the http request until either a
>certain period of time or until there is an event is triggered.  It is
>a hack for implementing event driven messaging on top of HTTP.
>
>Alex Russell references it in his blog:  http://alex.dojotoolkit.org/?p=545
>
>What's the best way to implement hanging-gets using twisted?  I have a
>web page that I want to immediately update everytime there is a change
>to the data.  Making asynchronous javascript requests every second do
>not really make sense, but I was thinking that if the javascript
>continually made asynchronous requests to the server and the server
>implemented hanging-gets, then that would be a good solution.
>
>Any thoughts are appreciated.

See http://divmod.org/trac/wiki/DivmodNevow/Athena

The basic mechanism in twisted.web which this relies on is a renderHTTP
method which returns NOT_DONE_YET and arranges for request.finish() to
be called at some later time.

Jean-Paul

From joe.kim at gmail.com  Sun Nov 12 00:38:45 2006
From: joe.kim at gmail.com (joe kim)
Date: Sun Nov 12 00:38:49 2006
Subject: [Twisted-web] Implementing hanging get with twisted web
In-Reply-To: <20061111191613.20948.985380715.divmod.quotient.23183@ohm>
References: <35379c520611111106w7966e241t44c96f3369d3d859@mail.gmail.com>
	<20061111191613.20948.985380715.divmod.quotient.23183@ohm>
Message-ID: <35379c520611112238k4a7a69b3r8b3e3a14ccd44432@mail.gmail.com>

On 11/11/06, Jean-Paul Calderone <exarkun@divmod.com> wrote:
> On Sat, 11 Nov 2006 11:06:07 -0800, joe kim <joe.kim@gmail.com> wrote:
> >Hi all,
> >
> >I had a question about implementing hanging-gets.  A hanging get is
> >basically when the server "hangs" onto the http request until either a
> >certain period of time or until there is an event is triggered.  It is
> >a hack for implementing event driven messaging on top of HTTP.
> >
> >Alex Russell references it in his blog:  http://alex.dojotoolkit.org/?p=545
> >
> >What's the best way to implement hanging-gets using twisted?  I have a
> >web page that I want to immediately update everytime there is a change
> >to the data.  Making asynchronous javascript requests every second do
> >not really make sense, but I was thinking that if the javascript
> >continually made asynchronous requests to the server and the server
> >implemented hanging-gets, then that would be a good solution.
> >
> >Any thoughts are appreciated.
>
> See http://divmod.org/trac/wiki/DivmodNevow/Athena
>
> The basic mechanism in twisted.web which this relies on is a renderHTTP
> method which returns NOT_DONE_YET and arranges for request.finish() to
> be called at some later time.
>
> Jean-Paul
>
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web
>

Thanks for the link. I was using HTTPFactory, HTTPChannel,
http.Request for my implementation.  I have not tried Athena yet.   I
will give it a try.

Joe

From tonys at sterrett.net  Wed Nov 15 22:17:37 2006
From: tonys at sterrett.net (Tony Sterrett)
Date: Wed Nov 15 22:17:57 2006
Subject: [Twisted-web] Question about the Big picture
Message-ID: <99C8DD86-7906-423F-A3BE-03420A93D475@sterrett.net>

I just received a advertisement for a new book "TurboGears", a python  
web application server. There sure are
a lot of these approach/communities focused on python.

So what's the 40k foot view of the menagerie.   (i understand this  
question is a bit abstract).
Also do we have to start saying Turbo again, I was just getting use  
to "Extreme" and "On Steroids"
as in ExtremeGears or Ruby on Steroids :-)

Respectfully,

Tony Sterrett

Sterrett Software, LLC.

Consultant for Open Source Software, Network and Kernel programming,  
featuring OpenBSD and Linux.

www.sterrett.net
(858) 433-1467 San Diego
(408) 705-2135 San Jose




-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-web/attachments/20061115/496ca65c/attachment.htm
From hxianping at gmail.com  Wed Nov 29 01:31:37 2006
From: hxianping at gmail.com (Steve Han)
Date: Wed Nov 29 01:31:48 2006
Subject: [Twisted-web] Why cannot find twisted.web packages?
Message-ID: <702805a90611282331s770de268v26c60a486db58eee@mail.gmail.com>

Hi all,
I am new to twisted and just came this maillist,have not recieved any
mails till now.This is as a test.

My twisted2.0 came with SuSE10.0 installation box.The packages I had
are not the same as those in the documentations of twisted online.

From p.mayers at imperial.ac.uk  Wed Nov 29 07:46:50 2006
From: p.mayers at imperial.ac.uk (Phil Mayers)
Date: Wed Nov 29 07:47:00 2006
Subject: [Twisted-web] reloading nevow templates
Message-ID: <456D8F4A.5080308@imperial.ac.uk>

All,

Do the nevow rend.Page and athena.LivePage co-operate with the 
t.p.u.reload mechanism?

For various reasons I don't want to stop the process to reload the 
changes I've made to disk and .py templates, but would like to be able 
to reload them.

Thoughts?

From therve at free.fr  Wed Nov 29 08:38:02 2006
From: therve at free.fr (Thomas =?iso-8859-1?b?SGVyduk=?=)
Date: Wed Nov 29 08:07:40 2006
Subject: [Twisted-web] reloading nevow templates
In-Reply-To: <456D8F4A.5080308@imperial.ac.uk>
References: <456D8F4A.5080308@imperial.ac.uk>
Message-ID: <1164811082.456d9b4a5437b@imp8-g19.free.fr>

Selon Phil Mayers <p.mayers@imperial.ac.uk>:

> All,
>
> Do the nevow rend.Page and athena.LivePage co-operate with the
> t.p.u.reload mechanism?
>
> For various reasons I don't want to stop the process to reload the
> changes I've made to disk and .py templates, but would like to be able
> to reload them.
>
> Thoughts?

There's an entry in the wiki:

http://divmod.org/users/wiki.twistd/nevow/moin.cgi/ReloadingStan

That hasn't been updated for ages, though.

--
Thomas

From glyph at divmod.com  Wed Nov 29 12:37:50 2006
From: glyph at divmod.com (glyph@divmod.com)
Date: Wed Nov 29 12:42:18 2006
Subject: [Twisted-web] reloading nevow templates
Message-ID: <20061129183750.11053.180053572.divmod.xquotient.817@joule.divmod.com>

On 01:46 pm, p.mayers@imperial.ac.uk wrote:

>Do the nevow rend.Page and athena.LivePage co-operate with the t.p.u.reload 
>mechanism?

No.

>For various reasons I don't want to stop the process to reload the changes 
>I've made to disk and .py templates, but would like to be able to reload 
>them.

Disk templates do not contain python code and therefore do not need to be integrated with t.p.u.rebuild.  They already load automatically based on modification time.

.py files are a much more intricate problem.

>Thoughts?

Rebuild is a nice idea, but a lot more work would need to be done to make it work reliably (or rather, fail gracefully and report sane errors when it *can't* work reliably).  Getting this to work properly really has nothing to do with nevow, although nevow does exacerbate some problems with it.

I'd recommend just manually restarting the server during development for now.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://twistedmatrix.com/pipermail/twisted-web/attachments/20061129/fa7a14d0/attachment.htm
From christian.simms at gmail.com  Wed Nov 29 14:54:38 2006
From: christian.simms at gmail.com (christian simms)
Date: Wed Nov 29 14:54:41 2006
Subject: [Twisted-web] reloading nevow templates
In-Reply-To: <20061129183750.11053.180053572.divmod.xquotient.817@joule.divmod.com>
References: <20061129183750.11053.180053572.divmod.xquotient.817@joule.divmod.com>
Message-ID: <cd8fa6f90611291254y64a361d3yac739dff9ecbb212@mail.gmail.com>

On 11/29/06, glyph@divmod.com <glyph@divmod.com> wrote:
> On 01:46 pm, p.mayers@imperial.ac.uk wrote:
>
> >Do the nevow rend.Page and athena.LivePage co-operate with the t.p.u.reload
> >mechanism?
>
> No.
>
> >For various reasons I don't want to stop the process to reload the changes
> >I've made to disk and .py templates, but would like to be able to reload
> >them.
>
> Disk templates do not contain python code and therefore do not need to be
> integrated with t.p.u.rebuild.  They already load automatically based on
> modification time.
>
> .py files are a much more intricate problem.
>
> >Thoughts?
>
> Rebuild is a nice idea, but a lot more work would need to be done to make it
> work reliably (or rather, fail gracefully and report sane errors when it
> *can't* work reliably).  Getting this to work properly really has nothing to
> do with nevow, although nevow does exacerbate some problems with it.
>
> I'd recommend just manually restarting the server during development for
> now.
>
> _______________________________________________
> Twisted-web mailing list
> Twisted-web@twistedmatrix.com
> http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web

I personally just use the standard Python "reload" function on my
major web modules, then when I hit ctrl-R in my browser it loads the
latest Python code and re-renders the current page using it.  The
major downside with this approach is that you must structure your
Python code in a way that works with reload.  The other potential
gotcha is that reload is really slow and you don't want it in
production code, so I always wrap mine with "if __debug__".

Cheers,
Christian

