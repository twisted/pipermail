<tt>
&lt;br&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;10/11/06,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Jean-Paul&nbsp;Calderone&lt;/b&gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:exarkun@divmod.com&quot;&gt;exarkun@divmod.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
On&nbsp;Wed,&nbsp;11&nbsp;Oct&nbsp;2006&nbsp;12:35:42&nbsp;+0200,&nbsp;Fabio&nbsp;Forno&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:fabio.forno@gmail.com&quot;&gt;fabio.forno@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;&amp;gt;Widgets.ChatWidget&nbsp;=&nbsp;Nevow.Athena.Widget.subclass('Widgets.ChatWidget');&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;<br>
Widgets.ChatWidget.methods(&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;function&nbsp;keyPressed&nbsp;(self,&nbsp;event)&nbsp;{&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if(event.key()[&amp;quot;string&amp;quot;]&nbsp;==&nbsp;&amp;quot;KEY_ENTER&amp;quot;)&nbsp;{&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;text_area&nbsp;=&nbsp;window.document.getElementById<br>
(&amp;quot;chat_area&amp;quot;);&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;d&nbsp;=&nbsp;self.callRemote('got_text',&nbsp;text_area.value);&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;d.addCallback(self.text_sent);&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;&amp;gt;)&lt;/blockquote&gt;&lt;div&gt;&amp;nbsp;[...]&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&amp;gt;&lt;br&gt;&amp;gt;Then&nbsp;in&nbsp;the&nbsp;xml&nbsp;template&nbsp;I&nbsp;try&nbsp;to&nbsp;get&nbsp;a&nbsp;reference&nbsp;to&nbsp;the&nbsp;just&nbsp;defined&lt;br&gt;&amp;gt;method&nbsp;in&nbsp;this&nbsp;way:&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;widget&nbsp;=&nbsp;Nevow.Athena.Widget.get(&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;document.getElementById(&amp;quot;athena:1&amp;quot;);<br>
&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;);&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;widget.keyPressed&lt;br&gt;&lt;br&gt;Likewise,&nbsp;&amp;quot;athena:1&amp;quot;&nbsp;is&nbsp;an&nbsp;implementation&nbsp;detail,&nbsp;and&nbsp;you&nbsp;can't&nbsp;rely&nbsp;on&lt;br&gt;your&nbsp;widget&nbsp;getting&nbsp;id&nbsp;&amp;quot;1&amp;quot;&nbsp;all&nbsp;the&nbsp;time.&amp;nbsp;&amp;nbsp;Instead,&nbsp;try&nbsp;using&nbsp;the&lt;br&gt;<br>
athena:handler&nbsp;feature:&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;div&nbsp;nevow:render=&amp;quot;liveFragment&amp;quot;&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;...&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;textarea&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;athena:handler&nbsp;event=&amp;quot;onkeypress&amp;quot;&nbsp;handler=&amp;quot;keyPressed&amp;quot;&nbsp;/&amp;gt;<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;/textarea&amp;gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;/div&amp;gt;&lt;br&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;The&nbsp;problem&nbsp;is&nbsp;he&nbsp;needs&nbsp;to&nbsp;examine&nbsp;the&nbsp;event&nbsp;details&nbsp;after&nbsp;it's&nbsp;received,&nbsp;and&nbsp;athena:handler&nbsp;only&nbsp;gives&nbsp;the&nbsp;event&nbsp;handler&nbsp;access&nbsp;to&nbsp;the&nbsp;node&nbsp;where&nbsp;it&nbsp;happened,&nbsp;not&nbsp;the&nbsp;event&nbsp;object.<br>
&lt;br&gt;&lt;br&gt;I&nbsp;suggest&nbsp;this:&lt;br&gt;&lt;br&gt;YourNS.YourWidget.methods(&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;function&nbsp;__init__(self,&nbsp;node)&nbsp;{&nbsp;//&nbsp;{{{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;YourNS.YourWidget.upcall(self,&nbsp;'__init__',&nbsp;node);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;DeanEdwards.addEvent(node,&nbsp;'keyPressed',&nbsp;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;function&nbsp;onKeyPressed(event)&nbsp;{&nbsp;return&nbsp;self.onKeyPressed(event)&nbsp;});&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;},&nbsp;//&nbsp;}}}&lt;br&gt;&lt;br&gt;&lt;br&gt;What's&nbsp;DeanEdwards,&nbsp;you&nbsp;ask?&amp;nbsp;&nbsp;&lt;br&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://rafb.net/paste/results/57Orqx27.html&quot;&gt;http://rafb.net/paste/results/57Orqx27.html<br>
&lt;/a&gt;&lt;br&gt;&lt;br&gt;Dean&nbsp;Edwards&nbsp;came&nbsp;up&nbsp;with&nbsp;a&nbsp;nifty&nbsp;cross-browser&nbsp;event&nbsp;handling&nbsp;solution,&nbsp;but&nbsp;there&nbsp;are&nbsp;others&nbsp;that&nbsp;could&nbsp;work&nbsp;here.&amp;nbsp;&nbsp;I&nbsp;adapted&nbsp;his&nbsp;solution&nbsp;to&nbsp;the&nbsp;Divmod&nbsp;namespace&nbsp;style,&nbsp;and&nbsp;added&nbsp;line&nbsp;63&nbsp;so&nbsp;.target&nbsp;and&nbsp;.srcElement&nbsp;mean&nbsp;the&nbsp;same&nbsp;thing.&amp;nbsp;&nbsp;The&nbsp;above&nbsp;URL&nbsp;will&nbsp;rot&nbsp;pretty&nbsp;quickly,&nbsp;so&nbsp;just&nbsp;google&nbsp;for&nbsp;&amp;lt;dean&nbsp;edwards&nbsp;event&nbsp;handling&amp;gt;.<br>
&lt;br&gt;&lt;br&gt;&lt;br&gt;<br>

</tt>
