<tt>
&lt;html&gt;&lt;body&gt;On&nbsp;05:44&nbsp;pm,&nbsp;exarkun@divmod.com&nbsp;wrote:&lt;br&nbsp;/&gt;&amp;gt;On&nbsp;Thu,&nbsp;24&nbsp;May&nbsp;2007&nbsp;18:04:57&nbsp;+0200,&nbsp;Terry&nbsp;Jones&nbsp;&amp;lt;terry@jon.es&amp;gt;&nbsp;wrote:&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&quot;JP&quot;&nbsp;==&nbsp;Jean-Paul&nbsp;Calderone&nbsp;&amp;lt;exarkun@divmod.com&amp;gt;&nbsp;writes:&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;JP&amp;gt;&nbsp;A&nbsp;completely&nbsp;wild&nbsp;guess&nbsp;is&nbsp;that&nbsp;forking&nbsp;is&nbsp;confusing&nbsp;PyLucene&nbsp;in&nbsp;a&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;JP&amp;gt;&nbsp;fatal&nbsp;way.&nbsp;&amp;#160;Are&nbsp;you&nbsp;importing&nbsp;PyLucene&nbsp;in&nbsp;the&nbsp;.tac&nbsp;file&nbsp;itself?&nbsp;&amp;#160;If&nbsp;so,&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;JP&amp;gt;&nbsp;it&nbsp;may&nbsp;help&nbsp;to&nbsp;avoid&nbsp;doing&nbsp;this,&nbsp;so&nbsp;that&nbsp;no&nbsp;code&nbsp;from&nbsp;PyLucene&nbsp;even&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;JP&amp;gt;&nbsp;gets&nbsp;a&nbsp;chance&nbsp;to&nbsp;run&nbsp;until&nbsp;after&nbsp;the&nbsp;process&nbsp;has&nbsp;already&nbsp;daemonized.&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;Hi&nbsp;JP.&nbsp;Thanks&nbsp;for&nbsp;the&nbsp;suggestion.&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;Yes,&nbsp;the&nbsp;PyLucene&nbsp;import&nbsp;does&nbsp;happen&nbsp;as&nbsp;a&nbsp;result&nbsp;of&nbsp;an&nbsp;import&nbsp;in&nbsp;the&nbsp;.tac&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;file.&nbsp;I&nbsp;just&nbsp;made&nbsp;some&nbsp;changes&nbsp;to&nbsp;delay&nbsp;the&nbsp;import&nbsp;until&nbsp;PyLucene&nbsp;is&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;actually&nbsp;needed.&nbsp;That&nbsp;didn't&nbsp;work,&nbsp;and&nbsp;nor&nbsp;did&nbsp;further&nbsp;hiding&nbsp;the&nbsp;import&nbsp;by&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;using&nbsp;__import__.&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;&amp;gt;Is&nbsp;it&nbsp;right&nbsp;that&nbsp;all&nbsp;the&nbsp;-n&nbsp;switch&nbsp;to&nbsp;twistd&nbsp;does&nbsp;is&nbsp;prevent&nbsp;the&nbsp;fork?&lt;br&nbsp;/&gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;It&nbsp;does&nbsp;a&nbsp;couple&nbsp;other&nbsp;minor&nbsp;things,&nbsp;like&nbsp;changing&nbsp;the&nbsp;default&nbsp;logging&nbsp;to&lt;br&nbsp;/&gt;&amp;gt;go&nbsp;to&nbsp;stdout&nbsp;instead&nbsp;of&nbsp;twistd.log,&nbsp;but&nbsp;preventing&nbsp;the&nbsp;fork&nbsp;is&nbsp;the&nbsp;only&nbsp;big&lt;br&nbsp;/&gt;&amp;gt;thing,&nbsp;yes.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;The&nbsp;fork&nbsp;does&nbsp;some&nbsp;other&nbsp;things&nbsp;though,&nbsp;and&nbsp;it's&nbsp;hard&nbsp;to&nbsp;say&nbsp;which&nbsp;one&nbsp;is&nbsp;affecting&nbsp;the&nbsp;execution&nbsp;of&nbsp;your&nbsp;program,&nbsp;especially&nbsp;since&nbsp;PyLucene&nbsp;is&nbsp;doing&nbsp;a&nbsp;bunch&nbsp;of&nbsp;things&nbsp;at&nbsp;the&nbsp;machine-code&nbsp;level&nbsp;which&nbsp;are&nbsp;highly&nbsp;surprising&nbsp;to&nbsp;Python&nbsp;programmers.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;Have&nbsp;you&nbsp;tried&nbsp;running&nbsp;'strace'&nbsp;on&nbsp;this&nbsp;process&nbsp;yet?&lt;/body&gt;&lt;/html&gt;
</tt>
