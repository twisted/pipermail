<tt>
&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&amp;gt;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;client&nbsp;=&nbsp;getPage(url=&amp;#39;&lt;a&nbsp;href=&quot;http://localhost:8080/message_event_notify&quot;&nbsp;target=&quot;_blank&quot;&gt;<br>
http://localhost:8080/message_event_notify&lt;/a&gt;&amp;#39;,&lt;br&gt;&amp;gt;method=&amp;#39;POST&amp;#39;,&lt;br&gt;&amp;gt;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;postdata=urlencode(postdata),&lt;br&gt;&amp;gt;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;headers={&nbsp;&amp;#39;Content-Type&amp;#39;:&nbsp;&amp;#39;application/x-www-form-urlencoded&amp;#39;&nbsp;}<br>
&lt;br&gt;&amp;gt;)&lt;br&gt;&amp;gt;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;client.addCallback(self.success)&lt;br&gt;&amp;gt;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;client.addErrback(self.failure)&lt;br&gt;&amp;gt;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;reactor.run()&lt;br&gt;&amp;gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;You&nbsp;don&amp;#39;t&nbsp;need&nbsp;to&nbsp;call&nbsp;reactor.run()&nbsp;here&nbsp;-&nbsp;the&nbsp;reactor&nbsp;is&nbsp;already&nbsp;running<br>
&lt;br&gt;(that&amp;#39;s&nbsp;how&nbsp;the&nbsp;SMTP&nbsp;server&nbsp;works,&nbsp;after&nbsp;all).&nbsp;&amp;nbsp;In&nbsp;fact,&nbsp;you&nbsp;can&amp;#39;t&nbsp;call&lt;br&gt;reactor.run()&nbsp;here&nbsp;-&nbsp;the&nbsp;reactor&nbsp;mainloop&nbsp;is&nbsp;not&nbsp;reentrant.&lt;br&gt;&lt;br&gt;Instead,&nbsp;you&nbsp;probably&nbsp;want&nbsp;to&nbsp;return&nbsp;the&nbsp;&amp;quot;client&amp;quot;&nbsp;Deferred&nbsp;from&nbsp;eomReceived.<br>
&lt;br&gt;The&nbsp;SMTP&nbsp;protocol&nbsp;code&nbsp;will&nbsp;use&nbsp;that&nbsp;Deferred&nbsp;to&nbsp;know&nbsp;when&nbsp;to&nbsp;indicate&nbsp;to&lt;br&gt;the&nbsp;SMTP&nbsp;client&nbsp;which&nbsp;is&nbsp;talking&nbsp;to&nbsp;it&nbsp;when&nbsp;the&nbsp;message&nbsp;has&nbsp;been&nbsp;delivered&lt;br&gt;successful&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;an&nbsp;error.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;OK,&nbsp;yes&nbsp;that&nbsp;makes&nbsp;sense&nbsp;-&nbsp;it&nbsp;works&nbsp;great&nbsp;with&nbsp;that&nbsp;change.<br>
&lt;br&gt;&lt;br&gt;Thanks&lt;br&gt;James&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
