<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;Creating&nbsp;the&nbsp;session&nbsp;follows&nbsp;the&nbsp;normal&nbsp;Twisted&nbsp;modus&nbsp;operandi--&nbsp;create&nbsp;a&nbsp;factory&nbsp;that&nbsp;returns&nbsp;the&nbsp;actual&nbsp;thing&nbsp;you&nbsp;want&nbsp;and&nbsp;attach&nbsp;the&nbsp;session&nbsp;to&nbsp;your&nbsp;site. &nbsp;I&nbsp;wrote&nbsp;an&nbsp;authenticating&nbsp;web&nbsp;proxy[1]&nbsp;that&nbsp;does&nbsp;just&nbsp;that. &nbsp;If&nbsp;you&nbsp;skim&nbsp;down&nbsp;to&nbsp;the&nbsp;`sessionFactory()`&nbsp;function,&nbsp;you&nbsp;can&nbsp;see&nbsp;it&nbsp;is&nbsp;not&nbsp;overly&nbsp;complicated.&lt;br&gt;&lt;br&gt;&lt;/div&gt;The&nbsp;docs&nbsp;on&nbsp;storing&nbsp;objects&nbsp;in&nbsp;a&nbsp;session[2]&nbsp;are&nbsp;a&nbsp;bit&nbsp;complex. &nbsp;They&nbsp;are&nbsp;basically&nbsp;taking&nbsp;the&nbsp;approach&nbsp;where&nbsp;the&nbsp;idea&nbsp;is&nbsp;when&nbsp;you&nbsp;can&nbsp;`request.getSession()`,&nbsp;you&nbsp;can&nbsp;pass&nbsp;in&nbsp;an&nbsp;interface&nbsp;and&nbsp;get&nbsp;back&nbsp;an&nbsp;object&nbsp;that&nbsp;corresponds&nbsp;to&nbsp;that&nbsp;interface. &nbsp;This&nbsp;can&nbsp;actually&nbsp;be&nbsp;useful&nbsp;in&nbsp;larger&nbsp;systems&nbsp;where&nbsp;you&nbsp;are&nbsp;making&nbsp;use&nbsp;of&nbsp;heavily&nbsp;componentized&nbsp;code,&nbsp;but&nbsp;in&nbsp;some&nbsp;cases&nbsp;it&nbsp;does&nbsp;seem&nbsp;like&nbsp;overkill.&lt;br&gt;&lt;br&gt;&lt;/div&gt;Since&nbsp;the&nbsp;main&nbsp;thing&nbsp;that&nbsp;the&nbsp;stock&nbsp;`Session`&nbsp;buys&nbsp;you&nbsp;is&nbsp;expiration,&nbsp;you&nbsp;can&nbsp;use&nbsp;the&nbsp;`Session.notifyOnExpire()`&nbsp;method&nbsp;to&nbsp;update&nbsp;other&nbsp;data&nbsp;structures. &nbsp;My&nbsp;authenticating&nbsp;proxy&nbsp;took&nbsp;that&nbsp;approach&nbsp;for&nbsp;keeping&nbsp;track&nbsp;of&nbsp;authenticated&nbsp;users&nbsp;(see&nbsp;the&nbsp;&quot;txcasproxy.py&quot;&nbsp;file&nbsp;around&nbsp;the&nbsp;`&lt;span&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;&quot;&gt;_expired`&nbsp;function).&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&nbsp;class=&quot;&quot;&gt;As&nbsp;for&nbsp;persisting&nbsp;session&nbsp;data--&nbsp;I&nbsp;guess&nbsp;the&nbsp;idea&nbsp;is&nbsp;that&nbsp;storing&nbsp;or&nbsp;retrieving&nbsp;the&nbsp;session&nbsp;object&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;async&nbsp;because&nbsp;it&nbsp;is&nbsp;just&nbsp;an&nbsp;object&nbsp;in&nbsp;memory&nbsp;corresponding&nbsp;to&nbsp;a&nbsp;cookie&nbsp;in&nbsp;the&nbsp;request. &nbsp;However,&nbsp;writing&nbsp;to&nbsp;or&nbsp;reading&nbsp;from&nbsp;the&nbsp;session&nbsp;could&nbsp;definitely&nbsp;require&nbsp;async&nbsp;methods&nbsp;that&nbsp;talk&nbsp;to&nbsp;a&nbsp;back&nbsp;end&nbsp;store. &nbsp;This&nbsp;could&nbsp;potentially&nbsp;be&nbsp;one&nbsp;area&nbsp;where&nbsp;implementing&nbsp;a&nbsp;component&nbsp;with&nbsp;an&nbsp;interface&nbsp;like&nbsp;`IRedisSessionStorage`&nbsp;might&nbsp;be&nbsp;useful&nbsp;(get&nbsp;session&nbsp;synchonously&nbsp;from&nbsp;request&nbsp;passing&nbsp;in&nbsp;IRedisStorage, &nbsp;then&nbsp;call&nbsp;`storeThingInSession()`&nbsp;which&nbsp;returns&nbsp;a&nbsp;deferred).&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&nbsp;class=&quot;&quot;&gt;Thanks,&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&nbsp;class=&quot;&quot;&gt;Carl&nbsp;&lt;br&gt;&lt;/span&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;[1]&nbsp;&lt;a&nbsp;href=&quot;https://github.com/cwaldbieser/txcasproxy/blob/master/txcasproxy/service.py&quot;&gt;https://github.com/cwaldbieser/txcasproxy/blob/master/txcasproxy/service.py&lt;/a&gt;&lt;br&gt;&lt;br&gt;[2]&nbsp;&lt;a&nbsp;href=&quot;https://twistedmatrix.com/documents/current/web/howto/web-in-60/session-store.html&quot;&gt;https://twistedmatrix.com/documents/current/web/howto/web-in-60/session-store.html&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Jul&nbsp;5,&nbsp;2016&nbsp;at&nbsp;12:03&nbsp;PM,&nbsp;Donal&nbsp;McMullan&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:donal.mcmullan@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;donal.mcmullan@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&#39;m&nbsp;curious&nbsp;about&nbsp;request.getSession&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Per&nbsp;the&nbsp;docs:&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;https://twistedmatrix.com/documents/current/web/howto/using-twistedweb.html&quot;&nbsp;target=&quot;_blank&quot;&gt;https://twistedmatrix.com/documents/current/web/howto/using-twistedweb.html&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;seems&nbsp;like&nbsp;it&#39;s&nbsp;tricky&nbsp;to&nbsp;use&nbsp;correctly.&nbsp;My&nbsp;code&nbsp;needs&nbsp;to:&lt;/div&gt;&lt;div&gt; -&nbsp;define&nbsp;an&nbsp;Interface&lt;/div&gt;&lt;div&gt; -&nbsp;define&nbsp;a&nbsp;class&nbsp;that&nbsp;implements&nbsp;my&nbsp;Interface&lt;/div&gt;&lt;div&gt; -&nbsp;call&nbsp;registerAdapter,&nbsp;passing&nbsp;in&nbsp;my&nbsp;class,&nbsp;server.Session&nbsp;and&nbsp;my&nbsp;Interface&lt;/div&gt;&lt;div&gt; -&nbsp;get&nbsp;a&nbsp;Session&nbsp;instance&lt;/div&gt;&lt;div&gt; -&nbsp;brace&nbsp;myself&lt;/div&gt;&lt;div&gt; -&nbsp;create&nbsp;an&nbsp;instance&nbsp;of&nbsp;my&nbsp;Interface&nbsp;class,&nbsp;passing&nbsp;in&nbsp;the&nbsp;Session&nbsp;instance&lt;/div&gt;&lt;div&gt; -&nbsp;update&nbsp;that&nbsp;Interface&nbsp;instance....&nbsp;it&nbsp;will&nbsp;persisted,&nbsp;but&nbsp;only&nbsp;in-memory&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;By&nbsp;default,&nbsp;that&nbsp;data&nbsp;doesn&#39;t&nbsp;go&nbsp;to&nbsp;database/memcached/whatever,&nbsp;so&nbsp;it&#39;s&nbsp;only&nbsp;accessible&nbsp;in-process&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;On&nbsp;first&nbsp;blush,&nbsp;that&nbsp;seems&nbsp;like&nbsp;a&nbsp;lot&nbsp;of&nbsp;legwork.&nbsp;I&#39;m&nbsp;not&nbsp;clear&nbsp;on&nbsp;what&nbsp;utility&#39;s&nbsp;provided&nbsp;by&nbsp;all&nbsp;this&nbsp;versus&nbsp;say&nbsp;maintaining&nbsp;a&nbsp;dict&nbsp;as&nbsp;a&nbsp;class-attribute&nbsp;on&nbsp;Site&nbsp;or&nbsp;something.&nbsp;It&#39;s&nbsp;also&nbsp;(for&nbsp;me)&nbsp;counter-intuitive&nbsp;to&nbsp;be&nbsp;creating&nbsp;an&nbsp;instance&nbsp;of&nbsp;an&nbsp;_Interface_&nbsp;and&nbsp;poking&nbsp;data&nbsp;into&nbsp;it.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Also&nbsp;I&nbsp;was&nbsp;a&nbsp;bit&nbsp;surprised&nbsp;that&nbsp;getSession&nbsp;doesn&#39;t&nbsp;return&nbsp;a&nbsp;deferred,&nbsp;since&nbsp;it&nbsp;seems&nbsp;like&nbsp;it&#39;d&nbsp;be&nbsp;common&nbsp;to&nbsp;want&nbsp;to&nbsp;persist&nbsp;session&nbsp;data&nbsp;in&nbsp;an&nbsp;external&nbsp;store&nbsp;so&nbsp;that&nbsp;multiple&nbsp;twisted-web&nbsp;processes&nbsp;can&nbsp;access&nbsp;it&nbsp;in&nbsp;a&nbsp;clustered/load-balanced&nbsp;setup.&nbsp;How&nbsp;do&nbsp;other&nbsp;folks&nbsp;go&nbsp;about&nbsp;that?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;hacked&nbsp;something&nbsp;together&nbsp;a&nbsp;while&nbsp;ago&nbsp;to&nbsp;run&nbsp;session&nbsp;data&nbsp;into&nbsp;Redis,&nbsp;but&nbsp;what&nbsp;I&nbsp;ended&nbsp;up&nbsp;with&nbsp;required&nbsp;so&nbsp;much&nbsp;surgery&nbsp;on&nbsp;twisted&nbsp;web&#39;s&nbsp;classes&nbsp;that&nbsp;I&nbsp;figured&nbsp;I&nbsp;must&nbsp;be&nbsp;doing&nbsp;it&nbsp;wrong.&nbsp;I&nbsp;think&nbsp;Site,&nbsp;SessionFactory&nbsp;and&nbsp;Request&nbsp;were&nbsp;all&nbsp;customised.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;was&nbsp;thinking&nbsp;about&nbsp;this&nbsp;again&nbsp;in&nbsp;the&nbsp;context&nbsp;of&nbsp;Cory&#39;s&nbsp;&quot;Implement&nbsp;server-side&nbsp;HTTP/2&nbsp;server&nbsp;push&quot;&nbsp;ticket:&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;https://twistedmatrix.com/trac/ticket/8485&quot;&nbsp;target=&quot;_blank&quot;&gt;https://twistedmatrix.com/trac/ticket/8485&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;this&nbsp;context,&nbsp;I&#39;d&nbsp;like&nbsp;to&nbsp;have&nbsp;access&nbsp;to&nbsp;my&nbsp;session&nbsp;data&nbsp;in&nbsp;multiple&nbsp;Resource&nbsp;objects&nbsp;without&nbsp;_necessarily_&nbsp;having&nbsp;to&nbsp;round-trip&nbsp;to&nbsp;an&nbsp;external&nbsp;store&nbsp;each&nbsp;time&nbsp;to&nbsp;get/put&nbsp;the&nbsp;same&nbsp;data.&nbsp;In&nbsp;the&nbsp;case&nbsp;of&nbsp;http&nbsp;1.1&nbsp;requests,&nbsp;I&nbsp;guess&nbsp;there&#39;s&nbsp;no&nbsp;way&nbsp;around&nbsp;that&nbsp;round-trip,&nbsp;so&nbsp;it&nbsp;might&nbsp;be&nbsp;optimal&nbsp;if&nbsp;my&nbsp;Resource&nbsp;objects&nbsp;could&nbsp;be&nbsp;oblivious&nbsp;to&nbsp;the&nbsp;underlying&nbsp;protocol&nbsp;version&nbsp;and&nbsp;Session&nbsp;get/put&nbsp;mechanism.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;it&#39;d&nbsp;be&nbsp;great&nbsp;if&nbsp;the&nbsp;default&nbsp;Session&nbsp;mechanism&nbsp;could&nbsp;take&nbsp;care&nbsp;of&nbsp;me&nbsp;there,&nbsp;and&nbsp;I&nbsp;could&nbsp;just&nbsp;have&nbsp;my&nbsp;cake&nbsp;and&nbsp;eat&nbsp;it.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Another&nbsp;wrinkle&nbsp;that&nbsp;surprised&nbsp;me&nbsp;when&nbsp;I&nbsp;was&nbsp;hacking&nbsp;on&nbsp;this&nbsp;was&nbsp;that&nbsp;there&nbsp;didn&#39;t&nbsp;seem&nbsp;to&nbsp;be&nbsp;a&nbsp;way&nbsp;to&nbsp;uniquely&nbsp;identify&nbsp;a&nbsp;request&nbsp;instance,&nbsp;so&nbsp;within&nbsp;the&nbsp;session&nbsp;code&nbsp;it&nbsp;was&nbsp;impossible&nbsp;to&nbsp;tell&nbsp;if&nbsp;two&nbsp;calls&nbsp;to&nbsp;getSession&nbsp;were&nbsp;coming&nbsp;from&nbsp;different&nbsp;points&nbsp;in&nbsp;the&nbsp;callback&nbsp;chain&nbsp;responding&nbsp;to&nbsp;a&nbsp;single&nbsp;Request,&nbsp;or&nbsp;if&nbsp;the&nbsp;second&nbsp;belonged&nbsp;to&nbsp;a&nbsp;different&nbsp;Request&nbsp;entirely.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;my&nbsp;confusion&nbsp;is&nbsp;probably&nbsp;apparent&nbsp;at&nbsp;this&nbsp;stage&nbsp;:)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;m&nbsp;guessing&nbsp;others&nbsp;have&nbsp;been&nbsp;here&nbsp;before&nbsp;me.&nbsp;What&nbsp;approaches&nbsp;have&nbsp;you&nbsp;taken&nbsp;to&nbsp;storing&nbsp;your&nbsp;sessions?&nbsp;Are&nbsp;there&nbsp;good&nbsp;open&nbsp;source&nbsp;projects&nbsp;that&nbsp;I&nbsp;should&nbsp;look&nbsp;to&nbsp;for&nbsp;best&nbsp;practice?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;DJM&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
Twisted-web&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Twisted-web@twistedmatrix.com&quot;&gt;Twisted-web@twistedmatrix.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
