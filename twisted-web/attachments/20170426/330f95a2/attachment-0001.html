<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello,&lt;br&gt;&lt;br&gt;The&nbsp;other&nbsp;day,&nbsp;we&nbsp;had&nbsp;a&nbsp;Scrapy&nbsp;user&nbsp;report&nbsp;an&nbsp;issue&nbsp;connecting&nbsp;to&nbsp;&lt;a&nbsp;href=&quot;https://www.skelbiu.lt/&quot;&gt;https://www.skelbiu.lt/&lt;/a&gt;&nbsp;with&nbsp;OpenSSL&nbsp;1.1&nbsp;[1]&lt;br&gt;&lt;br&gt;To&nbsp;not&nbsp;mix&nbsp;scrapy&#39;s&nbsp;things&nbsp;with&nbsp;Twisted&nbsp;Web,&nbsp;I&nbsp;used&nbsp;this&nbsp;(adapted&nbsp;from&nbsp;official&nbsp;docs):&lt;br&gt;&lt;br&gt;#---------------&lt;br&gt;from&nbsp;__future__&nbsp;import&nbsp;print_function&lt;br&gt;&lt;br&gt;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;br&gt;from&nbsp;twisted.web.client&nbsp;import&nbsp;Agent&lt;br&gt;from&nbsp;twisted.web.http_headers&nbsp;import&nbsp;Headers&lt;br&gt;&lt;br&gt;agent&nbsp;=&nbsp;Agent(reactor)&lt;br&gt;&lt;br&gt;d&nbsp;=&nbsp;agent.request(&lt;br&gt; &nbsp; &nbsp;&#39;GET&#39;,&lt;br&gt; &nbsp; &nbsp;&#39;&lt;a&nbsp;href=&quot;https://www.skelbiu.lt/&quot;&gt;https://www.skelbiu.lt/&lt;/a&gt;&#39;,&lt;br&gt; &nbsp; &nbsp;Headers({&#39;User-Agent&#39;:&nbsp;[&#39;Twisted&nbsp;Web&nbsp;Client&nbsp;Example&#39;]}),&lt;br&gt; &nbsp; &nbsp;None)&lt;br&gt;&lt;br&gt;def&nbsp;cbResponse(ignored):&lt;br&gt; &nbsp; &nbsp;print(&#39;Response&nbsp;received&#39;)&lt;br&gt;d.addCallback(cbResponse)&lt;br&gt;&lt;br&gt;def&nbsp;cbShutdown(ignored):&lt;br&gt; &nbsp; &nbsp;print(ignored)&lt;br&gt; &nbsp; &nbsp;reactor.stop()&lt;br&gt;d.addBoth(cbShutdown)&lt;br&gt;&lt;br&gt;reactor.run()&lt;br&gt;#---------------&lt;br&gt;&lt;br&gt;And&nbsp;I&nbsp;did&nbsp;get&nbsp;a&nbsp;Handshake&nbsp;failure&nbsp;too:&lt;br&gt;&lt;br&gt; &nbsp; &nbsp;$&nbsp;python&nbsp;twistedtest.py&nbsp;&lt;br&gt; &nbsp; &nbsp;[Failure&nbsp;instance:&nbsp;Traceback&nbsp;(failure&nbsp;with&nbsp;no&nbsp;frames):&nbsp;&lt;class&nbsp;&#39;twisted.web._newclient.ResponseNeverReceived&#39;&gt;:&nbsp;[&lt;twisted.python.failure.Failure&nbsp;OpenSSL.SSL.Error:&nbsp;[(&#39;SSL&nbsp;routines&#39;,&nbsp;&#39;ssl3_read_bytes&#39;,&nbsp;&#39;sslv3&nbsp;alert&nbsp;handshake&nbsp;failure&#39;)]&gt;]&lt;br&gt; &nbsp; &nbsp;]&lt;br&gt;&lt;br&gt;&lt;br&gt;It&nbsp;seems&nbsp;this&nbsp;happens&nbsp;(at&nbsp;least)&nbsp;with&nbsp;OpenSSL&nbsp;1.1.0e&nbsp;(currently&nbsp;in&nbsp;Debian&nbsp;9&nbsp;sid&nbsp;[2])&lt;br&gt;It&nbsp;does&nbsp;not&nbsp;happen&nbsp;(for&nbsp;me)&nbsp;with&nbsp;OpenSSL&nbsp;1.0.2g&nbsp;for&nbsp;example.&lt;br&gt;&lt;br&gt;I&nbsp;dug&nbsp;into&nbsp;this&nbsp;this&nbsp;afternoon&nbsp;and&nbsp;narrowed&nbsp;it&nbsp;down&nbsp;to&nbsp;the&nbsp;use&nbsp;of &lt;div&gt;_defaultCurveName&nbsp;=&nbsp;u&quot;prime256v1&quot;&lt;/div&gt;&lt;div&gt;in&nbsp;twisted.internet._sslverify.py&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;tried&nbsp;patching&nbsp;the&nbsp;current&nbsp;trunk&nbsp;with&nbsp;_defaultCurveName&nbsp;=&nbsp;u&quot;secp384r1&quot;&nbsp;(the&nbsp;EC&nbsp;that&nbsp;&lt;a&nbsp;href=&quot;http://ssllabs.com&quot;&gt;ssllabs.com&lt;/a&gt;&nbsp;reports)&lt;br&gt;and&nbsp;it&nbsp;did&nbsp;work.&lt;br&gt;&lt;br&gt;Looking&nbsp;at&nbsp;ClientHello&nbsp;messages&nbsp;for&nbsp;openssl&nbsp;1.0.2&nbsp;and&nbsp;1.1&nbsp;[4]:&lt;br&gt;with&nbsp;1.1,&nbsp;only&nbsp;1&nbsp;Elliptic&nbsp;Curve&nbsp;is&nbsp;sent&nbsp;by&nbsp;Twisted&nbsp;Web&nbsp;Agent,&nbsp;secp256r1&lt;br&gt;&lt;br&gt;openssl&nbsp;v1.1&nbsp;client&nbsp;uses&nbsp;4&nbsp;by&nbsp;default:&nbsp;ecdh_x25519,&nbsp;secp256r1,&nbsp;secp521r1,&nbsp;secp384r1&lt;br&gt;&lt;br&gt;I&nbsp;was&nbsp;wondering&nbsp;what&nbsp;is&nbsp;the&nbsp;proper&nbsp;way&nbsp;to&nbsp;configure&nbsp;requested&nbsp;Elliptic&nbsp;Curves.&lt;br&gt;I&nbsp;haven&#39;t&nbsp;seen&nbsp;any&nbsp;interface&nbsp;for&nbsp;this,&nbsp;contrary&nbsp;to&nbsp;ciphers&nbsp;with&nbsp;acceptableCiphers.&lt;br&gt;&lt;br&gt;Thank&nbsp;you&nbsp;for&nbsp;your&nbsp;input.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;Best,&lt;br&gt;Paul.&lt;br&gt;&lt;br&gt;[1]&nbsp;&lt;a&nbsp;href=&quot;https://github.com/scrapy/scrapy/issues/2717&quot;&gt;https://github.com/scrapy/scrapy/issues/2717&lt;/a&gt;&lt;br&gt;[2]&nbsp;&lt;a&nbsp;href=&quot;https://packages.debian.org/fr/source/sid/openssl&quot;&gt;https://packages.debian.org/fr/source/sid/openssl&lt;/a&gt;&lt;br&gt;[3]&nbsp;&lt;a&nbsp;href=&quot;https://github.com/twisted/twisted/blob/78679af87e349721a167f35bef239e192e91d126/src/twisted/internet/_sslverify.py#L1904&quot;&gt;https://github.com/twisted/twisted/blob/78679af87e349721a167f35bef239e192e91d126/src/twisted/internet/_sslverify.py#L1904&lt;/a&gt;&lt;br&gt;[4]&nbsp;&lt;a&nbsp;href=&quot;https://github.com/scrapy/scrapy/issues/2717#issuecomment-297464034&quot;&gt;https://github.com/scrapy/scrapy/issues/2717#issuecomment-297464034&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
