<tt>
&lt;br&gt;&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;May&nbsp;7,&nbsp;2008&nbsp;at&nbsp;12:49&nbsp;PM,&nbsp;Tristan&nbsp;Seligmann&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:mithrandi@mithrandi.net&quot;&gt;mithrandi@mithrandi.net&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;PADDING-LEFT:&nbsp;1ex;&nbsp;MARGIN:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;BORDER-LEFT:&nbsp;#ccc&nbsp;1px&nbsp;solid&quot;&gt;*&nbsp;Harald&nbsp;Bl√•tand&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:kozneb@gmail.com&quot;&gt;kozneb@gmail.com&lt;/a&gt;&amp;gt;&nbsp;[2008-05-07&nbsp;12:24:18&nbsp;+0200]:&lt;br&gt;<br>
<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&lt;br&gt;&amp;gt;&nbsp;Just&nbsp;thought&nbsp;that&nbsp;since&nbsp;we&nbsp;have&nbsp;IE&nbsp;all&nbsp;over&nbsp;the&nbsp;place,&nbsp;and&nbsp;we&nbsp;can&amp;#39;t&nbsp;have&nbsp;an&lt;br&gt;&amp;gt;&nbsp;app&nbsp;that&nbsp;freezes&nbsp;if&nbsp;a&nbsp;user&nbsp;refreshes&nbsp;it,&nbsp;I&nbsp;might&nbsp;make&nbsp;a&nbsp;feeble&nbsp;attempt...&nbsp;By&lt;br&gt;&lt;br&gt;&lt;/div&gt;Indeed,&nbsp;I&amp;#39;m&nbsp;in&nbsp;the&nbsp;same&nbsp;position&nbsp;with&nbsp;my&nbsp;own&nbsp;application:&nbsp;our&nbsp;userbase&lt;br&gt;<br>
is&nbsp;currently&nbsp;100%&nbsp;IE-using,&nbsp;with&nbsp;the&nbsp;exception&nbsp;of&nbsp;us&nbsp;developers&nbsp;;)&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;Ih2E3d&quot;&gt;&amp;nbsp;&lt;/div&gt;&lt;/blockquote&gt;<br>
&lt;div&gt;I&nbsp;may&nbsp;have&nbsp;something&nbsp;now&nbsp;that&nbsp;keeps&nbsp;IE&nbsp;from&nbsp;hanging&nbsp;on&nbsp;a&nbsp;page&nbsp;refresh.&lt;/div&gt;<br>
&lt;div&gt;Here&amp;#39;s&nbsp;what&nbsp;I&amp;#39;ve&nbsp;changed&nbsp;in&nbsp;the&nbsp;0.9.31&nbsp;JS&nbsp;code:&lt;/div&gt;<br>
&lt;div&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;------------------&nbsp;Nevow/Athena/__init__.js&nbsp;(2&nbsp;additions)&nbsp;--------------------------&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;courier&nbsp;new,monospace&quot;&gt;Nevow.Athena.Widget._initialize&nbsp;=&nbsp;function()&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Divmod.debug(&amp;quot;widget&amp;quot;,&nbsp;&amp;quot;Instantiating&nbsp;live&nbsp;widgets&amp;quot;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Nevow.Athena.Widget._pageLoaded&nbsp;=&nbsp;true;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;With&nbsp;the&nbsp;next&nbsp;line,&nbsp;sendCloseMessage&nbsp;will&nbsp;get&nbsp;called&nbsp;in&nbsp;IE.&nbsp;//&nbsp;Harald&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Divmod.Base.addUnLoadEvent(Nevow.Athena.page.deliveryChannel);&nbsp;//&nbsp;Harald&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Nevow.Athena.Widget._instantiateWidgets();&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Divmod.debug(&amp;quot;widget&amp;quot;,&nbsp;&amp;quot;Finished&nbsp;instantiating&nbsp;live&nbsp;widgets&amp;quot;);&lt;br&gt;};&lt;br&gt;<br>
&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;courier&nbsp;new,monospace&quot;&gt;Nevow.Athena.bootstrap&nbsp;=&nbsp;function&nbsp;(pageClassName,&nbsp;clientID)&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;var&nbsp;self&nbsp;=&nbsp;this;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;var&nbsp;pageClass&nbsp;=&nbsp;Divmod.namedAny(pageClassName);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.page&nbsp;=&nbsp;pageClass(clientID,&nbsp;Nevow.Athena._createMessageDelivery);&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Nevow.Athena.page&nbsp;=&nbsp;self.page;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;Harald&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.page.bindEvents(window);&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;courier&nbsp;new,monospace&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;.....&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;courier&nbsp;new,monospace&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;courier&nbsp;new,monospace&quot;&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;arial,sans-serif&quot;&gt;------------------&nbsp;Divmod/Base.js&nbsp;(1&nbsp;added&nbsp;function&nbsp;at&nbsp;the&nbsp;end)&nbsp;--------------------------&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;Divmod.Base.addUnLoadEvent&nbsp;=&nbsp;function(channel)&nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;/***&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Harald&amp;#39;s&nbsp;desperate&nbsp;try&nbsp;to&nbsp;get&nbsp;IE&nbsp;page&nbsp;refresh&nbsp;to&nbsp;work...&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;***/&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;window.attachEvent(&amp;quot;onunload&amp;quot;,&nbsp;function&nbsp;(e)&nbsp;{channel.sendCloseMessage();});&lt;br&gt;<br>
};&lt;/div&gt;<br>
&lt;div&gt;Divmod.Base.jsonRegistry&nbsp;=&nbsp;Divmod.Base.AdapterRegistry();&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;arial,sans-serif&quot;&gt;I&amp;#39;m&nbsp;not&amp;nbsp;used&nbsp;to&nbsp;this&nbsp;coding&nbsp;style,&nbsp;so&nbsp;it&amp;#39;s&nbsp;a&nbsp;bit&nbsp;of&nbsp;trial&nbsp;&amp;amp;&nbsp;error.&nbsp;Anyway,&nbsp;before,&nbsp;sendCloseMessage&nbsp;would&nbsp;_not_&nbsp;be&nbsp;called;&nbsp;now&nbsp;it&nbsp;is,&nbsp;and&nbsp;I&nbsp;can&nbsp;refresh&nbsp;ad&nbsp;lib&nbsp;on&nbsp;IE&nbsp;6.and&nbsp;7.&lt;/font&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&gt;Not&nbsp;sure&nbsp;either&nbsp;what&nbsp;this&nbsp;will&nbsp;do&nbsp;to&nbsp;FF.&nbsp;(Since&nbsp;we&amp;#39;re&nbsp;stuck&nbsp;with&nbsp;IE,&nbsp;I&amp;#39;m&nbsp;heavily&nbsp;abusing&nbsp;its&nbsp;non-standard&nbsp;extras,&nbsp;so&nbsp;I&nbsp;can&amp;#39;t&nbsp;get&nbsp;my&nbsp;full&nbsp;app&nbsp;to&nbsp;run&nbsp;on&nbsp;FF.)&amp;nbsp;Besides,&nbsp;you&amp;#39;re&nbsp;better&nbsp;on&nbsp;FF&nbsp;than&nbsp;I&nbsp;am&nbsp;:-)&lt;/font&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&gt;Finally,&nbsp;to&nbsp;fix&nbsp;the&nbsp;onkeypress&nbsp;issue,&nbsp;I&nbsp;think&nbsp;we&amp;#39;d&nbsp;need&nbsp;to&nbsp;go&nbsp;deeper&nbsp;into&nbsp;the&nbsp;&amp;quot;this&amp;quot;&nbsp;dept.&nbsp;For&nbsp;me,&nbsp;the&nbsp;refresh&nbsp;is&nbsp;more&nbsp;important&nbsp;-&nbsp;if&nbsp;the&nbsp;users&nbsp;insist&nbsp;on&nbsp;pressing&nbsp;ESC,&nbsp;they&nbsp;can&nbsp;blame&nbsp;themselves..&nbsp;;-)&lt;/font&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&gt;What&nbsp;do&nbsp;you&nbsp;think?&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&gt;Regards,&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&gt;Harald&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Arial&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;
</tt>
