<tt>
hi,&nbsp;i&nbsp;resolved&nbsp;the&nbsp;problem.&lt;br&gt;&lt;br&gt;use&nbsp;twisted.web2.stream.ProducerStream&lt;br&gt;when&nbsp;getPage&nbsp;function&nbsp;is&nbsp;finished,&nbsp;then&nbsp;write&nbsp;data&nbsp;to&nbsp;the&nbsp;stream.&lt;br&gt;&lt;br&gt;class&nbsp;Test(resource.Resource):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&nbsp;def&nbsp;render(self,&nbsp;request):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&nbsp;remoteurl&nbsp;=&nbsp;&amp;#39;&lt;a&nbsp;href=&quot;http://www.sf.org/&quot;&gt;http://www.sf.org/&lt;/a&gt;&amp;#39;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&nbsp;from&nbsp;twisted.web2.stream&nbsp;import&nbsp;ProducerStream&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&nbsp;responseStream&nbsp;=&nbsp;ProducerStream()&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;getPage(remoteurl,&nbsp;timeout=60).addCallback(self.reqok,&nbsp;request,<br>
responseStream).addErrback(self.reqfailure,&nbsp;request,&nbsp;responseStream)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&nbsp;return&nbsp;http.Response(200,&nbsp;{&amp;#39;content-type&amp;#39;:&nbsp;contenttype}&nbsp;,responseStream)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&nbsp;def&nbsp;reqok(self,&nbsp;result,&nbsp;request,&nbsp;responseStream):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&nbsp;responseStream.write(result)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&nbsp;responseStream.finish()&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&nbsp;def&nbsp;reqfailure(self,&nbsp;failure,&nbsp;request,&nbsp;responseStream):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&nbsp;responseStream.write(&amp;#39;Bad&nbsp;Request&amp;#39;)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&nbsp;responseStream.finish()&lt;a&nbsp;href=&quot;mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20web2%20and%20database%20handling&amp;amp;In-Reply-To=45802378.6000605%40ag-projects.com&quot;&nbsp;title=&quot;[Twisted-web]&nbsp;web2&nbsp;and&nbsp;database&nbsp;handling&quot;&gt;&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;but&nbsp;when&nbsp;get&nbsp;remoteurl&nbsp;cotent&nbsp;need&nbsp;longtime,&nbsp;my&nbsp;program&nbsp;ofter&nbsp;raise..&lt;br&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;2008-06-21&nbsp;21:02:19+0800&nbsp;[-]&nbsp;Unhandled&nbsp;Error&lt;/span&gt;&lt;br&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Traceback&nbsp;(most&nbsp;recent&nbsp;call&nbsp;last):&lt;/span&gt;&lt;br&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;<br>
&lt;span&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;File&nbsp;&amp;quot;/usr/local/lib/python2.5/site-packages/twisted/application/app.py&amp;quot;,&nbsp;line&nbsp;433,&nbsp;in&nbsp;startReactor&lt;/span&gt;&lt;br&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.config,&nbsp;oldstdout,&nbsp;oldstderr,&nbsp;self.profiler,&nbsp;reactor)&lt;/span&gt;&lt;br&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;<br>
&lt;span&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;File&nbsp;&amp;quot;/usr/local/lib/python2.5/site-packages/twisted/application/app.py&amp;quot;,&nbsp;line&nbsp;336,&nbsp;in&nbsp;runReactorWithLogging&lt;/span&gt;&lt;br&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;reactor.run()&lt;/span&gt;&lt;br&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;<br>
&lt;span&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;File&nbsp;&amp;quot;/usr/local/lib/python2.5/site-packages/twisted/internet/base.py&amp;quot;,&nbsp;line&nbsp;1114,&nbsp;in&nbsp;run&lt;/span&gt;&lt;br&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.mainLoop()&lt;/span&gt;&lt;br&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;<br>
&lt;span&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;File&nbsp;&amp;quot;/usr/local/lib/python2.5/site-packages/twisted/internet/base.py&amp;quot;,&nbsp;line&nbsp;1126,&nbsp;in&nbsp;mainLoop&lt;/span&gt;&lt;br&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.doIteration(t)&lt;/span&gt;&lt;br&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;<br>
&lt;span&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;---&nbsp;&amp;lt;exception&nbsp;caught&nbsp;here&amp;gt;&nbsp;---&lt;/span&gt;&lt;br&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;0,&nbsp;0);&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;File&nbsp;&amp;quot;/usr/local/lib/python2.5/site-packages/twisted/internet/selectreactor.py&amp;quot;,&nbsp;line&nbsp;104,&nbsp;in&nbsp;doSelect&lt;/span&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;51,&nbsp;0);&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;[],&nbsp;timeout)&lt;/span&gt;&lt;br&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;51,&nbsp;0);&quot;&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(153,&nbsp;51,&nbsp;0);&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;exceptions.ValueError:&nbsp;filedescriptor&nbsp;out&nbsp;of&nbsp;range&nbsp;in&nbsp;select()&lt;/span&gt;&lt;br&gt;<br>

</tt>
