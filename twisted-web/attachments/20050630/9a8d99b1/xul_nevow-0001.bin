
from nevow import rend, loaders, inevow, livepage

getValue = livepage.js('getValue')
changeLabel = livepage.js('changeLabel')
changeRecord = livepage.js('changeRecord')

def onCommand(client, text):
    client.sendScript(changeRecord('First name','Last name','Street address','City or suburb'))
    client.sendScript(changeLabel(text))

class XulApp(livepage.LivePage):
    addSlash = True
    docFactory = loaders.xmlfile('xul_example.xul')

    def locateChild(self, ctx, segments):
        inevow.IRequest(ctx).setHeader("Content-Type", "application/vnd.mozilla.xul+xml; charset=UTF-8")
        return rend.Page.locateChild(self, ctx, segments)

    def render_btn(self, ctx, data):
        return ctx.tag(oncommand=livepage.server.handle('onCommand', getValue('some-text')))

    def handle_onCommand(self, ctx, text):
        return changeLabel(text)

def createResource():
    return XulApp()
