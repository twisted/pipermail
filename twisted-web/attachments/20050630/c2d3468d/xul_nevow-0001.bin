
from nevow import rend, loaders, inevow, livepage, appserver

getValue = livepage.js('getValue')
changeLabel = livepage.js('changeLabel')
changeRecord = livepage.js('changeRecord')


class XulApp(livepage.LivePage):
    addSlash = True
    docFactory = loaders.xmlfile('xul_example.xul')

    def locateChild(self, ctx, segments):
        inevow.IRequest(ctx).setHeader("Content-Type", "application/vnd.mozilla.xul+xml; charset=UTF-8")
        return rend.Page.locateChild(self, ctx, segments)

    def render_btn(self, ctx, data):
        return ctx.tag(oncommand=livepage.server.handle('onCommand', getValue('some-text')))

    def handle_onCommand(self, ctx, text):
        return [
            changeRecord('First name','Last name','Street address','City or suburb'), livepage.eol,
            changeLabel(text)]

from twisted.application import service, strports
application = service.Application('test-xul')
strports.service("8080", appserver.NevowSite(XulApp())).setServiceParent(application)

