<tt>
&lt;span&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;Hello&lt;/span&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;The&nbsp;code&nbsp;suggests&nbsp;it&nbsp;does&nbsp;-&nbsp;but&nbsp;I&nbsp;can&amp;#39;t&nbsp;get&nbsp;it&nbsp;to&nbsp;work.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;&lt;div&gt;class&nbsp;ProxyAgent(_AgentBase):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;&amp;quot;&amp;quot;&amp;quot;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;An&nbsp;HTTP&nbsp;agent&nbsp;able&nbsp;to&nbsp;cross&nbsp;HTTP&nbsp;proxies.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;@ivar&nbsp;_proxyEndpoint:&nbsp;The&nbsp;endpoint&nbsp;used&nbsp;to&nbsp;connect&nbsp;to&nbsp;the&nbsp;proxy.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;@since:&nbsp;11.1&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;&amp;quot;&amp;quot;&amp;quot;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;def&nbsp;__init__(self,&nbsp;endpoint,&nbsp;reactor=None,&nbsp;pool=None):&lt;/div&gt;<br>
<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;if&nbsp;reactor&nbsp;is&nbsp;None:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;_AgentBase.__init__(self,&nbsp;reactor,&nbsp;pool)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;self._proxyEndpoint&nbsp;=&nbsp;endpoint&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;def&nbsp;request(self,&nbsp;method,&nbsp;uri,&nbsp;headers=None,&nbsp;bodyProducer=None):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;&amp;quot;&amp;quot;&amp;quot;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;Issue&nbsp;a&nbsp;new&nbsp;request&nbsp;via&nbsp;the&nbsp;configured&nbsp;proxy.&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;&amp;quot;&amp;quot;&amp;quot;&lt;/div&gt;<br>
<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;Cache&nbsp;*all*&nbsp;connections&nbsp;under&nbsp;the&nbsp;same&nbsp;key,&nbsp;since&nbsp;we&nbsp;are&nbsp;only&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;connecting&nbsp;to&nbsp;a&nbsp;single&nbsp;destination,&nbsp;the&nbsp;proxy:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;key&nbsp;=&nbsp;(&amp;quot;http-proxy&amp;quot;,&nbsp;self._proxyEndpoint)&lt;/div&gt;&lt;div&gt;<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;To&nbsp;support&nbsp;proxying&nbsp;HTTPS&nbsp;via&nbsp;CONNECT,&nbsp;we&nbsp;will&nbsp;use&nbsp;key&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;(&amp;quot;http-proxy-CONNECT&amp;quot;,&nbsp;scheme,&nbsp;host,&nbsp;port),&nbsp;and&nbsp;an&nbsp;endpoint&nbsp;that&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;#&nbsp;wraps&nbsp;_proxyEndpoint&nbsp;with&nbsp;an&nbsp;additional&nbsp;callback&nbsp;to&nbsp;do&nbsp;the&nbsp;CONNECT.&lt;/div&gt;<br>
<br>
&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;return&nbsp;self._requestWithEndpoint(key,&nbsp;self._proxyEndpoint,&nbsp;method,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _parse(uri),&nbsp;headers,&nbsp;bodyProducer,&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uri)&lt;/div&gt;<br>
<br>
&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;The&nbsp;&amp;quot;Using&nbsp;a&nbsp;http&nbsp;proxy&amp;quot;&nbsp;- &lt;a&nbsp;href=&quot;http://twistedmatrix.com/documents/current/web/howto/client.html&quot;&nbsp;style=&quot;color:rgb(17,85,204)&quot;&nbsp;target=&quot;_blank&quot;&gt;http://twistedmatrix.com/documents/current/web/howto/client.html&lt;/a&gt;  works,&nbsp;provided&nbsp;the&nbsp;target&nbsp;url&nbsp;is&nbsp;http&nbsp;(&nbsp;not&nbsp;https&nbsp;as&nbsp;shown&nbsp;in&nbsp;the&nbsp;example&nbsp;).&lt;/div&gt;<br>
<br>
&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;I&amp;#39;m&nbsp;attempting&nbsp;to&nbsp;adapt&nbsp;this&nbsp;example&nbsp;to&nbsp;confirm&nbsp;https&nbsp;proxing&nbsp;is&nbsp;possible&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;&lt;div&gt;from&nbsp;twisted.python.log&nbsp;import&nbsp;err&lt;/div&gt;&lt;div&gt;from&nbsp;twisted.web.client&nbsp;import&nbsp;ProxyAgent&lt;/div&gt;&lt;div&gt;<br>
from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;/div&gt;&lt;div&gt;from&nbsp;twisted.internet.endpoints&nbsp;import&nbsp;TCP4ClientEndpoint&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;def&nbsp;display(response):&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;print&nbsp;&amp;quot;Received&nbsp;response&amp;quot;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;print&nbsp;response&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;def&nbsp;main():&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;endpoint&nbsp;=&nbsp;TCP4ClientEndpoint(reactor,&nbsp;&amp;quot;localhost&amp;quot;,&nbsp;8000)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;agent&nbsp;=&nbsp;ProxyAgent(endpoint)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;d&nbsp;=&nbsp;agent.request(&amp;quot;GET&amp;quot;,&nbsp;&amp;quot;&lt;a&nbsp;href=&quot;https://example.com/&quot;&nbsp;style=&quot;color:rgb(17,85,204)&quot;&nbsp;target=&quot;_blank&quot;&gt;https://example.com/&lt;/a&gt;&amp;quot;)&lt;/div&gt;<br>
<br>
&lt;div&gt; &nbsp; &nbsp;d.addCallbacks(display,&nbsp;err)&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;d.addCallback(lambda&nbsp;ignored:&nbsp;reactor.stop())&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;reactor.run()&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if&nbsp;__name__&nbsp;==&nbsp;&amp;quot;__main__&amp;quot;:&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;main()&lt;/div&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;I&amp;#39;ve&nbsp;tried&nbsp;changing&nbsp;the&nbsp;endpoint&nbsp;to&nbsp;SSL4ClientEndpoint&nbsp;without&nbsp;success.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;Any&nbsp;help,&nbsp;much&nbsp;appreciated&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(34,34,34);font-size:13px;font-family:arial,sans-serif&quot;&gt;<br>
-&nbsp;G&lt;/div&gt;<br>

</tt>
