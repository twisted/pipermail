<tt>
&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;charset=UTF-8&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
Jeff&nbsp;Rush&nbsp;pisze:<br>
&lt;blockquote&nbsp;cite=&quot;mid:49EC49B8.8020708@taupro.com&quot;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Michal&nbsp;Pasternak&nbsp;wrote:<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;2009/4/19&nbsp;Jeff&nbsp;Rush&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:jeff@taupro.com&quot;&gt;&amp;lt;jeff@taupro.com&amp;gt;&lt;/a&gt;:<br>
[...]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;2)&nbsp;Alternatively,&nbsp;one&nbsp;could&nbsp;dynamically&nbsp;generate&nbsp;a&nbsp;custom&nbsp;tree&nbsp;of<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pages/resources&nbsp;within&nbsp;the&nbsp;realm&nbsp;object,&nbsp;returning&nbsp;a<br>
different&nbsp;tree&nbsp;depending&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;upon&nbsp;the<br>
identity/permissions&nbsp;of&nbsp;the&nbsp;user.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;I&nbsp;think&nbsp;this&nbsp;is&nbsp;the&nbsp;preferred&nbsp;approach&nbsp;ATM.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&nbsp;This&nbsp;would&nbsp;seem&nbsp;to&nbsp;make&nbsp;it<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;complicated&nbsp;to&nbsp;(a)&nbsp;guarantee&nbsp;that&nbsp;all&nbsp;visitors&nbsp;see&nbsp;the&nbsp;exact<br>
same&nbsp;URL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;structure&nbsp;and,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;You&nbsp;can&nbsp;share&nbsp;the&nbsp;same&nbsp;URL&nbsp;mapper&nbsp;between&nbsp;all&nbsp;users&nbsp;of&nbsp;you&nbsp;site.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
Hmmm,&nbsp;I'm&nbsp;not&nbsp;aware&nbsp;of&nbsp;a&nbsp;centralized&nbsp;URL&nbsp;mapper&nbsp;in&nbsp;the&nbsp;Twisted&nbsp;framework&nbsp;as<br>
there&nbsp;is&nbsp;in&nbsp;other&nbsp;Python&nbsp;frameworks&nbsp;that&nbsp;use&nbsp;regular&nbsp;expression&nbsp;mappers.<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
I&nbsp;think&nbsp;you&nbsp;can&nbsp;write&nbsp;one&nbsp;easily.&nbsp;The&nbsp;question&nbsp;is,&nbsp;do&nbsp;you&nbsp;really&nbsp;need<br>
one?&nbsp;:-)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;cite=&quot;mid:49EC49B8.8020708@taupro.com&quot;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;AFAIK,&nbsp;in&nbsp;Twisted,&nbsp;the&nbsp;URL&nbsp;tree&nbsp;is&nbsp;constructed&nbsp;piece&nbsp;by&nbsp;piece&nbsp;using&nbsp;a&nbsp;series<br>
of&nbsp;.putChild('segment',&nbsp;resource)&nbsp;calls&nbsp;(or&nbsp;child_XXX&nbsp;class&nbsp;attributes)&nbsp;which<br>
if&nbsp;you&nbsp;construct&nbsp;a&nbsp;complex&nbsp;tree&nbsp;with&nbsp;lots&nbsp;of&nbsp;conditionals&nbsp;based&nbsp;on&nbsp;the&nbsp;access<br>
rights&nbsp;of&nbsp;the&nbsp;user,&nbsp;can&nbsp;be&nbsp;messy.<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
Or,&nbsp;you&nbsp;can&nbsp;override&nbsp;locateChild().&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
Conditionals&nbsp;make&nbsp;the&nbsp;code&nbsp;messy.&nbsp;That's&nbsp;why&nbsp;I&nbsp;like&nbsp;the&nbsp;idea&nbsp;of<br>
returning&nbsp;trees&nbsp;of&nbsp;resources,&nbsp;that&nbsp;wrap&nbsp;the&nbsp;avatar&nbsp;object&nbsp;and&nbsp;know<br>
nothing&nbsp;about&nbsp;access&nbsp;control.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;cite=&quot;mid:49EC49B8.8020708@taupro.com&quot;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;(b)&nbsp;consume&nbsp;more<br>
time/memory&nbsp;with&nbsp;constructing&nbsp;duplicate&nbsp;page/resource&nbsp;trees&nbsp;when&nbsp;thousands&nbsp;of<br>
users&nbsp;may&nbsp;be&nbsp;visiting&nbsp;the&nbsp;site,&nbsp;with&nbsp;a&nbsp;mix&nbsp;of&nbsp;permissions.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;You&nbsp;don't&nbsp;have&nbsp;to&nbsp;duplicate&nbsp;page&nbsp;resources;&nbsp;you&nbsp;can&nbsp;create&nbsp;a&nbsp;single<br>
resource&nbsp;and&nbsp;return&nbsp;it&nbsp;for&nbsp;as&nbsp;many&nbsp;users&nbsp;as&nbsp;you&nbsp;want.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
WHile&nbsp;users&nbsp;with&nbsp;identical&nbsp;roles&nbsp;can&nbsp;share&nbsp;resource&nbsp;trees,&nbsp;it&nbsp;seems&nbsp;you'd&nbsp;need<br>
a&nbsp;unique&nbsp;tree&nbsp;for&nbsp;each&nbsp;'kind'&nbsp;of&nbsp;user.<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
If&nbsp;you&nbsp;like,&nbsp;you&nbsp;can&nbsp;also&nbsp;remember&nbsp;the&nbsp;avatar&nbsp;object&nbsp;on&nbsp;the&nbsp;request<br>
object,&nbsp;and&nbsp;then&nbsp;make&nbsp;your&nbsp;resources&nbsp;(which&nbsp;may&nbsp;be&nbsp;a&nbsp;singleton<br>
instances)&nbsp;get&nbsp;the&nbsp;avatar&nbsp;from&nbsp;the&nbsp;request.&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;think&nbsp;that&nbsp;you&nbsp;will&nbsp;spare&nbsp;a&nbsp;few&nbsp;kilobytes&nbsp;of&nbsp;RAM&nbsp;at&nbsp;the&nbsp;cost&nbsp;of<br>
making&nbsp;your&nbsp;code&nbsp;a&nbsp;little&nbsp;bit&nbsp;more&nbsp;complicated.&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;cite=&quot;mid:49EC49B8.8020708@taupro.com&quot;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;I'm&nbsp;thinking&nbsp;I'll&nbsp;have&nbsp;to&nbsp;write&nbsp;something&nbsp;like&nbsp;decorators&nbsp;for&nbsp;page&nbsp;resources<br>
that&nbsp;front-end&nbsp;the&nbsp;locateChild&nbsp;method&nbsp;(for&nbsp;access&nbsp;control&nbsp;over&nbsp;traversal),<br>
and&nbsp;perhaps&nbsp;the&nbsp;renderHTTP&nbsp;method&nbsp;(for&nbsp;access&nbsp;control&nbsp;over&nbsp;page&nbsp;delivery)&nbsp;with<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permissions&nbsp;checking&nbsp;logic.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;What&nbsp;is&nbsp;your&nbsp;permission&nbsp;model&nbsp;exactly?&nbsp;What&nbsp;kind&nbsp;of&nbsp;limitations&nbsp;of<br>
current&nbsp;guard&nbsp;implementation&nbsp;would&nbsp;you&nbsp;like&nbsp;to&nbsp;solve?<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
It&nbsp;is&nbsp;role-based,&nbsp;where&nbsp;a&nbsp;user&nbsp;can&nbsp;possess&nbsp;a&nbsp;mix&nbsp;of&nbsp;multiple&nbsp;roles,&nbsp;such&nbsp;as<br>
user&nbsp;A&nbsp;is&nbsp;(member,&nbsp;),&nbsp;user&nbsp;B&nbsp;is&nbsp;(member,&nbsp;instructor),&nbsp;user&nbsp;C&nbsp;is&nbsp;(admin,&nbsp;).<br>
For&nbsp;that&nbsp;scenario&nbsp;I'd&nbsp;need&nbsp;three&nbsp;resource&nbsp;trees&nbsp;that&nbsp;include/exclude&nbsp;different<br>
things.&nbsp;&nbsp;I&nbsp;could&nbsp;pre-build&nbsp;trees&nbsp;for&nbsp;all&nbsp;possible&nbsp;combinations&nbsp;of&nbsp;roles,&nbsp;or<br>
build&nbsp;on&nbsp;demand&nbsp;and&nbsp;cache&nbsp;the&nbsp;last&nbsp;N&nbsp;trees&nbsp;keyed&nbsp;by&nbsp;role&nbsp;combination.&nbsp;&nbsp;Not<br>
very&nbsp;elegant&nbsp;though.<br>
<br>
Instead&nbsp;I'm&nbsp;looking&nbsp;for&nbsp;something&nbsp;more&nbsp;like:<br>
<br>
&nbsp;&nbsp;@access('instructor')<br>
&nbsp;&nbsp;class&nbsp;StudentRosterPage(rend.Page):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>
<br>
where&nbsp;after&nbsp;traversal&nbsp;ends,&nbsp;a&nbsp;page's&nbsp;renderHTTP()&nbsp;method&nbsp;does:<br>
<br>
&nbsp;&nbsp;if&nbsp;request.user.session.role&nbsp;in&nbsp;self.page_roles:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...return&nbsp;content<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
How&nbsp;about&nbsp;this:&lt;br&gt;<br>
&lt;ul&gt;<br>
&nbsp;&nbsp;&lt;li&gt;create&nbsp;a&nbsp;central&nbsp;mapping&nbsp;of&nbsp;{&nbsp;privlege&nbsp;:&nbsp;[resourceClass,<br>
orInstances]&nbsp;}&lt;/li&gt;<br>
&nbsp;&nbsp;&lt;li&gt;make&nbsp;your&nbsp;decorators&nbsp;put&nbsp;classess&nbsp;into&nbsp;that&nbsp;mapping&lt;/li&gt;<br>
&nbsp;&nbsp;&lt;li&gt;show&nbsp;your&nbsp;resources&nbsp;where&nbsp;they&nbsp;belong&nbsp;(self.url,&nbsp;for&nbsp;example)&lt;/li&gt;<br>
&nbsp;&nbsp;&lt;li&gt;in&nbsp;your&nbsp;IRealm&nbsp;implementation,&nbsp;return&nbsp;trees&nbsp;of&nbsp;resources&nbsp;for&nbsp;a<br>
given&nbsp;privlege;&nbsp;you&nbsp;can&nbsp;return&nbsp;trees&nbsp;of&nbsp;classess&nbsp;and&nbsp;create&nbsp;instances<br>
on-fly,&nbsp;you&nbsp;can&nbsp;create&nbsp;all&nbsp;the&nbsp;instances&nbsp;that&nbsp;you&nbsp;share&nbsp;between&nbsp;users<br>
as&nbsp;singletons&nbsp;and&nbsp;put&nbsp;them&nbsp;in&nbsp;those&nbsp;trees&nbsp;too...&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/li&gt;<br>
&lt;/ul&gt;<br>
&lt;br&gt;<br>
I&nbsp;think&nbsp;it&nbsp;will&nbsp;work&nbsp;with&nbsp;guard;&nbsp;it&nbsp;will&nbsp;also&nbsp;allow&nbsp;you&nbsp;to&nbsp;write&nbsp;API<br>
you&nbsp;described.&nbsp;Do&nbsp;you&nbsp;see&nbsp;any&nbsp;potential&nbsp;problems&nbsp;with&nbsp;this&nbsp;approach?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;cite=&quot;mid:49EC49B8.8020708@taupro.com&quot;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;It&nbsp;is&nbsp;pretty&nbsp;cool&nbsp;-&nbsp;and&nbsp;that&nbsp;is&nbsp;why&nbsp;I'm&nbsp;asking&nbsp;because&nbsp;Twisted&nbsp;has&nbsp;always<br>
introduced&nbsp;me&nbsp;to&nbsp;new&nbsp;ideas&nbsp;and&nbsp;ways&nbsp;of&nbsp;doing&nbsp;things.&nbsp;&nbsp;Perhaps&nbsp;there&nbsp;is<br>
significant&nbsp;security&nbsp;leverage&nbsp;already&nbsp;in&nbsp;there&nbsp;I'm&nbsp;not&nbsp;understanding,&nbsp;or&nbsp;maybe<br>
most&nbsp;people&nbsp;using&nbsp;Twisted&nbsp;roll&nbsp;their&nbsp;own&nbsp;web&nbsp;security&nbsp;mechanisms.&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
[...]&lt;br&gt;<br>
&lt;blockquote&nbsp;cite=&quot;mid:49EC49B8.8020708@taupro.com&quot;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Besides&nbsp;security,&nbsp;I'm&nbsp;looking&nbsp;for&nbsp;examples&nbsp;of&nbsp;smart&nbsp;ways&nbsp;to&nbsp;build&nbsp;up&nbsp;a&nbsp;complex<br>
website&nbsp;from&nbsp;parts&nbsp;developed&nbsp;and&nbsp;packaged&nbsp;by&nbsp;others,&nbsp;without&nbsp;a&nbsp;lot&nbsp;of&nbsp;messy<br>
wiring&nbsp;logic.<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
Looks&nbsp;like&nbsp;you&nbsp;need&nbsp;Divmod&nbsp;Mantissa.&nbsp;&lt;a<br>
&nbsp;href=&quot;http://www.divmod.org/trac/wiki/DivmodMantissa&quot;&gt;http://www.divmod.org/trac/wiki/DivmodMantissa<br>
&lt;/a&gt;&lt;a&nbsp;href=&quot;http://www.divmod.org/trac/wiki/DivmodMantissa/Sharing&quot;&gt;http://www.divmod.org/trac/wiki/DivmodMantissa/Sharing&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
BTW,&nbsp;list:&nbsp;it&nbsp;would&nbsp;be&nbsp;ubercool&nbsp;to&nbsp;have&nbsp;a&nbsp;downloadable&nbsp;repository&nbsp;of<br>
packaged&nbsp;LiveFragments&nbsp;(or&nbsp;Mantissa&nbsp;plugins).&nbsp;All&nbsp;the&nbsp;hard&nbsp;parts&nbsp;(code<br>
&amp;amp;&nbsp;tests)&nbsp;is&nbsp;already&nbsp;done...&lt;br&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
m&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
