<tt>
&lt;html&nbsp;dir=&quot;ltr&quot;&gt;&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;style&nbsp;title=&quot;owaParaStyle&quot;&gt;&lt;!--P&nbsp;{<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspMARGIN-TOP:&nbsp;0px;&nbsp;MARGIN-BOTTOM:&nbsp;0px<br>
}<br>
--&gt;&lt;/style&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;ocsi=&quot;x&quot;&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;color=&quot;#000000&quot;&nbsp;size=&quot;2&quot;&nbsp;face=&quot;Tahoma&quot;&gt;Hi&nbsp;all,&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;tahoma&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;tahoma&quot;&gt;I'm&amp;nbsp;trying&amp;nbsp;to&nbsp;write&nbsp;a&nbsp;typical&nbsp;chat&nbsp;server&nbsp;application&nbsp;with&nbsp;twisted.&amp;nbsp;At&nbsp;this&nbsp;moment,&nbsp;all&nbsp;is&nbsp;working&nbsp;fine&nbsp;except&nbsp;for&nbsp;some&nbsp;strange&nbsp;behaviour&nbsp;with&amp;nbsp;sendLine&nbsp;and&amp;nbsp;connectionLost&nbsp;funcs.&nbsp;Let&nbsp;me&nbsp;explain&nbsp;the&nbsp;problem:&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;tahoma&quot;&gt;-&nbsp;I&nbsp;have&amp;nbsp;a&nbsp;server&amp;nbsp;on&nbsp;the&nbsp;internet.&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;tahoma&quot;&gt;-&amp;nbsp;I&amp;nbsp;connect&nbsp;two&nbsp;PCs&nbsp;(2&nbsp;clients)&amp;nbsp;from&nbsp;the&nbsp;same&nbsp;LAN&nbsp;through&nbsp;a&nbsp;router&nbsp;to&nbsp;that&nbsp;server&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;tahoma&quot;&gt;-&nbsp;All&nbsp;is&nbsp;working&nbsp;fine&nbsp;until&nbsp;I&nbsp;disconnect&nbsp;the&nbsp;LAN&nbsp;of&nbsp;one&nbsp;of&nbsp;those&nbsp;PC&amp;nbsp;(The&nbsp;client&nbsp;is&nbsp;disconnected&nbsp;but&nbsp;the&nbsp;server&nbsp;doesn't&nbsp;know&nbsp;about&nbsp;it).&nbsp;Just&nbsp;to&nbsp;test&nbsp;a&nbsp;typical&nbsp;wireless&nbsp;disconnection&nbsp;without&nbsp;closing&nbsp;sockets,&nbsp;etc...&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;tahoma&quot;&gt;-&nbsp;After&nbsp;disconnecting&nbsp;I&nbsp;try&nbsp;to&nbsp;send&nbsp;some&nbsp;messages&nbsp;through&nbsp;the&nbsp;remaining&nbsp;clients&nbsp;to&amp;nbsp;all&nbsp;clients&nbsp;through&nbsp;this&nbsp;function:&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;tahoma&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;sendMessageToAllClients(self,&nbsp;mesg,reqClient):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;for&nbsp;client&nbsp;in&nbsp;self.clientProtocols:&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;dataLength&nbsp;=&nbsp;str(len(mesg))&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;(len(dataLength)&nbsp;&amp;lt;&nbsp;8):&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;dif&nbsp;=&nbsp;8&nbsp;-&nbsp;len(dataLength)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;dataLength&nbsp;=&nbsp;&amp;quot;0&amp;quot;*dif&nbsp;&amp;#43;&nbsp;dataLength&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;print&nbsp;&amp;quot;Enviando&nbsp;a:&amp;quot;,str(client)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;client.sendLine(dataLength&amp;#43;mesg)&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;client.clearLineBuffer()&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;Tahoma&quot;&gt;<br>
&lt;pre&nbsp;style=&quot;FONT-FAMILY:&nbsp;verdana,arial;&nbsp;FONT-SIZE:&nbsp;8pt&quot;&gt;&lt;div&nbsp;style=&quot;FONT:&nbsp;bold&nbsp;13px&nbsp;'Trebuchet&nbsp;MS';&nbsp;COLOR:&nbsp;black&quot;&gt;As&nbsp;you&nbsp;can&nbsp;see,&nbsp;I&nbsp;send&nbsp;a&nbsp;message&nbsp;to&nbsp;all&nbsp;clients,&nbsp;including&nbsp;the&nbsp;one&nbsp;disconnected&nbsp;because&nbsp;the&nbsp;server&nbsp;doesn't&lt;/div&gt;&lt;div&nbsp;style=&quot;FONT:&nbsp;bold&nbsp;13px&nbsp;'Trebuchet&nbsp;MS';&nbsp;COLOR:&nbsp;black&quot;&gt;&nbsp;know&nbsp;at&nbsp;this&nbsp;moment&nbsp;that&nbsp;the&nbsp;client&nbsp;is&nbsp;&amp;quot;out&amp;quot;.&nbsp;I'm&nbsp;able&nbsp;to&nbsp;send&nbsp;6&nbsp;or&nbsp;7&nbsp;messages&nbsp;to&nbsp;the&nbsp;remaining&nbsp;client&nbsp;but&lt;/div&gt;&lt;div&nbsp;style=&quot;FONT:&nbsp;bold&nbsp;13px&nbsp;'Trebuchet&nbsp;MS';&nbsp;COLOR:&nbsp;black&quot;&gt;&nbsp;after&nbsp;that,&nbsp;the&nbsp;connection&nbsp;get&nbsp;lost.&nbsp;I&nbsp;would&nbsp;expect&nbsp;to&nbsp;have&nbsp;a&nbsp;connectionLost&nbsp;with&nbsp;the&nbsp;client&nbsp;offline&nbsp;but&nbsp;actually&lt;/div&gt;&lt;div&nbsp;style=&quot;FONT:&nbsp;bold&nbsp;13px&nbsp;'Trebuchet&nbsp;MS';&nbsp;COLOR:&nbsp;black&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;trebuchet&nbsp;ms&quot;&gt;I&nbsp;got&nbsp;a&nbsp;connectionLost&nbsp;in&nbsp;both&nbsp;clients&nbsp;and&nbsp;I&nbsp;don't&nbsp;know&nbsp;why.&lt;/font&gt;&nbsp;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;trebuchet&nbsp;ms&quot;&gt;The&nbsp;server&nbsp;disconnect&nbsp;both&nbsp;clients&nbsp;with&nbsp;&amp;quot;non&nbsp;clean&nbsp;fashion&amp;quot;.&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;FONT:&nbsp;bold&nbsp;13px&nbsp;'Trebuchet&nbsp;MS';&nbsp;COLOR:&nbsp;black&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;trebuchet&nbsp;ms&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;&lt;div&nbsp;style=&quot;FONT:&nbsp;bold&nbsp;13px&nbsp;'Trebuchet&nbsp;MS';&nbsp;COLOR:&nbsp;black&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;trebuchet&nbsp;ms&quot;&gt;Any&nbsp;help&nbsp;or&nbsp;advice&nbsp;would&nbsp;be&nbsp;highly&nbsp;appreciated.&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;FONT:&nbsp;bold&nbsp;13px&nbsp;'Trebuchet&nbsp;MS';&nbsp;COLOR:&nbsp;black&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;trebuchet&nbsp;ms&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;&lt;div&nbsp;style=&quot;FONT:&nbsp;bold&nbsp;13px&nbsp;'Trebuchet&nbsp;MS';&nbsp;COLOR:&nbsp;black&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;trebuchet&nbsp;ms&quot;&gt;Regards,&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;FONT:&nbsp;bold&nbsp;13px&nbsp;'Trebuchet&nbsp;MS';&nbsp;COLOR:&nbsp;black&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;trebuchet&nbsp;ms&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;&lt;div&nbsp;style=&quot;FONT:&nbsp;bold&nbsp;13px&nbsp;'Trebuchet&nbsp;MS';&nbsp;COLOR:&nbsp;black&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;trebuchet&nbsp;ms&quot;&gt;David&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;FONT:&nbsp;bold&nbsp;13px&nbsp;'Trebuchet&nbsp;MS';&nbsp;COLOR:&nbsp;black&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;face=&quot;trebuchet&nbsp;ms&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;&lt;/pre&gt;<br>
&lt;/font&gt;&lt;/div&gt;<br>
<br>
&lt;P&nbsp;<br>
align=left&gt;-----------------------------------------------------------------------&lt;/P&gt;<br>
&lt;P&gt;Este&nbsp;mensaje&nbsp;es&nbsp;confidencial&nbsp;y&nbsp;atañe&nbsp;exclusivamente&nbsp;a&nbsp;las&nbsp;personas&nbsp;a&nbsp;las&nbsp;que&nbsp;<br>
va&nbsp;dirigido.&lt;BR&gt;Cualquier&nbsp;opinión&nbsp;en&nbsp;el&nbsp;contenida,&nbsp;es&nbsp;exclusivo&nbsp;de&nbsp;su&nbsp;autor&nbsp;y&nbsp;no&nbsp;<br>
representa&nbsp;necesariamente&lt;BR&gt;la&nbsp;opinion&nbsp;de&nbsp;&lt;STRONG&gt;UNIPOST,&nbsp;S.A.&lt;/STRONG&gt;&lt;BR&gt;Si&nbsp;<br>
Ud.&nbsp;no&nbsp;es&nbsp;el&nbsp;destinatario&nbsp;del&amp;nbsp;&nbsp;mensaje,&nbsp;considerese&nbsp;advertido&nbsp;que&nbsp;lo&nbsp;ha&nbsp;<br>
recibido&nbsp;por&nbsp;error&lt;BR&gt;y&nbsp;que&nbsp;cualquier&nbsp;difusión&nbsp;o&nbsp;copia&nbsp;estan&nbsp;terminantemente&nbsp;<br>
prohibidos.&nbsp;Si&nbsp;ha&nbsp;recibido&nbsp;por&nbsp;error,&nbsp;&lt;BR&gt;por&nbsp;favor&nbsp;comuniquelo&nbsp;a&nbsp;<br>
&lt;STRONG&gt;UNIPOST,&nbsp;S.A&lt;/STRONG&gt;.&nbsp;al&nbsp;número&nbsp;+34&nbsp;93&nbsp;223&nbsp;25&nbsp;52&nbsp;o&nbsp;correo&nbsp;electrónico&nbsp;<br>
&lt;BR&gt;a&nbsp;&amp;lt;&lt;A&nbsp;href=&quot;mailto:support@unipost.es&quot;&gt;support@unipost.es&lt;/A&gt;&amp;gt;.&lt;/P&gt;<br>
&lt;P&nbsp;align=left&gt;This&nbsp;e-mail&nbsp;is&nbsp;confidential&nbsp;and&nbsp;intended&nbsp;solely&nbsp;for&nbsp;the&nbsp;use&nbsp;of&nbsp;the&nbsp;<br>
individual&nbsp;to&nbsp;whom&nbsp;it&nbsp;is&nbsp;addressed.&lt;BR&gt;Any&nbsp;opinions&nbsp;presented&nbsp;are&nbsp;solely&nbsp;those&nbsp;<br>
of&nbsp;the&nbsp;author&nbsp;and&nbsp;do&nbsp;not&nbsp;necessarily&nbsp;represent&nbsp;those&nbsp;of&nbsp;&lt;BR&gt;&lt;STRONG&gt;UNIPOST,&nbsp;<br>
S.A.&lt;BR&gt;&lt;/STRONG&gt;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;be&nbsp;advised&nbsp;that&nbsp;you&nbsp;have&nbsp;<br>
received&nbsp;this&nbsp;e-mail&nbsp;in&nbsp;error&nbsp;and&nbsp;that&nbsp;&lt;BR&gt;dissemination,&nbsp;forwarding&nbsp;or&nbsp;copying&nbsp;<br>
of&nbsp;this&nbsp;e-mail&nbsp;is&nbsp;strictly&nbsp;prohibited.&nbsp;If&nbsp;you&nbsp;have&nbsp;received&nbsp;this&nbsp;&lt;BR&gt;e-mail&nbsp;in&nbsp;<br>
error&nbsp;please&nbsp;notify&nbsp;it&nbsp;to&nbsp;&lt;STRONG&gt;UNIPOST,&nbsp;S.A&lt;/STRONG&gt;.&nbsp;by&nbsp;telephone&nbsp;on&nbsp;number&nbsp;<br>
+34&nbsp;93&nbsp;223&nbsp;25&nbsp;52&nbsp;or&nbsp;by&lt;BR&gt;e-mail&nbsp;to&nbsp;&amp;lt;&lt;A&nbsp;<br>
href=&quot;mailto:support@unipost.es&quot;&gt;support@unipost.es&lt;/A&gt;&amp;gt;.&lt;BR&gt;-----------------------------------------------------------------------&lt;BR&gt;&lt;/P&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
