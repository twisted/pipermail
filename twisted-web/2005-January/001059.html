<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] reduce deferred stack in nevow
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20reduce%20deferred%20stack%20in%20nevow&In-Reply-To=60ed19d4050119181143c6dc27%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001058.html">
   <LINK REL="Next"  HREF="001060.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] reduce deferred stack in nevow</H1>
    <B>Andrea Arcangeli</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20reduce%20deferred%20stack%20in%20nevow&In-Reply-To=60ed19d4050119181143c6dc27%40mail.gmail.com"
       TITLE="[Twisted-web] reduce deferred stack in nevow">andrea at cpushare.com
       </A><BR>
    <I>Wed Jan 19 20:09:17 MST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001058.html">[Twisted-web] reduce deferred stack in nevow
</A></li>
        <LI>Next message: <A HREF="001060.html">[Twisted-web] reduce deferred stack in nevow
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1059">[ date ]</a>
              <a href="thread.html#1059">[ thread ]</a>
              <a href="subject.html#1059">[ subject ]</a>
              <a href="author.html#1059">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Jan 20, 2005 at 01:11:44PM +1100, Christopher Armstrong wrote:
&gt;<i> Did you actually find a real performance problem with using
</I>&gt;<i> addCallback/addErrback? Do you know that there is a big difference in
</I>
Of course not (all cpu time seems spent for the rendering of the html),
but the current code looked less optimal than it could have been with a
simple change.

&gt;<i> semantics between addCallback/addErrback vs addCallbacks?
</I>
More or less. The first callback may actually return a Failure that will
cause the underlying errback to be called. Or the first errback may not
return an instance of the Failure class causing the next callback to be
called.

But I admit I didn't think about it while making the patch. So there's a
good chance it wasn't just incidental that the previous code was using
.addcallback/adderrback sorry. I was using the patch successfully but I
might have break something without noticing, sorry. You can ignore it
and if something we can concentrate on something more useful.

Since you mentioned a performance problem, the real performance problem
I have is in the rendering, that takes &gt;150msec for my simplest page in
the whole site. The slowest takes 800msec and I'm going to make some
that will be even slower than that. You can easily reproduce with [0] *
300 passed as input to annotate.Choice(). Now for most of the http part
a reverse proxy can probably do the trick, but for the ssl part it can't
(even ignoring the ssl issues) because it's too dynamic.

Now it's not a short term problem, but I might have to solve that
eventually. Even if formless takes 2 seconds per page (not so
unrelistic) it's ok for the short term.

I wonder what can be done to boost the rendering (I was looking around
the code, and I thought the addcallback/adderrback would be a cleanup
but it wasn't sorry).

Thanks!

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001058.html">[Twisted-web] reduce deferred stack in nevow
</A></li>
	<LI>Next message: <A HREF="001060.html">[Twisted-web] reduce deferred stack in nevow
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1059">[ date ]</a>
              <a href="thread.html#1059">[ thread ]</a>
              <a href="subject.html#1059">[ subject ]</a>
              <a href="author.html#1059">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
