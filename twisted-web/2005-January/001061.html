<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] reduce deferred stack in nevow
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20reduce%20deferred%20stack%20in%20nevow&In-Reply-To=20050120030917.GK12647%40dualathlon.random">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001060.html">
   <LINK REL="Next"  HREF="001062.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] reduce deferred stack in nevow</H1>
    <B>Valentino Volonghi aka Dialtone</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20reduce%20deferred%20stack%20in%20nevow&In-Reply-To=20050120030917.GK12647%40dualathlon.random"
       TITLE="[Twisted-web] reduce deferred stack in nevow">dialtone at divmod.com
       </A><BR>
    <I>Thu Jan 20 05:38:06 MST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001060.html">[Twisted-web] reduce deferred stack in nevow
</A></li>
        <LI>Next message: <A HREF="001062.html">[Twisted-web] reduce deferred stack in nevow
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1061">[ date ]</a>
              <a href="thread.html#1061">[ thread ]</a>
              <a href="subject.html#1061">[ subject ]</a>
              <a href="author.html#1061">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 20 Jan 2005 04:09:17 +0100, Andrea Arcangeli &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">andrea at cpushare.com</A>&gt; wrote:

&gt;<i> Since you mentioned a performance problem, the real performance problem
</I>&gt;<i> I have is in the rendering, that takes &gt;150msec for my simplest page in
</I>&gt;<i> the whole site. The slowest takes 800msec and I'm going to make some
</I>&gt;<i> that will be even slower than that. You can easily reproduce with [0] *
</I>&gt;<i> 300 passed as input to annotate.Choice(). Now for most of the http part
</I>&gt;<i> a reverse proxy can probably do the trick, but for the ssl part it can't
</I>&gt;<i> (even ignoring the ssl issues) because it's too dynamic.
</I>
&gt;<i> I wonder what can be done to boost the rendering (I was looking around
</I>&gt;<i> the code, and I thought the addcallback/adderrback would be a cleanup
</I>&gt;<i> but it wasn't sorry).
</I>
There are some issues to consider:

1) The optimizations branch will surely help a lot. I got a 2x speedup after using it (the branch caches every flattener lookup and does a great job in context lookups) unfortunately this is not yet merged and it's a bit old, so you may have to merge trunk with it first.

2) After that branch you may have pages that render in 70ms with the most complex that could take between 400-600ms.

Keep in mind that taking 70ms to render a page is not so slow for a single page. 

Another thing that could possibly work is rewriting the flatteners in Pyrex or even your page module in Pyrex, nothing stops you from that.

But first you should try to cache rendered fragments so that if data doesn't change you will be able to directly serve the pre-rendered html. 

And before everything you can use the load balancer, and once the session management will be improved you will also be able to share the session on many different servers.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001060.html">[Twisted-web] reduce deferred stack in nevow
</A></li>
	<LI>Next message: <A HREF="001062.html">[Twisted-web] reduce deferred stack in nevow
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1061">[ date ]</a>
              <a href="thread.html#1061">[ thread ]</a>
              <a href="subject.html#1061">[ subject ]</a>
              <a href="author.html#1061">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
