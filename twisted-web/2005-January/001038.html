<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Re: /__logout__ doesn't expire the session
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Re%3A%20/__logout__%20doesn%27t%20expire%20the%20session&In-Reply-To=20050114193356.GI8709%40dualathlon.random">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001036.html">
   <LINK REL="Next"  HREF="001031.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Re: /__logout__ doesn't expire the session</H1>
    <B>Andrea Arcangeli</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Re%3A%20/__logout__%20doesn%27t%20expire%20the%20session&In-Reply-To=20050114193356.GI8709%40dualathlon.random"
       TITLE="[Twisted-web] Re: /__logout__ doesn't expire the session">andrea at cpushare.com
       </A><BR>
    <I>Fri Jan 14 15:23:04 MST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001036.html">[Twisted-web] Re: /__logout__ doesn't expire the session
</A></li>
        <LI>Next message: <A HREF="001031.html">[Twisted-web] Re: /__logout__ doesn't expire the session
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1038">[ date ]</a>
              <a href="thread.html#1038">[ thread ]</a>
              <a href="subject.html#1038">[ subject ]</a>
              <a href="author.html#1038">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Jan 14, 2005 at 08:33:56PM +0100, Andrea Arcangeli wrote:
&gt;<i> expire instead of the user logging out, so I'll simply use the mind to
</I>&gt;<i> expire the session instead of applying the patch I posted (the security
</I>
I can't expire the session from there, it gets in some sort of recursion
and tries to expire it twice, and the second time it generates an
exception. Not too bad actually but for now I'm fine with a
unsetCompontent which doesn't fire the exception (at least I get the
bonus that it won't require cookie regeneration).

			if interface is inevow.IResource:
				def logout(session):
					def _logout():
						session.unsetComponent(iweb.IAccount)
					return _logout

				if avatar_id is checkers.ANONYMOUS or avatar_id.shutdown:
					resc = guest.root_page_class()
					resc.realm = self
					return (inevow.IResource, resc, lambda : None)
				else:
					resc = account.root_page_class(avatar_id)
					resc.remember(avatar_id, iweb.IAccount)
					resc.realm = self
					session = mind.request.getSession()
					return (inevow.IResource, resc, logout(session))

btw, the logout trick looks quite like an hack, but the only real problem is
that I can't get to the ctx, so I'm fine with the above trick for now.

Thanks everyone.

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001036.html">[Twisted-web] Re: /__logout__ doesn't expire the session
</A></li>
	<LI>Next message: <A HREF="001031.html">[Twisted-web] Re: /__logout__ doesn't expire the session
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1038">[ date ]</a>
              <a href="thread.html#1038">[ thread ]</a>
              <a href="subject.html#1038">[ subject ]</a>
              <a href="author.html#1038">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
