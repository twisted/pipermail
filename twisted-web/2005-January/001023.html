<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] /__logout__ doesn't expire the session
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20/__logout__%20doesn%27t%20expire%20the%20session&In-Reply-To=20050113022128.GL26799%40dualathlon.random">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001021.html">
   <LINK REL="Next"  HREF="001025.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] /__logout__ doesn't expire the session</H1>
    <B>Tommi Virtanen</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20/__logout__%20doesn%27t%20expire%20the%20session&In-Reply-To=20050113022128.GL26799%40dualathlon.random"
       TITLE="[Twisted-web] /__logout__ doesn't expire the session">tv at twistedmatrix.com
       </A><BR>
    <I>Thu Jan 13 13:35:27 MST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001021.html">[Twisted-web] /__logout__ doesn't expire the session
</A></li>
        <LI>Next message: <A HREF="001025.html">[Twisted-web] Re: /__logout__ doesn't expire the session
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1023">[ date ]</a>
              <a href="thread.html#1023">[ thread ]</a>
              <a href="subject.html#1023">[ subject ]</a>
              <a href="author.html#1023">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Andrea Arcangeli wrote:
&gt;<i> Because of subject, any data structure linked to the user is still
</I>&gt;<i> visible to the webserver if the user explicitly types /__logout__ in the
</I>&gt;<i> URL. That doesn't seem very safe behaviour.
</I>&gt;<i> 
</I>&gt;<i> The userdb/ in the example directory does this to workaround it:
</I>&gt;<i> 
</I>&gt;<i>     def logout(self, request):
</I>&gt;<i>         request.getSession().expire()
</I>&gt;<i>         request.setComponent(iformless.IRedirectAfterPost, &quot;/&quot;+guard.LOGOUT_AVATAR)
</I>&gt;<i> 
</I>&gt;<i> but that workaround is insecure, since the user can type __logout__ by
</I>&gt;<i> himself (if he knows the nevow code at least) and logout without
</I>&gt;<i> clearing the session.
</I>&gt;<i> 
</I>&gt;<i> This problem would have caused a (very minor) security issue to me, but
</I>&gt;<i> it might have more serious implications in other apps.
</I>&gt;<i> 
</I>&gt;<i> So I'd suggest to expire the session automatically in the __logout__
</I>&gt;<i> avatar so that a new fresh (anonymous) session will have to be allocated
</I>&gt;<i> after logout.
</I>
As I understand it, that removes &quot;too much state&quot;; that is, you only
asked to logout from this specific realm, where the same person could
be logged into multiple Realms at the same time. Or something like that.

When your Realm returns the 3-tuple

	(inevow.IResource, someResource, logout)

that logout callback is called when you call guard's .logout() or visit
__logout__ (or when the session expires). Clean up the state there. For
instance, if your app-specific state is in
session.setComponent(IMyAppState, state), and thus accessed
with IMyAppState(inevow.ISession(ctx)), you can clean that with
session.unsetComponent(IMyAppState).

Things could be cleaner. That's mostly a matter of good docstrings,
gentle API evolution, and examples.

Things could be simpler. But the design inherits directly from
twisted.cred, and that is up to glyph to defend (most like on the
main twisted mailing list).

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001021.html">[Twisted-web] /__logout__ doesn't expire the session
</A></li>
	<LI>Next message: <A HREF="001025.html">[Twisted-web] Re: /__logout__ doesn't expire the session
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1023">[ date ]</a>
              <a href="thread.html#1023">[ thread ]</a>
              <a href="subject.html#1023">[ subject ]</a>
              <a href="author.html#1023">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
