<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] livepage breaks after reload
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20livepage%20breaks%20after%20reload&In-Reply-To=41F7E199.9010302%40shechen.at">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001096.html">
   <LINK REL="Next"  HREF="001099.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] livepage breaks after reload</H1>
    <B>Matt Goodall</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20livepage%20breaks%20after%20reload&In-Reply-To=41F7E199.9010302%40shechen.at"
       TITLE="[Twisted-web] livepage breaks after reload">matt at pollenation.net
       </A><BR>
    <I>Wed Jan 26 16:03:09 MST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001096.html">[Twisted-web] livepage breaks after reload
</A></li>
        <LI>Next message: <A HREF="001099.html">[Twisted-web] livepage breaks after reload
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1097">[ date ]</a>
              <a href="thread.html#1097">[ thread ]</a>
              <a href="subject.html#1097">[ subject ]</a>
              <a href="author.html#1097">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 2005-01-26 at 19:29 +0100, noema wrote:
&gt;<i> &gt; You're locate child should look something more like ...
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; def locateChild(self, context, segments):
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;     # Do whatever you need to do here, probably returning
</I>&gt;<i> &gt;     # a resource and the remaining segments.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;     # I don't know what it is so let Page (my subclass) try.
</I>&gt;<i> &gt;     return rend.Page.locateChild(self, context, segments)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I am not sure I fully understand what you mean. Am I not exactly doing 
</I>&gt;<i> what you are suggesting?!  I return a resource and the remaining 
</I>&gt;<i> segments. Just that in my case the resource is the current resource 
</I>&gt;<i> itself and the remaining segments are empty. (to make any child valid 
</I>&gt;<i> and be handled by MyPage (which it does just not with livepage support))
</I>
Oops, my reasoning was completely flawed although I'm still confident
I'm correct about the problem.

Liveevil connects to the nevow_liveOutput and nevow_liveInput child
resources (see rend.LiveEvilChildMixin). By overriding locateChild, and
not allowing the super class to play, you are blocking access to those
liveevil resources.

&gt;<i> 
</I>&gt;<i>  &gt; return rend.Page.locateChild(self, context, segments)
</I>&gt;<i> 
</I>&gt;<i> Isn't this returned/called anyways if I wouldn't overwrite the inherited 
</I>&gt;<i> locateChild methode.
</I>
Yes, *if* you don't override locateChild. But in your code, the problem
occurs once you uncomment locateChild and replace rend.Page's
implementation of locateChild.

If you want to handle all segments but still let Liveevil work, perhaps
the following will help:

        def locateChild(self, ctx, segments):
            r = rend.Page(self, ctx, segments)
            if r is not appserver.NotFound:
                return r
            return self, ()
        
That /should/ let the super class locate the resources needed by
liveevil and make your page handle all other segments.

Hope this makes more sense this time ;-).

Cheers, Matt

&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> &gt;&gt;What follows is some code that illustrates exactly that. Javascript 
</I>&gt;<i> &gt;&gt;events come perfectly through until I uncommend the localChild methode.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;#noema
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;#################### START OF .TAC FILE ########################
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;import random
</I>&gt;<i> &gt;&gt;from twisted.application import service, internet
</I>&gt;<i> &gt;&gt;from nevow import loaders, rend, tags, livepage, url
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;class MyPage(rend.Page):
</I>&gt;<i> &gt;&gt;     addSlash = True
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     #def locateChild(self, context, segments):
</I>&gt;<i> &gt;&gt;     #    #store the rest of the url for any kind of manual processing
</I>&gt;<i> &gt;&gt;     #    self.postpath = segments
</I>&gt;<i> &gt;&gt;     #    return self, ()
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     def onLinkAction(self, client):
</I>&gt;<i> &gt;&gt;         client.set('atag',
</I>&gt;<i> &gt;&gt;             random.choice(('one', 'two', 'three', 'four', 'five')))
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     def render_link(self, context, data):
</I>&gt;<i> &gt;&gt;         return tags.a(onclick=livepage.handler(self.onLinkAction),
</I>&gt;<i> &gt;&gt;                     href=url.here, id=&quot;atag&quot;)['click!']
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     def render_glue(self, context, data):
</I>&gt;<i> &gt;&gt;         return livepage.glue
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     docFactory = loaders.stan(
</I>&gt;<i> &gt;&gt;     tags.html[
</I>&gt;<i> &gt;&gt;         tags.head[
</I>&gt;<i> &gt;&gt;             tags.title[&quot;mypage&quot;],
</I>&gt;<i> &gt;&gt;           ],
</I>&gt;<i> &gt;&gt;         tags.body[
</I>&gt;<i> &gt;&gt;             tags.div[
</I>&gt;<i> &gt;&gt;                 render_link
</I>&gt;<i> &gt;&gt;             ],
</I>&gt;<i> &gt;&gt;             tags.span(render=render_glue)
</I>&gt;<i> &gt;&gt;         ]
</I>&gt;<i> &gt;&gt;     ])
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;application = service.Application('mypage')
</I>&gt;<i> &gt;&gt;internet.TCPServer(8080, livepage.LiveSite(MyPage()))\
</I>&gt;<i> &gt;&gt;     .setServiceParent(application)
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;#################### END OF .TAC FILE ##########################
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-web mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">Twisted-web at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web</A>
</I>

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001096.html">[Twisted-web] livepage breaks after reload
</A></li>
	<LI>Next message: <A HREF="001099.html">[Twisted-web] livepage breaks after reload
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1097">[ date ]</a>
              <a href="thread.html#1097">[ thread ]</a>
              <a href="subject.html#1097">[ subject ]</a>
              <a href="author.html#1097">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
