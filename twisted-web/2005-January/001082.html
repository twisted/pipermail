<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Re: Page object design: wrapping a dictionary
	containing data
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Re%3A%20Page%20object%20design%3A%20wrapping%20a%20dictionary%0A%09containing%20data&In-Reply-To=2mu0p8a1fh.fsf%40starship.python.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001078.html">
   <LINK REL="Next"  HREF="001086.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Re: Page object design: wrapping a dictionary
	containing data</H1>
    <B>Matt Goodall</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Re%3A%20Page%20object%20design%3A%20wrapping%20a%20dictionary%0A%09containing%20data&In-Reply-To=2mu0p8a1fh.fsf%40starship.python.net"
       TITLE="[Twisted-web] Re: Page object design: wrapping a dictionary
	containing data">matt at pollenation.net
       </A><BR>
    <I>Sun Jan 23 07:18:23 MST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001078.html">[Twisted-web] Re: Page object design: wrapping a dictionary
	containing data
</A></li>
        <LI>Next message: <A HREF="001086.html">[Twisted-web] Re: Page object design: wrapping a dictionary
	containing data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1082">[ date ]</a>
              <a href="thread.html#1082">[ thread ]</a>
              <a href="subject.html#1082">[ subject ]</a>
              <a href="author.html#1082">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, 2005-01-23 at 10:24 +0000, Michael Hudson wrote:
&gt;<i> Mary Gardiner &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">mary-twisted at puzzling.org</A>&gt; writes:
</I>&gt;<i> 
</I>&gt;<i> &gt; I've got a Page object that derives all its data from a dictionary, eg:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; {
</I>&gt;<i> &gt;     'project_name': 'project',
</I>&gt;<i> &gt;     'project_description': 'hello',
</I>&gt;<i> &gt;     # ... you get the idea
</I>&gt;<i> &gt; }
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; What's a good way for the Page object to wrap that dictionary that
</I>&gt;<i> &gt; doesn't involve doing this:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     def data_name(self, ctx, data):
</I>&gt;<i> &gt;         return self.d['project_name']
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     def data_description(self, ctx, data):
</I>&gt;<i> &gt;         return self.d['project_description']
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     # and so on for every key in the dictionary
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I vaguely recall that the equivalent of this used to be possible in
</I>&gt;<i> &gt; Woven:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     def data_project(self, ctx, data):
</I>&gt;<i> &gt;         return self.d
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; and then that the data items were accessible by (say)
</I>&gt;<i> &gt; stan.directive(&quot;project/project_name&quot;). This doesn't look like its
</I>&gt;<i> &gt; supported in Nevow. Is this correct? What alternative designs are there
</I>&gt;<i> &gt; for something like this?
</I>&gt;<i> 
</I>&gt;<i> I think something like this:
</I>&gt;<i> 
</I>&gt;<i>     def data_dict(self, thing):
</I>&gt;<i>         return self.d[thing]
</I>&gt;<i> 
</I>&gt;<i> then nevow:data=&quot;dict project_name&quot; shoud work.  I think.
</I>
This is a parameterised data_ method, right? In which case it should
look like:

        def data_dict(self, thing):
            def _(ctx, data):
                return self.d[thing]
            return _

Parameterised render_ methods look similar.

Basically, Nevow expects parameterised data_ and render_ methods to
return a callable (the _ function in the above example) with a signature
of (ctx, data).

The &quot;weird&quot; syntax is due to some crazy magic in the stan flatteners.
There's not a lot we can do about that right now, although I think it
may be possible to fix in the future.

Having said all that, there may be better ways of doing this anyway,
i.e. provide an inevow.IContainer adapter or use the standard adapters
Nevow provides for tuple, list and dict. See my other posts for more.

Cheers, Matt


</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001078.html">[Twisted-web] Re: Page object design: wrapping a dictionary
	containing data
</A></li>
	<LI>Next message: <A HREF="001086.html">[Twisted-web] Re: Page object design: wrapping a dictionary
	containing data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1082">[ date ]</a>
              <a href="thread.html#1082">[ thread ]</a>
              <a href="subject.html#1082">[ subject ]</a>
              <a href="author.html#1082">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
