<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] [Nevow] template performance
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5BNevow%5D%20template%20performance&In-Reply-To=4582CDFB.8010304%40libero.it">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003221.html">
   <LINK REL="Next"  HREF="003227.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] [Nevow] template performance</H1>
    <B>L. Daniel Burr</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20%5BNevow%5D%20template%20performance&In-Reply-To=4582CDFB.8010304%40libero.it"
       TITLE="[Twisted-web] [Nevow] template performance">ldanielburr at mac.com
       </A><BR>
    <I>Fri Dec 15 12:11:29 CST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="003221.html">[Twisted-web] [Nevow] template performance
</A></li>
        <LI>Next message: <A HREF="003227.html">[Twisted-web] [Nevow] template performance
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3226">[ date ]</a>
              <a href="thread.html#3226">[ thread ]</a>
              <a href="subject.html#3226">[ subject ]</a>
              <a href="author.html#3226">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, 15 Dec 2006 10:31:55 -0600, Manlio Perillo  
&lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">manlio_perillo at libero.it</A>&gt; wrote:

&gt;<i> L. Daniel Burr ha scritto:
</I>&gt;&gt;<i> [...]
</I>&gt;&gt;<i>  Yes, I understand that too.  I will point out that I have *never* used
</I>&gt;&gt;<i> a data directive in any of my applications.  I'm not sure why you feel
</I>&gt;&gt;<i> that you need them.
</I>&gt;<i>
</I>&gt;<i> Because I want to write XHTML code as much as possible.
</I>&gt;<i> This is possible with Djando and it is &quot;fast&quot;, why it should not be  
</I>&gt;<i> possible with Nevow?
</I>&gt;<i>
</I>&gt;&gt;<i> The fact that they are going away at some point is
</I>&gt;&gt;<i> a very good thing, in my opinion.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> If data directive are going away and I will no more be able to write:
</I>&gt;<i>
</I>&gt;<i>     &lt;table&gt;
</I>&gt;<i>        &lt;caption&gt;RandomTable&lt;/caption&gt;
</I>&gt;<i>        &lt;thead&gt;
</I>&gt;<i>          &lt;tr n:render=&quot;sequence&quot; n:data=&quot;header&quot;&gt;
</I>&gt;<i>            &lt;th n:pattern=&quot;item&quot; n:render=&quot;string&quot; /&gt;
</I>&gt;<i>          &lt;/tr&gt;
</I>&gt;<i>        &lt;/thead&gt;
</I>&gt;<i>        &lt;tbody n:render=&quot;sequence&quot; n:data=&quot;table&quot;&gt;
</I>&gt;<i>          &lt;tr n:pattern=&quot;item&quot; n:render=&quot;sequence&quot;&gt;
</I>&gt;<i>            &lt;td n:pattern=&quot;item&quot; n:render=&quot;string&quot; /&gt;
</I>&gt;<i>          &lt;/tr&gt;
</I>&gt;<i>        &lt;/tbody&gt;
</I>&gt;<i>      &lt;/table&gt;
</I>&gt;<i>
</I>
You can still have patterns, and you can still render tables.

&gt;<i> I will migrate to twisted web2 + django template, where I can write:
</I>&gt;<i>
</I>&gt;<i>      &lt;table&gt;
</I>&gt;<i>        &lt;caption&gt;RandomTable&lt;/caption&gt;
</I>&gt;<i>        &lt;thead&gt;
</I>&gt;<i>          &lt;tr&gt;
</I>&gt;<i>            {% for i in header %}
</I>&gt;<i>              &lt;th&gt;{{ i }}&lt;/li&gt;
</I>&gt;<i>            {% endfor %}
</I>&gt;<i>          &lt;/tr&gt;
</I>&gt;<i>        &lt;/thead&gt;
</I>&gt;<i>        &lt;tbody&gt;
</I>&gt;<i>          {% for i in table %}
</I>&gt;<i>            &lt;tr&gt;
</I>&gt;<i>              {% for j in i %}
</I>&gt;<i>                &lt;td&gt;{{ j }}&lt;/td&gt;
</I>&gt;<i>              {% endfor %}
</I>&gt;<i>            &lt;/tr&gt;
</I>&gt;<i>          {% endfor %}
</I>&gt;<i>        &lt;/tbody&gt;
</I>&gt;<i>      &lt;/table&gt;
</I>&gt;<i>
</I>
I will note that this is most definitely *not* XHTML, so your
statement &quot;...want to write XHTML code as much as possible.&quot;
doesn't make sense.  The nevow template would probably pass
XHTML validation, but this Django template surely won't, so
I don't understand your point.

Moreover, you've embedded iteration logic in the Django
template, so if some idea of &quot;XHTML purity&quot; is driving you,
the the Django approach, while faster, is less pure.

&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> However I want to be sure.
</I>&gt;<i> Maybe I'm using Nevow in the wrong way.
</I>&gt;<i>
</I>&gt;<i> How do you render a table like the one in the example?
</I>&gt;<i>
</I>
You could do something like this (untested):

template.xhtml:

&lt;table xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml&quot;">http://www.w3.org/1999/xhtml&quot;</A>
	xmlns:n=&quot;<A HREF="http://nevow.com/ns/nevow/0.1&quot;">http://nevow.com/ns/nevow/0.1&quot;</A>&gt;

     &lt;caption&gt;RandomTable&lt;/caption&gt;

     &lt;thead&gt;
         &lt;tr n:render=&quot;headers&quot;&gt;
             &lt;th n:pattern=&quot;item&quot;&gt;
                 &lt;n:slot name=&quot;content&quot;/&gt;
             &lt;/th&gt;
         &lt;/tr&gt;
     &lt;/thead&gt;

     &lt;tfoot/&gt;

     &lt;tbody n:render=&quot;rows&quot;&gt;
         &lt;tr n:pattern=&quot;item&quot;&gt;
             &lt;td n:pattern=&quot;item&quot;&gt;
                 &lt;n:slot name=&quot;content&quot;/&gt;
             &lt;/td&gt;
         &lt;/tr&gt;
     &lt;/tbody&gt;

&lt;/table&gt;


 from nevow import flat, loaders, page


class MyTable(page.Element):
     docFactory = loaders.xmlfile('template.xhtml')

     def headers(self, request, tag):
         headerPattern = tag.patternGenerator('item')
         columns = []
         for i in range(5):
             header = headerPattern()
             header.fillSlots('content', i)
             columns.append(header)
         return tag.clear()[columns]

     def rows(self, request, tag):
         rowPattern = tag.patternGenerator('item')
         rows = []
         for i in range(10):
             row = rowPattern()
             cells = []
             cellPattern = row.patternGenerator('item')
             for j in range(5):
                 cell = cellPattern()
                 cell.fillSlots('content', j)
                 cells.append(cell)
             rows.append(row.clear()[cells])
         return tag.clear()[rows]

     page.renderer(headers, rows)


This is one possible way to do it, and it works now,
with the current nevow release.

Note that the template is generally similar to your
original one, and we've kept the looping out of the
template.

The most important thing is to stop thinking in terms
of data types (render=&quot;sequence&quot;, render=&quot;string&quot;),
and just write render methods that deal with app-level
concepts (headers, rows).

An important point to make here, is that the code I
provided above is based on the same code used to
implement the &quot;sequence&quot; directive, so there is really
nothing magical going on.

&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanks and regards  Manlio Perillo
</I>
Hope this helps,

L. Daniel Burr

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003221.html">[Twisted-web] [Nevow] template performance
</A></li>
	<LI>Next message: <A HREF="003227.html">[Twisted-web] [Nevow] template performance
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3226">[ date ]</a>
              <a href="thread.html#3226">[ thread ]</a>
              <a href="subject.html#3226">[ subject ]</a>
              <a href="author.html#3226">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
