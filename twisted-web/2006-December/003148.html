<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] How to nest LiveElements? (getting a
	MissingRenderMethod error)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20How%20to%20nest%20LiveElements%3F%20%28getting%20a%0A%09MissingRenderMethod%20error%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="003149.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] How to nest LiveElements? (getting a
	MissingRenderMethod error)</H1>
    <B>kgi</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20How%20to%20nest%20LiveElements%3F%20%28getting%20a%0A%09MissingRenderMethod%20error%29&In-Reply-To="
       TITLE="[Twisted-web] How to nest LiveElements? (getting a
	MissingRenderMethod error)">iacovou at gmail.com
       </A><BR>
    <I>Fri Dec  1 07:35:34 CST 2006</I>
    <P><UL>
        
        <LI>Next message: <A HREF="003149.html">[Twisted-web] How to nest LiveElements? (getting a
	MissingRenderMethod error)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3148">[ date ]</a>
              <a href="thread.html#3148">[ thread ]</a>
              <a href="subject.html#3148">[ subject ]</a>
              <a href="author.html#3148">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi there.

I've got a web app that was originally written as a bunch of LiveElements at 
the top level of a LivePage. I want to clean up this code and restructure it 
such that several of the LiveElements are more modular; this entails making 
some of the LiveElements contain other LiveElements.

Now, I could have *sworn* I've done this before, but whatever I try to do now 
I get a nevow.errors.MissingRenderMethod exception.

At the end of this email is a cut-down example that exhibits the behaviour. 
OuterWidget and InnerWidget are two LiveElement objects; they can both exist 
happily in the LivePage, but if you uncomment the div containing an 
innerWidget rendering directive (around line 28) you get:

          File &quot;/usr/lib/python2.4/site-packages/nevow/flat/ten.py&quot;, line 70, 
in serialize
            return partialflatten(context, obj)
          File &quot;/usr/lib/python2.4/site-packages/nevow/flat/ten.py&quot;, line 61, 
in partialflatten
            return flattener(obj, context)
          File &quot;/usr/lib/python2.4/site-packages/nevow/flat/flatstan.py&quot;, line 
261, in DirectiveSerializer
            renderer = rendererFactory.renderer(context, original.name)
          File &quot;/usr/lib/python2.4/site-packages/nevow/page.py&quot;, line 78, in 
renderer
            raise MissingRenderMethod(self, name)
        nevow.errors.MissingRenderMethod: (&lt;OuterWidget object at 
0xb763482c&gt;, 'innerWidget')

Can anyone shed any light on this?

There are also seemingly three styles for render methods that I've found. The 
third was kind of guessed from the documentation of nevow.page.Element; I'm 
not sure I've used it correctly, but I seem to recall reading that the 
special &quot;render_&quot; prefixes will be going away and replaced by a renderer() 
registration method, like the expose() method for athena callables.

Which is the preferred form?

    def render_innerWidget ( self, ctx, data ):
        elem = InnerWidget()
        elem.setFragmentParent ( self )
        return elem

   def render_innerWidget ( self, ctx, data ):
        elem = InnerWidget()
        elem.setFragmentParent ( self )
        return ctx.tag[f]

   from nevow.page import renderer
   def innerWidget ( self, request, tag ):
        elem = InnerWidget()
        elem.setFragmentParent ( self )
        return elem
   renderer(items)

Thanks,

Ricky

--


# Run using 'twistd -noy file.py'; point browser to localhost:8080

from nevow import athena
from nevow import stan
from nevow import loaders
from nevow import tags as T
from nevow import flat
from nevow import static


class InnerWidget ( athena.LiveElement ):

    docFactory = loaders.stan (
        T.div (
            render = T.directive ( 'liveElement' ),
            ) [
                T.p ( _class = 'bar' ) [ &quot;This is InnerWidget text&quot; ]
            ]
    )


class OuterWidget ( athena.LiveElement ):

    docFactory = loaders.stan (
        T.div (
            render = T.directive ( 'liveElement' ),
            ) [
                T.p ( _class = &quot;foo&quot; ) [ &quot;This is OuterWidget text&quot; ],
                # I can't create an InnerWidget inside the OuterWidget.
                # T.div ( render = T.directive ( &quot;innerWidget&quot; ) ),
            ]
    )

    def render_innerWidget ( self, ctx, data ):
        elem = InnerWidget()
        elem.setFragmentParent ( self )
        return ctx.tag[f]


class WebApp ( athena.LivePage ):

    DOCTYPE_XHTML = (
        '&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; '
        '&quot;<A HREF="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;">http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;</A>&gt;'
    )

    _css = T.link (
        rel = &quot;stylesheet&quot;, type = &quot;text/css&quot;, href = &quot;css/style.css&quot;
    )

    docFactory = loaders.stan (
        [
            T.xml ( DOCTYPE_XHTML ),
            T.html [
                T.head ( render = T.directive ( 'liveglue' ) ) [ _css ],
                T.body [
                    T.div ( render = T.directive ( 'outerWidget') ),

                    # But I can create an InnerWidget at the top-level, inside
                    # athena.LivePage.
                    T.div ( render = T.directive ( 'innerWidget') ),
                ]
            ]
        ]
    )
    
    addSlash = True

    def render_outerWidget ( self, ctx, data ):
        f = OuterWidget()
        f.setFragmentParent(self)
        return ctx.tag[f]


    def render_innerWidget ( self, ctx, data ):
        f = InnerWidget()
        f.setFragmentParent(self)
        return ctx.tag[f]


    def child_css ( self, ctx ):
        return static.File ( 'css' )


    def child_js ( self, ctx ):
        return static.File ( 'js' )

    
from twisted.application import service, internet
from nevow import appserver

res = WebApp()

site = appserver.NevowSite ( res )

application = service.Application ( &quot;WebApp&quot; )
webService = internet.TCPServer ( 8080, site )
webService.setServiceParent ( application )

--


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="003149.html">[Twisted-web] How to nest LiveElements? (getting a
	MissingRenderMethod error)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3148">[ date ]</a>
              <a href="thread.html#3148">[ thread ]</a>
              <a href="subject.html#3148">[ subject ]</a>
              <a href="author.html#3148">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
