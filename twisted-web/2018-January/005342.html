<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Nevow and python 3
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-web%5D%20Nevow%20and%20python%203&In-Reply-To=%3C1516820195.2104744.1246880168.03A58840%40webmail.messagingengine.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="005341.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Nevow and python 3</H1>
    <B>Glyph</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-web%5D%20Nevow%20and%20python%203&In-Reply-To=%3C1516820195.2104744.1246880168.03A58840%40webmail.messagingengine.com%3E"
       TITLE="[Twisted-web] Nevow and python 3">glyph at twistedmatrix.com
       </A><BR>
    <I>Wed Jan 24 11:56:35 MST 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005341.html">[Twisted-web] Nevow and python 3
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5342">[ date ]</a>
              <a href="thread.html#5342">[ thread ]</a>
              <a href="subject.html#5342">[ subject ]</a>
              <a href="author.html#5342">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On Wed, Jan 24, 2018, at 12:54 AM, Markus Demleitner wrote:
&gt;<i> Hi Glyph,
</I>&gt;<i> 
</I>&gt;<i> On Tue, Jan 23, 2018 at 11:51:44PM -0800, Glyph wrote:
</I>&gt;<i> &gt; &gt; On Jan 23, 2018, at 2:03 AM, Markus Demleitner &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">msdemlei at ari.uni-heidelberg.de</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; through from twisted.web quite unsatisfying.  I've tried to formulate
</I>&gt;<i> &gt; &gt; something like a preliminary policy in
</I>&gt;<i> &gt; &gt; <A HREF="https://github.com/msdemlei/nevow/blob/master/doc/strings_and_bytes.rst,">https://github.com/msdemlei/nevow/blob/master/doc/strings_and_bytes.rst,</A>
</I>&gt;<i> &gt; &gt; but I'm deeply unhappy about most of this.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Yeah, IRequest is an unfortunate interface.  Work is ongoing to
</I>&gt;<i> &gt; design a more thoughtful one and gradually migrate to it.  I think
</I>&gt;<i> &gt; <A HREF="https://github.com/wsanchez/txrequest">https://github.com/wsanchez/txrequest</A>
</I>&gt;<i> &gt; &lt;<A HREF="https://github.com/wsanchez/txrequest">https://github.com/wsanchez/txrequest</A>&gt; is getting pretty complete,
</I>&gt;<i> &gt; and from there the hope is that it will get integrated into Klein
</I>&gt;<i> &gt; and then upstreamed into Twisted.
</I>&gt;<i> 
</I>&gt;<i> ...which of course looks like a very long migration path, very likely
</I>&gt;<i> stretching far beyond python2's EOL if my typical deployment is on
</I>&gt;<i> Debian stable...
</I>
Shorter the more people we have working on it :-).

&gt;<i> I wonder if one couldn't arrange for inevow.IRequest to adapt to
</I>&gt;<i> essentially this (perhaps with a bit more glue code to keep
</I>&gt;<i> as compatible with existing code as possible).
</I>
This would be great.

&gt;<i> &gt; &gt; Ideally, I'd like to fairly exclusively expose actual strings to
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; &quot;actual&quot; meaning text?
</I>&gt;<i> 
</I>&gt;<i> Yes: str.
</I>&gt;<i> 
</I>&gt;<i> &gt; &gt; (2) Is anyone at all interested in the livepages stuff (I'm not, and
</I>&gt;<i> &gt; &gt; dropping it would certainly make porting and maintaining the package
</I>&gt;<i> &gt; &gt; a lot easier)?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; If you're going to drop livepage, is there any reason you're not
</I>&gt;<i> &gt; just migrating to twisted.web.template?  Is there any way t.w.t
</I>&gt;<i> &gt; could be made into an easier migration path?
</I>&gt;<i> 
</I>&gt;<i> I have to admit I've not really investigated t.w.t in any detail; one
</I>&gt;<i> thing that actually does matter -- because templates of my users will
</I>&gt;<i> silently fail with it -- is the change of the XML namespace for the
</I>&gt;<i> nevow elements and attributes.  
</I>&gt;<i> 
</I>&gt;<i> I suppose one could work around it on template load, though.  Hm --
</I>&gt;<i> this might be an interesting alternative to keeping all of nevow.
</I>
I don't pretend to have a complete solution here - unfortunately I've ported very few projects *from* nevow *to* t.w.t so almost no work has gone into migration or compatibility.  But I do think there's definitely something to investigate.

&gt;<i> Of course, that still doesn't help against the insiduous breakage
</I>&gt;<i> when suddenly code needs to deal with byte strings coming out of
</I>&gt;<i> request.args.keys(), path components, and headers; that's a bit less
</I>&gt;<i> of a direct concern for me since it's much less deployer-visible for
</I>&gt;<i> my applications, but if I have to write some compatibility layer, why
</I>&gt;<i> not have nevow be it?
</I>
This is largely about aligning as much effort as possible in one place :).  Our goals are not exactly the same of course, you want Nevow+Py3, and most Klein interest right now is primarily around APIs rather than HTML, but this is exactly why extracting the request-processing fix to the lowest shared level is important :).

&gt;<i> &gt; &gt; (3) If I went ahead with this and actually tried to get a
</I>&gt;<i> &gt; &gt; python3-nevow into Debian (which I'd really, really like to see): How
</I>&gt;<i> &gt; &gt; is everyone's feeling about keeping the name nevow even if serious
</I>&gt;<i> &gt; &gt; functional changes (such as dropping livepages) were to come about?
</I>&gt;<i> &gt; &gt; [What I care about most is keeping the templating system including
</I>&gt;<i> &gt; &gt; the render_ and data_ methods].
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; If you're going to do a fork, please come up with a new name.
</I>&gt;<i> &gt; Using the existing one is confusing, it causes namespace conflicts
</I>&gt;<i> &gt; (what happens when Nevow itself gets some upstream patches that
</I>&gt;<i> &gt; port it to python 3 from someone else?) and it causes import
</I>&gt;<i> &gt; conflicts.
</I>&gt;<i> 
</I>&gt;<i> Fair enough (a bit more on this in my response to Werner).
</I>
I do hope we can figure out a way to work together! Although if a fork is necessary there will definitely be no hard feelings - the logistics on that are hard.

&gt;<i> &gt; That said, if you are interested in porting Nevow the same way that
</I>&gt;<i> &gt; Twisted is being ported (i.e. there's one set of sources, but `pip
</I>&gt;<i> &gt; install` on python 3 only installs the modules ported thus far)
</I>&gt;<i> 
</I>&gt;<i> Ouch -- given my experiences while porting it would seem a major
</I>&gt;<i> chore to keep python2 compatibity.  But then I've not tried, and I
</I>&gt;<i> may be wrong.   If I actually wanted to follow
</I>&gt;<i> <A HREF="https://twistedmatrix.com/trac/wiki/Plan/Python3">https://twistedmatrix.com/trac/wiki/Plan/Python3</A> by the letter,
</I>&gt;<i> that's certainly far beyond what I can reasonably commit in terms of
</I>&gt;<i> resources.
</I>
Doing this at the very start of the project (Python2.5 + Python3.2) was agonizing; barely practical. But today (Python2.7 + Python3.4) is mostly quite pleasant.

&gt;<i> &gt; then that would certainly be a way to invest the effort in just
</I>&gt;<i> &gt; porting the parts that you need, and letting someone else port
</I>&gt;<i> &gt; LivePage later :).  I'd be happy to make you a maintainer if you're
</I>&gt;<i> &gt; interested in doing this - not a lot of other activity on Nevow
</I>&gt;<i> &gt; right now!
</I>&gt;<i> 
</I>&gt;<i> I'd certainly like to make the effort I invest as worthwhile as
</I>&gt;<i> possible; but, in particular after the experience of porting, I feel
</I>&gt;<i> I'm not nearly as familiar with nevow's codebase (and customs in the
</I>&gt;<i> twisted ecosystem) as I should be to confidently work as maintainer.
</I>
There's really only one way to become familiar with these things - jump right in! :)

&gt;<i> Before I commit to anything, let me try to work out if I can get
</I>&gt;<i> nevow to the point where it doesn't cause extra porting pains in the
</I>&gt;<i> python3 migration of dependent code.
</I>
I don't want to pressure you into any commitments you're uncomfortable with; as you said, just wanting to making the investment of your effort worthwhile.  Sounds like your mind is in the right place though; let me know when you have completed your investigations :).

-g

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005341.html">[Twisted-web] Nevow and python 3
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5342">[ date ]</a>
              <a href="thread.html#5342">[ thread ]</a>
              <a href="subject.html#5342">[ subject ]</a>
              <a href="author.html#5342">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
