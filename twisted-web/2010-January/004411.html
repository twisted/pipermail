<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Parallelism is twisted
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Parallelism%20is%20twisted&In-Reply-To=8181edc01001061804s20cc0600of32c2ef206082c66%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004412.html">
   <LINK REL="Next"  HREF="004413.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Parallelism is twisted</H1>
    <B>Andreas Kostyrka</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Parallelism%20is%20twisted&In-Reply-To=8181edc01001061804s20cc0600of32c2ef206082c66%40mail.gmail.com"
       TITLE="[Twisted-web] Parallelism is twisted">andreas at kostyrka.org
       </A><BR>
    <I>Wed Jan  6 22:16:53 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="004412.html">[Twisted-web] Parallelism is twisted
</A></li>
        <LI>Next message: <A HREF="004413.html">[Twisted-web] upload and receive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4411">[ date ]</a>
              <a href="thread.html#4411">[ thread ]</a>
              <a href="subject.html#4411">[ subject ]</a>
              <a href="author.html#4411">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Am Mittwoch, den 06.01.2010, 20:04 -0600 schrieb arun chhetri:
&gt;<i> First of all I would like to thank to developer of twisted for making
</I>&gt;<i> such a great platform for network applications,, I just love it...
</I>&gt;<i> But for theory point of view I want to clear some of my doubts.
</I>&gt;<i> 
</I>&gt;<i> 1) What is the underlying technology?
</I>&gt;<i> As, I believe that twisted is a TCP server which which uses select()
</I>&gt;<i> based call to handle multiple requests. Is it true or there is
</I>&gt;<i> something else which I am not aware of.
</I>
Basically yes. It uses select or more or less equivalent techniques to
do an event handling loop. It's called a reactor in Twisted ;)

&gt;<i> 
</I>&gt;<i> 2) So, if twisted is single process based network application
</I>&gt;<i> framework (without threads and forks),, I believe it cannot take
</I>&gt;<i> advantage of multiple processor residing on one machine. For e.g. if
</I>&gt;<i> OS schedule twisted process on one processor,, that's it,, it can only
</I>&gt;<i> run on same processor not taking advantage of multiple processor. I am
</I>&gt;<i> kind of confused in this question. Can anyone shed some light on this?
</I>
Correctly. If you want to use multiple processors, you should consider
running multiple processes, e.g. using load balancing.

&gt;<i> 
</I>&gt;<i> 3) So, suppose I have one twisted reactor based process running,, I
</I>&gt;<i> can use defferToThread as one of the way to kind of using multiple
</I>&gt;<i> processing?
</I>
Yes and no. Yes it runs in a thread. Yes, in some cases you can use many
cores this way. But no, Python with it's GIL is not the perfect language
to write threaded programs that want to use threads for performance.

&gt;<i> 
</I>&gt;<i> 4) So, one of the technique to achieve parallelism is by running
</I>&gt;<i> multiple twisted reactor on different processor and using some
</I>&gt;<i> scheduler which takes the web request and forwards that request to
</I>&gt;<i> different twisted reactor instance on different processor. 
</I>&gt;<i> This is close to Load balancing as we can also use the upper
</I>&gt;<i> architecture and configure the scheduler to schedule requests to
</I>&gt;<i> different computers.
</I>
Exactly. Or you can split the work asymetrically, I once had a server
that did the work (data lookups), but used multiple backends for
different languages (1 for French, a couple of English lookup
processes).

One thing to consider is that Twisted, when done correctly is rather
efficient. 

2 experiences from my work come to mind:

-) once I've done a web crawler in Twisted without any consideration how
many connections I create. The website which was not a first tier
operation (like Google, Yahoo, MSN, ...), but still some commerical
offering was DoSed in seconds. Twisted has no problem with opening 20000
http connections (if you give it the file descriptors to manage that),
but typical sites, don't take that very well. Lesson to consider: Always
consider your server and client capabilities, and rate limit stuff as
needed.

-) I've also done some years ago a delivery network, that patched files
on the fly (by substituting a couple of bytes, nothing eleborate, but it
did complicate the reading and sending of the data). Even early versions
of that http server (it was twisted.web2 back then) where capable to
fill a Gigabit pipe without issues.

So the &quot;single-threadness&quot; of Twisted (and in some ways of Python) is
not that big an issue, other moving parts will probably limit you first,
e.g. SQL databases are notorious for being a choking point for scaling.

Andreas
&gt;<i> 
</I>&gt;<i> Many of the questions might sound weird,, and please feel free to
</I>&gt;<i> write any comment. 
</I>&gt;<i> Thanks
</I>&gt;<i> Arun
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-web mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">Twisted-web at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web</A>
</I>

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004412.html">[Twisted-web] Parallelism is twisted
</A></li>
	<LI>Next message: <A HREF="004413.html">[Twisted-web] upload and receive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4411">[ date ]</a>
              <a href="thread.html#4411">[ thread ]</a>
              <a href="subject.html#4411">[ subject ]</a>
              <a href="author.html#4411">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
