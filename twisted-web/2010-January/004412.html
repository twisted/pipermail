<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Parallelism is twisted
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Parallelism%20is%20twisted&In-Reply-To=A0B4B1BB-B9CE-4B8A-9914-3BE486006E0C%40twistedmatrix.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004410.html">
   <LINK REL="Next"  HREF="004411.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Parallelism is twisted</H1>
    <B>Andreas Kostyrka</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Parallelism%20is%20twisted&In-Reply-To=A0B4B1BB-B9CE-4B8A-9914-3BE486006E0C%40twistedmatrix.com"
       TITLE="[Twisted-web] Parallelism is twisted">andreas at kostyrka.org
       </A><BR>
    <I>Wed Jan  6 22:28:07 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="004410.html">[Twisted-web] Parallelism is twisted
</A></li>
        <LI>Next message: <A HREF="004411.html">[Twisted-web] Parallelism is twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4412">[ date ]</a>
              <a href="thread.html#4412">[ thread ]</a>
              <a href="subject.html#4412">[ subject ]</a>
              <a href="author.html#4412">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Am Mittwoch, den 06.01.2010, 22:02 -0500 schrieb Glyph Lefkowitz:

&gt;<i> &gt; 3) So, suppose I have one twisted reactor based process running,, I can use defferToThread as one of the way to kind of using multiple processing?
</I>&gt;<i> 
</I>&gt;<i> No, not really.  Threads in python are bound by the global interpreter lock and are therefore not that useful for using multiple processors.
</I>
While this is generally true, in specific cases you can use it for
speeding up by using multiple cores. One example would be a program that
does image manipulation via PIL. PIL does release the GIL before it
starts to munch on the image, hence you can achieve more than 100% user
time :)

One script that I use to scale images does manage, in ideal settings
over 300% user time; the trick being to use a couple of threads more
than I've got cpu cores, this way a couple of threads can inform the
Linux kernel what files the process is interested in. This way, the CPU
has usually enough work to do the work, and as most work is spent in C
code in PIL, the GIL does not limit CPU utilization.

But generally speaking as Glyph has mentioned, Python usually can use
only one CPU core per process. The reason for that you need to hold a
single global lock to access the virtual machine, but also the runtime
in any way.

So some C function, can do something like that:

* extract input arguments from PyObjects.
* release GIL
* munch munch
* reacquire GIL
* create PyObjects for return state.

notice that only code that in no way touches the Python runtime can run
without the GIL being hold.

Andreas

&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-web mailing list
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">Twisted-web at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004410.html">[Twisted-web] Parallelism is twisted
</A></li>
	<LI>Next message: <A HREF="004411.html">[Twisted-web] Parallelism is twisted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4412">[ date ]</a>
              <a href="thread.html#4412">[ thread ]</a>
              <a href="subject.html#4412">[ subject ]</a>
              <a href="author.html#4412">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
