<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Asynchronous responses example from documentation -- why import time??
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-web%5D%20Asynchronous%20responses%20example%20from%20documentation%20--%0A%20why%20import%20time%3F%3F&In-Reply-To=%3CCAHVLaBG_fE65Vb-b1Mt9Ew9AR3TiSHTDdkQw3S8Wgka8poY1QA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   
   <LINK REL="Next"  HREF="005348.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Asynchronous responses example from documentation -- why import time??</H1>
    <B>Jason Harrison</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-web%5D%20Asynchronous%20responses%20example%20from%20documentation%20--%0A%20why%20import%20time%3F%3F&In-Reply-To=%3CCAHVLaBG_fE65Vb-b1Mt9Ew9AR3TiSHTDdkQw3S8Wgka8poY1QA%40mail.gmail.com%3E"
       TITLE="[Twisted-web] Asynchronous responses example from documentation -- why import time??">drjasonharrison at gmail.com
       </A><BR>
    <I>Wed Aug  8 09:48:35 MDT 2018</I>
    <P><UL>
        
        <LI>Next message (by thread): <A HREF="005348.html">[Twisted-web] Asynchronous responses example from documentation -- why import time??
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5347">[ date ]</a>
              <a href="thread.html#5347">[ thread ]</a>
              <a href="subject.html#5347">[ subject ]</a>
              <a href="author.html#5347">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I am learning twisted-web by attempting each of the examples in the
documentation and making any (small) changes necessary for Python 3.
However when I got to the Aysnchronous Responses example I was not able to
get it to work. The example is at:

<A HREF="https://twistedmatrix.com/documents/current/web/howto/web-in-60/asynchronous.html">https://twistedmatrix.com/documents/current/web/howto/web-in-60/asynchronous.html</A>

I have adapted it to be a self-contained &quot;server&quot; rather than a .rpy
snippet but the response was always a 404.  After much head scratching and
comparison to other examples, I discovered that by adding &quot;import time&quot; to
my &quot;server&quot; it started working.

Why is &quot;import time&quot; required. What is happening without the &quot;import time&quot;?

-Jason

Cell: 604 644 8611
Email: <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">drjasonharrison at gmail.com</A>
LinkedIn: <A HREF="http://www.linkedin.com/in/drjasonharrison">http://www.linkedin.com/in/drjasonharrison</A>
Twitter: <A HREF="http://twitter.com/drjasonharrison">http://twitter.com/drjasonharrison</A>



#!/usr/bin/env python3
#
<A HREF="https://twistedmatrix.com/documents/current/web/howto/web-in-60/asynchronous.html">https://twistedmatrix.com/documents/current/web/howto/web-in-60/asynchronous.html</A>
# Asynchronous responses,
#
# try
# - <A HREF="http://localhost:8888">http://localhost:8888</A>

import sys
from twisted.web.server import Site
from twisted.web.resource import Resource
from twisted.internet import reactor, endpoints
from twisted.web.resource import NoResource
from twisted.web.server import NOT_DONE_YET
from twisted.python import log
import time #???

log.startLogging(sys.stdout)
observer = log.PythonLoggingObserver()
observer.start()

class DelayedResource(Resource):
    def _delayedRender(self, request):
        log.msg(&quot;_delayedRender request {request!r}&quot;, request = request)
        request.write(b&quot;&lt;html&gt;&lt;body&gt;Sorry to keep you
waiting.&lt;/body&gt;&lt;/html&gt;&quot;)
        request.finish()

    def render_GET(self, request):
        log.msg(&quot;get request {request!r}&quot;, request = request)
        reactor.callLater(5, self._delayedRender, request)
        return NOT_DONE_YET

resource = DelayedResource()
factory = Site(resource)
endpoint = endpoints.TCP4ServerEndpoint(reactor, 8888)
endpoint.listen(factory)
log.msg(&quot;running reactor&quot;)
reactor.run()
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-web/attachments/20180808/0465e62c/attachment.html&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message (by thread): <A HREF="005348.html">[Twisted-web] Asynchronous responses example from documentation -- why import time??
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5347">[ date ]</a>
              <a href="thread.html#5347">[ thread ]</a>
              <a href="subject.html#5347">[ subject ]</a>
              <a href="author.html#5347">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
