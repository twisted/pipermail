<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Asynchronous responses example from documentation -- why import time??
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-web%5D%20Asynchronous%20responses%20example%20from%20documentation%0A%20--%20why%20import%20time%3F%3F&In-Reply-To=%3CCAEeXt4P3z1qBY8dD6GrGr2TUX4LHMSFByzFN07NQi11vW81ivw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="005347.html">
   <LINK REL="Next"  HREF="005349.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Asynchronous responses example from documentation -- why import time??</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-web%5D%20Asynchronous%20responses%20example%20from%20documentation%0A%20--%20why%20import%20time%3F%3F&In-Reply-To=%3CCAEeXt4P3z1qBY8dD6GrGr2TUX4LHMSFByzFN07NQi11vW81ivw%40mail.gmail.com%3E"
       TITLE="[Twisted-web] Asynchronous responses example from documentation -- why import time??">exarkun at twistedmatrix.com
       </A><BR>
    <I>Wed Aug  8 09:58:37 MDT 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005347.html">[Twisted-web] Asynchronous responses example from documentation -- why import time??
</A></li>
        <LI>Next message (by thread): <A HREF="005349.html">[Twisted-web] Asynchronous responses example from documentation -- why import time??
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5348">[ date ]</a>
              <a href="thread.html#5348">[ thread ]</a>
              <a href="subject.html#5348">[ subject ]</a>
              <a href="author.html#5348">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Aug 8, 2018 at 11:51 AM Jason Harrison &lt;<A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">drjasonharrison at gmail.com</A>&gt;
wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I am learning twisted-web by attempting each of the examples in the
</I>&gt;<i> documentation and making any (small) changes necessary for Python 3.
</I>&gt;<i> However when I got to the Aysnchronous Responses example I was not able to
</I>&gt;<i> get it to work. The example is at:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://twistedmatrix.com/documents/current/web/howto/web-in-60/asynchronous.html">https://twistedmatrix.com/documents/current/web/howto/web-in-60/asynchronous.html</A>
</I>&gt;<i>
</I>&gt;<i> I have adapted it to be a self-contained &quot;server&quot; rather than a .rpy
</I>&gt;<i> snippet but the response was always a 404.  After much head scratching
</I>&gt;<i> and comparison to other examples, I discovered that by adding &quot;import time&quot;
</I>&gt;<i> to my &quot;server&quot; it started working.
</I>&gt;<i>
</I>&gt;<i> Why is &quot;import time&quot; required. What is happening without the &quot;import time&quot;?
</I>&gt;<i>
</I>&gt;<i>
</I>One possible explanation is that it has nothing to do with import time per
se.  Instead, *any* change to your source file would have fixed the
problem.  This could be because you had &quot;stale&quot; pyc files lying around
(cached bytecode the interpreter *thought* was up-to-date with your source
but was actually outdated).  It could also be that your server process was
left running and was still using your old code.  Then, for some reason,
after you added the import time your server got the new version of the code
(perhaps you're relying on an auto-reloader and it missed a change, for
example, or you just forgot to restart the server yourself).

import time itself is definitely not a requirement for arbitrary Twisted
Web-based programs to return a response other than 404.

Jean-Paul


&gt;<i> -Jason
</I>&gt;<i>
</I>&gt;<i> Cell: 604 644 8611
</I>&gt;<i> Email: <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">drjasonharrison at gmail.com</A>
</I>&gt;<i> LinkedIn: <A HREF="http://www.linkedin.com/in/drjasonharrison">http://www.linkedin.com/in/drjasonharrison</A>
</I>&gt;<i> Twitter: <A HREF="http://twitter.com/drjasonharrison">http://twitter.com/drjasonharrison</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> #!/usr/bin/env python3
</I>&gt;<i> #
</I>&gt;<i> <A HREF="https://twistedmatrix.com/documents/current/web/howto/web-in-60/asynchronous.html">https://twistedmatrix.com/documents/current/web/howto/web-in-60/asynchronous.html</A>
</I>&gt;<i> # Asynchronous responses,
</I>&gt;<i> #
</I>&gt;<i> # try
</I>&gt;<i> # - <A HREF="http://localhost:8888">http://localhost:8888</A>
</I>&gt;<i>
</I>&gt;<i> import sys
</I>&gt;<i> from twisted.web.server import Site
</I>&gt;<i> from twisted.web.resource import Resource
</I>&gt;<i> from twisted.internet import reactor, endpoints
</I>&gt;<i> from twisted.web.resource import NoResource
</I>&gt;<i> from twisted.web.server import NOT_DONE_YET
</I>&gt;<i> from twisted.python import log
</I>&gt;<i> import time #???
</I>&gt;<i>
</I>&gt;<i> log.startLogging(sys.stdout)
</I>&gt;<i> observer = log.PythonLoggingObserver()
</I>&gt;<i> observer.start()
</I>&gt;<i>
</I>&gt;<i> class DelayedResource(Resource):
</I>&gt;<i>     def _delayedRender(self, request):
</I>&gt;<i>         log.msg(&quot;_delayedRender request {request!r}&quot;, request = request)
</I>&gt;<i>         request.write(b&quot;&lt;html&gt;&lt;body&gt;Sorry to keep you
</I>&gt;<i> waiting.&lt;/body&gt;&lt;/html&gt;&quot;)
</I>&gt;<i>         request.finish()
</I>&gt;<i>
</I>&gt;<i>     def render_GET(self, request):
</I>&gt;<i>         log.msg(&quot;get request {request!r}&quot;, request = request)
</I>&gt;<i>         reactor.callLater(5, self._delayedRender, request)
</I>&gt;<i>         return NOT_DONE_YET
</I>&gt;<i>
</I>&gt;<i> resource = DelayedResource()
</I>&gt;<i> factory = Site(resource)
</I>&gt;<i> endpoint = endpoints.TCP4ServerEndpoint(reactor, 8888)
</I>&gt;<i> endpoint.listen(factory)
</I>&gt;<i> log.msg(&quot;running reactor&quot;)
</I>&gt;<i> reactor.run()
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Twisted-web mailing list
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">Twisted-web at twistedmatrix.com</A>
</I>&gt;<i> <A HREF="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;/pipermail/twisted-web/attachments/20180808/6dffbf0f/attachment.html&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005347.html">[Twisted-web] Asynchronous responses example from documentation -- why import time??
</A></li>
	<LI>Next message (by thread): <A HREF="005349.html">[Twisted-web] Asynchronous responses example from documentation -- why import time??
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5348">[ date ]</a>
              <a href="thread.html#5348">[ thread ]</a>
              <a href="subject.html#5348">[ subject ]</a>
              <a href="author.html#5348">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
