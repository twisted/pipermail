<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] HTTP authentication and Nevow cred checker
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20HTTP%20authentication%20and%20Nevow%20cred%20checker&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003268.html">
   <LINK REL="Next"  HREF="003270.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] HTTP authentication and Nevow cred checker</H1>
    <B>KC Leong</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20HTTP%20authentication%20and%20Nevow%20cred%20checker&In-Reply-To="
       TITLE="[Twisted-web] HTTP authentication and Nevow cred checker">mewanttowork at gmail.com
       </A><BR>
    <I>Mon Jan 29 06:50:06 CST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="003268.html">[Twisted-web] Re: Twisted Flickr API library
</A></li>
        <LI>Next message: <A HREF="003270.html">[Twisted-web] HTTP authentication and Nevow cred checker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3269">[ date ]</a>
              <a href="thread.html#3269">[ thread ]</a>
              <a href="subject.html#3269">[ subject ]</a>
              <a href="author.html#3269">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

With Twisted and Nevow I'm building an XML-RPC server that does HTTP
authentication. So a basic XML-RPC client can login using
<A HREF="https://user:passwd@host.">https://user:passwd@host.</A> I can get the credentials with HTTP
authentication, but how can I check the credentials. I'd tried calling
guard.SessionWrapper.login(....), but I get the error: &quot;exceptions.TypeError:
unbound method login() must be called with SessionWrapper instance as first
argument (got NevowRequest instance instead)&quot;.

So I'm guessing that request.getSession() is wrong and I must get the
session of the guard (or something similar). Or I'm calling the wrong
function to check the creds. In the guarded.py example from Nevow the
credentials get checked thru a html form, but that is not what I want.

Below is an example part of my code:

class RootPage(rend.Page):
    ## We are a directory-like resource because we are at the root
    addSlash = True
    ## Doesn't work
    def tryLogin(self, ctx, request):
        session =  request.getSession()
        segments = inevow.ICurrentSegments(ctx)
        httpAuthCredentials = (self.data_username,self.data_password)
        return guard.SessionWrapper.login(request, session,
httpAuthCredentials, segments).addCallback(self._loginSucceeded).addErrback(
self.loginFailed)

    def renderHTTP(self, ctx):
        request = inevow.IRequest(ctx)
        username, password = request.getUser(), request.getPassword()
        ## No REAL authentication yet, must implement it.
        if (username, password) == ('', ''):
            request.setHeader('WWW-Authenticate', 'Basic
realm='+cfg.app_name)
            request.setResponseCode(http.UNAUTHORIZED)
            return &quot;Authentication required.&quot;
        ## They provided a username and password, so let's let them in!
horray
        self.data_username, self.data_password = username, password

        self.tryLogin(ctx, request)
        return rend.Page.renderHTTP(self, ctx)

    docFactory = loaders.stan(tags.html[
    tags.body[
        tags.h1[&quot;Welcome user!&quot;],
        tags.div[&quot;You said: &quot;,
            tags.span(data=tags.directive('username'), render=str),
            &quot; &quot;,
            tags.span(data=tags.directive('password'), render=str),
            tags.a(href=guard.LOGOUT_AVATAR)[&quot;Logout&quot;]
            ]]])

Regards,

Kim Chee Leong
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20070129/e78a6de1/attachment.htm">http://twistedmatrix.com/pipermail/twisted-web/attachments/20070129/e78a6de1/attachment.htm</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003268.html">[Twisted-web] Re: Twisted Flickr API library
</A></li>
	<LI>Next message: <A HREF="003270.html">[Twisted-web] HTTP authentication and Nevow cred checker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3269">[ date ]</a>
              <a href="thread.html#3269">[ thread ]</a>
              <a href="subject.html#3269">[ subject ]</a>
              <a href="author.html#3269">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
