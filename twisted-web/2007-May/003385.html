<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Trouble chaining Javascript module calls in Athena
	(example code attached).
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Trouble%20chaining%20Javascript%20module%20calls%20in%20Athena%0A%09%28example%20code%20attached%29.&In-Reply-To=200705301753.11190.iacovou%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003384.html">
   <LINK REL="Next"  HREF="003387.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Trouble chaining Javascript module calls in Athena
	(example code attached).</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Trouble%20chaining%20Javascript%20module%20calls%20in%20Athena%0A%09%28example%20code%20attached%29.&In-Reply-To=200705301753.11190.iacovou%40gmail.com"
       TITLE="[Twisted-web] Trouble chaining Javascript module calls in Athena
	(example code attached).">exarkun at divmod.com
       </A><BR>
    <I>Wed May 30 11:12:32 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="003384.html">[Twisted-web] Trouble chaining Javascript module calls in Athena
	(example code attached).
</A></li>
        <LI>Next message: <A HREF="003387.html">[Twisted-web] Trouble chaining Javascript module calls in Athena
	(example code attached).
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3385">[ date ]</a>
              <a href="thread.html#3385">[ thread ]</a>
              <a href="subject.html#3385">[ subject ]</a>
              <a href="author.html#3385">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 30 May 2007 17:53:11 +0300, kgi &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">iacovou at gmail.com</A>&gt; wrote:
&gt;<i>On Wednesday 30 May 2007 15:15:56 Jean-Paul Calderone wrote:
</I>&gt;<i>
</I>&gt;<i>Hi Jean-Paul; thanks for your email - very helpful.
</I>&gt;<i>
</I>&gt;&gt;<i> Widgets on the client have a hierarchical relationship with each other
</I>&gt;&gt;<i> which reflects the hierarchical relationship of their corresponding
</I>&gt;&gt;<i> server-side LiveElement progenitors.  That is, if LiveElement B has
</I>&gt;&gt;<i> setFragmentParent called on it with LiveElement A as an argument, then
</I>&gt;&gt;<i> Widget B will have a widgetParent property which refers to Widget A;
</I>&gt;&gt;<i> similarly, Widget A's childWidgets array property will include widget B.
</I>&gt;&gt;<i> These relationships can be used to pass messages between widgets in the
</I>&gt;&gt;<i> browser without involving the server.
</I>&gt;<i>
</I>&gt;<i>Yep, I see the attributes for traversing along the hierarchy. Unless I've
</I>&gt;<i>misunderstood, in order for a widget's Javascript to be able to call another
</I>&gt;<i>widget's Javascript, it has to do something like:
</I>&gt;<i>
</I>&gt;<i>  self.widgetParent.widgetParent.widgetParent ...
</I>&gt;<i>childWidgets[0].childWidgets[1].doStuff()
</I>&gt;<i>
</I>&gt;<i>This feels somewhat wrong, partly because of fragility: if I move the location
</I>&gt;<i>of a widget in the hierarchy, its Javascript code will need updating.
</I>&gt;<i>
</I>
Yep.  One solution to this is to do something like:

    self.widgetParent.doStuffToSpecificThing()

Supplying an implementation of doStuffToSpecific for whatever the widget's
parent happens to be which knows about its position in the overall page
layout.  This keeps the inter-widget dependency limited to a single step.

&gt;<i>Is there a way of accessing another widget in the page directly by name? An
</I>&gt;<i>example might be a panel where I want any widget to be able to append status
</I>&gt;<i>messages.
</I>&gt;<i>
</I>&gt;<i>I would imagine this might entail assigning a user-controlled widget id to the
</I>&gt;<i>top-level DOM node of a LiveElement (as opposed to *subnodes* of the widget,
</I>&gt;<i>in which ids are rewritten for use by nodeById(), and which need the athena
</I>&gt;<i>id to access).
</I>&gt;<i>
</I>&gt;<i>I suppose the stan would look like this (this doesn't work, because the id
</I>&gt;<i>gets clobbered by the autogenerated id):
</I>&gt;<i>
</I>&gt;<i>    T.div ( _id = 'my-unique-id', render = T.directive ( &quot;mywidget&quot; ) ),
</I>&gt;<i>    T.div ( _id = 'another-unique-id', render = T.directive ( &quot;mywidget&quot; ) )
</I>&gt;<i>
</I>&gt;<i>Then in JS code of another widget:
</I>&gt;<i>
</I>&gt;<i>    w = self.getAthenaWidgetByName ( 'my-unique-id' );
</I>&gt;<i>    w.doStuff()
</I>&gt;<i>
</I>&gt;<i>Obviously, the LiveElement nodes are already all assigned a unique id, it's
</I>&gt;<i>just that it's done automatically and there's no obvious way of getting at
</I>&gt;<i>them ahead-of-time.
</I>&gt;<i>
</I>&gt;<i>I guess I could always cheat and wrap all LiveElements inside named divs and
</I>&gt;<i>do document.getElementById(), but that feels silly, given that the divs are
</I>&gt;<i>already named.
</I>&gt;<i>
</I>&gt;<i>There are plenty of methods in Nevow/nevow/js/Nevow/Athena/__init__.js for
</I>&gt;<i>getting hold of things but they all seem to need either the *numeric* athena
</I>&gt;<i>id (fromAthenaID, callByAthenaID) or a reference to a node (athenaIDFromNode,
</I>&gt;<i>athenaClassFromNode).
</I>&gt;<i>
</I>
Something about this approach rubs me the wrong way.  Identifiers which are
required to be globally unique sends one down the path of being limited to
only supporting certain page configurations.  Maybe if there were some well
defined algorithm for choosing the &quot;nearest&quot; widget with a given identifier,
something could be worked out.  I'm not too sure about this either, though.

You can already do something like this, though, if the class name is a
sufficient identifier for the widget you want (find the node with the right
value for athena:class, then find the widget associated with the node).
I tend to discourage this approach in favor of the one I gave at the top
of the message, though.

Jean-Paul

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003384.html">[Twisted-web] Trouble chaining Javascript module calls in Athena
	(example code attached).
</A></li>
	<LI>Next message: <A HREF="003387.html">[Twisted-web] Trouble chaining Javascript module calls in Athena
	(example code attached).
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3385">[ date ]</a>
              <a href="thread.html#3385">[ thread ]</a>
              <a href="subject.html#3385">[ subject ]</a>
              <a href="author.html#3385">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
