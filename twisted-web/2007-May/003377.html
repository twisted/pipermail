<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] XML-RPC and Authentication
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20XML-RPC%20and%20Authentication&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003375.html">
   <LINK REL="Next"  HREF="003378.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] XML-RPC and Authentication</H1>
    <B>Andrey</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20XML-RPC%20and%20Authentication&In-Reply-To="
       TITLE="[Twisted-web] XML-RPC and Authentication">alpha04 at netvigator.com
       </A><BR>
    <I>Sat May 26 16:09:24 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="003375.html">[Twisted-web] atomic log write
</A></li>
        <LI>Next message: <A HREF="003378.html">[Twisted-web] Trouble chaining Javascript module calls in Athena
	(example code attached).
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3377">[ date ]</a>
              <a href="thread.html#3377">[ thread ]</a>
              <a href="subject.html#3377">[ subject ]</a>
              <a href="author.html#3377">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>In the xmlrpc auth with auth.wrapper example below, how to pass the avatar 
information to the EXAMPLE(XML_RPC) class?
e.g.
=============================
xmlrpc_welcome(){
    return &quot;Welcome &quot;+username
}
=============================
Cheers
Andrey


from zope.interface import Interface, implements
from twisted.cred import portal
from twisted.cred import checkers
from twisted.web2 import channel
from twisted.web2 import http
from twisted.web2 import responsecode
from twisted.web2 import server
from twisted.web2 import xmlrpc
from twisted.web2.auth import digest
from twisted.web2.auth import basic
from twisted.web2.auth import wrapper

from twisted.application import service, strports

class IHTTPUser(Interface):
    pass

class HTTPUser(object):
    implements(IHTTPUser)

class HTTPAuthRealm(object):
    implements(portal.IRealm)

    def requestAvatar(self, avatarId, mind, *interfaces):
        if IHTTPUser in interfaces:            return IHTTPUser, HTTPUser()

        raise NotImplementedError(&quot;Only IHTTPUser interface is supported&quot;)

class Example(xmlrpc.XMLRPC):
    &quot;&quot;&quot;An example object to be published.&quot;&quot;&quot;

    addSlash = True

    def xmlrpc_echo(self, request, x):
        &quot;&quot;&quot;Return all passed args.&quot;&quot;&quot;
        return x

    def xmlrpc_add(self, request, a, b):
        &quot;&quot;&quot;Return sum of arguments.&quot;&quot;&quot;
        return a + b

portal = portal.Portal(HTTPAuthRealm())
checker = checkers.InMemoryUsernamePasswordDatabaseDontUse(guest='guest123')
portal.registerChecker(checker)
rsrc = Example()
credFactories = (basic.BasicCredentialFactory('My Realm'),
    digest.DigestCredentialFactory('md5', 'My Realm'))
ifaces = (IHTTPUser,)
root = wrapper.HTTPAuthResource(rsrc, credFactories, portal, ifaces)

site = server.Site(root)
application = service.Application(&quot;XML-RPC Auth Demo&quot;)
s = strports.service('tcp:8080', channel.HTTPFactory(site))
s.setServiceParent(application) 




</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003375.html">[Twisted-web] atomic log write
</A></li>
	<LI>Next message: <A HREF="003378.html">[Twisted-web] Trouble chaining Javascript module calls in Athena
	(example code attached).
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3377">[ date ]</a>
              <a href="thread.html#3377">[ thread ]</a>
              <a href="subject.html#3377">[ subject ]</a>
              <a href="author.html#3377">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
