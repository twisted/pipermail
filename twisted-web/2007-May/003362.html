<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Quick Questions about JS mapping in Athena.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Quick%20Questions%20about%20JS%20mapping%20in%20Athena.&In-Reply-To=200705171757.35710.iacovou%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003361.html">
   <LINK REL="Next"  HREF="003363.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Quick Questions about JS mapping in Athena.</H1>
    <B>Jean-Paul Calderone</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Quick%20Questions%20about%20JS%20mapping%20in%20Athena.&In-Reply-To=200705171757.35710.iacovou%40gmail.com"
       TITLE="[Twisted-web] Quick Questions about JS mapping in Athena.">exarkun at divmod.com
       </A><BR>
    <I>Thu May 17 11:31:59 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="003361.html">[Twisted-web] Quick Questions about JS mapping in Athena.
</A></li>
        <LI>Next message: <A HREF="003363.html">[Twisted-web] Quick Questions about JS mapping in Athena.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3362">[ date ]</a>
              <a href="thread.html#3362">[ thread ]</a>
              <a href="subject.html#3362">[ subject ]</a>
              <a href="author.html#3362">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 17 May 2007 17:57:35 +0300, kgi &lt;<A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">iacovou at gmail.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i>Hi all.
</I>&gt;<i>
</I>&gt;<i>I have a couple of quick questions regarding JS in Athena. At least, they're
</I>&gt;<i>quick to ask; I hope they're also quick to answer.
</I>&gt;<i>
</I>&gt;<i> [snip]
</I>&gt;<i>
</I>&gt;<i>So, my questions is: is there a way to register the JS mapping elsewhere? It
</I>&gt;<i>looks like modifying self.jsModules.mapping directly inside the constructor
</I>&gt;<i>of a LivePage might do it, but that feels hacky as heck.
</I>
This works, but I agree it has a hackish feel.

&gt;<i>
</I>&gt;<i>As an aside: I desperately don't want to ruffle any feathers here, but I also
</I>&gt;<i>feel that using the twisted plugins system to store what amounts to a
</I>&gt;<i>dictionary is a bit of a sledgehammer and nut thing. Since the actual
</I>&gt;<i>LiveElement classes don't even live in the same place as the mapping, it's
</I>&gt;<i>not as if the athena.JSPackages are really &quot;plugins&quot;, as they only contain
</I>&gt;<i>data, not code. Wouldn't having a &quot;jsFile&quot; attribute directly on the
</I>&gt;<i>LiveElements be more natural, since in any case, the renderer looks up
</I>&gt;<i>the &quot;jsClass&quot; attribute and looks up the corresponding JS file in jsModules?
</I>&gt;<i>Possibly in conjunction with an attribute (allElements?) on LivePage that you
</I>&gt;<i>can set to pre-declare all Elements you intend to use ahead of time so all
</I>&gt;<i>the JS gets included in the page in the same place).
</I>
The import system requires more or less complete knowledge of what modules
are defined in order to resolve dependencies.  If each LiveElement took
care to declaring which file it needed, then the page would need to be
rendered completely before Athena could figure out which modules needed to
be loaded, by which time it is a little too late to include them in the
page (perhaps this could be made to work, but it would be a hassle).

I can sympthatize somewhat with your desire to avoid conforming to the
structure required by the Twisted plugin system here, but I don't have a
better solution to suggest now.  In my copious spare time, I am trying to
push something better into Twisted (plugins are really a low level thing,
not what you actually want to be interacting with), but that's not likely
to see any results for quite a while to come.

I wouldn't be happy to see a solution that required declaring all LiveElement
classes a LivePage is going to use, since my own most common use-case for
LivePages involves my not having any idea what most of the LiveElements will
be (and in fact, changing what they will be with almost every render).  I'm
open to other suggestions and discussion about improving this area of Athena,
though.

&gt;<i>
</I>&gt;<i>Secondly, what are the requirements on the naming of JS packages? Many of the
</I>&gt;<i>examples use a dotted notation (&quot;Foo.Bar&quot;), but not all. Is there any
</I>&gt;<i>advantage on the JS side to having multiple modules share a top-level module
</I>&gt;<i>name (memory usage, runtime speed)? Are the strings significant at all? As
</I>&gt;<i>far as I can tell, the keys in the jsModules are arbitrary and just need to
</I>&gt;<i>match the jsClass declarations in the LiveElements and the &quot;// import&quot;
</I>&gt;<i>declarations in JS source files. Am I right in believing that there's no
</I>&gt;<i>requirement that they match the class instances actually used in the JS
</I>&gt;<i>source files?
</I>
The idea is to provide a package hierarchy, as Python has.  The strings will
be split on &quot;.&quot; in a couple places, but if there is simply no &quot;.&quot; in them,
this will work (since it is equivalent to any top-level name in an
arrangement which does use dotted names).  The goal of dotted names is to
avoid polluting the top-level namespace more than necessary.  For sanity's
sake, I would define classes in a module as attributes of that module, rather
than using arbitrary other names, but there's little or nothing Athena can
actually do to prevent this, and as long as you aren't clobbering any names
which Athena itself uses (and almost all such names are beneath the Divmod or
Nevow namespace), it probably won't do anything to interfer with Athena.

&gt;<i>
</I>&gt;<i>Anyway, that's my two questions and an aside; thanks for your patience, and
</I>&gt;<i>thanks for any help you can afford.
</I>
Hope this helps,

Jean-Paul

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003361.html">[Twisted-web] Quick Questions about JS mapping in Athena.
</A></li>
	<LI>Next message: <A HREF="003363.html">[Twisted-web] Quick Questions about JS mapping in Athena.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3362">[ date ]</a>
              <a href="thread.html#3362">[ thread ]</a>
              <a href="subject.html#3362">[ subject ]</a>
              <a href="author.html#3362">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
