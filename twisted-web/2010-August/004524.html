<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Gzipped Response with web.client.Agent
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Gzipped%20Response%20with%20web.client.Agent&In-Reply-To=20100810141323.2470.670063666.divmod.xquotient.16%40localhost.localdomain">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004523.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Gzipped Response with web.client.Agent</H1>
    <B>Vokdin Sergei</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20Gzipped%20Response%20with%20web.client.Agent&In-Reply-To=20100810141323.2470.670063666.divmod.xquotient.16%40localhost.localdomain"
       TITLE="[Twisted-web] Gzipped Response with web.client.Agent">sergei.vokdin at yandex.ru
       </A><BR>
    <I>Wed Aug 11 06:31:23 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="004523.html">[Twisted-web] Gzipped Response with web.client.Agent
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4524">[ date ]</a>
              <a href="thread.html#4524">[ thread ]</a>
              <a href="subject.html#4524">[ subject ]</a>
              <a href="author.html#4524">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

10.08.10, 16:13, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">exarkun at twistedmatrix.com</A>:

&gt;<i> On 9 Aug, 11:34 am, <A HREF="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">sergei.vokdin at yandex.ru</A> wrote:
</I>&gt;<i>  &gt;Hello,
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;I've putted together examples from the web (see below) to replace 
</I>&gt;<i>  &gt;getPage with web.client.Agent and it works fine. Now, I'd like to get 
</I>&gt;<i>  &gt;gzipped response, but I can't get gunzipping to work before returning 
</I>&gt;<i>  &gt;result.
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;Thanks for help!
</I>&gt;<i>  
</I>&gt;<i>  What are you having trouble with?  Your code looks okay, more or less. 
</I>&gt;<i>  If I were writing it, I'd try to make the gzip support more transparent, 
</I>&gt;<i>  but the way you've done it seems like it should probably work.
</I>
Hi,

returned string should be wrapped into file object before passing to gzip module, that was the problem.

&gt;<i>  
</I>&gt;<i>  A few simple things I notice that could cause problems, but won't 
</I>&gt;<i>  necessarily...
</I>&gt;<i>  
</I>&gt;<i>    * Using repeated string concatenation to buffer the response is going 
</I>&gt;<i>  to be extremely slow for responses of any significant size.
</I>
Nice catch, I'm forgetting this over and over again

&gt;<i>  
</I>&gt;<i>    * In general, there's no guarantee you'll be able to decode the un- 
</I>&gt;<i>  gzipped bytes using utf-8.  You could easily have downloaded a gzipped 
</I>&gt;<i>  TIFF image.
</I>&gt;<i>  
</I>&gt;<i>    * Similarly, there's no guarantee that the un-gzipping will succeed if 
</I>&gt;<i>  you got a truncated response (represented by the PotentialDataLoss 
</I>&gt;<i>  failure).
</I>&gt;<i>  
</I>&gt;<i>    * The server might have sent back un-gzipped contents.  You have to 
</I>&gt;<i>  check one of the response headers to see if it's appropriate to do the 
</I>&gt;<i>  decompression.
</I>
Thanks, for hints. This was next step in implementation.


One issue I've still have is, how to set or implement timeout, so if remote host does not answer in some period of time, request would be cancelled.

Thanks a lot!

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004523.html">[Twisted-web] Gzipped Response with web.client.Agent
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4524">[ date ]</a>
              <a href="thread.html#4524">[ thread ]</a>
              <a href="subject.html#4524">[ subject ]</a>
              <a href="author.html#4524">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
