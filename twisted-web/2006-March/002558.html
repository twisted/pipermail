<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] NameVirtualHost and web2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20NameVirtualHost%20and%20web2&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002557.html">
   <LINK REL="Next"  HREF="002559.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] NameVirtualHost and web2</H1>
    <B>Jeff Grimmett</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=%5BTwisted-web%5D%20NameVirtualHost%20and%20web2&In-Reply-To="
       TITLE="[Twisted-web] NameVirtualHost and web2">grimmtooth at gmail.com
       </A><BR>
    <I>Mon Mar 20 00:25:04 CST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002557.html">[Twisted-web] How to fill slots in sub-pattern
</A></li>
        <LI>Next message: <A HREF="002559.html">[Twisted-web] NameVirtualHost and web2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2558">[ date ]</a>
              <a href="thread.html#2558">[ thread ]</a>
              <a href="subject.html#2558">[ subject ]</a>
              <a href="author.html#2558">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've a working NameVirtualHost setup that I am trying to convert over to
web2 and I've hit a speedbump. Here's the code, more or less:

===========================
from twisted.web2 import server, http, channel, vhost
from twisted.web2 import static

root = vhost.NameVirtualHost()

site1 = server.Site(static.File(&quot;d:sites\site1&quot;))
site2 = server.Site(static.File(&quot;d:sites\site2&quot;))

root.addHost('www.grimmlabs.com', site1)
root.addHost('www.g-labs.com', site2)

site = server.Site(root)

# Standard twisted application Boilerplate
from twisted.application    import strports, service
from twisted.internet       import reactor

application = service.Application(&quot;Grimmlabs&quot;)
s = strports.service('tcp:8080', channel.HTTPFactory(site))
s.setServiceParent(application)
===========================

Run using twistd -ny file.py

Starts up, no probs. When I go to load a page, though, I see this traceback:

===========================
          File &quot;E:\Python\Lib\site-packages\twisted\web2\server.py&quot;, line
263, in process
            d = self._getChild(self.site.resource, self.postpath)
          File &quot;E:\Python\Lib\site-packages\twisted\web2\server.py&quot;, line
290, in _getChild
            return defer.maybeDeferred(
          File &quot;E:\Python\Lib\site-packages\twisted\internet\defer.py&quot;, line
191, in addCallbac
k
            callbackKeywords=kw)
          File &quot;E:\Python\Lib\site-packages\twisted\internet\defer.py&quot;, line
182, in addCallbac
ks
            self._runCallbacks()
        --- &lt;exception caught here&gt; ---
          File &quot;E:\Python\Lib\site-packages\twisted\internet\defer.py&quot;, line
307, in _runCallba
cks
            self.result = callback(self.result, *args, **kw)
          File &quot;E:\Python\Lib\site-packages\twisted\web2\server.py&quot;, line
317, in _handleSegmen
t
            newres = iweb.IResource(newres)
          File &quot;E:\Python\lib\site-packages\zope\interface\interface.py&quot;,
line 703, in __call__

            raise TypeError(&quot;Could not adapt&quot;, obj, self)
        exceptions.TypeError: ('Could not adapt',
&lt;twisted.web2.server.Siteobject at 0x00D9157
0&gt;, &lt;SpecialAdaptInterfaceClass twisted.web2.iweb.IResource&gt;)
===========================

(sorry about the formatting)

I've tried a few variations with more or less the same results. Note that
the sites I am trying to add all work just fine in web2 without the
NameVirtualHost in the mix.

I've looked over the examples and what docs we have here, and haven't come
up with any inspiration. Help me Obi-wan Kenobi, you're my only hope...

--
&quot;Ladies and gentlemen, there's nothing to worry about ... but please keep
your heads down.&quot; - The Muppet Show

Best,

    Jeff
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20060320/39afe2d4/attachment.htm">http://twistedmatrix.com/pipermail/twisted-web/attachments/20060320/39afe2d4/attachment.htm</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002557.html">[Twisted-web] How to fill slots in sub-pattern
</A></li>
	<LI>Next message: <A HREF="002559.html">[Twisted-web] NameVirtualHost and web2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2558">[ date ]</a>
              <a href="thread.html#2558">[ thread ]</a>
              <a href="subject.html#2558">[ subject ]</a>
              <a href="author.html#2558">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
