<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Twisted-web] Client.agent - PartialDownloadError - cannot	determine cause
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:twisted-web%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-web%5D%20Client.agent%20-%20PartialDownloadError%20-%20cannot%0A%09determine%20cause&In-Reply-To=%3CCAAa4tawmRy78D2daTGQz5s%2BK2o_3uXFbPLp8brNcd_BFHGf3CA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005145.html">
   <LINK REL="Next"  HREF="005142.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Twisted-web] Client.agent - PartialDownloadError - cannot	determine cause</H1>
    <B>Chris Drane</B> 
    <A HREF="mailto:twisted-web%40twistedmatrix.com?Subject=Re%3A%20%5BTwisted-web%5D%20Client.agent%20-%20PartialDownloadError%20-%20cannot%0A%09determine%20cause&In-Reply-To=%3CCAAa4tawmRy78D2daTGQz5s%2BK2o_3uXFbPLp8brNcd_BFHGf3CA%40mail.gmail.com%3E"
       TITLE="[Twisted-web] Client.agent - PartialDownloadError - cannot	determine cause">csdrane at gmail.com
       </A><BR>
    <I>Mon Apr 13 12:29:01 MDT 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="005145.html">[Twisted-web] Twisted 15.1 Release Announcement
</A></li>
        <LI>Next message: <A HREF="005142.html">[Twisted-web] Client.agent - PartialDownloadError - cannot	determine cause
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5141">[ date ]</a>
              <a href="thread.html#5141">[ thread ]</a>
              <a href="subject.html#5141">[ subject ]</a>
              <a href="author.html#5141">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am new with Twisted so chances are that this is *not* a bug. If that is
the case, I would very much appreciate it if you help me understand what I
am doing incorrectly.

I have some very simple code to just download a particular page via HTTP.
The problem I'm running into is that I get PartialDownloadErrors for some
sites, while others load fine. And when I examine the HTTP response, it
looks like the page fully downloaded. The traceback and logging information
have been very unhelpful. I cannot determine what exactly is causing the
error.

import sys
from twisted.internet.task import react
from twisted.python.log import err, startLogging
from twisted.web.client import Agent, BrowserLikeRedirectAgent, readBody
from twisted.web.http_headers import Headers
from twisted.internet import reactor
from twisted.internet.ssl import ClientContextFactory

def cbBody(r):
    print &quot;Response body:&quot;
    print r

def cbRequest(response):
    print &quot;Received response&quot;
    d = readBody(response)
    d.addCallbacks(cbBody, err)
    return d

def err(e):
    try:
        e.raiseException()
    except Exception, err:
        pass
        # display HTTP response
        # print err.response
    e.printTraceback()
    sys.stderr.write(str(e))

def main(reactor):
    startLogging(sys.stdout)
    agent = BrowserLikeRedirectAgent(Agent(reactor))
    d = agent.request(&quot;GET&quot;, b&quot;<A HREF="http://www.google.com">http://www.google.com</A>&quot;,
            Headers({'User-Agent': ['Twisted Web Client Example']}),
            None)
    d.addCallbacks(cbRequest, err)
    return d

react(main)

2015-04-13 14:13:11-0400 [-] Log opened.
2015-04-13 14:13:11-0400 [-] Starting factory
&lt;twisted.web.client._HTTP11ClientFactory instance at 0x10303f560&gt;
2015-04-13 14:13:11-0400 [HTTP11ClientProtocol,client] Received response
2015-04-13 14:13:11-0400 [HTTP11ClientProtocol,client] Traceback (most
recent call last):
2015-04-13 14:13:11-0400 [HTTP11ClientProtocol,client] Failure:
twisted.web.client.PartialDownloadError: 200 OK
2015-04-13 14:13:11-0400 [HTTP11ClientProtocol,client] [Failure instance:
Traceback (failure with no frames): &lt;class
'twisted.web.client.PartialDownloadError'&gt;: 200 OK
2015-04-13 14:13:11-0400 [HTTP11ClientProtocol,client] Stopping factory
&lt;twisted.web.client._HTTP11ClientFactory instance at 0x10303f560&gt;
2015-04-13 14:13:11-0400 [-] Main loop terminated.

Thanks!

Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://twistedmatrix.com/pipermail/twisted-web/attachments/20150413/916b2019/attachment.html">http://twistedmatrix.com/pipermail/twisted-web/attachments/20150413/916b2019/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005145.html">[Twisted-web] Twisted 15.1 Release Announcement
</A></li>
	<LI>Next message: <A HREF="005142.html">[Twisted-web] Client.agent - PartialDownloadError - cannot	determine cause
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5141">[ date ]</a>
              <a href="thread.html#5141">[ thread ]</a>
              <a href="subject.html#5141">[ subject ]</a>
              <a href="author.html#5141">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://twistedmatrix.com/cgi-bin/mailman/listinfo/twisted-web">More information about the Twisted-web
mailing list</a><br>
</body></html>
