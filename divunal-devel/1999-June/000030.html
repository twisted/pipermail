<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Divunal-devel] Proper usage of return values from a Verb</TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:glyph%40divunal.com">
   <LINK REL="Previous"  HREF="000029.html">
   <LINK REL="Next" HREF="000031.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Divunal-devel] Proper usage of return values from a Verb</H1>
    <B>Glyph Lefkowitz</B> 
    <A HREF="mailto:glyph%40divunal.com"
       TITLE="[Divunal-devel] Proper usage of return values from a Verb">glyph@divunal.com</A><BR>
    <I>Mon, 28 Jun 1999 17:01:36 -0400 (EDT)</I>
    <P><UL>
        <LI> Previous message: <A HREF="000029.html">[Divunal-devel] Proper usage of return values from a Verb</A></li>
        <LI> Next message: <A HREF="000031.html">[Divunal-devel] Problem and obstructions</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30">[ date ]</a>
              <a href="thread.html#30">[ thread ]</a>
              <a href="subject.html#30">[ subject ]</a>
              <a href="author.html#30">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I think this is a pretty clear description of when to return false, but I
believe it may have exposed a design flaw in the search path for TR --

It is quite common that an object will not want other objects to be able
to use a verb that it has exposed on it as an ablative object.  It is
pretty weird behavior for an object to be usable like that... (I.E.
something which you can &quot;turn on&quot; allowing you to &quot;turn on&quot; something else
&quot;with&quot; it)

You should never be able to &quot;sit on Bob with chair&quot; or &quot;turn on Bob with
Lamp&quot;. (well, perhaps it were a very good looking lamp, and it was one of
Bob's worse days... but I digress)

I think that adding some initialization methods in verb like featureWith()
(for allowing the verb to be found by Reality on abletive objects)  
featureDirect() featureIndirect(String) (obvious) and featureOverride()
(for allowing the verb to be found on any object in the room or on the
room itself and override the default search pattern) might be a good idea,
except that that would necessitate rewriting all the verbs we've coded to
date...

In the meanwhile, do as James says with returning false, and remember that
verbObject can tell you where a given verb is found.

On Mon, 28 Jun 1999, James Knight wrote:

&gt;<i> There seems to be some confusion over when a verb should return false. I
</I>&gt;<i> hope this will clear it up.
</I>&gt;<i> The return value from Verb.action() is not (like some documentation seems
</I>&gt;<i> to say) an indication of whether the verb succeeded or failed. Rather, it
</I>&gt;<i> is an indication of whether the verb is appropriate to use or not. For
</I>&gt;<i> example, lets take the &quot;Sit&quot; verb. If you type &quot;sit on chair&quot; Reality will
</I>&gt;<i> go through a complicated search process to find an object with the
</I>&gt;<i> specified verb on it. It will stop with the first one it finds. It searches
</I>&gt;<i> in the following order:
</I>&gt;<i> 
</I>&gt;<i> 1) the object in a 'with' clause
</I>&gt;<i> 2) the object in an indirect object clause
</I>&gt;<i> (in/on/to/at/from/through/except/into)
</I>&gt;<i> 3) the direct object (ie the phrase right after the verb)
</I>&gt;<i> 4) the room itself (or if you're on a chair or something, the chair you're
</I>&gt;<i> on, and then the room)
</I>&gt;<i> 5) the player's abilities
</I>&gt;<i> 6) ANY object in the same room.
</I>&gt;<i> 7) ANY object the player is carrying
</I>&gt;<i> Only after not finding the verb in any of those places will it give up.
</I>&gt;<i> Therefore, it is important for your verb to not work when it is
</I>&gt;<i> inappropriate.
</I>&gt;<i> 
</I>&gt;<i> Lets take a real example. divunal.common.Sit is a verb on a 'red chair'.
</I>&gt;<i> There is also a lantern in the same room. &quot;Sit on chair&quot; should run sit on
</I>&gt;<i> the chair and will do so (from case 2). However, &quot;Sit on lantern&quot; will (if
</I>&gt;<i> no extra checking is done) get to case 6, and try to use the &quot;sit&quot; verb
</I>&gt;<i> from the chair. This is incorrect behavior. Note that if the user does &quot;sit
</I>&gt;<i> on lantern with chair&quot; it will try to run the &quot;sit&quot; verb from the chair in
</I>&gt;<i> case #1. This is even more problematic if there are two chairs in the room.
</I>&gt;<i> Lets say chair 1 and chair 2 have different &quot;sit&quot; verbs on them. The user
</I>&gt;<i> can then cause the game to use the *wrong* one intentionally by doing &quot;sit
</I>&gt;<i> on chair 1 with chair 2&quot;. That will use chair 2's sit because the with
</I>&gt;<i> clause is checked first.
</I>&gt;<i> To fix this behavior, you can return false from your verb. What this means
</I>&gt;<i> is essentially &quot;I am the wrong verb, keep looking&quot;.
</I>&gt;<i> 
</I>&gt;<i> So e.g. to make Sit work properly, you want to check that the object that
</I>&gt;<i> the verb was found on is the same as the object you're trying to sit on. If
</I>&gt;<i> it isn't, then don't run this verb, BUT keep looking for another one that
</I>&gt;<i> may be appropriate.
</I>&gt;<i> You can do this by adding the following code: if(d.verbObject() != box)
</I>&gt;<i> return false;
</I>&gt;<i> (d.verbObject() returns the object that the verb was found on, and box is
</I>&gt;<i> previously set in Sit.java to be d.indirectObject(&quot;in&quot;) or
</I>&gt;<i> d.indirectObject(&quot;on&quot;))
</I>&gt;<i> 
</I>&gt;<i> The same should be done for Stand. However, in stand's case, the verb is
</I>&gt;<i> only applicable if you are currently on the object that the verb was found
</I>&gt;<i> on. In java, this translates to: if(d.verbObject() != d.subject().place())
</I>&gt;<i> return false;
</I>&gt;<i> 
</I>&gt;<i> Now that those modifications are made, if the user types &quot;sit on lantern&quot;
</I>&gt;<i> it will properly give a generic error message. And, if in the second
</I>&gt;<i> example, the user types &quot;sit on chair 1 with chair 2&quot; it will properly use
</I>&gt;<i> chair 1's Sit. Anyways, I hope this clears things up somewhat, so you can
</I>&gt;<i> all write better verbs. If my explaination is lacking in some way please
</I>&gt;<i> tell me so I can correct it.
</I>&gt;<i> -James
</I>&gt;<i> 
</I>&gt;<i> --
</I>&gt;<i> You are in a maze of testy little Java VMs, all subtly different.
</I>

</pre>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000029.html">[Divunal-devel] Proper usage of return values from a Verb</A></li>
	<LI> Next message: <A HREF="000031.html">[Divunal-devel] Problem and obstructions</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30">[ date ]</a>
              <a href="thread.html#30">[ thread ]</a>
              <a href="subject.html#30">[ subject ]</a>
              <a href="author.html#30">[ author ]</a>
         </LI>
       </UL>
</body></html>
